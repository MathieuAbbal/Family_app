(self.webpackChunkfamilyapp=self.webpackChunkfamilyapp||[]).push([[792],{4(Jy,lf,Vd){"use strict";let ro=null,Ud=!1,v=1;const He=Symbol("SIGNAL");function St(t){const n=ro;return ro=t,n}const Hl={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Oo(t){if(Ud)throw new Error("");if(null===ro)return;ro.consumerOnSignalRead(t);const n=ro.producersTail;if(void 0!==n&&n.producer===t)return;let e;const r=ro.recomputing;if(r&&(e=void 0!==n?n.nextProducer:ro.producers,void 0!==e&&e.producer===t))return ro.producersTail=e,void(e.lastReadVersion=t.version);const i=t.consumersTail;if(void 0!==i&&i.consumer===ro&&(!r||function As(t,n){const e=n.producersTail;if(void 0!==e){let r=n.producers;do{if(r===t)return!0;if(r===e)break;r=r.nextProducer}while(void 0!==r)}return!1}(i,ro)))return;const o=yr(ro),a={producer:t,consumer:ro,nextProducer:e,prevConsumer:i,lastReadVersion:t.version,nextConsumer:void 0};ro.producersTail=a,void 0!==n?n.nextProducer=a:ro.producers=a,o&&Gs(t,a)}function io(t){if((!yr(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==v)){if(!t.producerMustRecompute(t)&&!zi(t))return void hl(t);t.producerRecomputeValue(t),hl(t)}}function Mu(t){if(void 0===t.consumers)return;const n=Ud;Ud=!0;try{for(let e=t.consumers;void 0!==e;e=e.nextConsumer){const r=e.consumer;r.dirty||cf(r)}}finally{Ud=n}}function Ui(){return!1!==ro?.consumerAllowSignalWrites}function cf(t){t.dirty=!0,Mu(t),t.consumerMarkedDirty?.(t)}function hl(t){t.dirty=!1,t.lastCleanEpoch=v}function ss(t){return t&&function Ru(t){t.producersTail=void 0,t.recomputing=!0}(t),St(t)}function Ia(t,n){St(n),t&&function Vc(t){t.recomputing=!1;const n=t.producersTail;let e=void 0!==n?n.nextProducer:t.producers;if(void 0!==e){if(yr(t))do{e=$l(e)}while(void 0!==e);void 0!==n?n.nextProducer=void 0:t.producers=void 0}}(t)}function zi(t){for(let n=t.producers;void 0!==n;n=n.nextProducer){const e=n.producer,r=n.lastReadVersion;if(r!==e.version||(io(e),r!==e.version))return!0}return!1}function ks(t){if(yr(t)){let n=t.producers;for(;void 0!==n;)n=$l(n)}t.producers=void 0,t.producersTail=void 0,t.consumers=void 0,t.consumersTail=void 0}function Gs(t,n){const e=t.consumersTail,r=yr(t);if(void 0!==e?(n.nextConsumer=e.nextConsumer,e.nextConsumer=n):(n.nextConsumer=void 0,t.consumers=n),n.prevConsumer=e,t.consumersTail=n,!r)for(let i=t.producers;void 0!==i;i=i.nextProducer)Gs(i.producer,i)}function $l(t){const n=t.producer,e=t.nextProducer,r=t.nextConsumer,i=t.prevConsumer;if(t.nextConsumer=void 0,t.prevConsumer=void 0,void 0!==r?r.prevConsumer=i:n.consumersTail=i,void 0!==i)i.nextConsumer=r;else if(n.consumers=r,!yr(n)){let o=n.producers;for(;void 0!==o;)o=$l(o)}return e}function yr(t){return t.consumerIsAlwaysLive||void 0!==t.consumers}function ql(t,n){return Object.is(t,n)}const ka=Symbol("UNSET"),Ms=Symbol("COMPUTING"),oo=Symbol("ERRORED"),Aa={...Hl,value:ka,dirty:!0,error:null,equal:ql,kind:"computed",producerMustRecompute:t=>t.value===ka||t.value===Ms,producerRecomputeValue(t){if(t.value===Ms)throw new Error("");const n=t.value;t.value=Ms;const e=ss(t);let r,i=!1;try{r=t.computation(),St(null),i=n!==ka&&n!==oo&&r!==oo&&t.equal(n,r)}catch(o){r=oo,t.error=o}finally{Ia(t,e)}i?t.value=n:(t.value=r,t.version++)}};let Gl=function Uc(){throw new Error};function fl(t){Gl(t)}function pl(t,n){const e=Object.create(Ra);e.value=t,void 0!==n&&(e.equal=n);const r=()=>function Ma(t){return Oo(t),t.value}(e);return r[He]=e,[r,a=>ml(e,a),a=>function Ws(t,n){Ui()||fl(t),ml(t,n(t.value))}(e,a)]}function ml(t,n){Ui()||fl(t),t.equal(t.value,n)||(t.value=n,function Fo(t){t.version++,function Bc(){v++}(),Mu(t)}(t))}const Ra={...Hl,equal:ql,value:void 0,kind:"signal"},Hp={...Hl,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"};function vr(t){return"function"==typeof t}function as(t){const e=t(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const gl=as(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function _l(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class Qn{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(vr(r))try{r()}catch(o){n=o instanceof gl?o.errors:[o]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const o of i)try{Ks(o)}catch(a){n=n??[],a instanceof gl?n=[...n,...a.errors]:n.push(a)}}if(n)throw new gl(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Ks(n);else{if(n instanceof Qn){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._teardowns=null!==(e=this._teardowns)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&_l(e,n)}remove(n){const{_teardowns:e}=this;e&&_l(e,n),n instanceof Qn&&n._removeParent(this)}}Qn.EMPTY=(()=>{const t=new Qn;return t.closed=!0,t})();const Rs=Qn.EMPTY;function Wl(t){return t instanceof Qn||t&&"closed"in t&&vr(t.remove)&&vr(t.add)&&vr(t.unsubscribe)}function Ks(t){vr(t)?t():t.unsubscribe()}const Pa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},zc={setTimeout(...t){const{delegate:n}=zc;return(n?.setTimeout||setTimeout)(...t)},clearTimeout(t){const{delegate:n}=zc;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Nu(t){zc.setTimeout(()=>{const{onUnhandledError:n}=Pa;if(!n)throw t;n(t)})}function Na(){}const Ou=jc("C",void 0,void 0);function jc(t,n,e){return{kind:t,value:n,error:e}}let Ps=null;function Zl(t){if(Pa.useDeprecatedSynchronousErrorHandling){const n=!Ps;if(n&&(Ps={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:r}=Ps;if(Ps=null,e)throw r}}else t()}class Fu extends Qn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Wl(n)&&n.add(this)):this.destination=Hc}static create(n,e,r){return new jd(n,e,r)}next(n){this.isStopped?Oa(function Lu(t){return jc("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Oa(function uf(t){return jc("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Oa(Ou,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class jd extends Fu{constructor(n,e,r){let i;if(super(),vr(n))i=n;else if(n){let o;({next:i,error:e,complete:r}=n),this&&Pa.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe()):o=n,i=i?.bind(o),e=e?.bind(o),r=r?.bind(o)}this.destination={next:i?yl(i):Na,error:yl(e??Kl),complete:r?yl(r):Na}}}function yl(t,n){return(...e)=>{try{t(...e)}catch(r){Pa.useDeprecatedSynchronousErrorHandling?function zd(t){Pa.useDeprecatedSynchronousErrorHandling&&Ps&&(Ps.errorThrown=!0,Ps.error=t)}(r):Nu(r)}}}function Kl(t){throw t}function Oa(t,n){const{onStoppedNotification:e}=Pa;e&&zc.setTimeout(()=>e(t,n))}const Hc={closed:!0,next:Na,error:Kl,complete:Na},Yl="function"==typeof Symbol&&Symbol.observable||"@@observable";function sr(t){return t}function j(t){return 0===t.length?sr:1===t.length?t[0]:function(e){return t.reduce((r,i)=>i(r),e)}}let H=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,i){const o=function me(t){return t&&t instanceof Fu||function oe(t){return t&&vr(t.next)&&vr(t.error)&&vr(t.complete)}(t)&&Wl(t)}(e)?e:new jd(e,r,i);return Zl(()=>{const{operator:a,source:c}=this;o.add(a?a.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=K(r))((i,o)=>{let a;a=this.subscribe(c=>{try{e(c)}catch(f){o(f),a?.unsubscribe()}},o,i)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[Yl](){return this}pipe(...e){return j(e)(this)}toPromise(e){return new(e=K(e))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return t.create=n=>new t(n),t})();function K(t){var n;return null!==(n=t??Pa.Promise)&&void 0!==n?n:Promise}const ye=as(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let qe,ee=(()=>{class t extends H{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new X(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new ye}next(e){Zl(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(e)}})}error(e){Zl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){Zl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:i,observers:o}=this;return r||i?Rs:(o.push(e),new Qn(()=>_l(o,e)))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:i,isStopped:o}=this;r?e.error(i):o&&e.complete()}asObservable(){const e=new H;return e.source=this,e}}return t.create=(n,e)=>new X(n,e),t})();class X extends ee{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,n)}error(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==r?r:Rs}}class ae extends ee{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}function Je(){return qe}function Te(t){const n=qe;return qe=t,n}const ht=Symbol("NotFound");function Et(t){return t===ht||"\u0275NotFound"===t?.name}Error;const tn="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class ue extends Error{code;constructor(n,e){super(Ht(n,e)),this.code=n}}function Ht(t,n){return`${function fr(t){return`NG0${Math.abs(t)}`}(t)}${n?": "+n:""}`}const ln=globalThis;function _t(t){for(let n in t)if(t[n]===_t)return n;throw Error("")}function Br(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function En(t){if("string"==typeof t)return t;if(Array.isArray(t))return`[${t.map(En).join(", ")}]`;if(null==t)return""+t;const n=t.overriddenName||t.name;if(n)return`${n}`;const e=t.toString();if(null==e)return""+e;const r=e.indexOf("\n");return r>=0?e.slice(0,r):e}function mn(t,n){return t?n?`${t} ${n}`:t:n||""}const wn=_t({__forward_ref__:_t});function Jn(t){return t.__forward_ref__=Jn,t.toString=function(){return En(this())},t}function _n(t){return si(t)?t():t}function si(t){return"function"==typeof t&&t.hasOwnProperty(wn)&&t.__forward_ref__===Jn}function $e(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Hr(t){return{providers:t.providers||[],imports:t.imports||[]}}function df(t){return function tv(t,n){return t.hasOwnProperty(n)&&t[n]||null}(t,Gc)}function qc(t){return t&&t.hasOwnProperty(Wc)?t[Wc]:null}const Gc=_t({\u0275prov:_t}),Wc=_t({\u0275inj:_t});class Ue{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(n,e){this._desc=n,this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=$e({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function $d(t){return t&&!!t.\u0275providers}const ff=_t({\u0275cmp:_t}),Wp=_t({\u0275dir:_t}),Zp=_t({\u0275pipe:_t}),Kp=_t({\u0275mod:_t}),nc=_t({\u0275fac:_t}),qd=_t({__NG_ELEMENT_ID__:_t}),Uu=_t({__NG_ENV_ID__:_t});function us(t){return Fa(t),t[Kp]||null}function cn(t){return Fa(t),t[ff]||null}function ai(t){return Fa(t),t[Wp]||null}function lo(t){return Fa(t),t[Zp]||null}function Fa(t,n){if(null==t)throw new ue(-919,!1)}function nn(t){return"string"==typeof t?t:null==t?"":String(t)}const mf=_t({ngErrorCode:_t}),xr=_t({ngErrorMessage:_t}),Ba=_t({ngTokenPath:_t});function ju(t,n){return vl("",-200,n)}function gf(t,n){throw new ue(-201,!1)}function vl(t,n,e){const r=new ue(n,t);return r[mf]=n,r[xr]=t,e&&(r[Ba]=e),r}let _f;function yf(){return _f}function Ii(t){const n=_f;return _f=t,n}function vf(t,n,e){const r=df(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:8&e?null:void 0!==n?n:void gf()}const Va={};class br{injector;constructor(n){this.injector=n}retrieve(n,e){const r=Zd(e)||0;try{return this.injector.get(n,8&r?null:Va,r)}catch(i){if(Et(i))return i;throw i}}}function bf(t,n=0){const e=Je();if(void 0===e)throw new ue(-203,!1);if(null===e)return vf(t,void 0,n);{const r=function Kd(t){return{optional:!!(8&t),host:!!(1&t),self:!!(2&t),skipSelf:!!(4&t)}}(n),i=e.retrieve(t,r);if(Et(i)){if(r.optional)return null;throw i}return i}}function Tt(t,n=0){return(yf()||bf)(_n(t),n)}function Q(t,n){return Tt(t,Zd(n))}function Zd(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function wf(t){const n=[];for(let e=0;e<t.length;e++){const r=_n(t[e]);if(Array.isArray(r)){if(0===r.length)throw new ue(900,!1);let i,o=0;for(let a=0;a<r.length;a++){const c=r[a],f=xf(c);"number"==typeof f?-1===f?i=c.token:o|=f:i=c}n.push(Tt(i,o))}else n.push(Tt(r))}return n}function xf(t){return t.__NG_DI_FLAG__}function za(t,n){return t.hasOwnProperty(nc)?t[nc]:null}function oc(t,n){t.forEach(e=>Array.isArray(e)?oc(e,n):n(e))}function qu(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function ds(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function ja(t,n,e){let r=bl(t,n);return r>=0?t[1|r]=e:(r=~r,function Ef(t,n,e,r){let i=t.length;if(i==n)t.push(e,r);else if(1===i)t.push(r,t[0]),t[0]=e;else{for(i--,t.push(t[i-1],t[i]);i>n;)t[i]=t[i-2],i--;t[n]=e,t[n+1]=r}}(t,r,n,e)),r}function Kc(t,n){const e=bl(t,n);if(e>=0)return t[1|e]}function bl(t,n){return function sv(t,n,e){let r=0,i=t.length>>e;for(;i!==r;){const o=r+(i-r>>1),a=t[o<<e];if(n===a)return o<<e;a>n?i=o:r=o+1}return~(i<<e)}(t,n,1)}const Ls={},Pr=[],Xs=new Ue(""),Cf=new Ue("",-1),Df=new Ue("");class Qd{get(n,e=Va){if(e===Va){const i=vl("",-201);throw i.name="\u0275NotFound",i}return e}}function Ha(t){return{\u0275providers:t}}function Sf(...t){return{\u0275providers:Yc(0,t),\u0275fromNgModule:!0}}function Yc(t,...n){const e=[],r=new Set;let i;const o=a=>{e.push(a)};return oc(n,a=>{const c=a;Gu(c,o,[],r)&&(i||=[],i.push(c))}),void 0!==i&&Xp(i,o),e}function Xp(t,n){for(let e=0;e<t.length;e++){const{ngModule:r,providers:i}=t[e];Wu(i,o=>{n(o,r)})}}function Gu(t,n,e,r){if(!(t=_n(t)))return!1;let i=null,o=qc(t);const a=!o&&cn(t);if(o||a){if(a&&!a.standalone)return!1;i=t}else{const f=t.ngModule;if(o=qc(f),!o)return!1;i=f}const c=r.has(i);if(a){if(c)return!1;if(r.add(i),a.dependencies){const f="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const _ of f)Gu(_,n,e,r)}}else{if(!o)return!1;{if(null!=o.imports&&!c){let _;r.add(i),oc(o.imports,x=>{Gu(x,n,e,r)&&(_||=[],_.push(x))}),void 0!==_&&Xp(_,n)}if(!c){const _=za(i)||(()=>new i);n({provide:i,useFactory:_,deps:Pr},i),n({provide:Df,useValue:i,multi:!0},i),n({provide:Xs,useValue:()=>Tt(i),multi:!0},i)}const f=o.providers;if(null!=f&&!c){const _=t;Wu(f,x=>{n(x,_)})}}}return i!==t&&void 0!==t.providers}function Wu(t,n){for(let e of t)$d(e)&&(e=e.\u0275providers),Array.isArray(e)?Wu(e,n):n(e)}const Xc=_t({provide:String,useValue:_t});function $a(t){return null!==t&&"object"==typeof t&&Xc in t}function Jo(t){return"function"==typeof t}const If=new Ue(""),wl={},Zu={};let Qp;function sc(){return void 0===Qp&&(Qp=new Qd),Qp}class $r{}class da extends $r{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(n,e,r,i){super(),this.parent=e,this.source=r,this.scopes=i,Vo(n,a=>this.processProvider(a)),this.records.set(Cf,lt(void 0,this)),i.has("environment")&&this.records.set($r,lt(void 0,this));const o=this.records.get(If);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Df,Pr,{self:!0}))}retrieve(n,e){const r=Zd(e)||0;try{return this.get(n,Va,r)}catch(i){if(Et(i))return i;throw i}}destroy(){co(this),this._destroyed=!0;const n=St(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of e)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),St(n)}}onDestroy(n){return co(this),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){co(this);const e=Te(this),r=Ii(void 0);try{return n()}finally{Te(e),Ii(r)}}get(n,e=Va,r){if(co(this),n.hasOwnProperty(Uu))return n[Uu](this);const i=Zd(r),a=Te(this),c=Ii(void 0);try{if(!(4&i)){let _=this.records.get(n);if(void 0===_){const x=function ac(t){return"function"==typeof t||"object"==typeof t&&"InjectionToken"===t.ngMetadataName}(n)&&df(n);_=x&&this.injectableDefInScope(x)?lt($i(n),wl):null,this.records.set(n,_)}if(null!=_)return this.hydrate(n,_,i)}return(2&i?sc():this.parent).get(n,e=8&i&&e===Va?null:e)}catch(f){const _=function Hu(t){return t[mf]}(f);throw-200===_||-201===_?new ue(_,null):f}finally{Ii(c),Te(a)}}resolveInjectorInitializers(){const n=St(null),e=Te(this),r=Ii(void 0);try{const o=this.get(Xs,Pr,{self:!0});for(const a of o)a()}finally{Te(e),Ii(r),St(n)}}toString(){const n=[],e=this.records;for(const r of e.keys())n.push(En(r));return`R3Injector[${n.join(", ")}]`}processProvider(n){let e=Jo(n=_n(n))?n:_n(n&&n.provide);const r=function Ug(t){return $a(t)?lt(void 0,t.useValue):lt(ki(t),wl)}(n);if(!Jo(n)&&!0===n.multi){let i=this.records.get(e);i||(i=lt(void 0,wl,!0),i.factory=()=>wf(i.multi),this.records.set(e,i)),e=n,i.multi.push(n)}this.records.set(e,r)}hydrate(n,e,r){const i=St(null);try{if(e.value===Zu)throw ju(En(n));return e.value===wl&&(e.value=Zu,e.value=e.factory(void 0,r)),"object"==typeof e.value&&e.value&&function Ku(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{St(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const e=_n(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function $i(t){const n=df(t),e=null!==n?n.factory:za(t);if(null!==e)return e;if(t instanceof Ue)throw new ue(204,!1);if(t instanceof Function)return function Fs(t){if(t.length>0)throw new ue(204,!1);const e=function qp(t){return(t?.[Gc]??null)||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new ue(204,!1)}function ki(t,n,e){let r;if(Jo(t)){const i=_n(t);return za(i)||$i(i)}if($a(t))r=()=>_n(t.useValue);else if(function kn(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...wf(t.deps||[]));else if(function er(t){return!(!t||!t.useExisting)}(t))r=(i,o)=>Tt(_n(t.useExisting),void 0!==o&&8&o?8:void 0);else{const i=_n(t&&(t.useClass||t.provide));if(!function Jd(t){return!!t.deps}(t))return za(i)||$i(i);r=()=>new i(...wf(t.deps))}return r}function co(t){if(t.destroyed)throw new ue(205,!1)}function lt(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Vo(t,n){for(const e of t)Array.isArray(e)?Vo(e,n):e&&$d(e)?Vo(e.\u0275providers,n):n(e)}function qi(t,n){let e;t instanceof da?(co(t),e=t):e=new br(t);const i=Te(e),o=Ii(void 0);try{return n()}finally{Te(i),Ii(o)}}function Cn(t){return Array.isArray(t)&&"object"==typeof t[1]}function Eo(t){return Array.isArray(t)&&!0===t[1]}function Yu(t){return!!(4&t.flags)}function uo(t){return t.componentOffset>-1}function Xi(t){return!(1&~t.flags)}function ps(t){return!!t.template}function ms(t){return!!(512&t[2])}function Vs(t){return!(256&~t[2])}function F(t){for(;Array.isArray(t);)t=t[0];return t}function Z(t,n){return F(n[t])}function $(t,n){return F(n[t.index])}function re(t,n){return t.data[n]}function le(t,n){const e=n[t];return Cn(e)?e:e[0]}function we(t){return!(128&~t[2])}function De(t,n){return null==n?null:t[n]}function Re(t){t[17]=0}function Ve(t){1024&t[2]||(t[2]|=1024,we(t)&&Ct(t))}function We(t){return!!(9216&t[2]||t[24]?.dirty)}function ct(t){t[10].changeDetectionScheduler?.notify(8),64&t[2]&&(t[2]|=1024),We(t)&&Ct(t)}function Ct(t){t[10].changeDetectionScheduler?.notify(0);let n=gn(t);for(;null!==n&&!(8192&n[2])&&(n[2]|=8192,we(n));)n=gn(n)}function kt(t,n){if(Vs(t))throw new ue(911,!1);null===t[21]&&(t[21]=[]),t[21].push(n)}function gn(t){const n=t[3];return Eo(n)?n[3]:n}function ft(t){return t[7]??=[]}function Xt(t){return t.cleanup??=[]}const et={lFrame:Uw(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let jt=!1;function qr(){et.lFrame.elementDepthCount--}function ho(){return et.bindingsEnabled}function vi(){return null!==et.skipHydrationRootTNode}function bi(t){return et.skipHydrationRootTNode===t}function Co(){et.skipHydrationRootTNode=null}function Le(){return et.lFrame.lView}function $t(){return et.lFrame.tView}function Me(t){return et.lFrame.contextLView=t,t[8]}function Oe(t){return et.lFrame.contextLView=null,t}function Qt(){let t=Qc();for(;null!==t&&64===t.type;)t=t.parent;return t}function Qc(){return et.lFrame.currentTNode}function Us(t,n){const e=et.lFrame;e.currentTNode=t,e.isParent=n}function Jc(){return et.lFrame.isParent}function ma(){et.lFrame.isParent=!1}function dc(){return jt}function Nr(t){const n=jt;return jt=t,n}function jn(){const t=et.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Vr(){return et.lFrame.bindingIndex}function Qi(){return et.lFrame.bindingIndex++}function El(t){const n=et.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function Hg(t,n){const e=et.lFrame;e.bindingIndex=e.bindingRootIndex=t,tu(n)}function tu(t){et.lFrame.currentDirectiveIndex=t}function nm(){return et.lFrame.currentQueryIndex}function hc(t){et.lFrame.currentQueryIndex=t}function gs(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[5]:null}function Bw(t,n,e){if(4&e){let i=n,o=t;for(;!(i=i.parent,null!==i||1&e||(i=gs(o),null===i||(o=o[14],10&i.type))););if(null===i)return!1;n=i,t=o}const r=et.lFrame=Vw();return r.currentTNode=n,r.lView=t,!0}function qg(t){const n=Vw(),e=t[1];et.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Vw(){const t=et.lFrame,n=null===t?null:t.child;return null===n?Uw(t):n}function Uw(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function zw(){const t=et.lFrame;return et.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const jw=zw;function rm(){const t=zw();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function fo(){return et.lFrame.selectedIndex}function ed(t){et.lFrame.selectedIndex=t}function zo(){const t=et.lFrame;return re(t.tView,t.selectedIndex)}function xn(){et.lFrame.currentNamespace="svg"}function Ri(){!function _T(){et.lFrame.currentNamespace=null}()}let Hw=!0;function Gg(){return Hw}function im(t){Hw=t}function Wg(t,n=null,e=null,r){const i=$w(t,n,e,r);return i.resolveInjectorInitializers(),i}function $w(t,n=null,e=null,r,i=new Set){const o=[e||Pr,Sf(t)];return r=r||("object"==typeof t?void 0:En(t)),new da(o,n||sc(),r||null,i)}class An{static THROW_IF_NOT_FOUND=Va;static NULL=new Qd;static create(n,e){if(Array.isArray(n))return Wg({name:""},e,n,"");{const r=n.name??"";return Wg({name:r},n.parent,n.providers,r)}}static \u0275prov=$e({token:An,providedIn:"any",factory:()=>Tt(Cf)});static __NG_ELEMENT_ID__=-1}const Wn=new Ue("");let cr=(()=>class t{static __NG_ELEMENT_ID__=qw;static __NG_ENV_ID__=e=>e})();class om extends cr{_lView;constructor(n){super(),this._lView=n}get destroyed(){return Vs(this._lView)}onDestroy(n){const e=this._lView;return kt(e,n),()=>function It(t,n){if(null===t[21])return;const e=t[21].indexOf(n);-1!==e&&t[21].splice(e,1)}(e,n)}}function qw(){return new om(Le())}const sm=!1,Zg=new Ue("");let Ga=(()=>{class t{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new ae(!1);debugTaskTracker=Q(Zg,{optional:!0});get hasPendingTasks(){return!this.destroyed&&this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new H(e=>{e.next(!1),e.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),this.debugTaskTracker?.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.debugTaskTracker?.remove(e),0===this.pendingTasks.size&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new t})}return t})();const Zn=class Gw extends ee{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(n=!1){super(),this.__isAsync=n,function bo(){return void 0!==yf()||null!=Je()}()&&(this.destroyRef=Q(cr,{optional:!0})??void 0,this.pendingTasks=Q(Ga,{optional:!0})??void 0)}emit(n){const e=St(null);try{super.next(n)}finally{St(e)}}subscribe(n,e,r){let i=n,o=e||(()=>null),a=r;if(n&&"object"==typeof n){const f=n;i=f.next?.bind(f),o=f.error?.bind(f),a=f.complete?.bind(f)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),a&&(a=this.wrapInTimeout(a)));const c=super.subscribe({next:i,error:o,complete:a});return n instanceof Qn&&n.add(c),c}wrapInTimeout(n){return e=>{const r=this.pendingTasks?.add();setTimeout(()=>{try{n(e)}finally{void 0!==r&&this.pendingTasks?.remove(r)}})}}};function td(...t){}function Kg(t){let n,e;function r(){t=td;try{void 0!==e&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(e),void 0!==n&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{t(),r()}),"function"==typeof requestAnimationFrame&&(e=requestAnimationFrame(()=>{t(),r()})),()=>r()}function av(t){return queueMicrotask(()=>t()),()=>{t=td}}const ih="isAngularZone",Yg=ih+"_ID";let lv=0;class sn{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Zn(!1);onMicrotaskEmpty=new Zn(!1);onStable=new Zn(!1);onError=new Zn(!1);constructor(n){const{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=sm}=n;if(typeof Zone>"u")throw new ue(908,!1);Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!i&&r,a.shouldCoalesceRunChangeDetection=i,a.callbackScheduled=!1,a.scheduleInRootZone=o,function vT(t){const n=()=>{!function Cl(t){function n(){Kg(()=>{t.callbackScheduled=!1,uv(t),t.isCheckStableRunning=!0,am(t),t.isCheckStableRunning=!1})}t.isCheckStableRunning||t.callbackScheduled||(t.callbackScheduled=!0,t.scheduleInRootZone?Zone.root.run(()=>{n()}):t._outer.run(()=>{n()}),uv(t))}(t)},e=lv++;t._inner=t._inner.fork({name:"angular",properties:{[ih]:!0,[Yg]:e,[Yg+e]:!0},onInvokeTask:(r,i,o,a,c,f)=>{if(function Nf(t){return Yw(t,"__ignore_ng_zone__")}(f))return r.invokeTask(o,a,c,f);try{return Ww(t),r.invokeTask(o,a,c,f)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||t.shouldCoalesceRunChangeDetection)&&n(),Zw(t)}},onInvoke:(r,i,o,a,c,f,_)=>{try{return Ww(t),r.invoke(o,a,c,f,_)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!function bT(t){return Yw(t,"__scheduler_tick__")}(f)&&n(),Zw(t)}},onHasTask:(r,i,o,a)=>{r.hasTask(o,a),i===o&&("microTask"==a.change?(t._hasPendingMicrotasks=a.microTask,uv(t),am(t)):"macroTask"==a.change&&(t.hasPendingMacrotasks=a.macroTask))},onHandleError:(r,i,o,a)=>(r.handleError(o,a),t.runOutsideAngular(()=>t.onError.emit(a)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(ih)}static assertInAngularZone(){if(!sn.isInAngularZone())throw new ue(909,!1)}static assertNotInAngularZone(){if(sn.isInAngularZone())throw new ue(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,n,cv,td,td);try{return o.runTask(a,e,r)}finally{o.cancelTask(a)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}}const cv={};function am(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function uv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&!0===t.callbackScheduled)}function Ww(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Zw(t){t._nesting--,am(t)}class Kw{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Zn;onMicrotaskEmpty=new Zn;onStable=new Zn;onError=new Zn;run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,i){return n.apply(e,r)}}function Yw(t,n){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0]?.data?.[n]}class Of{_console=console;handleError(n){this._console.error("ERROR",n)}}const Dl=new Ue("",{factory:()=>{const t=Q(sn),n=Q($r);let e;return r=>{t.runOutsideAngular(()=>{n.destroyed&&!e?setTimeout(()=>{throw r}):(e??=n.get(Of),e.handleError(r))})}}}),Xw={provide:Xs,useValue:()=>{Q(Of,{optional:!0})},multi:!0};function Pi(t,n){const[e,r,i]=pl(t,n?.equal),o=e;return o.set=r,o.update=i,o.asReadonly=oh.bind(o),o}function oh(){const t=this[He];if(void 0===t.readonlyFn){const n=()=>this();n[He]=t,t.readonlyFn=n}return t.readonlyFn}let dv=(()=>class t{view;node;constructor(e,r){this.view=e,this.node=r}static __NG_ELEMENT_ID__=xT})();function xT(){return new dv(Le(),Qt())}class Lf{}const nd=new Ue("",{factory:()=>!0}),Qw=new Ue("");let hv=(()=>{class t{internalPendingTasks=Q(Ga);scheduler=Q(Lf);errorHandler=Q(Dl);add(){const e=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(e)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(e))}}run(e){const r=this.add();e().catch(this.errorHandler).finally(r)}static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new t})}return t})(),Jw=(()=>{class t{static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new CT})}return t})();class CT{dirtyEffectCount=0;queues=new Map;add(n){this.enqueue(n),this.schedule(n)}schedule(n){n.dirty&&this.dirtyEffectCount++}remove(n){const r=this.queues.get(n.zone);r.has(n)&&(r.delete(n),n.dirty&&this.dirtyEffectCount--)}enqueue(n){const e=n.zone;this.queues.has(e)||this.queues.set(e,new Set);const r=this.queues.get(e);r.has(n)||r.add(n)}flush(){for(;this.dirtyEffectCount>0;){let n=!1;for(const[e,r]of this.queues)n||=null===e?this.flushQueue(r):e.run(()=>this.flushQueue(r));n||(this.dirtyEffectCount=0)}}flushQueue(n){let e=!1;for(const r of n)r.dirty&&(this.dirtyEffectCount--,e=!0,r.run());return e}}class Xg{[He];constructor(n){this[He]=n}destroy(){this[He].destroy()}}function Do(t,n){const e=n?.injector??Q(An);let i,r=!0!==n?.manualCleanup?e.get(cr):null;const o=e.get(dv,null,{optional:!0}),a=e.get(Lf);return null!==o?(i=function DT(t,n,e){const r=Object.create(nx);return r.view=t,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=n,r.fn=ix(r,e),t[23]??=new Set,t[23].add(r),r.consumerMarkedDirty(r),r}(o.view,a,t),r instanceof om&&r._lView===o.view&&(r=null)):i=function rx(t,n,e){const r=Object.create(tx);return r.fn=ix(r,t),r.scheduler=n,r.notifier=e,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}(t,e.get(Jw),a),i.injector=e,null!==r&&(i.onDestroyFns=[r.onDestroy(()=>i.destroy())]),new Xg(i)}const ex={...Hp,cleanupFns:void 0,zone:null,onDestroyFns:null,run(){const t=Nr(!1);try{!function aa(t){if(t.dirty=!1,t.version>0&&!zi(t))return;t.version++;const n=ss(t);try{t.cleanup(),t.fn()}finally{Ia(t,n)}}(this)}finally{Nr(t)}},cleanup(){if(!this.cleanupFns?.length)return;const t=St(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],St(t)}}},tx={...ex,consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(ks(this),null!==this.onDestroyFns)for(const t of this.onDestroyFns)t();this.cleanup(),this.scheduler.remove(this)}},nx={...ex,consumerMarkedDirty(){this.view[2]|=8192,Ct(this.view),this.notifier.notify(13)},destroy(){if(ks(this),null!==this.onDestroyFns)for(const t of this.onDestroyFns)t();this.cleanup(),this.view[23]?.delete(this)}};function ix(t,n){return()=>{n(e=>(t.cleanupFns??=[]).push(e))}}function Er(t){return function Zs(t){const n=St(null);try{return t()}finally{St(n)}}(t)}function ox(t,n,e,r,i,o,a){try{var c=t[o](a),f=c.value}catch(_){return void e(_)}c.done?n(f):Promise.resolve(f).then(r,i)}function fe(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(f){ox(o,r,i,a,c,"next",f)}function c(f){ox(o,r,i,a,c,"throw",f)}a(void 0)})}}function jo(t){return n=>{if(function TT(t){return vr(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class li extends Fu{constructor(n,e,r,i,o){super(n),this.onFinalize=o,this._next=e?function(a){try{e(a)}catch(c){n.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){n.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}function mr(t,n){return jo((e,r)=>{let i=0;e.subscribe(new li(r,o=>{r.next(t.call(n,o,i++))}))})}function pc(t){return{toString:t}.toString()}function Vf(t,n,e,r){null!==n?n.applyValueToInputSignal(n,r):t[e]=r}class ta{previousValue;currentValue;firstChange;constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}const Ho=(()=>{const t=()=>To;return t.ngInherit=!0,t})();function To(t){return t.type.prototype.ngOnChanges&&(t.setInput=Jg),Qg}function Qg(){const t=fv(this),n=t?.current;if(n){const e=t.previous;if(e===Ls)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function Jg(t,n,e,r,i){const o=this.declaredInputs[r],a=fv(t)||function cx(t,n){return t[_s]=n}(t,{previous:Ls,current:null}),c=a.current||(a.current={}),f=a.previous,_=f[o];c[o]=new ta(_&&_.currentValue,e,f===Ls),Vf(t,n,i,e)}const _s="__ngSimpleChanges__";function fv(t){return t[_s]||null}const lh=[],wr=function(t,n=null,e){for(let r=0;r<lh.length;r++)(0,lh[r])(t,n,e)};var Dt=function(t){return t[t.TemplateCreateStart=0]="TemplateCreateStart",t[t.TemplateCreateEnd=1]="TemplateCreateEnd",t[t.TemplateUpdateStart=2]="TemplateUpdateStart",t[t.TemplateUpdateEnd=3]="TemplateUpdateEnd",t[t.LifecycleHookStart=4]="LifecycleHookStart",t[t.LifecycleHookEnd=5]="LifecycleHookEnd",t[t.OutputStart=6]="OutputStart",t[t.OutputEnd=7]="OutputEnd",t[t.BootstrapApplicationStart=8]="BootstrapApplicationStart",t[t.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",t[t.BootstrapComponentStart=10]="BootstrapComponentStart",t[t.BootstrapComponentEnd=11]="BootstrapComponentEnd",t[t.ChangeDetectionStart=12]="ChangeDetectionStart",t[t.ChangeDetectionEnd=13]="ChangeDetectionEnd",t[t.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",t[t.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",t[t.AfterRenderHooksStart=16]="AfterRenderHooksStart",t[t.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",t[t.ComponentStart=18]="ComponentStart",t[t.ComponentEnd=19]="ComponentEnd",t[t.DeferBlockStateStart=20]="DeferBlockStateStart",t[t.DeferBlockStateEnd=21]="DeferBlockStateEnd",t[t.DynamicComponentStart=22]="DynamicComponentStart",t[t.DynamicComponentEnd=23]="DynamicComponentEnd",t[t.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",t[t.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",t}(Dt||{});function e_(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:c,ngAfterViewInit:f,ngAfterViewChecked:_,ngOnDestroy:x}=o;a&&(t.contentHooks??=[]).push(-e,a),c&&((t.contentHooks??=[]).push(e,c),(t.contentCheckHooks??=[]).push(e,c)),f&&(t.viewHooks??=[]).push(-e,f),_&&((t.viewHooks??=[]).push(e,_),(t.viewCheckHooks??=[]).push(e,_)),null!=x&&(t.destroyHooks??=[]).push(e,x)}}function cm(t,n,e){_v(t,n,3,e)}function um(t,n,e,r){(3&t[2])===e&&_v(t,n,e,r)}function gv(t,n){let e=t[2];(3&e)===n&&(e&=16383,e+=1,t[2]=e)}function _v(t,n,e,r){const o=r??-1,a=n.length-1;let c=0;for(let f=void 0!==r?65535&t[17]:0;f<a;f++)if("number"==typeof n[f+1]){if(c=n[f],null!=r&&c>=r)break}else n[f]<0&&(t[17]+=65536),(c<o||-1==o)&&(dx(t,e,n,f),t[17]=(4294901760&t[17])+f+2),f++}function yv(t,n){wr(Dt.LifecycleHookStart,t,n);const e=St(null);try{n.call(t)}finally{St(e),wr(Dt.LifecycleHookEnd,t,n)}}function dx(t,n,e,r){const i=e[r]<0,o=e[r+1],c=t[i?-e[r]:e[r]];i?t[2]>>14<t[17]>>16&&(3&t[2])===n&&(t[2]+=16384,yv(c,o)):yv(c,o)}class dm{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(n,e,r,i){this.factory=n,this.name=i,this.canSeeViewProviders=e,this.injectImpl=r}}function sd(t){return 3===t||4===t||6===t}function fx(t){return 64===t.charCodeAt(0)}function zf(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){const i=n[r];"number"==typeof i?e=i:0===e||px(t,e,i,0,-1===e||2===e?n[++r]:null)}}return t}function px(t,n,e,r,i){let o=0,a=t.length;if(-1===n)a=-1;else for(;o<t.length;){const c=t[o++];if("number"==typeof c){if(c===n){a=-1;break}if(c>n){a=o-1;break}}}for(;o<t.length;){const c=t[o];if("number"==typeof c)break;if(c===e)return void(null!==i&&(t[o+1]=i));o++,null!==i&&o++}-1!==a&&(t.splice(a,0,n),o=a+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i)}function ad(t){return-1!==t}function uh(t){return 32767&t}function dh(t,n){let e=function mx(t){return t>>16}(t),r=n;for(;e>0;)r=r[14],e--;return r}let r_=!0;function hm(t){const n=r_;return r_=t,n}let i_=0;const Za={};function ru(t,n){const e=tr(t,n);if(-1!==e)return e;const r=n[1];r.firstCreatePass&&(t.injectorIndex=n.length,hh(r.data,t),hh(n,null),hh(r.blueprint,null));const i=o_(t,n),o=t.injectorIndex;if(ad(i)){const a=uh(i),c=dh(i,n),f=c[1].data;for(let _=0;_<8;_++)n[o+_]=c[a+_]|f[a+_]}return n[o+8]=i,o}function hh(t,n){t.push(0,0,0,0,0,0,0,0,n)}function tr(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function o_(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,r=null,i=n;for(;null!==i;){if(r=Dv(i),null===r)return-1;if(e++,i=i[14],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function fm(t,n,e){!function FT(t,n,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(qd)&&(r=e[qd]),null==r&&(r=e[qd]=i_++);const i=255&r;n.data[t+(i>>5)]|=1<<i}(t,n,e)}function yx(t,n,e){if(8&e||void 0!==t)return t;gf()}function vx(t,n,e,r){if(8&e&&void 0===r&&(r=null),!(3&e)){const i=t[9],o=Ii(void 0);try{return i?i.get(n,r,8&e):vf(n,r,8&e)}finally{Ii(o)}}return yx(r,0,e)}function bx(t,n,e,r=0,i){if(null!==t){if(2048&n[2]&&!(2&r)){const a=function Ar(t,n,e,r,i){let o=t,a=n;for(;null!==o&&null!==a&&2048&a[2]&&!ms(a);){const c=wx(o,a,e,2|r,Za);if(c!==Za)return c;let f=o.parent;if(!f){const _=a[20];if(_){const x=_.get(e,Za,r);if(x!==Za)return x}f=Dv(a),a=a[14]}o=f}return i}(t,n,e,r,Za);if(a!==Za)return a}const o=wx(t,n,e,r,Za);if(o!==Za)return o}return vx(n,e,r,i)}function wx(t,n,e,r,i){const o=function xx(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(qd)?t[qd]:void 0;return"number"==typeof n?n>=0?255&n:$f:n}(e);if("function"==typeof o){if(!Bw(n,t,r))return 1&r?yx(i,0,r):vx(n,e,r,i);try{let a;if(a=o(r),null!=a||8&r)return a;gf()}finally{jw()}}else if("number"==typeof o){let a=null,c=tr(t,n),f=-1,_=1&r?n[15][5]:null;for((-1===c||4&r)&&(f=-1===c?o_(t,n):n[c+8],-1!==f&&Cv(r,!1)?(a=n[1],c=uh(f),n=dh(f,n)):c=-1);-1!==c;){const x=n[1];if(Ev(o,c,x.data)){const C=BT(c,n,e,a,r,_);if(C!==Za)return C}f=n[c+8],-1!==f&&Cv(r,n[1].data[c+8]===_)&&Ev(o,c,n)?(a=x,c=uh(f),n=dh(f,n)):c=-1}}return i}function BT(t,n,e,r,i,o){const a=n[1],c=a.data[t+8],x=s_(c,a,e,null==r?uo(c)&&r_:r!=a&&!!(3&c.type),1&i&&o===c);return null!==x?Hf(n,a,x,c,i):Za}function s_(t,n,e,r,i){const o=t.providerIndexes,a=n.data,c=1048575&o,f=t.directiveStart,x=o>>20,A=i?c+x:t.directiveEnd;for(let N=r?c:c+x;N<A;N++){const U=a[N];if(N<f&&e===U||N>=f&&U.type===e)return N}if(i){const N=a[f];if(N&&ps(N)&&N.type===e)return f}return null}function Hf(t,n,e,r,i){let o=t[e];const a=n.data;if(o instanceof dm){const c=o;if(c.resolving)throw ju();const f=hm(c.canSeeViewProviders);c.resolving=!0;const C=c.injectImpl?Ii(c.injectImpl):null;Bw(t,r,0);try{o=t[e]=c.factory(void 0,i,a,t,r),n.firstCreatePass&&e>=r.directiveStart&&function Uf(t,n,e){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=n.type.prototype;if(r){const a=To(n);(e.preOrderHooks??=[]).push(t,a),(e.preOrderCheckHooks??=[]).push(t,a)}i&&(e.preOrderHooks??=[]).push(0-t,i),o&&((e.preOrderHooks??=[]).push(t,o),(e.preOrderCheckHooks??=[]).push(t,o))}(e,a[e],n)}finally{null!==C&&Ii(C),hm(f),c.resolving=!1,jw()}}return o}function Ev(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function Cv(t,n){return!(2&t||1&t&&n)}class ci{_tNode;_lView;constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return bx(this._tNode,this._lView,n,Zd(r),e)}}function $f(){return new ci(Qt(),Le())}function Gr(t){return pc(()=>{const n=t.prototype.constructor,e=n[nc]||ti(n),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const o=i[nc]||ti(i);if(o&&o!==e)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function ti(t){return si(t)?()=>{const n=ti(_n(t));return n&&n()}:za(t)}function Dv(t){const n=t[1],e=n.type;return 2===e?n.declTNode:1===e?t[5]:null}function qf(t){return function jf(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const r=e.length;let i=0;for(;i<r;){const o=e[i];if(sd(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof e[i];)i++;else{if(o===n)return e[i+1];i+=2}}}return null}(Qt(),t)}function ou(){return ph(Qt(),Le())}function ph(t,n){return new Ur($(t,n))}let Ur=(()=>class t{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=ou})();function Dx(t){return t instanceof Ur?t.nativeElement:t}function Ji(){return this._results[Symbol.iterator]()}class cd{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new ee}constructor(n=!1){this._emitDistinctChangesOnly=n}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;const r=function vo(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function Yd(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],o=n[r];if(e&&(i=e(i),o=e(o)),o!==i)return!1}return!0}(this._results,r,e))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=Ji}function m(t){return!(128&~t.flags)}var E=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(E||{});const S=new Map;let k=0;function z(t){S.delete(t[19])}const be="__ngContext__";function ve(t,n){Cn(n)?(t[be]=n[19],function P(t){S.set(t[19],t)}(n)):t[be]=n}function on(t){return Mt(t[12])}function Dn(t){return Mt(t[4])}function Mt(t){for(;null!==t&&!Eo(t);)t=t[4];return t}let So;const Tr=new Ue("",{factory:()=>ko}),ko="ng",Sl=new Ue(""),ys=new Ue("",{providedIn:"platform",factory:()=>"unknown"}),_a=new Ue(""),jr=new Ue("",{factory:()=>Q(Wn).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),vm=new Ue("",{factory:()=>!1}),Em=new Ue("");function wh(t){return!(32&~t.flags)}function TO(t,n){const e=t.contentQueries;if(null!==e){const r=St(null);try{for(let i=0;i<e.length;i+=2){const a=e[i+1];if(-1!==a){const c=t.data[a];hc(e[i]),c.contentQueries(2,n[a],a)}}}finally{St(r)}}}function WT(t,n,e){hc(0);const r=St(null);try{n(t,e)}finally{St(r)}}function ZT(t,n,e){if(Yu(n)){const r=St(null);try{const o=n.directiveEnd;for(let a=n.directiveStart;a<o;a++){const c=t.data[a];c.contentQueries&&c.contentQueries(1,e[a],a)}}finally{St(r)}}}var Ec=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t[t.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",t}(Ec||{});let jx,Hx;function k_(t){return function AO(){if(void 0===jx&&(jx=null,ln.trustedTypes))try{jx=ln.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return jx}()?.createHTML(t)||t}function PO(t){return function XT(){if(void 0===Hx&&(Hx=null,ln.trustedTypes))try{Hx=ln.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Hx}()?.createScriptURL(t)||t}class Sm{changingThisBreaksApplicationSecurity;constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${tn})`}}class O7 extends Sm{getTypeName(){return"HTML"}}class L7 extends Sm{getTypeName(){return"Style"}}class F7 extends Sm{getTypeName(){return"Script"}}class B7 extends Sm{getTypeName(){return"URL"}}class V7 extends Sm{getTypeName(){return"ResourceURL"}}function kl(t){return t instanceof Sm?t.changingThisBreaksApplicationSecurity:t}function hd(t,n){const e=function U7(t){return t instanceof Sm&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${tn})`)}return e===n}class G7{inertDocumentHelper;constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(k_(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.firstChild?.remove(),e)}catch{return null}}}class W7{defaultDoc;inertDocument;constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=k_(n),e}}const K7=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function $x(t){return(t=String(t)).match(K7)?t:"unsafe:"+t}function Dh(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Vv(...t){const n={};for(const e of t)for(const r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}const OO=Dh("area,br,col,hr,img,wbr"),LO=Dh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),FO=Dh("rp,rt"),QT=Vv(OO,Vv(LO,Dh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Vv(FO,Dh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Vv(FO,LO)),JT=Dh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),BO=Vv(JT,Dh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Dh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Y7=Dh("script,style,template");class X7{sanitizedSomething=!1;buf=[];sanitizeChildren(n){let e=n.firstChild,r=!0,i=[];for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)i.push(e),e=eW(e);else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=J7(e);if(o){e=o;break}e=i.pop()}return this.buf.join("")}startElement(n){const e=VO(n).toLowerCase();if(!QT.hasOwnProperty(e))return this.sanitizedSomething=!0,!Y7.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=n.attributes;for(let i=0;i<r.length;i++){const o=r.item(i),a=o.name,c=a.toLowerCase();if(!BO.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let f=o.value;JT[c]&&(f=$x(f)),this.buf.push(" ",a,'="',zO(f),'"')}return this.buf.push(">"),!0}endElement(n){const e=VO(n).toLowerCase();QT.hasOwnProperty(e)&&!OO.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(zO(n))}}function J7(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw UO(n);return n}function eW(t){const n=t.firstChild;if(n&&function Q7(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw UO(n);return n}function VO(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function UO(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const tW=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,nW=/([^\#-~ |!])/g;function zO(t){return t.replace(/&/g,"&amp;").replace(tW,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(nW,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let qx;function jO(t,n){let e=null;try{qx=qx||function NO(t){const n=new W7(t);return function Z7(){try{return!!(new window.DOMParser).parseFromString(k_(""),"text/html")}catch{return!1}}()?new G7(n):n}(t);let r=n?String(n):"";e=qx.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=e.innerHTML,e=qx.getInertBodyElement(r)}while(r!==o);return k_((new X7).sanitizeChildren(eS(e)||e))}finally{if(e){const r=eS(e)||e;for(;r.firstChild;)r.firstChild.remove()}}}function eS(t){return"content"in t&&function rW(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}function Gx(t,n,e){return t.createElement(n,e)}function Im(t,n,e,r,i){t.insertBefore(n,e,r,i)}function qO(t,n,e){t.appendChild(n,e)}function GO(t,n,e,r,i){null!==r?Im(t,n,e,r,i):qO(t,n,e)}function Uv(t,n,e,r){t.removeChild(null,n,e,r)}function ZO(t,n,e){const{mergedAttrs:r,classes:i,styles:o}=e;null!==r&&function n_(t,n,e){let r=0;for(;r<e.length;){const i=e[r];if("number"==typeof i){if(0!==i)break;r++;const o=e[r++],a=e[r++],c=e[r++];t.setAttribute(n,a,c,o)}else{const o=i,a=e[++r];fx(o)?t.setProperty(n,o,a):t.setAttribute(n,o,a),r++}}}(t,n,r),null!==i&&function lW(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}(t,n,i),null!==o&&function aW(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}var Al=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Al||{});function vs(t){const n=zv();return n?n.sanitize(Al.URL,t)||"":hd(t,"URL")?kl(t):$x(nn(t))}function KO(t){const n=zv();if(n)return PO(n.sanitize(Al.RESOURCE_URL,t)||"");if(hd(t,"ResourceURL"))return PO(kl(t));throw new ue(904,!1)}const mW=new Set(["embed","frame","iframe","media","script"]),gW=new Set(["base","link","script"]);function YO(t,n,e){return function _W(t,n){return"src"===n&&mW.has(t)||"href"===n&&gW.has(t)||"xlink:href"===n&&"script"===t?KO:vs}(n,e)(t)}function zv(){const t=Le();return t&&t[10].sanitizer}function fd(t){return t instanceof Function?t():t}function IW(t,n,e){let r=t.length;for(;;){const i=t.indexOf(n,e);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=n.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}e=i+1}}const tL="ng-template";function kW(t,n,e,r){let i=0;if(r){for(;i<n.length&&"string"==typeof n[i];i+=2)if("class"===n[i]&&-1!==IW(n[i+1].toLowerCase(),e,0))return!0}else if(rS(t))return!1;if(i=n.indexOf(1,i),i>-1){let o;for(;++i<n.length&&"string"==typeof(o=n[i]);)if(o.toLowerCase()===e)return!0}return!1}function rS(t){return 4===t.type&&t.value!==tL}function AW(t,n,e){return n===(4!==t.type||e?t.value:tL)}function MW(t,n,e){let r=4;const i=t.attrs,o=null!==i?function NW(t){for(let n=0;n<t.length;n++)if(sd(t[n]))return n;return t.length}(i):0;let a=!1;for(let c=0;c<n.length;c++){const f=n[c];if("number"!=typeof f){if(!a)if(4&r){if(r=2|1&r,""!==f&&!AW(t,f,e)||""===f&&1===n.length){if(du(r))return!1;a=!0}}else if(8&r){if(null===i||!kW(t,i,f,e)){if(du(r))return!1;a=!0}}else{const _=n[++c],x=RW(f,i,rS(t),e);if(-1===x){if(du(r))return!1;a=!0;continue}if(""!==_){let C;if(C=x>o?"":i[x+1].toLowerCase(),2&r&&_!==C){if(du(r))return!1;a=!0}}}}else{if(!a&&!du(r)&&!du(f))return!1;if(a&&du(f))continue;a=!1,r=f|1&r}}return du(r)||a}function du(t){return!(1&t)}function RW(t,n,e,r){if(null===n)return-1;let i=0;if(r||!e){let o=!1;for(;i<n.length;){const a=n[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let c=n[++i];for(;"string"==typeof c;)c=n[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function OW(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const r=t[e];if("number"==typeof r)return-1;if(r===n)return e;e++}return-1}(n,t)}function nL(t,n,e=!1){for(let r=0;r<n.length;r++)if(MW(t,n[r],e))return!0;return!1}function LW(t,n){e:for(let e=0;e<n.length;e++){const r=n[e];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function rL(t,n){return t?":not("+n.trim()+")":n}function FW(t){let n=t[0],e=1,r=2,i="",o=!1;for(;e<t.length;){let a=t[e];if("string"==typeof a)if(2&r){const c=t[++e];i+="["+a+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!du(a)&&(n+=rL(o,i),i=""),r=a,o=o||!du(r);e++}return""!==i&&(n+=rL(o,i)),n}const Lr={};function iS(t,n,e,r,i,o,a,c,f,_,x){const C=27+r,A=C+i,N=function UW(t,n){const e=[];for(let r=0;r<n;r++)e.push(r<t?null:Lr);return e}(C,A),U="function"==typeof _?_():_;return N[1]={type:t,blueprint:N,template:e,queries:null,viewQuery:c,declTNode:n,data:N.slice().fill(null,C),bindingStartIndex:C,expandoStartIndex:A,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:f,consts:U,incompleteFirstPass:!1,ssrId:x}}function Zx(t,n,e,r,i,o,a,c,f,_,x){const C=n.blueprint.slice();return C[0]=i,C[2]=1228|r,(null!==_||t&&2048&t[2])&&(C[2]|=2048),Re(C),C[3]=C[14]=t,C[8]=e,C[10]=a||t&&t[10],C[11]=c||t&&t[11],C[9]=f||t&&t[9]||null,C[5]=o,C[19]=function M(){return k++}(),C[6]=x,C[20]=_,C[15]=2==n.type?t[15]:C,C}function oS(t){let n=16;return t.signals?n=4096:t.onPush&&(n=64),n}function jv(t,n,e,r){if(0===e)return-1;const i=n.length;for(let o=0;o<e;o++)n.push(r),t.blueprint.push(r),t.data.push(null);return i}function sS(t,n){return t[12]?t[13][4]=n:t[12]=n,t[13]=n,n}function Y(t=1){oL($t(),Le(),fo()+t,!1)}function oL(t,n,e,r){if(!r)if(3&~n[2]){const o=t.preOrderHooks;null!==o&&um(n,o,0,e)}else{const o=t.preOrderCheckHooks;null!==o&&cm(n,o,e)}ed(e)}var Kx=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Kx||{});function km(t,n,e,r){const i=St(null);try{const[o,a,c]=t.inputs[e];let f=null;0!==(a&Kx.SignalBased)&&(f=n[o][He]),null!==f&&void 0!==f.transformFn?r=f.transformFn(r):null!==c&&(r=c.call(n,r)),null!==t.setInput?t.setInput(n,f,r,e,o):Vf(n,f,o,r)}finally{St(i)}}var ap=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(ap||{});function lS(t,n){return undefined(t,n)}const Am=new Set;var cS=function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t}(cS||{});const R_=new Ue(""),cL=new Set;function ns(t){cL.has(t)||(cL.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}let uL=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new t})}return t})();const dL=[0,1,2,3];let WW=(()=>{class t{ngZone=Q(sn);scheduler=Q(Lf);errorHandler=Q(Of,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){Q(R_,{optional:!0})}execute(){const e=this.sequences.size>0;e&&wr(Dt.AfterRenderHooksStart),this.executing=!0;for(const r of dL)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[r])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>(0,i.hooks[r])(i.pipelinedValue),i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(const r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(const r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&wr(Dt.AfterRenderHooksEnd)}register(e){const{view:r}=e;void 0!==r?((r[25]??=[]).push(e),Ct(r),r[2]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,r){return r?r.run(cS.AFTER_NEXT_RENDER,e):e()}static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new t})}return t})();class hL{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(n,e,r,i,o,a=null){this.impl=n,this.hooks=e,this.view=r,this.once=i,this.snapshot=a,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();const n=this.view?.[25];n&&(this.view[25]=n.filter(e=>e!==this))}}function hu(t,n){const e=n?.injector??Q(An);return ns("NgAfterNextRender"),function fL(t,n,e,r){const i=n.get(uL);i.impl??=n.get(WW);const o=n.get(R_,null,{optional:!0}),a=!0!==e?.manualCleanup?n.get(cr):null,c=n.get(dv,null,{optional:!0}),f=new hL(i.impl,function KW(t){return t instanceof Function?[void 0,void 0,t,void 0]:[t.earlyRead,t.write,t.mixedReadWrite,t.read]}(t),c?.view,r,a,o?.snapshot(null));return i.impl.register(f),f}(t,e,n,!0)}const Xx=new Ue("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:Q($r)})});function pL(t,n,e){const r=t.get(Xx);if(Array.isArray(n))for(const i of n)r.queue.add(i),e?.detachedLeaveAnimationFns?.push(i);else r.queue.add(n),e?.detachedLeaveAnimationFns?.push(n);r.scheduler&&r.scheduler(t)}function mL(t,n,e,r){const i=t?.[26]?.enter;null!==n&&i&&i.has(e.index)&&function uS(t,n){for(const[e,r]of n)pL(t,r.animateFns)}(r,i)}function P_(t,n,e,r,i,o,a,c){if(null!=i){let f,_=!1;Eo(i)?f=i:Cn(i)&&(_=!0,i=i[0]);const x=F(i);0===t&&null!==r?(mL(c,r,o,e),null==a?qO(n,r,x):Im(n,r,x,a||null,!0)):1===t&&null!==r?(mL(c,r,o,e),Im(n,r,x,a||null,!0)):2===t?yL(c,o,e,C=>{Uv(n,x,_,C)}):3===t&&yL(c,o,e,()=>{n.destroyNode(x)}),null!=f&&function i9(t,n,e,r,i,o,a){const c=r[7];c!==F(r)&&P_(n,t,e,o,c,i,a);for(let _=10;_<r.length;_++){const x=r[_];e1(x[1],x,t,n,o,c)}}(n,t,e,f,o,r,a)}}function _L(t,n){n[10].changeDetectionScheduler?.notify(9),e1(t,n,n[11],2,null,null)}function dS(t,n){const e=t[9],r=e.indexOf(n);e.splice(r,1)}function Hv(t,n){if(Vs(n))return;const e=n[11];e.destroyNode&&e1(t,n,e,3,null,null),function JW(t){let n=t[12];if(!n)return hS(t[1],t);for(;n;){let e=null;if(Cn(n))e=n[12];else{const r=n[10];r&&(e=r)}if(!e){for(;n&&!n[4]&&n!==t;)Cn(n)&&hS(n[1],n),n=n[3];null===n&&(n=t),Cn(n)&&hS(n[1],n),e=n&&n[4]}n=e}}(n)}function hS(t,n){if(Vs(n))return;const e=St(null);try{n[2]&=-129,n[2]|=256,n[24]&&ks(n[24]),function n9(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let r=0;r<e.length;r+=2){const i=n[e[r]];if(!(i instanceof dm)){const o=e[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const c=i[o[a]],f=o[a+1];wr(Dt.LifecycleHookStart,c,f);try{f.call(c)}finally{wr(Dt.LifecycleHookEnd,c,f)}}else{wr(Dt.LifecycleHookStart,i,o);try{o.call(i)}finally{wr(Dt.LifecycleHookEnd,i,o)}}}}}(t,n),function t9(t,n){const e=t.cleanup,r=n[7];if(null!==e)for(let a=0;a<e.length-1;a+=2)if("string"==typeof e[a]){const c=e[a+3];c>=0?r[c]():r[-c].unsubscribe(),a+=2}else e[a].call(r[e[a+1]]);null!==r&&(n[7]=null);const i=n[21];if(null!==i){n[21]=null;for(let a=0;a<i.length;a++)(0,i[a])()}const o=n[23];if(null!==o){n[23]=null;for(const a of o)a.destroy()}}(t,n),1===n[1].type&&n[11].destroy();const r=n[16];if(null!==r&&Eo(n[3])){r!==n[3]&&dS(r,n);const i=n[18];null!==i&&i.detachView(t)}z(n)}finally{St(e)}}function yL(t,n,e,r){const i=t?.[26];if(null==i||null==i.leave||!i.leave.has(n.index))return r(!1);t&&Am.add(t[19]),pL(e,()=>{if(i.leave&&i.leave.has(n.index)){const a=i.leave.get(n.index),c=[];if(a){for(let f=0;f<a.animateFns.length;f++){const _=a.animateFns[f],{promise:x}=_();c.push(x)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(c),function e9(t,n){const e=t[26]?.running;e?e.then(()=>{t[26].running=void 0,Am.delete(t[19]),n(!0)}):n(!1)}(t,r)}else t&&Am.delete(t[19]),r(!1)},i)}function fS(t,n,e){return function vL(t,n,e){let r=n;for(;null!==r&&168&r.type;)r=(n=r).parent;if(null===r)return e[0];if(uo(r)){const{encapsulation:i}=t.data[r.directiveStart+r.componentOffset];if(i===Ec.None||i===Ec.Emulated)return null}return $(r,e)}(t,n.parent,e)}function bL(t,n,e){return xL(t,n,e)}let xL=function wL(t,n,e){return 40&t.type?$(t,e):null};function mS(t,n,e,r){const i=fS(t,r,n),o=n[11],c=bL(r.parent||n[5],r,n);if(null!=i)if(Array.isArray(e))for(let f=0;f<e.length;f++)GO(o,i,e[f],c,!1);else GO(o,i,e,c,!1)}function Mm(t,n){if(null!==n){const e=n.type;if(3&e)return $(n,t);if(4&e)return Jx(-1,t[n.index]);if(8&e){const r=n.child;if(null!==r)return Mm(t,r);{const i=t[n.index];return Eo(i)?Jx(-1,i):F(i)}}if(128&e)return Mm(t,n.next);if(32&e)return lS(n,t)()||F(t[n.index]);{const r=CL(t,n);return null!==r?Array.isArray(r)?r[0]:Mm(gn(t[15]),r):Mm(t,n.next)}}return null}function CL(t,n){return null!==n?t[15][5].projection[n.projection]:null}function Jx(t,n){const e=10+t+1;if(e<n.length){const r=n[e],i=r[1].firstChild;if(null!==i)return Mm(r,i)}return n[7]}function gS(t,n,e,r,i,o,a){for(;null!=e;){const c=r[9];if(128===e.type){e=e.next;continue}const f=r[e.index],_=e.type;if(a&&0===n&&(f&&ve(F(f),r),e.flags|=2),!wh(e))if(8&_)gS(t,n,e.child,r,i,o,!1),P_(n,t,c,i,f,e,o,r);else if(32&_){const x=lS(e,r);let C;for(;C=x();)P_(n,t,c,i,C,e,o,r);P_(n,t,c,i,f,e,o,r)}else 16&_?DL(t,n,r,e,i,o):P_(n,t,c,i,f,e,o,r);e=a?e.projectionNext:e.next}}function e1(t,n,e,r,i,o){gS(e,r,t.firstChild,n,i,o,!1)}function DL(t,n,e,r,i,o){const a=e[15],f=a[5].projection[r.projection];if(Array.isArray(f))for(let _=0;_<f.length;_++)P_(n,t,e[9],i,f[_],r,o,e);else{let _=f;const x=a[3];m(r)&&(_.flags|=128),gS(t,n,_,x,i,o,!0)}}function TL(t,n,e,r,i){const o=fo(),a=2&r;try{ed(-1),a&&n.length>27&&oL(t,n,27,!1),wr(a?Dt.TemplateUpdateStart:Dt.TemplateCreateStart,i,e),e(r,i)}finally{ed(o),wr(a?Dt.TemplateUpdateEnd:Dt.TemplateCreateEnd,i,e)}}function t1(t,n,e){(function u9(t,n,e){const r=e.directiveStart,i=e.directiveEnd;uo(e)&&function zW(t,n,e){const r=$(n,t),i=function iL(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=iS(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}(e),o=t[10].rendererFactory,a=sS(t,Zx(t,i,null,oS(e),r,n,null,o.createRenderer(r,e),null,null,null));t[n.index]=a}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||ru(e,n);const o=e.initialInputs;for(let a=r;a<i;a++){const c=t.data[a],f=Hf(n,t,a,e);ve(f,n),null!==o&&p9(0,a-r,f,c,0,o),ps(c)&&(le(e.index,n)[8]=Hf(n,t,a,e))}})(t,n,e),!(64&~e.flags)&&function d9(t,n,e){const r=e.directiveStart,i=e.directiveEnd,o=e.index,a=function rh(){return et.lFrame.currentDirectiveIndex}();try{ed(o);for(let c=r;c<i;c++){const f=t.data[c],_=n[c];tu(c),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&h9(f,_)}}finally{ed(-1),tu(a)}}(t,n,e)}function N_(t,n,e=$){const r=n.localNames;if(null!==r){let i=n.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],c=-1===a?e(n,t):t[a];t[i++]=c}}}let SL=()=>null;function n1(t,n,e,r,i,o){s1(t,n[1],n,e,r)?uo(t)&&function IL(t,n){const e=le(n,t);16&e[2]||(e[2]|=64)}(n,t.index):(3&t.type&&(e=function c9(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(e)),_S(t,n,e,r,i,o))}function _S(t,n,e,r,i,o){if(3&t.type){const a=$(t,n);r=null!=o?o(r,t.value||"",e):r,i.setProperty(a,e,r)}}function h9(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function yS(t,n){const e=t.directiveRegistry;let r=null;if(e)for(let i=0;i<e.length;i++){const o=e[i];nL(n,o.selectors,!1)&&(r??=[],ps(o)?r.unshift(o):r.push(o))}return r}function p9(t,n,e,r,i,o){const a=o[n];if(null!==a)for(let c=0;c<a.length;c+=2)km(r,e,a[c],a[c+1])}function i1(t,n,e,r,i){const o=27+e,a=n[1],c=i(a,n,t,r,e);n[o]=c,Us(t,!0);const f=2===t.type;return f?(ZO(n[11],c,t),(0===function Pt(){return et.lFrame.elementDepthCount}()||Xi(t))&&ve(c,n),function lr(){et.lFrame.elementDepthCount++}()):ve(c,n),Gg()&&(!f||!wh(t))&&mS(a,n,c,t),t}function o1(t){let n=t;return Jc()?ma():(n=n.parent,Us(n,!1)),n}function s1(t,n,e,r,i){const o=t.inputs?.[r],a=t.hostDirectiveInputs?.[r];let c=!1;if(a)for(let f=0;f<a.length;f+=2){const _=a[f];km(n.data[_],e[_],a[f+1],i),c=!0}if(o)for(const f of o)km(n.data[f],e[f],r,i),c=!0;return c}function g9(t,n){const e=le(n,t),r=e[1];!function _9(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(r,e);const i=e[0];null!==i&&null===e[6]&&(e[6]=null),wr(Dt.ComponentStart);try{a1(r,e,e[8])}finally{wr(Dt.ComponentEnd,e[8])}}function a1(t,n,e){qg(n);try{const r=t.viewQuery;null!==r&&WT(1,r,e);const i=t.template;null!==i&&TL(t,n,i,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[18]?.finishViewCreation(t),t.staticContentQueries&&TO(t,n),t.staticViewQueries&&WT(2,t.viewQuery,e);const o=t.components;null!==o&&function y9(t,n){for(let e=0;e<n.length;e++)g9(t,n[e])}(n,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[2]&=-5,rm()}}function O_(t,n,e,r){const i=St(null);try{const o=n.tView,f=Zx(t,o,e,4096&t[2]?4096:16,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);f[16]=t[n.index];const x=t[18];return null!==x&&(f[18]=x.createEmbeddedView(o)),a1(o,f,e),f}finally{St(i)}}function Rm(t,n){return!n||null===n.firstChild||m(t)}function $v(t,n,e,r,i=!1){for(;null!==e;){if(128===e.type){e=i?e.projectionNext:e.next;continue}const o=n[e.index];null!==o&&r.push(F(o)),Eo(o)&&v9(o,r);const a=e.type;if(8&a)$v(t,n,e.child,r);else if(32&a){const c=lS(e,n);let f;for(;f=c();)r.push(f)}else if(16&a){const c=CL(n,e);if(Array.isArray(c))r.push(...c);else{const f=gn(n[15]);$v(f[1],f,c,r,!0)}}e=i?e.projectionNext:e.next}return r}function v9(t,n){for(let e=10;e<t.length;e++){const r=t[e],i=r[1].firstChild;null!==i&&$v(r[1],r,i,n)}t[7]!==t[0]&&n.push(t[7])}function ML(t){if(null!==t[25]){for(const n of t[25])n.impl.addSequence(n);t[25].length=0}}let RL=[];const E9={...Hl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{Ct(t.lView)},consumerOnSignalRead(){this.lView[24]=this}},D9={...Hl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let n=gn(t.lView);for(;n&&!PL(n[1]);)n=gn(n);n&&Ve(n)},consumerOnSignalRead(){this.lView[24]=this}};function PL(t){return 2!==t.type}function NL(t){if(null===t[23])return;let n=!0;for(;n;){let e=!1;for(const r of t[23])r.dirty&&(e=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));n=e&&!!(8192&t[2])}}function l1(t,n=0){const r=t[10].rendererFactory;r.begin?.();try{!function S9(t,n){const e=dc();try{Nr(!0),bS(t,n);let r=0;for(;We(t);){if(100===r)throw new ue(103,!1);r++,bS(t,1)}}finally{Nr(e)}}(t,n)}finally{r.end?.()}}function OL(t,n,e,r){if(Vs(n))return;const i=n[2];qg(n);let c=!0,f=null,_=null;PL(t)?(_=function b9(t){return t[24]??function w9(t){const n=RL.pop()??Object.create(E9);return n.lView=t,n}(t)}(n),f=ss(_)):null===function Wt(){return ro}()?(c=!1,_=function C9(t){const n=t[24]??Object.create(D9);return n.lView=t,n}(n),f=ss(_)):n[24]&&(ks(n[24]),n[24]=null);try{Re(n),function Ju(t){return et.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&TL(t,n,e,2,r);const x=!(3&~i);if(x){const N=t.preOrderCheckHooks;null!==N&&cm(n,N,null)}else{const N=t.preOrderHooks;null!==N&&um(n,N,0,null),gv(n,0)}if(function I9(t){for(let n=on(t);null!==n;n=Dn(n)){if(!(2&n[2]))continue;const e=n[9];for(let r=0;r<e.length;r++)Ve(e[r])}}(n),NL(n),LL(n,0),null!==t.contentQueries&&TO(t,n),x){const N=t.contentCheckHooks;null!==N&&cm(n,N)}else{const N=t.contentHooks;null!==N&&um(n,N,1),gv(n,1)}!function A9(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const i=e[r];if(i<0)ed(~i);else{const o=i,a=e[++r],c=e[++r];Hg(a,o);const f=n[o];wr(Dt.HostBindingsUpdateStart,f);try{c(2,f)}finally{wr(Dt.HostBindingsUpdateEnd,f)}}}}finally{ed(-1)}}(t,n);const C=t.components;null!==C&&BL(n,C,0);const A=t.viewQuery;if(null!==A&&WT(2,A,r),x){const N=t.viewCheckHooks;null!==N&&cm(n,N)}else{const N=t.viewHooks;null!==N&&um(n,N,2),gv(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[22]){for(const N of n[22])N();n[22]=null}ML(n),n[2]&=-73}catch(x){throw Ct(n),x}finally{null!==_&&(Ia(_,f),c&&function x9(t){t.lView[24]!==t&&(t.lView=null,RL.push(t))}(_)),rm()}}function LL(t,n){for(let e=on(t);null!==e;e=Dn(e))for(let r=10;r<e.length;r++)FL(e[r],n)}function k9(t,n,e){wr(Dt.ComponentStart);const r=le(n,t);try{FL(r,e)}finally{wr(Dt.ComponentEnd,r[8])}}function FL(t,n){we(t)&&bS(t,n)}function bS(t,n){const r=t[1],i=t[2],o=t[24];let a=!!(0===n&&16&i);if(a||=!!(64&i&&0===n),a||=!!(1024&i),a||=!(!o?.dirty||!zi(o)),a||=!1,o&&(o.dirty=!1),t[2]&=-9217,a)OL(r,t,r.template,t[8]);else if(8192&i){const c=St(null);try{NL(t),LL(t,1);const f=r.components;null!==f&&BL(t,f,1),ML(t)}finally{St(c)}}}function BL(t,n,e){for(let r=0;r<n.length;r++)k9(t,n[r],e)}function L_(t,n){const e=dc()?64:1088;for(t[10].changeDetectionScheduler?.notify(n);t;){t[2]|=e;const r=gn(t);if(ms(t)&&!r)return t;t=r}return null}function VL(t,n,e,r){return[t,!0,0,n,null,r,null,e,null,null]}function UL(t,n){const e=10+n;if(e<t.length)return t[e]}function F_(t,n,e,r=!0){const i=n[1];if(function M9(t,n,e,r){const i=10+r,o=e.length;r>0&&(e[i-1][4]=n),r<o-10?(n[4]=e[i],qu(e,10+r,n)):(e.push(n),n[4]=null),n[3]=e;const a=n[16];null!==a&&e!==a&&zL(a,n);const c=n[18];null!==c&&c.insertView(t),ct(n),n[2]|=128}(i,n,t,e),r){const a=Jx(e,t),c=n[11],f=c.parentNode(t[7]);null!==f&&function QW(t,n,e,r,i,o){r[0]=i,r[5]=n,e1(t,r,e,1,i,o)}(i,t[5],c,n,f,a)}const o=n[6];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function wS(t,n){const e=qv(t,n);return void 0!==e&&Hv(e[1],e),e}function qv(t,n){if(t.length<=10)return;const e=10+n,r=t[e];if(r){const i=r[16];null!==i&&i!==t&&dS(i,r),n>0&&(t[e-1][4]=r[4]);const o=ds(t,10+n);!function gL(t,n){_L(t,n),n[0]=null,n[5]=null}(r[1],r);const a=o[18];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function zL(t,n){const e=t[9],r=n[3];(Cn(r)||n[15]!==r[3][15])&&(t[2]|=2),null===e?t[9]=[n]:e.push(n)}class Gv{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){const n=this._lView,e=n[1];return $v(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return Vs(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Eo(n)){const e=n[8],r=e?e.indexOf(this):-1;r>-1&&(qv(n,r),ds(e,r))}this._attachedToViewContainer=!1}Hv(this._lView[1],this._lView)}onDestroy(n){kt(this._lView,n)}markForCheck(){L_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[2]&=-129}reattach(){ct(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,l1(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ue(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const n=ms(this._lView),e=this._lView[16];null!==e&&!n&&dS(e,this._lView),_L(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ue(902,!1);this._appRef=n;const e=ms(this._lView),r=this._lView[16];null!==r&&!e&&zL(r,this._lView),ct(this._lView)}}let Ml=(()=>class t{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=R9;constructor(e,r,i){this._declarationLView=e,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,r){return this.createEmbeddedViewImpl(e,r)}createEmbeddedViewImpl(e,r,i){const o=O_(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:r,dehydratedView:i});return new Gv(o)}})();function R9(){return c1(Qt(),Le())}function c1(t,n){return 4&t.type?new Ml(n,t,ph(t,n)):null}function Pm(t,n,e,r,i){let o=t.data[n];if(null===o)o=function DS(t,n,e,r,i){const o=Qc(),a=Jc(),f=t.data[n]=function z9(t,n,e,r,i,o){let a=n?n.injectorIndex:-1,c=0;return vi()&&(c|=128),{type:e,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:c,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,e,n,r,i);return function U9(t,n,e,r){null===t.firstChild&&(t.firstChild=n),null!==e&&(r?null==e.child&&null!==n.parent&&(e.child=n):null===e.next&&(e.next=n,n.prev=e))}(t,f,o,a),f}(t,n,e,r,i),function Pf(){return et.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=r,o.attrs=i;const a=function pa(){const t=et.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return Us(o,!0),o}function sF(t,n){let e=0,r=t.firstChild;if(r){const i=t.data.r;for(;e<i;){const o=r.nextSibling;Uv(n,r,!1),r=o,e++}}}let EZ=class{},hF=class{};class CZ{resolveComponentFactory(n){throw new ue(917,!1)}}let _1=class{static NULL=new CZ};class Rl{}let Xa=(()=>class t{destroyNode=null;static __NG_ELEMENT_ID__=()=>function DZ(){const t=Le(),e=le(Qt().index,t);return(Cn(e)?e:t)[11]}()})(),TZ=(()=>{class t{static \u0275prov=$e({token:t,providedIn:"root",factory:()=>null})}return t})();const PS={};class V_{injector;parentInjector;constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){const i=this.injector.get(n,PS,r);return i!==PS||e===PS?i:this.parentInjector.get(n,e,r)}}function v1(t,n,e){let r=e?t.styles:null,i=e?t.classes:null,o=0;if(null!==n)for(let a=0;a<n.length;a++){const c=n[a];"number"==typeof c?o=c:1==o?i=mn(i,c):2==o&&(r=mn(r,c+": "+n[++a]+";"))}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=i:t.classesWithoutHost=i}function Ne(t,n=0){const e=Le();return null===e?Tt(t,n):bx(Qt(),e,_n(t),n)}function mF(t,n,e,r,i){const o=null===r?null:{"":-1},a=i(t,e);if(null!==a){let c=a,f=null,_=null;for(const x of a)if(null!==x.resolveHostDirectives){[c,f,_]=x.resolveHostDirectives(a);break}!function RZ(t,n,e,r,i,o,a){const c=r.length;let f=null;for(let A=0;A<c;A++){const N=r[A];null===f&&ps(N)&&(f=N,MZ(t,e,A)),fm(ru(e,n),t,N.type)}(function BZ(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n})(e,t.data.length,c),f?.viewProvidersResolver&&f.viewProvidersResolver(f);for(let A=0;A<c;A++){const N=r[A];N.providersResolver&&N.providersResolver(N)}let _=!1,x=!1,C=jv(t,n,c,null);c>0&&(e.directiveToIndex=new Map);for(let A=0;A<c;A++){const N=r[A];if(e.mergedAttrs=zf(e.mergedAttrs,N.hostAttrs),NZ(t,e,n,C,N),FZ(C,N,i),null!==a&&a.has(N)){const[ne,ce]=a.get(N);e.directiveToIndex.set(N.type,[C,ne+e.directiveStart,ce+e.directiveStart])}else(null===o||!o.has(N))&&e.directiveToIndex.set(N.type,C);null!==N.contentQueries&&(e.flags|=4),(null!==N.hostBindings||null!==N.hostAttrs||0!==N.hostVars)&&(e.flags|=64);const U=N.type.prototype;!_&&(U.ngOnChanges||U.ngOnInit||U.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),_=!0),!x&&(U.ngOnChanges||U.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),x=!0),C++}!function PZ(t,n,e){for(let r=n.directiveStart;r<n.directiveEnd;r++){const i=t.data[r];if(null!==e&&e.has(i)){const o=e.get(i);_F(0,n,o,r),_F(1,n,o,r),vF(n,r,!0)}else gF(0,n,i,r),gF(1,n,i,r),vF(n,r,!1)}}(t,e,o)}(t,n,e,c,o,f,_)}null!==o&&null!==r&&function AZ(t,n,e){const r=t.localNames=[];for(let i=0;i<n.length;i+=2){const o=e[n[i+1]];if(null==o)throw new ue(-301,!1);r.push(n[i],o)}}(e,r,o)}function MZ(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function gF(t,n,e,r){const i=0===t?e.inputs:e.outputs;for(const o in i)if(i.hasOwnProperty(o)){let a;a=0===t?n.inputs??={}:n.outputs??={},a[o]??=[],a[o].push(r),yF(n,o)}}function _F(t,n,e,r){const i=0===t?e.inputs:e.outputs;for(const o in i)if(i.hasOwnProperty(o)){const a=i[o];let c;c=0===t?n.hostDirectiveInputs??={}:n.hostDirectiveOutputs??={},c[a]??=[],c[a].push(r,o),yF(n,a)}}function yF(t,n){"class"===n?t.flags|=8:"style"===n&&(t.flags|=16)}function vF(t,n,e){const{attrs:r,inputs:i,hostDirectiveInputs:o}=t;if(null===r||!e&&null===i||e&&null===o||rS(t))return t.initialInputs??=[],void t.initialInputs.push(null);let a=null,c=0;for(;c<r.length;){const f=r[c];if(0!==f)if(5!==f){if("number"==typeof f)break;if(!e&&i.hasOwnProperty(f)){const _=i[f];for(const x of _)if(x===n){a??=[],a.push(f,r[c+1]);break}}else if(e&&o.hasOwnProperty(f)){const _=o[f];for(let x=0;x<_.length;x+=2)if(_[x]===n){a??=[],a.push(_[x+1],r[c+1]);break}}c+=2}else c+=2;else c+=4}t.initialInputs??=[],t.initialInputs.push(a)}function NZ(t,n,e,r,i){t.data[r]=i;const o=i.factory||(i.factory=za(i.type)),a=new dm(o,ps(i),Ne,null);t.blueprint[r]=a,e[r]=a,function OZ(t,n,e,r,i){const o=i.hostBindings;if(o){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const c=~n.index;(function LZ(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=c&&a.push(c),a.push(e,r,o)}}(t,n,r,jv(t,e,i.hostVars,Lr),i)}function FZ(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;ps(n)&&(e[""]=t)}}function NS(t,n,e,r,i,o,a,c){const f=n[1],_=f.consts,C=Pm(f,t,e,r,De(_,a));return o&&mF(f,n,C,De(_,c),i),C.mergedAttrs=zf(C.mergedAttrs,C.attrs),null!==C.attrs&&v1(C,C.attrs,!1),null!==C.mergedAttrs&&v1(C,C.mergedAttrs,!0),null!==f.queries&&f.queries.elementStart(f,C),C}function OS(t,n){e_(t,n),Yu(n)&&t.queries.elementEnd(n)}function pd(t,n,e){return t[n]=e}function ui(t,n,e){return e!==Lr&&(!Object.is(t[n],e)&&(t[n]=e,!0))}function Lm(t,n,e,r){const i=ui(t,n,e);return ui(t,n+1,r)||i}function Cc(t,n,e,r,i,o){const a=Lm(t,n,e,r);return Lm(t,n+2,i,o)||a}function Th(t,n,e){return function r(i){L_(uo(t)?le(t.index,n):n,5);const a=n[8];let c=xF(n,a,e,i),f=r.__ngNextListenerFn__;for(;f;)c=xF(n,a,f,i)&&c,f=f.__ngNextListenerFn__;return c}}function xF(t,n,e,r){const i=St(null);try{return wr(Dt.OutputStart,n,e),!1!==e(r)}catch(o){return function vS(t,n){const e=t[9];if(!e)return;let r;try{r=e.get(Dl,null)}catch{r=null}r?.(n)}(t,o),!1}finally{wr(Dt.OutputEnd,n,e),St(i)}}function x1(t,n,e,r,i,o,a,c){const f=Xi(t);let _=!1,x=null;if(!r&&f&&(x=function HZ(t,n,e,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===e&&i[o+1]===r){const c=n[7],f=i[o+2];return c&&c.length>f?c[f]:null}"string"==typeof a&&(o+=2)}return null}(n,e,o,t.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=a,x.__ngLastListenerFn__=a,_=!0;else{const C=$(t,e),A=r?r(C):C,N=i.listen(A,o,c);(function jZ(t){return t.startsWith("animation")||t.startsWith("transition")})(o)||EF(r?ne=>r(F(ne[t.index])):t.index,n,e,o,c,N,!1)}return _}function EF(t,n,e,r,i,o,a){const c=n.firstCreatePass?Xt(n):null,f=ft(e),_=f.length;f.push(i,o),c&&c.push(r,t,_,(_+1)*(a?-1:1))}function U_(t,n,e,r,i,o){const c=n[1],C=n[e][c.data[e].outputs[r]].subscribe(o);EF(t.index,c,n,i,o,C,!0)}const Sh=Symbol("BINDING");class TF extends _1{ngModule;constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=cn(n);return new rb(e,this.ngModule)}}class rb extends hF{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function XZ(t){return Object.keys(t).map(n=>{const[e,r,i]=t[n],o={propName:e,templateName:n,isSignal:0!==(r&Kx.SignalBased)};return i&&(o.transform=i),o})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function QZ(t){return Object.keys(t).map(n=>({propName:t[n],templateName:n}))}(this.componentDef.outputs),this.cachedOutputs}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function BW(t){return t.map(FW).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors??[],this.isBoundToModule=!!e}create(n,e,r,i,o,a){wr(Dt.DynamicComponentStart);const c=St(null);try{const f=this.componentDef,_=function rK(t,n,e,r){const i=t?["ng-version","21.1.2"]:function VW(t){const n=[],e=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&n.push(o,t[++r]):8===i&&e.push(o);else{if(!du(i))break;i=o}r++}return e.length&&n.push(1,...e),n}(n.selectors[0]);let o=null,a=null,c=0;if(e)for(const x of e)c+=x[Sh].requiredVars,x.create&&(x.targetIdx=0,(o??=[]).push(x)),x.update&&(x.targetIdx=0,(a??=[]).push(x));if(r)for(let x=0;x<r.length;x++){const C=r[x];if("function"!=typeof C)for(const A of C.bindings){c+=A[Sh].requiredVars;const N=x+1;A.create&&(A.targetIdx=N,(o??=[]).push(A)),A.update&&(A.targetIdx=N,(a??=[]).push(A))}}const f=[n];if(r)for(const x of r){const A=ai("function"==typeof x?x:x.type);f.push(A)}return iS(0,null,function iK(t,n){return t||n?e=>{if(1&e&&t)for(const r of t)r.create();if(2&e&&n)for(const r of n)r.update()}:null}(o,a),1,c,f,null,null,null,[i],null)}(r,f,a,o),x=function JZ(t,n,e){let r=n instanceof $r?n:n?.injector;return r&&null!==t.getStandaloneInjector&&(r=t.getStandaloneInjector(r)||r),r?new V_(e,r):e}(f,i||this.ngModule,n),C=function eK(t){const n=t.get(Rl,null);if(null===n)throw new ue(407,!1);return{rendererFactory:n,sanitizer:t.get(TZ,null),changeDetectionScheduler:t.get(Lf,null),ngReflect:!1}}(x),A=C.rendererFactory.createRenderer(null,f),N=r?function s9(t,n,e,r){const o=r.get(vm,!1)||e===Ec.ShadowDom||e===Ec.ExperimentalIsolatedShadowDom,a=t.selectRootElement(n,o);return function a9(t){SL(t)}(a),a}(A,r,f.encapsulation,x):function tK(t,n){const e=function nK(t){return(t.selectors[0][0]||"div").toLowerCase()}(t);return Gx(n,e,"svg"===e?"svg":"math"===e?"math":null)}(f,A),U=a?.some(SF)||o?.some(xe=>"function"!=typeof xe&&xe.bindings.some(SF)),ne=Zx(null,_,null,512|oS(f),null,null,C,A,x,null,null);ne[27]=N,qg(ne);let ce=null;try{const xe=NS(27,ne,2,"#host",()=>_.directiveRegistry,!0,0);ZO(A,N,xe),ve(N,ne),t1(_,ne,xe),ZT(_,xe,ne),OS(_,xe),void 0!==e&&function sK(t,n,e){const r=t.projection=[];for(let i=0;i<n.length;i++){const o=e[i];r.push(null!=o&&o.length?Array.from(o):null)}}(xe,this.ngContentSelectors,e),ce=le(xe.index,ne),ne[8]=ce[8],a1(_,ne,null)}catch(xe){throw null!==ce&&z(ce),z(ne),xe}finally{wr(Dt.DynamicComponentEnd),rm()}return new oK(this.componentType,ne,!!U)}finally{St(c)}}}function SF(t){const n=t[Sh].kind;return"input"===n||"twoWay"===n}class oK extends EZ{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(n,e,r){super(),this._rootLView=e,this._hasInputBindings=r,this._tNode=re(e[1],27),this.location=ph(this._tNode,e),this.instance=le(this._tNode.index,e)[8],this.hostView=this.changeDetectorRef=new Gv(e,void 0),this.componentType=n}setInput(n,e){const r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const i=this._rootLView;s1(r,i[1],i,n,e),this.previousInputValues.set(n,e),L_(le(r.index,i),1)}get injector(){return new ci(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}let Pl=(()=>class t{static __NG_ELEMENT_ID__=aK})();function aK(){return AF(Qt(),Le())}const lK=Pl,IF=class extends lK{_lContainer;_hostTNode;_hostLView;constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return ph(this._hostTNode,this._hostLView)}get injector(){return new ci(this._hostTNode,this._hostLView)}get parentInjector(){const n=o_(this._hostTNode,this._hostLView);if(ad(n)){const e=dh(n,this._hostLView),r=uh(n);return new ci(e[1].data[r+8],e)}return new ci(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=kF(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,r){let i,o;"number"==typeof r?i=r:null!=r&&(i=r.index,o=r.injector);const c=n.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(c,i,Rm(this._hostTNode,null)),c}createComponent(n,e,r,i,o,a,c){const f=n&&!function id(t){return"function"==typeof t}(n);let _;if(f)_=e;else{const ce=e||{};_=ce.index,r=ce.injector,i=ce.projectableNodes,o=ce.environmentInjector||ce.ngModuleRef,a=ce.directives,c=ce.bindings}const x=f?n:new rb(cn(n)),C=r||this.parentInjector;if(!o&&null==x.ngModule){const xe=(f?C:this.parentInjector).get($r,null);xe&&(o=xe)}cn(x.componentType??{});const ne=x.create(C,i,null,o,a,c);return this.insertImpl(ne.hostView,_,Rm(this._hostTNode,null)),ne}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,r){const i=n._lView;if(function Ae(t){return Eo(t[3])}(i)){const c=this.indexOf(n);if(-1!==c)this.detach(c);else{const f=i[3],_=new IF(f,f[5],f[3]);_.detach(_.indexOf(n))}}const o=this._adjustIndex(e),a=this._lContainer;return F_(a,i,o,r),n.attachToViewContainerRef(),qu(FS(a),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=kF(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),r=qv(this._lContainer,e);r&&(ds(FS(this._lContainer),e),Hv(r[1],r))}detach(n){const e=this._adjustIndex(n,-1),r=qv(this._lContainer,e);return r&&null!=ds(FS(this._lContainer),e)?new Gv(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function kF(t){return t[8]}function FS(t){return t[8]||(t[8]=[])}function AF(t,n){let e;const r=n[t.index];return Eo(r)?e=r:(e=VL(r,n,null,t),n[t.index]=e,sS(n,e)),MF(e,n,t,r),new IF(e,t,n)}let MF=function PF(t,n,e,r){if(t[7])return;let i;i=8&e.type?F(r):function cK(t,n){const e=t[11],r=e.createComment(""),i=$(n,t),o=e.parentNode(i);return Im(e,o,r,e.nextSibling(i),!1),r}(n,e),t[7]=i};class VS{queryList;matches=null;constructor(n){this.queryList=n}clone(){return new VS(this.queryList)}setDirty(){this.queryList.setDirty()}}class US{queries;constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const r=null!==n.contentQueries?n.contentQueries[0]:e.length,i=[];for(let o=0;o<r;o++){const a=e.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new US(i)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==qS(n,e).matches&&this.queries[e].setDirty()}}class NF{flags;read;predicate;constructor(n,e,r=null){this.flags=e,this.read=r,this.predicate="string"==typeof n?function gK(t){return t.split(",").map(n=>n.trim())}(n):n}}class zS{queries;constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){const i=null!==e?e.length:0,o=this.getByIndex(r).embeddedTView(n,i);o&&(o.indexInDeclarationView=r,null!==e?e.push(o):e=[o])}return null!==e?new zS(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class jS{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(n,e=-1){this.metadata=n,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new jS(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];this.matchTNodeWithReadOption(n,e,hK(e,o)),this.matchTNodeWithReadOption(n,e,s_(e,n,o,!1,!1))}else r===Ml?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,s_(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Ur||i===Pl||i===Ml&&4&e.type)this.addMatch(e.index,-2);else{const o=s_(e,n,i,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,r)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function hK(t,n){const e=t.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1];return null}function pK(t,n,e,r){return-1===e?function fK(t,n){return 11&t.type?ph(t,n):4&t.type?c1(t,n):null}(n,t):-2===e?function mK(t,n,e){return e===Ur?ph(n,t):e===Ml?c1(n,t):e===Pl?AF(n,t):void 0}(t,n,r):Hf(t,t[1],e,n)}function OF(t,n,e,r){const i=n[18].queries[r];if(null===i.matches){const o=t.data,a=e.matches,c=[];for(let f=0;null!==a&&f<a.length;f+=2){const _=a[f];c.push(_<0?null:pK(n,o[_],a[f+1],e.metadata.read))}i.matches=c}return i.matches}function HS(t,n,e,r){const i=t.queries.getByIndex(e),o=i.matches;if(null!==o){const a=OF(t,n,i,e);for(let c=0;c<o.length;c+=2){const f=o[c];if(f>0)r.push(a[c/2]);else{const _=o[c+1],x=n[-f];for(let C=10;C<x.length;C++){const A=x[C];A[16]===A[3]&&HS(A[1],A,_,r)}if(null!==x[9]){const C=x[9];for(let A=0;A<C.length;A++){const N=C[A];HS(N[1],N,_,r)}}}}}return r}function LF(t,n,e){const r=new cd(!(4&~e));return function hn(t,n,e,r){const i=ft(n);i.push(e),t.firstCreatePass&&Xt(t).push(r,i.length-1)}(t,n,r,r.destroy),(n[18]??=new US).queries.push(new VS(r))-1}function VF(t,n,e){null===t.queries&&(t.queries=new zS),t.queries.track(new jS(n,e))}function qS(t,n){return t.queries.getByIndex(n)}function UF(t,n){const e=t[1],r=qS(e,n);return r.crossesNgTemplate?HS(e,t,n,[]):OF(e,t,r,n)}let Ih=class{},GF=class{};class YS extends Ih{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new TF(this);constructor(n,e,r,i=!0){super(),this.ngModuleType=n,this._parent=e;const o=us(n);this._bootstrapComponents=fd(o.bootstrap),this._r3Injector=$w(n,e,[{provide:Ih,useValue:this},{provide:_1,useValue:this.componentFactoryResolver},...r],En(n),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class WF extends GF{moduleType;constructor(n){super(),this.moduleType=n}create(n){return new YS(this.moduleType,n,[])}}class ZF extends Ih{injector;componentFactoryResolver=new TF(this);instance=null;constructor(n){super();const e=new da([...n.providers,{provide:Ih,useValue:this},{provide:_1,useValue:this.componentFactoryResolver}],n.parent||sc(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function E1(t,n,e=null){return new ZF({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}let DK=(()=>{class t{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const r=Yc(0,e.type),i=r.length>0?E1([r],this._injector,""):null;this.cachedInjectors.set(e,i)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=$e({token:t,providedIn:"environment",factory:()=>new t(Tt($r))})}return t})();function gr(t){return pc(()=>{const n=YF(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===E.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:n.standalone?i=>i.get(DK).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Ec.Emulated,styles:t.styles||Pr,_:null,schemas:t.schemas||null,tView:null,id:""};n.standalone&&ns("NgStandalone"),XF(e);const r=t.dependencies;return e.directiveDefs=C1(r,KF),e.pipeDefs=C1(r,lo),e.id=function kK(t){let n=0;const r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,"function"==typeof t.consts?"":t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(const o of r.join("|"))n=Math.imul(31,n)+o.charCodeAt(0)|0;return n+=2147483648,"c"+n}(e),e})}function KF(t){return cn(t)||ai(t)}function Ao(t){return pc(()=>({type:t.type,bootstrap:t.bootstrap||Pr,declarations:t.declarations||Pr,imports:t.imports||Pr,exports:t.exports||Pr,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function TK(t,n){if(null==t)return Ls;const e={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r];let o,a,c,f;Array.isArray(i)?(c=i[0],o=i[1],a=i[2]??o,f=i[3]||null):(o=i,a=i,c=Kx.None,f=null),e[o]=[r,c,f],n[o]=a}return e}function SK(t){if(null==t)return Ls;const n={};for(const e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}function Ft(t){return pc(()=>{const n=YF(t);return XF(n),n})}function Qa(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:t.standalone??!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function YF(t){const n={};return{type:t.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputConfig:t.inputs||Ls,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:!0===t.signals,selectors:t.selectors||Pr,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:TK(t.inputs,n),outputs:SK(t.outputs),debugInfo:null}}function XF(t){t.features?.forEach(n=>n(t))}function C1(t,n){return t?()=>{const e="function"==typeof t?t():t,r=[];for(const i of e){const o=n(i);null!==o&&r.push(o)}return r}:null}function Yn(t){let n=function RK(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const r=[t];for(;n;){let i;if(ps(t))i=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ue(903,!1);i=n.\u0275dir}if(i){if(e){r.push(i);const a=t;a.inputs=QS(t.inputs),a.declaredInputs=QS(t.declaredInputs),a.outputs=QS(t.outputs);const c=i.hostBindings;c&&FK(t,c);const f=i.viewQuery,_=i.contentQueries;if(f&&OK(t,f),_&&LK(t,_),PK(t,i),Br(t.outputs,i.outputs),ps(i)&&i.data.animation){const x=t.data;x.animation=(x.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let a=0;a<o.length;a++){const c=o[a];c&&c.ngInherit&&c(t),c===Yn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function NK(t){let n=0,e=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=n+=i.hostVars,i.hostAttrs=zf(i.hostAttrs,e=zf(e,i.hostAttrs))}}(r)}function PK(t,n){for(const e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;const r=n.inputs[e];void 0!==r&&(t.inputs[e]=r,t.declaredInputs[e]=n.declaredInputs[e])}}function QS(t){return t===Ls?{}:t===Pr?[]:t}function OK(t,n){const e=t.viewQuery;t.viewQuery=e?(r,i)=>{n(r,i),e(r,i)}:n}function LK(t,n){const e=t.contentQueries;t.contentQueries=e?(r,i,o)=>{n(r,i,o),e(r,i,o)}:n}function FK(t,n){const e=t.hostBindings;t.hostBindings=e?(r,i)=>{n(r,i),e(r,i)}:n}function rB(t,n,e,r,i,o,a,c){if(e.firstCreatePass){t.mergedAttrs=zf(t.mergedAttrs,t.attrs);const x=t.tView=iS(2,t,i,o,a,e.directiveRegistry,e.pipeRegistry,null,e.schemas,e.consts,null);null!==e.queries&&(e.queries.template(e,t),x.queries=e.queries.embeddedTView(t))}c&&(t.flags|=c),Us(t,!1);const f=oB(e,n,t,r);Gg()&&mS(e,n,f,t),ve(f,n);const _=VL(f,n,f,t);n[r+27]=_,sS(n,_)}function Bm(t,n,e,r,i,o,a,c,f,_,x){const C=e+27;let A;if(n.firstCreatePass){if(A=Pm(n,C,4,a||null,c||null),null!=_){const N=De(n.consts,_);A.localNames=[];for(let U=0;U<N.length;U+=2)A.localNames.push(N[U],-1)}}else A=n.data[C];return rB(A,t,n,e,r,i,o,f),null!=_&&N_(t,A,x),A}function ob(t,n,e,r,i,o,a,c){const f=Le(),_=$t();return function BK(t,n,e,r,i,o,a,c,f,_,x){const C=e+27;let A;n.firstCreatePass?(A=Pm(n,C,4,a||null,c||null),ho()&&mF(n,t,A,De(n.consts,_),yS),e_(n,A)):A=n.data[C],rB(A,t,n,e,r,i,o,f),Xi(A)&&t1(n,t,A),null!=_&&N_(t,A,x)}(f,_,t,n,e,r,i,De(_.consts,o),void 0,a,c),ob}let oB=function sB(t,n,e,r){return im(!0),n[11].createComment("")};let vB=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function xB(t){return function wB(t){return"function"==typeof t&&void 0!==t[He]}(t)&&"function"==typeof t.set}const FB=new Ue("");function ub(t){return!!t&&"function"==typeof t.then}function VB(t){return!!t&&"function"==typeof t.subscribe}const UB=new Ue("");function aI(t){return Ha([{provide:UB,multi:!0,useValue:t}])}let zB=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,r)=>{this.resolve=e,this.reject=r});appInits=Q(UB,{optional:!0})??[];injector=Q(An);constructor(){}runInitializers(){if(this.initialized)return;const e=[];for(const i of this.appInits){const o=qi(this.injector,i);if(ub(o))e.push(o);else if(VB(o)){const a=new Promise((c,f)=>{o.subscribe({complete:c,error:f})});e.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{r()}).catch(i=>{this.reject(i)}),0===e.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const lI=new Ue("");let tl=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Q(Dl);afterRenderManager=Q(uL);zonelessEnabled=Q(nd);rootEffectScheduler=Q(Jw);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new ee;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=Q(Ga);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(mr(e=>!e))}constructor(){Q(R_,{optional:!0})}whenStable(){let e;return new Promise(r=>{e=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{e.unsubscribe()})}_injector=Q($r);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,r){return this.bootstrapImpl(e,r)}bootstrapImpl(e,r,i=An.NULL){return this._injector.get(sn).run(()=>{wr(Dt.BootstrapComponentStart);const a=e instanceof hF;if(!this._injector.get(zB).done)throw new ue(405,"");let f;f=a?e:this._injector.get(_1).resolveComponentFactory(e),this.componentTypes.push(f.componentType);const _=function ZY(t){return t.isBoundToModule}(f)?void 0:this._injector.get(Ih),C=f.create(i,[],r||f.selector,_),A=C.location.nativeElement,N=C.injector.get(FB,null);return N?.registerApplication(A),C.onDestroy(()=>{this.detachView(C.hostView),R1(this.components,C),N?.unregisterApplication(A)}),this._loadComponent(C),wr(Dt.BootstrapComponentEnd,C),C})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){wr(Dt.ChangeDetectionStart),null!==this.tracingSnapshot?this.tracingSnapshot.run(cS.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw wr(Dt.ChangeDetectionEnd),new ue(101,!1);const e=St(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,St(e),this.afterTick.next(),wr(Dt.ChangeDetectionEnd)}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Rl,null,{optional:!0}));let e=0;for(;0!==this.dirtyFlags&&e++<10;){wr(Dt.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{wr(Dt.ChangeDetectionSyncEnd)}}}synchronizeOnce(){16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let e=!1;if(7&this.dirtyFlags){const r=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews)(r||We(i))&&(l1(i,r&&!this.zonelessEnabled?0:1),e=!0);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}e||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:e})=>We(e))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;R1(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(e),this._injector.get(lI,[]).forEach(i=>i(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>R1(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ue(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function R1(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function na(t,n,e,r){const i=Le();return ui(i,Qi(),n)&&($t(),function f9(t,n,e,r,i,o){const a=$(t,n);!function r1(t,n,e,r,i,o,a){if(null==o)t.removeAttribute(n,i,e);else{const c=null==a?nn(o):a(o,r||"",i);t.setAttribute(n,i,c,e)}}(n[11],a,o,t.value,e,r,i)}(zo(),i,t,n,e,r)),na}typeof document<"u"&&document;Object.keys({disabled:"disabled",disabledReasons:"disabledReasons",dirty:"dirty",errors:"errors",hidden:"hidden",invalid:"invalid",max:"max",maxLength:"maxLength",min:"min",minLength:"minLength",name:"name",pattern:"pattern",pending:"pending",readonly:"readonly",required:"required",touched:"touched"});class bQ{destroy(n){}updateValue(n,e){}swap(n,e){const r=Math.min(n,e),i=Math.max(n,e),o=this.detach(i);if(i-r>1){const a=this.detach(r);this.attach(r,o),this.attach(i,a)}else this.attach(r,o)}move(n,e){this.attach(e,this.detach(n))}}function EI(t,n,e,r,i){return t===e&&Object.is(n,r)?1:Object.is(i(t,n),i(e,r))?-1:0}function CI(t,n,e,r){return!(void 0===n||!n.has(r)||(t.attach(e,n.get(r)),n.delete(r),0))}function d3(t,n,e,r,i){if(CI(t,n,r,e(r,i)))t.updateValue(r,i);else{const o=t.create(r,i);t.attach(r,o)}}function h3(t,n,e,r){const i=new Set;for(let o=n;o<=e;o++)i.add(r(o,t.at(o)));return i}class f3{kvMap=new Map;_vMap=void 0;has(n){return this.kvMap.has(n)}delete(n){if(!this.has(n))return!1;const e=this.kvMap.get(n);return void 0!==this._vMap&&this._vMap.has(e)?(this.kvMap.set(n,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(n),!0}get(n){return this.kvMap.get(n)}set(n,e){if(this.kvMap.has(n)){let r=this.kvMap.get(n);void 0===this._vMap&&(this._vMap=new Map);const i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,e)}else this.kvMap.set(n,e)}forEach(n){for(let[e,r]of this.kvMap)if(n(r,e),void 0!==this._vMap){const i=this._vMap;for(;i.has(r);)r=i.get(r),n(r,e)}}}function ot(t,n,e,r,i,o,a,c){ns("NgControlFlow");const f=Le(),_=$t();return Bm(f,_,t,n,e,r,i,De(_.consts,o),256,a,c),DI}function DI(t,n,e,r,i,o,a,c){ns("NgControlFlow");const f=Le(),_=$t();return Bm(f,_,t,n,e,r,i,De(_.consts,o),512,a,c),DI}function st(t,n){ns("NgControlFlow");const e=Le(),r=Qi(),i=e[r]!==Lr?e[r]:-1,o=-1!==i?H1(e,27+i):void 0;if(ui(e,r,t)){const c=St(null);try{if(void 0!==o&&wS(o,0),-1!==t){const f=27+t,_=H1(e,f),x=TI(e[1],f),C=null;F_(_,O_(e,x,n,{dehydratedView:C}),0,Rm(x,C))}}finally{St(c)}}else if(void 0!==o){const c=UL(o,0);void 0!==c&&(c[8]=n)}}class xQ{lContainer;$implicit;$index;constructor(n,e,r){this.lContainer=n,this.$implicit=e,this.$index=r}get $count(){return this.lContainer.length-10}}function hb(t){return t}function nl(t,n){return n}class EQ{hasEmptyBlock;trackByFn;liveCollection;constructor(n,e,r){this.hasEmptyBlock=n,this.trackByFn=e,this.liveCollection=r}}function On(t,n,e,r,i,o,a,c,f,_,x,C,A){ns("NgControlFlow");const N=Le(),U=$t(),ne=void 0!==f,ce=Le(),xe=c?a.bind(ce[15][8]):a,Ce=new EQ(ne,xe);ce[27+t]=Ce,Bm(N,U,t+1,n,e,r,i,De(U.consts,o),256),ne&&Bm(N,U,t+2,f,_,x,C,De(U.consts,A),512)}class CQ extends bQ{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(n,e,r){super(),this.lContainer=n,this.hostLView=e,this.templateTNode=r}get length(){return this.lContainer.length-10}at(n){return this.getLView(n)[8].$implicit}attach(n,e){const r=e[6];this.needsIndexUpdate||=n!==this.length,F_(this.lContainer,e,n,Rm(this.templateTNode,r)),function DQ(t,n){if(t.length<=10)return;const r=t[10+n],i=r?r[26]:void 0;r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0&&(function YW(t,n){const e=t.get(Xx);if(n.detachedLeaveAnimationFns){for(const r of n.detachedLeaveAnimationFns)e.queue.delete(r);n.detachedLeaveAnimationFns=void 0}}(r[9],i),Am.delete(r[19]),i.detachedLeaveAnimationFns=void 0)}(this.lContainer,n)}detach(n){return this.needsIndexUpdate||=n!==this.length-1,function TQ(t,n){if(t.length<=10)return;const r=t[10+n],i=r?r[26]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}(this.lContainer,n),function SQ(t,n){return qv(t,n)}(this.lContainer,n)}create(n,e){return O_(this.hostLView,this.templateTNode,new xQ(this.lContainer,e,n),{dehydratedView:null})}destroy(n){Hv(n[1],n)}updateValue(n,e){this.getLView(n)[8].$implicit=e}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let n=0;n<this.length;n++)this.getLView(n)[8].$index=n}getLView(n){return function IQ(t,n){return UL(t,n)}(this.lContainer,n)}}function Ln(t){const n=St(null),e=fo();try{const r=Le(),i=r[1],o=r[e],a=e+1,c=H1(r,a);if(void 0===o.liveCollection){const _=TI(i,a);o.liveCollection=new CQ(c,r,_)}else o.liveCollection.reset();const f=o.liveCollection;if(function wQ(t,n,e,r){let i,o,a=0,c=t.length-1;if(Array.isArray(n)){St(r);let _=n.length-1;for(St(null);a<=c&&a<=_;){const x=t.at(a),C=n[a],A=EI(a,x,a,C,e);if(0!==A){A<0&&t.updateValue(a,C),a++;continue}const N=t.at(c),U=n[_],ne=EI(c,N,_,U,e);if(0!==ne){ne<0&&t.updateValue(c,U),c--,_--;continue}const ce=e(a,x),xe=e(c,N),Ce=e(a,C);if(Object.is(Ce,xe)){const Ze=e(_,U);Object.is(Ze,ce)?(t.swap(a,c),t.updateValue(c,U),_--,c--):t.move(c,a),t.updateValue(a,C),a++;continue}if(i??=new f3,o??=h3(t,a,c,e),CI(t,i,a,Ce))t.updateValue(a,C),a++,c++;else if(o.has(Ce))i.set(ce,t.detach(a)),c--;else{const Ze=t.create(a,n[a]);t.attach(a,Ze),a++,c++}}for(;a<=_;)d3(t,i,e,a,n[a]),a++}else if(null!=n){St(r);const _=n[Symbol.iterator]();St(null);let x=_.next();for(;!x.done&&a<=c;){const C=t.at(a),A=x.value,N=EI(a,C,a,A,e);if(0!==N)N<0&&t.updateValue(a,A),a++,x=_.next();else{i??=new f3,o??=h3(t,a,c,e);const U=e(a,A);if(CI(t,i,a,U))t.updateValue(a,A),a++,c++,x=_.next();else if(o.has(U)){const ne=e(a,C);i.set(ne,t.detach(a)),c--}else t.attach(a,t.create(a,A)),a++,c++,x=_.next()}}for(;!x.done;)d3(t,i,e,t.length,x.value),x=_.next()}for(;a<=c;)t.destroy(t.detach(c--));i?.forEach(_=>{t.destroy(_)})}(f,t,o.trackByFn,n),f.updateIndexes(),o.hasEmptyBlock){const _=Qi(),x=0===f.length;if(ui(r,_,x)){const C=e+2,A=H1(r,C);if(x){const N=TI(i,C),U=null;F_(A,O_(r,N,void 0,{dehydratedView:U}),0,Rm(N,U))}else i.firstUpdatePass&&function p1(t){const n=t[6]??[],r=t[3][11],i=[];for(const o of n)void 0!==o.data.di?i.push(o):sF(o,r);t[6]=i}(A),wS(A,0)}}}finally{St(n)}}function H1(t,n){return t[n]}function TI(t,n){return re(t,n)}function pn(t,n,e){const r=Le();return ui(r,Qi(),n)&&($t(),n1(zo(),r,t,n,r[11],e)),pn}function SI(t,n,e,r,i){s1(n,t,e,i?"class":"style",r)}function O(t,n,e,r){const i=Le(),o=i[1],a=t+27,c=o.firstCreatePass?NS(a,i,2,n,yS,ho(),e,r):o.data[a];if(i1(c,i,t,n,II),Xi(c)){const f=i[1];t1(f,i,c),ZT(f,c,i)}return null!=r&&N_(i,c),O}function V(){const t=$t(),e=o1(Qt());return t.firstCreatePass&&OS(t,e),bi(e)&&Co(),qr(),null!=e.classesWithoutHost&&function t_(t){return!!(8&t.flags)}(e)&&SI(t,e,Le(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function hx(t){return!!(16&t.flags)}(e)&&SI(t,e,Le(),e.stylesWithoutHost,!1),V}function ut(t,n,e,r){return O(t,n,e,r),V(),ut}function Yt(t,n,e,r){const i=Le(),o=i[1],a=t+27,c=o.firstCreatePass?function bF(t,n,e,r,i,o){const a=n.consts,f=Pm(n,t,e,r,De(a,i));if(f.mergedAttrs=zf(f.mergedAttrs,f.attrs),null!=o){const _=De(a,o);f.localNames=[];for(let x=0;x<_.length;x+=2)f.localNames.push(_[x],-1)}return null!==f.attrs&&v1(f,f.attrs,!1),null!==f.mergedAttrs&&v1(f,f.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,f),f}(a,o,2,n,e,r):o.data[a];return i1(c,i,t,n,II),null!=r&&N_(i,c),Yt}function Gt(){return bi(o1(Qt()))&&Co(),qr(),Gt}function md(t,n,e,r){return Yt(t,n,e,r),Gt(),md}let II=(t,n,e,r,i)=>(im(!0),Gx(n[11],r,function yT(){return et.lFrame.currentNamespace}()));function Ut(){return Le()}function fb(t,n,e){const r=Le();return ui(r,Qi(),n)&&($t(),_S(zo(),r,t,n,r[11],e)),fb}const pb=void 0;var RQ=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202fa","h:mm:ss\u202fa","h:mm:ss\u202fa z","h:mm:ss\u202fa zzzz"],["{1}, {0}",pb,pb,pb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function MQ(t){const n=Math.floor(Math.abs(t)),e=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===e?1:5}];let Y_={};function va(t){const n=function NQ(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=v3(n);if(e)return e;const r=n.split("-")[0];if(e=v3(r),e)return e;if("en"===r)return RQ;throw new ue(701,!1)}function v3(t){return t in Y_||(Y_[t]=ln.ng&&ln.ng.common&&ln.ng.common.locales&&ln.ng.common.locales[t]),Y_[t]}var xi=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(xi||{});const q1="en-US";let b3=q1;function Pe(t,n,e){const r=Le(),i=$t(),o=Qt();return NI(i,r,r[11],o,t,n,e),Pe}function ba(t,n,e){const r=Le(),i=$t(),o=Qt();return(3&o.type||e)&&x1(o,i,r,e,r[11],t,n,Th(o,r,n)),ba}function NI(t,n,e,r,i,o,a){let c=!0,f=null;if((3&r.type||a)&&(f??=Th(r,n,o),x1(r,t,n,a,e,i,o,f)&&(c=!1)),c){const _=r.outputs?.[i],x=r.hostDirectiveOutputs?.[i];if(x&&x.length)for(let C=0;C<x.length;C+=2){const A=x[C],N=x[C+1];f??=Th(r,n,o),U_(r,n,A,N,i,f)}if(_&&_.length)for(const C of _)f??=Th(r,n,o),U_(r,n,C,i,i,f)}}function ge(t=1){return function mT(t){return(et.lFrame.contextLView=function Qe(t,n){for(;t>0;)n=n[14],t--;return n}(t,et.lFrame.contextLView))[8]}(t)}function wJ(t,n){let e=null;const r=function PW(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let i=0;i<n.length;i++){const o=n[i];if("*"!==o){if(null===r?nL(t,o,!0):LW(r,o))return i}else e=i}return e}function K1(t,n=0,e,r,i,o){const a=Le(),c=$t(),f=r?t+1:null;null!==f&&Bm(a,c,f,r,i,o,null,e);const _=Pm(c,27+t,16,null,e||null);null===_.projection&&(_.projection=n),ma();const C=!a[6]||vi();null===a[15][5].projection[_.projection]&&null!==f?function xJ(t,n,e){const r=27+e,i=n.data[r],o=t[r];F_(o,O_(t,i,void 0,{dehydratedView:null}),0,Rm(i,null))}(a,c,f):C&&!wh(_)&&function r9(t,n,e){DL(n[11],0,n,e,fS(t,e,n),bL(e.parent||n[5],e,n))}(c,a,_)}function OI(t,n,e,r){return function BF(t,n,e,r){const i=$t();if(i.firstCreatePass){const o=Qt();VF(i,new NF(n,e,r),o.index),function _K(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(i,t),!(2&~e)&&(i.staticContentQueries=!0)}return LF(i,Le(),e)}(t,n,e,r),OI}function dp(t,n,e){return function FF(t,n,e){const r=$t();return r.firstCreatePass&&(VF(r,new NF(t,n,e),-1),!(2&~n)&&(r.staticViewQueries=!0)),LF(r,Le(),n)}(t,n,e),dp}function gd(t){const n=Le(),e=$t(),r=nm();hc(r+1);const i=qS(e,r);if(t.dirty&&function _e(t){return!(4&~t[2])}(n)===!(2&~i.metadata.flags)){if(null===i.matches)t.reset([]);else{const o=UF(n,r);t.reset(o,Dx),t.notifyOnChanges()}return!0}return!1}function _d(){return function $S(t,n){return t[18].queries[n].queryList}(Le(),nm())}function Y1(t,n){return t<<17|n<<2}function Gm(t){return t>>17&32767}function LI(t){return 2|t}function X_(t){return(131068&t)>>2}function FI(t,n){return-131069&t|n<<2}function BI(t){return 1|t}function j3(t,n,e,r){const i=t[e+1],o=null===n;let a=r?Gm(i):X_(i),c=!1;for(;0!==a&&(!1===c||o);){const _=t[a+1];AJ(t[a],n)&&(c=!0,t[a+1]=r?BI(_):LI(_)),a=r?Gm(_):X_(_)}c&&(t[e+1]=r?LI(i):BI(i))}function AJ(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&bl(t,n)>=0}const rs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function H3(t){return t.substring(rs.key,rs.keyEnd)}function $3(t,n){const e=rs.textEnd;return e===n?-1:(n=rs.keyEnd=function NJ(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,rs.key=n,e),Q_(t,n,e))}function Q_(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function Wm(t,n,e){return K3(t,n,e,!1),Wm}function js(t,n){return K3(t,n,null,!0),js}function is(t){!function Y3(t,n,e,r){const i=$t(),o=El(2);i.firstUpdatePass&&Q3(i,null,o,r);const a=Le();if(e!==Lr&&ui(a,o,e)){const c=i.data[fo()];if(nV(c,r)&&!X3(i,o)){let f=r?c.classesWithoutHost:c.stylesWithoutHost;null!==f&&(e=mn(f,e||"")),SI(i,c,a,e,r)}else!function GJ(t,n,e,r,i,o,a,c){i===Lr&&(i=Pr);let f=0,_=0,x=0<i.length?i[0]:null,C=0<o.length?o[0]:null;for(;null!==x||null!==C;){const A=f<i.length?i[f+1]:void 0,N=_<o.length?o[_+1]:void 0;let ne,U=null;x===C?(f+=2,_+=2,A!==N&&(U=C,ne=N)):null===C||null!==x&&x<C?(f+=2,U=x):(_+=2,U=C,ne=N),null!==U&&eV(t,n,e,r,U,ne,a,c),x=f<i.length?i[f]:null,C=_<o.length?o[_]:null}}(i,c,a,a[11],a[o+1],a[o+1]=function $J(t,n,e){if(null==e||""===e)return Pr;const r=[],i=kl(e);if(Array.isArray(i))for(let o=0;o<i.length;o++)t(r,i[o],!0);else if(i instanceof Set)for(const o of i)t(r,o,!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&t(r,o,i[o]);else"string"==typeof i&&n(r,i);return r}(t,n,e),r,o)}}(qJ,VJ,t,!0)}function VJ(t,n){for(let e=function RJ(t){return function G3(t){rs.key=0,rs.keyEnd=0,rs.value=0,rs.valueEnd=0,rs.textEnd=t.length}(t),$3(t,Q_(t,0,rs.textEnd))}(n);e>=0;e=$3(n,e))ja(t,H3(n),!0)}function K3(t,n,e,r){const i=Le(),o=$t(),a=El(2);o.firstUpdatePass&&Q3(o,t,a,r),n!==Lr&&ui(i,a,n)&&eV(o,o.data[fo()],i,i[11],t,i[a+1]=function WJ(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=En(kl(t)))),t}(n,e),r,a)}function X3(t,n){return n>=t.expandoStartIndex}function Q3(t,n,e,r){const i=t.data;if(null===i[e+1]){const o=i[fo()],a=X3(t,e);nV(o,r)&&null===n&&!a&&(n=!1),n=function UJ(t,n,e,r){const i=function $g(t){const n=et.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=r?n.residualClasses:n.residualStyles;if(null===i)0===(r?n.classBindings:n.styleBindings)&&(e=bb(e=VI(null,t,n,e,r),n.attrs,r),o=null);else{const a=n.directiveStylingLast;if(-1===a||t[a]!==i)if(e=VI(i,t,n,e,r),null===o){let f=function zJ(t,n,e){const r=e?n.classBindings:n.styleBindings;if(0!==X_(r))return t[Gm(r)]}(t,n,r);void 0!==f&&Array.isArray(f)&&(f=VI(null,t,n,f[1],r),f=bb(f,n.attrs,r),function jJ(t,n,e,r){t[Gm(e?n.classBindings:n.styleBindings)]=r}(t,n,r,f))}else o=function HJ(t,n,e){let r;const i=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<i;o++)r=bb(r,t[o].hostAttrs,e);return bb(r,n.attrs,e)}(t,n,r)}return void 0!==o&&(r?n.residualClasses=o:n.residualStyles=o),e}(i,o,n,r),function IJ(t,n,e,r,i,o){let a=o?n.classBindings:n.styleBindings,c=Gm(a),f=X_(a);t[r]=e;let x,_=!1;if(Array.isArray(e)?(x=e[1],(null===x||bl(e,x)>0)&&(_=!0)):x=e,i)if(0!==f){const A=Gm(t[c+1]);t[r+1]=Y1(A,c),0!==A&&(t[A+1]=FI(t[A+1],r)),t[c+1]=function TJ(t,n){return 131071&t|n<<17}(t[c+1],r)}else t[r+1]=Y1(c,0),0!==c&&(t[c+1]=FI(t[c+1],r)),c=r;else t[r+1]=Y1(f,0),0===c?c=r:t[f+1]=FI(t[f+1],r),f=r;_&&(t[r+1]=LI(t[r+1])),j3(t,x,r,!0),j3(t,x,r,!1),function kJ(t,n,e,r,i){const o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&bl(o,n)>=0&&(e[r+1]=BI(e[r+1]))}(n,x,t,r,o),a=Y1(c,f),o?n.classBindings=a:n.styleBindings=a}(i,o,n,e,a,r)}}function VI(t,n,e,r,i){let o=null;const a=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<a&&(o=n[c],r=bb(r,o.hostAttrs,i),o!==t);)c++;return null!==t&&(e.directiveStylingLast=c),r}function bb(t,n,e){const r=e?1:2;let i=-1;if(null!==n)for(let o=0;o<n.length;o++){const a=n[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ja(t,a,!!e||n[++o]))}return void 0===t?null:t}function qJ(t,n,e){const r=String(n);""!==r&&!r.includes(" ")&&ja(t,r,e)}function eV(t,n,e,r,i,o,a,c){if(!(3&n.type))return;const f=t.data,_=f[c+1],x=function SJ(t){return!(1&~t)}(_)?tV(f,n,e,i,X_(_),a):void 0;X1(x)||(X1(o)||function DJ(t){return!(2&~t)}(_)&&(o=tV(f,null,e,i,c,a)),function o9(t,n,e,r,i){if(n)i?t.addClass(e,r):t.removeClass(e,r);else{let o=-1===r.indexOf("-")?void 0:ap.DashCase;null==i?t.removeStyle(e,r,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=ap.Important),t.setStyle(e,r,i,o))}}(r,a,Z(fo(),e),i,o))}function tV(t,n,e,r,i,o){const a=null===n;let c;for(;i>0;){const f=t[i],_=Array.isArray(f),x=_?f[1]:f,C=null===x;let A=e[i+1];A===Lr&&(A=C?Pr:void 0);let N=C?Kc(A,r):x===r?A:void 0;if(_&&!X1(N)&&(N=Kc(f,r)),X1(N)&&(c=N,a))return c;const U=t[i+1];i=a?Gm(U):X_(U)}if(null!==n){let f=o?n.residualClasses:n.residualStyles;null!=f&&(c=Kc(f,r))}return c}function X1(t){return void 0!==t}function nV(t,n){return!!(t.flags&(n?8:16))}function q(t,n=""){const e=Le(),r=$t(),i=t+27,o=r.firstCreatePass?Pm(r,i,1,n,null):r.data[i],a=rV(r,e,o,n);e[i]=a,Gg()&&mS(r,e,a,o),Us(o,!1)}let rV=(t,n,e,r)=>(im(!0),function tS(t,n){return t.createText(n)}(n[11],r));function aV(t,n,e,r,i,o,a,c=""){const _=function w1(t,n,e,r,i){const o=Lm(t,n,e,r);return ui(t,n+2,i)||o}(t,Vr(),e,i,a);return El(3),_?n+nn(e)+r+nn(i)+o+nn(a)+c:Lr}function xt(t){return _r("",t),xt}function _r(t,n,e){const r=Le(),i=function oV(t,n,e,r=""){return ui(t,Qi(),e)?n+nn(e)+r:Lr}(r,t,n,e);return i!==Lr&&kh(r,fo(),i),_r}function bs(t,n,e,r,i){const o=Le(),a=function sV(t,n,e,r,i,o=""){const c=Lm(t,Vr(),e,i);return El(2),c?n+nn(e)+r+nn(i)+o:Lr}(o,t,n,e,r,i);return a!==Lr&&kh(o,fo(),a),bs}function Q1(t,n,e,r,i,o,a){const c=Le(),f=aV(c,t,n,e,r,i,o,a);return f!==Lr&&kh(c,fo(),f),Q1}function UI(t,n,e,r,i,o,a,c,f){const _=Le(),x=function lV(t,n,e,r,i,o,a,c,f,_=""){const C=Cc(t,Vr(),e,i,a,f);return El(4),C?n+nn(e)+r+nn(i)+o+nn(a)+c+nn(f)+_:Lr}(_,t,n,e,r,i,o,a,c,f);return x!==Lr&&kh(_,fo(),x),UI}function kh(t,n,e){const r=Z(n,t);!function $O(t,n,e){t.setValue(n,e)}(t[11],r,e)}function mo(t,n,e){xB(n)&&(n=n());const r=Le();return ui(r,Qi(),n)&&($t(),n1(zo(),r,t,n,r[11],e)),mo}function Ro(t,n){const e=xB(t);return e&&t.set(n),e}function go(t,n){const e=Le(),r=$t(),i=Qt();return NI(r,e,e[11],i,t,n),go}function bV(t,n,e){const r=$t();r.firstCreatePass&&wV(n,r.data,r.blueprint,ps(t),e)}function wV(t,n,e,r,i){if(t=_n(t),Array.isArray(t))for(let o=0;o<t.length;o++)wV(t[o],n,e,r,i);else{const o=$t(),a=Le(),c=Qt();let f=Jo(t)?t:_n(t.provide);const _=ki(t),x=1048575&c.providerIndexes,C=c.directiveStart,A=c.providerIndexes>>20;if(Jo(t)||!t.multi){const N=new dm(_,i,Ne,null),U=jI(f,n,i?x:x+A,C);-1===U?(fm(ru(c,a),o,f),zI(o,t,n.length),n.push(f),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(N),a.push(N)):(e[U]=N,a[U]=N)}else{const N=jI(f,n,x+A,C),U=jI(f,n,x,x+A),ce=U>=0&&e[U];if(i&&!ce||!i&&!(N>=0&&e[N])){fm(ru(c,a),o,f);const xe=function uee(t,n,e,r,i){const a=new dm(t,e,Ne,null);return a.multi=[],a.index=n,a.componentProviders=0,xV(a,i,r&&!e),a}(i?cee:lee,e.length,i,r,_);!i&&ce&&(e[U].providerFactory=xe),zI(o,t,n.length,0),n.push(f),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(xe),a.push(xe)}else zI(o,t,N>-1?N:U,xV(e[i?U:N],_,!i&&r));!i&&r&&ce&&e[U].componentProviders++}}}function zI(t,n,e,r){const i=Jo(n),o=function ua(t){return!!t.useClass}(n);if(i||o){const f=(o?_n(n.useClass):n).prototype.ngOnDestroy;if(f){const _=t.destroyHooks||(t.destroyHooks=[]);if(!i&&n.multi){const x=_.indexOf(e);-1===x?_.push(e,[r,f]):_[x+1].push(r,f)}else _.push(e,f)}}}function xV(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function jI(t,n,e,r){for(let i=e;i<r;i++)if(n[i]===t)return i;return-1}function lee(t,n,e,r,i){return HI(this.multi,[])}function cee(t,n,e,r,i){const o=this.multi;let a;if(this.providerFactory){const c=this.providerFactory.componentProviders,f=Hf(r,r[1],this.providerFactory.index,i);a=f.slice(0,c),HI(o,a);for(let _=c;_<f.length;_++)a.push(f[_])}else a=[],HI(o,a);return a}function HI(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Mr(t,n){return e=>{e.providersResolver=(r,i)=>bV(r,i?i(t):t,!1),n&&(e.viewProvidersResolver=(r,i)=>bV(r,i?i(n):n,!0))}}function IV(t,n,e,r,i,o,a,c,f){const _=n+e;return Cc(t,_,i,o,a,c)?pd(t,_+4,f?r.call(f,i,o,a,c):r(i,o,a,c)):function wb(t,n){const e=t[n];return e===Lr?void 0:e}(t,_+4)}function J_(t,n){const e=$t();let r;const i=t+27;e.firstCreatePass?(r=function Eee(t,n){if(n)for(let e=n.length-1;e>=0;e--){const r=n[e];if(t===r.name)return r}}(n,e.pipeRegistry),e.data[i]=r,r.onDestroy&&(e.destroyHooks??=[]).push(i,r.onDestroy)):r=e.data[i];const o=r.factory||(r.factory=za(r.type)),c=Ii(Ne);try{const f=hm(!1),_=o();return hm(f),function ie(t,n,e,r){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=r}(e,Le(),i,_),_}finally{Ii(c)}}function ey(t,n,e,r,i,o){const a=t+27,c=Le(),f=function de(t,n){return t[n]}(c,a);return function xb(t,n){return t[1].data[n].pure}(c,a)?IV(c,jn(),n,f.transform,e,r,i,o,f):f.transform(e,r,i,o)}class nte{ngModuleFactory;componentFactories;constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let rte=(()=>{class t{compileModuleSync(e){return new WF(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),o=fd(us(e).declarations).reduce((a,c)=>{const f=cn(c);return f&&a.push(new rb(f)),a},[]);return new nte(r,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ote=(()=>{class t{applicationErrorHandler=Q(Dl);appRef=Q(tl);taskService=Q(Ga);ngZone=Q(sn);zonelessEnabled=Q(nd);tracing=Q(R_,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Qn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Yg):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Q(Qw,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{const e=this.taskService.add();this.runningTick||(this.cleanup(),this.zonelessEnabled&&!this.appRef.includeAllTestViews)?(this.switchToMicrotaskScheduler(),this.taskService.remove(e)):this.taskService.remove(e)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{const e=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})})}notify(e){if(!this.zonelessEnabled&&5===e)return;switch(e){case 0:case 6:case 13:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 12:this.appRef.dirtyFlags|=16;break;case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;const r=this.useMicrotaskScheduler?av:Kg;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Yg+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(e),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ah=new Ue("",{factory:()=>Q(Ah,{optional:!0,skipSelf:!0})||function ste(){return typeof $localize<"u"&&$localize.locale||q1}()}),iE=Symbol("InputSignalNode#UNSET"),QV={...Ra,transformFn:void 0,applyValueToInputSignal(t,n){ml(t,n)}};function JV(t,n){const e=Object.create(QV);function r(){if(Oo(e),e.value===iE)throw new ue(-950,null);return e.value}return e.value=t,e.transformFn=n?.transform,r[He]=e,r}class mte{attributeName;constructor(n){this.attributeName=n}__NG_ELEMENT_ID__=()=>qf(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}}function e4(t,n){return JV(t,n)}const _te=(e4.required=function gte(t){return JV(iE,t)},e4);let vte=(()=>{class t{zone=Q(sn);changeDetectionScheduler=Q(Lf);applicationRef=Q(tl);applicationErrorHandler=Q(Dl);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(e){this.applicationErrorHandler(e)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const bte=new Ue("",{factory:()=>!1});function i4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}let Ete=(()=>{class t{subscription=new Qn;initialized=!1;zone=Q(sn);pendingTasks=Q(Ga);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{sn.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{sn.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const oE=new Ue(""),Ste=new Ue("");function Cb(t){return!t.moduleRef}let ry=null;let Mh=(()=>class t{static __NG_ELEMENT_ID__=Gte})();function Gte(t){return function Wte(t,n,e){if(uo(t)&&!e){const r=le(t.index,n);return new Gv(r,r)}return 175&t.type?new Gv(n[15],n):null}(Qt(),Le(),!(16&~t))}function nne(t){const{rootComponent:n,appProviders:e,platformProviders:r,platformRef:i}=t;wr(Dt.BootstrapApplicationStart);try{const o=i?.injector??function Rte(t=[]){if(ry)return ry;const n=function u4(t=[],n){return An.create({name:n,providers:[{provide:If,useValue:"platform"},{provide:oE,useValue:new Set([()=>ry=null])},...t]})}(t);return ry=n,function WY(){!function jp(t){Gl=t}(()=>{throw new ue(600,"")})}(),function d4(t){const n=t.get(Sl,null);qi(t,()=>{n?.forEach(e=>e())})}(n),n}(r),a=[[{provide:Lf,useExisting:ote},{provide:sn,useClass:Kw},{provide:nd,useValue:!0}],Xw,...e||[]];return function s4(t){const n=Cb(t)?t.r3Injector:t.moduleRef.injector,e=n.get(sn);return e.run(()=>{Cb(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();const r=n.get(Dl);let i;if(e.runOutsideAngular(()=>{i=e.onError.subscribe({next:r})}),Cb(t)){const o=()=>n.destroy(),a=t.platformInjector.get(oE);a.add(o),n.onDestroy(()=>{i.unsubscribe(),a.delete(o)})}else{const o=()=>t.moduleRef.destroy(),a=t.platformInjector.get(oE);a.add(o),t.moduleRef.onDestroy(()=>{R1(t.allPlatformModules,t.moduleRef),i.unsubscribe(),a.delete(o)})}return function kte(t,n,e){try{const r=e();return ub(r)?r.catch(i=>{throw n.runOutsideAngular(()=>t(i)),i}):r}catch(r){throw n.runOutsideAngular(()=>t(r)),r}}(r,e,()=>{const o=n.get(Ga),a=o.add(),c=n.get(zB);return c.runInitializers(),c.donePromise.then(()=>{if(function BQ(t){"string"==typeof t&&(b3=t.toLowerCase().replace(/_/g,"-"))}(n.get(Ah,q1)||q1),!n.get(Ste,!0))return Cb(t)?n.get(tl):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(Cb(t)){const x=n.get(tl);return void 0!==t.rootComponent&&x.bootstrap(t.rootComponent),x}return t.moduleRef}).finally(()=>{o.remove(a)})})})}({r3Injector:new ZF({providers:a,parent:o,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:o,rootComponent:n})}catch(o){return Promise.reject(o)}finally{wr(Dt.BootstrapApplicationEnd)}}function ws(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function M4(t,n=NaN){return isNaN(parseFloat(t))||isNaN(Number(t))?n:Number(t)}function O4(t,n){const e=cn(t),r=n.elementInjector||sc();return new rb(e).create(r,n.projectableNodes,n.hostElement,n.environmentInjector,n.directives,n.bindings)}let L4=null;function fp(){return L4}class bne{}let dE=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(xne),providedIn:"platform"})}return t})();const wne=new Ue("");let xne=(()=>{class t extends dE{_location;_history;_doc=Q(Wn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fp().getBaseHref(this._doc)}onPopState(e){const r=fp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=fp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,i){this._history.pushState(e,r,i)}replaceState(e,r,i){this._history.replaceState(e,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function F4(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const r=e.indexOf("="),[i,o]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===n)return decodeURIComponent(o)}return null}class B4{}function V4(t,n,e){return function PQ(t,n,e){"string"!=typeof n&&(e=n,n=t[xi.LocaleId]),n=n.toLowerCase().replace(/_/g,"-"),Y_[n]=t,e&&(Y_[n][xi.ExtraData]=e)}(t,n,e)}const U4="browser";let z4=(()=>{class t{static \u0275prov=$e({token:t,providedIn:"root",factory:()=>new Dne(Q(Wn),window)})}return t})();class Dne{document;window;offset=()=>[0,0];constructor(n,e){this.document=n,this.window=e}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n,e){this.window.scrollTo({...e,left:n[0],top:n[1]})}scrollToAnchor(n,e){const r=function Tne(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const a=o.getElementById(n)||o.querySelector(`[name="${n}"]`);if(a)return a}i=r.nextNode()}}return null}(this.document,n);r&&(this.scrollToElement(r,e),r.focus())}setHistoryScrollRestoration(n){try{this.window.history.scrollRestoration=n}catch{console.warn(Ht(2400,!1))}}scrollToElement(n,e){const r=n.getBoundingClientRect(),i=r.left+this.window.pageXOffset,o=r.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo({...e,left:i-a[0],top:o-a[1]})}}class Q4{_doc;constructor(n){this._doc=n}manager}let ok=(()=>{class t extends Q4{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i,o){return e.addEventListener(r,i,o),()=>this.removeEventListener(e,r,i,o)}removeEventListener(e,r,i,o){return e.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||t)(Tt(Wn))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();const sk=new Ue("");let J4=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,r){this._zone=r,e.forEach(a=>{a.manager=this});const i=e.filter(a=>!(a instanceof ok));this._plugins=i.slice().reverse();const o=e.find(a=>a instanceof ok);o&&this._plugins.push(o)}addEventListener(e,r,i,o){return this._findPluginFor(r).addEventListener(e,r,i,o)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(o=>o.supports(e)),!r)throw new ue(5101,!1);return this._eventNameToPlugin.set(e,r),r}static \u0275fac=function(r){return new(r||t)(Tt(sk),Tt(sn))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();const ak="ng-app-id";function eU(t){for(const n of t)n.remove()}function tU(t,n){const e=n.createElement("style");return e.textContent=t,e}function lk(t,n){const e=n.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",t),e}let nU=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,r,i,o={}){this.doc=e,this.appId=r,this.nonce=i,function ere(t,n,e,r){const i=t.head?.querySelectorAll(`style[${ak}="${n}"],link[${ak}="${n}"]`);if(i)for(const o of i)o.removeAttribute(ak),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&e.set(o.textContent,{usage:0,elements:[o]})}(e,r,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,r){for(const i of e)this.addUsage(i,this.inline,tU);r?.forEach(i=>this.addUsage(i,this.external,lk))}removeStyles(e,r){for(const i of e)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(e,r,i){const o=r.get(e);o?o.usage++:r.set(e,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,i(e,this.doc)))})}removeUsage(e,r){const i=r.get(e);i&&(i.usage--,i.usage<=0&&(eU(i.elements),r.delete(e)))}ngOnDestroy(){for(const[,{elements:e}]of[...this.inline,...this.external])eU(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(const[r,{elements:i}]of this.inline)i.push(this.addElement(e,tU(r,this.doc)));for(const[r,{elements:i}]of this.external)i.push(this.addElement(e,lk(r,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,r){return this.nonce&&r.setAttribute("nonce",this.nonce),e.appendChild(r)}static \u0275fac=function(r){return new(r||t)(Tt(Wn),Tt(Tr),Tt(jr,8),Tt(ys))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();const ck={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},uk=/%COMP%/g,sre=new Ue("",{factory:()=>!0});function iU(t,n){return n.map(e=>e.replace(uk,t))}let dk=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(e,r,i,o,a,c,f=null,_=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=a,this.ngZone=c,this.nonce=f,this.tracingService=_,this.defaultRenderer=new hk(e,a,c,this.tracingService)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(e,r);return i instanceof aU?i.applyToHost(e):i instanceof fk&&i.applyStyles(),i}getOrCreateRenderer(e,r){const i=this.rendererByCompId;let o=i.get(r.id);if(!o){const a=this.doc,c=this.ngZone,f=this.eventManager,_=this.sharedStylesHost,x=this.removeStylesOnCompDestroy,C=this.tracingService;switch(r.encapsulation){case Ec.Emulated:o=new aU(f,_,r,this.appId,x,a,c,C);break;case Ec.ShadowDom:return new sU(f,e,r,a,c,this.nonce,C,_);case Ec.ExperimentalIsolatedShadowDom:return new sU(f,e,r,a,c,this.nonce,C);default:o=new fk(f,_,r,x,a,c,C)}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(r){return new(r||t)(Tt(J4),Tt(nU),Tt(Tr),Tt(sre),Tt(Wn),Tt(sn),Tt(jr),Tt(R_,8))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();class hk{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(n,e,r,i){this.eventManager=n,this.doc=e,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(n,e){return e?this.doc.createElementNS(ck[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(oU(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(oU(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){e.remove()}selectRootElement(n,e){let r="string"==typeof n?this.doc.querySelector(n):n;if(!r)throw new ue(-5104,!1);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,i){if(i){e=i+":"+e;const o=ck[i];o?n.setAttributeNS(o,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){const i=ck[r];i?n.removeAttributeNS(i,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,i){i&(ap.DashCase|ap.Important)?n.style.setProperty(e,r,i&ap.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&ap.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){null!=n&&(n[e]=r)}setValue(n,e){n.nodeValue=e}listen(n,e,r,i){if("string"==typeof n&&!(n=fp().getGlobalEventTarget(this.doc,n)))throw new ue(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(n,e,o)),this.eventManager.addEventListener(n,e,o,i)}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&e.preventDefault()}}}function oU(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class sU extends hk{hostEl;sharedStylesHost;shadowRoot;constructor(n,e,r,i,o,a,c,f){super(n,i,o,c),this.hostEl=e,this.sharedStylesHost=f,this.shadowRoot=e.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let _=r.styles;_=iU(r.id,_);for(const C of _){const A=document.createElement("style");a&&A.setAttribute("nonce",a),A.textContent=C,this.shadowRoot.appendChild(A)}const x=r.getExternalStyles?.();if(x)for(const C of x){const A=lk(C,i);a&&A.setAttribute("nonce",a),this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(null,e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}}class fk extends hk{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(n,e,r,i,o,a,c,f){super(n,o,a,c),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=i;let _=r.styles;this.styles=f?iU(f,_):_,this.styleUrls=r.getExternalStyles?.(f)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&0===Am.size&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class aU extends fk{contentAttr;hostAttr;constructor(n,e,r,i,o,a,c,f){const _=i+"-"+r.id;super(n,e,r,o,a,c,f,_),this.contentAttr=function are(t){return"_ngcontent-%COMP%".replace(uk,t)}(_),this.hostAttr=function lre(t){return"_nghost-%COMP%".replace(uk,t)}(_)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}}class pk extends bne{supportsDOMEvents=!0;static makeCurrent(){!function vne(t){L4??=t}(new pk)}onAndCancel(n,e,r,i){return n.addEventListener(e,r,i),()=>{n.removeEventListener(e,r,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.remove()}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function ure(){return kb=kb||document.head.querySelector("base"),kb?kb.getAttribute("href"):null}();return null==e?null:function dre(t){return new URL(t,document.baseURI).pathname}(e)}resetBaseElement(){kb=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return F4(document.cookie,n)}}let kb=null,fre=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();const lU=["alt","control","meta","shift"],pre={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mre={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};function mk(){return(mk=fe(function*(t,n,e){return nne({rootComponent:t,...cU(n,e)})})).apply(this,arguments)}function cU(t,n){return{platformRef:n?.platformRef,appProviders:[...Ere,...t?.providers??[]],platformProviders:wre}}const wre=[{provide:ys,useValue:U4},{provide:Sl,useValue:function yre(){pk.makeCurrent()},multi:!0},{provide:Wn,useFactory:function bre(){return function Io(t){So=t}(document),document}}],Ere=[{provide:If,useValue:"root"},{provide:Of,useFactory:function vre(){return new Of}},{provide:sk,useClass:ok,multi:!0},{provide:sk,useClass:(()=>{class t extends Q4{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,r,i,o){const a=t.parseEventName(r),c=t.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fp().onAndCancel(e,a.domEventName,c,o))}static parseEventName(e){const r=e.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),lU.forEach(_=>{const x=r.indexOf(_);x>-1&&(r.splice(x,1),a+=_+".")}),a+=o,0!=r.length||0===o.length)return null;const f={};return f.domEventName=i,f.fullKey=a,f}static matchEventFullKeyCode(e,r){let i=pre[e.key]||e.key,o="";return r.indexOf("code.")>-1&&(i=e.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),lU.forEach(a=>{a!==i&&(0,mre[a])(e)&&(o+=a+".")}),o+=i,o===r)}static eventCallback(e,r,i){return o=>{t.matchEventFullKeyCode(o,e)&&i.runGuarded(()=>r(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static \u0275fac=function(r){return new(r||t)(Tt(Wn))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})(),multi:!0},dk,nU,J4,{provide:Rl,useExisting:dk},{provide:B4,useClass:fre},[]];var vn=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(vn||{});const Rh="*";function uU(t){return{type:vn.Style,styles:t,offset:null}}class Ab{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(n=0,e=0){this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class dU{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(n){this.players=n;let e=0,r=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++e==o&&this._onFinish()}),a.onDestroy(()=>{++r==o&&this._onDestroy()}),a.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((a,c)=>Math.max(a,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(i)})}getPosition(){const n=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function hU(t){return new ue(3e3,!1)}function Nre(t){return new ue(3002,!1)}function pp(t){switch(t.length){case 0:return new Ab;case 1:return t[0];default:return new dU(t)}}function fU(t,n,e=new Map,r=new Map){const i=[],o=[];let a=-1,c=null;if(n.forEach(f=>{const _=f.get("offset"),x=_==a,C=x&&c||new Map;f.forEach((A,N)=>{let U=N,ne=A;if("offset"!==N)switch(U=t.normalizePropertyName(U,i),ne){case"!":ne=e.get(N);break;case Rh:ne=r.get(N);break;default:ne=t.normalizeStyleValue(N,U,ne,i)}C.set(U,ne)}),x||o.push(C),c=C,a=_}),i.length)throw function qre(){return new ue(3502,!1)}();return o}function vk(t,n,e,r){switch(n){case"start":t.onStart(()=>r(e&&bk(e,"start",t)));break;case"done":t.onDone(()=>r(e&&bk(e,"done",t)));break;case"destroy":t.onDestroy(()=>r(e&&bk(e,"destroy",t)))}}function bk(t,n,e){const o=wk(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),a=t._data;return null!=a&&(o._data=a),o}function wk(t,n,e,r,i="",o=0,a){return{element:t,triggerName:n,fromState:e,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function Nl(t,n,e){let r=t.get(n);return r||t.set(n,r=e),r}function pU(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const rie=typeof document>"u"?null:document.documentElement;function xk(t){const n=t.parentNode||t.host||null;return n===rie?null:n}let Km=null,mU=!1;function gU(t,n){for(;n;){if(n===t)return!0;n=xk(n)}return!1}function _U(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const r=t.querySelector(n);return r?[r]:[]}const vU="ng-enter",Ek="ng-leave",gE="ng-trigger",_E=".ng-trigger",bU="ng-animating",Ck=".ng-animating";function Ph(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:Dk(parseFloat(n[1]),n[2])}function Dk(t,n){return"s"===n?1e3*t:t}function yE(t,n,e){return t.hasOwnProperty("duration")?t:function uie(t,n,e){let r,i=0,o="";if("string"==typeof t){const a=t.match(cie);if(null===a)return n.push(hU()),{duration:0,delay:0,easing:""};r=Dk(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(i=Dk(parseFloat(c),a[4]));const f=a[5];f&&(o=f)}else r=t;if(!e){let a=!1,c=n.length;r<0&&(n.push(function Dre(){return new ue(3100,!1)}()),a=!0),i<0&&(n.push(function Tre(){return new ue(3101,!1)}()),a=!0),a&&n.splice(c,0,hU())}return{duration:r,delay:i,easing:o}}(t,n,e)}const cie=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i;function yd(t,n,e){n.forEach((r,i)=>{const o=Sk(i);e&&!e.has(i)&&e.set(i,t.style[o]),t.style[o]=r})}function Ym(t,n){n.forEach((e,r)=>{const i=Sk(r);t.style[i]=""})}function Mb(t){return Array.isArray(t)?1==t.length?t[0]:function Cre(t,n=null){return{type:vn.Sequence,steps:t,options:n}}(t):t}const Tk=new RegExp("{{\\s*(.+?)\\s*}}","g");function wU(t){let n=[];if("string"==typeof t){let e;for(;e=Tk.exec(t);)n.push(e[1]);Tk.lastIndex=0}return n}function Rb(t,n,e){const r=`${t}`,i=r.replace(Tk,(o,a)=>{let c=n[a];return null==c&&(e.push(function Ire(){return new ue(3003,!1)}()),c=""),c.toString()});return i==r?t:i}const fie=/-+([a-z0-9])/g;function Sk(t){return t.replace(fie,(...n)=>n[1].toUpperCase())}function Ol(t,n,e){switch(n.type){case vn.Trigger:return t.visitTrigger(n,e);case vn.State:return t.visitState(n,e);case vn.Transition:return t.visitTransition(n,e);case vn.Sequence:return t.visitSequence(n,e);case vn.Group:return t.visitGroup(n,e);case vn.Animate:return t.visitAnimate(n,e);case vn.Keyframes:return t.visitKeyframes(n,e);case vn.Style:return t.visitStyle(n,e);case vn.Reference:return t.visitReference(n,e);case vn.AnimateChild:return t.visitAnimateChild(n,e);case vn.AnimateRef:return t.visitAnimateRef(n,e);case vn.Query:return t.visitQuery(n,e);case vn.Stagger:return t.visitStagger(n,e);default:throw function kre(){return new ue(3004,!1)}()}}function Ik(t,n){return window.getComputedStyle(t)[n]}let kk=(()=>{class t{validateStyleProperty(e){return function oie(t){Km||(Km=function sie(){return typeof document<"u"?document.body:null}()||{},mU=!!Km.style&&"WebkitAppearance"in Km.style);let n=!0;return Km.style&&!function iie(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Km.style,!n&&mU&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Km.style)),n}(e)}containsElement(e,r){return gU(e,r)}getParentElement(e){return xk(e)}query(e,r,i){return _U(e,r,i)}computeStyle(e,r,i){return i||""}animate(e,r,i,o,a,c=[],f){return new Ab(i,o)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();class Ak{static NOOP=new kk}class Mk{}const _ie=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class xU extends Mk{normalizePropertyName(n,e){return Sk(n)}normalizeStyleValue(n,e,r,i){let o="";const a=r.toString().trim();if(_ie.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)o="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&i.push(function Are(){return new ue(3005,!1)}())}return a+o}}const bE=new Set(["true","1"]),wE=new Set(["false","0"]);function EU(t,n){const e=bE.has(t)||wE.has(t),r=bE.has(n)||wE.has(n);return(i,o)=>{let a="*"==t||t==i,c="*"==n||n==o;return!a&&e&&"boolean"==typeof i&&(a=i?bE.has(t):wE.has(t)),!c&&r&&"boolean"==typeof o&&(c=o?bE.has(n):wE.has(n)),a&&c}}const wie=new RegExp("s*:selfs*,?","g");function Pk(t,n,e,r){return new xie(t).build(n,e,r)}class xie{_driver;constructor(n){this._driver=n}build(n,e,r){const i=new Die(e);return this._resetContextStyleTimingState(i),Ol(this,Mb(n),i)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let r=e.queryCount=0,i=e.depCount=0;const o=[],a=[];return"@"==n.name.charAt(0)&&e.errors.push(function Mre(){return new ue(3006,!1)}()),n.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),c.type==vn.State){const f=c,_=f.name;_.toString().split(/\s*,\s*/).forEach(x=>{f.name=x,o.push(this.visitState(f,e))}),f.name=_}else if(c.type==vn.Transition){const f=this.visitTransition(c,e);r+=f.queryCount,i+=f.depCount,a.push(f)}else e.errors.push(function Rre(){return new ue(3007,!1)}())}),{type:vn.Trigger,name:n.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}visitState(n,e){const r=this.visitStyle(n.styles,e),i=n.options&&n.options.params||null;if(r.containsDynamicStyles){const o=new Set,a=i||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(f=>{wU(f).forEach(_=>{a.hasOwnProperty(_)||o.add(_)})})}),o.size&&e.errors.push(function Pre(){return new ue(3008,!1)}(0,o.values()))}return{type:vn.State,name:n.name,style:r,options:i?{params:i}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const r=Ol(this,Mb(n.animation),e),i=function yie(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function vie(t,n,e){if(":"==t[0]){const f=function bie(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return n.push(function Hre(){return new ue(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof f)return void n.push(f);t=f}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function jre(){return new ue(3015,!1)}()),n;const i=r[1],o=r[2],a=r[3];n.push(EU(i,a)),"<"==o[0]&&("*"!=i||"*"!=a)&&n.push(EU(a,i))}(r,e,n)):e.push(t),e}(n.expr,e.errors);return{type:vn.Transition,matchers:i,animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Xm(n.options)}}visitSequence(n,e){return{type:vn.Sequence,steps:n.steps.map(r=>Ol(this,r,e)),options:Xm(n.options)}}visitGroup(n,e){const r=e.currentTime;let i=0;const o=n.steps.map(a=>{e.currentTime=r;const c=Ol(this,a,e);return i=Math.max(i,e.currentTime),c});return e.currentTime=i,{type:vn.Group,steps:o,options:Xm(n.options)}}visitAnimate(n,e){const r=function Sie(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return Nk(yE(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=Nk(0,0,"");return o.dynamic=!0,o.strValue=e,o}const i=yE(e,n);return Nk(i.duration,i.delay,i.easing)}(n.timings,e.errors);e.currentAnimateTimings=r;let i,o=n.styles?n.styles:uU({});if(o.type==vn.Keyframes)i=this.visitKeyframes(o,e);else{let a=n.styles,c=!1;if(!a){c=!0;const _={};r.easing&&(_.easing=r.easing),a=uU(_)}e.currentTime+=r.duration+r.delay;const f=this.visitStyle(a,e);f.isEmptyStep=c,i=f}return e.currentAnimateTimings=null,{type:vn.Animate,timings:r,style:i,options:null}}visitStyle(n,e){const r=this._makeStyleAst(n,e);return this._validateStyleAst(r,e),r}_makeStyleAst(n,e){const r=[],i=Array.isArray(n.styles)?n.styles:[n.styles];for(let c of i)"string"==typeof c?c===Rh?r.push(c):e.errors.push(Nre()):r.push(new Map(Object.entries(c)));let o=!1,a=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(a=c.get("easing"),c.delete("easing")),!o))for(let f of c.values())if(f.toString().indexOf("{{")>=0){o=!0;break}}),{type:vn.Style,styles:r,easing:a,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const r=e.currentAnimateTimings;let i=e.currentTime,o=e.currentTime;r&&o>0&&(o-=r.duration+r.delay),n.styles.forEach(a=>{"string"!=typeof a&&a.forEach((c,f)=>{const _=e.collectedStyles.get(e.currentQuerySelector),x=_.get(f);let C=!0;x&&(o!=i&&o>=x.startTime&&i<=x.endTime&&(e.errors.push(function Ore(){return new ue(3010,!1)}()),C=!1),o=x.startTime),C&&_.set(f,{startTime:o,endTime:i}),e.options&&function hie(t,n,e){const r=n.params||{},i=wU(t);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||e.push(function Sre(){return new ue(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(n,e){const r={type:vn.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Lre(){return new ue(3011,!1)}()),r;let o=0;const a=[];let c=!1,f=!1,_=0;const x=n.steps.map(xe=>{const Ce=this._makeStyleAst(xe,e);let Ze=null!=Ce.offset?Ce.offset:function Tie(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(Ce.styles),Se=0;return null!=Ze&&(o++,Se=Ce.offset=Ze),f=f||Se<0||Se>1,c=c||Se<_,_=Se,a.push(Se),Ce});f&&e.errors.push(function Fre(){return new ue(3012,!1)}()),c&&e.errors.push(function Bre(){return new ue(3200,!1)}());const C=n.steps.length;let A=0;o>0&&o<C?e.errors.push(function Vre(){return new ue(3202,!1)}()):0==o&&(A=1/(C-1));const N=C-1,U=e.currentTime,ne=e.currentAnimateTimings,ce=ne.duration;return x.forEach((xe,Ce)=>{const Ze=A>0?Ce==N?1:A*Ce:a[Ce],Se=Ze*ce;e.currentTime=U+ne.delay+Se,ne.duration=Se,this._validateStyleAst(xe,e),xe.offset=Ze,r.styles.push(xe)}),r}visitReference(n,e){return{type:vn.Reference,animation:Ol(this,Mb(n.animation),e),options:Xm(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:vn.AnimateChild,options:Xm(n.options)}}visitAnimateRef(n,e){return{type:vn.AnimateRef,animation:this.visitReference(n.animation,e),options:Xm(n.options)}}visitQuery(n,e){const r=e.currentQuerySelector,i=n.options||{};e.queryCount++,e.currentQuery=n;const[o,a]=function Eie(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(wie,"")),t=t.replace(/@\*/g,_E).replace(/@\w+/g,e=>_E+"-"+e.slice(1)).replace(/:animating/g,Ck),[t,n]}(n.selector);e.currentQuerySelector=r.length?r+" "+o:o,Nl(e.collectedStyles,e.currentQuerySelector,new Map);const c=Ol(this,Mb(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:vn.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:a,animation:c,originalSelector:n.selector,options:Xm(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function Ure(){return new ue(3013,!1)}());const r="full"===n.timings?{duration:0,delay:0,easing:"full"}:yE(n.timings,e.errors,!0);return{type:vn.Stagger,animation:Ol(this,Mb(n.animation),e),timings:r,options:null}}}class Die{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(n){this.errors=n}}function Xm(t){return t?(t={...t}).params&&(t.params=function Cie(t){return t?{...t}:null}(t.params)):t={},t}function Nk(t,n,e){return{duration:t,delay:n,easing:e}}function Ok(t,n,e,r,i,o,a=null,c=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:c}}class xE{_map=new Map;get(n){return this._map.get(n)||[]}append(n,e){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const Aie=new RegExp(":enter","g"),Rie=new RegExp(":leave","g");function Lk(t,n,e,r,i,o=new Map,a=new Map,c,f,_=[]){return(new Pie).buildKeyframes(t,n,e,r,i,o,a,c,f,_)}class Pie{buildKeyframes(n,e,r,i,o,a,c,f,_,x=[]){_=_||new xE;const C=new Fk(n,e,_,i,o,x,[]);C.options=f;const A=f.delay?Ph(f.delay):0;C.currentTimeline.delayNextStep(A),C.currentTimeline.setStyles([a],null,C.errors,f),Ol(this,r,C);const N=C.timelines.filter(U=>U.containsAnimation());if(N.length&&c.size){let U;for(let ne=N.length-1;ne>=0;ne--){const ce=N[ne];if(ce.element===e){U=ce;break}}U&&!U.allowOnlyTimelineStyles()&&U.setStyles([c],null,C.errors,f)}return N.length?N.map(U=>U.buildKeyframes()):[Ok(e,[],[],[],0,A,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const r=e.subInstructions.get(e.element);if(r){const i=e.createSubContext(n.options),o=e.currentTimeline.currentTime,a=this._visitSubInstructions(r,i,i.options);o!=a&&e.transformIntoNewTimeline(a)}e.previousNode=n}visitAnimateRef(n,e){const r=e.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,r),this.visitReference(n.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,r){for(const i of n){const o=i?.delay;if(o){const a="number"==typeof o?o:Ph(Rb(o,i?.params??{},e.errors));r.delayNextStep(a)}}}_visitSubInstructions(n,e,r){let o=e.currentTimeline.currentTime;const a=null!=r.duration?Ph(r.duration):null,c=null!=r.delay?Ph(r.delay):null;return 0!==a&&n.forEach(f=>{const _=e.appendInstructionToTimeline(f,a,c);o=Math.max(o,_.duration+_.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Ol(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const r=e.subContextCount;let i=e;const o=n.options;if(o&&(o.params||o.delay)&&(i=e.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){i.previousNode.type==vn.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=EE);const a=Ph(o.delay);i.delayNextStep(a)}n.steps.length&&(n.steps.forEach(a=>Ol(this,a,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const r=[];let i=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Ph(n.options.delay):0;n.steps.forEach(a=>{const c=e.createSubContext(n.options);o&&c.delayNextStep(o),Ol(this,a,c),i=Math.max(i,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(a=>e.currentTimeline.mergeTimelineCollectedStyles(a)),e.transformIntoNewTimeline(i),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const r=n.strValue;return yE(e.params?Rb(r,e.params,e.errors):r,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const r=e.currentAnimateTimings=this._visitTiming(n.timings,e),i=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),i.snapshotCurrentStyles());const o=n.style;o.type==vn.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(r.duration),this.visitStyle(o,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const r=e.currentTimeline,i=e.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const o=i&&i.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(o):r.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const r=e.currentAnimateTimings,i=e.currentTimeline.duration,o=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,n.styles.forEach(f=>{c.forwardTime((f.offset||0)*o),c.setStyles(f.styles,f.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(i+o),e.previousNode=n}visitQuery(n,e){const r=e.currentTimeline.currentTime,i=n.options||{},o=i.delay?Ph(i.delay):0;o&&(e.previousNode.type===vn.Style||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=EE);let a=r;const c=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=c.length;let f=null;c.forEach((_,x)=>{e.currentQueryIndex=x;const C=e.createSubContext(n.options,_);o&&C.delayNextStep(o),_===e.element&&(f=C.currentTimeline),Ol(this,n.animation,C),C.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,C.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),f&&(e.currentTimeline.mergeTimelineCollectedStyles(f),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const r=e.parentContext,i=e.currentTimeline,o=n.timings,a=Math.abs(o.duration),c=a*(e.currentQueryTotal-1);let f=a*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":f=c-f;break;case"full":f=r.currentStaggerTime}const x=e.currentTimeline;f&&x.delayNextStep(f);const C=x.currentTime;Ol(this,n.animation,e),e.previousNode=n,r.currentStaggerTime=i.currentTime-C+(i.startTime-r.currentTimeline.startTime)}}const EE={};class Fk{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=EE;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(n,e,r,i,o,a,c,f){this._driver=n,this.element=e,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=c,this.currentTimeline=f||new CE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const r=n;let i=this.options;null!=r.duration&&(i.duration=Ph(r.duration)),null!=r.delay&&(i.delay=Ph(r.delay));const o=r.params;if(o){let a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(c=>{(!e||!a.hasOwnProperty(c))&&(a[c]=Rb(o[c],a,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const r=n.params={};Object.keys(e).forEach(i=>{r[i]=e[i]})}}return n}createSubContext(n=null,e,r){const i=e||this.element,o=new Fk(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=EE,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,r){const i={duration:e??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},o=new Nie(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,i,n.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,r,i,o,a){let c=[];if(i&&c.push(this.element),n.length>0){n=(n=n.replace(Aie,"."+this._enterClassName)).replace(Rie,"."+this._leaveClassName);let _=this._driver.query(this.element,n,1!=r);0!==r&&(_=r<0?_.slice(_.length+r,_.length):_.slice(0,r)),c.push(..._)}return!o&&0==c.length&&a.push(function zre(){return new ue(3014,!1)}()),c}}class CE{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(n,e,r,i){this._driver=n,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=i,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new CE(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Rh),this._currentKeyframe.set(e,Rh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,r,i){e&&this._previousKeyframe.set("easing",e);const o=i&&i.params||{},a=function Oie(t,n){const e=new Map;let r;return t.forEach(i=>{if("*"===i){r??=n.keys();for(let o of r)e.set(o,Rh)}else for(let[o,a]of i)e.set(o,a)}),e}(n,this._globalTimelineStyles);for(let[c,f]of a){const _=Rb(f,o,r);this._pendingStyles.set(c,_),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Rh),this._updateStyle(c,_)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,r)=>{const i=this._styleSummary.get(r);(!i||e.time>i.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((c,f)=>{const _=new Map([...this._backFill,...c]);_.forEach((x,C)=>{"!"===x?n.add(C):x===Rh&&e.add(C)}),r||_.set("offset",f/this.duration),i.push(_)});const o=[...n.values()],a=[...e.values()];if(r){const c=i[0],f=new Map(c);c.set("offset",0),f.set("offset",1),i=[c,f]}return Ok(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}}class Nie extends CE{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(n,e,r,i,o,a,c=!1){super(n,e,a.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=c,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],a=r+e,c=e/a,f=new Map(n[0]);f.set("offset",0),o.push(f);const _=new Map(n[0]);_.set("offset",TU(c)),o.push(_);const x=n.length-1;for(let C=1;C<=x;C++){let A=new Map(n[C]);const N=A.get("offset");A.set("offset",TU((e+N*r)/a)),o.push(A)}r=a,e=0,i="",n=o}return Ok(this.element,n,this.preStyleProps,this.postStyleProps,r,e,i,!0)}}function TU(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}function SU(t,n,e,r,i,o,a,c,f,_,x,C,A){return{type:0,element:t,triggerName:n,isRemovalTransition:i,fromState:e,fromStyles:o,toState:r,toStyles:a,timelines:c,queriedElements:f,preStyleProps:_,postStyleProps:x,totalTime:C,errors:A}}const Bk={};class IU{_triggerName;ast;_stateStyles;constructor(n,e,r){this._triggerName=n,this.ast=e,this._stateStyles=r}match(n,e,r,i){return function Lie(t,n,e,r,i){return t.some(o=>o(n,e,r,i))}(this.ast.matchers,n,e,r,i)}buildStyles(n,e,r){let i=this._stateStyles.get("*");return void 0!==n&&(i=this._stateStyles.get(n?.toString())||i),i?i.buildStyles(e,r):new Map}build(n,e,r,i,o,a,c,f,_,x){const C=[],A=this.ast.options&&this.ast.options.params||Bk,U=this.buildStyles(r,c&&c.params||Bk,C),ne=f&&f.params||Bk,ce=this.buildStyles(i,ne,C),xe=new Set,Ce=new Map,Ze=new Map,Se="void"===i,Ee={params:kU(ne,A),delay:this.ast.options?.delay},ze=x?[]:Lk(n,e,this.ast.animation,o,a,U,ce,Ee,_,C);let Xe=0;return ze.forEach(yt=>{Xe=Math.max(yt.duration+yt.delay,Xe)}),C.length?SU(e,this._triggerName,r,i,Se,U,ce,[],[],Ce,Ze,Xe,C):(ze.forEach(yt=>{const an=yt.element,un=Nl(Ce,an,new Set);yt.preStyleProps.forEach(Di=>un.add(Di));const Vi=Nl(Ze,an,new Set);yt.postStyleProps.forEach(Di=>Vi.add(Di)),an!==e&&xe.add(an)}),SU(e,this._triggerName,r,i,Se,U,ce,ze,[...xe.values()],Ce,Ze,Xe))}}function kU(t,n){const e={...n};return Object.entries(t).forEach(([r,i])=>{null!=i&&(e[r]=i)}),e}class Fie{styles;defaultParams;normalizer;constructor(n,e,r){this.styles=n,this.defaultParams=e,this.normalizer=r}buildStyles(n,e){const r=new Map,i=kU(n,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{a&&(a=Rb(a,i,e));const f=this.normalizer.normalizePropertyName(c,e);a=this.normalizer.normalizeStyleValue(c,f,a,e),r.set(c,a)})}),r}}class Vie{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(n,e,r){this.name=n,this.ast=e,this._normalizer=r,e.states.forEach(i=>{this.states.set(i.name,new Fie(i.style,i.options&&i.options.params||{},r))}),AU(this.states,"true","1"),AU(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new IU(n,i,this.states))}),this.fallbackTransition=function Uie(t,n){return new IU(t,{type:vn.Transition,animation:{type:vn.Sequence,steps:[],options:null},matchers:[(a,c)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,r,i){return this.transitionFactories.find(a=>a.match(n,e,r,i))||null}matchStyles(n,e,r){return this.fallbackTransition.buildStyles(n,e,r)}}function AU(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const zie=new xE;class jie{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r}register(n,e){const r=[],o=Pk(this._driver,e,r,[]);if(r.length)throw function Gre(){return new ue(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,r){const i=n.element,o=fU(this._normalizer,n.keyframes,e,r);return this._driver.animate(i,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,r={}){const i=[],o=this._animations.get(n);let a;const c=new Map;if(o?(a=Lk(this._driver,e,o,vU,Ek,new Map,new Map,r,zie,i),a.forEach(x=>{const C=Nl(c,x.element,new Map);x.postStyleProps.forEach(A=>C.set(A,null))})):(i.push(function Wre(){return new ue(3300,!1)}()),a=[]),i.length)throw function Zre(){return new ue(3504,!1)}();c.forEach((x,C)=>{x.forEach((A,N)=>{x.set(N,this._driver.computeStyle(C,N,Rh))})});const _=pp(a.map(x=>{const C=c.get(x.element);return this._buildPlayer(x,new Map,C)}));return this._playersById.set(n,_),_.onDestroy(()=>this.destroy(n)),this.players.push(_),_}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Kre(){return new ue(3301,!1)}();return e}listen(n,e,r,i){const o=wk(e,"","","");return vk(this._getPlayer(n),r,o,i),()=>{}}command(n,e,r,i){if("register"==r)return void this.register(n,i[0]);if("create"==r)return void this.create(n,e,i[0]||{});const o=this._getPlayer(n);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(n)}}}const MU="ng-animate-queued",Vk="ng-animate-disabled",Wie=[],RU={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Zie={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},fu="__ng_removed";class Uk{namespaceId;value;options;get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const r=n&&n.hasOwnProperty("value");if(this.value=function Qie(t){return t??null}(r?n.value:n),r){const{value:o,...a}=n;this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const r=this.options.params;Object.keys(e).forEach(i=>{null==r[i]&&(r[i]=e[i])})}}}const Pb="void",zk=new Uk(Pb);class Kie{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(n,e,r){this.id=n,this.hostElement=e,this._engine=r,this._hostClassName="ng-tns-"+n,Dc(e,this._hostClassName)}listen(n,e,r,i){if(!this._triggers.has(e))throw function Yre(){return new ue(3302,!1)}();if(null==r||0==r.length)throw function Xre(){return new ue(3303,!1)}();if(!function Jie(t){return"start"==t||"done"==t}(r))throw function Qre(){return new ue(3400,!1)}();const o=Nl(this._elementListeners,n,[]),a={name:e,phase:r,callback:i};o.push(a);const c=Nl(this._engine.statesByElement,n,new Map);return c.has(e)||(Dc(n,gE),Dc(n,gE+"-"+e),c.set(e,zk)),()=>{this._engine.afterFlush(()=>{const f=o.indexOf(a);f>=0&&o.splice(f,1),this._triggers.has(e)||c.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function Jre(){return new ue(3401,!1)}();return e}trigger(n,e,r,i=!0){const o=this._getTrigger(e),a=new jk(this.id,e,n);let c=this._engine.statesByElement.get(n);c||(Dc(n,gE),Dc(n,gE+"-"+e),this._engine.statesByElement.set(n,c=new Map));let f=c.get(e);const _=new Uk(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&f&&_.absorbOptions(f.options),c.set(e,_),f||(f=zk),_.value!==Pb&&f.value===_.value){if(!function noe(t,n){const e=Object.keys(t),r=Object.keys(n);if(e.length!=r.length)return!1;for(let i=0;i<e.length;i++){const o=e[i];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(f.params,_.params)){const ne=[],ce=o.matchStyles(f.value,f.params,ne),xe=o.matchStyles(_.value,_.params,ne);ne.length?this._engine.reportError(ne):this._engine.afterFlush(()=>{Ym(n,ce),yd(n,xe)})}return}const A=Nl(this._engine.playersByElement,n,[]);A.forEach(ne=>{ne.namespaceId==this.id&&ne.triggerName==e&&ne.queued&&ne.destroy()});let N=o.matchTransition(f.value,_.value,n,_.params),U=!1;if(!N){if(!i)return;N=o.fallbackTransition,U=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:N,fromState:f,toState:_,player:a,isFallbackTransition:U}),U||(Dc(n,MU),a.onStart(()=>{iy(n,MU)})),a.onDone(()=>{let ne=this.players.indexOf(a);ne>=0&&this.players.splice(ne,1);const ce=this._engine.playersByElement.get(n);if(ce){let xe=ce.indexOf(a);xe>=0&&ce.splice(xe,1)}}),this.players.push(a),A.push(a),a}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(i=>i.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const r=this._engine.driver.query(n,_E,!0);r.forEach(i=>{if(i[fu])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(a=>a.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(n,e,r,i){const o=this._engine.statesByElement.get(n),a=new Map;if(o){const c=[];if(o.forEach((f,_)=>{if(a.set(_,f.value),this._triggers.has(_)){const x=this.trigger(n,_,Pb,i);x&&c.push(x)}}),c.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,a),r&&pp(c).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(e&&r){const i=new Set;e.forEach(o=>{const a=o.name;if(i.has(a))return;i.add(a);const f=this._triggers.get(a).fallbackTransition,_=r.get(a)||zk,x=new Uk(Pb),C=new jk(this.id,a,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:a,transition:f,fromState:_,toState:x,player:C,isFallbackTransition:!0})})}}removeNode(n,e){const r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let i=!1;if(r.totalAnimations){const o=r.players.length?r.playersByQueriedElement.get(n):[];if(o&&o.length)i=!0;else{let a=n;for(;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(n),i)r.markElementAsRemoved(this.id,n,!1,e);else{const o=n[fu];(!o||o===RU)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,e))}}insertNode(n,e){Dc(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const o=r.element,a=this._elementListeners.get(o);a&&a.forEach(c=>{if(c.name==r.triggerName){const f=wk(o,r.triggerName,r.fromState.value,r.toState.value);f._data=n,vk(r.player,c.phase,f,c.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(r)}),this._queue=[],e.sort((r,i)=>{const o=r.transition.ast.depCount,a=i.transition.ast.depCount;return 0==o||0==a?o-a:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Yie{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(n,e)=>{};_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,r){this.bodyNode=n,this.driver=e,this._normalizer=r}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,e){const r=new Kie(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,e){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let a=!1,c=this.driver.getParentElement(e);for(;c;){const f=i.get(c);if(f){const _=r.indexOf(f);r.splice(_+1,0,n),a=!0;break}c=this.driver.getParentElement(c)}a||r.unshift(n)}else r.push(n);return i.set(e,n),n}register(n,e){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,e)),r}registerTrigger(n,e,r){let i=this._namespaceLookup[n];i&&i.register(e,r)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(n);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,r=this.statesByElement.get(n);if(r)for(let i of r.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&e.add(o)}return e}trigger(n,e,r,i){if(DE(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,r,i),!0}return!1}insertNode(n,e,r,i){if(!DE(e))return;const o=e[fu];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const a=this.collectedLeaveElements.indexOf(e);a>=0&&this.collectedLeaveElements.splice(a,1)}if(n){const a=this._fetchNamespace(n);a&&a.insertNode(e,r)}i&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Dc(n,Vk)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),iy(n,Vk))}removeNode(n,e,r){if(DE(e)){const i=n?this._fetchNamespace(n):null;i?i.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r);const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,r)}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,r,i,o){this.collectedLeaveElements.push(e),e[fu]={namespaceId:n,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,r,i,o){return DE(e)?this._fetchNamespace(n).listen(e,r,i,o):()=>{}}_buildInstruction(n,e,r,i,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,i,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,_E,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,Ck,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return pp(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[fu];if(e&&e.setForRemoval){if(n[fu]=RU,e.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(Vk)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Dc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,n)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?pp(e).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(n){throw function eie(){return new ue(3402,!1)}()}_flushAnimations(n,e){const r=new xE,i=[],o=new Map,a=[],c=new Map,f=new Map,_=new Map,x=new Set;this.disabledNodes.forEach(Nt=>{x.add(Nt);const Jt=this.driver.query(Nt,".ng-animate-queued",!0);for(let dn=0;dn<Jt.length;dn++)x.add(Jt[dn])});const C=this.bodyNode,A=Array.from(this.statesByElement.keys()),N=OU(A,this.collectedEnterElements),U=new Map;let ne=0;N.forEach((Nt,Jt)=>{const dn=vU+ne++;U.set(Jt,dn),Nt.forEach(hr=>Dc(hr,dn))});const ce=[],xe=new Set,Ce=new Set;for(let Nt=0;Nt<this.collectedLeaveElements.length;Nt++){const Jt=this.collectedLeaveElements[Nt],dn=Jt[fu];dn&&dn.setForRemoval&&(ce.push(Jt),xe.add(Jt),dn.hasAnimation?this.driver.query(Jt,".ng-star-inserted",!0).forEach(hr=>xe.add(hr)):Ce.add(Jt))}const Ze=new Map,Se=OU(A,Array.from(xe));Se.forEach((Nt,Jt)=>{const dn=Ek+ne++;Ze.set(Jt,dn),Nt.forEach(hr=>Dc(hr,dn))}),n.push(()=>{N.forEach((Nt,Jt)=>{const dn=U.get(Jt);Nt.forEach(hr=>iy(hr,dn))}),Se.forEach((Nt,Jt)=>{const dn=Ze.get(Jt);Nt.forEach(hr=>iy(hr,dn))}),ce.forEach(Nt=>{this.processLeaveNode(Nt)})});const Ee=[],ze=[];for(let Nt=this._namespaceList.length-1;Nt>=0;Nt--)this._namespaceList[Nt].drainQueuedTransitions(e).forEach(dn=>{const hr=dn.player,Xo=dn.element;if(Ee.push(hr),this.collectedEnterElements.length){const ir=Xo[fu];if(ir&&ir.setForMove){if(ir.previousTriggersValues&&ir.previousTriggersValues.has(dn.triggerName)){const sa=ir.previousTriggersValues.get(dn.triggerName),Is=this.statesByElement.get(dn.element);if(Is&&Is.has(dn.triggerName)){const Ng=Is.get(dn.triggerName);Ng.value=sa,Is.set(dn.triggerName,Ng)}}return void hr.destroy()}}const jl=!C||!this.driver.containsElement(C,Xo),Ss=Ze.get(Xo),Au=U.get(Xo),Ti=this._buildInstruction(dn,r,Au,Ss,jl);if(Ti.errors&&Ti.errors.length)return void ze.push(Ti);if(jl)return hr.onStart(()=>Ym(Xo,Ti.fromStyles)),hr.onDestroy(()=>yd(Xo,Ti.toStyles)),void i.push(hr);if(dn.isFallbackTransition)return hr.onStart(()=>Ym(Xo,Ti.fromStyles)),hr.onDestroy(()=>yd(Xo,Ti.toStyles)),void i.push(hr);const pT=[];Ti.timelines.forEach(ir=>{ir.stretchStartingKeyframe=!0,this.disabledNodes.has(ir.element)||pT.push(ir)}),Ti.timelines=pT,r.append(Xo,Ti.timelines),a.push({instruction:Ti,player:hr,element:Xo}),Ti.queriedElements.forEach(ir=>Nl(c,ir,[]).push(hr)),Ti.preStyleProps.forEach((ir,sa)=>{if(ir.size){let Is=f.get(sa);Is||f.set(sa,Is=new Set),ir.forEach((Ng,_O)=>Is.add(_O))}}),Ti.postStyleProps.forEach((ir,sa)=>{let Is=_.get(sa);Is||_.set(sa,Is=new Set),ir.forEach((Ng,_O)=>Is.add(_O))})});if(ze.length){const Nt=[];ze.forEach(Jt=>{Nt.push(function tie(){return new ue(3505,!1)}())}),Ee.forEach(Jt=>Jt.destroy()),this.reportError(Nt)}const Xe=new Map,yt=new Map;a.forEach(Nt=>{const Jt=Nt.element;r.has(Jt)&&(yt.set(Jt,Jt),this._beforeAnimationBuild(Nt.player.namespaceId,Nt.instruction,Xe))}),i.forEach(Nt=>{const Jt=Nt.element;this._getPreviousPlayers(Jt,!1,Nt.namespaceId,Nt.triggerName,null).forEach(hr=>{Nl(Xe,Jt,[]).push(hr),hr.destroy()})});const an=ce.filter(Nt=>FU(Nt,f,_)),un=new Map;NU(un,this.driver,Ce,_,Rh).forEach(Nt=>{FU(Nt,f,_)&&an.push(Nt)});const Di=new Map;N.forEach((Nt,Jt)=>{NU(Di,this.driver,new Set(Nt),f,"!")}),an.forEach(Nt=>{const Jt=un.get(Nt),dn=Di.get(Nt);un.set(Nt,new Map([...Jt?.entries()??[],...dn?.entries()??[]]))});const ul=[],Bd=[],Pw={};a.forEach(Nt=>{const{element:Jt,player:dn,instruction:hr}=Nt;if(r.has(Jt)){if(x.has(Jt))return dn.onDestroy(()=>yd(Jt,hr.toStyles)),dn.disabled=!0,dn.overrideTotalTime(hr.totalTime),void i.push(dn);let Xo=Pw;if(yt.size>1){let Ss=Jt;const Au=[];for(;Ss=Ss.parentNode;){const Ti=yt.get(Ss);if(Ti){Xo=Ti;break}Au.push(Ss)}Au.forEach(Ti=>yt.set(Ti,Xo))}const jl=this._buildAnimation(dn.namespaceId,hr,Xe,o,Di,un);if(dn.setRealPlayer(jl),Xo===Pw)ul.push(dn);else{const Ss=this.playersByElement.get(Xo);Ss&&Ss.length&&(dn.parentPlayer=pp(Ss)),i.push(dn)}}else Ym(Jt,hr.fromStyles),dn.onDestroy(()=>yd(Jt,hr.toStyles)),Bd.push(dn),x.has(Jt)&&i.push(dn)}),Bd.forEach(Nt=>{const Jt=o.get(Nt.element);if(Jt&&Jt.length){const dn=pp(Jt);Nt.setRealPlayer(dn)}}),i.forEach(Nt=>{Nt.parentPlayer?Nt.syncPlayerEvents(Nt.parentPlayer):Nt.destroy()});for(let Nt=0;Nt<ce.length;Nt++){const Jt=ce[Nt],dn=Jt[fu];if(iy(Jt,Ek),dn&&dn.hasAnimation)continue;let hr=[];if(c.size){let jl=c.get(Jt);jl&&jl.length&&hr.push(...jl);let Ss=this.driver.query(Jt,Ck,!0);for(let Au=0;Au<Ss.length;Au++){let Ti=c.get(Ss[Au]);Ti&&Ti.length&&hr.push(...Ti)}}const Xo=hr.filter(jl=>!jl.destroyed);Xo.length?eoe(this,Jt,Xo):this.processLeaveNode(Jt)}return ce.length=0,ul.forEach(Nt=>{this.players.push(Nt),Nt.onDone(()=>{Nt.destroy();const Jt=this.players.indexOf(Nt);this.players.splice(Jt,1)}),Nt.play()}),ul}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,r,i,o){let a=[];if(e){const c=this.playersByQueriedElement.get(n);c&&(a=c)}else{const c=this.playersByElement.get(n);if(c){const f=!o||o==Pb;c.forEach(_=>{_.queued||!f&&_.triggerName!=i||a.push(_)})}}return(r||i)&&(a=a.filter(c=>!(r&&r!=c.namespaceId||i&&i!=c.triggerName))),a}_beforeAnimationBuild(n,e,r){const o=e.element,a=e.isRemovalTransition?void 0:n,c=e.isRemovalTransition?void 0:e.triggerName;for(const f of e.timelines){const _=f.element,x=_!==o,C=Nl(r,_,[]);this._getPreviousPlayers(_,x,a,c,e.toState).forEach(N=>{const U=N.getRealPlayer();U.beforeDestroy&&U.beforeDestroy(),N.destroy(),C.push(N)})}Ym(o,e.fromStyles)}_buildAnimation(n,e,r,i,o,a){const c=e.triggerName,f=e.element,_=[],x=new Set,C=new Set,A=e.timelines.map(U=>{const ne=U.element;x.add(ne);const ce=ne[fu];if(ce&&ce.removedBeforeQueried)return new Ab(U.duration,U.delay);const xe=ne!==f,Ce=function toe(t){const n=[];return LU(t,n),n}((r.get(ne)||Wie).map(Xe=>Xe.getRealPlayer())).filter(Xe=>!!Xe.element&&Xe.element===ne),Ze=o.get(ne),Se=a.get(ne),Ee=fU(this._normalizer,U.keyframes,Ze,Se),ze=this._buildPlayer(U,Ee,Ce);if(U.subTimeline&&i&&C.add(ne),xe){const Xe=new jk(n,c,ne);Xe.setRealPlayer(ze),_.push(Xe)}return ze});_.forEach(U=>{Nl(this.playersByQueriedElement,U.element,[]).push(U),U.onDone(()=>function Xie(t,n,e){let r=t.get(n);if(r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&t.delete(n)}return r}(this.playersByQueriedElement,U.element,U))}),x.forEach(U=>Dc(U,bU));const N=pp(A);return N.onDestroy(()=>{x.forEach(U=>iy(U,bU)),yd(f,e.toStyles)}),C.forEach(U=>{Nl(i,U,[]).push(N)}),N}_buildPlayer(n,e,r){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,r):new Ab(n.duration,n.delay)}}class jk{namespaceId;triggerName;element;_player=new Ab;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(n,e,r){this.namespaceId=n,this.triggerName=e,this.element=r}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,r)=>{e.forEach(i=>vk(n,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Nl(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function DE(t){return t&&1===t.nodeType}function PU(t,n){const e=t.style.display;return t.style.display=n??"none",e}function NU(t,n,e,r,i){const o=[];e.forEach(f=>o.push(PU(f)));const a=[];r.forEach((f,_)=>{const x=new Map;f.forEach(C=>{const A=n.computeStyle(_,C,i);x.set(C,A),(!A||0==A.length)&&(_[fu]=Zie,a.push(_))}),t.set(_,x)});let c=0;return e.forEach(f=>PU(f,o[c++])),a}function OU(t,n){const e=new Map;if(t.forEach(c=>e.set(c,[])),0==n.length)return e;const i=new Set(n),o=new Map;function a(c){if(!c)return 1;let f=o.get(c);if(f)return f;const _=c.parentNode;return f=e.has(_)?_:i.has(_)?1:a(_),o.set(c,f),f}return n.forEach(c=>{const f=a(c);1!==f&&e.get(f).push(c)}),e}function Dc(t,n){t.classList?.add(n)}function iy(t,n){t.classList?.remove(n)}function eoe(t,n,e){pp(e).onDone(()=>t.processLeaveNode(n))}function LU(t,n){for(let e=0;e<t.length;e++){const r=t[e];r instanceof dU?LU(r.players,n):n.push(r)}}function FU(t,n,e){const r=e.get(t);if(!r)return!1;let i=n.get(t);return i?r.forEach(o=>i.add(o)):n.set(t,r),e.delete(t),!0}class Nb{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(n,e)=>{};constructor(n,e,r){this._driver=e,this._normalizer=r,this._transitionEngine=new Yie(n.body,e,r),this._timelineEngine=new jie(n.body,e,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(n,e,r,i,o){const a=n+"-"+i;let c=this._triggerCache[a];if(!c){const f=[],x=Pk(this._driver,o,f,[]);if(f.length)throw function $re(){return new ue(3404,!1)}();c=function Bie(t,n,e){return new Vie(t,n,e)}(i,x,this._normalizer),this._triggerCache[a]=c}this._transitionEngine.registerTrigger(e,i,c)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,r,i){this._transitionEngine.insertNode(n,e,r,i)}onRemove(n,e,r){this._transitionEngine.removeNode(n,e,r)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,r,i){if("@"==r.charAt(0)){const[o,a]=pU(r);this._timelineEngine.command(o,e,a,i)}else this._transitionEngine.trigger(n,e,r,i)}listen(n,e,r,i,o){if("@"==r.charAt(0)){const[a,c]=pU(r);return this._timelineEngine.listen(a,e,c,o)}return this._transitionEngine.listen(n,e,r,i,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let ioe=(()=>{class t{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(e,r,i){this._element=e,this._startStyles=r,this._endStyles=i;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&yd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(yd(this._element,this._initialStyles),this._endStyles&&(yd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Ym(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ym(this._element,this._endStyles),this._endStyles=null),yd(this._element,this._initialStyles),this._state=3)}}return t})();function Hk(t){let n=null;return t.forEach((e,r)=>{(function ooe(t){return"display"===t||"position"===t})(r)&&(n=n||new Map,n.set(r,e))}),n}class BU{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer=null;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(n,e,r,i){this.element=n,this.keyframes=e,this.options=r,this._specialStyles=i,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer()&&this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return this.domPlayer;this._initialized=!0;const n=this.keyframes,e=this._triggerWebAnimation(this.element,n,this.options);if(!e)return this._onFinish(),null;this.domPlayer=e,this._finalKeyframe=n.length?n[n.length-1]:new Map;const r=()=>this._onFinish();return e.addEventListener("finish",r),this.onDestroy(()=>{e.removeEventListener("finish",r)}),e}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer?.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(n,e,r){const i=this._convertKeyframesToObject(e);try{return n.animate(i,r)}catch{return null}}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){const n=this._buildPlayer();n&&(this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),n.play())}pause(){this.init(),this.domPlayer?.pause()}finish(){this.init(),this.domPlayer&&(this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish())}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer?.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){this.domPlayer||this.init(),this.domPlayer&&(this.domPlayer.currentTime=n*this.time)}getPosition(){return this.domPlayer?+(this.domPlayer.currentTime??0)/this.time:this._initialized?1:0}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&n.set(i,this._finished?r:Ik(this.element,i))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class VU{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}containsElement(n,e){return gU(n,e)}getParentElement(n){return xk(n)}query(n,e,r){return _U(n,e,r)}computeStyle(n,e,r){return Ik(n,e)}animate(n,e,r,i,o,a=[]){const f={duration:r,delay:i,fill:0==i?"both":"forwards"};o&&(f.easing=o);const _=new Map,x=a.filter(N=>N instanceof BU);(function pie(t,n){return 0===t||0===n})(r,i)&&x.forEach(N=>{N.currentSnapshot.forEach((U,ne)=>_.set(ne,U))});let C=function die(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}(e).map(N=>new Map(N));C=function mie(t,n,e){if(e.size&&n.length){let r=n[0],i=[];if(e.forEach((o,a)=>{r.has(a)||i.push(a),r.set(a,o)}),i.length)for(let o=1;o<n.length;o++){let a=n[o];i.forEach(c=>a.set(c,Ik(t,c)))}}return n}(n,C,_);const A=function roe(t,n){let e=null,r=null;return Array.isArray(n)&&n.length?(e=Hk(n[0]),n.length>1&&(r=Hk(n[n.length-1]))):n instanceof Map&&(e=Hk(n)),e||r?new ioe(t,e,r):null}(n,C);return new BU(n,C,f,A)}}const UU="@.disabled";class zU{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(n,e,r,i){this.namespaceId=n,this.delegate=e,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,r,i=!0){this.delegate.insertBefore(n,e,r),this.engine.onInsert(this.namespaceId,e,n,i)}removeChild(n,e,r,i){i?this.delegate.removeChild(n,e,r,i):this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,r,i){this.delegate.setAttribute(n,e,r,i)}removeAttribute(n,e,r){this.delegate.removeAttribute(n,e,r)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,r,i){this.delegate.setStyle(n,e,r,i)}removeStyle(n,e,r){this.delegate.removeStyle(n,e,r)}setProperty(n,e,r){"@"==e.charAt(0)&&e==UU?this.disableAnimations(n,!!r):this.delegate.setProperty(n,e,r)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,r,i){return this.delegate.listen(n,e,r,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class soe extends zU{factory;constructor(n,e,r,i,o){super(e,r,i,o),this.factory=n,this.namespaceId=e}setProperty(n,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==UU?this.disableAnimations(n,r=void 0===r||!!r):this.engine.process(this.namespaceId,n,e.slice(1),r):this.delegate.setProperty(n,e,r)}listen(n,e,r,i){if("@"==e.charAt(0)){const o=function aoe(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let a=e.slice(1),c="";return"@"!=a.charAt(0)&&([a,c]=function loe(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(a)),this.engine.listen(this.namespaceId,o,a,c,f=>{this.factory.scheduleListenerCallback(f._data||-1,r,f)})}return this.delegate.listen(n,e,r,i)}}class coe{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(n,e,r){this.delegate=n,this.engine=e,this._zone=r,e.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(n,e){const i=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){const _=this._rendererCache;let x=_.get(i);return x||(x=new zU("",i,this.engine,()=>_.delete(i)),_.set(i,x)),x}const o=e.id,a=e.id+"-"+this._currentId;this._currentId++,this.engine.register(a,n);const c=_=>{Array.isArray(_)?_.forEach(c):this.engine.registerTrigger(o,a,n,_.name,_)};return e.data.animation.forEach(c),new soe(this,a,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,r){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>e(r));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),i.push([e,r])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(n){this.engine.flush(),this.delegate.componentReplaced?.(n)}}const poe=[{provide:Ak,useFactory:()=>new VU},{provide:_a,useFactory:()=>"BrowserAnimations"},...[{provide:Mk,useFactory:function doe(){return new xU}},{provide:Nb,useClass:(()=>{class t extends Nb{constructor(e,r,i){super(e,r,i)}ngOnDestroy(){this.flush()}static \u0275fac=function(r){return new(r||t)(Tt(Wn),Tt(Ak),Tt(Mk))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})()},{provide:Rl,useFactory:function hoe(){return new coe(Q(dk),Q(Nb),Q(sn))}}]];function $k(t,n){return t?n?t.endsWith("/")?n.startsWith("/")?t+n.slice(1):t+n:n.startsWith("/")?t+n:`${t}/${n}`:t:n}function HU(t){const n=t.search(/#|\?|$/);return"/"===t[n-1]?t.slice(0,n-1)+t.slice(n):t}function Nh(t){return t&&"?"!==t[0]?`?${t}`:t}let Qm=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(qU),providedIn:"root"})}return t})();const $U=new Ue("");let qU=(()=>{class t extends Qm{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Q(Wn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return $k(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Nh(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,o){const a=this.prepareExternalUrl(i+Nh(o));this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){const a=this.prepareExternalUrl(i+Nh(o));this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||t)(Tt(dE),Tt($U,8))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),oy=(()=>{class t{_subject=new ee;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._basePath=function yoe(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(HU(GU(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Nh(r))}normalize(e){return t.stripTrailingSlash(function _oe(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,GU(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._locationStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Nh(r)),i)}replaceState(e,r="",i=null){this._locationStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Nh(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Nh;static joinWithSlash=$k;static stripTrailingSlash=HU;static \u0275fac=function(r){return new(r||t)(Tt(Qm))};static \u0275prov=$e({token:t,factory:()=>function goe(){return new oy(Tt(Qm))}(),providedIn:"root"})}return t})();function GU(t){return t.replace(/\/index.html$/,"")}let voe=(()=>{class t extends Qm{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){const r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=$k(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,i,o){const a=this.prepareExternalUrl(i+Nh(o))||this._platformLocation.pathname;this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){const a=this.prepareExternalUrl(i+Nh(o))||this._platformLocation.pathname;this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||t)(Tt(dE),Tt($U,8))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();var wa=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(wa||{}),ri=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(ri||{}),Ll=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Ll||{});function IE(t,n){return Sc(va(t)[xi.DateFormat],n)}function kE(t,n){return Sc(va(t)[xi.TimeFormat],n)}function AE(t,n){return Sc(va(t)[xi.DateTimeFormat],n)}function Tc(t,n){const e=va(t),r=e[xi.NumberSymbols][n];if(typeof r>"u"){if(12===n)return e[xi.NumberSymbols][0];if(13===n)return e[xi.NumberSymbols][1]}return r}function ZU(t){if(!t[xi.ExtraData])throw new ue(2303,!1)}function Sc(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new ue(2304,!1)}function Gk(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const Poe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ME={},Noe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function Ooe(t,n,e,r){let i=function $oe(t){if(XU(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[i,o=1,a=1]=t.split("-").map(c=>+c);return RE(i,o-1,a)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let r;if(r=t.match(Poe))return function qoe(t){const n=new Date(0);let e=0,r=0;const i=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const a=Number(t[4]||0)-e,c=Number(t[5]||0)-r,f=Number(t[6]||0),_=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,a,c,f,_),n}(r)}const n=new Date(t);if(!XU(n))throw new ue(2311,!1);return n}(t);n=Oh(e,n)||n;let c,a=[];for(;n;){if(c=Noe.exec(n),!c){a.push(n);break}{a=a.concat(c.slice(1));const x=a.pop();if(!x)break;n=x}}let f=i.getTimezoneOffset();r&&(f=YU(r,f),i=function Hoe(t,n){const i=t.getTimezoneOffset();return function joe(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,-1*(YU(n,i)-i))}(i,r));let _="";return a.forEach(x=>{const C=function zoe(t){if(Zk[t])return Zk[t];let n;switch(t){case"G":case"GG":case"GGG":n=di(3,ri.Abbreviated);break;case"GGGG":n=di(3,ri.Wide);break;case"GGGGG":n=di(3,ri.Narrow);break;case"y":n=Wo(0,1,0,!1,!0);break;case"yy":n=Wo(0,2,0,!0,!0);break;case"yyy":n=Wo(0,3,0,!1,!0);break;case"yyyy":n=Wo(0,4,0,!1,!0);break;case"Y":n=LE(1);break;case"YY":n=LE(2,!0);break;case"YYY":n=LE(3);break;case"YYYY":n=LE(4);break;case"M":case"L":n=Wo(1,1,1);break;case"MM":case"LL":n=Wo(1,2,1);break;case"MMM":n=di(2,ri.Abbreviated);break;case"MMMM":n=di(2,ri.Wide);break;case"MMMMM":n=di(2,ri.Narrow);break;case"LLL":n=di(2,ri.Abbreviated,wa.Standalone);break;case"LLLL":n=di(2,ri.Wide,wa.Standalone);break;case"LLLLL":n=di(2,ri.Narrow,wa.Standalone);break;case"w":n=Wk(1);break;case"ww":n=Wk(2);break;case"W":n=Wk(1,!0);break;case"d":n=Wo(2,1);break;case"dd":n=Wo(2,2);break;case"c":case"cc":n=Wo(7,1);break;case"ccc":n=di(1,ri.Abbreviated,wa.Standalone);break;case"cccc":n=di(1,ri.Wide,wa.Standalone);break;case"ccccc":n=di(1,ri.Narrow,wa.Standalone);break;case"cccccc":n=di(1,ri.Short,wa.Standalone);break;case"E":case"EE":case"EEE":n=di(1,ri.Abbreviated);break;case"EEEE":n=di(1,ri.Wide);break;case"EEEEE":n=di(1,ri.Narrow);break;case"EEEEEE":n=di(1,ri.Short);break;case"a":case"aa":case"aaa":n=di(0,ri.Abbreviated);break;case"aaaa":n=di(0,ri.Wide);break;case"aaaaa":n=di(0,ri.Narrow);break;case"b":case"bb":case"bbb":n=di(0,ri.Abbreviated,wa.Standalone,!0);break;case"bbbb":n=di(0,ri.Wide,wa.Standalone,!0);break;case"bbbbb":n=di(0,ri.Narrow,wa.Standalone,!0);break;case"B":case"BB":case"BBB":n=di(0,ri.Abbreviated,wa.Format,!0);break;case"BBBB":n=di(0,ri.Wide,wa.Format,!0);break;case"BBBBB":n=di(0,ri.Narrow,wa.Format,!0);break;case"h":n=Wo(3,1,-12);break;case"hh":n=Wo(3,2,-12);break;case"H":n=Wo(3,1);break;case"HH":n=Wo(3,2);break;case"m":n=Wo(4,1);break;case"mm":n=Wo(4,2);break;case"s":n=Wo(5,1);break;case"ss":n=Wo(5,2);break;case"S":n=Wo(6,1);break;case"SS":n=Wo(6,2);break;case"SSS":n=Wo(6,3);break;case"Z":case"ZZ":case"ZZZ":n=NE(0);break;case"ZZZZZ":n=NE(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=NE(1);break;case"OOOO":case"ZZZZ":case"zzzz":n=NE(2);break;default:return null}return Zk[t]=n,n}(x);_+=C?C(i,e,f):"''"===x?"'":x.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),_}function RE(t,n,e){const r=new Date(0);return r.setFullYear(t,n,e),r.setHours(0,0,0),r}function Oh(t,n){const e=function woe(t){return va(t)[xi.LocaleId]}(t);if(ME[e]??={},ME[e][n])return ME[e][n];let r="";switch(n){case"shortDate":r=IE(t,Ll.Short);break;case"mediumDate":r=IE(t,Ll.Medium);break;case"longDate":r=IE(t,Ll.Long);break;case"fullDate":r=IE(t,Ll.Full);break;case"shortTime":r=kE(t,Ll.Short);break;case"mediumTime":r=kE(t,Ll.Medium);break;case"longTime":r=kE(t,Ll.Long);break;case"fullTime":r=kE(t,Ll.Full);break;case"short":const i=Oh(t,"shortTime"),o=Oh(t,"shortDate");r=PE(AE(t,Ll.Short),[i,o]);break;case"medium":const a=Oh(t,"mediumTime"),c=Oh(t,"mediumDate");r=PE(AE(t,Ll.Medium),[a,c]);break;case"long":const f=Oh(t,"longTime"),_=Oh(t,"longDate");r=PE(AE(t,Ll.Long),[f,_]);break;case"full":const x=Oh(t,"fullTime"),C=Oh(t,"fullDate");r=PE(AE(t,Ll.Full),[x,C])}return r&&(ME[e][n]=r),r}function PE(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,r){return null!=n&&r in n?n[r]:e})),t}function pu(t,n,e="-",r,i){let o="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,o=e));let a=String(t);for(;a.length<n;)a="0"+a;return r&&(a=a.slice(a.length-n)),o+a}function Wo(t,n,e=0,r=!1,i=!1){return function(o,a){let c=function Foe(t,n){switch(t){case 0:return n.getFullYear();case 1:return n.getMonth();case 2:return n.getDate();case 3:return n.getHours();case 4:return n.getMinutes();case 5:return n.getSeconds();case 6:return n.getMilliseconds();case 7:return n.getDay();default:throw new ue(2301,!1)}}(t,o);if((e>0||c>-e)&&(c+=e),3===t)0===c&&-12===e&&(c=12);else if(6===t)return function Loe(t,n){return pu(t,3).substring(0,n)}(c,n);const f=Tc(a,5);return pu(c,n,f,r,i)}}function di(t,n,e=wa.Format,r=!1){return function(i,o){return function Boe(t,n,e,r,i,o){switch(e){case 2:return function Coe(t,n,e){const r=va(t),o=Sc([r[xi.MonthsFormat],r[xi.MonthsStandalone]],n);return Sc(o,e)}(n,i,r)[t.getMonth()];case 1:return function Eoe(t,n,e){const r=va(t),o=Sc([r[xi.DaysFormat],r[xi.DaysStandalone]],n);return Sc(o,e)}(n,i,r)[t.getDay()];case 0:const a=t.getHours(),c=t.getMinutes();if(o){const _=function Ioe(t){const n=va(t);return ZU(n),(n[xi.ExtraData][2]||[]).map(r=>"string"==typeof r?Gk(r):[Gk(r[0]),Gk(r[1])])}(n),x=function koe(t,n,e){const r=va(t);ZU(r);const o=Sc([r[xi.ExtraData][0],r[xi.ExtraData][1]],n)||[];return Sc(o,e)||[]}(n,i,r),C=_.findIndex(A=>{if(Array.isArray(A)){const[N,U]=A,ne=a>=N.hours&&c>=N.minutes,ce=a<U.hours||a===U.hours&&c<U.minutes;if(N.hours<U.hours){if(ne&&ce)return!0}else if(ne||ce)return!0}else if(A.hours===a&&A.minutes===c)return!0;return!1});if(-1!==C)return x[C]}return function xoe(t,n,e){const r=va(t),o=Sc([r[xi.DayPeriodsFormat],r[xi.DayPeriodsStandalone]],n);return Sc(o,e)}(n,i,r)[a<12?0:1];case 3:return function Doe(t,n){return Sc(va(t)[xi.Eras],n)}(n,r)[t.getFullYear()<=0?0:1];default:throw new ue(2302,!1)}}(i,o,t,n,e,r)}}function NE(t){return function(n,e,r){const i=-1*r,o=Tc(e,5),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case 0:return(i>=0?"+":"")+pu(a,2,o)+pu(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+pu(a,1,o);case 2:return"GMT"+(i>=0?"+":"")+pu(a,2,o)+":"+pu(Math.abs(i%60),2,o);case 3:return 0===r?"Z":(i>=0?"+":"")+pu(a,2,o)+":"+pu(Math.abs(i%60),2,o);default:throw new ue(2310,!1)}}}function KU(t){const n=t.getDay(),e=0===n?-3:4-n;return RE(t.getFullYear(),t.getMonth(),t.getDate()+e)}function Wk(t,n=!1){return function(e,r){let i;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,a=e.getDate();i=1+Math.floor((a+o)/7)}else{const o=KU(e),a=function Uoe(t){const n=RE(t,0,1).getDay();return RE(t,0,1+(n<=4?4:11)-n)}(o.getFullYear()),c=o.getTime()-a.getTime();i=1+Math.round(c/6048e5)}return pu(i,t,Tc(r,5))}}function LE(t,n=!1){return function(e,r){return pu(KU(e).getFullYear(),t,Tc(r,5),n)}}const Zk={};function YU(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function XU(t){return t instanceof Date&&!isNaN(t.valueOf())}const eA=/\s+/,tz=[];let nz=(()=>{class t{_ngEl;_renderer;initialClasses=tz;rawClass;stateMap=new Map;constructor(e,r){this._ngEl=e,this._renderer=r}set klass(e){this.initialClasses=null!=e?e.trim().split(eA):tz}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(eA):e}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const r of e)this._updateState(r,!0);else if(null!=e)for(const r of Object.keys(e))this._updateState(r,!!e[r]);this._applyStateDiff()}_updateState(e,r){const i=this.stateMap.get(e);void 0!==i?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const r=e[0],i=e[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(e,r){(e=e.trim()).length>0&&e.split(eA).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||t)(Ne(Ur),Ne(Xa))};static \u0275dir=Ft({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return t})();const wse=new Ue(""),xse=new Ue("");let BE=(()=>{class t{locale;defaultTimezone;defaultOptions;constructor(e,r,i){this.locale=e,this.defaultTimezone=r,this.defaultOptions=i}transform(e,r,i,o){if(null==e||""===e||e!=e)return null;try{return Ooe(e,r??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,i??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(a){throw function mu(t,n){return new ue(2100,!1)}()}}static \u0275fac=function(r){return new(r||t)(Ne(Ah,16),Ne(wse,24),Ne(xse,24))};static \u0275pipe=Qa({name:"date",type:t,pure:!0})}return t})(),Ic=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})();function ii(t,n){return function Pu(t,n){const e=Object.create(Aa);e.computation=t,void 0!==n&&(e.equal=n);const r=()=>{if(io(e),Oo(e),e.value===oo)throw e.error;return e.value};return r[He]=e,r}(t,n?.equal)}function hz(t){return!!t&&(t instanceof H||vr(t.lift)&&vr(t.subscribe))}function Jm(t){return this instanceof Jm?(this.v=t,this):new Jm(t)}function Wse(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function mz(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(o){e[o]=t[o]&&function(a){return new Promise(function(c,f){!function i(o,a,c,f){Promise.resolve(f).then(function(_){o({value:_,done:c})},a)}(c,f,(a=t[o](a)).done,a.value)})}}}Error,Error;const gz=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function _z(t){return vr(t?.then)}function yz(t){return vr(t[Yl])}function vz(t){return Symbol.asyncIterator&&vr(t?.[Symbol.asyncIterator])}function bz(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const wz=function Kse(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function xz(t){return vr(t?.[wz])}function Ez(t){return function Gse(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=e.apply(t,n||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(A){r[A]&&(i[A]=function(N){return new Promise(function(U,ne){o.push([A,N,U,ne])>1||c(A,N)})})}function c(A,N){try{!function f(A){A.value instanceof Jm?Promise.resolve(A.value.v).then(_,x):C(o[0][2],A)}(r[A](N))}catch(U){C(o[0][3],U)}}function _(A){c("next",A)}function x(A){c("throw",A)}function C(A,N){A(N),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:r,done:i}=yield Jm(e.read());if(i)return yield Jm(void 0);yield yield Jm(r)}}finally{e.releaseLock()}})}function Cz(t){return vr(t?.getReader)}function kc(t){if(t instanceof H)return t;if(null!=t){if(yz(t))return function Yse(t){return new H(n=>{const e=t[Yl]();if(vr(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(gz(t))return function Xse(t){return new H(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(_z(t))return function Qse(t){return new H(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Nu)})}(t);if(vz(t))return Dz(t);if(xz(t))return function Jse(t){return new H(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Cz(t))return function eae(t){return Dz(Ez(t))}(t)}throw bz(t)}function Dz(t){return new H(n=>{(function tae(t,n){var e,r,i,o;return function $se(t,n,e,r){return new(e||(e=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(C){a(C)}}function f(x){try{_(r.throw(x))}catch(C){a(C)}}function _(x){x.done?o(x.value):function i(o){return o instanceof e?o:new e(function(a){a(o)})}(x.value).then(c,f)}_((r=r.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Wse(t);!(r=yield e.next()).done;)if(n.next(r.value),n.closed)return}catch(a){i={error:a}}finally{try{r&&!r.done&&(o=e.return)&&(yield o.call(e))}finally{if(i)throw i.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function Lh(t,n,e,r=0,i=!1){const o=n.schedule(function(){e(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function Tz(t,n=0){return jo((e,r)=>{e.subscribe(new li(r,i=>Lh(r,t,()=>r.next(i),n),()=>Lh(r,t,()=>r.complete(),n),i=>Lh(r,t,()=>r.error(i),n)))})}function Sz(t,n=0){return jo((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function Iz(t,n){if(!t)throw new Error("Iterable cannot be null");return new H(e=>{Lh(e,n,()=>{const r=t[Symbol.asyncIterator]();Lh(e,n,()=>{r.next().then(i=>{i.done?e.complete():e.next(i.value)})},0,!0)})})}function xs(t,n){return n?function aae(t,n){if(null!=t){if(yz(t))return function nae(t,n){return kc(t).pipe(Sz(n),Tz(n))}(t,n);if(gz(t))return function iae(t,n){return new H(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}(t,n);if(_z(t))return function rae(t,n){return kc(t).pipe(Sz(n),Tz(n))}(t,n);if(vz(t))return Iz(t,n);if(xz(t))return function oae(t,n){return new H(e=>{let r;return Lh(e,n,()=>{r=t[wz](),Lh(e,n,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(a){return void e.error(a)}o?e.complete():e.next(i)},0,!0)}),()=>vr(r?.return)&&r.return()})}(t,n);if(Cz(t))return function sae(t,n){return Iz(Ez(t),n)}(t,n)}throw bz(t)}(t,n):kc(t)}function kz(t){return t&&vr(t.schedule)}function aA(t){return t[t.length-1]}function Az(t){return vr(aA(t))?t.pop():void 0}function Lb(t){return kz(aA(t))?t.pop():void 0}function Fn(...t){return xs(t,Lb(t))}const{isArray:cae}=Array,{getPrototypeOf:uae,prototype:dae,keys:hae}=Object;function Mz(t){if(1===t.length){const n=t[0];if(cae(n))return{args:n,keys:null};if(function fae(t){return t&&"object"==typeof t&&uae(t)===dae}(n)){const e=hae(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}const{isArray:pae}=Array;function Rz(t){return mr(n=>function mae(t,n){return pae(n)?t(...n):t(n)}(t,n))}function Pz(t,n){return t.reduce((e,r,i)=>(e[r]=n[i],e),{})}function lA(...t){const n=Lb(t),e=Az(t),{args:r,keys:i}=Mz(t);if(0===r.length)return xs([],n);const o=new H(function gae(t,n,e=sr){return r=>{Nz(n,()=>{const{length:i}=t,o=new Array(i);let a=i,c=i;for(let f=0;f<i;f++)Nz(n,()=>{const _=xs(t[f],n);let x=!1;_.subscribe(new li(r,C=>{o[f]=C,x||(x=!0,c--),c||r.next(e(o.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,n,i?a=>Pz(i,a):sr));return e?o.pipe(Rz(e)):o}function Nz(t,n,e){t?Lh(e,t,n):n()}const cA=as(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Ac(t,n,e=1/0){return vr(n)?Ac((r,i)=>mr((o,a)=>n(r,o,i,a))(kc(t(r,i))),e):("number"==typeof n&&(e=n),jo((r,i)=>function _ae(t,n,e,r,i,o,a,c){const f=[];let _=0,x=0,C=!1;const A=()=>{C&&!f.length&&!_&&n.complete()},N=ne=>_<r?U(ne):f.push(ne),U=ne=>{o&&n.next(ne),_++;let ce=!1;kc(e(ne,x++)).subscribe(new li(n,xe=>{i?.(xe),o?N(xe):n.next(xe)},()=>{ce=!0},void 0,()=>{if(ce)try{for(_--;f.length&&_<r;){const xe=f.shift();a?Lh(n,a,()=>U(xe)):U(xe)}A()}catch(xe){n.error(xe)}}))};return t.subscribe(new li(n,N,()=>{C=!0,A()})),()=>{c?.()}}(r,i,t,e)))}function ay(t=1/0){return Ac(sr,t)}function Fb(...t){return function yae(){return ay(1)}()(xs(t,Lb(t)))}function Bb(t){return new H(n=>{kc(t()).subscribe(n)})}const xa=new H(t=>t.complete());function Es(t,n){return jo((e,r)=>{let i=0;e.subscribe(new li(r,o=>t.call(n,o,i++)&&r.next(o)))})}function Hs(t){return t<=0?()=>xa:jo((n,e)=>{let r=0;n.subscribe(new li(e,i=>{++r<=t&&(e.next(i),t<=r&&e.complete())}))})}function xae(t=Eae){return jo((n,e)=>{let r=!1;n.subscribe(new li(e,i=>{r=!0,e.next(i)},()=>r?e.complete():e.error(t())))})}function Eae(){return new cA}function mp(t,n){const e=arguments.length>=2;return r=>r.pipe(t?Es((i,o)=>t(i,o,r)):sr,Hs(1),e?function wae(t){return jo((n,e)=>{let r=!1;n.subscribe(new li(e,i=>{r=!0,e.next(i)},()=>{r||e.next(t),e.complete()}))})}(n):xae(()=>new cA))}function il(t,n){return jo((e,r)=>{let i=null,o=0,a=!1;const c=()=>a&&!i&&r.complete();e.subscribe(new li(r,f=>{i?.unsubscribe();let _=0;const x=o++;kc(t(f,x)).subscribe(i=new li(r,C=>r.next(n?n(f,C,x,_++):C),()=>{i=null,c()}))},()=>{a=!0,c()}))})}function ly(...t){const n=Lb(t);return jo((e,r)=>{(n?Fb(t,e,n):Fb(t,e)).subscribe(r)})}function vd(t){return jo((n,e)=>{kc(t).subscribe(new li(e,()=>e.complete(),Na)),!e.closed&&n.subscribe(e)})}function VE(t,n){return vr(n)?Ac(t,n,1):Ac(t,1)}function Fh(t,n,e){const r=vr(t)||n||e?{next:t,error:n,complete:e}:t;return r?jo((i,o)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let c=!0;i.subscribe(new li(o,f=>{var _;null===(_=r.next)||void 0===_||_.call(r,f),o.next(f)},()=>{var f;c=!1,null===(f=r.complete)||void 0===f||f.call(r),o.complete()},f=>{var _;c=!1,null===(_=r.error)||void 0===_||_.call(r,f),o.error(f)},()=>{var f,_;c&&(null===(f=r.unsubscribe)||void 0===f||f.call(r)),null===(_=r.finalize)||void 0===_||_.call(r)}))}):sr}function Oz(t){return t<=0?()=>xa:jo((n,e)=>{let r=[];n.subscribe(new li(e,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)e.next(i);e.complete()},void 0,()=>{r=null}))})}function uA(t){return jo((n,e)=>{let o,r=null,i=!1;r=n.subscribe(new li(e,void 0,void 0,a=>{o=kc(t(a,uA(t)(n))),r?(r.unsubscribe(),r=null,o.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(e))})}function Lz(t){return jo((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}let Cae=(()=>{class t{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(r){return new(r||t)(Tt(Wn))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Vz=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:function(r){let i=null;return i=r?new(r||t):Tt(Iae),i},providedIn:"root"})}return t})(),Iae=(()=>{class t extends Vz{_doc;constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Al.NONE:return r;case Al.HTML:return hd(r,"HTML")?kl(r):jO(this._doc,String(r)).toString();case Al.STYLE:return hd(r,"Style")?kl(r):r;case Al.SCRIPT:if(hd(r,"Script"))return kl(r);throw new ue(5200,!1);case Al.URL:return hd(r,"URL")?kl(r):$x(String(r));case Al.RESOURCE_URL:if(hd(r,"ResourceURL"))return kl(r);throw new ue(5201,!1);default:throw new ue(5202,!1)}}bypassSecurityTrustHtml(e){return function z7(t){return new O7(t)}(e)}bypassSecurityTrustStyle(e){return function j7(t){return new L7(t)}(e)}bypassSecurityTrustScript(e){return function H7(t){return new F7(t)}(e)}bypassSecurityTrustUrl(e){return function $7(t){return new B7(t)}(e)}bypassSecurityTrustResourceUrl(e){return function q7(t){return new V7(t)}(e)}static \u0275fac=function(r){return new(r||t)(Tt(Wn))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Bn="primary",Ub=Symbol("RouteTitle");class kae{params;constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function cy(t){return new kae(t)}function dA(t,n,e){for(let r=0;r<t.length;r++){const i=t[r],o=n[r];if(":"===i[0])e[i.substring(1)]=o;else if(i!==o.path)return!1}return!0}function Aae(t,n,e){const r=e.path.split("/"),i=r.indexOf("**");if(-1===i){if(r.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||r.length<t.length))return null;const f={},_=t.slice(0,r.length);return dA(r,_,f)?{consumed:_,posParams:f}:null}if(i!==r.lastIndexOf("**"))return null;const o=r.slice(0,i),a=r.slice(i+1);if(o.length+a.length>t.length||"full"===e.pathMatch&&n.hasChildren()&&"**"!==e.path)return null;const c={};return dA(o,t.slice(0,o.length),c)&&dA(a,t.slice(t.length-a.length),c)?{consumed:t,posParams:c}:null}function UE(t){return new Promise((n,e)=>{t.pipe(mp()).subscribe({next:r=>n(r),error:r=>e(r)})})}function bd(t,n){const e=t?hA(t):void 0,r=n?hA(n):void 0;if(!e||!r||e.length!=r.length)return!1;let i;for(let o=0;o<e.length;o++)if(i=e[o],!Uz(t[i],n[i]))return!1;return!0}function hA(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function Uz(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),r=[...n].sort();return e.every((i,o)=>r[o]===i)}return t===n}function eg(t){return hz(t)?t:ub(t)?xs(Promise.resolve(t)):Fn(t)}function zz(t){return hz(t)?UE(t):Promise.resolve(t)}const Pae={exact:function Hz(t,n,e){if(!tg(t.segments,n.segments)||!zE(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!t.children[r]||!Hz(t.children[r],n.children[r],e))return!1;return!0},subset:$z},jz={exact:function Oae(t,n){return bd(t,n)},subset:function Lae(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>Uz(t[e],n[e]))},ignored:()=>!0};function fA(t,n,e){return Pae[e.paths](t.root,n.root,e.matrixParams)&&jz[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function $z(t,n,e){return qz(t,n,n.segments,e)}function qz(t,n,e,r){if(t.segments.length>e.length){const i=t.segments.slice(0,e.length);return!(!tg(i,e)||n.hasChildren()||!zE(i,e,r))}if(t.segments.length===e.length){if(!tg(t.segments,e)||!zE(t.segments,e,r))return!1;for(const i in n.children)if(!t.children[i]||!$z(t.children[i],n.children[i],r))return!1;return!0}{const i=e.slice(0,t.segments.length),o=e.slice(t.segments.length);return!!(tg(t.segments,i)&&zE(t.segments,i,r)&&t.children[Bn])&&qz(t.children[Bn],n,o,r)}}function zE(t,n,e){return n.every((r,i)=>jz[e](t[i].parameters,r.parameters))}class wd{root;queryParams;fragment;_queryParamMap;constructor(n=new Xr([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=cy(this.queryParams),this._queryParamMap}toString(){return Vae.serialize(this)}}class Xr{segments;children;parent=null;constructor(n,e){this.segments=n,this.children=e,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jE(this)}}class zb{path;parameters;_parameterMap;constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap??=cy(this.parameters),this._parameterMap}toString(){return Zz(this)}}function tg(t,n){return t.length===n.length&&t.every((e,r)=>e.path===n[r].path)}let jb=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>new Hb,providedIn:"root"})}return t})();class Hb{parse(n){const e=new Yae(n);return new wd(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${$b(n.root,!0)}`,r=function jae(t){const n=Object.entries(t).map(([e,r])=>Array.isArray(r)?r.map(i=>`${HE(e)}=${HE(i)}`).join("&"):`${HE(e)}=${HE(r)}`).filter(e=>e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${r}${"string"==typeof n.fragment?`#${function Uae(t){return encodeURI(t)}(n.fragment)}`:""}`}}const Vae=new Hb;function jE(t){return t.segments.map(n=>Zz(n)).join("/")}function $b(t,n){if(!t.hasChildren())return jE(t);if(n){const e=t.children[Bn]?$b(t.children[Bn],!1):"",r=[];return Object.entries(t.children).forEach(([i,o])=>{i!==Bn&&r.push(`${i}:${$b(o,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function Bae(t,n){let e=[];return Object.entries(t.children).forEach(([r,i])=>{r===Bn&&(e=e.concat(n(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==Bn&&(e=e.concat(n(i,r)))}),e}(t,(r,i)=>i===Bn?[$b(t.children[Bn],!1)]:[`${i}:${$b(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Bn]?`${jE(t)}/${e[0]}`:`${jE(t)}/(${e.join("//")})`}}function Gz(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function HE(t){return Gz(t).replace(/%3B/gi,";")}function pA(t){return Gz(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $E(t){return decodeURIComponent(t)}function Wz(t){return $E(t.replace(/\+/g,"%20"))}function Zz(t){return`${pA(t.path)}${function zae(t){return Object.entries(t).map(([n,e])=>`;${pA(n)}=${pA(e)}`).join("")}(t.parameters)}`}const Hae=/^[^\/()?;#]+/;function mA(t){const n=t.match(Hae);return n?n[0]:""}const $ae=/^[^\/()?;=#]+/,Gae=/^[^=?&#]+/,Zae=/^[^&#]+/;class Yae{url;remaining;constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Xr([],{}):new Xr([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[Bn]=new Xr(n,e)),r}parseSegment(){const n=mA(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ue(4009,!1);return this.capture(n),new zb($E(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=function qae(t){const n=t.match($ae);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const i=mA(this.remaining);i&&(r=i,this.capture(r))}n[$E(e)]=$E(r)}parseQueryParam(n){const e=function Wae(t){const n=t.match(Gae);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const a=function Kae(t){const n=t.match(Zae);return n?n[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const i=Wz(e),o=Wz(r);if(n.hasOwnProperty(i)){let a=n[i];Array.isArray(a)||(a=[a],n[i]=a),a.push(o)}else n[i]=o}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=mA(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new ue(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):n&&(o=Bn);const a=this.parseChildren();e[o??Bn]=1===Object.keys(a).length&&a[Bn]?a[Bn]:new Xr([],a),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ue(4011,!1)}}function Kz(t){return t.segments.length>0?new Xr([],{[Bn]:t}):t}function Yz(t){const n={};for(const[r,i]of Object.entries(t.children)){const o=Yz(i);if(r===Bn&&0===o.segments.length&&o.hasChildren())for(const[a,c]of Object.entries(o.children))n[a]=c;else(o.segments.length>0||o.hasChildren())&&(n[r]=o)}return function Xae(t){if(1===t.numberOfChildren&&t.children[Bn]){const n=t.children[Bn];return new Xr(t.segments.concat(n.segments),n.children)}return t}(new Xr(t.segments,n))}function ng(t){return t instanceof wd}function Xz(t){let n;const i=Kz(function e(o){const a={};for(const f of o.children){const _=e(f);a[f.outlet]=_}const c=new Xr(o.url,a);return o===t&&(n=c),c}(t.root));return n??i}function Qz(t,n,e,r,i){let o=t;for(;o.parent;)o=o.parent;if(0===n.length)return gA(o,o,o,e,r,i);const a=function Jae(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new t5(!0,0,t);let n=0,e=!1;const r=t.reduce((i,o,a)=>{if("object"==typeof o&&null!=o){if(o.outlets){const c={};return Object.entries(o.outlets).forEach(([f,_])=>{c[f]="string"==typeof _?_.split("/"):_}),[...i,{outlets:c}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===a?(o.split("/").forEach((c,f)=>{0==f&&"."===c||(0==f&&""===c?e=!0:".."===c?n++:""!=c&&i.push(c))}),i):[...i,o]},[]);return new t5(e,n,r)}(n);if(a.toRoot())return gA(o,o,new Xr([],{}),e,r,i);const c=function ele(t,n,e){if(t.isAbsolute)return new GE(n,!0,0);if(!e)return new GE(n,!1,NaN);if(null===e.parent)return new GE(e,!0,0);const r=qE(t.commands[0])?0:1;return function tle(t,n,e){let r=t,i=n,o=e;for(;o>i;){if(o-=i,r=r.parent,!r)throw new ue(4005,!1);i=r.segments.length}return new GE(r,!1,i-o)}(e,e.segments.length-1+r,t.numberOfDoubleDots)}(a,o,t),f=c.processChildren?Gb(c.segmentGroup,c.index,a.commands):n5(c.segmentGroup,c.index,a.commands);return gA(o,c.segmentGroup,f,e,r,i)}function qE(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function qb(t){return"object"==typeof t&&null!=t&&t.outlets}function Jz(t,n,e){t||="\u0275";const r=new wd;return r.queryParams={[t]:n},e.parse(e.serialize(r)).queryParams[t]}function gA(t,n,e,r,i,o){const a={};for(const[_,x]of Object.entries(r??{}))a[_]=Array.isArray(x)?x.map(C=>Jz(_,C,o)):Jz(_,x,o);let c;c=t===n?e:e5(t,n,e);const f=Kz(Yz(c));return new wd(f,a,i)}function e5(t,n,e){const r={};return Object.entries(t.children).forEach(([i,o])=>{r[i]=o===n?e:e5(o,n,e)}),new Xr(t.segments,r)}class t5{isAbsolute;numberOfDoubleDots;commands;constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&qE(r[0]))throw new ue(4003,!1);const i=r.find(qb);if(i&&i!==function Rae(t){return t.length>0?t[t.length-1]:null}(r))throw new ue(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class GE{segmentGroup;processChildren;index;constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}}function n5(t,n,e){if(t??=new Xr([],{}),0===t.segments.length&&t.hasChildren())return Gb(t,n,e);const r=function rle(t,n,e){let r=0,i=n;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=e.length)return o;const a=t.segments[i],c=e[r];if(qb(c))break;const f=`${c}`,_=r<e.length-1?e[r+1]:null;if(i>0&&void 0===f)break;if(f&&_&&"object"==typeof _&&void 0===_.outlets){if(!i5(f,_,a))return o;r+=2}else{if(!i5(f,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,n,e),i=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const o=new Xr(t.segments.slice(0,r.pathIndex),{});return o.children[Bn]=new Xr(t.segments.slice(r.pathIndex),t.children),Gb(o,0,i)}return r.match&&0===i.length?new Xr(t.segments,{}):r.match&&!t.hasChildren()?_A(t,n,e):r.match?Gb(t,0,i):_A(t,n,e)}function Gb(t,n,e){if(0===e.length)return new Xr(t.segments,{});{const r=function nle(t){return qb(t[0])?t[0].outlets:{[Bn]:t}}(e),i={};if(Object.keys(r).some(o=>o!==Bn)&&t.children[Bn]&&1===t.numberOfChildren&&0===t.children[Bn].segments.length){const o=Gb(t.children[Bn],n,e);return new Xr(t.segments,o.children)}return Object.entries(r).forEach(([o,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(i[o]=n5(t.children[o],n,a))}),Object.entries(t.children).forEach(([o,a])=>{void 0===r[o]&&(i[o]=a)}),new Xr(t.segments,i)}}function _A(t,n,e){const r=t.segments.slice(0,n);let i=0;for(;i<e.length;){const o=e[i];if(qb(o)){const f=ile(o.outlets);return new Xr(r,f)}if(0===i&&qE(e[0])){r.push(new zb(t.segments[n].path,r5(e[0]))),i++;continue}const a=qb(o)?o.outlets[Bn]:`${o}`,c=i<e.length-1?e[i+1]:null;a&&c&&qE(c)?(r.push(new zb(a,r5(c))),i+=2):(r.push(new zb(a,{})),i++)}return new Xr(r,{})}function ile(t){const n={};return Object.entries(t).forEach(([e,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(n[e]=_A(new Xr([],{}),0,r))}),n}function r5(t){const n={};return Object.entries(t).forEach(([e,r])=>n[e]=`${r}`),n}function i5(t,n,e){return t==e.path&&bd(n,e.parameters)}const Wb="imperative";var dr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(dr||{});class xd{id;url;constructor(n,e){this.id=n,this.url=e}}class WE extends xd{type=dr.NavigationStart;navigationTrigger;restoredState;constructor(n,e,r="imperative",i=null){super(n,e),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bh extends xd{urlAfterRedirects;type=dr.NavigationEnd;constructor(n,e,r){super(n,e),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var ol=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t[t.Aborted=4]="Aborted",t}(ol||{}),ZE=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(ZE||{});class _p extends xd{reason;code;type=dr.NavigationCancel;constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class uy extends xd{reason;code;type=dr.NavigationSkipped;constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i}}class yA extends xd{error;target;type=dr.NavigationError;constructor(n,e,r,i){super(n,e),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class o5 extends xd{urlAfterRedirects;state;type=dr.RoutesRecognized;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sle extends xd{urlAfterRedirects;state;type=dr.GuardsCheckStart;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ale extends xd{urlAfterRedirects;state;shouldActivate;type=dr.GuardsCheckEnd;constructor(n,e,r,i,o){super(n,e),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class lle extends xd{urlAfterRedirects;state;type=dr.ResolveStart;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cle extends xd{urlAfterRedirects;state;type=dr.ResolveEnd;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ule{route;type=dr.RouteConfigLoadStart;constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class dle{route;type=dr.RouteConfigLoadEnd;constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class hle{snapshot;type=dr.ChildActivationStart;constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class fle{snapshot;type=dr.ChildActivationEnd;constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ple{snapshot;type=dr.ActivationStart;constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mle{snapshot;type=dr.ActivationEnd;constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class s5{routerEvent;position;anchor;scrollBehavior;type=dr.Scroll;constructor(n,e,r,i){this.routerEvent=n,this.position=e,this.anchor=r,this.scrollBehavior=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class vA{}class KE{url;navigationBehaviorOptions;constructor(n,e){this.url=n,this.navigationBehaviorOptions=e}}class _le{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(n){this.rootInjector=n,this.children=new Zb(this.rootInjector)}}let Zb=(()=>{class t{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,r){const i=this.getOrCreateContext(e);i.outlet=r,this.contexts.set(e,i)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new _le(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(r){return new(r||t)(Tt($r))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class a5{_root;constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=bA(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){const e=bA(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=wA(n,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==n)}pathFromRoot(n){return wA(n,this._root).map(e=>e.value)}}function bA(t,n){if(t===n.value)return n;for(const e of n.children){const r=bA(t,e);if(r)return r}return null}function wA(t,n){if(t===n.value)return[n];for(const e of n.children){const r=wA(t,e);if(r.length)return r.unshift(n),r}return[]}class gu{value;children;constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function dy(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class l5 extends a5{snapshot;constructor(n,e){super(n),this.snapshot=e,xA(this,n)}toString(){return this.snapshot.toString()}}function c5(t,n){const e=function yle(t,n){const a=new XE([],{},{},"",{},Bn,t,null,{},n);return new u5("",new gu(a,[]))}(t,n),r=new ae([new zb("",{})]),i=new ae({}),o=new ae({}),a=new ae({}),c=new ae(""),f=new rg(r,i,a,c,o,Bn,t,e.root);return f.snapshot=e.root,new l5(new gu(f,[]),e)}class rg{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(n,e,r,i,o,a,c,f){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=a,this.component=c,this._futureSnapshot=f,this.title=this.dataSubject?.pipe(mr(_=>_[Ub]))??Fn(void 0),this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(mr(n=>cy(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(mr(n=>cy(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function YE(t,n,e="emptyOnly"){let r;const{routeConfig:i}=t;return r=null===n||"always"!==e&&""!==i?.path&&(n.component||n.routeConfig?.loadComponent)?{params:{...t.params},data:{...t.data},resolve:{...t.data,...t._resolvedData??{}}}:{params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.data,...i?.data,...t._resolvedData}},i&&h5(i)&&(r.resolve[Ub]=i.title),r}class XE{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[Ub]}constructor(n,e,r,i,o,a,c,f,_,x){this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=c,this.routeConfig=f,this._resolve=_,this._environmentInjector=x}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=cy(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=cy(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class u5 extends a5{url;constructor(n,e){super(e),this.url=n,xA(this,e)}toString(){return d5(this._root)}}function xA(t,n){n.value._routerState=t,n.children.forEach(e=>xA(t,e))}function d5(t){const n=t.children.length>0?` { ${t.children.map(d5).join(", ")} } `:"";return`${t.value}${n}`}function EA(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,bd(n.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),bd(n.params,e.params)||t.paramsSubject.next(e.params),function Mae(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!bd(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.urlSubject.next(e.url),bd(n.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function CA(t,n){const e=bd(t.params,n.params)&&function Fae(t,n){return tg(t,n)&&t.every((e,r)=>bd(e.parameters,n[r].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||CA(t.parent,n.parent))}function h5(t){return"string"==typeof t.title||null===t.title}const vle=new Ue("");let DA=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Bn;activateEvents=new Zn;deactivateEvents=new Zn;attachEvents=new Zn;detachEvents=new Zn;routerOutletData=_te();parentContexts=Q(Zb);location=Q(Pl);changeDetector=Q(Mh);inputBinder=Q(QE,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){const{firstChange:r,previousValue:i}=e.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ue(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ue(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ue(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new ue(4013,!1);this._activatedRoute=e;const i=this.location,a=e.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,f=new ble(e,c,i.injector,this.routerOutletData);this.activated=i.createComponent(a,{index:i.length,injector:f,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ho]})}return t})();class ble{route;childContexts;parent;outletData;constructor(n,e,r,i){this.route=n,this.childContexts=e,this.parent=r,this.outletData=i}get(n,e){return n===rg?this.route:n===Zb?this.childContexts:n===vle?this.outletData:this.parent.get(n,e)}}const QE=new Ue("");let f5=(()=>{class t{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:r}=e,i=lA([r.queryParams,r.params,r.data]).pipe(il(([o,a,c],f)=>(c={...o,...a,...c},0===f?Fn(c):Promise.resolve(c)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(e);const a=function yne(t){const n=cn(t);if(!n)return null;const e=new rb(n);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(r.component);if(a)for(const{templateName:c}of a.inputs)e.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,i)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})(),p5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){1&r&&ut(0,"router-outlet")},dependencies:[DA],encapsulation:2})}return t})();function TA(t){const n=t.children&&t.children.map(TA),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Bn&&(e.component=p5),e}function Kb(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=n.value;const i=function xle(t,n,e){return n.children.map(r=>{for(const i of e.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Kb(t,r,i);return Kb(t,r)})}(t,n,e);return new gu(r,i)}{if(t.shouldAttach(n.value)){const o=t.retrieve(n.value);if(null!==o){const a=o.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(c=>Kb(t,c)),a}}const r=function Ele(t){return new rg(new ae(t.url),new ae(t.params),new ae(t.queryParams),new ae(t.fragment),new ae(t.data),t.outlet,t.component,t)}(n.value),i=n.children.map(o=>Kb(t,o));return new gu(r,i)}}class SA{redirectTo;navigationBehaviorOptions;constructor(n,e){this.redirectTo=n,this.navigationBehaviorOptions=e}}const m5="ngNavigationCancelingError";function JE(t,n){const{redirectTo:e,navigationBehaviorOptions:r}=ng(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,i=g5(!1,ol.Redirect);return i.url=e,i.navigationBehaviorOptions=r,i}function g5(t,n){const e=new Error(`NavigationCancelingError: ${t||""}`);return e[m5]=!0,e.cancellationCode=n,e}function _5(t){return!!t&&t[m5]}class Dle{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(n,e,r,i,o){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(n){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),EA(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){const i=dy(e);n.children.forEach(o=>{const a=o.value.outlet;this.deactivateRoutes(o,i[a],r),delete i[a]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(i===o)if(i.component){const a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(n,e,a.children)}else this.deactivateChildRoutes(n,e,r);else o&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=dy(n);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){const a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:c})}}deactivateRouteAndOutlet(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=dy(n);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,e,r){const i=dy(e);n.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new mle(o.value.snapshot))}),n.children.length&&this.forwardEvent(new fle(n.value.snapshot))}activateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(EA(i),i===o)if(i.component){const a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(n,e,a.children)}else this.activateChildRoutes(n,e,r);else if(i.component){const a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),EA(c.route.value),this.activateChildRoutes(n,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(n,null,a.children)}else this.activateChildRoutes(n,null,r)}}class y5{path;route;constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class eC{component;route;constructor(n,e){this.component=n,this.route=e}}function Tle(t,n,e){const r=t._root;return Yb(r,n?n._root:null,e,[r.value])}function hy(t,n){const e=Symbol(),r=n.get(t,e);return r===e?"function"!=typeof t||function Lg(t){return null!==df(t)}(t)?n.get(t):t:r}function Yb(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=dy(n);return t.children.forEach(a=>{(function Ile(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,a=n?n.value:null,c=e?e.getContext(t.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const f=function kle(t,n,e){if("function"==typeof e)return qi(n._environmentInjector,()=>e(t,n));switch(e){case"pathParamsChange":return!tg(t.url,n.url);case"pathParamsOrQueryParamsChange":return!tg(t.url,n.url)||!bd(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!CA(t,n)||!bd(t.queryParams,n.queryParams);default:return!CA(t,n)}}(a,o,o.routeConfig.runGuardsAndResolvers);f?i.canActivateChecks.push(new y5(r)):(o.data=a.data,o._resolvedData=a._resolvedData),Yb(t,n,o.component?c?c.children:null:e,r,i),f&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new eC(c.outlet.component,a))}else a&&Xb(n,c,i),i.canActivateChecks.push(new y5(r)),Yb(t,null,o.component?c?c.children:null:e,r,i)})(a,o[a.value.outlet],e,r.concat([a.value]),i),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,c])=>Xb(c,e.getContext(a),i)),i}function Xb(t,n,e){const r=dy(t),i=t.value;Object.entries(r).forEach(([o,a])=>{Xb(a,i.component?n?n.children.getContext(o):null:n,e)}),e.canDeactivateChecks.push(new eC(i.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,i))}function Qb(t){return"function"==typeof t}function v5(t){return t instanceof cA||"EmptyError"===t?.name}const tC=Symbol("INITIAL_VALUE");function fy(){return il(t=>lA(t.map(n=>n.pipe(Hs(1),ly(tC)))).pipe(mr(n=>{for(const e of n)if(!0!==e){if(e===tC)return tC;if(!1===e||Lle(e))return e}return!0}),Es(n=>n!==tC),Hs(1)))}function Lle(t){return ng(t)||t instanceof SA}function b5(t){return t.aborted?Fn(void 0).pipe(Hs(1)):new H(n=>{const e=()=>{n.next(),n.complete()};return t.addEventListener("abort",e),()=>t.removeEventListener("abort",e)})}function w5(t){return vd(b5(t))}function x5(t){return function B(...t){return j(t)}(Fh(n=>{if("boolean"!=typeof n)throw JE(0,n)}),mr(n=>!0===n))}class Vh extends Error{segmentGroup;constructor(n){super(),this.segmentGroup=n||null,Object.setPrototypeOf(this,Vh.prototype)}}class Jb extends Error{urlTree;constructor(n){super(),this.urlTree=n,Object.setPrototypeOf(this,Jb.prototype)}}function Wle(t){throw new ue(4e3,!1)}class Kle{urlSerializer;urlTree;constructor(n,e){this.urlSerializer=n,this.urlTree=e}lineralizeSegments(n,e){return fe(function*(){let r=[],i=e.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return r;if(i.numberOfChildren>1||!i.children[Bn])throw Wle();i=i.children[Bn]}})()}applyRedirectCommands(n,e,r,i,o){var a=this;return fe(function*(){const c=yield function Yle(t,n,e){if("string"==typeof t)return Promise.resolve(t);const r=t,{queryParams:i,fragment:o,routeConfig:a,url:c,outlet:f,params:_,data:x,title:C,paramMap:A,queryParamMap:N}=n;return UE(eg(qi(e,()=>r({params:_,data:x,queryParams:i,fragment:o,routeConfig:a,url:c,outlet:f,title:C,paramMap:A,queryParamMap:N}))))}(e,i,o);if(c instanceof wd)throw new Jb(c);const f=a.applyRedirectCreateUrlTree(c,a.urlSerializer.parse(c),n,r);if("/"===c[0])throw new Jb(f);return f})()}applyRedirectCreateUrlTree(n,e,r,i){const o=this.createSegmentGroup(n,e.root,r,i);return new wd(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const r={};return Object.entries(n).forEach(([i,o])=>{if("string"==typeof o&&":"===o[0]){const c=o.substring(1);r[i]=e[c]}else r[i]=o}),r}createSegmentGroup(n,e,r,i){const o=this.createSegments(n,e.segments,r,i);let a={};return Object.entries(e.children).forEach(([c,f])=>{a[c]=this.createSegmentGroup(n,f,r,i)}),new Xr(o,a)}createSegments(n,e,r,i){return e.map(o=>":"===o.path[0]?this.findPosParam(n,o,i):this.findOrReturn(o,r))}findPosParam(n,e,r){const i=r[e.path.substring(1)];if(!i)throw new ue(4001,!1);return i}findOrReturn(n,e){let r=0;for(const i of e){if(i.path===n.path)return e.splice(r),i;r++}return n}}function _u(t){return t.outlet||Bn}function tce(t,n){const e=t.filter(r=>_u(r)===n);return e.push(...t.filter(r=>_u(r)!==n)),e}const IA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function nce(t,n,e,r,i,o){const a=E5(t,n,e);return a.matched?(r=function Xle(t,n){return t.providers&&!t._injector&&(t._injector=E1(t.providers,n,`Route: ${t.path}`)),t._injector??n}(n,r),function Gle(t,n,e,r,i){const o=n.canMatch;return o&&0!==o.length?Fn(o.map(c=>{const f=hy(c,t);return eg(function Ole(t){return t&&Qb(t.canMatch)}(f)?f.canMatch(n,e):qi(t,()=>f(n,e))).pipe(w5(i))})).pipe(fy(),x5()):Fn(!0)}(r,n,e,0,o).pipe(mr(c=>!0===c?a:{...IA}))):Fn(a)}function E5(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...IA}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const i=(n.matcher||Aae)(e,t,n);if(!i)return{...IA};const o={};Object.entries(i.posParams??{}).forEach(([c,f])=>{o[c]=f.path});const a=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function C5(t,n,e,r){return e.length>0&&function oce(t,n,e){return e.some(r=>nC(t,n,r)&&_u(r)!==Bn)}(t,e,r)?{segmentGroup:new Xr(n,ice(r,new Xr(e,t.children))),slicedSegments:[]}:0===e.length&&function sce(t,n,e){return e.some(r=>nC(t,n,r))}(t,e,r)?{segmentGroup:new Xr(t.segments,rce(t,e,r,t.children)),slicedSegments:e}:{segmentGroup:new Xr(t.segments,t.children),slicedSegments:e}}function rce(t,n,e,r){const i={};for(const o of e)if(nC(t,n,o)&&!r[_u(o)]){const a=new Xr([],{});i[_u(o)]=a}return{...r,...i}}function ice(t,n){const e={};e[Bn]=n;for(const r of t)if(""===r.path&&_u(r)!==Bn){const i=new Xr([],{});e[_u(r)]=i}return e}function nC(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}class lce{}function kA(){return(kA=fe(function*(t,n,e,r,i,o,a="emptyOnly",c){return new dce(t,n,e,r,i,a,o,c).recognize()})).apply(this,arguments)}class dce{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(n,e,r,i,o,a,c,f){this.injector=n,this.configLoader=e,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.abortSignal=f,this.applyRedirects=new Kle(this.urlSerializer,this.urlTree)}noMatchError(n){return new ue(4002,`'${n.segmentGroup}'`)}recognize(){var n=this;return fe(function*(){const e=C5(n.urlTree.root,[],[],n.config).segmentGroup,{children:r,rootSnapshot:i}=yield n.match(e),o=new gu(i,r),a=new u5("",o),c=function Qae(t,n,e=null,r=null,i=new Hb){return Qz(Xz(t),n,e,r,i)}(i,[],n.urlTree.queryParams,n.urlTree.fragment);return c.queryParams=n.urlTree.queryParams,a.url=n.urlSerializer.serialize(c),{state:a,tree:c}})()}match(n){var e=this;return fe(function*(){const r=new XE([],Object.freeze({}),Object.freeze({...e.urlTree.queryParams}),e.urlTree.fragment,Object.freeze({}),Bn,e.rootComponentType,null,{},e.injector);try{return{children:yield e.processSegmentGroup(e.injector,e.config,n,Bn,r),rootSnapshot:r}}catch(i){if(i instanceof Jb)return e.urlTree=i.urlTree,e.match(i.urlTree.root);throw i instanceof Vh?e.noMatchError(i):i}})()}processSegmentGroup(n,e,r,i,o){var a=this;return fe(function*(){if(0===r.segments.length&&r.hasChildren())return a.processChildren(n,e,r,o);const c=yield a.processSegment(n,e,r,r.segments,i,!0,o);return c instanceof gu?[c]:[]})()}processChildren(n,e,r,i){var o=this;return fe(function*(){const a=[];for(const _ of Object.keys(r.children))"primary"===_?a.unshift(_):a.push(_);let c=[];for(const _ of a){const x=r.children[_],C=tce(e,_),A=yield o.processSegmentGroup(n,C,x,_,i);c.push(...A)}const f=D5(c);return function hce(t){t.sort((n,e)=>n.value.outlet===Bn?-1:e.value.outlet===Bn?1:n.value.outlet.localeCompare(e.value.outlet))}(f),f})()}processSegment(n,e,r,i,o,a,c){var f=this;return fe(function*(){for(const _ of e)try{return yield f.processSegmentAgainstRoute(_._injector??n,e,_,r,i,o,a,c)}catch(x){if(x instanceof Vh||v5(x))continue;throw x}if(function ace(t,n,e){return 0===n.length&&!t.children[e]}(r,i,o))return new lce;throw new Vh(r)})()}processSegmentAgainstRoute(n,e,r,i,o,a,c,f){var _=this;return fe(function*(){if(_u(r)!==a&&(a===Bn||!nC(i,o,r)))throw new Vh(i);if(void 0===r.redirectTo)return _.matchSegmentAgainstRoute(n,i,r,o,a,f);if(_.allowRedirects&&c)return _.expandSegmentAgainstRouteUsingRedirect(n,i,e,r,o,a,f);throw new Vh(i)})()}expandSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a,c){var f=this;return fe(function*(){const{matched:_,parameters:x,consumedSegments:C,positionalParamSegments:A,remainingSegments:N}=E5(e,i,o);if(!_)throw new Vh(e);"string"==typeof i.redirectTo&&"/"===i.redirectTo[0]&&(f.absoluteRedirectCount++,f.absoluteRedirectCount>31&&(f.allowRedirects=!1));const U=new XE(o,x,Object.freeze({...f.urlTree.queryParams}),f.urlTree.fragment,T5(i),_u(i),i.component??i._loadedComponent??null,i,S5(i),n),ne=YE(U,c,f.paramsInheritanceStrategy);if(U.params=Object.freeze(ne.params),U.data=Object.freeze(ne.data),f.abortSignal.aborted)throw new Error(f.abortSignal.reason);const ce=yield f.applyRedirects.applyRedirectCommands(C,i.redirectTo,A,U,n),xe=yield f.applyRedirects.lineralizeSegments(i,ce);return f.processSegment(n,r,e,xe.concat(N),a,!1,c)})()}matchSegmentAgainstRoute(n,e,r,i,o,a){var c=this;return fe(function*(){if(c.abortSignal.aborted)throw new Error(c.abortSignal.reason);const f=yield UE(nce(e,r,i,n,0,c.abortSignal));if("**"===r.path&&(e.children={}),!f?.matched)throw new Vh(e);n=r._injector??n;const{routes:_}=yield c.getChildConfig(n,r,i),x=r._loadedInjector??n,{parameters:C,consumedSegments:A,remainingSegments:N}=f,U=new XE(A,C,Object.freeze({...c.urlTree.queryParams}),c.urlTree.fragment,T5(r),_u(r),r.component??r._loadedComponent??null,r,S5(r),n),ne=YE(U,a,c.paramsInheritanceStrategy);U.params=Object.freeze(ne.params),U.data=Object.freeze(ne.data);const{segmentGroup:ce,slicedSegments:xe}=C5(e,A,N,_);if(0===xe.length&&ce.hasChildren()){const Se=yield c.processChildren(x,_,ce,U);return new gu(U,Se)}if(0===_.length&&0===xe.length)return new gu(U,[]);const Ce=_u(r)===o,Ze=yield c.processSegment(x,_,ce,xe,Ce?Bn:o,!0,U);return new gu(U,Ze instanceof gu?[Ze]:[])})()}getChildConfig(n,e,r){var i=this;return fe(function*(){if(e.children)return{routes:e.children,injector:n};if(e.loadChildren){if(void 0!==e._loadedRoutes){const a=e._loadedNgModuleFactory;return a&&!e._loadedInjector&&(e._loadedInjector=a.create(n).injector),{routes:e._loadedRoutes,injector:e._loadedInjector}}if(i.abortSignal.aborted)throw new Error(i.abortSignal.reason);if(yield UE(function qle(t,n,e,r,i){const o=n.canLoad;return void 0===o||0===o.length?Fn(!0):Fn(o.map(c=>{const f=hy(c,t),x=eg(function Mle(t){return t&&Qb(t.canLoad)}(f)?f.canLoad(n,e):qi(t,()=>f(n,e)));return i?x.pipe(w5(i)):x})).pipe(fy(),x5())}(n,e,r,0,i.abortSignal))){const a=yield i.configLoader.loadChildren(n,e);return e._loadedRoutes=a.routes,e._loadedInjector=a.injector,e._loadedNgModuleFactory=a.factory,a}throw function Zle(){throw g5(!1,ol.GuardRejected)}()}return{routes:[],injector:n}})()}}function fce(t){const n=t.value.routeConfig;return n&&""===n.path}function D5(t){const n=[],e=new Set;for(const r of t){if(!fce(r)){n.push(r);continue}const i=n.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),e.add(i)):n.push(r)}for(const r of e){const i=D5(r.children);n.push(new gu(r.value,i))}return n.filter(r=>!e.has(r))}function T5(t){return t.data||{}}function S5(t){return t.resolve||{}}function I5(t){const n=t.children.map(e=>I5(e)).flat();return[t,...n]}function k5(t){return il(n=>{const e=t(n);return e?xs(e).pipe(mr(()=>n)):Fn(n)})}let A5=(()=>{class t{buildTitle(e){let r,i=e.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Bn);return r}getResolvedTitleForRoute(e){return e.data[Ub]}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(vce),providedIn:"root"})}return t})(),vce=(()=>{class t extends A5{title;constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||t)(Tt(Cae))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const py=new Ue("",{factory:()=>({})}),e0=new Ue("");let AA=(()=>{class t{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Q(rte);loadComponent(e,r){var i=this;return fe(function*(){if(i.componentLoaders.get(r))return i.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);i.onLoadStartListener&&i.onLoadStartListener(r);const o=fe(function*(){try{const a=yield zz(qi(e,()=>r.loadComponent())),c=yield R5(M5(a));return i.onLoadEndListener&&i.onLoadEndListener(r),r._loadedComponent=c,c}finally{i.componentLoaders.delete(r)}})();return i.componentLoaders.set(r,o),o})()}loadChildren(e,r){var i=this;if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=fe(function*(){try{const a=yield function bce(t,n,e,r){return MA.apply(this,arguments)}(r,i.compiler,e,i.onLoadEndListener);return r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,a}finally{i.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function MA(){return(MA=fe(function*(t,n,e,r){const i=yield zz(qi(e,()=>t.loadChildren())),o=yield R5(M5(i));let a;a=o instanceof GF||Array.isArray(o)?o:yield n.compileModuleAsync(o),r&&r(t);let c,f,x;return Array.isArray(a)?f=a:(c=a.create(e).injector,x=a,f=c.get(e0,[],{optional:!0,self:!0}).flat()),{routes:f.map(TA),injector:c,factory:x}})).apply(this,arguments)}function M5(t){return function wce(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}function R5(t){return RA.apply(this,arguments)}function RA(){return(RA=fe(function*(t){return t})).apply(this,arguments)}let PA=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(xce),providedIn:"root"})}return t})(),xce=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const P5=new Ue(""),N5=new Ue("");function Ece(t,n,e){const r=t.get(N5),i=t.get(Wn);if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(_=>setTimeout(_));let o;const a=new Promise(_=>{o=_}),c=i.startViewTransition(()=>(o(),function Cce(t){return new Promise(n=>{hu({read:()=>setTimeout(n)},{injector:t})})}(t)));c.updateCallbackDone.catch(_=>{}),c.ready.catch(_=>{}),c.finished.catch(_=>{});const{onViewTransitionCreated:f}=r;return f&&qi(t,()=>f({transition:c,from:n,to:e})),a}const Dce=()=>{},O5=new Ue("");let NA=(()=>{class t{currentNavigation=Pi(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=Pi(null);events=new ee;transitionAbortWithErrorSubject=new ee;configLoader=Q(AA);environmentInjector=Q($r);destroyRef=Q(cr);urlSerializer=Q(jb);rootContexts=Q(Zb);location=Q(oy);inputBindingEnabled=null!==Q(QE,{optional:!0});titleStrategy=Q(A5);options=Q(py,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Q(PA);createViewTransition=Q(P5,{optional:!0});navigationErrorHandler=Q(O5,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>Fn(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=i=>this.events.next(new dle(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new ule(i)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){const r=++this.navigationId;Er(()=>{this.transitions?.next({...e,extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r})})}setupNavigations(e){return this.transitions=new ae(null),this.transitions.pipe(Es(r=>null!==r),il(r=>{let i=!1;const o=new AbortController,a=()=>!i&&this.currentTransition?.id===r.id;return Fn(r).pipe(il(c=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ol.SupersededByNewNavigation),xa;this.currentTransition=r;const f=this.lastSuccessfulNavigation();this.currentNavigation.set({id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:"string"==typeof c.extras.browserUrl?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:f?{...f,previousNavigation:null}:null,abort:()=>o.abort()});const _=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!_&&"reload"!==(c.extras.onSameUrlNavigation??e.onSameUrlNavigation))return this.events.next(new uy(c.id,this.urlSerializer.serialize(c.rawUrl),"",ZE.IgnoredSameUrlNavigation)),c.resolve(!1),xa;if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Fn(c).pipe(il(C=>(this.events.next(new WE(C.id,this.urlSerializer.serialize(C.extractedUrl),C.source,C.restoredState)),C.id!==this.navigationId?xa:Promise.resolve(C))),function pce(t,n,e,r,i,o,a){return Ac(function(){var c=fe(function*(f){const{state:_,tree:x}=yield function cce(t,n,e,r,i,o){return kA.apply(this,arguments)}(t,n,e,r,f.extractedUrl,i,o,a);return{...f,targetSnapshot:_,urlAfterRedirects:x}});return function(f){return c.apply(this,arguments)}}())}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),Fh(C=>{r.targetSnapshot=C.targetSnapshot,r.urlAfterRedirects=C.urlAfterRedirects,this.currentNavigation.update(N=>(N.finalUrl=C.urlAfterRedirects,N));const A=new o5(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(A)}));if(_&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:C,extractedUrl:A,source:N,restoredState:U,extras:ne}=c,ce=new WE(C,this.urlSerializer.serialize(A),N,U);this.events.next(ce);const xe=c5(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=r={...c,targetSnapshot:xe,urlAfterRedirects:A,extras:{...ne,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.update(Ce=>(Ce.finalUrl=A,Ce)),Fn(r)}return this.events.next(new uy(c.id,this.urlSerializer.serialize(c.extractedUrl),"",ZE.IgnoredByUrlHandlingStrategy)),c.resolve(!1),xa}),mr(c=>{const f=new sle(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);return this.events.next(f),this.currentTransition=r={...c,guards:Tle(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},r}),function Fle(t){return Ac(n=>{const{targetSnapshot:e,currentSnapshot:r,guards:{canActivateChecks:i,canDeactivateChecks:o}}=n;return 0===o.length&&0===i.length?Fn({...n,guardsResult:!0}):function Ble(t,n,e){return xs(t).pipe(Ac(r=>function $le(t,n,e,r){const i=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return i&&0!==i.length?Fn(i.map(a=>{const c=n._environmentInjector,f=hy(a,c);return eg(function Nle(t){return t&&Qb(t.canDeactivate)}(f)?f.canDeactivate(t,n,e,r):qi(c,()=>f(t,n,e,r))).pipe(mp())})).pipe(fy()):Fn(!0)}(r.component,r.route,e,n)),mp(r=>!0!==r,!0))}(o,e,r).pipe(Ac(a=>a&&function Ale(t){return"boolean"==typeof t}(a)?function Vle(t,n,e){return xs(n).pipe(VE(r=>Fb(function zle(t,n){return null!==t&&n&&n(new hle(t)),Fn(!0)}(r.route.parent,e),function Ule(t,n){return null!==t&&n&&n(new ple(t)),Fn(!0)}(r.route,e),function Hle(t,n){const e=n[n.length-1],i=n.slice(0,n.length-1).reverse().map(o=>function Sle(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(o)).filter(o=>null!==o).map(o=>Bb(()=>Fn(o.guards.map(c=>{const f=o.node._environmentInjector,_=hy(c,f);return eg(function Ple(t){return t&&Qb(t.canActivateChild)}(_)?_.canActivateChild(e,t):qi(f,()=>_(e,t))).pipe(mp())})).pipe(fy())));return Fn(i).pipe(fy())}(t,r.path),function jle(t,n){const e=n.routeConfig?n.routeConfig.canActivate:null;if(!e||0===e.length)return Fn(!0);const r=e.map(i=>Bb(()=>{const o=n._environmentInjector,a=hy(i,o);return eg(function Rle(t){return t&&Qb(t.canActivate)}(a)?a.canActivate(n,t):qi(o,()=>a(n,t))).pipe(mp())}));return Fn(r).pipe(fy())}(t,r.route))),mp(r=>!0!==r,!0))}(e,i,t):Fn(a)),mr(a=>({...n,guardsResult:a})))})}(c=>this.events.next(c)),il(c=>{if(r.guardsResult=c.guardsResult,c.guardsResult&&"boolean"!=typeof c.guardsResult)throw JE(0,c.guardsResult);const f=new ale(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);if(this.events.next(f),!a())return xa;if(!c.guardsResult)return this.cancelNavigationTransition(c,"",ol.GuardRejected),xa;if(0===c.guards.canActivateChecks.length)return Fn(c);const _=new lle(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);if(this.events.next(_),!a())return xa;let x=!1;return Fn(c).pipe(function mce(t){return Ac(n=>{const{targetSnapshot:e,guards:{canActivateChecks:r}}=n;if(!r.length)return Fn(n);const i=new Set(r.map(c=>c.route)),o=new Set;for(const c of i)if(!o.has(c))for(const f of I5(c))o.add(f);let a=0;return xs(o).pipe(VE(c=>i.has(c)?function gce(t,n,e){const r=t.routeConfig,i=t._resolve;return void 0!==r?.title&&!h5(r)&&(i[Ub]=r.title),Bb(()=>(t.data=YE(t,t.parent,e).resolve,function _ce(t,n,e){const r=hA(t);if(0===r.length)return Fn({});const i={};return xs(r).pipe(Ac(o=>function yce(t,n,e){const r=n._environmentInjector,i=hy(t,r);return eg(i.resolve?i.resolve(n,e):qi(r,()=>i(n,e)))}(t[o],n,e).pipe(mp(),Fh(a=>{if(a instanceof SA)throw JE(new Hb,a);i[o]=a}))),Oz(1),mr(()=>i),uA(o=>v5(o)?xa:function bae(t,n){const e=vr(t)?t:()=>t,r=i=>i.error(e());return new H(n?i=>n.schedule(r,0,i):r)}(o)))}(i,t,n).pipe(mr(o=>(t._resolvedData=o,t.data={...t.data,...o},null)))))}(c,e,t):(c.data=YE(c,c.parent,t).resolve,Fn(void 0))),Fh(()=>a++),Oz(1),Ac(c=>a===o.size?Fn(n):xa))})}(this.paramsInheritanceStrategy),Fh({next:()=>{x=!0;const C=new cle(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(C)},complete:()=>{x||this.cancelNavigationTransition(c,"",ol.NoDataFromResolver)}}))}),k5(c=>{const f=x=>{const C=[];x.routeConfig?._loadedComponent?x.component=x.routeConfig?._loadedComponent:x.routeConfig?.loadComponent&&C.push(this.configLoader.loadComponent(x._environmentInjector,x.routeConfig).then(N=>{x.component=N}));for(const A of x.children)C.push(...f(A));return C},_=f(c.targetSnapshot.root);return 0===_.length?Fn(c):xs(Promise.all(_).then(()=>c))}),k5(()=>this.afterPreactivation()),il(()=>{const{currentSnapshot:c,targetSnapshot:f}=r,_=this.createViewTransition?.(this.environmentInjector,c.root,f.root);return _?xs(_).pipe(mr(()=>r)):Fn(r)}),Hs(1),mr(c=>{const f=function wle(t,n,e){const r=Kb(t,n._root,e?e._root:void 0);return new l5(r,n)}(e.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);this.currentTransition=r=c={...c,targetRouterState:f},this.currentNavigation.update(_=>(_.targetRouterState=f,_)),this.events.next(new vA),a()&&(new Dle(e.routeReuseStrategy,r.targetRouterState,r.currentRouterState,_=>this.events.next(_),this.inputBindingEnabled).activate(this.rootContexts),a()&&(i=!0,this.currentNavigation.update(_=>(_.abort=Dce,_)),this.lastSuccessfulNavigation.set(Er(this.currentNavigation)),this.events.next(new Bh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)))}),vd(b5(o.signal).pipe(Es(()=>!i&&!r.targetRouterState),Fh(()=>{this.cancelNavigationTransition(r,o.signal.reason+"",ol.Aborted)}))),Fh({complete:()=>{i=!0}}),vd(this.transitionAbortWithErrorSubject.pipe(Fh(c=>{throw c}))),Lz(()=>{o.abort(),i||this.cancelNavigationTransition(r,"",ol.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),uA(c=>{if(i=!0,this.destroyed)return r.resolve(!1),xa;if(_5(c))this.events.next(new _p(r.id,this.urlSerializer.serialize(r.extractedUrl),c.message,c.cancellationCode)),function Cle(t){return _5(t)&&ng(t.url)}(c)?this.events.next(new KE(c.url,c.navigationBehaviorOptions)):r.resolve(!1);else{const f=new yA(r.id,this.urlSerializer.serialize(r.extractedUrl),c,r.targetSnapshot??void 0);try{const _=qi(this.environmentInjector,()=>this.navigationErrorHandler?.(f));if(!(_ instanceof SA))throw this.events.next(f),c;{const{message:x,cancellationCode:C}=JE(0,_);this.events.next(new _p(r.id,this.urlSerializer.serialize(r.extractedUrl),x,C)),this.events.next(new KE(_.redirectTo,_.navigationBehaviorOptions))}}catch(_){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(_)}}return xa}))}))}cancelNavigationTransition(e,r,i){const o=new _p(e.id,this.urlSerializer.serialize(e.extractedUrl),r,i);this.events.next(o),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Er(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return e.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Tce(t){return t!==Wb}const Sce=new Ue("");let Ice=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(Ace),providedIn:"root"})}return t})();class kce{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}shouldDestroyInjector(n){return!0}}let Ace=(()=>{class t extends kce{static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),F5=(()=>{class t{urlSerializer=Q(jb);options=Q(py,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=Q(oy);urlHandlingStrategy=Q(PA);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new wd;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:r,targetBrowserUrl:i}){const o=void 0!==e?this.urlHandlingStrategy.merge(e,r):r,a=i??o;return a instanceof wd?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:e,finalUrl:r,initialUrl:i}){r&&e?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=e):this.rawUrlTree=i}routerState=c5(null,Q($r));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:()=>Q(Mce),providedIn:"root"})}return t})(),Mce=(()=>{class t extends F5{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{"popstate"===r.type&&setTimeout(()=>{e(r.url,r.state,"popstate")})})}handleRouterEvent(e,r){e instanceof WE?this.updateStateMemento():e instanceof uy?this.commitTransition(r):e instanceof o5?"eager"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof vA?(this.commitTransition(r),"deferred"===this.urlUpdateStrategy&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof _p&&!function ole(t){return t instanceof _p&&(t.code===ol.Redirect||t.code===ol.SupersededByNewNavigation)}(e)?this.restoreHistory(r):e instanceof yA?this.restoreHistory(r,!0):e instanceof Bh&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:r,id:i}){const{replaceUrl:o,state:a}=r;if(this.location.isCurrentPathEqualTo(e)||o){const c=this.browserPageId,f={...a,...this.generateNgRouterState(i,c)};this.location.replaceState(e,"",f)}else{const c={...a,...this.generateNgRouterState(i,this.browserPageId+1)};this.location.go(e,"",c)}}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.getCurrentUrlTree()===e.finalUrl&&0===o&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function B5(t,n){t.events.pipe(Es(e=>e instanceof Bh||e instanceof _p||e instanceof yA||e instanceof uy),mr(e=>e instanceof Bh||e instanceof uy?0:e instanceof _p&&(e.code===ol.Redirect||e.code===ol.SupersededByNewNavigation)?2:1),Es(e=>2!==e),Hs(1)).subscribe(()=>{n()})}const V5={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},U5={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let $s=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Q(vB);stateManager=Q(F5);options=Q(py,{optional:!0})||{};pendingTasks=Q(Ga);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Q(NA);urlSerializer=Q(jb);location=Q(oy);urlHandlingStrategy=Q(PA);injector=Q($r);_events=new ee;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Q(Ice);injectorCleanup=Q(Sce,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Q(e0,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Q(QE,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Qn;subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,o=Er(this.navigationTransitions.currentNavigation);if(null!==i&&null!==o)if(this.stateManager.handleRouterEvent(r,o),r instanceof _p&&r.code!==ol.Redirect&&r.code!==ol.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Bh)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(r instanceof KE){const a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),f={scroll:i.extras.scroll,browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||"eager"===this.urlUpdateStrategy||Tce(i.source),...a};this.scheduleNavigation(c,Wb,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function gle(t){return!(t instanceof vA||t instanceof KE)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Wb,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r,i)=>{this.navigateToSyncWithBrowser(e,i,r)})}navigateToSyncWithBrowser(e,r,i){const o={replaceUrl:!0},a=i?.navigationId?i:null;if(i){const f={...i};delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(o.state=f)}const c=this.parseUrl(e);this.scheduleNavigation(c,r,a,o).catch(f=>{this.disposed||this.injector.get(Dl)(f)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Er(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(TA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){const{relativeTo:i,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:f}=r,_=f?this.currentUrlTree.fragment:a;let C,x=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":x={...this.currentUrlTree.queryParams,...o};break;case"preserve":x=this.currentUrlTree.queryParams;break;default:x=o||null}null!==x&&(x=this.removeEmptyProps(x));try{C=Xz(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||"/"!==e[0][0])&&(e=[]),C=this.currentUrlTree.root}return Qz(C,e,x,_??null,this.urlSerializer)}navigateByUrl(e,r={skipLocationChange:!1}){const i=ng(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Wb,null,r)}navigate(e,r={skipLocationChange:!1}){return function Rce(t){for(let n=0;n<t.length;n++)if(null==t[n])throw new ue(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.console.warn(Ht(4018,!1)),this.urlSerializer.parse("/")}}isActive(e,r){let i;if(i=!0===r?{...V5}:!1===r?{...U5}:r,ng(e))return fA(this.currentUrlTree,e,i);const o=this.parseUrl(e);return fA(this.currentUrlTree,o,i)}removeEmptyProps(e){return Object.entries(e).reduce((r,[i,o])=>(null!=o&&(r[i]=o),r),{})}scheduleNavigation(e,r,i,o,a){if(this.disposed)return Promise.resolve(!1);let c,f,_;a?(c=a.resolve,f=a.reject,_=a.promise):_=new Promise((C,A)=>{c=C,f=A});const x=this.pendingTasks.add();return B5(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(x))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:c,reject:f,promise:_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_.catch(C=>Promise.reject(C))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),yp=(()=>{class t{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Pi(null);get href(){return Er(this.reactiveHref)}set href(e){this.reactiveHref.set(e)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new ee;applicationErrorHandler=Q(Dl);options=Q(py,{optional:!0});constructor(e,r,i,o,a,c){this.router=e,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=a,this.locationStrategy=c,this.reactiveHref.set(Q(new mte("href"),{optional:!0}));const f=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===f||"area"===f||!("object"!=typeof customElements||!customElements.get(f)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){void 0===this.subscription&&(this.subscription=this.router.events.subscribe(e=>{e instanceof Bh&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){null==e?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=ng(e)||Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,r,i,o,a){const c=this.urlTree;if(null===c||this.isAnchorElement&&(0!==e||r||i||o||a||"string"==typeof this.target&&"_self"!=this.target))return!0;const f={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,f)?.catch(_=>{this.applicationErrorHandler(_)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const e=this.urlTree;this.reactiveHref.set(null!==e&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e))??"":null)}applyAttributeValue(e,r){const i=this.renderer,o=this.el.nativeElement;null!==r?i.setAttribute(o,e,r):i.removeAttribute(o,e)}get urlTree(){return null===this.routerLinkInput?null:ng(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||t)(Ne($s),Ne(rg),qf("tabindex"),Ne(Xa),Ne(Ur),Ne(Qm))};static \u0275dir=Ft({type:t,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){1&r&&Pe("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&r&&na("href",i.reactiveHref(),YO)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ws],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ws],replaceUrl:[2,"replaceUrl","replaceUrl",ws],routerLink:"routerLink"},features:[Ho]})}return t})(),LA=(()=>{class t{router;element;renderer;cdr;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new Zn;link=Q(yp,{optional:!0});constructor(e,r,i,o){this.router=e,this.element=r,this.renderer=i,this.cdr=o,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Bh&&this.update()})}ngAfterContentInit(){Fn(this.links.changes,Fn(null)).pipe(ay()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=xs(e).pipe(ay()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const e=this.hasActiveLinks();this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){const r=function Pce(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact?{...V5}:{...U5};return i=>{const o=i.urlTree;return!!o&&Er(function Nae(t,n,e){const r=t instanceof wd?t:n.parseUrl(t);return ii(()=>fA(n.lastSuccessfulNavigation()?.finalUrl??new wd,r,e))}(o,e,r))}}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static \u0275fac=function(r){return new(r||t)(Ne($s),Ne(Ur),Ne(Xa),Ne(Mh))};static \u0275dir=Ft({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,o){if(1&r&&OI(o,yp,5),2&r){let a;gd(a=_d())&&(i.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Ho]})}return t})();class z5{}let Nce=(()=>{class t{router;injector;preloadingStrategy;loader;subscription;constructor(e,r,i,o){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Es(e=>e instanceof Bh),VE(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription?.unsubscribe()}processRoutes(e,r){const i=[];for(const o of r){o.providers&&!o._injector&&(o._injector=E1(o.providers,e,""));const a=o._injector??e;o._loadedNgModuleFactory&&!o._loadedInjector&&(o._loadedInjector=o._loadedNgModuleFactory.create(a).injector);const c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(c,o.children??o._loadedRoutes))}return xs(i).pipe(ay())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{if(e.destroyed)return Fn(null);let i;i=r.loadChildren&&void 0===r.canLoad?xs(this.loader.loadChildren(e,r)):Fn(null);const o=i.pipe(Ac(a=>null===a?Fn(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,this.processRoutes(a.injector??e,a.routes))));return r.loadComponent&&!r._loadedComponent?xs([o,this.loader.loadComponent(e,r)]).pipe(ay()):o})}static \u0275fac=function(r){return new(r||t)(Tt($s),Tt($r),Tt(z5),Tt(AA))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const FA=new Ue("");let j5=(()=>{class t{options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=Wb;restoredId=0;store={};urlSerializer=Q(jb);zone=Q(sn);viewportScroller=Q(z4);transitions=Q(NA);constructor(e){this.options=e,this.options.scrollPositionRestoration||="disabled",this.options.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof WE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Bh?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof uy&&e.code===ZE.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{if(!(e instanceof s5)||"manual"===e.scrollBehavior)return;const r={behavior:"instant"};e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0],r):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position,r):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(e,r){var i=this;const o=Er(this.transitions.currentNavigation)?.extras.scroll;this.zone.runOutsideAngular(fe(function*(){yield new Promise(a=>{setTimeout(a),typeof requestAnimationFrame<"u"&&requestAnimationFrame(a)}),i.zone.run(()=>{i.transitions.events.next(new s5(e,"popstate"===i.lastSource?i.store[i.restoredId]:null,r,o))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){!function pF(){throw new Error("invalid")}()};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();function H5(){return Q($s).routerState.root}function Mc(t,n){return{\u0275kind:t,\u0275providers:n}}function $5(){const t=Q(An);return n=>{const e=t.get(tl);if(n!==e.components[0])return;const r=t.get($s),i=t.get(q5);1===t.get(BA)&&r.initialNavigation(),t.get(G5,null,{optional:!0})?.setUpPreloading(),t.get(FA,null,{optional:!0})?.init(),r.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const q5=new Ue("",{factory:()=>new ee}),BA=new Ue("",{factory:()=>1}),G5=new Ue("");function Uce(t){return Mc(0,[{provide:G5,useExisting:Nce},{provide:z5,useExisting:t}])}function jce(t){return ns("NgRouterViewTransitions"),Mc(9,[{provide:P5,useValue:Ece},{provide:N5,useValue:{skipNextTransition:!!t?.skipInitialTransition,...t}}])}const Hce=[oy,{provide:jb,useClass:Hb},$s,Zb,{provide:rg,useFactory:H5},AA,[]];let t0=(()=>{class t{constructor(){}static forRoot(e,r){return{ngModule:t,providers:[Hce,[],{provide:e0,multi:!0,useValue:e},[],r?.errorHandler?{provide:O5,useValue:r.errorHandler}:[],{provide:py,useValue:r||{}},r?.useHash?{provide:Qm,useClass:voe}:{provide:Qm,useClass:qU},{provide:FA,useFactory:()=>{const t=Q(z4),n=Q(py);return n.scrollOffset&&t.setOffset(n.scrollOffset),new j5(n)}},r?.preloadingStrategy?Uce(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Wce(r):[],r?.bindToComponentInputs?Mc(8,[f5,{provide:QE,useExisting:f5}]).\u0275providers:[],r?.enableViewTransitions?jce().\u0275providers:[],[{provide:W5,useFactory:$5},{provide:lI,multi:!0,useExisting:W5}]]}}static forChild(e){return{ngModule:t,providers:[{provide:e0,multi:!0,useValue:e}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})();function Wce(t){return["disabled"===t.initialNavigation?Mc(3,[aI(()=>{Q($s).setUpLocationChangeListener()}),{provide:BA,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Mc(2,[{provide:Em,useValue:!0},{provide:BA,useValue:0},aI(()=>{const n=Q(An);return n.get(wne,Promise.resolve()).then(()=>new Promise(r=>{const i=n.get($s),o=n.get(q5);B5(i,()=>{r(!0)}),n.get(NA).afterPreactivation=()=>(r(!0),o.closed?Fn(void 0):o),i.initialNavigation()}))})]).\u0275providers:[]]}const W5=new Ue("");class yu{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(n){n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const i=e.slice(0,r),o=e.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,r)=>{this.addHeaderEntry(r,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,r])=>{this.setHeaderEntries(e,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof yu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new yu;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof yu?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,e);const i=("a"===n.op?this.headers.get(e):void 0)||[];i.push(...r),this.headers.set(e,i);break;case"d":const o=n.value;if(o){let a=this.headers.get(e);if(!a)return;a=a.filter(c=>-1===o.indexOf(c)),0===a.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}addHeaderEntry(n,e){const r=n.toLowerCase();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(e):this.headers.set(r,[e])}setHeaderEntries(n,e){const r=(Array.isArray(e)?e:[e]).map(o=>o.toString()),i=n.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(n,i)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class Kce{map=new Map;set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}class Yce{encodeKey(n){return Z5(n)}encodeValue(n){return Z5(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const Qce=/%(\d[a-f0-9])/gi,Jce={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Z5(t){return encodeURIComponent(t).replace(Qce,(n,e)=>Jce[e]??n)}function rC(t){return`${t}`}class vp{map;encoder;updates=null;cloneFrom=null;constructor(n={}){if(this.encoder=n.encoder||new Yce,n.fromString){if(n.fromObject)throw new ue(2805,!1);this.map=function Xce(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[a,c]=-1==o?[n.decodeKey(i),""]:[n.decodeKey(i.slice(0,o)),n.decodeValue(i.slice(o+1))],f=e.get(a)||[];f.push(c),e.set(a,f)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const r=n.fromObject[e],i=Array.isArray(r)?r.map(rC):[rC(r)];this.map.set(e,i)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(r=>{const i=n[r];Array.isArray(i)?i.forEach(o=>{e.push({param:r,value:o,op:"a"})}):e.push({param:r,value:i,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new vp({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(rC(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const i=r.indexOf(rC(n.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}function K5(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Y5(t){return typeof Blob<"u"&&t instanceof Blob}function X5(t){return typeof FormData<"u"&&t instanceof FormData}const n0="Content-Type",Q5="text/plain",J5="application/json",ej=`${J5}, ${Q5}, */*`;class r0{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(n,e,r,i){let o;if(this.url=e,this.method=n.toUpperCase(),function eue(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),"number"==typeof o.timeout){if(o.timeout<1||!Number.isInteger(o.timeout))throw new ue(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),o.referrerPolicy&&(this.referrerPolicy=o.referrerPolicy),this.transferCache=o.transferCache}if(this.headers??=new yu,this.context??=new Kce,this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+a}}else this.params=new vp,this.urlWithParams=e}serializeBody(){return null===this.body?null:"string"==typeof this.body||K5(this.body)||Y5(this.body)||X5(this.body)||function tue(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)?this.body:this.body instanceof vp?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||X5(this.body)?null:Y5(this.body)?this.body.type||null:K5(this.body)?null:"string"==typeof this.body?Q5:this.body instanceof vp?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?J5:null}clone(n={}){const e=n.method||this.method,r=n.url||this.url,i=n.responseType||this.responseType,o=n.keepalive??this.keepalive,a=n.priority||this.priority,c=n.cache||this.cache,f=n.mode||this.mode,_=n.redirect||this.redirect,x=n.credentials||this.credentials,C=n.referrer||this.referrer,A=n.integrity||this.integrity,N=n.referrerPolicy||this.referrerPolicy,U=n.transferCache??this.transferCache,ne=n.timeout??this.timeout,ce=void 0!==n.body?n.body:this.body,xe=n.withCredentials??this.withCredentials,Ce=n.reportProgress??this.reportProgress;let Ze=n.headers||this.headers,Se=n.params||this.params;const Ee=n.context??this.context;return void 0!==n.setHeaders&&(Ze=Object.keys(n.setHeaders).reduce((ze,Xe)=>ze.set(Xe,n.setHeaders[Xe]),Ze)),n.setParams&&(Se=Object.keys(n.setParams).reduce((ze,Xe)=>ze.set(Xe,n.setParams[Xe]),Se)),new r0(e,r,ce,{params:Se,headers:Ze,context:Ee,reportProgress:Ce,responseType:i,withCredentials:xe,transferCache:U,keepalive:o,cache:c,priority:a,timeout:ne,mode:f,redirect:_,credentials:x,referrer:C,integrity:A,referrerPolicy:N})}}var bp=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(bp||{});class VA{headers;status;statusText;url;ok;type;redirected;responseType;constructor(n,e=200,r="OK"){this.headers=n.headers||new yu,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||r,this.url=n.url||null,this.redirected=n.redirected,this.responseType=n.responseType,this.ok=this.status>=200&&this.status<300}}class oC extends VA{constructor(n={}){super(n)}type=bp.ResponseHeader;clone(n={}){return new oC({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class o0 extends VA{body;constructor(n={}){super(n),this.body=void 0!==n.body?n.body:null}type=bp.Response;clone(n={}){return new o0({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0,redirected:n.redirected??this.redirected,responseType:n.responseType??this.responseType})}}class ig extends VA{name="HttpErrorResponse";message;error;ok=!1;constructor(n){super(n,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}const nj=new Ue(""),aue=/^\)\]\}',?\n/;let rj=(()=>{class t{xhrFactory;tracingService=Q(R_,{optional:!0});constructor(e){this.xhrFactory=e}maybePropagateTrace(e){return this.tracingService?.propagate?this.tracingService.propagate(e):e}handle(e){if("JSONP"===e.method)throw new ue(-2800,!1);const r=this.xhrFactory;return Fn(null).pipe(il(()=>new H(o=>{const a=r.build();if(a.open(e.method,e.urlWithParams),e.withCredentials&&(a.withCredentials=!0),e.headers.forEach((ce,xe)=>a.setRequestHeader(ce,xe.join(","))),e.headers.has("Accept")||a.setRequestHeader("Accept",ej),!e.headers.has(n0)){const ce=e.detectContentTypeHeader();null!==ce&&a.setRequestHeader(n0,ce)}if(e.timeout&&(a.timeout=e.timeout),e.responseType){const ce=e.responseType.toLowerCase();a.responseType="json"!==ce?ce:"text"}const c=e.serializeBody();let f=null;const _=()=>{if(null!==f)return f;const ce=a.statusText||"OK",xe=new yu(a.getAllResponseHeaders());return f=new oC({headers:xe,status:a.status,statusText:ce,url:a.responseURL||e.url}),f},x=this.maybePropagateTrace(()=>{let{headers:ce,status:xe,statusText:Ce,url:Ze}=_(),Se=null;204!==xe&&(Se=typeof a.response>"u"?a.responseText:a.response),0===xe&&(xe=Se?200:0);let Ee=xe>=200&&xe<300;if("json"===e.responseType&&"string"==typeof Se){const ze=Se;Se=Se.replace(aue,"");try{Se=""!==Se?JSON.parse(Se):null}catch(Xe){Se=ze,Ee&&(Ee=!1,Se={error:Xe,text:Se})}}Ee?(o.next(new o0({body:Se,headers:ce,status:xe,statusText:Ce,url:Ze||void 0})),o.complete()):o.error(new ig({error:Se,headers:ce,status:xe,statusText:Ce,url:Ze||void 0}))}),C=this.maybePropagateTrace(ce=>{const{url:xe}=_(),Ce=new ig({error:ce,status:a.status||0,statusText:a.statusText||"Unknown Error",url:xe||void 0});o.error(Ce)});let A=C;e.timeout&&(A=this.maybePropagateTrace(ce=>{const{url:xe}=_(),Ce=new ig({error:new DOMException("Request timed out","TimeoutError"),status:a.status||0,statusText:a.statusText||"Request timeout",url:xe||void 0});o.error(Ce)}));let N=!1;const U=this.maybePropagateTrace(ce=>{N||(o.next(_()),N=!0);let xe={type:bp.DownloadProgress,loaded:ce.loaded};ce.lengthComputable&&(xe.total=ce.total),"text"===e.responseType&&a.responseText&&(xe.partialText=a.responseText),o.next(xe)}),ne=this.maybePropagateTrace(ce=>{let xe={type:bp.UploadProgress,loaded:ce.loaded};ce.lengthComputable&&(xe.total=ce.total),o.next(xe)});return a.addEventListener("load",x),a.addEventListener("error",C),a.addEventListener("timeout",A),a.addEventListener("abort",C),e.reportProgress&&(a.addEventListener("progress",U),null!==c&&a.upload&&a.upload.addEventListener("progress",ne)),a.send(c),o.next({type:bp.Sent}),()=>{a.removeEventListener("error",C),a.removeEventListener("abort",C),a.removeEventListener("load",x),a.removeEventListener("timeout",A),e.reportProgress&&(a.removeEventListener("progress",U),null!==c&&a.upload&&a.upload.removeEventListener("progress",ne)),a.readyState!==a.DONE&&a.abort()}})))}static \u0275fac=function(r){return new(r||t)(Tt(B4))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ij(t,n){return n(t)}const s0=new Ue("",{factory:()=>[]}),due=new Ue(""),oj=new Ue("",{factory:()=>!0});let sC=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:function(r){let i=null;return i=r?new(r||t):Tt(rj),i},providedIn:"root"})}return t})(),jA=(()=>{class t{backend;injector;chain=null;pendingTasks=Q(hv);contributeToStability=Q(oj);constructor(e,r){this.backend=e,this.injector=r}handle(e){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(s0),...this.injector.get(due,[])]));this.chain=r.reduceRight((i,o)=>function cue(t,n,e){return(r,i)=>qi(e,()=>n(r,o=>t(o,i)))}(i,o,this.injector),ij)}if(this.contributeToStability){const r=this.pendingTasks.add();return this.chain(e,i=>this.backend.handle(i)).pipe(Lz(r))}return this.chain(e,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||t)(Tt(sC),Tt($r))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),HA=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:function(r){let i=null;return i=r?new(r||t):Tt(jA),i},providedIn:"root"})}return t})();function $A(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,credentials:t.credentials,transferCache:t.transferCache,timeout:t.timeout,keepalive:t.keepalive,priority:t.priority,cache:t.cache,mode:t.mode,redirect:t.redirect,integrity:t.integrity,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}let fue=(()=>{class t{handler;constructor(e){this.handler=e}request(e,r,i={}){let o;if(e instanceof r0)o=e;else{let f,_;f=i.headers instanceof yu?i.headers:new yu(i.headers),i.params&&(_=i.params instanceof vp?i.params:new vp({fromObject:i.params})),o=new r0(e,r,void 0!==i.body?i.body:null,{headers:f,context:i.context,params:_,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}const a=Fn(o).pipe(VE(f=>this.handler.handle(f)));if(e instanceof r0||"events"===i.observe)return a;const c=a.pipe(Es(f=>f instanceof o0));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(mr(f=>{if(null!==f.body&&!(f.body instanceof ArrayBuffer))throw new ue(2806,!1);return f.body}));case"blob":return c.pipe(mr(f=>{if(null!==f.body&&!(f.body instanceof Blob))throw new ue(2807,!1);return f.body}));case"text":return c.pipe(mr(f=>{if(null!==f.body&&"string"!=typeof f.body)throw new ue(2808,!1);return f.body}));default:return c.pipe(mr(f=>f.body))}case"response":return c;default:throw new ue(2809,!1)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new vp).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,i={}){return this.request("PATCH",e,$A(i,r))}post(e,r,i={}){return this.request("POST",e,$A(i,r))}put(e,r,i={}){return this.request("PUT",e,$A(i,r))}static \u0275fac=function(r){return new(r||t)(Tt(HA))};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const aj=new Ue("",{factory:()=>!0}),lj=new Ue("",{factory:()=>"XSRF-TOKEN"}),cj=new Ue("",{factory:()=>"X-XSRF-TOKEN"});let vue=(()=>{class t{cookieName=Q(lj);doc=Q(Wn);lastCookieString="";lastToken=null;parseCount=0;getToken(){const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=F4(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),bue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:function(r){let i=null;return i=r?new(r||t):Tt(vue),i},providedIn:"root"})}return t})();function wue(t,n){if(!Q(aj)||"GET"===t.method||"HEAD"===t.method)return n(t);try{const i=Q(dE).href,{origin:o}=new URL(i),{origin:a}=new URL(t.url,o);if(o!==a)return n(t)}catch{return n(t)}const e=Q(bue).getToken(),r=Q(cj);return null!=e&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,e)})),n(t)}const Zo=void 0,dj=["fr",[["AM","PM"]],Zo,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Zo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Zo,[["av. J.-C.","ap. J.-C."],Zo,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}",Zo,Zo],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Zo,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Zo,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Zo,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Zo,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Zo,"\xa5"],KMF:[Zo,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Zo,"$C"],NZD:["$NZ","$"],PHP:[Zo,"\u20b1"],RHD:["$RH"],RON:[Zo,"L"],RWF:[Zo,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Zo,"$T"],TTD:["$TT","$"],TWD:[Zo,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Zo,"$"],XPF:["FCFP"],ZMW:[Zo,"Kw"]},"ltr",function Eue(t){const e=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===i&&0!==e&&e%1e6==0&&0===r||!(i>=0&&i<=5)?4:5}];function hj(t){return Es((n,e)=>t<=e)}function Due(t,n){return t===n}function qA(t){return 0===t.buttons||0===t.detail}function GA(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}let WA,KA;function aC(t){if(function Mue(){if(null==WA){const t=typeof document<"u"?document.head:null;WA=!(!t||!t.createShadowRoot&&!t.attachShadow)}return WA}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function ZA(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){const n=t.shadowRoot.activeElement;if(n===t)break;t=n}return t}function Fl(t){return t.composedPath?t.composedPath()[0]:t.target}try{KA=typeof Intl<"u"&&Intl.v8BreakIterator}catch{KA=!1}let a0,Bl=(()=>{class t{_platformId=Q(ys);isBrowser=this._platformId?function Cne(t){return t===U4}(this._platformId):"object"==typeof document&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!(!window.chrome&&!KA)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function YA(t){return function Rue(){if(null==a0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>a0=!0}))}finally{a0=a0||!1}return a0}()?t:!!t.capture}function lC(t,n=0){return function Pue(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):2===arguments.length?n:0}function sl(t){return t instanceof Ur?t.nativeElement:t}const Nue=new Ue("cdk-input-modality-detector-options"),Oue={ignoreKeys:[18,17,224,91,16]},XA={passive:!0,capture:!0};let Lue=(()=>{class t{_platform=Q(Bl);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new ae(null);_options;_lastTouchMs=0;_onKeydown=e=>{this._options?.ignoreKeys?.some(r=>r===e.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Fl(e))};_onMousedown=e=>{Date.now()-this._lastTouchMs<650||(this._modality.next(qA(e)?"keyboard":"mouse"),this._mostRecentTarget=Fl(e))};_onTouchstart=e=>{GA(e)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Fl(e))};constructor(){const e=Q(sn),r=Q(Wn),i=Q(Nue,{optional:!0});if(this._options={...Oue,...i},this.modalityDetected=this._modality.pipe(hj(1)),this.modalityChanged=this.modalityDetected.pipe(function Cue(t,n=sr){return t=t??Due,jo((e,r)=>{let i,o=!0;e.subscribe(new li(r,a=>{const c=n(a);(o||!t(i,c))&&(o=!1,i=c,r.next(a))}))})}()),this._platform.isBrowser){const o=Q(Rl).createRenderer(null,null);this._listenerCleanups=e.runOutsideAngular(()=>[o.listen(r,"keydown",this._onKeydown,XA),o.listen(r,"mousedown",this._onMousedown,XA),o.listen(r,"touchstart",this._onTouchstart,XA)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(e=>e())}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var cC=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(cC||{});const Fue=new Ue("cdk-focus-monitor-default-options"),uC=YA({passive:!0,capture:!0});let mj=(()=>{class t{_ngZone=Q(sn);_platform=Q(Bl);_inputModalityDetector=Q(Lue);_origin=null;_lastFocusOrigin=null;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=Q(Wn);_stopInputModalityDetector=new ee;constructor(){const e=Q(Fue,{optional:!0});this._detectionMode=e?.detectionMode||cC.IMMEDIATE}_rootNodeFocusAndBlurListener=e=>{for(let i=Fl(e);i;i=i.parentElement)"focus"===e.type?this._onFocus(e,i):this._onBlur(e,i)};monitor(e,r=!1){const i=sl(e);if(!this._platform.isBrowser||1!==i.nodeType)return Fn();const o=aC(i)||this._document,a=this._elementInfo.get(i);if(a)return r&&(a.checkChildren=!0),a.subject;const c={checkChildren:r,subject:new ee,rootNode:o};return this._elementInfo.set(i,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(e){const r=sl(e),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(e,r,i){const o=sl(e);o===this._document.activeElement?this._getClosestElementsInfo(o).forEach(([c,f])=>this._originChanged(c,r,f)):(this._setOrigin(r),"function"==typeof o.focus&&o.focus(i))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getWindow(){return this._document.defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===cC.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,this._detectionMode===cC.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const i=this._elementInfo.get(r),o=Fl(e);!i||!i.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),i)}_onBlur(e,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(i,null))}_emitOrigin(e,r){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,uC),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,uC)}),this._rootNodeFocusListenerCount.set(r,i+1),1===++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(vd(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,uC),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,uC),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,i){this._setClasses(e,r),this._emitOrigin(i,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((i,o)=>{(o===e||i.checkChildren&&o.contains(e))&&r.push([o,i])}),r}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:r,mostRecentModality:i}=this._inputModalityDetector;if("mouse"!==i||!r||r===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const o=e.labels;if(o)for(let a=0;a<o.length;a++)if(o[a].contains(r))return!0;return!1}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const dC=new WeakMap;let my=(()=>{class t{_appRef;_injector=Q(An);_environmentInjector=Q($r);load(e){const r=this._appRef=this._appRef||this._injector.get(tl);let i=dC.get(r);i||(i={loaders:new Set,refs:[]},dC.set(r,i),r.onDestroy(()=>{dC.get(r)?.refs.forEach(o=>o.destroy()),dC.delete(r)})),i.loaders.has(e)||(i.loaders.add(e),i.refs.push(O4(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Bue extends Qn{constructor(n,e){super()}schedule(n,e=0){return this}}const hC={setInterval(...t){const{delegate:n}=hC;return(n?.setInterval||setInterval)(...t)},clearInterval(t){const{delegate:n}=hC;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class QA extends Bue{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){if(this.closed)return this;this.state=n;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(n,e,r=0){return hC.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;hC.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let i,r=!1;try{this.work(n)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,_l(r,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const JA={now:()=>(JA.delegate||Date).now(),delegate:void 0};class l0{constructor(n,e=l0.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}}l0.now=JA.now;class eM extends l0{constructor(n,e=l0.now){super(n,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}}const tM=new eM(QA),gj=tM;function c0(t){return Array.isArray(t)?t:[t]}const _j=new Set;let sg,yj=(()=>{class t{_platform=Q(Bl);_nonce=Q(jr,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):zue}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Uue(t,n){if(!_j.has(t))try{sg||(sg=document.createElement("style"),n&&sg.setAttribute("nonce",n),sg.setAttribute("type","text/css"),document.head.appendChild(sg)),sg.sheet&&(sg.sheet.insertRule(`@media ${t} {body{ }}`,0),_j.add(t))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function zue(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let vj=(()=>{class t{_mediaMatcher=Q(yj);_zone=Q(sn);_queries=new Map;_destroySubject=new ee;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return bj(c0(e)).some(i=>this._registerQuery(i).mql.matches)}observe(e){let o=lA(bj(c0(e)).map(a=>this._registerQuery(a).observable));return o=Fb(o.pipe(Hs(1)),o.pipe(hj(1),function Vue(t,n=tM){return jo((e,r)=>{let i=null,o=null,a=null;const c=()=>{if(i){i.unsubscribe(),i=null;const _=o;o=null,r.next(_)}};function f(){const _=a+t,x=n.now();if(x<_)return i=this.schedule(void 0,_-x),void r.add(i);c()}e.subscribe(new li(r,_=>{o=_,a=n.now(),i||(i=n.schedule(f,t),r.add(i))},()=>{c(),r.complete()},void 0,()=>{o=i=null}))})}(0))),o.pipe(mr(a=>{const c={matches:!1,breakpoints:{}};return a.forEach(({matches:f,query:_})=>{c.matches=c.matches||f,c.breakpoints[_]=f}),c}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),o={observable:new H(a=>{const c=f=>this._zone.run(()=>a.next(f));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(ly(r),mr(({matches:a})=>({query:e,matches:a})),vd(this._destroySubject)),mql:r};return this._queries.set(e,o),o}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function bj(t){return t.map(n=>n.split(",")).reduce((n,e)=>n.concat(e)).map(n=>n.trim())}const jue=new Ue("MATERIAL_ANIMATIONS");let wj=null;function gy(){return"enabled"!==function Hue(){return Q(jue,{optional:!0})?.animationsDisabled||"NoopAnimations"===Q(_a,{optional:!0})?"di-disabled":(wj??=Q(yj).matchMedia("(prefers-reduced-motion)").matches,wj?"reduced-motion":"enabled")}()}var Rc=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Rc||{});class $ue{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Rc.HIDDEN;constructor(n,e,r,i=!1){this._renderer=n,this.element=e,this.config=r,this._animationForciblyDisabledThroughCss=i}fadeOut(){this._renderer.fadeOutRipple(this)}}const xj=YA({passive:!0,capture:!0});class que{_events=new Map;addHandler(n,e,r,i){const o=this._events.get(e);if(o){const a=o.get(r);a?a.add(i):o.set(r,new Set([i]))}else this._events.set(e,new Map([[r,new Set([i])]])),n.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,xj)})}removeHandler(n,e,r){const i=this._events.get(n);if(!i)return;const o=i.get(e);o&&(o.delete(r),0===o.size&&i.delete(e),0===i.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,xj)))}_delegateEventHandler=n=>{const e=Fl(n);e&&this._events.get(n.type)?.forEach((r,i)=>{(i===e||i.contains(e))&&r.forEach(o=>o.handleEvent(n))})}}const fC={enterDuration:225,exitDuration:150},Ej=YA({passive:!0,capture:!0}),Cj=["mousedown","touchstart"],Dj=["mouseup","mouseleave","touchend","touchcancel"];let Wue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}\n"],encapsulation:2,changeDetection:0})}return t})();class pC{_target;_ngZone;_platform;_containerElement;_triggerElement=null;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple=null;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect=null;static _eventManager=new que;constructor(n,e,r,i,o){this._target=n,this._ngZone=e,this._platform=i,i.isBrowser&&(this._containerElement=sl(r)),o&&o.get(my).load(Wue)}fadeInRipple(n,e,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...fC,...r.animation};r.centered&&(n=i.left+i.width/2,e=i.top+i.height/2);const a=r.radius||function Zue(t,n,e){const r=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),i=Math.max(Math.abs(n-e.top),Math.abs(n-e.bottom));return Math.sqrt(r*r+i*i)}(n,e,i),c=n-i.left,f=e-i.top,_=o.enterDuration,x=document.createElement("div");x.classList.add("mat-ripple-element"),x.style.left=c-a+"px",x.style.top=f-a+"px",x.style.height=2*a+"px",x.style.width=2*a+"px",null!=r.color&&(x.style.backgroundColor=r.color),x.style.transitionDuration=`${_}ms`,this._containerElement.appendChild(x);const C=window.getComputedStyle(x),N=C.transitionDuration,U="none"===C.transitionProperty||"0s"===N||"0s, 0s"===N||0===i.width&&0===i.height,ne=new $ue(this,x,r,U);x.style.transform="scale3d(1, 1, 1)",ne.state=Rc.FADING_IN,r.persistent||(this._mostRecentTransientRipple=ne);let ce=null;return!U&&(_||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const xe=()=>{ce&&(ce.fallbackTimer=null),clearTimeout(Ze),this._finishRippleTransition(ne)},Ce=()=>this._destroyRipple(ne),Ze=setTimeout(Ce,_+100);x.addEventListener("transitionend",xe),x.addEventListener("transitioncancel",Ce),ce={onTransitionEnd:xe,onTransitionCancel:Ce,fallbackTimer:Ze}}),this._activeRipples.set(ne,ce),(U||!_)&&this._finishRippleTransition(ne),ne}fadeOutRipple(n){if(n.state===Rc.FADING_OUT||n.state===Rc.HIDDEN)return;const e=n.element,r={...fC,...n.config.animation};e.style.transitionDuration=`${r.exitDuration}ms`,e.style.opacity="0",n.state=Rc.FADING_OUT,(n._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const e=sl(n);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,Cj.forEach(r=>{pC._eventManager.addHandler(this._ngZone,r,e,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Dj.forEach(e=>{this._triggerElement.addEventListener(e,this,Ej)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){n.state===Rc.FADING_IN?this._startFadeOutTransition(n):n.state===Rc.FADING_OUT&&this._destroyRipple(n)}_startFadeOutTransition(n){const e=n===this._mostRecentTransientRipple,{persistent:r}=n.config;n.state=Rc.VISIBLE,!r&&(!e||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const e=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=Rc.HIDDEN,null!==e&&(n.element.removeEventListener("transitionend",e.onTransitionEnd),n.element.removeEventListener("transitioncancel",e.onTransitionCancel),null!==e.fallbackTimer&&clearTimeout(e.fallbackTimer)),n.element.remove()}_onMousedown(n){const e=qA(n),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!GA(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=n.changedTouches;if(e)for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(n.state===Rc.VISIBLE||n.config.terminateOnPointerUp&&n.state===Rc.FADING_IN)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(Cj.forEach(e=>pC._eventManager.removeHandler(e,n,this)),this._pointerUpEventsRegistered&&(Dj.forEach(e=>n.removeEventListener(e,this,Ej)),this._pointerUpEventsRegistered=!1))}}const Kue=new Ue("mat-ripple-global-options"),Yue={capture:!0},Xue=["focus","mousedown","mouseenter","touchstart"],nM="mat-ripple-loader-uninitialized",rM="mat-ripple-loader-class-name",Tj="mat-ripple-loader-centered",mC="mat-ripple-loader-disabled";let Que=(()=>{class t{_document=Q(Wn);_animationsDisabled=gy();_globalRippleOptions=Q(Kue,{optional:!0});_platform=Q(Bl);_ngZone=Q(sn);_injector=Q(An);_eventCleanups;_hosts=new Map;constructor(){const e=Q(Rl).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>Xue.map(r=>e.listen(this._document,r,this._onInteraction,Yue)))}ngOnDestroy(){const e=this._hosts.keys();for(const r of e)this.destroyRipple(r);this._eventCleanups.forEach(r=>r())}configureRipple(e,r){e.setAttribute(nM,this._globalRippleOptions?.namespace??""),(r.className||!e.hasAttribute(rM))&&e.setAttribute(rM,r.className||""),r.centered&&e.setAttribute(Tj,""),r.disabled&&e.setAttribute(mC,"")}setDisabled(e,r){const i=this._hosts.get(e);i?(i.target.rippleDisabled=r,!r&&!i.hasSetUpEvents&&(i.hasSetUpEvents=!0,i.renderer.setupTriggerEvents(e))):r?e.setAttribute(mC,""):e.removeAttribute(mC)}_onInteraction=e=>{const r=Fl(e);if(r instanceof HTMLElement){const i=r.closest(`[${nM}="${this._globalRippleOptions?.namespace??""}"]`);i&&this._createRipple(i)}};_createRipple(e){if(!this._document||this._hosts.has(e))return;e.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",e.getAttribute(rM)),e.append(r);const i=this._globalRippleOptions,o=this._animationsDisabled?0:i?.animation?.enterDuration??fC.enterDuration,a=this._animationsDisabled?0:i?.animation?.exitDuration??fC.exitDuration,c={rippleDisabled:this._animationsDisabled||i?.disabled||e.hasAttribute(mC),rippleConfig:{centered:e.hasAttribute(Tj),terminateOnPointerUp:i?.terminateOnPointerUp,animation:{enterDuration:o,exitDuration:a}}},f=new pC(c,this._ngZone,r,this._platform,this._injector),_=!c.rippleDisabled;_&&f.setupTriggerEvents(e),this._hosts.set(e,{target:c,renderer:f,hasSetUpEvents:_}),e.removeAttribute(nM)}destroyRipple(e){const r=this._hosts.get(e);r&&(r.renderer._removeTriggerEvents(),this._hosts.delete(e))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Jue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["structural-styles"]],decls:0,vars:0,template:function(r,i){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus-visible::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}\n'],encapsulation:2,changeDetection:0})}return t})();const ede=new Ue("MAT_BUTTON_CONFIG");function Sj(t){return null==t?void 0:M4(t)}let tde=(()=>{class t{_elementRef=Q(Ur);_ngZone=Q(sn);_animationsDisabled=gy();_config=Q(ede,{optional:!0});_focusMonitor=Q(mj);_cleanupClick;_renderer=Q(Xa);_rippleLoader=Q(Que);_isAnchor;_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;tabIndex;set _tabindex(e){this.tabIndex=e}constructor(){Q(my).load(Jue);const e=this._elementRef.nativeElement;this._isAnchor="A"===e.tagName,this.disabledInteractive=this._config?.disabledInteractive??!1,this.color=this._config?.color??null,this._rippleLoader?.configureRipple(e,{className:"mat-mdc-button-ripple"})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0),this._isAnchor&&this._setupAsAnchor()}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",r){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:this._isAnchor?this.disabled||null:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}_getTabIndex(){return this._isAnchor&&this.disabled&&!this.disabledInteractive?-1:this.tabIndex}_setupAsAnchor(){this._cleanupClick=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"click",e=>{this.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}))}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,hostAttrs:[1,"mat-mdc-button-base"],hostVars:13,hostBindings:function(r,i){2&r&&(na("disabled",i._getDisabledAttribute())("aria-disabled",i._getAriaDisabled())("tabindex",i._getTabIndex()),is(i.color?"mat-"+i.color:""),js("mat-mdc-button-disabled",i.disabled)("mat-mdc-button-disabled-interactive",i.disabledInteractive)("mat-unthemed",!i.color)("_mat-animation-noopable",i._animationsDisabled))},inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",ws],disabled:[2,"disabled","disabled",ws],ariaDisabled:[2,"aria-disabled","ariaDisabled",ws],disabledInteractive:[2,"disabledInteractive","disabledInteractive",ws],tabIndex:[2,"tabIndex","tabIndex",Sj],_tabindex:[2,"tabindex","_tabindex",Sj]}})}return t})(),ag=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})(),nde=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[ag]})}return t})();const rde=["matButton",""],ide=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],ode=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Ij=new Map([["text",["mat-mdc-button"]],["filled",["mdc-button--unelevated","mat-mdc-unelevated-button"]],["elevated",["mdc-button--raised","mat-mdc-raised-button"]],["outlined",["mdc-button--outlined","mat-mdc-outlined-button"]],["tonal",["mat-tonal-button"]]]);let sde=(()=>{class t extends tde{get appearance(){return this._appearance}set appearance(e){this.setAppearance(e||this._config?.defaultAppearance||"text")}_appearance=null;constructor(){super();const e=function ade(t){return t.hasAttribute("mat-raised-button")?"elevated":t.hasAttribute("mat-stroked-button")?"outlined":t.hasAttribute("mat-flat-button")?"filled":t.hasAttribute("mat-button")?"text":null}(this._elementRef.nativeElement);e&&this.setAppearance(e)}setAppearance(e){if(e===this._appearance)return;const r=this._elementRef.nativeElement.classList,i=this._appearance?Ij.get(this._appearance):null,o=Ij.get(e);i&&r.remove(...i),r.add(...o),this._appearance=e}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["button","matButton",""],["a","matButton",""],["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""],["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostAttrs:[1,"mdc-button"],inputs:{appearance:[0,"matButton","appearance"]},exportAs:["matButton","matAnchor"],features:[Yn],attrs:rde,ngContentSelectors:ode,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,i){1&r&&(function V3(t){const n=Le()[15][5];if(!n.projection){const r=n.projection=function Xd(t,n){const e=[];for(let r=0;r<t;r++)e.push(n);return e}(t?t.length:1,null),i=r.slice();let o=n.child;for(;null!==o;){if(128!==o.type){const a=t?wJ(o,t):0;null!==a&&(i[a]?i[a].projectionNext=o:r[a]=o,i[a]=o)}o=o.next}}}(ide),md(0,"span",0),K1(1),Yt(2,"span",1),K1(3,1),Gt(),K1(4,2),md(5,"span",2)(6,"span",3)),2&r&&js("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mat-mdc-button-base .mat-icon{min-height:fit-content;flex-shrink:0}@media(hover: none){.mat-mdc-button-base:hover>span.mat-mdc-button-persistent-ripple::before{opacity:0}}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-button-text-horizontal-padding, 12px);height:var(--mat-button-text-container-height, 40px);font-family:var(--mat-button-text-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-text-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-text-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-text-label-text-transform);font-weight:var(--mat-button-text-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mat-button-text-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mat-button-text-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-text-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-button-text-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-button-text-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-text-touch-target-size, 48px);display:var(--mat-button-text-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-filled-container-height, 40px);font-family:var(--mat-button-filled-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-filled-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-filled-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-filled-label-text-transform);font-weight:var(--mat-button-filled-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-filled-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-button-filled-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-filled-touch-target-size, 48px);display:var(--mat-button-filled-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mat-button-filled-label-text-color, var(--mat-sys-on-primary));background-color:var(--mat-button-filled-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mat-button-filled-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-filled-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-filled-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mat-button-protected-container-elevation-shadow, var(--mat-sys-level1));height:var(--mat-button-protected-container-height, 40px);font-family:var(--mat-button-protected-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-protected-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-protected-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-protected-label-text-transform);font-weight:var(--mat-button-protected-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-protected-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-button-protected-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-protected-touch-target-size, 48px);display:var(--mat-button-protected-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-raised-button:not(:disabled){color:var(--mat-button-protected-label-text-color, var(--mat-sys-primary));background-color:var(--mat-button-protected-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mat-button-protected-container-shape, var(--mat-sys-corner-full))}@media(hover: hover){.mat-mdc-raised-button:hover{box-shadow:var(--mat-button-protected-hover-container-elevation-shadow, var(--mat-sys-level2))}}.mat-mdc-raised-button:focus{box-shadow:var(--mat-button-protected-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mat-button-protected-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-protected-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-protected-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mat-button-protected-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-outlined-container-height, 40px);font-family:var(--mat-button-outlined-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-outlined-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-outlined-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-outlined-label-text-transform);font-weight:var(--mat-button-outlined-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mat-button-outlined-container-shape, var(--mat-sys-corner-full));border-width:var(--mat-button-outlined-outline-width, 1px);padding:0 var(--mat-button-outlined-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-button-outlined-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-outlined-touch-target-size, 48px);display:var(--mat-button-outlined-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-outlined-button:not(:disabled){color:var(--mat-button-outlined-label-text-color, var(--mat-sys-primary));border-color:var(--mat-button-outlined-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-outlined-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mat-button-outlined-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-tonal-container-height, 40px);font-family:var(--mat-button-tonal-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-tonal-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-tonal-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-tonal-label-text-transform);font-weight:var(--mat-button-tonal-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-tonal-horizontal-padding, 24px)}.mat-tonal-button:not(:disabled){color:var(--mat-button-tonal-label-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-button-tonal-container-color, var(--mat-sys-secondary-container))}.mat-tonal-button,.mat-tonal-button .mdc-button__ripple{border-radius:var(--mat-button-tonal-container-shape, var(--mat-sys-corner-full))}.mat-tonal-button[disabled],.mat-tonal-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-tonal-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-tonal-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-tonal-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}[dir=rtl] .mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}.mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}[dir=rtl] .mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}.mat-tonal-button .mat-ripple-element{background-color:var(--mat-button-tonal-ripple-color, color-mix(in srgb, var(--mat-sys-on-secondary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-tonal-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-tonal-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-tonal-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-tonal-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-tonal-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-tonal-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-tonal-touch-target-size, 48px);display:var(--mat-button-tonal-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button,.mat-tonal-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon,.mat-tonal-button .mdc-button__label,.mat-tonal-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator,.mat-tonal-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit}.mat-mdc-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-raised-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus-visible>.mat-focus-indicator::before,.mat-tonal-button:focus-visible>.mat-focus-indicator::before{content:"";border-radius:inherit}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable,.mat-tonal-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon,.mat-tonal-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-tonal-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}\n',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-button-base.mat-tonal-button,.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}\n"],encapsulation:2,changeDetection:0})}return t})(),cde=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[nde,ag]})}return t})();const iM={};class vu{_appId=Q(Tr);static _infix=`a${Math.floor(1e5*Math.random()).toString()}`;getId(n,e=!1){return"ng"!==this._appId&&(n+=this._appId),iM.hasOwnProperty(n)||(iM[n]=0),`${n}${e?vu._infix+"-":""}${iM[n]++}`}static \u0275fac=function(e){return new(e||vu)};static \u0275prov=$e({token:vu,factory:vu.\u0275fac,providedIn:"root"})}let gC,ude=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(r,i){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}\n"],encapsulation:2,changeDetection:0})}return t})();let pde=(()=>{class t{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),mde=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[pde]})}return t})(),kj=(()=>{class t{_platform=Q(Bl);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function _de(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const r=function gde(t){try{return t.frameElement}catch{return null}}(function Dde(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(e));if(r&&(-1===Mj(r)||!this.isVisible(r)))return!1;let i=e.nodeName.toLowerCase(),o=Mj(e);return e.hasAttribute("contenteditable")?-1!==o:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function Ede(t){let n=t.nodeName.toLowerCase(),e="input"===n&&t.type;return"text"===e||"password"===e||"select"===n||"textarea"===n}(e))&&("audio"===i?!!e.hasAttribute("controls")&&-1!==o:"video"===i?-1!==o&&(null!==o||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,r){return function Cde(t){return!function vde(t){return function wde(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function yde(t){let n=t.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(t)||function bde(t){return function xde(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||Aj(t))}(e)&&!this.isDisabled(e)&&(r?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Aj(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let n=t.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function Mj(t){if(!Aj(t))return null;const n=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class Tde{_element;_checker;_ngZone;_document;_injector;_startAnchor=null;_endAnchor=null;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_enabled=!0;constructor(n,e,r,i,o=!1,a){this._element=n,this._checker=e,this._ngZone=r,this._document=i,this._injector=a,o||this.attachAnchors()}destroy(){const n=this._startAnchor,e=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const e=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const r=this._getFirstTabbableElement(e);return r?.focus(n),!!r}return e.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const e=this._getRegionBoundary("start");return e&&e.focus(n),!!e}focusLastTabbableElement(n){const e=this._getRegionBoundary("end");return e&&e.focus(n),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=0;r<e.length;r++){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[r]):null;if(i)return i}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=e.length-1;r>=0;r--){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[r]):null;if(i)return i}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,e){n?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._injector?hu(n,{injector:this._injector}):setTimeout(n)}}let Sde=(()=>{class t{_checker=Q(kj);_ngZone=Q(sn);_document=Q(Wn);_injector=Q(An);constructor(){Q(my).load(ude)}create(e,r=!1){return new Tde(e,this._checker,this._ngZone,this._document,r,this._injector)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ide=new Ue("liveAnnouncerElement",{providedIn:"root",factory:()=>null}),kde=new Ue("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Ade=0,Mde=(()=>{class t{_ngZone=Q(sn);_defaultOptions=Q(kde,{optional:!0});_liveElement;_document=Q(Wn);_sanitizer=Q(Vz);_previousTimeout;_currentPromise;_currentResolve;constructor(){const e=Q(Ide,{optional:!0});this._liveElement=e||this._createLiveElement()}announce(e,...r){const i=this._defaultOptions;let o,a;return 1===r.length&&"number"==typeof r[0]?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=i&&i.politeness?i.politeness:"polite"),null==a&&i&&(a=i.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(c=>this._currentResolve=c)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{e&&"string"!=typeof e?function fde(t,n,e){const r=e.sanitize(Al.HTML,n);t.innerHTML=function hde(t){return function dde(){if(void 0===gC&&(gC=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(gC=t.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return gC}()?.createHTML(t)||t}(r||"")}(this._liveElement,e,this._sanitizer):this._liveElement.textContent=e,"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",r=this._document.getElementsByClassName(e),i=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return i.classList.add(e),i.classList.add("cdk-visually-hidden"),i.setAttribute("aria-atomic","true"),i.setAttribute("aria-live","polite"),i.id="cdk-live-announcer-"+Ade++,this._document.body.appendChild(i),i}_exposeAnnouncerToModals(e){const r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");a?-1===a.indexOf(e)&&o.setAttribute("aria-owns",a+" "+e):o.setAttribute("aria-owns",e)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var lg=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(lg||{});const Rj="cdk-high-contrast-black-on-white",Pj="cdk-high-contrast-white-on-black",oM="cdk-high-contrast-active";let Rde=(()=>{class t{_platform=Q(Bl);_hasCheckedHighContrastMode=!1;_document=Q(Wn);_breakpointSubscription;constructor(){this._breakpointSubscription=Q(vj).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return lg.NONE;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(e):null,o=(i&&i.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return lg.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return lg.BLACK_ON_WHITE}return lg.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(oM,Rj,Pj),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();r===lg.BLACK_ON_WHITE?e.add(oM,Rj):r===lg.WHITE_ON_BLACK&&e.add(oM,Pj)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Pde=(()=>{class t{constructor(){Q(Rde)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[mde]})}return t})();class sM{_attachedHost=null;attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class u0 extends sM{component;viewContainerRef;injector;projectableNodes;constructor(n,e,r,i){super(),this.component=n,this.viewContainerRef=e,this.injector=r,this.projectableNodes=i}}class aM extends sM{templateRef;viewContainerRef;context;injector;constructor(n,e,r,i){super(),this.templateRef=n,this.viewContainerRef=e,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(n,e=this.context){return this.context=e,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class Nde extends sM{element;constructor(n){super(),this.element=n instanceof Ur?n.nativeElement:n}}class _C{_attachedPortal=null;_disposeFn=null;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof u0?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof aM?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof Nde?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Ode extends _C{outletElement;_appRef;_defaultInjector;constructor(n,e,r){super(),this.outletElement=n,this._appRef=e,this._defaultInjector=r}attachComponentPortal(n){let e;if(n.viewContainerRef){const r=n.injector||n.viewContainerRef.injector,i=r.get(Ih,null,{optional:!0})||void 0;e=n.viewContainerRef.createComponent(n.component,{index:n.viewContainerRef.length,injector:r,ngModuleRef:i,projectableNodes:n.projectableNodes||void 0}),this.setDisposeFn(()=>e.destroy())}else{const r=this._appRef,i=n.injector||this._defaultInjector||An.NULL,o=i.get($r,r.injector);e=O4(n.component,{elementInjector:i,environmentInjector:o,projectableNodes:n.projectableNodes||void 0}),r.attachView(e.hostView),this.setDisposeFn(()=>{r.viewCount>0&&r.detachView(e.hostView),e.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(e)),this._attachedPortal=n,e}attachTemplatePortal(n){let e=n.viewContainerRef,r=e.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=e.indexOf(r);-1!==i&&e.remove(i)}),this._attachedPortal=n,r}attachDomPortal=n=>{const e=n.element,r=this.outletElement.ownerDocument.createComment("dom-portal");e.parentNode.insertBefore(r,e),this.outletElement.appendChild(e),this._attachedPortal=n,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(e,r)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let d0=(()=>{class t extends _C{_moduleRef=Q(Ih,{optional:!0});_document=Q(Wn);_viewContainerRef=Q(Pl);_isInitialized=!1;_attachedRef=null;constructor(){super()}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}attached=new Zn;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const r=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,i=r.createComponent(e.component,{index:r.length,injector:e.injector||r.injector,projectableNodes:e.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return r!==this._viewContainerRef&&this._getRootNode().appendChild(i.hostView.rootNodes[0]),super.setDisposeFn(()=>i.destroy()),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}attachTemplatePortal(e){e.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}attachDomPortal=e=>{const r=e.element,i=this._document.createComment("dom-portal");e.setAttachedHost(this),r.parentNode.insertBefore(i,r),this._getRootNode().appendChild(r),this._attachedPortal=e,super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(r,i)})};_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Yn]})}return t})(),h0=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})();function Nj(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Ko(t){return null==t?"":"string"==typeof t?t:`${t}px`}const f0={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=f0;r&&(n=r.requestAnimationFrame,e=r.cancelAnimationFrame);const i=n(o=>{e=void 0,t(o)});return new Qn(()=>e?.(i))},requestAnimationFrame(...t){const{delegate:n}=f0;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=f0;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0},Oj=new class Bde extends eM{flush(n){this._active=!0,this._scheduled=void 0;const{actions:e}=this;let r,i=-1;n=n||e.shift();const o=e.length;do{if(r=n.execute(n.state,n.delay))break}while(++i<o&&(n=e.shift()));if(this._active=!1,r){for(;++i<o&&(n=e.shift());)n.unsubscribe();throw r}}}(class Fde extends QA{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=f0.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(n,e,r);0===n.actions.length&&(f0.cancelAnimationFrame(e),n._scheduled=void 0)}});let lM,Vde=1;const yC={};function Lj(t){return t in yC&&(delete yC[t],!0)}const Ude={setImmediate(t){const n=Vde++;return yC[n]=!0,lM||(lM=Promise.resolve()),lM.then(()=>Lj(n)&&t()),n},clearImmediate(t){Lj(t)}},{setImmediate:zde,clearImmediate:jde}=Ude,vC={setImmediate(...t){const{delegate:n}=vC;return(n?.setImmediate||zde)(...t)},clearImmediate(t){const{delegate:n}=vC;return(n?.clearImmediate||jde)(t)},delegate:void 0};new class $de extends eM{flush(n){this._active=!0,this._scheduled=void 0;const{actions:e}=this;let r,i=-1;n=n||e.shift();const o=e.length;do{if(r=n.execute(n.state,n.delay))break}while(++i<o&&(n=e.shift()));if(this._active=!1,r){for(;++i<o&&(n=e.shift());)n.unsubscribe();throw r}}}(class Hde extends QA{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=vC.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(n,e,r);0===n.actions.length&&(vC.clearImmediate(e),n._scheduled=void 0)}});function Fj(t=0,n,e=gj){let r=-1;return null!=n&&(kz(n)?e=n:r=n),new H(i=>{let o=function Wde(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let a=0;return e.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function Bj(t,n=gj){return function Gde(t){return jo((n,e)=>{let r=!1,i=null,o=null,a=!1;const c=()=>{if(o?.unsubscribe(),o=null,r){r=!1;const _=i;i=null,e.next(_)}a&&e.complete()},f=()=>{o=null,a&&e.complete()};n.subscribe(new li(e,_=>{r=!0,i=_,o||kc(t(_)).subscribe(o=new li(e,c,f))},()=>{a=!0,(!r||!o||o.closed)&&e.complete()}))})}(()=>Fj(t,n))}const Zde=new Ue("cdk-dir-doc",{providedIn:"root",factory:()=>Q(Wn)}),Kde=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let cg,_y=(()=>{class t{get value(){return this.valueSignal()}valueSignal=Pi("ltr");change=new Zn;constructor(){const e=Q(Zde,{optional:!0});e&&this.valueSignal.set(function Yde(t){const n=t?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?Kde.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Vj(){if(null==cg){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return cg=!1,cg;if(document.documentElement?.style&&"scrollBehavior"in document.documentElement.style)cg=!0;else{const t=Element.prototype.scrollTo;cg=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return cg}let wC=(()=>{class t{_ngZone=Q(sn);_platform=Q(Bl);_renderer=Q(Rl).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new ee;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new H(r=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));const i=e>0?this._scrolled.pipe(Bj(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Fn()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(Es(o=>!o||i.indexOf(o)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((i,o)=>{this._scrollableContainsElement(o,e)&&r.push(o)}),r}_scrollableContainsElement(e,r){let i=sl(r),o=e.getElementRef().nativeElement;do{if(i==o)return!0}while(i=i.parentElement);return!1}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),yy=(()=>{class t{_platform=Q(Bl);_listeners;_viewportSize=null;_change=new ee;_document=Q(Wn);constructor(){const e=Q(sn),r=Q(Rl).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){const i=o=>this._change.next(o);this._listeners=[r.listen("window","resize",i),r.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),i=e.documentElement,o=i.getBoundingClientRect();return{top:-o.top||e.body?.scrollTop||r.scrollY||i.scrollTop||0,left:-o.left||e.body?.scrollLeft||r.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(Bj(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),cM=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})(),Uj=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[ag,cM,ag,cM]})}return t})();const zj=Vj();function uM(t){return new ehe(t.get(yy),t.get(Wn))}class ehe{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(n,e){this._viewportRuler=n,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=Ko(-this._previousScrollPosition.left),n.style.top=Ko(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,r=n.style,i=this._document.body.style,o=r.scrollBehavior||"",a=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),zj&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),zj&&(r.scrollBehavior=o,i.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.documentElement,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class nhe{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(n,e,r,i){this._scrollDispatcher=n,this._ngZone=e,this._viewportRuler=r,this._config=i}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(Es(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}class dM{enable(){}disable(){}attach(){}}function hM(t,n){return n.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function jj(t,n){return n.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class rhe{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(n,e,r,i){this._scrollDispatcher=n,this._viewportRuler=e,this._ngZone=r,this._config=i}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();hM(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let ihe=(()=>{class t{_injector=Q(An);constructor(){}noop=()=>new dM;close=e=>function the(t,n){return new nhe(t.get(wC),t.get(sn),t.get(yy),n)}(this._injector,e);block=()=>uM(this._injector);reposition=e=>function Hj(t,n){return new rhe(t.get(wC),t.get(yy),t.get(sn),n)}(this._injector,e);static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class fM{positionStrategy;scrollStrategy=new dM;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";disableAnimations;width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;usePopover;constructor(n){if(n){const e=Object.keys(n);for(const r of e)void 0!==n[r]&&(this[r]=n[r])}}}class ohe{connectionPair;scrollableViewProperties;constructor(n,e){this.connectionPair=n,this.scrollableViewProperties=e}}let $j=(()=>{class t{_attachedOverlays=[];_document=Q(Wn);_isAttached=!1;constructor(){}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),she=(()=>{class t extends $j{_ngZone=Q(sn);_renderer=Q(Rl).createRenderer(null,null);_cleanupKeydown;add(e){super.add(e),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=e=>{const r=this._attachedOverlays;for(let i=r.length-1;i>-1;i--)if(r[i]._keydownEvents.observers.length>0){this._ngZone.run(()=>r[i]._keydownEvents.next(e));break}};static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ahe=(()=>{class t extends $j{_platform=Q(Bl);_ngZone=Q(sn);_renderer=Q(Rl).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget=null;_cleanups;add(e){if(super.add(e),!this._isAttached){const r=this._document.body,i={capture:!0},o=this._renderer;this._cleanups=this._ngZone.runOutsideAngular(()=>[o.listen(r,"pointerdown",this._pointerDownListener,i),o.listen(r,"click",this._clickListener,i),o.listen(r,"auxclick",this._clickListener,i),o.listen(r,"contextmenu",this._clickListener,i)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(e=>e()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=e=>{this._pointerDownEventTarget=Fl(e)};_clickListener=e=>{const r=Fl(e),i="click"===e.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:r;this._pointerDownEventTarget=null;const o=this._attachedOverlays.slice();for(let a=o.length-1;a>-1;a--){const c=o[a];if(c._outsidePointerEvents.observers.length<1||!c.hasAttached())continue;if(qj(c.overlayElement,r)||qj(c.overlayElement,i))break;const f=c._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>f.next(e)):f.next(e)}};static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function qj(t,n){const e=typeof ShadowRoot<"u"&&ShadowRoot;let r=n;for(;r;){if(r===t)return!0;r=e&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}let Gj=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0;touch-action:manipulation}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}.cdk-overlay-popover{background:none;border:none;padding:0;outline:0;overflow:visible;position:fixed;pointer-events:none;white-space:normal;color:inherit;text-decoration:none;width:100%;height:100%;inset:auto;top:0;left:0}.cdk-overlay-popover::backdrop{display:none}.cdk-overlay-popover .cdk-overlay-backdrop{position:fixed;z-index:auto}\n"],encapsulation:2,changeDetection:0})}return t})(),pM=(()=>{class t{_platform=Q(Bl);_containerElement;_document=Q(Wn);_styleLoader=Q(my);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||Nj()){const i=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let o=0;o<i.length;o++)i[o].remove()}const r=this._document.createElement("div");r.classList.add(e),Nj()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}_loadStyles(){this._styleLoader.load(Gj)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class lhe{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(n,e,r,i){this._renderer=e,this._ngZone=r,this.element=n.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=e.listen(this.element,"click",i)}detach(){this._ngZone.runOutsideAngular(()=>{const n=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(n,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),n.style.pointerEvents="none",n.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}}function mM(t){return t&&1===t.nodeType}class Wj{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new ee;_attachments=new ee;_detachments=new ee;_positionStrategy;_scrollStrategy;_locationChanges=Qn.EMPTY;_backdropRef=null;_detachContentMutationObserver;_detachContentAfterRenderRef;_disposed=!1;_previousHostParent;_keydownEvents=new ee;_outsidePointerEvents=new ee;_afterNextRenderRef;constructor(n,e,r,i,o,a,c,f,_,x=!1,C,A){this._portalOutlet=n,this._host=e,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=a,this._document=c,this._location=f,this._outsideClickDispatcher=_,this._animationsDisabled=x,this._injector=C,this._renderer=A,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(n){if(this._disposed)return null;this._attachHost();const e=this._portalOutlet.attach(n);return this._positionStrategy?.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=hu(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._completeDetachContent(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._completeDetachContent(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){if(this._disposed)return;const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,n&&this._detachments.next(),this._detachments.complete(),this._completeDetachContent(),this._disposed=!0}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=Ko(this._config.width),n.height=Ko(this._config.height),n.minWidth=Ko(this._config.minWidth),n.minHeight=Ko(this._config.minHeight),n.maxWidth=Ko(this._config.maxWidth),n.maxHeight=Ko(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachHost(){if(!this._host.parentElement){const n=this._config.usePopover?this._positionStrategy?.getPopoverInsertionPoint?.():null;mM(n)?n.after(this._host):"parent"===n?.type?n.element.appendChild(this._host):this._previousHostParent?.appendChild(this._host)}if(this._config.usePopover)try{this._host.showPopover()}catch{}}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new lhe(this._document,this._renderer,this._ngZone,e=>{this._backdropClick.next(e)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._config.usePopover?this._host.prepend(this._backdropRef.element):this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(n))}):this._backdropRef.element.classList.add(n)}_updateStackingOrder(){!this._config.usePopover&&this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(n,e,r){const i=c0(e||[]).filter(o=>!!o);i.length&&(r?n.classList.add(...i):n.classList.remove(...i))}_detachContentWhenEmpty(){let n=!1;try{this._detachContentAfterRenderRef=hu(()=>{n=!0,this._detachContent()},{injector:this._injector})}catch(e){if(n)throw e;this._detachContent()}globalThis.MutationObserver&&this._pane&&(this._detachContentMutationObserver||=new globalThis.MutationObserver(()=>{this._detachContent()}),this._detachContentMutationObserver.observe(this._pane,{childList:!0}))}_detachContent(){(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),this._completeDetachContent())}_completeDetachContent(){this._detachContentAfterRenderRef?.destroy(),this._detachContentAfterRenderRef=void 0,this._detachContentMutationObserver?.disconnect()}_disposeScrollStrategy(){const n=this._scrollStrategy;n?.disable(),n?.detach?.()}}const Zj="cdk-overlay-connected-position-bounding-box",che=/([A-Za-z%]+)$/;class dhe{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender=!1;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed=!1;_boundingBox=null;_lastPosition=null;_lastScrollVisibility=null;_positionChanges=new ee;_resizeSubscription=Qn.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount=null;_popoverLocation="global";positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(n,e,r,i,o){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=o,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(Zj),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._getContainerRect();const n=this._originRect,e=this._overlayRect,r=this._viewportRect,i=this._containerRect,o=[];let a;for(let c of this._preferredPositions){let f=this._getOriginPoint(n,i,c),_=this._getOverlayPoint(f,e,c),x=this._getOverlayFit(_,e,r,c);if(x.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(c,f);this._canFitWithFlexibleDimensions(x,_,r)?o.push({position:c,origin:f,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(f,c)}):(!a||a.overlayFit.visibleArea<x.visibleArea)&&(a={overlayFit:x,overlayPoint:_,originPoint:f,position:c,overlayRect:e})}if(o.length){let c=null,f=-1;for(const _ of o){const x=_.boundingBoxRect.width*_.boundingBoxRect.height*(_.position.weight||1);x>f&&(f=x,c=_)}return this._isPushed=!1,void this._applyPosition(c.position,c.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&ug(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Zj),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;n?(this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._getContainerRect(),this._applyPosition(n,this._getOriginPoint(this._originRect,this._containerRect,n))):this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}withPopoverLocation(n){return this._popoverLocation=n,this}getPopoverInsertionPoint(){return"global"===this._popoverLocation?null:"inline"!==this._popoverLocation?this._popoverLocation:this._origin instanceof Ur?this._origin.nativeElement:mM(this._origin)?this._origin:null}_getOriginPoint(n,e,r){let i,o;if("center"==r.originX)i=n.left+n.width/2;else{const a=this._isRtl()?n.right:n.left,c=this._isRtl()?n.left:n.right;i="start"==r.originX?a:c}return e.left<0&&(i-=e.left),o="center"==r.originY?n.top+n.height/2:"top"==r.originY?n.top:n.bottom,e.top<0&&(o-=e.top),{x:i,y:o}}_getOverlayPoint(n,e,r){let i,o;return i="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,o="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:n.x+i,y:n.y+o}}_getOverlayFit(n,e,r,i){const o=Yj(e);let{x:a,y:c}=n,f=this._getOffset(i,"x"),_=this._getOffset(i,"y");f&&(a+=f),_&&(c+=_);let A=0-c,N=c+o.height-r.height,U=this._subtractOverflows(o.width,0-a,a+o.width-r.width),ne=this._subtractOverflows(o.height,A,N),ce=U*ne;return{visibleArea:ce,isCompletelyWithinViewport:o.width*o.height===ce,fitsInViewportVertically:ne===o.height,fitsInViewportHorizontally:U==o.width}}_canFitWithFlexibleDimensions(n,e,r){if(this._hasFlexibleDimensions){const i=r.bottom-e.y,o=r.right-e.x,a=Kj(this._overlayRef.getConfig().minHeight),c=Kj(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=a&&a<=i)&&(n.fitsInViewportHorizontally||null!=c&&c<=o)}return!1}_pushOverlayOnScreen(n,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const i=Yj(e),o=this._viewportRect,a=Math.max(n.x+i.width-o.width,0),c=Math.max(n.y+i.height-o.height,0),f=Math.max(o.top-r.top-n.y,0),_=Math.max(o.left-r.left-n.x,0);let x=0,C=0;return x=i.width<=o.width?_||-a:n.x<this._getViewportMarginStart()?o.left-r.left-n.x:0,C=i.height<=o.height?f||-c:n.y<this._getViewportMarginTop()?o.top-r.top-n.y:0,this._previousPushAmount={x,y:C},{x:n.x+x,y:n.y+C}}_applyPosition(n,e){if(this._setTransformOrigin(n),this._setOverlayElementStyles(e,n),this._setBoundingBoxStyles(e,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._positionChanges.observers.length){const r=this._getScrollVisibility();if(n!==this._lastPosition||!this._lastScrollVisibility||!function hhe(t,n){return t===n||t.isOriginClipped===n.isOriginClipped&&t.isOriginOutsideView===n.isOriginOutsideView&&t.isOverlayClipped===n.isOverlayClipped&&t.isOverlayOutsideView===n.isOverlayOutsideView}(this._lastScrollVisibility,r)){const i=new ohe(n,r);this._positionChanges.next(i)}this._lastScrollVisibility=r}this._lastPosition=n,this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=n.overlayY;r="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let o=0;o<e.length;o++)e[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(n,e){const r=this._viewportRect,i=this._isRtl();let o,a,c;if("top"===e.overlayY)a=n.y,o=r.height-a+this._getViewportMarginBottom();else if("bottom"===e.overlayY)c=r.height-n.y+this._getViewportMarginTop()+this._getViewportMarginBottom(),o=r.height-c+this._getViewportMarginTop();else{const N=Math.min(r.bottom-n.y+r.top,n.y),U=this._lastBoundingBoxSize.height;o=2*N,a=n.y-N,o>U&&!this._isInitialRender&&!this._growAfterOpen&&(a=n.y-U/2)}const f="start"===e.overlayX&&!i||"end"===e.overlayX&&i;let x,C,A;if("end"===e.overlayX&&!i||"start"===e.overlayX&&i)A=r.width-n.x+this._getViewportMarginStart()+this._getViewportMarginEnd(),x=n.x-this._getViewportMarginStart();else if(f)C=n.x,x=r.right-n.x-this._getViewportMarginEnd();else{const N=Math.min(r.right-n.x+r.left,n.x),U=this._lastBoundingBoxSize.width;x=2*N,C=n.x-N,x>U&&!this._isInitialRender&&!this._growAfterOpen&&(C=n.x-U/2)}return{top:a,left:C,bottom:c,right:A,width:x,height:o}}_setBoundingBoxStyles(n,e){const r=this._calculateBoundingBoxRect(n,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right="auto",i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;i.width=Ko(r.width),i.height=Ko(r.height),i.top=Ko(r.top)||"auto",i.bottom=Ko(r.bottom)||"auto",i.left=Ko(r.left)||"auto",i.right=Ko(r.right)||"auto",i.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",i.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",o&&(i.maxHeight=Ko(o)),a&&(i.maxWidth=Ko(a))}this._lastBoundingBoxSize=r,ug(this._boundingBox.style,i)}_resetBoundingBoxStyles(){ug(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){ug(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,e){const r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(i){const x=this._viewportRuler.getViewportScrollPosition();ug(r,this._getExactOverlayY(e,n,x)),ug(r,this._getExactOverlayX(e,n,x))}else r.position="static";let c="",f=this._getOffset(e,"x"),_=this._getOffset(e,"y");f&&(c+=`translateX(${f}px) `),_&&(c+=`translateY(${_}px)`),r.transform=c.trim(),a.maxHeight&&(i?r.maxHeight=Ko(a.maxHeight):o&&(r.maxHeight="")),a.maxWidth&&(i?r.maxWidth=Ko(a.maxWidth):o&&(r.maxWidth="")),ug(this._pane.style,r)}_getExactOverlayY(n,e,r){let i={top:"",bottom:""},o=this._getOverlayPoint(e,this._overlayRect,n);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),"bottom"===n.overlayY?i.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":i.top=Ko(o.y),i}_getExactOverlayX(n,e,r){let a,i={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,n);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),a=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===a?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=Ko(o.x),i}_getScrollVisibility(){const n=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:jj(n,r),isOriginOutsideView:hM(n,r),isOverlayClipped:jj(e,r),isOverlayOutsideView:hM(e,r)}}_subtractOverflows(n,...e){return e.reduce((r,i)=>r-Math.max(i,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._getViewportMarginTop(),left:r.left+this._getViewportMarginStart(),right:r.left+n-this._getViewportMarginEnd(),bottom:r.top+e-this._getViewportMarginBottom(),width:n-this._getViewportMarginStart()-this._getViewportMarginEnd(),height:e-this._getViewportMarginTop()-this._getViewportMarginBottom()}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,e){return"x"===e?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&c0(n).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getViewportMarginStart(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.start??0}_getViewportMarginEnd(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.end??0}_getViewportMarginTop(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.top??0}_getViewportMarginBottom(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.bottom??0}_getOriginRect(){const n=this._origin;if(n instanceof Ur)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const e=n.width||0,r=n.height||0;return{top:n.y,bottom:n.y+r,left:n.x,right:n.x+e,height:r,width:e}}_getContainerRect(){const n=this._overlayRef.getConfig().usePopover&&"global"!==this._popoverLocation,e=this._overlayContainer.getContainerElement();n&&(e.style.display="block");const r=e.getBoundingClientRect();return n&&(e.style.display=""),r}}function ug(t,n){for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function Kj(t){if("number"!=typeof t&&null!=t){const[n,e]=t.split(che);return e&&"px"!==e?null:parseFloat(n)}return t||null}function Yj(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}const Xj="cdk-global-overlay-wrapper";function xC(t){return new fhe}class fhe{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(n){const e=n.getConfig();this._overlayRef=n,this._width&&!e.width&&n.updateSize({width:this._width}),this._height&&!e.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(Xj),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:a,maxHeight:c}=r,f=!("100%"!==i&&"100vw"!==i||a&&"100%"!==a&&"100vw"!==a),_=!("100%"!==o&&"100vh"!==o||c&&"100%"!==c&&"100vh"!==c),x=this._xPosition,C=this._xOffset,A="rtl"===this._overlayRef.getConfig().direction;let N="",U="",ne="";f?ne="flex-start":"center"===x?(ne="center",A?U=C:N=C):A?"left"===x||"end"===x?(ne="flex-end",N=C):("right"===x||"start"===x)&&(ne="flex-start",U=C):"left"===x||"start"===x?(ne="flex-start",N=C):("right"===x||"end"===x)&&(ne="flex-end",U=C),n.position=this._cssPosition,n.marginLeft=f?"0":N,n.marginTop=_?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=f?"0":U,e.justifyContent=ne,e.alignItems=_?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(Xj),r.justifyContent=r.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let phe=(()=>{class t{_injector=Q(An);constructor(){}global(){return xC()}flexibleConnectedTo(e){return function uhe(t,n){return new dhe(n,t.get(yy),t.get(Wn),t.get(Bl),t.get(pM))}(this._injector,e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const mhe=new Ue("OVERLAY_DEFAULT_CONFIG");function gM(t,n){t.get(my).load(Gj);const e=t.get(pM),r=t.get(Wn),i=t.get(vu),o=t.get(tl),a=t.get(_y),c=t.get(Xa,null,{optional:!0})||t.get(Rl).createRenderer(null,null),f=new fM(n),_=t.get(mhe,null,{optional:!0})?.usePopover??!0;f.direction=f.direction||a.value,f.usePopover="showPopover"in r.body&&(n?.usePopover??_);const x=r.createElement("div"),C=r.createElement("div");x.id=i.getId("cdk-overlay-"),x.classList.add("cdk-overlay-pane"),C.appendChild(x),f.usePopover&&(C.setAttribute("popover","manual"),C.classList.add("cdk-overlay-popover"));const A=f.usePopover?f.positionStrategy?.getPopoverInsertionPoint?.():null;return mM(A)?A.after(C):"parent"===A?.type?A.element.appendChild(C):e.getContainerElement().appendChild(C),new Wj(new Ode(x,o,t),C,x,f,t.get(sn),t.get(she),r,t.get(oy),t.get(ahe),n?.disableAnimations??"NoopAnimations"===t.get(_a,null,{optional:!0}),t.get($r),c)}let ghe=(()=>{class t{scrollStrategies=Q(ihe);_positionBuilder=Q(phe);_injector=Q(An);constructor(){}create(e){return gM(this._injector,e)}position(){return this._positionBuilder}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_M=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[ghe],imports:[ag,h0,Uj,Uj]})}return t})();function _he(t,n){if(1&t){const e=Ut();O(0,"div",1)(1,"button",2),Pe("click",function(){return Me(e),Oe(ge().action())}),q(2),V()()}if(2&t){const e=ge();Y(2),_r(" ",e.data.action," ")}}const yhe=["label"];function vhe(t,n){}const bhe=Math.pow(2,31)-1;class yM{_overlayRef;instance;containerInstance;_afterDismissed=new ee;_afterOpened=new ee;_onAction=new ee;_durationTimeoutId;_dismissedByAction=!1;constructor(n,e){this._overlayRef=e,this.containerInstance=n,n._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(n){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(n,bhe))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const Qj=new Ue("MatSnackBarData");class EC{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"}let Jj=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return t})(),e6=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return t})(),t6=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return t})(),n6=(()=>{class t{snackBarRef=Q(yM);data=Q(Qj);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0),q(1),V(),ot(2,_he,3,1,"div",1)),2&r&&(Y(),_r(" ",i.data.message,"\n"),Y(),st(i.hasAction?2:-1))},dependencies:[sde,Jj,e6,t6],styles:[".mat-mdc-simple-snack-bar{display:flex}.mat-mdc-simple-snack-bar .mat-mdc-snack-bar-label{max-height:50vh;overflow:auto}\n"],encapsulation:2,changeDetection:0})}return t})();const vM="_mat-snack-bar-enter",bM="_mat-snack-bar-exit";let r6=(()=>{class t extends _C{_ngZone=Q(sn);_elementRef=Q(Ur);_changeDetectorRef=Q(Mh);_platform=Q(Bl);_animationsDisabled=gy();snackBarConfig=Q(EC);_document=Q(Wn);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=Q(An);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new ee;_onExit=new ee;_onEnter=new ee;_animationState="void";_live;_label;_role;_liveElementId=Q(vu).getId("mat-snack-bar-container-live-");constructor(){super();const e=this.snackBarConfig;this._live="assertive"!==e.politeness||e.announcementMessage?"off"===e.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),r}attachTemplatePortal(e){this._assertNotAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),r}attachDomPortal=e=>{this._assertNotAttached();const r=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),r};onAnimationEnd(e){e===bM?this._completeExit():e===vM&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?hu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(vM)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(vM)},200)))}exit(){return this._destroyed?Fn(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?hu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(bM)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(bM),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){const e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(a=>e.classList.add(a)):e.classList.add(r)),this._exposeToModals();const i=this._label.nativeElement,o="mdc-snackbar__label";i.classList.toggle(o,!i.querySelector(`.${o}`))}_exposeToModals(){const e=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");this._trackedModals.add(o),a?-1===a.indexOf(e)&&o.setAttribute("aria-owns",a+" "+e):o.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{const r=e.getAttribute("aria-owns");if(r){const i=r.replace(this._liveElementId,"").trim();i.length>0?e.setAttribute("aria-owns",i):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;const e=this._elementRef.nativeElement,r=e.querySelector("[aria-hidden]"),i=e.querySelector("[aria-live]");if(r&&i){let o=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&r.contains(document.activeElement)&&(o=document.activeElement),r.removeAttribute("aria-hidden"),i.appendChild(r),o?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,i){if(1&r&&dp(d0,7)(yhe,7),2&r){let o;gd(o=_d())&&(i._portalOutlet=o.first),gd(o=_d())&&(i._label=o.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(r,i){1&r&&Pe("animationend",function(a){return i.onAnimationEnd(a.animationName)})("animationcancel",function(a){return i.onAnimationEnd(a.animationName)}),2&r&&js("mat-snack-bar-container-enter","visible"===i._animationState)("mat-snack-bar-container-exit","hidden"===i._animationState)("mat-snack-bar-container-animations-enabled",!i._animationsDisabled)},features:[Yn],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(O(0,"div",1)(1,"div",2,0)(3,"div",3),ob(4,vhe,0,0,"ng-template",4),V(),ut(5,"div"),V()()),2&r&&(Y(5),na("aria-live",i._live)("role",i._role)("id",i._liveElementId))},dependencies:[d0],styles:["@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}\n"],encapsulation:2})}return t})();const whe=new Ue("mat-snack-bar-default-options",{providedIn:"root",factory:()=>new EC});let xp=(()=>{class t{_live=Q(Mde);_injector=Q(An);_breakpointObserver=Q(vj);_parentSnackBar=Q(t,{optional:!0,skipSelf:!0});_defaultConfig=Q(whe);_animationsDisabled=gy();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=n6;snackBarContainerComponent=r6;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",i){const o={...this._defaultConfig,...i};return o.data={message:e,action:r},o.announcementMessage===e&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){const o=An.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:EC,useValue:r}]}),a=new u0(this.snackBarContainerComponent,r.viewContainerRef,o),c=e.attach(a);return c.instance.snackBarConfig=r,c.instance}_attach(e,r){const i={...new EC,...this._defaultConfig,...r},o=this._createOverlay(i),a=this._attachSnackBarContainer(o,i),c=new yM(a,o);if(e instanceof Ml){const f=new aM(e,null,{$implicit:i.data,snackBarRef:c});c.instance=a.attachTemplatePortal(f)}else{const f=this._createInjector(i,c),_=new u0(e,void 0,f),x=a.attachComponentPortal(_);c.instance=x.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(vd(o.detachments())).subscribe(f=>{o.overlayElement.classList.toggle(this.handsetCssClass,f.matches)}),i.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(c,i),this._openedSnackBarRef=c,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){const r=new fM;r.direction=e.direction;const i=xC(),o="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!o||"end"===e.horizontalPosition&&o,c=!a&&"center"!==e.horizontalPosition;return a?i.left("0"):c?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),r.positionStrategy=i,r.disableAnimations=this._animationsDisabled,gM(this._injector,r)}_createInjector(e,r){return An.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:yM,useValue:r},{provide:Qj,useValue:e.data}]})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xhe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[xp],imports:[_M,h0,cde,n6,ag]})}return t})();function i6(t,...n){return n.length?n.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function Ehe(t,n){}class m0{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;disableAnimations=!1;providers;container;templateContext}let o6=(()=>{class t extends _C{_elementRef=Q(Ur);_focusTrapFactory=Q(Sde);_config;_interactivityChecker=Q(kj);_ngZone=Q(sn);_focusMonitor=Q(mj);_renderer=Q(Xa);_changeDetectorRef=Q(Mh);_injector=Q(An);_platform=Q(Bl);_document=Q(Wn);_portalOutlet;_focusTrapped=new ee;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_isDestroyed=!1;constructor(){super(),this._config=Q(m0,{optional:!0})||new m0,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(e){this._ariaLabelledByQueue.push(e),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(e){const r=this._ariaLabelledByQueue.indexOf(e);r>-1&&(this._ariaLabelledByQueue.splice(r,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._focusTrapped.complete(),this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),r}attachTemplatePortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),r}attachDomPortal=e=>{this._portalOutlet.hasAttached();const r=this._portalOutlet.attachDomPortal(e);return this._contentAttached(),r};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const i=()=>{o(),a(),e.removeAttribute("tabindex")},o=this._renderer.listen(e,"blur",i),a=this._renderer.listen(e,"mousedown",i)})),e.focus(r)}_focusByCssSelector(e,r){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,r)}_trapFocus(e){this._isDestroyed||hu(()=>{const r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus(e);break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement(e)||this._focusDialogContainer(e);break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]',e);break;default:this._focusByCssSelector(this._config.autoFocus,e)}this._focusTrapped.next()},{injector:this._injector})}_restoreFocus(){const e=this._config.restoreFocus;let r=null;if("string"==typeof e?r=this._document.querySelector(e):"boolean"==typeof e?r=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(r=e),this._config.restoreFocus&&r&&"function"==typeof r.focus){const i=ZA(),o=this._elementRef.nativeElement;(!i||i===this._document.body||i===o||o.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(e){this._elementRef.nativeElement.focus?.(e)}_containsFocus(){const e=this._elementRef.nativeElement,r=ZA();return e===r||e.contains(r)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=ZA()))}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["cdk-dialog-container"]],viewQuery:function(r,i){if(1&r&&dp(d0,7),2&r){let o;gd(o=_d())&&(i._portalOutlet=o.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,i){2&r&&na("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[Yn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,i){1&r&&ob(0,Ehe,0,0,"ng-template",0)},dependencies:[d0],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}\n"],encapsulation:2})}return t})();class wM{overlayRef;config;componentInstance=null;componentRef=null;containerInstance;disableClose;closed=new ee;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(n,e){this.overlayRef=n,this.config=e,this.disableClose=e.disableClose,this.backdropClick=n.backdropClick(),this.keydownEvents=n.keydownEvents(),this.outsidePointerEvents=n.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!i6(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{!this.disableClose&&this._canClose()?this.close(void 0,{focusOrigin:"mouse"}):this.containerInstance._recaptureFocus?.()}),this._detachSubscription=n.detachments().subscribe(()=>{!1!==e.closeOnOverlayDetachments&&this.close()})}close(n,e){if(this._canClose(n)){const r=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(n),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(n="",e=""){return this.overlayRef.updateSize({width:n,height:e}),this}addPanelClass(n){return this.overlayRef.addPanelClass(n),this}removePanelClass(n){return this.overlayRef.removePanelClass(n),this}_canClose(n){const e=this.config;return!!this.containerInstance&&(!e.closePredicate||e.closePredicate(n,e,this.componentInstance))}}const Che=new Ue("DialogScrollStrategy",{providedIn:"root",factory:()=>{const t=Q(An);return()=>uM(t)}}),Dhe=new Ue("DialogData"),The=new Ue("DefaultDialogConfig");function She(t){const n=Pi(t),e=new Zn;return{valueSignal:n,get value(){return n()},change:e,ngOnDestroy(){e.complete()}}}let s6=(()=>{class t{_injector=Q(An);_defaultOptions=Q(The,{optional:!0});_parentDialog=Q(t,{optional:!0,skipSelf:!0});_overlayContainer=Q(pM);_idGenerator=Q(vu);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new ee;_afterOpenedAtThisLevel=new ee;_ariaHiddenElements=new Map;_scrollStrategy=Q(Che);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=Bb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ly(void 0)));constructor(){}open(e,r){(r={...this._defaultOptions||new m0,...r}).id=r.id||this._idGenerator.getId("cdk-dialog-"),r.id&&this.getDialogById(r.id);const o=this._getOverlayConfig(r),a=gM(this._injector,o),c=new wM(a,r),f=this._attachContainer(a,c,r);if(c.containerInstance=f,!this.openDialogs.length){const _=this._overlayContainer.getContainerElement();f._focusTrapped?f._focusTrapped.pipe(Hs(1)).subscribe(()=>{this._hideNonDialogContentFromAssistiveTechnology(_)}):this._hideNonDialogContentFromAssistiveTechnology(_)}return this._attachDialogContent(e,c,f,r),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){xM(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){xM(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),xM(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const r=new fM({positionStrategy:e.positionStrategy||xC().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation,disableAnimations:e.disableAnimations});return e.backdropClass&&(r.backdropClass=e.backdropClass),r}_attachContainer(e,r,i){const o=i.injector||i.viewContainerRef?.injector,a=[{provide:m0,useValue:i},{provide:wM,useValue:r},{provide:Wj,useValue:e}];let c;i.container?"function"==typeof i.container?c=i.container:(c=i.container.type,a.push(...i.container.providers(i))):c=o6;const f=new u0(c,i.viewContainerRef,An.create({parent:o||this._injector,providers:a}));return e.attach(f).instance}_attachDialogContent(e,r,i,o){if(e instanceof Ml){const a=this._createInjector(o,r,i,void 0);let c={$implicit:o.data,dialogRef:r};o.templateContext&&(c={...c,..."function"==typeof o.templateContext?o.templateContext():o.templateContext}),i.attachTemplatePortal(new aM(e,null,c,a))}else{const a=this._createInjector(o,r,i,this._injector),c=i.attachComponentPortal(new u0(e,o.viewContainerRef,a));r.componentRef=c,r.componentInstance=c.instance}}_createInjector(e,r,i,o){const a=e.injector||e.viewContainerRef?.injector,c=[{provide:Dhe,useValue:e.data},{provide:wM,useValue:r}];return e.providers&&("function"==typeof e.providers?c.push(...e.providers(r,e,i)):c.push(...e.providers)),e.direction&&(!a||!a.get(_y,null,{optional:!0}))&&c.push({provide:_y,useValue:She(e.direction)}),An.create({parent:a||o,providers:c})}_removeOpenDialog(e,r){const i=this.openDialogs.indexOf(e);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((o,a)=>{o?a.setAttribute("aria-hidden",o):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(e){if(e.parentElement){const r=e.parentElement.children;for(let i=r.length-1;i>-1;i--){const o=r[i];o!==e&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&!o.hasAttribute("popover")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function xM(t,n){let e=t.length;for(;e--;)n(t[e])}let Ihe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[s6],imports:[_M,h0,Pde,h0]})}return t})();class a6 extends ee{constructor(n=1/0,e=1/0,r=JA){super(),this._bufferSize=n,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,e)}next(n){const{isStopped:e,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:a}=this;e||(r.push(n),!i&&r.push(o.now()+a)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(n),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let a=0;a<o.length&&!n.closed;a+=r?1:2)n.next(o[a]);return this._checkFinalizedStatuses(n),e}_trimBuffer(){const{_bufferSize:n,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*n;if(n<1/0&&o<r.length&&r.splice(0,r.length-o),!i){const a=e.now();let c=0;for(let f=1;f<r.length&&r[f]<=a;f+=2)c=f;c&&r.splice(0,c+1)}}}function CC(...t){const n=Lb(t),e=function lae(t,n){return"number"==typeof aA(t)?t.pop():n}(t,1/0),r=t;return r.length?1===r.length?kc(r[0]):ay(e)(xs(r,n)):xa}function khe(t,n){}class l6{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;enterAnimationDuration;exitAnimationDuration}const EM="mdc-dialog--open",c6="mdc-dialog--opening",u6="mdc-dialog--closing";let d6=(()=>{class t extends o6{_animationStateChanged=new Zn;_animationsEnabled=!gy();_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?f6(this._config.enterAnimationDuration)??150:0;_exitAnimationDuration=this._animationsEnabled?f6(this._config.exitAnimationDuration)??75:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(h6,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(c6,EM)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(EM),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(EM),this._animationsEnabled?(this._hostElement.style.setProperty(h6,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(u6)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(e){this._actionSectionCount+=e,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(c6,u6)}_waitForAnimationToComplete(e,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(e):e()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(e){const r=super.attachComponentPortal(e);return r.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),r}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275cmp=gr({type:t,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(r,i){2&r&&(fb("id",i._config.id),na("aria-modal",i._config.ariaModal)("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),js("_mat-animation-noopable",!i._animationsEnabled)("mat-mdc-dialog-container-with-actions",i._actionSectionCount>0))},features:[Yn],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1),ob(2,khe,0,0,"ng-template",2),V()())},dependencies:[d0],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mat-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mat-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mat-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mat-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mat-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mat-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mat-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mat-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mat-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mat-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mat-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mat-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mat-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;box-sizing:border-box;min-height:52px;margin:0;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}\n'],encapsulation:2})}return t})();const h6="--mat-dialog-transition-duration";function f6(t){return null==t?null:"number"==typeof t?t:t.endsWith("ms")?lC(t.substring(0,t.length-2)):t.endsWith("s")?1e3*lC(t.substring(0,t.length-1)):"0"===t?0:null}var DC=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(DC||{});class dg{_ref;_config;_containerInstance;componentInstance;componentRef=null;disableClose;id;_afterOpened=new a6(1);_beforeClosed=new a6(1);_result;_closeFallbackTimeout;_state=DC.OPEN;_closeInteractionType;constructor(n,e,r){this._ref=n,this._config=e,this._containerInstance=r,this.disableClose=e.disableClose,this.id=n.id,n.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(Es(i=>"opened"===i.state),Hs(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(Es(i=>"closed"===i.state),Hs(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),n.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),CC(this.backdropClick(),this.keydownEvents().pipe(Es(i=>27===i.keyCode&&!this.disableClose&&!i6(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),function p6(t,n,e){return t._closeInteractionType=n,t.close(e)}(this,"keydown"===i.type?"keyboard":"mouse"))})}close(n){const e=this._config.closePredicate;e&&!e(n,this._config,this.componentInstance)||(this._result=n,this._containerInstance._animationStateChanged.pipe(Es(r=>"closing"===r.state),Hs(1)).subscribe(r=>{this._beforeClosed.next(n),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),r.totalTime+100)}),this._state=DC.CLOSING,this._containerInstance._startExitAnimation())}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(n){let e=this._ref.config.positionStrategy;return n&&(n.left||n.right)?n.left?e.left(n.left):e.right(n.right):e.centerHorizontally(),n&&(n.top||n.bottom)?n.top?e.top(n.top):e.bottom(n.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(n="",e=""){return this._ref.updateSize(n,e),this}addPanelClass(n){return this._ref.addPanelClass(n),this}removePanelClass(n){return this._ref.removePanelClass(n),this}getState(){return this._state}_finishDialogClose(){this._state=DC.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const TC=new Ue("MatMdcDialogData"),Rhe=new Ue("mat-mdc-dialog-default-options"),Phe=new Ue("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const t=Q(An);return()=>uM(t)}});let hg=(()=>{class t{_defaultOptions=Q(Rhe,{optional:!0});_scrollStrategy=Q(Phe);_parentDialog=Q(t,{optional:!0,skipSelf:!0});_idGenerator=Q(vu);_injector=Q(An);_dialog=Q(s6);_animationsDisabled=gy();_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new ee;_afterOpenedAtThisLevel=new ee;dialogConfigClass=l6;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=Bb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(ly(void 0)));constructor(){this._dialogRefConstructor=dg,this._dialogContainerType=d6,this._dialogDataToken=TC}open(e,r){let i;(r={...this._defaultOptions||new l6,...r}).id=r.id||this._idGenerator.getId("mat-mdc-dialog-"),r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const o=this._dialog.open(e,{...r,positionStrategy:xC().centerHorizontally().centerVertically(),disableClose:!0,closePredicate:void 0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,disableAnimations:this._animationsDisabled||"0"===r.enterAnimationDuration?.toLocaleString()||"0"===r.exitAnimationDuration?.toString(),container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:m0,useValue:r}]},templateContext:()=>({dialogRef:i}),providers:(a,c,f)=>(i=new this._dialogRefConstructor(a,r,f),i.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:f},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:i}])});return i.componentRef=o.componentRef,i.componentInstance=o.componentInstance,this.openDialogs.push(i),this.afterOpened.next(i),i.afterClosed().subscribe(()=>{const a=this.openDialogs.indexOf(i);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let r=e.length;for(;r--;)e[r].close()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_6=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[hg],imports:[Ihe,_M,h0,ag]})}return t})();const Ep=new H(Na),CM="Service workers are disabled or not supported by this browser";class SC{serviceWorker;worker;registration;events;constructor(n,e){if(this.serviceWorker=n,n){let r=null;const i=new ee;this.worker=new H(_=>(null!==r&&_.next(r),i.subscribe(x=>_.next(x))));const o=()=>{const{controller:_}=n;null!==_&&(r=_,i.next(r))};n.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(il(()=>n.getRegistration().then(_=>{if(!_)throw new ue(5601,!1);return _})));const a=new ee;this.events=a.asObservable();const c=_=>{const{data:x}=_;x?.type&&a.next(x)};n.addEventListener("message",c),e?.get(tl,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",o),n.removeEventListener("message",c)})}else this.worker=this.events=this.registration=new H(r=>r.error(new ue(5601,!1)))}postMessage(n,e){return new Promise(r=>{this.worker.pipe(Hs(1)).subscribe(i=>{i.postMessage({action:n,...e}),r()})})}postMessageWithOperation(n,e,r){const i=this.waitForOperationCompleted(r),o=this.postMessage(n,e);return Promise.all([o,i]).then(([,a])=>a)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?r=>r.type===n:r=>n.includes(r.type),this.events.pipe(Es(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(Hs(1))}waitForOperationCompleted(n){return new Promise((e,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(Es(i=>i.nonce===n),Hs(1),mr(i=>{if(void 0!==i.result)return i.result;throw new Error(i.error)})).subscribe({next:e,error:r})})}get isEnabled(){return!!this.serviceWorker}}let y6=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new ee;constructor(e){if(this.sw=e,!e.isEnabled)return this.messages=Ep,this.notificationClicks=Ep,this.notificationCloses=Ep,this.pushSubscriptionChanges=Ep,void(this.subscription=Ep);this.messages=this.sw.eventsOfType("PUSH").pipe(mr(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(mr(i=>i.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(mr(i=>i.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(mr(i=>i.data)),this.pushManager=this.sw.registration.pipe(mr(i=>i.pushManager));const r=this.pushManager.pipe(il(i=>i.getSubscription()));this.subscription=new H(i=>{const o=r.subscribe(i),a=this.subscriptionChanges.subscribe(i);return()=>{o.unsubscribe(),a.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(CM));const r={userVisibleOnly:!0};let i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return r.applicationServerKey=o,new Promise((a,c)=>{this.pushManager.pipe(il(f=>f.subscribe(r)),Hs(1)).subscribe({next:f=>{this.subscriptionChanges.next(f),a(f)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(CM));const e=r=>{if(null===r)throw new ue(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new ue(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(Hs(1),il(e)).subscribe({next:r,error:i})})}decodeBase64(e){return atob(e)}static \u0275fac=function(r){return new(r||t)(Tt(SC))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})(),DM=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=Ep,void(this.unrecoverable=Ep);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(CM));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;const e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new ue(5601,!1));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(r){return new(r||t)(Tt(SC))};static \u0275prov=$e({token:t,factory:t.\u0275fac})}return t})();const v6=new Ue("");function Bhe(){const t=Q(TM);if(!("serviceWorker"in navigator)||!1===t.enabled)return;const n=Q(v6),e=Q(sn),r=Q(tl);e.runOutsideAngular(()=>{const i=navigator.serviceWorker,o=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",o),r.onDestroy(()=>{i.removeEventListener("controllerchange",o)})}),e.runOutsideAngular(()=>{let i;const{registrationStrategy:o}=t;if("function"==typeof o)i=new Promise(a=>o().subscribe(()=>a()));else{const[a,...c]=(o||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=b6(+c[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),b6(+c[0])]);break;default:throw new ue(5600,!1)}}i.then(()=>{r.destroyed||navigator.serviceWorker.register(n,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(a=>console.error(Ht(5604,!1)))})})}function b6(t){return new Promise(n=>setTimeout(n,t))}function Vhe(){const t=Q(TM),n=Q(An);return new SC(!1!==t.enabled?navigator.serviceWorker:void 0,n)}class TM{enabled;updateViaCache;type;scope;registrationStrategy}function Uhe(t,n={}){return Ha([y6,DM,{provide:v6,useValue:t},{provide:TM,useValue:n},{provide:SC,useFactory:Vhe},aI(Bhe)])}let zhe=(()=>{class t{static register(e,r={}){return{ngModule:t,providers:[Uhe(e,r)]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[y6,DM]})}return t})();const dt=function(t,n){if(!t)throw vy(n)},vy=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},w6=function(t){const n=[];let e=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?n[e++]=i:i<2048?(n[e++]=i>>6|192,n[e++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),n[e++]=i>>18|240,n[e++]=i>>12&63|128,n[e++]=i>>6&63|128,n[e++]=63&i|128):(n[e++]=i>>12|224,n[e++]=i>>6&63|128,n[e++]=63&i|128)}return n},IM={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,n){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,f=i+2<t.length,_=f?t[i+2]:0;let A=(15&c)<<2|_>>6,N=63&_;f||(N=64,a||(A=64)),r.push(e[o>>2],e[(3&o)<<4|c>>4],e[A],e[N])}return r.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(w6(t),n)},decodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(t):function(t){const n=[];let e=0,r=0;for(;e<t.length;){const i=t[e++];if(i<128)n[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[e++];n[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const f=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536;n[r++]=String.fromCharCode(55296+(f>>10)),n[r++]=String.fromCharCode(56320+(1023&f))}else{const o=t[e++],a=t[e++];n[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return n.join("")}(this.decodeStringToByteArray(t,n))},decodeStringToByteArray(t,n){this.init_();const e=n?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=e[t.charAt(i++)],c=i<t.length?e[t.charAt(i)]:0;++i;const _=i<t.length?e[t.charAt(i)]:64;++i;const C=i<t.length?e[t.charAt(i)]:64;if(++i,null==o||null==c||null==_||null==C)throw new Hhe;r.push(o<<2|c>>4),64!==_&&(r.push(c<<4&240|_>>2),64!==C&&r.push(_<<6&192|C))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Hhe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const x6=function(t){const n=w6(t);return IM.encodeByteArray(n,!0)},IC=function(t){return x6(t).replace(/\./g,"")},kC=function(t){try{return IM.decodeString(t,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};function $he(t){return E6(void 0,t)}function E6(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(const e in n)!n.hasOwnProperty(e)||!qhe(e)||(t[e]=E6(t[e],n[e]));return t}function qhe(t){return"__proto__"!==t}const AC=()=>{try{return function Ghe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const n=t&&kC(t[1]);return n&&JSON.parse(n)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},C6=t=>{var n,e;return null===(e=null===(n=AC())||void 0===n?void 0:n.emulatorHosts)||void 0===e?void 0:e[t]},D6=t=>{const n=C6(t);if(!n)return;const e=n.lastIndexOf(":");if(e<=0||e+1===n.length)throw new Error(`Invalid host ${n} with no separate hostname and port!`);const r=parseInt(n.substring(e+1),10);return"["===n[0]?[n.substring(1,e-1),r]:[n.substring(0,e),r]},T6=()=>{var t;return null===(t=AC())||void 0===t?void 0:t.config},S6=t=>{var n;return null===(n=AC())||void 0===n?void 0:n[`_${t}`]};class by{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e})}wrapCallback(n){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof n&&(this.promise.catch(()=>{}),1===n.length?n(e):n(e,r))}}}function I6(t,n){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=n||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[IC(JSON.stringify({alg:"none",type:"JWT"})),IC(JSON.stringify(a)),""].join(".")}function qs(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function kM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qs())}function k6(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class zh extends Error{constructor(n,e,r){super(e),this.code=n,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,zh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,g0.prototype.create)}}class g0{constructor(n,e,r){this.service=n,this.serviceName=e,this.errors=r}create(n,...e){const r=e[0]||{},i=`${this.service}/${n}`,o=this.errors[n],a=o?function ife(t,n){return t.replace(ofe,(e,r)=>{const i=n[r];return null!=i?String(i):`<${r}?>`})}(o,r):"Error";return new zh(i,`${this.serviceName}: ${a} (${i}).`,r)}}const ofe=/\{\$([^}]+)}/g;function _0(t){return JSON.parse(t)}function os(t){return JSON.stringify(t)}const MC=function(t){let n={},e={},r={},i="";try{const o=t.split(".");n=_0(kC(o[0])||""),e=_0(kC(o[1])||""),i=o[2],r=e.d||{},delete e.d}catch{}return{header:n,claims:e,data:r,signature:i}};function Cd(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function wy(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]}function AM(t){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n))return!1;return!0}function RC(t,n,e){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=n.call(e,t[i],i,t));return r}function PC(t,n){if(t===n)return!0;const e=Object.keys(t),r=Object.keys(n);for(const i of e){if(!r.includes(i))return!1;const o=t[i],a=n[i];if(A6(o)&&A6(a)){if(!PC(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!e.includes(i))return!1;return!0}function A6(t){return null!==t&&"object"==typeof t}function xy(t){const n=[];for(const[e,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{n.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):n.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return n.length?"&"+n.join("&"):""}class lfe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(n,e){e||(e=0);const r=this.W_;if("string"==typeof n)for(let C=0;C<16;C++)r[C]=n.charCodeAt(e)<<24|n.charCodeAt(e+1)<<16|n.charCodeAt(e+2)<<8|n.charCodeAt(e+3),e+=4;else for(let C=0;C<16;C++)r[C]=n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3],e+=4;for(let C=16;C<80;C++){const A=r[C-3]^r[C-8]^r[C-14]^r[C-16];r[C]=4294967295&(A<<1|A>>>31)}let _,x,i=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],f=this.chain_[4];for(let C=0;C<80;C++){C<40?C<20?(_=c^o&(a^c),x=1518500249):(_=o^a^c,x=1859775393):C<60?(_=o&a|c&(o|a),x=2400959708):(_=o^a^c,x=3395469782);const A=(i<<5|i>>>27)+_+f+x+r[C]&4294967295;f=c,c=a,a=4294967295&(o<<30|o>>>2),o=i,i=A}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295}update(n,e){if(null==n)return;void 0===e&&(e=n.length);const r=e-this.blockSize;let i=0;const o=this.buf_;let a=this.inbuf_;for(;i<e;){if(0===a)for(;i<=r;)this.compress_(n,i),i+=this.blockSize;if("string"==typeof n){for(;i<e;)if(o[a]=n.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}else for(;i<e;)if(o[a]=n[i],++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=e}digest(){const n=[];let e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)n[r]=this.chain_[i]>>o&255,++r;return n}}class ufe{constructor(n,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{n(this)}).catch(r=>{this.error(r)})}next(n){this.forEachObserver(e=>{e.next(n)})}error(n){this.forEachObserver(e=>{e.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,e,r){let i;if(void 0===n&&void 0===e&&void 0===r)throw new Error("Missing Observer.");i=function dfe(t,n){if("object"!=typeof t||null===t)return!1;for(const e of n)if(e in t&&"function"==typeof t[e])return!0;return!1}(n,["next","error","complete"])?n:{next:n,error:e,complete:r},void 0===i.next&&(i.next=MM),void 0===i.error&&(i.error=MM),void 0===i.complete&&(i.complete=MM);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(n){void 0===this.observers||void 0===this.observers[n]||(delete this.observers[n],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,n)}sendOne(n,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[n])try{e(this.observers[n])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(n){this.finalized||(this.finalized=!0,void 0!==n&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function MM(){}function fg(t,n){return`${t} failed: ${n} argument `}const NC=function(t){let n=0;for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);r<128?n++:r<2048?n+=2:r>=55296&&r<=56319?(n+=4,e++):n+=3}return n};function Po(t){return t&&t._delegate?t._delegate:t}class Cp{constructor(n,e,r){this.name=n,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}const pg="[DEFAULT]";class yfe{constructor(n,e){this.name=n,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const e=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(e)){const r=new by;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(n){var e;const r=this.normalizeInstanceIdentifier(n?.identifier),i=null!==(e=n?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,this.shouldAutoInitialize()){if(function bfe(t){return"EAGER"===t.instantiationMode}(n))try{this.getOrInitializeService({instanceIdentifier:pg})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(n=pg){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}delete(){var n=this;return fe(function*(){const e=Array.from(n.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(n=pg){return this.instances.has(n)}getOptions(n=pg){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:e={}}=n,r=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[o,a]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(o)&&a.resolve(i);return i}onInit(n,e){var r;const i=this.normalizeInstanceIdentifier(e),o=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;o.add(n),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&n(a,i),()=>{o.delete(n)}}invokeOnInitCallbacks(n,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(n,e)}catch{}}getOrInitializeService({instanceIdentifier:n,options:e={}}){let r=this.instances.get(n);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===pg?void 0:t),options:e}),this.instances.set(n,r),this.instancesOptions.set(n,e),this.invokeOnInitCallbacks(r,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,r)}catch{}var t;return r||null}normalizeInstanceIdentifier(n=pg){return this.component?this.component.multipleInstances?n:pg:n}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class wfe{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const e=this.getProvider(n.name);if(e.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);e.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const e=new yfe(n,this);return this.providers.set(n,e),e}getProviders(){return Array.from(this.providers.values())}}const RM=[];var Qr=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(Qr||{});const M6={debug:Qr.DEBUG,verbose:Qr.VERBOSE,info:Qr.INFO,warn:Qr.WARN,error:Qr.ERROR,silent:Qr.SILENT},xfe=Qr.INFO,Efe={[Qr.DEBUG]:"log",[Qr.VERBOSE]:"log",[Qr.INFO]:"info",[Qr.WARN]:"warn",[Qr.ERROR]:"error"},Cfe=(t,n,...e)=>{if(n<t.logLevel)return;const r=(new Date).toISOString(),i=Efe[n];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`);console[i](`[${r}]  ${t.name}:`,...e)};class PM{constructor(n){this.name=n,this._logLevel=xfe,this._logHandler=Cfe,this._userLogHandler=null,RM.push(this)}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in Qr))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel="string"==typeof n?M6[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if("function"!=typeof n)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,Qr.DEBUG,...n),this._logHandler(this,Qr.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,Qr.VERBOSE,...n),this._logHandler(this,Qr.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,Qr.INFO,...n),this._logHandler(this,Qr.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,Qr.WARN,...n),this._logHandler(this,Qr.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,Qr.ERROR,...n),this._logHandler(this,Qr.ERROR,...n)}}let R6,P6;const N6=new WeakMap,NM=new WeakMap,O6=new WeakMap,OM=new WeakMap,LM=new WeakMap;let FM={get(t,n,e){if(t instanceof IDBTransaction){if("done"===n)return NM.get(t);if("objectStoreNames"===n)return t.objectStoreNames||O6.get(t);if("store"===n)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Dp(t[n])},set:(t,n,e)=>(t[n]=e,!0),has:(t,n)=>t instanceof IDBTransaction&&("done"===n||"store"===n)||n in t};function Rfe(t){return"function"==typeof t?function Mfe(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Sfe(){return P6||(P6=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...n){return t.apply(BM(this),n),Dp(N6.get(this))}:function(...n){return Dp(t.apply(BM(this),n))}:function(n,...e){const r=t.call(BM(this),n,...e);return O6.set(r,n.sort?n.sort():[n]),Dp(r)}}(t):(t instanceof IDBTransaction&&function kfe(t){if(NM.has(t))return;const n=new Promise((e,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{e(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});NM.set(t,n)}(t),((t,n)=>n.some(e=>t instanceof e))(t,function Tfe(){return R6||(R6=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,FM):t)}function Dp(t){if(t instanceof IDBRequest)return function Ife(t){const n=new Promise((e,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{e(Dp(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return n.then(e=>{e instanceof IDBCursor&&N6.set(e,t)}).catch(()=>{}),LM.set(n,t),n}(t);if(OM.has(t))return OM.get(t);const n=Rfe(t);return n!==t&&(OM.set(t,n),LM.set(n,t)),n}const BM=t=>LM.get(t),Nfe=["get","getKey","getAll","getAllKeys","count"],Ofe=["put","add","delete","clear"],VM=new Map;function L6(t,n){if(!(t instanceof IDBDatabase)||n in t||"string"!=typeof n)return;if(VM.get(n))return VM.get(n);const e=n.replace(/FromIndex$/,""),r=n!==e,i=Ofe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Nfe.includes(e))return;const o=function(){var a=fe(function*(c,...f){const _=this.transaction(c,i?"readwrite":"readonly");let x=_.store;return r&&(x=x.index(f.shift())),(yield Promise.all([x[e](...f),i&&_.done]))[0]});return function(f){return a.apply(this,arguments)}}();return VM.set(n,o),o}!function Afe(t){FM=t(FM)}(t=>({...t,get:(n,e,r)=>L6(n,e)||t.get(n,e,r),has:(n,e)=>!!L6(n,e)||t.has(n,e)}));class Lfe{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Ffe(t){const n=t.getComponent();return"VERSION"===n?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const OC="@firebase/app",UM="0.10.13",jh=new PM("@firebase/app"),Bfe="@firebase/app-compat",Vfe="@firebase/analytics-compat",Ufe="@firebase/analytics",zfe="@firebase/app-check-compat",jfe="@firebase/app-check",Hfe="@firebase/auth",$fe="@firebase/auth-compat",qfe="@firebase/database",Gfe="@firebase/data-connect",Wfe="@firebase/database-compat",Zfe="@firebase/functions",Kfe="@firebase/functions-compat",Yfe="@firebase/installations",Xfe="@firebase/installations-compat",Qfe="@firebase/messaging",Jfe="@firebase/messaging-compat",epe="@firebase/performance",tpe="@firebase/performance-compat",npe="@firebase/remote-config",rpe="@firebase/remote-config-compat",ipe="@firebase/storage",ope="@firebase/storage-compat",spe="@firebase/firestore",ape="@firebase/vertexai-preview",lpe="@firebase/firestore-compat",cpe="firebase",LC="[DEFAULT]",dpe={[OC]:"fire-core",[Bfe]:"fire-core-compat",[Ufe]:"fire-analytics",[Vfe]:"fire-analytics-compat",[jfe]:"fire-app-check",[zfe]:"fire-app-check-compat",[Hfe]:"fire-auth",[$fe]:"fire-auth-compat",[qfe]:"fire-rtdb",[Gfe]:"fire-data-connect",[Wfe]:"fire-rtdb-compat",[Zfe]:"fire-fn",[Kfe]:"fire-fn-compat",[Yfe]:"fire-iid",[Xfe]:"fire-iid-compat",[Qfe]:"fire-fcm",[Jfe]:"fire-fcm-compat",[epe]:"fire-perf",[tpe]:"fire-perf-compat",[npe]:"fire-rc",[rpe]:"fire-rc-compat",[ipe]:"fire-gcs",[ope]:"fire-gcs-compat",[spe]:"fire-fst",[lpe]:"fire-fst-compat",[ape]:"fire-vertex","fire-js":"fire-js",[cpe]:"fire-js-all"},mg=new Map,y0=new Map,v0=new Map;function F6(t,n){try{t.container.addComponent(n)}catch(e){jh.debug(`Component ${n.name} failed to register with FirebaseApp ${t.name}`,e)}}function gg(t){const n=t.name;if(v0.has(n))return jh.debug(`There were multiple attempts to register component ${n}.`),!1;v0.set(n,t);for(const e of mg.values())F6(e,t);for(const e of y0.values())F6(e,t);return!0}function b0(t,n){const e=t.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),t.container.getProvider(n)}function Hh(t){return void 0!==t.settings}const Pc=new g0("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class B6{constructor(n,e,r){this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw Pc.create("app-deleted",{appName:this._name})}}const _g="10.14.1";function V6(t,n={}){let e=t;"object"!=typeof n&&(n={name:n});const r=Object.assign({name:LC,automaticDataCollectionEnabled:!1},n),i=r.name;if("string"!=typeof i||!i)throw Pc.create("bad-app-name",{appName:String(i)});if(e||(e=T6()),!e)throw Pc.create("no-options");const o=mg.get(i);if(o){if(PC(e,o.options)&&PC(r,o.config))return o;throw Pc.create("duplicate-app",{appName:i})}const a=new wfe(i);for(const f of v0.values())a.addComponent(f);const c=new B6(e,r,a);return mg.set(i,c),c}function zM(t=LC){const n=mg.get(t);if(!n&&t===LC&&T6())return V6();if(!n)throw Pc.create("no-app",{appName:t});return n}function bu(t,n,e){var r;let i=null!==(r=dpe[t])&&void 0!==r?r:t;e&&(i+=`-${e}`);const o=i.match(/\s|\//),a=n.match(/\s|\//);if(o||a){const c=[`Unable to register library "${i}" with version "${n}":`];return o&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&c.push("and"),a&&c.push(`version name "${n}" contains illegal characters (whitespace or "/")`),void jh.warn(c.join(" "))}gg(new Cp(`${i}-version`,()=>({library:i,version:n}),"VERSION"))}const w0="firebase-heartbeat-store";let HM=null;function U6(){return HM||(HM=function Pfe(t,n,{blocked:e,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,n),c=Dp(a);return r&&a.addEventListener("upgradeneeded",f=>{r(Dp(a.result),f.oldVersion,f.newVersion,Dp(a.transaction),f)}),e&&a.addEventListener("blocked",f=>e(f.oldVersion,f.newVersion,f)),c.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",_=>i(_.oldVersion,_.newVersion,_))}).catch(()=>{}),c}("firebase-heartbeat-database",1,{upgrade:(t,n)=>{if(0===n)try{t.createObjectStore(w0)}catch(e){console.warn(e)}}}).catch(t=>{throw Pc.create("idb-open",{originalErrorMessage:t.message})})),HM}function $M(){return($M=fe(function*(t){try{const e=(yield U6()).transaction(w0),r=yield e.objectStore(w0).get(j6(t));return yield e.done,r}catch(n){if(n instanceof zh)jh.warn(n.message);else{const e=Pc.create("idb-get",{originalErrorMessage:n?.message});jh.warn(e.message)}}})).apply(this,arguments)}function z6(t,n){return qM.apply(this,arguments)}function qM(){return(qM=fe(function*(t,n){try{const r=(yield U6()).transaction(w0,"readwrite");yield r.objectStore(w0).put(n,j6(t)),yield r.done}catch(e){if(e instanceof zh)jh.warn(e.message);else{const r=Pc.create("idb-set",{originalErrorMessage:e?.message});jh.warn(r.message)}}})).apply(this,arguments)}function j6(t){return`${t.name}!${t.options.appId}`}class wpe{constructor(n){this.container=n,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Epe(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var n=this;return fe(function*(){var e,r;try{const o=n.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=H6();return null==(null===(e=n._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(n._heartbeatsCache=yield n._heartbeatsCachePromise,null==(null===(r=n._heartbeatsCache)||void 0===r?void 0:r.heartbeats))||n._heartbeatsCache.lastSentHeartbeatDate===a||n._heartbeatsCache.heartbeats.some(c=>c.date===a)?void 0:(n._heartbeatsCache.heartbeats.push({date:a,agent:o}),n._heartbeatsCache.heartbeats=n._heartbeatsCache.heartbeats.filter(c=>{const f=new Date(c.date).valueOf();return Date.now()-f<=2592e6}),n._storage.overwrite(n._heartbeatsCache))}catch(i){jh.warn(i)}})()}getHeartbeatsHeader(){var n=this;return fe(function*(){var e;try{if(null===n._heartbeatsCache&&(yield n._heartbeatsCachePromise),null==(null===(e=n._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===n._heartbeatsCache.heartbeats.length)return"";const r=H6(),{heartbeatsToSend:i,unsentEntries:o}=function xpe(t,n=1024){const e=[];let r=t.slice();for(const i of t){const o=e.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),$6(e)>n){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),$6(e)>n){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(n._heartbeatsCache.heartbeats),a=IC(JSON.stringify({version:2,heartbeats:i}));return n._heartbeatsCache.lastSentHeartbeatDate=r,o.length>0?(n._heartbeatsCache.heartbeats=o,yield n._storage.overwrite(n._heartbeatsCache)):(n._heartbeatsCache.heartbeats=[],n._storage.overwrite(n._heartbeatsCache)),a}catch(r){return jh.warn(r),""}})()}}function H6(){return(new Date).toISOString().substring(0,10)}class Epe{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return fe(function*(){return!!function tfe(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function nfe(){return new Promise((t,n)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var o;n((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(e){n(e)}})}().then(()=>!0).catch(()=>!1)})()}read(){var n=this;return fe(function*(){if(yield n._canUseIndexedDBPromise){const r=yield function ype(t){return $M.apply(this,arguments)}(n.app);return r?.heartbeats?r:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(n){var e=this;return fe(function*(){var r;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return z6(e.app,{lastSentHeartbeatDate:null!==(r=n.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:n.heartbeats})}})()}add(n){var e=this;return fe(function*(){var r;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return z6(e.app,{lastSentHeartbeatDate:null!==(r=n.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...n.heartbeats]})}})()}}function $6(t){return IC(JSON.stringify({version:2,heartbeats:t})).length}function FC(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}!function Cpe(t){gg(new Cp("platform-logger",n=>new Lfe(n),"PRIVATE")),gg(new Cp("heartbeat",n=>new wpe(n),"PRIVATE")),bu(OC,UM,t),bu(OC,UM,"esm2017"),bu("fire-js","")}(""),bu("firebase","10.14.1","app"),"function"==typeof SuppressedError&&SuppressedError;const tme=function G6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},W6=new g0("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),BC=new PM("@firebase/auth");function VC(t,...n){BC.logLevel<=Qr.ERROR&&BC.error(`Auth (${_g}): ${t}`,...n)}function al(t,...n){throw QM(t,...n)}function Ea(t,...n){return QM(t,...n)}function XM(t,n,e){const r=Object.assign(Object.assign({},tme()),{[n]:e});return new g0("auth","Firebase",r).create(n,{appName:t.name})}function Cs(t){return XM(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function QM(t,...n){if("string"!=typeof t){const e=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(e,...r)}return W6.create(t,...n)}function gt(t,n,...e){if(!t)throw QM(n,...e)}function Dd(t){const n="INTERNAL ASSERTION FAILED: "+t;throw VC(n),new Error(n)}function $h(t,n){t||Dd(n)}function E0(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function Z6(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function rme(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function JM(){return"http:"===Z6()||"https:"===Z6()}()||function Jhe(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class C0{constructor(n,e){this.shortDelay=n,this.longDelay=e,$h(e>n,"Short delay should be less than long delay!"),this.isMobile=kM()||k6()}get(){return rme()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function eR(t,n){$h(t.emulator,"Emulator should always be set here");const{url:e}=t.emulator;return n?`${e}${n.startsWith("/")?n.slice(1):n}`:e}class K6{static initialize(n,e,r){this.fetchImpl=n,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Dd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Dd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Dd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ome={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},sme=new C0(3e4,6e4);function Ei(t,n){return t.tenantId&&!n.tenantId?Object.assign(Object.assign({},n),{tenantId:t.tenantId}):n}function Ci(t,n,e,r){return tR.apply(this,arguments)}function tR(){return(tR=fe(function*(t,n,e,r,i={}){return Y6(t,i,fe(function*(){let o={},a={};r&&("GET"===n?a=r:o={body:JSON.stringify(r)});const c=xy(Object.assign({key:t.config.apiKey},a)).slice(1),f=yield t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const _=Object.assign({method:n,headers:f},o);return function Qhe(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}()||(_.referrerPolicy="no-referrer"),K6.fetch()(X6(t,t.config.apiHost,e,c),_)}))})).apply(this,arguments)}function Y6(t,n,e){return nR.apply(this,arguments)}function nR(){return(nR=fe(function*(t,n,e){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},ome),n);try{const i=new lme(t),o=yield Promise.race([e(),i.promise]);i.clearNetworkTimeout();const a=yield o.json();if("needConfirmation"in a)throw D0(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[f,_]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===f)throw D0(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===f)throw D0(t,"email-already-in-use",a);if("USER_DISABLED"===f)throw D0(t,"user-disabled",a);const x=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw XM(t,x,_);al(t,x)}}catch(i){if(i instanceof zh)throw i;al(t,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function qh(t,n,e,r){return rR.apply(this,arguments)}function rR(){return(rR=fe(function*(t,n,e,r,i={}){const o=yield Ci(t,n,e,r,i);return"mfaPendingCredential"in o&&al(t,"multi-factor-auth-required",{_serverResponse:o}),o})).apply(this,arguments)}function X6(t,n,e,r){const i=`${n}${e}?${r}`;return t.config.emulator?eR(t.config,i):`${t.config.apiScheme}://${i}`}class lme{constructor(n){this.auth=n,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(Ea(this.auth,"network-request-failed")),sme.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function D0(t,n,e){const r={appName:t.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const i=Ea(t,n,r);return i.customData._tokenResponse=e,i}function sR(){return(sR=fe(function*(t,n){return Ci(t,"POST","/v1/accounts:delete",n)})).apply(this,arguments)}function n8(t,n){return lR.apply(this,arguments)}function lR(){return(lR=fe(function*(t,n){return Ci(t,"POST","/v1/accounts:lookup",n)})).apply(this,arguments)}function T0(t){if(t)try{const n=new Date(Number(t));if(!isNaN(n.getTime()))return n.toUTCString()}catch{}}function cR(){return(cR=fe(function*(t,n=!1){const e=Po(t),r=yield e.getIdToken(n),i=UC(r);gt(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:T0(uR(i.auth_time)),issuedAtTime:T0(uR(i.iat)),expirationTime:T0(uR(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})).apply(this,arguments)}function uR(t){return 1e3*Number(t)}function UC(t){const[n,e,r]=t.split(".");if(void 0===n||void 0===e||void 0===r)return VC("JWT malformed, contained fewer than 3 sections"),null;try{const i=kC(e);return i?JSON.parse(i):(VC("Failed to decode base64 JWT payload"),null)}catch(i){return VC("Caught error parsing JWT payload as JSON",i?.toString()),null}}function r8(t){const n=UC(t);return gt(n,"internal-error"),gt(typeof n.exp<"u","internal-error"),gt(typeof n.iat<"u","internal-error"),Number(n.exp)-Number(n.iat)}function Gh(t,n){return dR.apply(this,arguments)}function dR(){return(dR=fe(function*(t,n,e=!1){if(e)return n;try{return yield n}catch(r){throw r instanceof zh&&function fme({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})).apply(this,arguments)}class pme{constructor(n){this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(n){var e;if(n){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const i=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(n=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(n);this.timerId=setTimeout(fe(function*(){yield e.iteration()}),r)}iteration(){var n=this;return fe(function*(){try{yield n.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&n.schedule(!0))}n.schedule()})()}}class hR{constructor(n,e){this.createdAt=n,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=T0(this.lastLoginAt),this.creationTime=T0(this.createdAt)}_copy(n){this.createdAt=n.createdAt,this.lastLoginAt=n.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function S0(t){return fR.apply(this,arguments)}function fR(){return(fR=fe(function*(t){var n;const e=t.auth,r=yield t.getIdToken(),i=yield Gh(t,n8(e,{idToken:r}));gt(i?.users.length,e,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=null!==(n=o.providerUserInfo)&&void 0!==n&&n.length?i8(o.providerUserInfo):[],c=function gme(t,n){return[...t.filter(r=>!n.some(i=>i.providerId===r.providerId)),...n]}(t.providerData,a),x=!!t.isAnonymous&&!(t.email&&o.passwordHash||c?.length),C={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new hR(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(t,C)})).apply(this,arguments)}function pR(){return(pR=fe(function*(t){const n=Po(t);yield S0(n),yield n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)})).apply(this,arguments)}function i8(t){return t.map(n=>{var{providerId:e}=n,r=FC(n,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function mR(){return(mR=fe(function*(t,n){const e=yield Y6(t,{},fe(function*(){const r=xy({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=X6(t,i,"/v1/token",`key=${o}`),c=yield t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",K6.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}})).apply(this,arguments)}function gR(){return(gR=fe(function*(t,n){return Ci(t,"POST","/v2/accounts:revokeToken",Ei(t,n))})).apply(this,arguments)}class Cy{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(n){gt(n.idToken,"internal-error"),gt(typeof n.idToken<"u","internal-error"),gt(typeof n.refreshToken<"u","internal-error");const e="expiresIn"in n&&typeof n.expiresIn<"u"?Number(n.expiresIn):r8(n.idToken);this.updateTokensAndExpiration(n.idToken,n.refreshToken,e)}updateFromIdToken(n){gt(0!==n.length,"internal-error");const e=r8(n);this.updateTokensAndExpiration(n,null,e)}getToken(n){var e=this;return fe(function*(r,i=!1){return i||!e.accessToken||e.isExpired?(gt(e.refreshToken,r,"user-token-expired"),e.refreshToken?(yield e.refresh(r,e.refreshToken),e.accessToken):null):e.accessToken}).apply(this,arguments)}clearRefreshToken(){this.refreshToken=null}refresh(n,e){var r=this;return fe(function*(){const{accessToken:i,refreshToken:o,expiresIn:a}=yield function _me(t,n){return mR.apply(this,arguments)}(n,e);r.updateTokensAndExpiration(i,o,Number(a))})()}updateTokensAndExpiration(n,e,r){this.refreshToken=e||null,this.accessToken=n||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(n,e){const{refreshToken:r,accessToken:i,expirationTime:o}=e,a=new Cy;return r&&(gt("string"==typeof r,"internal-error",{appName:n}),a.refreshToken=r),i&&(gt("string"==typeof i,"internal-error",{appName:n}),a.accessToken=i),o&&(gt("number"==typeof o,"internal-error",{appName:n}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(n){this.accessToken=n.accessToken,this.refreshToken=n.refreshToken,this.expirationTime=n.expirationTime}_clone(){return Object.assign(new Cy,this.toJSON())}_performRefresh(){return Dd("not implemented")}}function Tp(t,n){gt("string"==typeof t||typeof t>"u","internal-error",{appName:n})}class Wh{constructor(n){var{uid:e,auth:r,stsTokenManager:i}=n,o=FC(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pme(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new hR(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(n){var e=this;return fe(function*(){const r=yield Gh(e,e.stsTokenManager.getToken(e.auth,n));return gt(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(n){return function hme(t){return cR.apply(this,arguments)}(this,n)}reload(){return function mme(t){return pR.apply(this,arguments)}(this)}_assign(n){this!==n&&(gt(this.uid===n.uid,this.auth,"internal-error"),this.displayName=n.displayName,this.photoURL=n.photoURL,this.email=n.email,this.emailVerified=n.emailVerified,this.phoneNumber=n.phoneNumber,this.isAnonymous=n.isAnonymous,this.tenantId=n.tenantId,this.providerData=n.providerData.map(e=>Object.assign({},e)),this.metadata._copy(n.metadata),this.stsTokenManager._assign(n.stsTokenManager))}_clone(n){const e=new Wh(Object.assign(Object.assign({},this),{auth:n,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(n){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=n,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(n){this.reloadListener?this.reloadListener(n):this.reloadUserInfo=n}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(n){var e=this;return fe(function*(r,i=!1){let o=!1;r.idToken&&r.idToken!==e.stsTokenManager.accessToken&&(e.stsTokenManager.updateFromServerResponse(r),o=!0),i&&(yield S0(e)),yield e.auth._persistUserIfCurrent(e),o&&e.auth._notifyListenersIfCurrent(e)}).apply(this,arguments)}delete(){var n=this;return fe(function*(){if(Hh(n.auth.app))return Promise.reject(Cs(n.auth));const e=yield n.getIdToken();return yield Gh(n,function ume(t,n){return sR.apply(this,arguments)}(n.auth,{idToken:e})),n.stsTokenManager.clearRefreshToken(),n.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(n=>Object.assign({},n)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(n,e){var r,i,o,a,c,f,_,x;const C=null!==(r=e.displayName)&&void 0!==r?r:void 0,A=null!==(i=e.email)&&void 0!==i?i:void 0,N=null!==(o=e.phoneNumber)&&void 0!==o?o:void 0,U=null!==(a=e.photoURL)&&void 0!==a?a:void 0,ne=null!==(c=e.tenantId)&&void 0!==c?c:void 0,ce=null!==(f=e._redirectEventId)&&void 0!==f?f:void 0,xe=null!==(_=e.createdAt)&&void 0!==_?_:void 0,Ce=null!==(x=e.lastLoginAt)&&void 0!==x?x:void 0,{uid:Ze,emailVerified:Se,isAnonymous:Ee,providerData:ze,stsTokenManager:Xe}=e;gt(Ze&&Xe,n,"internal-error");const yt=Cy.fromJSON(this.name,Xe);gt("string"==typeof Ze,n,"internal-error"),Tp(C,n.name),Tp(A,n.name),gt("boolean"==typeof Se,n,"internal-error"),gt("boolean"==typeof Ee,n,"internal-error"),Tp(N,n.name),Tp(U,n.name),Tp(ne,n.name),Tp(ce,n.name),Tp(xe,n.name),Tp(Ce,n.name);const an=new Wh({uid:Ze,auth:n,email:A,emailVerified:Se,displayName:C,isAnonymous:Ee,photoURL:U,phoneNumber:N,tenantId:ne,stsTokenManager:yt,createdAt:xe,lastLoginAt:Ce});return ze&&Array.isArray(ze)&&(an.providerData=ze.map(un=>Object.assign({},un))),ce&&(an._redirectEventId=ce),an}static _fromIdTokenResponse(n,e){return fe(function*(r,i,o=!1){const a=new Cy;a.updateFromServerResponse(i);const c=new Wh({uid:i.localId,auth:r,stsTokenManager:a,isAnonymous:o});return yield S0(c),c}).apply(this,arguments)}static _fromGetAccountInfoResponse(n,e,r){return fe(function*(){const i=e.users[0];gt(void 0!==i.localId,"internal-error");const o=void 0!==i.providerUserInfo?i8(i.providerUserInfo):[],a=!(i.email&&i.passwordHash||o?.length),c=new Cy;c.updateFromIdToken(r);const f=new Wh({uid:i.localId,auth:n,stsTokenManager:c,isAnonymous:a}),_={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new hR(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||o?.length)};return Object.assign(f,_),f})()}}const o8=new Map;function Zh(t){$h(t instanceof Function,"Expected a class definition");let n=o8.get(t);return n?($h(n instanceof t,"Instance stored in cache mismatched with class"),n):(n=new t,o8.set(t,n),n)}const s8=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return fe(function*(){return!0})()}_set(e,r){var i=this;return fe(function*(){i.storage[e]=r})()}_get(e){var r=this;return fe(function*(){const i=r.storage[e];return void 0===i?null:i})()}_remove(e){var r=this;return fe(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return t.type="NONE",t})();function zC(t,n,e){return`firebase:${t}:${n}:${e}`}class Dy{constructor(n,e,r){this.persistence=n,this.auth=e,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=zC(this.userKey,i.apiKey,o),this.fullPersistenceKey=zC("persistence",i.apiKey,o),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(n){return this.persistence._set(this.fullUserKey,n.toJSON())}getCurrentUser(){var n=this;return fe(function*(){const e=yield n.persistence._get(n.fullUserKey);return e?Wh._fromJSON(n.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(n){var e=this;return fe(function*(){if(e.persistence===n)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=n,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(n,e){return fe(function*(r,i,o="authUser"){if(!i.length)return new Dy(Zh(s8),r,o);const a=(yield Promise.all(i.map(function(){var C=fe(function*(A){if(yield A._isAvailable())return A});return function(A){return C.apply(this,arguments)}}()))).filter(C=>C);let c=a[0]||Zh(s8);const f=zC(o,r.config.apiKey,r.name);let _=null;for(const C of i)try{const A=yield C._get(f);if(A){const N=Wh._fromJSON(r,A);C!==c&&(_=N),c=C;break}}catch{}const x=a.filter(C=>C._shouldAllowMigration);return c._shouldAllowMigration&&x.length?(c=x[0],_&&(yield c._set(f,_.toJSON())),yield Promise.all(i.map(function(){var C=fe(function*(A){if(A!==c)try{yield A._remove(f)}catch{}});return function(A){return C.apply(this,arguments)}}())),new Dy(c,r,o)):new Dy(c,r,o)}).apply(this,arguments)}}function a8(t){const n=t.toLowerCase();if(n.includes("opera/")||n.includes("opr/")||n.includes("opios/"))return"Opera";if(d8(n))return"IEMobile";if(n.includes("msie")||n.includes("trident/"))return"IE";if(n.includes("edge/"))return"Edge";if(l8(n))return"Firefox";if(n.includes("silk/"))return"Silk";if(f8(n))return"Blackberry";if(p8(n))return"Webos";if(c8(n))return"Safari";if((n.includes("chrome/")||u8(n))&&!n.includes("edge/"))return"Chrome";if(h8(n))return"Android";{const r=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function l8(t=qs()){return/firefox\//i.test(t)}function c8(t=qs()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function u8(t=qs()){return/crios\//i.test(t)}function d8(t=qs()){return/iemobile/i.test(t)}function h8(t=qs()){return/android/i.test(t)}function f8(t=qs()){return/blackberry/i.test(t)}function p8(t=qs()){return/webos/i.test(t)}function _R(t=qs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function m8(t=qs()){return _R(t)||h8(t)||p8(t)||f8(t)||/windows phone/i.test(t)||d8(t)}function g8(t,n=[]){let e;switch(t){case"Browser":e=a8(qs());break;case"Worker":e=`${a8(qs())}-${t}`;break;default:e=t}const r=n.length?n.join(","):"FirebaseCore-web";return`${e}/JsCore/${_g}/${r}`}class wme{constructor(n){this.auth=n,this.queue=[]}pushCallback(n,e){const r=o=>new Promise((a,c)=>{try{a(n(o))}catch(f){c(f)}});r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(n){var e=this;return fe(function*(){if(e.auth.currentUser===n)return;const r=[];try{for(const i of e.queue)yield i(n),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const o of r)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function yR(){return(yR=fe(function*(t,n={}){return Ci(t,"GET","/v2/passwordPolicy",Ei(t,n))})).apply(this,arguments)}class Cme{constructor(n){var e,r,i,o;const a=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=a.minPasswordLength)&&void 0!==e?e:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(r=n.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(o=n.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=n.schemaVersion}validatePassword(n){var e,r,i,o,a,c;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(n,f),this.validatePasswordCharacterOptions(n,f),f.isValid&&(f.isValid=null===(e=f.meetsMinPasswordLength)||void 0===e||e),f.isValid&&(f.isValid=null===(r=f.meetsMaxPasswordLength)||void 0===r||r),f.isValid&&(f.isValid=null===(i=f.containsLowercaseLetter)||void 0===i||i),f.isValid&&(f.isValid=null===(o=f.containsUppercaseLetter)||void 0===o||o),f.isValid&&(f.isValid=null===(a=f.containsNumericCharacter)||void 0===a||a),f.isValid&&(f.isValid=null===(c=f.containsNonAlphanumericCharacter)||void 0===c||c),f}validatePasswordLengthOptions(n,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=n.length>=r),i&&(e.meetsMaxPasswordLength=n.length<=i)}validatePasswordCharacterOptions(n,e){let r;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<n.length;i++)r=n.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(n,e,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(n.containsLowercaseLetter||(n.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(n.containsUppercaseLetter||(n.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(n.containsNumericCharacter||(n.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(n.containsNonAlphanumericCharacter||(n.containsNonAlphanumericCharacter=o))}}class Dme{constructor(n,e,r,i){this.app=n,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _8(this),this.idTokenSubscription=new _8(this),this.beforeStateQueue=new wme(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=W6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(n,e){var r=this;return e&&(this._popupRedirectResolver=Zh(e)),this._initializationPromise=this.queue(fe(function*(){var i,o;if(!r._deleted&&(r.persistenceManager=yield Dy.create(r,n),!r._deleted)){if(null!==(i=r._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var n=this;return fe(function*(){if(n._deleted)return;const e=yield n.assertedPersistence.getCurrentUser();if(n.currentUser||e){if(n.currentUser&&e&&n.currentUser.uid===e.uid)return n._currentUser._assign(e),void(yield n.currentUser.getIdToken());yield n._updateCurrentUser(e,!0)}})()}initializeCurrentUserFromIdToken(n){var e=this;return fe(function*(){try{const r=yield n8(e,{idToken:n}),i=yield Wh._fromGetAccountInfoResponse(e,r,n);yield e.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield e.directlySetCurrentUser(null)}})()}initializeCurrentUser(n){var e=this;return fe(function*(){var r;if(Hh(e.app)){const c=e.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>e.initializeCurrentUserFromIdToken(c).then(f,f))}):e.directlySetCurrentUser(null)}const i=yield e.assertedPersistence.getCurrentUser();let o=i,a=!1;if(n&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,f=o?._redirectEventId,_=yield e.tryRedirectSignIn(n);(!c||c===f)&&_?.user&&(o=_.user,a=!0)}if(!o)return e.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{yield e.beforeStateQueue.runMiddleware(o)}catch(c){o=i,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return o?e.reloadAndSetCurrentUserOrClear(o):e.directlySetCurrentUser(null)}return gt(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===o._redirectEventId?e.directlySetCurrentUser(o):e.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(n){var e=this;return fe(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,n,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(n){var e=this;return fe(function*(){try{yield S0(n)}catch(r){if("auth/network-request-failed"!==r?.code)return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(n)})()}useDeviceLanguage(){this.languageCode=function ime(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}_delete(){var n=this;return fe(function*(){n._deleted=!0})()}updateCurrentUser(n){var e=this;return fe(function*(){if(Hh(e.app))return Promise.reject(Cs(e));const r=n?Po(n):null;return r&&gt(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(n){var e=this;return fe(function*(r,i=!1){if(!e._deleted)return r&&gt(e.tenantId===r.tenantId,e,"tenant-id-mismatch"),i||(yield e.beforeStateQueue.runMiddleware(r)),e.queue(fe(function*(){yield e.directlySetCurrentUser(r),e.notifyAuthListeners()}))}).apply(this,arguments)}signOut(){var n=this;return fe(function*(){return Hh(n.app)?Promise.reject(Cs(n)):(yield n.beforeStateQueue.runMiddleware(null),(n.redirectPersistenceManager||n._popupRedirectResolver)&&(yield n._setRedirectUser(null)),n._updateCurrentUser(null,!0))})()}setPersistence(n){var e=this;return Hh(this.app)?Promise.reject(Cs(this)):this.queue(fe(function*(){yield e.assertedPersistence.setPersistence(Zh(n))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(n){var e=this;return fe(function*(){e._getPasswordPolicyInternal()||(yield e._updatePasswordPolicy());const r=e._getPasswordPolicyInternal();return r.schemaVersion!==e.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(e._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(n)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var n=this;return fe(function*(){const e=yield function xme(t){return yR.apply(this,arguments)}(n),r=new Cme(e);null===n.tenantId?n._projectPasswordPolicy=r:n._tenantPasswordPolicies[n.tenantId]=r})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(n){this._errorFactory=new g0("auth","Firebase",n())}onAuthStateChanged(n,e,r){return this.registerStateListener(this.authStateSubscription,n,e,r)}beforeAuthStateChanged(n,e){return this.beforeStateQueue.pushCallback(n,e)}onIdTokenChanged(n,e,r){return this.registerStateListener(this.idTokenSubscription,n,e,r)}authStateReady(){return new Promise((n,e)=>{if(this.currentUser)n();else{const r=this.onAuthStateChanged(()=>{r(),n()},e)}})}revokeAccessToken(n){var e=this;return fe(function*(){if(e.currentUser){const r=yield e.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:n,idToken:r};null!=e.tenantId&&(i.tenantId=e.tenantId),yield function yme(t,n){return gR.apply(this,arguments)}(e,i)}})()}toJSON(){var n;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(n=this._currentUser)||void 0===n?void 0:n.toJSON()}}_setRedirectUser(n,e){var r=this;return fe(function*(){const i=yield r.getOrInitRedirectPersistenceManager(e);return null===n?i.removeCurrentUser():i.setCurrentUser(n)})()}getOrInitRedirectPersistenceManager(n){var e=this;return fe(function*(){if(!e.redirectPersistenceManager){const r=n&&Zh(n)||e._popupRedirectResolver;gt(r,e,"argument-error"),e.redirectPersistenceManager=yield Dy.create(e,[Zh(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(n){var e=this;return fe(function*(){var r,i;return e._isInitialized&&(yield e.queue(fe(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===n?e._currentUser:(null===(i=e.redirectUser)||void 0===i?void 0:i._redirectEventId)===n?e.redirectUser:null})()}_persistUserIfCurrent(n){var e=this;return fe(function*(){if(n===e.currentUser)return e.queue(fe(function*(){return e.directlySetCurrentUser(n)}))})()}_notifyListenersIfCurrent(n){n===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(n=this.currentUser)||void 0===n?void 0:n.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(n,e,r,i){if(this._deleted)return()=>{};const o="function"==typeof e?e:e.next.bind(e);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),"function"==typeof e){const f=n.addObserver(e,r,i);return()=>{a=!0,f()}}{const f=n.addObserver(e);return()=>{a=!0,f()}}}directlySetCurrentUser(n){var e=this;return fe(function*(){e.currentUser&&e.currentUser!==n&&e._currentUser._stopProactiveRefresh(),n&&e.isProactiveRefreshEnabled&&n._startProactiveRefresh(),e.currentUser=n,n?yield e.assertedPersistence.setCurrentUser(n):yield e.assertedPersistence.removeCurrentUser()})()}queue(n){return this.operations=this.operations.then(n,n),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(n){!n||this.frameworks.includes(n)||(this.frameworks.push(n),this.frameworks.sort(),this.clientVersion=g8(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var n=this;return fe(function*(){var e;const r={"X-Client-Version":n.clientVersion};n.app.options.appId&&(r["X-Firebase-gmpid"]=n.app.options.appId);const i=yield null===(e=n.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();i&&(r["X-Firebase-Client"]=i);const o=yield n._getAppCheckToken();return o&&(r["X-Firebase-AppCheck"]=o),r})()}_getAppCheckToken(){var n=this;return fe(function*(){var e;const r=yield null===(e=n.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken();return r?.error&&function nme(t,...n){BC.logLevel<=Qr.WARN&&BC.warn(`Auth (${_g}): ${t}`,...n)}(`Error while retrieving App Check token: ${r.error}`),r?.token})()}}function No(t){return Po(t)}class _8{constructor(n){this.auth=n,this.observer=null,this.addObserver=function cfe(t,n){const e=new ufe(t,n);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let I0={loadJS:()=>fe(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y8(t){return`__${t}${Math.floor(1e6*Math.random())}`}function w8(t){const n=t.indexOf(":");return n<0?"":t.substr(0,n+1)}function x8(t){if(!t)return null;const n=Number(t);return isNaN(n)?null:n}class A0{constructor(n,e){this.providerId=n,this.signInMethod=e}toJSON(){return Dd("not implemented")}_getIdTokenResponse(n){return Dd("not implemented")}_linkToIdToken(n,e){return Dd("not implemented")}_getReauthenticationResolver(n){return Dd("not implemented")}}function Kh(t,n){return LR.apply(this,arguments)}function LR(){return(LR=fe(function*(t,n){return qh(t,"POST","/v1/accounts:signInWithIdp",Ei(t,n))})).apply(this,arguments)}class Ty extends A0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(n){const e=new Ty(n.providerId,n.signInMethod);return n.idToken||n.accessToken?(n.idToken&&(e.idToken=n.idToken),n.accessToken&&(e.accessToken=n.accessToken),n.nonce&&!n.pendingToken&&(e.nonce=n.nonce),n.pendingToken&&(e.pendingToken=n.pendingToken)):n.oauthToken&&n.oauthTokenSecret?(e.accessToken=n.oauthToken,e.secret=n.oauthTokenSecret):al("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(n){const e="string"==typeof n?JSON.parse(n):n,{providerId:r,signInMethod:i}=e,o=FC(e,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Ty(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(n){return Kh(n,this.buildRequest())}_linkToIdToken(n,e){const r=this.buildRequest();return r.idToken=e,Kh(n,r)}_getReauthenticationResolver(n){const e=this.buildRequest();return e.autoCreate=!1,Kh(n,e)}buildRequest(){const n={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)n.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),n.postBody=xy(e)}return n}}class Yh{constructor(n){this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(n){this.defaultLanguageCode=n}setCustomParameters(n){return this.customParameters=n,this}getCustomParameters(){return this.customParameters}}class D8 extends Yh{constructor(){super(...arguments),this.scopes=[]}addScope(n){return this.scopes.includes(n)||this.scopes.push(n),this}getScopes(){return[...this.scopes]}}let T8=(()=>{class t extends D8{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ty._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:i}=e;if(!r&&!i)return null;try{return t.credential(r,i)}catch{return null}}}return t.GOOGLE_SIGN_IN_METHOD="google.com",t.PROVIDER_ID="google.com",t})();class Nc{constructor(n){this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}static _fromIdTokenResponse(n,e,r){return fe(function*(i,o,a,c=!1){const f=yield Wh._fromIdTokenResponse(i,a,c),_=I8(a);return new Nc({user:f,providerId:_,_tokenResponse:a,operationType:o})}).apply(this,arguments)}static _forOperation(n,e,r){return fe(function*(){yield n._updateTokensIfNecessary(r,!0);const i=I8(r);return new Nc({user:n,providerId:i,_tokenResponse:r,operationType:e})})()}}function I8(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class qC extends zh{constructor(n,e,r,i){var o;super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,qC.prototype),this.customData={appName:n.name,tenantId:null!==(o=n.tenantId)&&void 0!==o?o:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(n,e,r,i){return new qC(n,e,r,i)}}function k8(t,n,e,r){return("reauthenticate"===n?e._getReauthenticationResolver(t):e._getIdTokenResponse(t)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?qC._fromErrorAndOperation(t,o,n,r):o})}function qR(t,n){return GR.apply(this,arguments)}function GR(){return(GR=fe(function*(t,n,e=!1){const r=yield Gh(t,n._linkToIdToken(t.auth,yield t.getIdToken()),e);return Nc._forOperation(t,"link",r)})).apply(this,arguments)}function M8(t,n){return ZR.apply(this,arguments)}function ZR(){return(ZR=fe(function*(t,n,e=!1){const{auth:r}=t;if(Hh(r.app))return Promise.reject(Cs(r));const i="reauthenticate";try{const o=yield Gh(t,k8(r,i,n,t),e);gt(o.idToken,r,"internal-error");const a=UC(o.idToken);gt(a,r,"internal-error");const{sub:c}=a;return gt(t.uid===c,r,"user-mismatch"),Nc._forOperation(t,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&al(r,"user-mismatch"),o}})).apply(this,arguments)}function R8(t,n){return KR.apply(this,arguments)}function KR(){return(KR=fe(function*(t,n,e=!1){if(Hh(t.app))return Promise.reject(Cs(t));const r="signIn",i=yield k8(t,r,n),o=yield Nc._fromIdTokenResponse(t,r,i);return e||(yield t._updateCurrentUser(o.user)),o})).apply(this,arguments)}function ZC(t,n,e,r){return Po(t).onAuthStateChanged(n,e,r)}const KC="__sak";class O8{constructor(n,e){this.storageRetriever=n,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(KC,"1"),this.storage.removeItem(KC),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(n,e){return this.storage.setItem(n,JSON.stringify(e)),Promise.resolve()}_get(n){const e=this.storage.getItem(n);return Promise.resolve(e?JSON.parse(e):null)}_remove(n){return this.storage.removeItem(n),Promise.resolve()}get storage(){return this.storageRetriever()}}const Cge=(()=>{class t extends O8{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=m8(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),o=this.localCache[r];i!==o&&e(r,o,i)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,f,_)=>{this.notifyListeners(c,_)});const i=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);!function bme(){return function efe(){const t=qs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}()||a===e.newValue||e.newValue===e.oldValue?o():setTimeout(o,10)}notifyListeners(e,r){this.localCache[e]=r;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var i=()=>super._set,o=this;return fe(function*(){yield i().call(o,e,r),o.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,i=this;return fe(function*(){const o=yield r().call(i,e);return i.localCache[e]=JSON.stringify(o),o})()}_remove(e){var r=()=>super._remove,i=this;return fe(function*(){yield r().call(i,e),delete i.localCache[e]})()}}return t.type="LOCAL",t})(),L8=(()=>{class t extends O8{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return t.type="SESSION",t})();let Tge=(()=>{class t{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const i=new t(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return fe(function*(){const i=e,{eventId:o,eventType:a,data:c}=i.data,f=r.handlersMap[a];if(!f?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:a});const _=Array.from(f).map(function(){var C=fe(function*(A){return A(i.origin,c)});return function(A){return C.apply(this,arguments)}}()),x=yield function Dge(t){return Promise.all(t.map(function(){var n=fe(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return n.apply(this,arguments)}}()))}(_);i.ports[0].postMessage({status:"done",eventId:o,eventType:a,response:x})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return t.receivers=[],t})();function YC(t="",n=10){let e="";for(let r=0;r<n;r++)e+=Math.floor(10*Math.random());return t+e}class Sge{constructor(n){this.target=n,this.handlers=new Set}removeMessageHandler(n){n.messageChannel&&(n.messageChannel.port1.removeEventListener("message",n.onMessage),n.messageChannel.port1.close()),this.handlers.delete(n)}_send(n,e){var r=this;return fe(function*(i,o,a=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let f,_;return new Promise((x,C)=>{const A=YC("",20);c.port1.start();const N=setTimeout(()=>{C(new Error("unsupported_event"))},a);_={messageChannel:c,onMessage(U){const ne=U;if(ne.data.eventId===A)switch(ne.data.status){case"ack":clearTimeout(N),f=setTimeout(()=>{C(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),x(ne.data.response);break;default:clearTimeout(N),clearTimeout(f),C(new Error("invalid_response"))}}},r.handlers.add(_),c.port1.addEventListener("message",_.onMessage),r.target.postMessage({eventType:i,eventId:A,data:o},[c.port2])}).finally(()=>{_&&r.removeMessageHandler(_)})}).apply(this,arguments)}}function Yo(){return window}function TP(){return typeof Yo().WorkerGlobalScope<"u"&&"function"==typeof Yo().importScripts}function SP(){return(SP=fe(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const F8="firebaseLocalStorageDb",XC="firebaseLocalStorage",B8="fbase_key";class N0{constructor(n){this.request=n}toPromise(){return new Promise((n,e)=>{this.request.addEventListener("success",()=>{n(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function QC(t,n){return t.transaction([XC],n?"readwrite":"readonly").objectStore(XC)}function IP(){const t=indexedDB.open(F8,1);return new Promise((n,e)=>{t.addEventListener("error",()=>{e(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(XC,{keyPath:B8})}catch(i){e(i)}}),t.addEventListener("success",fe(function*(){const r=t.result;r.objectStoreNames.contains(XC)?n(r):(r.close(),yield function Pge(){const t=indexedDB.deleteDatabase(F8);return new N0(t).toPromise()}(),n(yield IP()))}))})}function V8(t,n,e){return kP.apply(this,arguments)}function kP(){return(kP=fe(function*(t,n,e){const r=QC(t,!0).put({[B8]:n,value:e});return new N0(r).toPromise()})).apply(this,arguments)}function AP(){return(AP=fe(function*(t,n){const e=QC(t,!1).get(n),r=yield new N0(e).toPromise();return void 0===r?null:r.value})).apply(this,arguments)}function U8(t,n){const e=QC(t,!0).delete(n);return new N0(e).toPromise()}const Fge=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return fe(function*(){return e.db||(e.db=yield IP()),e.db})()}_withRetries(e){var r=this;return fe(function*(){let i=0;for(;;)try{const o=yield r._openDb();return yield e(o)}catch(o){if(i++>3)throw o;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return fe(function*(){return TP()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return fe(function*(){e.receiver=Tge._getInstance(function Mge(){return TP()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=fe(function*(i,o){return{keyProcessed:(yield e._poll()).includes(o.key)}});return function(i,o){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=fe(function*(i,o){return["keyChanged"]});return function(i,o){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return fe(function*(){var r,i;if(e.activeServiceWorker=yield function kge(){return SP.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new Sge(e.activeServiceWorker);const o=yield e.sender._send("ping",{},800);o&&null!==(r=o[0])&&void 0!==r&&r.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return fe(function*(){if(r.sender&&r.activeServiceWorker&&function Age(){var t;return(null===(t=navigator?.serviceWorker)||void 0===t?void 0:t.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return fe(function*(){try{if(!indexedDB)return!1;const e=yield IP();return yield V8(e,KC,"1"),yield U8(e,KC),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return fe(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var i=this;return fe(function*(){return i._withPendingWrite(fe(function*(){return yield i._withRetries(o=>V8(o,e,r)),i.localCache[e]=r,i.notifyServiceWorker(e)}))})()}_get(e){var r=this;return fe(function*(){const i=yield r._withRetries(o=>function Nge(t,n){return AP.apply(this,arguments)}(o,e));return r.localCache[e]=i,i})()}_remove(e){var r=this;return fe(function*(){return r._withPendingWrite(fe(function*(){return yield r._withRetries(i=>U8(i,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return fe(function*(){const r=yield e._withRetries(a=>{const c=QC(a,!1).getAll();return new N0(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const i=[],o=new Set;if(0!==r.length)for(const{fbase_key:a,value:c}of r)o.add(a),JSON.stringify(e.localCache[a])!==JSON.stringify(c)&&(e.notifyListeners(a,c),i.push(a));for(const a of Object.keys(e.localCache))e.localCache[a]&&!o.has(a)&&(e.notifyListeners(a,null),i.push(a));return i})()}notifyListeners(e,r){this.localCache[e]=r;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(fe(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return t.type="LOCAL",t})();function vg(t,n){return n?Zh(n):(gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}y8("rcb"),new C0(3e4,6e4);class VP extends A0{constructor(n){super("custom","custom"),this.params=n}_getIdTokenResponse(n){return Kh(n,this._buildIdpRequest())}_linkToIdToken(n,e){return Kh(n,this._buildIdpRequest(e))}_getReauthenticationResolver(n){return Kh(n,this._buildIdpRequest())}_buildIdpRequest(n){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return n&&(e.idToken=n),e}}function Qge(t){return R8(t.auth,new VP(t),t.bypassAuthState)}function Jge(t){const{auth:n,user:e}=t;return gt(e,n,"internal-error"),M8(e,new VP(t),t.bypassAuthState)}function e_e(t){return UP.apply(this,arguments)}function UP(){return(UP=fe(function*(t){const{auth:n,user:e}=t;return gt(e,n,"internal-error"),qR(e,new VP(t),t.bypassAuthState)})).apply(this,arguments)}class j8{constructor(n,e,r,i,o=!1){this.auth=n,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var n=this;return new Promise(function(){var e=fe(function*(r,i){n.pendingPromise={resolve:r,reject:i};try{n.eventManager=yield n.resolver._initialize(n.auth),yield n.onExecution(),n.eventManager.registerConsumer(n)}catch(o){n.reject(o)}});return function(r,i){return e.apply(this,arguments)}}())}onAuthEvent(n){var e=this;return fe(function*(){const{urlResponse:r,sessionId:i,postBody:o,tenantId:a,error:c,type:f}=n;if(c)return void e.reject(c);const _={auth:e.auth,requestUri:r,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(f)(_))}catch(x){e.reject(x)}})()}onError(n){this.reject(n)}getIdpTask(n){switch(n){case"signInViaPopup":case"signInViaRedirect":return Qge;case"linkViaPopup":case"linkViaRedirect":return e_e;case"reauthViaPopup":case"reauthViaRedirect":return Jge;default:al(this.auth,"internal-error")}}resolve(n){$h(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(n),this.unregisterAndCleanUp()}reject(n){$h(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(n),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const t_e=new C0(2e3,1e4);function zP(){return(zP=fe(function*(t,n,e){if(Hh(t.app))return Promise.reject(Ea(t,"operation-not-supported-in-this-environment"));const r=No(t);!function Ey(t,n,e){if(!(n instanceof e))throw e.name!==n.constructor.name&&al(t,"argument-error"),XM(t,"argument-error",`Type of ${n.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,n,Yh);const i=vg(r,e);return new $P(r,"signInViaPopup",n,i).executeNotNull()})).apply(this,arguments)}let $P=(()=>{class t extends j8{constructor(e,r,i,o,a){super(e,r,o,a),this.provider=i,this.authWindow=null,this.pollId=null,t.currentPopupAction&&t.currentPopupAction.cancel(),t.currentPopupAction=this}executeNotNull(){var e=this;return fe(function*(){const r=yield e.execute();return gt(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return fe(function*(){$h(1===e.filter.length,"Popup operations only handle one event");const r=YC();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(i=>{e.reject(i)}),e.resolver._isIframeWebStorageSupported(e.auth,i=>{i||e.reject(Ea(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Ea(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,t.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,i;this.pollId=null!==(i=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ea(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(e,t_e.get())};e()}}return t.currentPopupAction=null,t})();const O0=new Map;class i_e extends j8{constructor(n,e,r=!1){super(n,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var n=()=>super.execute,e=this;return fe(function*(){let r=O0.get(e.auth._key());if(!r){try{const o=(yield function o_e(t,n){return qP.apply(this,arguments)}(e.resolver,e.auth))?yield n().call(e):null;r=()=>Promise.resolve(o)}catch(i){r=()=>Promise.reject(i)}O0.set(e.auth._key(),r)}return e.bypassAuthState||O0.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(n){var e=()=>super.onAuthEvent,r=this;return fe(function*(){if("signInViaRedirect"===n.type)return e().call(r,n);if("unknown"!==n.type){if(n.eventId){const i=yield r.auth._redirectUserForId(n.eventId);if(i)return r.user=i,e().call(r,n);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return fe(function*(){})()}cleanUp(){}}function qP(){return(qP=fe(function*(t,n){const e=function $8(t){return zC("pendingRedirect",t.config.apiKey,t.name)}(n),r=function H8(t){return Zh(t._redirectPersistence)}(t);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(e));return yield r._remove(e),i})).apply(this,arguments)}function s_e(t,n){O0.set(t._key(),n)}function q8(t,n){return QP.apply(this,arguments)}function QP(){return(QP=fe(function*(t,n,e=!1){if(Hh(t.app))return Promise.reject(Cs(t));const r=No(t),i=vg(r,n),a=yield new i_e(r,i,e).execute();return a&&!e&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,n)),a})).apply(this,arguments)}class d_e{constructor(n){this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(n){this.consumers.add(n),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,n)&&(this.sendToConsumer(this.queuedRedirectEvent,n),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(n){this.consumers.delete(n)}onEvent(n){if(this.hasEventBeenHandled(n))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(n,r)&&(e=!0,this.sendToConsumer(n,r),this.saveEventToCache(n))}),this.hasHandledPotentialRedirect||!function h_e(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Z8(t);default:return!1}}(n)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=n,e=!0)),e}sendToConsumer(n,e){var r;if(n.error&&!Z8(n)){const i=(null===(r=n.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(Ea(this.auth,i))}else e.onAuthEvent(n)}isEventForConsumer(n,e){const r=null===e.eventId||!!n.eventId&&n.eventId===e.eventId;return e.filter.includes(n.type)&&r}hasEventBeenHandled(n){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(W8(n))}saveEventToCache(n){this.cachedEventUids.add(W8(n)),this.lastProcessedEventTime=Date.now()}}function W8(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(n=>n).join("-")}function Z8({type:t,error:n}){return"unknown"===t&&"auth/no-auth-event"===n?.code}function e2(){return(e2=fe(function*(t,n={}){return Ci(t,"GET","/v1/projects",n)})).apply(this,arguments)}const p_e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,m_e=/^https?/;function t2(){return t2=fe(function*(t){if(t.config.emulator)return;const{authorizedDomains:n}=yield function f_e(t){return e2.apply(this,arguments)}(t);for(const e of n)try{if(__e(e))return}catch{}al(t,"unauthorized-domain")}),t2.apply(this,arguments)}function __e(t){const n=E0(),{protocol:e,hostname:r}=new URL(n);if(t.startsWith("chrome-extension://")){const a=new URL(t);return""===a.hostname&&""===r?"chrome-extension:"===e&&t.replace("chrome-extension://","")===n.replace("chrome-extension://",""):"chrome-extension:"===e&&a.hostname===r}if(!m_e.test(e))return!1;if(p_e.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const y_e=new C0(3e4,6e4);function K8(){const t=Yo().___jsl;if(t?.H)for(const n of Object.keys(t.H))if(t.H[n].r=t.H[n].r||[],t.H[n].L=t.H[n].L||[],t.H[n].r=[...t.H[n].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function v_e(t){return new Promise((n,e)=>{var r,i,o;function a(){K8(),gapi.load("gapi.iframes",{callback:()=>{n(gapi.iframes.getContext())},ontimeout:()=>{K8(),e(Ea(t,"network-request-failed"))},timeout:y_e.get()})}if(null!==(i=null===(r=Yo().gapi)||void 0===r?void 0:r.iframes)&&void 0!==i&&i.Iframe)n(gapi.iframes.getContext());else{if(null===(o=Yo().gapi)||void 0===o||!o.load){const c=y8("iframefcb");return Yo()[c]=()=>{gapi.load?a():e(Ea(t,"network-request-failed"))},function vR(t){return I0.loadJS(t)}(`${function kme(){return I0.gapiScript}()}?onload=${c}`).catch(f=>e(f))}a()}}).catch(n=>{throw eD=null,n})}let eD=null;const w_e=new C0(5e3,15e3),C_e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D_e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T_e(t){const n=t.config;gt(n.authDomain,t,"auth-domain-config-required");const e=n.emulator?eR(n,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,r={apiKey:n.apiKey,appName:t.name,v:_g},i=D_e.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${e}?${xy(r).slice(1)}`}function n2(){return n2=fe(function*(t){const n=yield function b_e(t){return eD=eD||v_e(t),eD}(t),e=Yo().gapi;return gt(e,t,"internal-error"),n.open({where:document.body,url:T_e(t),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C_e,dontclear:!0},r=>new Promise(function(){var i=fe(function*(o,a){yield r.restyle({setHideOnLeave:!1});const c=Ea(t,"network-request-failed"),f=Yo().setTimeout(()=>{a(c)},w_e.get());function _(){Yo().clearTimeout(f),o(r)}r.ping(_).then(_,()=>{a(c)})});return function(o,a){return i.apply(this,arguments)}}()))}),n2.apply(this,arguments)}const I_e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Y8{constructor(n){this.window=n,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const F_e=encodeURIComponent("fac");function X8(t,n,e,r,i,o){return r2.apply(this,arguments)}function r2(){return(r2=fe(function*(t,n,e,r,i,o){gt(t.config.authDomain,t,"auth-domain-config-required"),gt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:e,redirectUrl:r,v:_g,eventId:i};if(n instanceof Yh){n.setDefaultLanguage(t.languageCode),a.providerId=n.providerId||"",AM(n.getCustomParameters())||(a.customParameters=JSON.stringify(n.getCustomParameters()));for(const[x,C]of Object.entries(o||{}))a[x]=C}if(n instanceof D8){const x=n.getScopes().filter(C=>""!==C);x.length>0&&(a.scopes=x.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const x of Object.keys(c))void 0===c[x]&&delete c[x];const f=yield t._getAppCheckToken(),_=f?`#${F_e}=${encodeURIComponent(f)}`:"";return`${function B_e({config:t}){return t.emulator?eR(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${xy(c).slice(1)}${_}`})).apply(this,arguments)}const i2="webStorageSupport",U_e=class V_e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=L8,this._completeRedirectFn=q8,this._overrideRedirectResult=s_e}_openPopup(n,e,r,i){var o=this;return fe(function*(){var a;$h(null===(a=o.eventManagers[n._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");const c=yield X8(n,e,r,E0(),i);return function P_e(t,n,e,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const f=Object.assign(Object.assign({},I_e),{width:r.toString(),height:i.toString(),top:o,left:a}),_=qs().toLowerCase();e&&(c=u8(_)?"_blank":e),l8(_)&&(n=n||"http://localhost",f.scrollbars="yes");const x=Object.entries(f).reduce((A,[N,U])=>`${A}${N}=${U},`,"");if(function vme(t=qs()){var n;return _R(t)&&!(null===(n=window.navigator)||void 0===n||!n.standalone)}(_)&&"_self"!==c)return function N_e(t,n){const e=document.createElement("a");e.href=t,e.target=n;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(n||"",c),new Y8(null);const C=window.open(n||"",c,x);gt(C,t,"popup-blocked");try{C.focus()}catch{}return new Y8(C)}(n,c,YC())})()}_openRedirect(n,e,r,i){var o=this;return fe(function*(){return yield o._originValidation(n),function Ige(t){Yo().location.href=t}(yield X8(n,e,r,E0(),i)),new Promise(()=>{})})()}_initialize(n){const e=n._key();if(this.eventManagers[e]){const{manager:i,promise:o}=this.eventManagers[e];return i?Promise.resolve(i):($h(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(n);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(n){var e=this;return fe(function*(){const r=yield function S_e(t){return n2.apply(this,arguments)}(n),i=new d_e(n);return r.register("authEvent",o=>(gt(o?.authEvent,n,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[n._key()]={manager:i},e.iframes[n._key()]=r,i})()}_isIframeWebStorageSupported(n,e){this.iframes[n._key()].send(i2,{type:i2},i=>{var o;const a=null===(o=i?.[0])||void 0===o?void 0:o[i2];void 0!==a&&e(!!a),al(n,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(n){const e=n._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function g_e(t){return t2.apply(this,arguments)}(n)),this.originValidationPromises[e]}get _shouldInitProactively(){return m8()||c8()||_R()}};var tH="@firebase/auth";class z_e{constructor(n){this.auth=n,this.internalListeners=new Map}getUid(){var n;return this.assertAuthConfigured(),(null===(n=this.auth.currentUser)||void 0===n?void 0:n.uid)||null}getToken(n){var e=this;return fe(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(n)}:null})()}addAuthTokenListener(n){if(this.assertAuthConfigured(),this.internalListeners.has(n))return;const e=this.auth.onIdTokenChanged(r=>{n(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(n,e),this.updateProactiveRefresh()}removeAuthTokenListener(n){this.assertAuthConfigured();const e=this.internalListeners.get(n);e&&(this.internalListeners.delete(n),e(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const $_e=S6("authIdTokenMaxAge")||300;let rH=null;const q_e=t=>function(){var n=fe(function*(e){const r=e&&(yield e.getIdTokenResult()),i=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>$_e)return;const o=r?.token;rH!==o&&(rH=o,yield fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(e){return n.apply(this,arguments)}}();(function Tme(t){I0=t})({loadJS:t=>new Promise((n,e)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=n,r.onerror=i=>{const o=Ea("internal-error");o.customData=i,e(o)},r.type="text/javascript",r.charset="UTF-8",function W_e(){var t,n;return null!==(n=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==n?n:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function H_e(t){gg(new Cp("auth",(n,{options:e})=>{const r=n.getProvider("app").getImmediate(),i=n.getProvider("heartbeat"),o=n.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;gt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:g8(t)},_=new Dme(r,i,o,f);return function Nme(t,n){const e=n?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Zh);n?.errorMap&&t._updateErrorMap(n.errorMap),t._initializeWithPersistence(r,n?.popupRedirectResolver)}(_,e),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,r)=>{n.getProvider("auth-internal").initialize()})),gg(new Cp("auth-internal",n=>{const e=No(n.getProvider("auth").getImmediate());return new z_e(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),bu(tH,"1.7.9",function j_e(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(t)),bu(tH,"1.7.9","esm2017")}("Browser");const iH="@firebase/database";let s2="";class Z_e{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,e){null==e?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),os(e))}get(n){const e=this.domStorage_.getItem(this.prefixedName_(n));return null==e?null:_0(e)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}}class K_e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,e){null==e?delete this.cache_[n]:this.cache_[n]=e}get(n){return Cd(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}}const aH=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const n=window[t];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new Z_e(n)}}catch{}return new K_e},bg=aH("localStorage"),a2=aH("sessionStorage"),Iy=new PM("@firebase/database"),lH=function(){let t=1;return function(){return t++}}(),cH=function(t){const n=function(t){const n=[];let e=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,dt(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?n[e++]=i:i<2048?(n[e++]=i>>6|192,n[e++]=63&i|128):i<65536?(n[e++]=i>>12|224,n[e++]=i>>6&63|128,n[e++]=63&i|128):(n[e++]=i>>18|240,n[e++]=i>>12&63|128,n[e++]=i>>6&63|128,n[e++]=63&i|128)}return n}(t),e=new lfe;e.update(n);const r=e.digest();return IM.encodeByteArray(r)},L0=function(...t){let n="";for(let e=0;e<t.length;e++){const r=t[e];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?n+=L0.apply(null,r):n+="object"==typeof r?os(r):r,n+=" "}return n};let wg=null,uH=!0;const Ds=function(...t){if(!0===uH&&(uH=!1,null===wg&&!0===a2.get("logging_enabled")&&function(t,n){dt(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Iy.logLevel=Qr.VERBOSE,wg=Iy.log.bind(Iy),n&&a2.set("logging_enabled",!0)):"function"==typeof t?wg=t:(wg=null,a2.remove("logging_enabled"))}(!0)),wg){const n=L0.apply(null,t);wg(n)}},F0=function(t){return function(...n){Ds(t,...n)}},l2=function(...t){const n="FIREBASE INTERNAL ERROR: "+L0(...t);Iy.error(n)},Td=function(...t){const n=`FIREBASE FATAL ERROR: ${L0(...t)}`;throw Iy.error(n),new Error(n)},ra=function(...t){const n="FIREBASE WARNING: "+L0(...t);Iy.warn(n)},nD=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Sp="[MIN_NAME]",Xh="[MAX_NAME]",xg=function(t,n){if(t===n)return 0;if(t===Sp||n===Xh)return-1;if(n===Sp||t===Xh)return 1;{const e=pH(t),r=pH(n);return null!==e?null!==r?e-r===0?t.length-n.length:e-r:-1:null!==r?1:t<n?-1:1}},Q_e=function(t,n){return t===n?0:t<n?-1:1},B0=function(t,n){if(n&&t in n)return n[t];throw new Error("Missing required key ("+t+") in object: "+os(n))},c2=function(t){if("object"!=typeof t||null===t)return os(t);const n=[];for(const r in t)n.push(r);n.sort();let e="{";for(let r=0;r<n.length;r++)0!==r&&(e+=","),e+=os(n[r]),e+=":",e+=c2(t[n[r]]);return e+="}",e},hH=function(t,n){const e=t.length;if(e<=n)return[t];const r=[];for(let i=0;i<e;i+=n)r.push(t.substring(i,i+n>e?e:i+n));return r};function Ts(t,n){for(const e in t)t.hasOwnProperty(e)&&n(e,t[e])}const fH=function(t){dt(!nD(t),"Invalid JSON number");const r=1023;let i,o,a,c,f;0===t?(o=0,a=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(c=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=c+r,a=Math.round(t*Math.pow(2,52-c)-Math.pow(2,52))):(o=0,a=Math.round(t/Math.pow(2,-1074))));const _=[];for(f=52;f;f-=1)_.push(a%2?1:0),a=Math.floor(a/2);for(f=11;f;f-=1)_.push(o%2?1:0),o=Math.floor(o/2);_.push(i?1:0),_.reverse();const x=_.join("");let C="";for(f=0;f<64;f+=8){let A=parseInt(x.substr(f,8),2).toString(16);1===A.length&&(A="0"+A),C+=A}return C.toLowerCase()},nye=new RegExp("^-?(0*)\\d{1,10}$"),pH=function(t){if(nye.test(t)){const n=Number(t);if(n>=-2147483648&&n<=2147483647)return n}return null},ky=function(t){try{t()}catch(n){setTimeout(()=>{throw ra("Exception was thrown by user callback.",n.stack||""),n},Math.floor(0))}},V0=function(t,n){const e=setTimeout(t,n);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class sye{constructor(n,e){this.appName_=n,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(r=>this.appCheck=r)}getToken(n){return this.appCheck?this.appCheck.getToken(n):new Promise((e,r)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(e,r):e(null)},0)})}addTokenChangeListener(n){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(r=>r.addTokenListener(n))}notifyForInvalidToken(){ra(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class aye{constructor(n,e,r){this.appName_=n,this.firebaseOptions_=e,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(e=>e&&"auth/token-not-initialized"===e.code?(Ds("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,r)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(e,r):e(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(e=>e.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(e=>e.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';n+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ra(n)}}let U0=(()=>{class t{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const vH=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,xH="websocket",EH="long_polling";class d2{constructor(n,e,r,i,o=!1,a="",c=!1,f=!1){this.secure=e,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=f,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=bg.get("host:"+n)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&bg.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function CH(t,n,e){let r;if(dt("string"==typeof n,"typeof type must == string"),dt("object"==typeof e,"typeof params must == object"),n===xH)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(n!==EH)throw new Error("Unknown connection type: "+n);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function lye(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(e.ns=t.namespace);const i=[];return Ts(e,(o,a)=>{i.push(o+"="+a)}),r+i.join("&")}class cye{constructor(){this.counters_={}}incrementCounter(n,e=1){Cd(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=e}get(){return $he(this.counters_)}}const h2={},f2={};function p2(t){const n=t.toString();return h2[n]||(h2[n]=new cye),h2[n]}class dye{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,e){this.closeAfterResponse=n,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,e){for(this.pendingResponses[n]=e;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ky(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Ip{constructor(n,e,r,i,o,a,c){this.connId=n,this.repoInfo=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=a,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=F0(n),this.stats_=p2(e),this.urlFn=f=>(this.appCheckToken&&(f.ac=this.appCheckToken),CH(e,EH,f))}open(n,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new dye(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{let n=!1;const e=function(){document.body?n||(n=!0,t()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new m2((...o)=>{const[a,c,f,_,x]=o;if(this.incrementIncomingBytes_(o),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=c,this.password=f;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_()}},(...o)=>{const[a,c]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,c)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&vH.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ip.forceAllow_=!0}static forceDisallow(){Ip.forceDisallow_=!0}static isAvailable(){return!(!Ip.forceAllow_&&(Ip.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){const e=os(n);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const r=x6(e),i=hH(r,1840);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(n,e){this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=n,r.pw=e,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){const e=os(n).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class m2{constructor(n,e,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=lH(),window["pLPCommand"+this.uniqueCallbackIdentifier]=n,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=m2.createIFrame_();let o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(c){Ds("frame writing exception"),c.stack&&Ds(c.stack),Ds(c)}}}static createIFrame_(){const n=document.createElement("iframe");if(n.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(n);try{n.contentWindow.document||Ds("No IE domain setting required")}catch{const r=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,e){for(this.myID=n,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const n={};n.id=this.myID,n.pw=this.myPW,n.ser=this.currentSerial;let e=this.urlFn(n),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const a=this.pendingSegs.shift();r=r+"&seg"+i+"="+a.seg+"&ts"+i+"="+a.ts+"&d"+i+"="+a.d,i++}return e+=r,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(n,e,r){this.pendingSegs.push({seg:n,ts:e,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(n,e){this.outstandingRequests.add(e);const r=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(n,()=>{clearTimeout(i),r()})}addTag(n,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=n,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=()=>{Ds("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let iD=null;typeof MozWebSocket<"u"?iD=MozWebSocket:typeof WebSocket<"u"&&(iD=WebSocket);let Ay=(()=>{class t{constructor(e,r,i,o,a,c,f){this.connId=e,this.applicationId=i,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=F0(this.connId),this.stats_=p2(r),this.connURL=t.connectionURL_(r,c,f,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,i,o,a){const c={v:"5"};return typeof location<"u"&&location.hostname&&vH.test(location.hostname)&&(c.r="f"),r&&(c.s=r),i&&(c.ls=i),o&&(c.ac=o),a&&(c.p=a),CH(e,xH,c)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,bg.set("previous_websocket_failure",!0);try{let i;0,this.mySock=new iD(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const o=i.message||i.data;return o&&this.log_(o),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&null!==iD&&!t.forceDisallow_}static previouslyFailed(){return bg.isInMemoryStorage||!0===bg.get("previous_websocket_failure")}markConnectionHealthy(){bg.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=_0(r);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(dt(null===this.frames,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const r=os(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=hH(r,16384);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),MH=(()=>{class t{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ip,Ay]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const r=Ay&&Ay.isAvailable();let i=r&&!Ay.previouslyFailed();if(e.webSocketOnly&&(r||ra("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ay];else{const o=this.transports_=[];for(const a of t.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class BH{constructor(n,e,r,i,o,a,c,f,_,x){this.id=n,this.repoInfo_=e,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=a,this.onReady_=c,this.onDisconnect_=f,this.onKill_=_,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=F0("c:"+this.id+":"),this.transportManager_=new MH(e),this.log_("Connection created"),this.start_()}start_(){const n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,r)},Math.floor(0));const i=n.healthyTimeout||0;i>0&&(this.healthyTimeout_=V0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return e=>{n===this.conn_?this.onConnectionLost_(e):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return e=>{2!==this.state_&&(n===this.rx_?this.onPrimaryMessageReceived_(e):n===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(n){this.sendData_({t:"d",d:n})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if("t"in n){const e=n.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){const e=B0("t",n),r=B0("d",n);if("c"===e)this.onSecondaryControl_(r);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){const e=B0("t",n),r=B0("d",n);"c"===e?this.onControl_(r):"d"===e&&this.onDataMessage_(r)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){const e=B0("t",n);if("d"in n){const r=n.d;if("h"===e){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(r):"r"===e?this.onReset_(r):"e"===e?l2("Server Error: "+r):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):l2("Unknown control packet command: "+e)}}onHandshake_(n){const e=n.ts,r=n.v,i=n.h;this.sessionId=n.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==r&&ra("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,r),V0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,e){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):V0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,n||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(bg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(n)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class VH{put(n,e,r,i){}merge(n,e,r,i){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,e,r){}onDisconnectMerge(n,e,r){}onDisconnectCancel(n,e){}reportStats(n){}}class UH{constructor(n){this.allowedEvents_=n,this.listeners_={},dt(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...e){if(Array.isArray(this.listeners_[n])){const r=[...this.listeners_[n]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)}}on(n,e,r){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:e,context:r});const i=this.getInitialEvent(n);i&&e.apply(r,i)}off(n,e,r){this.validateEventType_(n);const i=this.listeners_[n]||[];for(let o=0;o<i.length;o++)if(i[o].callback===e&&(!r||r===i[o].context))return void i.splice(o,1)}validateEventType_(n){dt(this.allowedEvents_.find(e=>e===n),"Unknown event: "+n)}}class oD extends UH{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!kM()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new oD}getInitialEvent(n){return dt("online"===n,"Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}}class Fr{constructor(n,e){if(void 0===e){this.pieces_=n.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=e}toString(){let n="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(n+="/"+this.pieces_[e]);return n||"/"}}function Sr(){return new Fr("")}function qn(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function kp(t){return t.pieces_.length-t.pieceNum_}function oi(t){let n=t.pieceNum_;return n<t.pieces_.length&&n++,new Fr(t.pieces_,n)}function _2(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function z0(t,n=0){return t.pieces_.slice(t.pieceNum_+n)}function HH(t){if(t.pieceNum_>=t.pieces_.length)return null;const n=[];for(let e=t.pieceNum_;e<t.pieces_.length-1;e++)n.push(t.pieces_[e]);return new Fr(n,0)}function Fi(t,n){const e=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)e.push(t.pieces_[r]);if(n instanceof Fr)for(let r=n.pieceNum_;r<n.pieces_.length;r++)e.push(n.pieces_[r]);else{const r=n.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&e.push(r[i])}return new Fr(e,0)}function Gn(t){return t.pieceNum_>=t.pieces_.length}function Ca(t,n){const e=qn(t),r=qn(n);if(null===e)return n;if(e===r)return Ca(oi(t),oi(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")}function Pye(t,n){const e=z0(t,0),r=z0(n,0);for(let i=0;i<e.length&&i<r.length;i++){const o=xg(e[i],r[i]);if(0!==o)return o}return e.length===r.length?0:e.length<r.length?-1:1}function y2(t,n){if(kp(t)!==kp(n))return!1;for(let e=t.pieceNum_,r=n.pieceNum_;e<=t.pieces_.length;e++,r++)if(t.pieces_[e]!==n.pieces_[r])return!1;return!0}function Oc(t,n){let e=t.pieceNum_,r=n.pieceNum_;if(kp(t)>kp(n))return!1;for(;e<t.pieces_.length;){if(t.pieces_[e]!==n.pieces_[r])return!1;++e,++r}return!0}class Nye{constructor(n,e){this.errorPrefix_=e,this.parts_=z0(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=NC(this.parts_[r]);$H(this)}}function $H(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Eg(t))}function Eg(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class v2 extends UH{constructor(){let n,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",n="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",n="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",n="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const r=!document[n];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new v2}getInitialEvent(n){return dt("visible"===n,"Unknown event type: "+n),[this.visible_]}}const j0=1e3;let aD,Cg=(()=>{class t extends VH{constructor(e,r,i,o,a,c,f,_){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=c,this.appCheckTokenProvider_=f,this.authOverride_=_,this.id=t.nextPersistentConnectionId_++,this.log_=F0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=j0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,_)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");v2.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&oD.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,i){const o=++this.requestNumber_,a={r:o,a:e,b:r};this.log_(os(a)),dt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),i&&(this.requestCBHash_[o]=i)}get(e){this.initConnection_();const r=new by,o={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const f=c.d;"ok"===c.s?r.resolve(f):r.reject(f)}};return this.outstandingGets_.push(o),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(e,r,i,o){this.initConnection_();const a=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+a),this.listens.has(c)||this.listens.set(c,new Map),dt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),dt(!this.listens.get(c).has(a),"listen() called twice for same path/queryId.");const f={onComplete:o,hashFn:r,query:e,tag:i};this.listens.get(c).set(a,f),this.connected_&&this.sendListen_(f)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(e){const r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);const a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,f=>{const _=f.d,x=f.s;t.warnOnListenWarnings_(_,r),(this.listens.get(i)&&this.listens.get(i).get(o))===e&&(this.log_("listen response",f),"ok"!==x&&this.removeListen_(i,o),e.onComplete&&e.onComplete(x,_))})}static warnOnListenWarnings_(e,r){if(e&&"object"==typeof e&&Cd(e,"w")){const i=wy(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',a=r._path.toString();ra(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(t){const n=MC(t).claims;return"object"==typeof n&&!0===n.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=function(t){const e=MC(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{const a=o.s,c=o.d||"error";this.authToken_===e&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,i=e.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(e,r){const i=e._path.toString(),o=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),dt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,e._queryObject,r)}sendUnlisten_(e,r,i,o){this.log_("Unlisten on "+e+" for "+r);const a={p:e};o&&(a.q=i,a.t=o),this.sendRequest("n",a)}onDisconnectPut(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:i})}onDisconnectMerge(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:i})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,i,o){const a={p:r,d:i};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,c=>{o&&setTimeout(()=>{o(c.s,c.d)},Math.floor(0))})}put(e,r,i,o){this.putInternal("p",e,r,i,o)}merge(e,r,i,o){this.putInternal("m",e,r,i,o)}putInternal(e,r,i,o,a){this.initConnection_();const c={p:r,d:i};void 0!==a&&(c.h=a),this.outstandingPuts_.push({action:e,request:c,onComplete:o}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,o=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,i,a=>{this.log_(r+" response",a),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+os(e));const r=e.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),"d"===e?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===e?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===e?this.onListenRevoked_(r.p,r.q):"ac"===e?this.onAuthRevoked_(r.s,r.d):"apc"===e?this.onAppCheckRevoked_(r.s,r.d):"sd"===e?this.onSecurityDebugPacket_(r):l2("Unrecognized action received from server: "+os(e)+"\nAre you using the latest client?")}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){dt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=j0,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=j0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=j0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return fe(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),o=e.onRealtimeDisconnect_.bind(e),a=e.id+":"+t.nextConnectionId_++,c=e.lastSessionId;let f=!1,_=null;const x=function(){_?_.close():(f=!0,o())};e.realtime_={close:x,sendRequest:function(N){dt(_,"sendRequest call when we're not connected not allowed."),_.sendRequest(N)}};const A=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[N,U]=yield Promise.all([e.authTokenProvider_.getToken(A),e.appCheckTokenProvider_.getToken(A)]);f?Ds("getToken() completed but was canceled"):(Ds("getToken() completed. Creating connection."),e.authToken_=N&&N.accessToken,e.appCheckToken_=U&&U.token,_=new BH(a,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,o,ne=>{ra(ne+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},c))}catch(N){e.log_("Failed to get token: "+N),f||(e.repoInfo_.nodeAdmin&&ra(N),x())}}})()}interrupt(e){Ds("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ds("Resuming connection for reason: "+e),delete this.interruptReasons_[e],AM(this.interruptReasons_)&&(this.reconnectDelay_=j0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let i;i=r?r.map(a=>c2(a)).join("$"):"default";const o=this.removeListen_(e,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(e,r){const i=new Fr(e).toString();let o;if(this.listens.has(i)){const a=this.listens.get(i);o=a.get(r),a.delete(r),0===a.size&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(e,r){Ds("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){Ds("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+s2.replace(/\./g,"-")]=1,kM()?e["framework.cordova"]=1:k6()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=oD.getInstance().currentlyOnline();return AM(this.interruptReasons_)&&e}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class Xn{constructor(n,e){this.name=n,this.node=e}static Wrap(n,e){return new Xn(n,e)}}class sD{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,e){const r=new Xn(Sp,n),i=new Xn(Sp,e);return 0!==this.compare(r,i)}minPost(){return Xn.MIN}}class WH extends sD{static get __EMPTY_NODE(){return aD}static set __EMPTY_NODE(n){aD=n}compare(n,e){return xg(n.name,e.name)}isDefinedOn(n){throw vy("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,e){return!1}minPost(){return Xn.MIN}maxPost(){return new Xn(Xh,aD)}makePost(n,e){return dt("string"==typeof n,"KeyIndex indexValue must always be a string."),new Xn(n,aD)}toString(){return".key"}}const Sd=new WH;class lD{constructor(n,e,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!n.isEmpty();)if(a=e?r(n.key,e):1,i&&(a*=-1),a<0)n=this.isReverse_?n.left:n.right;else{if(0===a){this.nodeStack_.push(n);break}this.nodeStack_.push(n),n=this.isReverse_?n.right:n.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,n=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}}let w2,wu=(()=>{class t{constructor(e,r,i,o,a){this.key=e,this.value=r,this.color=i??t.RED,this.left=o??ll.EMPTY_NODE,this.right=a??ll.EMPTY_NODE}copy(e,r,i,o,a){return new t(e??this.key,r??this.value,i??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,i){let o=this;const a=i(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,r,i),null):0===a?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return ll.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let i,o;if(i=this,r(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(e,i.key)){if(i.right.isEmpty())return ll.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class ll{constructor(n,e=ll.EMPTY_NODE){this.comparator_=n,this.root_=e}insert(n,e){return new ll(this.comparator_,this.root_.insert(n,e,this.comparator_).copy(null,null,wu.BLACK,null,null))}remove(n){return new ll(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,wu.BLACK,null,null))}get(n){let e,r=this.root_;for(;!r.isEmpty();){if(e=this.comparator_(n,r.key),0===e)return r.value;e<0?r=r.left:e>0&&(r=r.right)}return null}getPredecessorKey(n){let e,r=this.root_,i=null;for(;!r.isEmpty();){if(e=this.comparator_(n,r.key),0===e){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}e<0?r=r.left:e>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new lD(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,e){return new lD(this.root_,n,this.comparator_,!1,e)}getReverseIteratorFrom(n,e){return new lD(this.root_,n,this.comparator_,!0,e)}getReverseIterator(n){return new lD(this.root_,null,this.comparator_,!0,n)}}function jye(t,n){return xg(t.name,n.name)}function b2(t,n){return xg(t,n)}ll.EMPTY_NODE=new class zye{copy(n,e,r,i,o){return this}insert(n,e,r){return new wu(n,e,null)}remove(n,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ZH=function(t){return"number"==typeof t?"number:"+fH(t):"string:"+t},KH=function(t){if(t.isLeafNode()){const n=t.val();dt("string"==typeof n||"number"==typeof n||"object"==typeof n&&Cd(n,".sv"),"Priority must be a string or number.")}else dt(t===w2||t.isEmpty(),"priority of unexpected type.");dt(t===w2||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let YH,XH,QH,My=(()=>{class t{constructor(e,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,dt(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),KH(this.priorityNode_)}static set __childrenNodeConstructor(e){YH=e}static get __childrenNodeConstructor(){return YH}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new t(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Gn(e)?this:".priority"===qn(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return".priority"===e?this.updatePriority(r):r.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const i=qn(e);return null===i?r:r.isEmpty()&&".priority"!==i?this:(dt(".priority"!==i||1===kp(e),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(oi(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ZH(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",e+="number"===r?fH(this.value_):this.value_,this.lazyHash_=cH(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(dt(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,i=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(r),a=t.VALUE_TYPE_ORDER.indexOf(i);return dt(o>=0,"Unknown leaf type: "+r),dt(a>=0,"Unknown leaf type: "+i),o===a?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const hi=new class Gye extends sD{compare(n,e){const r=n.node.getPriority(),i=e.node.getPriority(),o=r.compareTo(i);return 0===o?xg(n.name,e.name):o}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,e){return!n.getPriority().equals(e.getPriority())}minPost(){return Xn.MIN}maxPost(){return new Xn(Xh,new My("[PRIORITY-POST]",QH))}makePost(n,e){const r=XH(n);return new Xn(e,new My("[PRIORITY-POST]",r))}toString(){return".priority"}},Wye=Math.log(2);class Zye{constructor(n){this.count=parseInt(Math.log(n+1)/Wye,10),this.current_=this.count-1;const i=(()=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=n+1&i}nextBitIsOne(){const n=!(this.bits_&1<<this.current_);return this.current_--,n}}const cD=function(t,n,e,r){t.sort(n);const i=function(f,_){const x=_-f;let C,A;if(0===x)return null;if(1===x)return C=t[f],A=e?e(C):C,new wu(A,C.node,wu.BLACK,null,null);{const N=parseInt(x/2,10)+f,U=i(f,N),ne=i(N+1,_);return C=t[N],A=e?e(C):C,new wu(A,C.node,wu.BLACK,U,ne)}},c=function(f){let _=null,x=null,C=t.length;const A=function(U,ne){const ce=C-U,xe=C;C-=U;const Ce=i(ce+1,xe),Ze=t[ce],Se=e?e(Ze):Ze;N(new wu(Se,Ze.node,ne,null,Ce))},N=function(U){_?(_.left=U,_=U):(x=U,_=U)};for(let U=0;U<f.count;++U){const ne=f.nextBitIsOne(),ce=Math.pow(2,f.count-(U+1));ne?A(ce,wu.BLACK):(A(ce,wu.BLACK),A(ce,wu.RED))}return x}(new Zye(t.length));return new ll(r||n,c)};let x2;const Ry={};class Qh{constructor(n,e){this.indexes_=n,this.indexSet_=e}static get Default(){return dt(Ry&&hi,"ChildrenNode.ts has not been loaded"),x2=x2||new Qh({".priority":Ry},{".priority":hi}),x2}get(n){const e=wy(this.indexes_,n);if(!e)throw new Error("No index defined for "+n);return e instanceof ll?e:null}hasIndex(n){return Cd(this.indexSet_,n.toString())}addIndex(n,e){dt(n!==Sd,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=e.getIterator(Xn.Wrap);let c,a=o.getNext();for(;a;)i=i||n.isDefinedOn(a.node),r.push(a),a=o.getNext();c=i?cD(r,n.getCompare()):Ry;const f=n.toString(),_=Object.assign({},this.indexSet_);_[f]=n;const x=Object.assign({},this.indexes_);return x[f]=c,new Qh(x,_)}addToIndexes(n,e){const r=RC(this.indexes_,(i,o)=>{const a=wy(this.indexSet_,o);if(dt(a,"Missing index implementation for "+o),i===Ry){if(a.isDefinedOn(n.node)){const c=[],f=e.getIterator(Xn.Wrap);let _=f.getNext();for(;_;)_.name!==n.name&&c.push(_),_=f.getNext();return c.push(n),cD(c,a.getCompare())}return Ry}{const c=e.get(n.name);let f=i;return c&&(f=f.remove(new Xn(n.name,c))),f.insert(n,n.node)}});return new Qh(r,this.indexSet_)}removeFromIndexes(n,e){const r=RC(this.indexes_,i=>{if(i===Ry)return i;{const o=e.get(n.name);return o?i.remove(new Xn(n.name,o)):i}});return new Qh(r,this.indexSet_)}}let H0,Vn=(()=>{class t{constructor(e,r,i){this.children_=e,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&KH(this.priorityNode_),this.children_.isEmpty()&&dt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return H0||(H0=new t(new ll(b2),null,Qh.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||H0}updatePriority(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const r=this.children_.get(e);return null===r?H0:r}}getChild(e){const r=qn(e);return null===r?this:this.getImmediateChild(r).getChild(oi(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,r){if(dt(r,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(r);{const i=new Xn(e,r);let o,a;r.isEmpty()?(o=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(e,r),a=this.indexMap_.addToIndexes(i,this.children_));const c=o.isEmpty()?H0:this.priorityNode_;return new t(o,c,a)}}updateChild(e,r){const i=qn(e);if(null===i)return r;{dt(".priority"!==qn(e)||1===kp(e),".priority must be the last token in a path");const o=this.getImmediateChild(i).updateChild(oi(e),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let i=0,o=0,a=!0;if(this.forEachChild(hi,(c,f)=>{r[c]=f.val(e),i++,a&&t.INTEGER_REGEXP_.test(c)?o=Math.max(o,Number(c)):a=!1}),!e&&a&&o<2*i){const c=[];for(const f in r)c[f]=r[f];return c}return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ZH(this.getPriority().val())+":"),this.forEachChild(hi,(r,i)=>{const o=i.hash();""!==o&&(e+=":"+r+":"+o)}),this.lazyHash_=""===e?"":cH(e)}return this.lazyHash_}getPredecessorChildName(e,r,i){const o=this.resolveIndex_(i);if(o){const a=o.getPredecessorKey(new Xn(e,r));return a?a.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new Xn(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new Xn(r,this.children_.get(r)):null}forEachChild(e,r){const i=this.resolveIndex_(e);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(e,o=>o);{const o=this.children_.getIteratorFrom(e.name,Xn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,e)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(e,o=>o);{const o=this.children_.getReverseIteratorFrom(e.name,Xn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,e)>0;)o.getNext(),a=o.peek();return o}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===$0?-1:0}withIndex(e){if(e===Sd||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===Sd||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(hi),o=r.getIterator(hi);let a=i.getNext(),c=o.getNext();for(;a&&c;){if(a.name!==c.name||!a.node.equals(c.node))return!1;a=i.getNext(),c=o.getNext()}return null===a&&null===c}return!1}return!1}}resolveIndex_(e){return e===Sd?null:this.indexMap_.get(e.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const $0=new class Kye extends Vn{constructor(){super(new ll(b2),Vn.EMPTY_NODE,Qh.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return Vn.EMPTY_NODE}isEmpty(){return!1}};function to(t,n=null){if(null===t)return Vn.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),dt(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+typeof n),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new My(t,to(n));if(t instanceof Array){let e=Vn.EMPTY_NODE;return Ts(t,(r,i)=>{if(Cd(t,r)&&"."!==r.substring(0,1)){const o=to(i);(o.isLeafNode()||!o.isEmpty())&&(e=e.updateImmediateChild(r,o))}}),e.updatePriority(to(n))}{const e=[];let r=!1;if(Ts(t,(a,c)=>{if("."!==a.substring(0,1)){const f=to(c);f.isEmpty()||(r=r||!f.getPriority().isEmpty(),e.push(new Xn(a,f)))}}),0===e.length)return Vn.EMPTY_NODE;const o=cD(e,jye,a=>a.name,b2);if(r){const a=cD(e,hi.getCompare());return new Vn(o,to(n),new Qh({".priority":a},{".priority":hi}))}return new Vn(o,to(n),Qh.Default)}}Object.defineProperties(Xn,{MIN:{value:new Xn(Sp,Vn.EMPTY_NODE)},MAX:{value:new Xn(Xh,$0)}}),WH.__EMPTY_NODE=Vn.EMPTY_NODE,My.__childrenNodeConstructor=Vn,function Hye(t){w2=t}($0),function qye(t){QH=t}($0),function $ye(t){XH=t}(to);class E2 extends sD{constructor(n){super(),this.indexPath_=n,dt(!Gn(n)&&".priority"!==qn(n),"Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,e){const r=this.extractChild(n.node),i=this.extractChild(e.node),o=r.compareTo(i);return 0===o?xg(n.name,e.name):o}makePost(n,e){const r=to(n),i=Vn.EMPTY_NODE.updateChild(this.indexPath_,r);return new Xn(e,i)}maxPost(){const n=Vn.EMPTY_NODE.updateChild(this.indexPath_,$0);return new Xn(Xh,n)}toString(){return z0(this.indexPath_,0).join("/")}}const C2=new class Xye extends sD{compare(n,e){const r=n.node.compareTo(e.node);return 0===r?xg(n.name,e.name):r}isDefinedOn(n){return!0}indexedValueChanged(n,e){return!n.equals(e)}minPost(){return Xn.MIN}maxPost(){return Xn.MAX}makePost(n,e){const r=to(n);return new Xn(e,r)}toString(){return".value"}};function JH(t){return{type:"value",snapshotNode:t}}function Py(t,n){return{type:"child_added",snapshotNode:n,childName:t}}function q0(t,n){return{type:"child_removed",snapshotNode:n,childName:t}}function G0(t,n,e){return{type:"child_changed",snapshotNode:n,childName:t,oldSnap:e}}class D2{constructor(n){this.index_=n}updateChild(n,e,r,i,o,a){dt(n.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=n.getImmediateChild(e);return c.getChild(i).equals(r.getChild(i))&&c.isEmpty()===r.isEmpty()||(null!=a&&(r.isEmpty()?n.hasChild(e)?a.trackChildChange(q0(e,c)):dt(n.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?a.trackChildChange(Py(e,r)):a.trackChildChange(G0(e,r,c))),n.isLeafNode()&&r.isEmpty())?n:n.updateImmediateChild(e,r).withIndex(this.index_)}updateFullNode(n,e,r){return null!=r&&(n.isLeafNode()||n.forEachChild(hi,(i,o)=>{e.hasChild(i)||r.trackChildChange(q0(i,o))}),e.isLeafNode()||e.forEachChild(hi,(i,o)=>{if(n.hasChild(i)){const a=n.getImmediateChild(i);a.equals(o)||r.trackChildChange(G0(i,o,a))}else r.trackChildChange(Py(i,o))})),e.withIndex(this.index_)}updatePriority(n,e){return n.isEmpty()?Vn.EMPTY_NODE:n.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class W0{constructor(n){this.indexedFilter_=new D2(n.getIndex()),this.index_=n.getIndex(),this.startPost_=W0.getStartPost_(n),this.endPost_=W0.getEndPost_(n),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(n){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),n)<=0:this.index_.compare(this.getStartPost(),n)<0,r=this.endIsInclusive_?this.index_.compare(n,this.getEndPost())<=0:this.index_.compare(n,this.getEndPost())<0;return e&&r}updateChild(n,e,r,i,o,a){return this.matches(new Xn(e,r))||(r=Vn.EMPTY_NODE),this.indexedFilter_.updateChild(n,e,r,i,o,a)}updateFullNode(n,e,r){e.isLeafNode()&&(e=Vn.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(Vn.EMPTY_NODE);const o=this;return e.forEachChild(hi,(a,c)=>{o.matches(new Xn(a,c))||(i=i.updateImmediateChild(a,Vn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(n,i,r)}updatePriority(n,e){return n}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(n){if(n.hasStart()){const e=n.getIndexStartName();return n.getIndex().makePost(n.getIndexStartValue(),e)}return n.getIndex().minPost()}static getEndPost_(n){if(n.hasEnd()){const e=n.getIndexEndName();return n.getIndex().makePost(n.getIndexEndValue(),e)}return n.getIndex().maxPost()}}class Jye{constructor(n){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=e=>{const r=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new W0(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft(),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}updateChild(n,e,r,i,o,a){return this.rangedFilter_.matches(new Xn(e,r))||(r=Vn.EMPTY_NODE),n.getImmediateChild(e).equals(r)?n:n.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(n,e,r,i,o,a):this.fullLimitUpdateChild_(n,e,r,o,a)}updateFullNode(n,e,r){let i;if(e.isLeafNode()||e.isEmpty())i=Vn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let o;i=Vn.EMPTY_NODE.withIndex(this.index_),o=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const c=o.getNext();if(this.withinDirectionalStart(c)){if(!this.withinDirectionalEnd(c))break;i=i.updateImmediateChild(c.name,c.node),a++}}}else{let o;i=e.withIndex(this.index_),i=i.updatePriority(Vn.EMPTY_NODE),o=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let a=0;for(;o.hasNext();){const c=o.getNext();a<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?a++:i=i.updateImmediateChild(c.name,Vn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(n,i,r)}updatePriority(n,e){return n}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(n,e,r,i,o){let a;if(this.reverse_){const C=this.index_.getCompare();a=(A,N)=>C(N,A)}else a=this.index_.getCompare();const c=n;dt(c.numChildren()===this.limit_,"");const f=new Xn(e,r),_=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),x=this.rangedFilter_.matches(f);if(c.hasChild(e)){const C=c.getImmediateChild(e);let A=i.getChildAfterChild(this.index_,_,this.reverse_);for(;null!=A&&(A.name===e||c.hasChild(A.name));)A=i.getChildAfterChild(this.index_,A,this.reverse_);const N=null==A?1:a(A,f);if(x&&!r.isEmpty()&&N>=0)return o?.trackChildChange(G0(e,r,C)),c.updateImmediateChild(e,r);{o?.trackChildChange(q0(e,C));const ne=c.updateImmediateChild(e,Vn.EMPTY_NODE);return null!=A&&this.rangedFilter_.matches(A)?(o?.trackChildChange(Py(A.name,A.node)),ne.updateImmediateChild(A.name,A.node)):ne}}return r.isEmpty()?n:x&&a(_,f)>=0?(null!=o&&(o.trackChildChange(q0(_.name,_.node)),o.trackChildChange(Py(e,r))),c.updateImmediateChild(e,r).updateImmediateChild(_.name,Vn.EMPTY_NODE)):n}}class T2{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=hi}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return dt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return dt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Sp}hasEnd(){return this.endSet_}getIndexEndValue(){return dt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return dt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xh}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return dt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===hi}copy(){const n=new T2;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.startAfterSet_=this.startAfterSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.endBeforeSet_=this.endBeforeSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}}function e$(t){const n={};if(t.isDefault())return n;let e;if(t.index_===hi?e="$priority":t.index_===C2?e="$value":t.index_===Sd?e="$key":(dt(t.index_ instanceof E2,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=os(e),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";n[r]=os(t.indexStartValue_),t.startNameSet_&&(n[r]+=","+os(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";n[r]=os(t.indexEndValue_),t.endNameSet_&&(n[r]+=","+os(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_),n}function t$(t){const n={};if(t.startSet_&&(n.sp=t.indexStartValue_,t.startNameSet_&&(n.sn=t.indexStartName_),n.sin=!t.startAfterSet_),t.endSet_&&(n.ep=t.indexEndValue_,t.endNameSet_&&(n.en=t.indexEndName_),n.ein=!t.endBeforeSet_),t.limitSet_){n.l=t.limit_;let e=t.viewFrom_;""===e&&(e=t.isViewFromLeft()?"l":"r"),n.vf=e}return t.index_!==hi&&(n.i=t.index_.toString()),n}class dD extends VH{constructor(n,e,r,i){super(),this.repoInfo_=n,this.onDataUpdate_=e,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=F0("p:rest:"),this.listens_={}}reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,e){return void 0!==e?"tag$"+e:(dt(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}listen(n,e,r,i){const o=n._path.toString();this.log_("Listen called for "+o+" "+n._queryIdentifier);const a=dD.getListenId_(n,r),c={};this.listens_[a]=c;const f=e$(n._queryParams);this.restRequest_(o+".json",f,(_,x)=>{let C=x;if(404===_&&(C=null,_=null),null===_&&this.onDataUpdate_(o,C,!1,r),wy(this.listens_,a)===c){let A;A=_?401===_?"permission_denied":"rest_error:"+_:"ok",i(A,null)}})}unlisten(n,e){const r=dD.getListenId_(n,e);delete this.listens_[r]}get(n){const e=e$(n._queryParams),r=n._path.toString(),i=new by;return this.restRequest_(r+".json",e,(o,a)=>{let c=a;404===o&&(c=null,o=null),null===o?(this.onDataUpdate_(r,c,!1,null),i.resolve(c)):i.reject(new Error(c))}),i.promise}refreshAuthToken(n){}restRequest_(n,e={},r){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(e.auth=i.accessToken),o&&o.token&&(e.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+xy(e);this.log_("Sending REST request for "+a);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(r&&4===c.readyState){this.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);let f=null;if(c.status>=200&&c.status<300){try{f=_0(c.responseText)}catch{ra("Failed to parse JSON response for "+a+": "+c.responseText)}r(null,f)}else 401!==c.status&&404!==c.status&&ra("Got unsuccessful REST response for "+a+" Status: "+c.status),r(c.status);r=null}},c.open("GET",a,!0),c.send()})}}class ove{constructor(){this.rootNode_=Vn.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,e){this.rootNode_=this.rootNode_.updateChild(n,e)}}function hD(){return{value:null,children:new Map}}function Ny(t,n,e){if(Gn(n))t.value=e,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(n,e);else{const r=qn(n);t.children.has(r)||t.children.set(r,hD()),Ny(t.children.get(r),n=oi(n),e)}}function A2(t,n,e){null!==t.value?e(n,t.value):function sve(t,n){t.children.forEach((e,r)=>{n(r,e)})}(t,(r,i)=>{A2(i,new Fr(n.toString()+"/"+r),e)})}class ave{constructor(n){this.collection_=n,this.last_=null}get(){const n=this.collection_.get(),e=Object.assign({},n);return this.last_&&Ts(this.last_,(r,i)=>{e[r]=e[r]-i}),this.last_=n,e}}class uve{constructor(n,e){this.server_=e,this.statsToReport_={},this.statsListener_=new ave(n);const r=1e4+2e4*Math.random();V0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const n=this.statsListener_.get(),e={};let r=!1;Ts(n,(i,o)=>{o>0&&Cd(this.statsToReport_,i)&&(e[i]=o,r=!0)}),r&&this.server_.reportStats(e),V0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Id=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Id||{});function P2(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class fD{constructor(n,e,r){this.path=n,this.affectedTree=e,this.revert=r,this.type=Id.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(n){if(Gn(this.path)){if(null!=this.affectedTree.value)return dt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new Fr(n));return new fD(Sr(),e,this.revert)}}return dt(qn(this.path)===n,"operationForChild called for unrelated child."),new fD(oi(this.path),this.affectedTree,this.revert)}}class Z0{constructor(n,e){this.source=n,this.path=e,this.type=Id.LISTEN_COMPLETE}operationForChild(n){return Gn(this.path)?new Z0(this.source,Sr()):new Z0(this.source,oi(this.path))}}class Dg{constructor(n,e,r){this.source=n,this.path=e,this.snap=r,this.type=Id.OVERWRITE}operationForChild(n){return Gn(this.path)?new Dg(this.source,Sr(),this.snap.getImmediateChild(n)):new Dg(this.source,oi(this.path),this.snap)}}class Oy{constructor(n,e,r){this.source=n,this.path=e,this.children=r,this.type=Id.MERGE}operationForChild(n){if(Gn(this.path)){const e=this.children.subtree(new Fr(n));return e.isEmpty()?null:e.value?new Dg(this.source,Sr(),e.value):new Oy(this.source,Sr(),e)}return dt(qn(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new Oy(this.source,oi(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ap{constructor(n,e,r){this.node_=n,this.fullyInitialized_=e,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(Gn(n))return this.isFullyInitialized()&&!this.filtered_;const e=qn(n);return this.isCompleteForChild(e)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}}class dve{constructor(n){this.query_=n,this.index_=this.query_._queryParams.getIndex()}}function K0(t,n,e,r,i,o){const a=r.filter(c=>c.type===e);a.sort((c,f)=>function pve(t,n,e){if(null==n.childName||null==e.childName)throw vy("Should only compare child_ events.");const r=new Xn(n.childName,n.snapshotNode),i=new Xn(e.childName,e.snapshotNode);return t.index_.compare(r,i)}(t,c,f)),a.forEach(c=>{const f=function fve(t,n,e){return"value"===n.type||"child_removed"===n.type||(n.prevName=e.getPredecessorChildName(n.childName,n.snapshotNode,t.index_)),n}(t,c,o);i.forEach(_=>{_.respondsTo(c.type)&&n.push(_.createEvent(f,t.query_))})})}function pD(t,n){return{eventCache:t,serverCache:n}}function Y0(t,n,e,r){return pD(new Ap(n,e,r),t.serverCache)}function r$(t,n,e,r){return pD(t.eventCache,new Ap(n,e,r))}function mD(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Tg(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let N2;class fi{constructor(n,e=(()=>(N2||(N2=new ll(Q_e)),N2))()){this.value=n,this.children=e}static fromObject(n){let e=new fi(null);return Ts(n,(r,i)=>{e=e.set(new Fr(r),i)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,e){if(null!=this.value&&e(this.value))return{path:Sr(),value:this.value};if(Gn(n))return null;{const r=qn(n),i=this.children.get(r);if(null!==i){const o=i.findRootMostMatchingPathAndValue(oi(n),e);return null!=o?{path:Fi(new Fr(r),o.path),value:o.value}:null}return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(Gn(n))return this;{const e=qn(n),r=this.children.get(e);return null!==r?r.subtree(oi(n)):new fi(null)}}set(n,e){if(Gn(n))return new fi(e,this.children);{const r=qn(n),o=(this.children.get(r)||new fi(null)).set(oi(n),e),a=this.children.insert(r,o);return new fi(this.value,a)}}remove(n){if(Gn(n))return this.children.isEmpty()?new fi(null):new fi(null,this.children);{const e=qn(n),r=this.children.get(e);if(r){const i=r.remove(oi(n));let o;return o=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&o.isEmpty()?new fi(null):new fi(this.value,o)}return this}}get(n){if(Gn(n))return this.value;{const e=qn(n),r=this.children.get(e);return r?r.get(oi(n)):null}}setTree(n,e){if(Gn(n))return e;{const r=qn(n),o=(this.children.get(r)||new fi(null)).setTree(oi(n),e);let a;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new fi(this.value,a)}}fold(n){return this.fold_(Sr(),n)}fold_(n,e){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Fi(n,i),e)}),e(n,this.value,r)}findOnPath(n,e){return this.findOnPath_(n,Sr(),e)}findOnPath_(n,e,r){const i=!!this.value&&r(e,this.value);if(i)return i;if(Gn(n))return null;{const o=qn(n),a=this.children.get(o);return a?a.findOnPath_(oi(n),Fi(e,o),r):null}}foreachOnPath(n,e){return this.foreachOnPath_(n,Sr(),e)}foreachOnPath_(n,e,r){if(Gn(n))return this;{this.value&&r(e,this.value);const i=qn(n),o=this.children.get(i);return o?o.foreachOnPath_(oi(n),Fi(e,i),r):new fi(null)}}foreach(n){this.foreach_(Sr(),n)}foreach_(n,e){this.children.inorderTraversal((r,i)=>{i.foreach_(Fi(n,r),e)}),this.value&&e(n,this.value)}foreachChild(n){this.children.inorderTraversal((e,r)=>{r.value&&n(e,r.value)})}}class xu{constructor(n){this.writeTree_=n}static empty(){return new xu(new fi(null))}}function X0(t,n,e){if(Gn(n))return new xu(new fi(e));{const r=t.writeTree_.findRootMostValueAndPath(n);if(null!=r){const i=r.path;let o=r.value;const a=Ca(i,n);return o=o.updateChild(a,e),new xu(t.writeTree_.set(i,o))}{const i=new fi(e),o=t.writeTree_.setTree(n,i);return new xu(o)}}}function O2(t,n,e){let r=t;return Ts(e,(i,o)=>{r=X0(r,Fi(n,i),o)}),r}function i$(t,n){if(Gn(n))return xu.empty();{const e=t.writeTree_.setTree(n,new fi(null));return new xu(e)}}function L2(t,n){return null!=Sg(t,n)}function Sg(t,n){const e=t.writeTree_.findRootMostValueAndPath(n);return null!=e?t.writeTree_.get(e.path).getChild(Ca(e.path,n)):null}function o$(t){const n=[],e=t.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(hi,(r,i)=>{n.push(new Xn(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&n.push(new Xn(r,i.value))}),n}function Mp(t,n){if(Gn(n))return t;{const e=Sg(t,n);return new xu(null!=e?new fi(e):t.writeTree_.subtree(n))}}function F2(t){return t.writeTree_.isEmpty()}function Ly(t,n){return s$(Sr(),t.writeTree_,n)}function s$(t,n,e){if(null!=n.value)return e.updateChild(t,n.value);{let r=null;return n.children.inorderTraversal((i,o)=>{".priority"===i?(dt(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):e=s$(Fi(t,i),o,e)}),!e.getChild(t).isEmpty()&&null!==r&&(e=e.updateChild(Fi(t,".priority"),r)),e}}function gD(t,n){return d$(n,t)}function bve(t,n){if(t.snap)return Oc(t.path,n);for(const e in t.children)if(t.children.hasOwnProperty(e)&&Oc(Fi(t.path,e),n))return!0;return!1}function xve(t){return t.visible}function a$(t,n,e){let r=xu.empty();for(let i=0;i<t.length;++i){const o=t[i];if(n(o)){const a=o.path;let c;if(o.snap)Oc(e,a)?(c=Ca(e,a),r=X0(r,c,o.snap)):Oc(a,e)&&(c=Ca(a,e),r=X0(r,Sr(),o.snap.getChild(c)));else{if(!o.children)throw vy("WriteRecord should have .snap or .children");if(Oc(e,a))c=Ca(e,a),r=O2(r,c,o.children);else if(Oc(a,e))if(c=Ca(a,e),Gn(c))r=O2(r,Sr(),o.children);else{const f=wy(o.children,qn(c));if(f){const _=f.getChild(oi(c));r=X0(r,Sr(),_)}}}}}return r}function l$(t,n,e,r,i){if(r||i){const o=Mp(t.visibleWrites,n);return!i&&F2(o)?e:i||null!=e||L2(o,Sr())?Ly(a$(t.allWrites,function(_){return(_.visible||i)&&(!r||!~r.indexOf(_.writeId))&&(Oc(_.path,n)||Oc(n,_.path))},n),e||Vn.EMPTY_NODE):null}{const o=Sg(t.visibleWrites,n);if(null!=o)return o;{const a=Mp(t.visibleWrites,n);return F2(a)?e:null!=e||L2(a,Sr())?Ly(a,e||Vn.EMPTY_NODE):null}}}function _D(t,n,e,r){return l$(t.writeTree,t.treePath,n,e,r)}function B2(t,n){return function Eve(t,n,e){let r=Vn.EMPTY_NODE;const i=Sg(t.visibleWrites,n);if(i)return i.isLeafNode()||i.forEachChild(hi,(o,a)=>{r=r.updateImmediateChild(o,a)}),r;if(e){const o=Mp(t.visibleWrites,n);return e.forEachChild(hi,(a,c)=>{const f=Ly(Mp(o,new Fr(a)),c);r=r.updateImmediateChild(a,f)}),o$(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}return o$(Mp(t.visibleWrites,n)).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}(t.writeTree,t.treePath,n)}function c$(t,n,e,r){return function Cve(t,n,e,r,i){dt(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Fi(n,e);if(L2(t.visibleWrites,o))return null;{const a=Mp(t.visibleWrites,o);return F2(a)?i.getChild(e):Ly(a,i.getChild(e))}}(t.writeTree,t.treePath,n,e,r)}function yD(t,n){return function Tve(t,n){return Sg(t.visibleWrites,n)}(t.writeTree,Fi(t.treePath,n))}function V2(t,n,e){return function Dve(t,n,e,r){const i=Fi(n,e),o=Sg(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(e)?Ly(Mp(t.visibleWrites,i),r.getNode().getImmediateChild(e)):null}(t.writeTree,t.treePath,n,e)}function u$(t,n){return d$(Fi(t.treePath,n),t.writeTree)}function d$(t,n){return{treePath:t,writeTree:n}}class Ave{constructor(){this.changeMap=new Map}trackChildChange(n){const e=n.type,r=n.childName;dt("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),dt(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if("child_added"===e&&"child_removed"===o)this.changeMap.set(r,G0(r,n.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===o)this.changeMap.delete(r);else if("child_removed"===e&&"child_changed"===o)this.changeMap.set(r,q0(r,i.oldSnap));else if("child_changed"===e&&"child_added"===o)this.changeMap.set(r,Py(r,n.snapshotNode));else{if("child_changed"!==e||"child_changed"!==o)throw vy("Illegal combination of changes: "+n+" occurred after "+i);this.changeMap.set(r,G0(r,n.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,n)}getChanges(){return Array.from(this.changeMap.values())}}const h$=new class Mve{getCompleteChild(n){return null}getChildAfterChild(n,e,r){return null}};class U2{constructor(n,e,r=null){this.writes_=n,this.viewCache_=e,this.optCompleteServerCache_=r}getCompleteChild(n){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(n))return e.getNode().getImmediateChild(n);{const r=null!=this.optCompleteServerCache_?new Ap(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return V2(this.writes_,n,r)}}getChildAfterChild(n,e,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Tg(this.viewCache_),o=function kve(t,n,e,r,i,o){return function Sve(t,n,e,r,i,o,a){let c;const f=Mp(t.visibleWrites,n),_=Sg(f,Sr());if(null!=_)c=_;else{if(null==e)return[];c=Ly(f,e)}if(c=c.withIndex(a),c.isEmpty()||c.isLeafNode())return[];{const x=[],C=a.getCompare(),A=o?c.getReverseIteratorFrom(r,a):c.getIteratorFrom(r,a);let N=A.getNext();for(;N&&x.length<i;)0!==C(N,r)&&x.push(N),N=A.getNext();return x}}(t.writeTree,t.treePath,n,e,r,i,o)}(this.writes_,i,e,1,r,n);return 0===o.length?null:o[0]}}function f$(t,n,e,r,i,o){const a=n.eventCache;if(null!=yD(r,e))return n;{let c,f;if(Gn(e))if(dt(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const _=Tg(n),C=B2(r,_ instanceof Vn?_:Vn.EMPTY_NODE);c=t.filter.updateFullNode(n.eventCache.getNode(),C,o)}else{const _=_D(r,Tg(n));c=t.filter.updateFullNode(n.eventCache.getNode(),_,o)}else{const _=qn(e);if(".priority"===_){dt(1===kp(e),"Can't have a priority with additional path components");const x=a.getNode();f=n.serverCache.getNode();const C=c$(r,e,x,f);c=null!=C?t.filter.updatePriority(x,C):a.getNode()}else{const x=oi(e);let C;if(a.isCompleteForChild(_)){f=n.serverCache.getNode();const A=c$(r,e,a.getNode(),f);C=null!=A?a.getNode().getImmediateChild(_).updateChild(x,A):a.getNode().getImmediateChild(_)}else C=V2(r,_,n.serverCache);c=null!=C?t.filter.updateChild(a.getNode(),_,C,x,i,o):a.getNode()}}return Y0(n,c,a.isFullyInitialized()||Gn(e),t.filter.filtersNodes())}}function vD(t,n,e,r,i,o,a,c){const f=n.serverCache;let _;const x=a?t.filter:t.filter.getIndexedFilter();if(Gn(e))_=x.updateFullNode(f.getNode(),r,null);else if(x.filtersNodes()&&!f.isFiltered()){const N=f.getNode().updateChild(e,r);_=x.updateFullNode(f.getNode(),N,null)}else{const N=qn(e);if(!f.isCompleteForPath(e)&&kp(e)>1)return n;const U=oi(e),ce=f.getNode().getImmediateChild(N).updateChild(U,r);_=".priority"===N?x.updatePriority(f.getNode(),ce):x.updateChild(f.getNode(),N,ce,U,h$,null)}const C=r$(n,_,f.isFullyInitialized()||Gn(e),x.filtersNodes());return f$(t,C,e,i,new U2(i,C,o),c)}function z2(t,n,e,r,i,o,a){const c=n.eventCache;let f,_;const x=new U2(i,n,o);if(Gn(e))_=t.filter.updateFullNode(n.eventCache.getNode(),r,a),f=Y0(n,_,!0,t.filter.filtersNodes());else{const C=qn(e);if(".priority"===C)_=t.filter.updatePriority(n.eventCache.getNode(),r),f=Y0(n,_,c.isFullyInitialized(),c.isFiltered());else{const A=oi(e),N=c.getNode().getImmediateChild(C);let U;if(Gn(A))U=r;else{const ne=x.getCompleteChild(C);U=null!=ne?".priority"===_2(A)&&ne.getChild(HH(A)).isEmpty()?ne:ne.updateChild(A,r):Vn.EMPTY_NODE}f=N.equals(U)?n:Y0(n,t.filter.updateChild(c.getNode(),C,U,A,x,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return f}function p$(t,n){return t.eventCache.isCompleteForChild(n)}function m$(t,n,e){return e.foreach((r,i)=>{n=n.updateChild(r,i)}),n}function j2(t,n,e,r,i,o,a,c){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let _,f=n;_=Gn(e)?r:new fi(null).setTree(e,r);const x=n.serverCache.getNode();return _.children.inorderTraversal((C,A)=>{if(x.hasChild(C)){const U=m$(0,n.serverCache.getNode().getImmediateChild(C),A);f=vD(t,f,new Fr(C),U,i,o,a,c)}}),_.children.inorderTraversal((C,A)=>{const N=!n.serverCache.isCompleteForChild(C)&&null===A.value;if(!x.hasChild(C)&&!N){const ne=m$(0,n.serverCache.getNode().getImmediateChild(C),A);f=vD(t,f,new Fr(C),ne,i,o,a,c)}}),f}class Uve{constructor(n,e){this.query_=n,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new D2(r.getIndex()),o=function eve(t){return t.loadsAllData()?new D2(t.getIndex()):t.hasLimit()?new Jye(t):new W0(t)}(r);this.processor_=function Rve(t){return{filter:t}}(o);const a=e.serverCache,c=e.eventCache,f=i.updateFullNode(Vn.EMPTY_NODE,a.getNode(),null),_=o.updateFullNode(Vn.EMPTY_NODE,c.getNode(),null),x=new Ap(f,a.isFullyInitialized(),i.filtersNodes()),C=new Ap(_,c.isFullyInitialized(),o.filtersNodes());this.viewCache_=pD(C,x),this.eventGenerator_=new dve(this.query_)}get query(){return this.query_}}function Hve(t,n){const e=Tg(t.viewCache_);return e&&(t.query._queryParams.loadsAllData()||!Gn(n)&&!e.getImmediateChild(qn(n)).isEmpty())?e.getChild(n):null}function g$(t){return 0===t.eventRegistrations_.length}function _$(t,n,e){const r=[];if(e){dt(null==n,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(e,i);a&&r.push(a)})}if(n){let i=[];for(let o=0;o<t.eventRegistrations_.length;++o){const a=t.eventRegistrations_[o];if(a.matches(n)){if(n.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(o+1));break}}else i.push(a)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function y$(t,n,e,r){n.type===Id.MERGE&&null!==n.source.queryId&&(dt(Tg(t.viewCache_),"We should always have a full cache before handling merges"),dt(mD(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,o=function Nve(t,n,e,r,i){const o=new Ave;let a,c;if(e.type===Id.OVERWRITE){const _=e;_.source.fromUser?a=z2(t,n,_.path,_.snap,r,i,o):(dt(_.source.fromServer,"Unknown source."),c=_.source.tagged||n.serverCache.isFiltered()&&!Gn(_.path),a=vD(t,n,_.path,_.snap,r,i,c,o))}else if(e.type===Id.MERGE){const _=e;_.source.fromUser?a=function Lve(t,n,e,r,i,o,a){let c=n;return r.foreach((f,_)=>{const x=Fi(e,f);p$(n,qn(x))&&(c=z2(t,c,x,_,i,o,a))}),r.foreach((f,_)=>{const x=Fi(e,f);p$(n,qn(x))||(c=z2(t,c,x,_,i,o,a))}),c}(t,n,_.path,_.children,r,i,o):(dt(_.source.fromServer,"Unknown source."),c=_.source.tagged||n.serverCache.isFiltered(),a=j2(t,n,_.path,_.children,r,i,c,o))}else if(e.type===Id.ACK_USER_WRITE){const _=e;a=_.revert?function Vve(t,n,e,r,i,o){let a;if(null!=yD(r,e))return n;{const c=new U2(r,n,i),f=n.eventCache.getNode();let _;if(Gn(e)||".priority"===qn(e)){let x;if(n.serverCache.isFullyInitialized())x=_D(r,Tg(n));else{const C=n.serverCache.getNode();dt(C instanceof Vn,"serverChildren would be complete if leaf node"),x=B2(r,C)}_=t.filter.updateFullNode(f,x,o)}else{const x=qn(e);let C=V2(r,x,n.serverCache);null==C&&n.serverCache.isCompleteForChild(x)&&(C=f.getImmediateChild(x)),_=null!=C?t.filter.updateChild(f,x,C,oi(e),c,o):n.eventCache.getNode().hasChild(x)?t.filter.updateChild(f,x,Vn.EMPTY_NODE,oi(e),c,o):f,_.isEmpty()&&n.serverCache.isFullyInitialized()&&(a=_D(r,Tg(n)),a.isLeafNode()&&(_=t.filter.updateFullNode(_,a,o)))}return a=n.serverCache.isFullyInitialized()||null!=yD(r,Sr()),Y0(n,_,a,t.filter.filtersNodes())}}(t,n,_.path,r,i,o):function Fve(t,n,e,r,i,o,a){if(null!=yD(i,e))return n;const c=n.serverCache.isFiltered(),f=n.serverCache;if(null!=r.value){if(Gn(e)&&f.isFullyInitialized()||f.isCompleteForPath(e))return vD(t,n,e,f.getNode().getChild(e),i,o,c,a);if(Gn(e)){let _=new fi(null);return f.getNode().forEachChild(Sd,(x,C)=>{_=_.set(new Fr(x),C)}),j2(t,n,e,_,i,o,c,a)}return n}{let _=new fi(null);return r.foreach((x,C)=>{const A=Fi(e,x);f.isCompleteForPath(A)&&(_=_.set(x,f.getNode().getChild(A)))}),j2(t,n,e,_,i,o,c,a)}}(t,n,_.path,_.affectedTree,r,i,o)}else{if(e.type!==Id.LISTEN_COMPLETE)throw vy("Unknown operation type: "+e.type);a=function Bve(t,n,e,r,i){const o=n.serverCache;return f$(t,r$(n,o.getNode(),o.isFullyInitialized()||Gn(e),o.isFiltered()),e,r,h$,i)}(t,n,e.path,r,o)}const f=o.getChanges();return function Ove(t,n,e){const r=n.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=mD(t);(e.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&e.push(JH(mD(n)))}}(n,a,f),{viewCache:a,changes:f}}(t.processor_,i,n,e,r);return function Pve(t,n){dt(n.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),dt(n.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,o.viewCache),dt(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,v$(t,o.changes,o.viewCache.eventCache.getNode(),null)}function v$(t,n,e,r){return function hve(t,n,e,r){const i=[],o=[];return n.forEach(a=>{"child_changed"===a.type&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(function Qye(t,n){return{type:"child_moved",snapshotNode:n,childName:t}}(a.childName,a.snapshotNode))}),K0(t,i,"child_removed",n,r,e),K0(t,i,"child_added",n,r,e),K0(t,i,"child_moved",o,r,e),K0(t,i,"child_changed",n,r,e),K0(t,i,"value",n,r,e),i}(t.eventGenerator_,n,e,r?[r]:t.eventRegistrations_)}let bD,xD;class b${constructor(){this.views=new Map}}function H2(t,n,e,r){const i=n.source.queryId;if(null!==i){const o=t.views.get(i);return dt(null!=o,"SyncTree gave us an op for an invalid query."),y$(o,n,e,r)}{let o=[];for(const a of t.views.values())o=o.concat(y$(a,n,e,r));return o}}function w$(t,n,e,r,i){const a=t.views.get(n._queryIdentifier);if(!a){let c=_D(e,i?r:null),f=!1;c?f=!0:r instanceof Vn?(c=B2(e,r),f=!1):(c=Vn.EMPTY_NODE,f=!1);const _=pD(new Ap(c,f,!1),new Ap(r,i,!1));return new Uve(n,_)}return a}function x$(t){const n=[];for(const e of t.views.values())e.query._queryParams.loadsAllData()||n.push(e);return n}function Rp(t,n){let e=null;for(const r of t.views.values())e=e||Hve(r,n);return e}function E$(t,n){return n._queryParams.loadsAllData()?wD(t):t.views.get(n._queryIdentifier)}function C$(t,n){return null!=E$(t,n)}function Pp(t){return null!=wD(t)}function wD(t){for(const n of t.views.values())if(n.query._queryParams.loadsAllData())return n;return null}let Jve=1;class D${constructor(n){this.listenProvider_=n,this.syncPointTree_=new fi(null),this.pendingWriteTree_=function Ive(){return{visibleWrites:xu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $2(t,n,e,r,i){return function gve(t,n,e,r,i){dt(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:n,snap:e,writeId:r,visible:i}),i&&(t.visibleWrites=X0(t.visibleWrites,n,e)),t.lastWriteId=r}(t.pendingWriteTree_,n,e,r,i),i?Fy(t,new Dg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,e)):[]}function Np(t,n,e=!1){const r=function yve(t,n){for(let e=0;e<t.allWrites.length;e++){const r=t.allWrites[e];if(r.writeId===n)return r}return null}(t.pendingWriteTree_,n);if(function vve(t,n){const e=t.allWrites.findIndex(c=>c.writeId===n);dt(e>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[e];t.allWrites.splice(e,1);let i=r.visible,o=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const c=t.allWrites[a];c.visible&&(a>=e&&bve(c,r.path)?i=!1:Oc(r.path,c.path)&&(o=!0)),a--}return!!i&&(o?(function wve(t){t.visibleWrites=a$(t.allWrites,xve,Sr()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=i$(t.visibleWrites,r.path):Ts(r.children,f=>{t.visibleWrites=i$(t.visibleWrites,Fi(r.path,f))}),!0))}(t.pendingWriteTree_,n)){let o=new fi(null);return null!=r.snap?o=o.set(Sr(),!0):Ts(r.children,a=>{o=o.set(new Fr(a),!0)}),Fy(t,new fD(r.path,o,e))}return[]}function Q0(t,n,e){return Fy(t,new Dg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,e))}function ED(t,n,e,r,i=!1){const o=n._path,a=t.syncPointTree_.get(o);let c=[];if(a&&("default"===n._queryIdentifier||C$(a,n))){const f=function Yve(t,n,e,r){const i=n._queryIdentifier,o=[];let a=[];const c=Pp(t);if("default"===i)for(const[f,_]of t.views.entries())a=a.concat(_$(_,e,r)),g$(_)&&(t.views.delete(f),_.query._queryParams.loadsAllData()||o.push(_.query));else{const f=t.views.get(i);f&&(a=a.concat(_$(f,e,r)),g$(f)&&(t.views.delete(i),f.query._queryParams.loadsAllData()||o.push(f.query)))}return c&&!Pp(t)&&o.push(new(function Wve(){return dt(bD,"Reference.ts has not been loaded"),bD}())(n._repo,n._path)),{removed:o,events:a}}(a,n,e,r);(function Zve(t){return 0===t.views.size})(a)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const _=f.removed;if(c=f.events,!i){const x=-1!==_.findIndex(A=>A._queryParams.loadsAllData()),C=t.syncPointTree_.findOnPath(o,(A,N)=>Pp(N));if(x&&!C){const A=t.syncPointTree_.subtree(o);if(!A.isEmpty()){const N=function sbe(t){return t.fold((n,e,r)=>{if(e&&Pp(e))return[wD(e)];{let i=[];return e&&(i=x$(e)),Ts(r,(o,a)=>{i=i.concat(a)}),i}})}(A);for(let U=0;U<N.length;++U){const ne=N[U],ce=ne.query,xe=k$(t,ne);t.listenProvider_.startListening(ew(ce),J0(t,ce),xe.hashFn,xe.onComplete)}}}!C&&_.length>0&&!r&&(x?t.listenProvider_.stopListening(ew(n),null):_.forEach(A=>{const N=t.queryToTagMap.get(DD(A));t.listenProvider_.stopListening(ew(A),N)}))}!function abe(t,n){for(let e=0;e<n.length;++e){const r=n[e];if(!r._queryParams.loadsAllData()){const i=DD(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,_)}return c}function T$(t,n,e,r){const i=G2(t,r);if(null!=i){const o=W2(i),a=o.path,c=o.queryId,f=Ca(a,n);return Z2(t,a,new Dg(P2(c),f,e))}return[]}function q2(t,n,e,r=!1){const i=n._path;let o=null,a=!1;t.syncPointTree_.foreachOnPath(i,(A,N)=>{const U=Ca(A,i);o=o||Rp(N,U),a=a||Pp(N)});let f,c=t.syncPointTree_.get(i);c?(a=a||Pp(c),o=o||Rp(c,Sr())):(c=new b$,t.syncPointTree_=t.syncPointTree_.set(i,c)),null!=o?f=!0:(f=!1,o=Vn.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((N,U)=>{const ne=Rp(U,Sr());ne&&(o=o.updateImmediateChild(N,ne))}));const _=C$(c,n);if(!_&&!n._queryParams.loadsAllData()){const A=DD(n);dt(!t.queryToTagMap.has(A),"View does not exist, but we have a tag");const N=function lbe(){return Jve++}();t.queryToTagMap.set(A,N),t.tagToQueryMap.set(N,A)}let C=function Kve(t,n,e,r,i,o){const a=w$(t,n,r,i,o);return t.views.has(n._queryIdentifier)||t.views.set(n._queryIdentifier,a),function $ve(t,n){t.eventRegistrations_.push(n)}(a,e),function qve(t,n){const e=t.viewCache_.eventCache,r=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(hi,(o,a)=>{r.push(Py(o,a))}),e.isFullyInitialized()&&r.push(JH(e.getNode())),v$(t,r,e.getNode(),n)}(a,e)}(c,n,e,gD(t.pendingWriteTree_,i),o,f);if(!_&&!a&&!r){const A=E$(c,n);C=C.concat(function cbe(t,n,e){const r=n._path,i=J0(t,n),o=k$(t,e),a=t.listenProvider_.startListening(ew(n),i,o.hashFn,o.onComplete),c=t.syncPointTree_.subtree(r);if(i)dt(!Pp(c.value),"If we're adding a query, it shouldn't be shadowed");else{const f=c.fold((_,x,C)=>{if(!Gn(_)&&x&&Pp(x))return[wD(x).query];{let A=[];return x&&(A=A.concat(x$(x).map(N=>N.query))),Ts(C,(N,U)=>{A=A.concat(U)}),A}});for(let _=0;_<f.length;++_){const x=f[_];t.listenProvider_.stopListening(ew(x),J0(t,x))}}return a}(t,n,A))}return C}function CD(t,n,e){const i=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(n,(a,c)=>{const _=Rp(c,Ca(a,n));if(_)return _});return l$(i,n,o,e,!0)}function Fy(t,n){return S$(n,t.syncPointTree_,null,gD(t.pendingWriteTree_,Sr()))}function S$(t,n,e,r){if(Gn(t.path))return I$(t,n,e,r);{const i=n.get(Sr());null==e&&null!=i&&(e=Rp(i,Sr()));let o=[];const a=qn(t.path),c=t.operationForChild(a),f=n.children.get(a);if(f&&c){const _=e?e.getImmediateChild(a):null,x=u$(r,a);o=o.concat(S$(c,f,_,x))}return i&&(o=o.concat(H2(i,t,r,e))),o}}function I$(t,n,e,r){const i=n.get(Sr());null==e&&null!=i&&(e=Rp(i,Sr()));let o=[];return n.children.inorderTraversal((a,c)=>{const f=e?e.getImmediateChild(a):null,_=u$(r,a),x=t.operationForChild(a);x&&(o=o.concat(I$(x,c,f,_)))}),i&&(o=o.concat(H2(i,t,r,e))),o}function k$(t,n){const e=n.query,r=J0(t,e);return{hashFn:()=>(function zve(t){return t.viewCache_.serverCache.getNode()}(n)||Vn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function rbe(t,n,e){const r=G2(t,e);if(r){const i=W2(r),o=i.path,a=i.queryId,c=Ca(o,n);return Z2(t,o,new Z0(P2(a),c))}return[]}(t,e._path,r):function nbe(t,n){return Fy(t,new Z0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n))}(t,e._path);{const o=function tye(t,n){let e="Unknown Error";"too_big"===t?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?e="Client doesn't have permission to access the desired data.":"unavailable"===t&&(e="The service is unavailable");const r=new Error(t+" at "+n._path.toString()+": "+e);return r.code=t.toUpperCase(),r}(i,e);return ED(t,e,null,o)}}}}function J0(t,n){const e=DD(n);return t.queryToTagMap.get(e)}function DD(t){return t._path.toString()+"$"+t._queryIdentifier}function G2(t,n){return t.tagToQueryMap.get(n)}function W2(t){const n=t.indexOf("$");return dt(-1!==n&&n<t.length-1,"Bad queryKey."),{queryId:t.substr(n+1),path:new Fr(t.substr(0,n))}}function Z2(t,n,e){const r=t.syncPointTree_.get(n);return dt(r,"Missing sync point for query tag that we're tracking"),H2(r,e,gD(t.pendingWriteTree_,n),null)}function ew(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function Qve(){return dt(xD,"Reference.ts has not been loaded"),xD}())(t._repo,t._path):t}class K2{constructor(n){this.node_=n}getImmediateChild(n){const e=this.node_.getImmediateChild(n);return new K2(e)}node(){return this.node_}}class Y2{constructor(n,e){this.syncTree_=n,this.path_=e}getImmediateChild(n){const e=Fi(this.path_,n);return new Y2(this.syncTree_,e)}node(){return CD(this.syncTree_,this.path_)}}const A$=function(t,n,e){return t&&"object"==typeof t?(dt(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?dbe(t[".sv"],n,e):"object"==typeof t[".sv"]?hbe(t[".sv"],n):void dt(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},dbe=function(t,n,e){if("timestamp"===t)return e.timestamp;dt(!1,"Unexpected server value: "+t)},hbe=function(t,n,e){t.hasOwnProperty("increment")||dt(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&dt(!1,"Unexpected increment value: "+r);const i=n.node();if(dt(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const a=i.getValue();return"number"!=typeof a?r:a+r},M$=function(t,n,e,r){return Q2(n,new Y2(e,t),r)},X2=function(t,n,e){return Q2(t,new K2(n),e)};function Q2(t,n,e){const r=t.getPriority().val(),i=A$(r,n.getImmediateChild(".priority"),e);let o;if(t.isLeafNode()){const a=t,c=A$(a.getValue(),n,e);return c!==a.getValue()||i!==a.getPriority().val()?new My(c,to(i)):t}{const a=t;return o=a,i!==a.getPriority().val()&&(o=o.updatePriority(new My(i))),a.forEachChild(hi,(c,f)=>{const _=Q2(f,n.getImmediateChild(c),e);_!==f&&(o=o.updateImmediateChild(c,_))}),o}}class J2{constructor(n="",e=null,r={children:{},childCount:0}){this.name=n,this.parent=e,this.node=r}}function TD(t,n){let e=n instanceof Fr?n:new Fr(n),r=t,i=qn(e);for(;null!==i;){const o=wy(r.node.children,i)||{children:{},childCount:0};r=new J2(i,r,o),e=oi(e),i=qn(e)}return r}function Ig(t){return t.node.value}function eN(t,n){t.node.value=n,tN(t)}function R$(t){return t.node.childCount>0}function SD(t,n){Ts(t.node.children,(e,r)=>{n(new J2(e,t,r))})}function P$(t,n,e,r){e&&!r&&n(t),SD(t,i=>{P$(i,n,!0,r)}),e&&r&&n(t)}function tw(t){return new Fr(null===t.parent?t.name:tw(t.parent)+"/"+t.name)}function tN(t){null!==t.parent&&function mbe(t,n,e){const r=function fbe(t){return void 0===Ig(t)&&!R$(t)}(e),i=Cd(t.node.children,n);r&&i?(delete t.node.children[n],t.node.childCount--,tN(t)):!r&&!i&&(t.node.children[n]=e.node,t.node.childCount++,tN(t))}(t.parent,t.name,t)}const gbe=/[\[\].#$\/\u0000-\u001F\u007F]/,_be=/[\[\].#$\u0000-\u001F\u007F]/,nN=10485760,ID=function(t){return"string"==typeof t&&0!==t.length&&!gbe.test(t)},N$=function(t){return"string"==typeof t&&0!==t.length&&!_be.test(t)},kd=function(t,n,e,r){r&&void 0===n||rw(fg(t,"value"),n,e)},rw=function(t,n,e){const r=e instanceof Fr?new Nye(e,t):e;if(void 0===n)throw new Error(t+"contains undefined "+Eg(r));if("function"==typeof n)throw new Error(t+"contains a function "+Eg(r)+" with contents = "+n.toString());if(nD(n))throw new Error(t+"contains "+n.toString()+" "+Eg(r));if("string"==typeof n&&n.length>nN/3&&NC(n)>nN)throw new Error(t+"contains a string greater than "+nN+" utf8 bytes "+Eg(r)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){let i=!1,o=!1;if(Ts(n,(a,c)=>{if(".value"===a)i=!0;else if(".priority"!==a&&".sv"!==a&&(o=!0,!ID(a)))throw new Error(t+" contains an invalid key ("+a+") "+Eg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Oye(t,n){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(n),t.byteLength_+=NC(n),$H(t)})(r,a),rw(t,c,r),function Lye(t){const n=t.parts_.pop();t.byteLength_-=NC(n),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&o)throw new Error(t+' contains ".value" child '+Eg(r)+" in addition to actual children.")}},O$=function(t,n,e,r){if(r&&void 0===n)return;const i=fg(t,"values");if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(i+" must be an object containing the children to replace.");const o=[];Ts(n,(a,c)=>{const f=new Fr(a);if(rw(i,c,Fi(e,f)),".priority"===_2(f)&&!function(t){return null===t||"string"==typeof t||"number"==typeof t&&!nD(t)||t&&"object"==typeof t&&Cd(t,".sv")}(c))throw new Error(i+"contains an invalid value for '"+f.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(f)}),function(t,n){let e,r;for(e=0;e<n.length;e++){r=n[e];const o=z0(r);for(let a=0;a<o.length;a++)if((".priority"!==o[a]||a!==o.length-1)&&!ID(o[a]))throw new Error(t+"contains an invalid key ("+o[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(Pye);let i=null;for(e=0;e<n.length;e++){if(r=n[e],null!==i&&Oc(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,o)},iN=function(t,n,e,r){if(!(r&&void 0===e||N$(e)))throw new Error(fg(t,n)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ad=function(t,n){if(".info"===qn(n))throw new Error(t+" failed = Can't modify data under /.info/")};class wbe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function kD(t,n){let e=null;for(let r=0;r<n.length;r++){const i=n[r],o=i.getPath();null!==e&&!y2(o,e.path)&&(t.eventLists_.push(e),e=null),null===e&&(e={events:[],path:o}),e.events.push(i)}e&&t.eventLists_.push(e)}function F$(t,n,e){kD(t,e),B$(t,r=>y2(r,n))}function Vl(t,n,e){kD(t,e),B$(t,r=>Oc(r,n)||Oc(n,r))}function B$(t,n){t.recursionDepth_++;let e=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(n(i.path)?(xbe(t.eventLists_[r]),t.eventLists_[r]=null):e=!1)}e&&(t.eventLists_=[]),t.recursionDepth_--}function xbe(t){for(let n=0;n<t.events.length;n++){const e=t.events[n];if(null!==e){t.events[n]=null;const r=e.getEventRunner();wg&&Ds("event: "+e.toString()),ky(r)}}}class Cbe{constructor(n,e,r,i){this.repoInfo_=n,this.forceRestClient_=e,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new wbe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=hD(),this.transactionQueueTree_=new J2,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function U$(t){const e=t.infoData_.getNode(new Fr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function ow(t){return function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t}({timestamp:U$(t)})}function z$(t,n,e,r,i){t.dataUpdateCount++;const o=new Fr(n);e=t.interceptServerDataCallback_?t.interceptServerDataCallback_(n,e):e;let a=[];if(i)if(r){const f=RC(e,_=>to(_));a=function ibe(t,n,e,r){const i=G2(t,r);if(i){const o=W2(i),a=o.path,c=o.queryId,f=Ca(a,n),_=fi.fromObject(e);return Z2(t,a,new Oy(P2(c),f,_))}return[]}(t.serverSyncTree_,o,f,i)}else{const f=to(e);a=T$(t.serverSyncTree_,o,f,i)}else if(r){const f=RC(e,_=>to(_));a=function tbe(t,n,e){const r=fi.fromObject(e);return Fy(t,new Oy({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,r))}(t.serverSyncTree_,o,f)}else{const f=to(e);a=Q0(t.serverSyncTree_,o,f)}let c=o;a.length>0&&(c=Vy(t,o)),Vl(t.eventQueue_,c,a)}function j$(t,n){oN(t,"connected",n),!1===n&&function kbe(t){By(t,"onDisconnectEvents");const n=ow(t),e=hD();A2(t.onDisconnect_,Sr(),(i,o)=>{const a=M$(i,o,t.serverSyncTree_,n);Ny(e,i,a)});let r=[];A2(e,Sr(),(i,o)=>{r=r.concat(Q0(t.serverSyncTree_,i,o));const a=cN(t,i);Vy(t,a)}),t.onDisconnect_=hD(),Vl(t.eventQueue_,Sr(),r)}(t)}function oN(t,n,e){const r=new Fr("/.info/"+n),i=to(e);t.infoData_.updateSnapshot(r,i);const o=Q0(t.infoSyncTree_,r,i);Vl(t.eventQueue_,r,o)}function AD(t){return t.nextWriteId_++}function aN(t,n,e){let r;r=".info"===qn(n._path)?ED(t.infoSyncTree_,n,e):ED(t.serverSyncTree_,n,e),F$(t.eventQueue_,n._path,r)}function By(t,...n){let e="";t.persistentConnection_&&(e=t.persistentConnection_.id+":"),Ds(e,...n)}function Op(t,n,e,r){n&&ky(()=>{if("ok"===e)n(null);else{const i=(e||"error").toUpperCase();let o=i;r&&(o+=": "+r);const a=new Error(o);a.code=i,n(a)}})}function lN(t,n,e){return CD(t.serverSyncTree_,n,e)||Vn.EMPTY_NODE}function MD(t,n=t.transactionQueueTree_){if(n||RD(t,n),Ig(n)){const e=G$(t,n);dt(e.length>0,"Sending zero length transaction queue"),e.every(i=>0===i.status)&&function Lbe(t,n,e){const r=e.map(_=>_.currentWriteId),i=lN(t,n,r);let o=i;const a=i.hash();for(let _=0;_<e.length;_++){const x=e[_];dt(0===x.status,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const C=Ca(n,x.path);o=o.updateChild(C,x.currentOutputSnapshotRaw)}const c=o.val(!0),f=n;t.server_.put(f.toString(),c,_=>{By(t,"transaction put response",{path:f.toString(),status:_});let x=[];if("ok"===_){const C=[];for(let A=0;A<e.length;A++)e[A].status=2,x=x.concat(Np(t.serverSyncTree_,e[A].currentWriteId)),e[A].onComplete&&C.push(()=>e[A].onComplete(null,!0,e[A].currentOutputSnapshotResolved)),e[A].unwatcher();RD(t,TD(t.transactionQueueTree_,n)),MD(t,t.transactionQueueTree_),Vl(t.eventQueue_,n,x);for(let A=0;A<C.length;A++)ky(C[A])}else{if("datastale"===_)for(let C=0;C<e.length;C++)e[C].status=3===e[C].status?4:0;else{ra("transaction at "+f.toString()+" failed: "+_);for(let C=0;C<e.length;C++)e[C].status=4,e[C].abortReason=_}Vy(t,n)}},a)}(t,tw(n),e)}else R$(n)&&SD(n,e=>{MD(t,e)})}function Vy(t,n){const e=q$(t,n),r=tw(e);return function Fbe(t,n,e){if(0===n.length)return;const r=[];let i=[];const a=n.filter(c=>0===c.status).map(c=>c.currentWriteId);for(let c=0;c<n.length;c++){const f=n[c],_=Ca(e,f.path);let C,x=!1;if(dt(null!==_,"rerunTransactionsUnderNode_: relativePath should not be null."),4===f.status)x=!0,C=f.abortReason,i=i.concat(Np(t.serverSyncTree_,f.currentWriteId,!0));else if(0===f.status)if(f.retryCount>=25)x=!0,C="maxretry",i=i.concat(Np(t.serverSyncTree_,f.currentWriteId,!0));else{const A=lN(t,f.path,a);f.currentInputSnapshot=A;const N=n[c].update(A.val());if(void 0!==N){rw("transaction failed: Data returned ",N,f.path);let U=to(N);"object"==typeof N&&null!=N&&Cd(N,".priority")||(U=U.updatePriority(A.getPriority()));const ce=f.currentWriteId,xe=ow(t),Ce=X2(U,A,xe);f.currentOutputSnapshotRaw=U,f.currentOutputSnapshotResolved=Ce,f.currentWriteId=AD(t),a.splice(a.indexOf(ce),1),i=i.concat($2(t.serverSyncTree_,f.path,Ce,f.currentWriteId,f.applyLocally)),i=i.concat(Np(t.serverSyncTree_,ce,!0))}else x=!0,C="nodata",i=i.concat(Np(t.serverSyncTree_,f.currentWriteId,!0))}Vl(t.eventQueue_,e,i),i=[],x&&(n[c].status=2,function(A){setTimeout(A,Math.floor(0))}(n[c].unwatcher),n[c].onComplete&&r.push("nodata"===C?()=>n[c].onComplete(null,!1,n[c].currentInputSnapshot):()=>n[c].onComplete(new Error(C),!1,null)))}RD(t,t.transactionQueueTree_);for(let c=0;c<r.length;c++)ky(r[c]);MD(t,t.transactionQueueTree_)}(t,G$(t,e),r),r}function q$(t,n){let e,r=t.transactionQueueTree_;for(e=qn(n);null!==e&&void 0===Ig(r);)r=TD(r,e),e=qn(n=oi(n));return r}function G$(t,n){const e=[];return W$(t,n,e),e.sort((r,i)=>r.order-i.order),e}function W$(t,n,e){const r=Ig(n);if(r)for(let i=0;i<r.length;i++)e.push(r[i]);SD(n,i=>{W$(t,i,e)})}function RD(t,n){const e=Ig(n);if(e){let r=0;for(let i=0;i<e.length;i++)2!==e[i].status&&(e[r]=e[i],r++);e.length=r,eN(n,e.length>0?e:void 0)}SD(n,r=>{RD(t,r)})}function cN(t,n){const e=tw(q$(t,n)),r=TD(t.transactionQueueTree_,n);return function pbe(t,n,e){let r=e?t:t.parent;for(;null!==r;){if(n(r))return!0;r=r.parent}}(r,i=>{uN(t,i)}),uN(t,r),P$(r,i=>{uN(t,i)}),e}function uN(t,n){const e=Ig(n);if(e){const r=[];let i=[],o=-1;for(let a=0;a<e.length;a++)3===e[a].status||(1===e[a].status?(dt(o===a-1,"All SENT items should be at beginning of queue."),o=a,e[a].status=3,e[a].abortReason="set"):(dt(0===e[a].status,"Unexpected transaction status in abort"),e[a].unwatcher(),i=i.concat(Np(t.serverSyncTree_,e[a].currentWriteId,!0)),e[a].onComplete&&r.push(e[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?eN(n,void 0):e.length=o+1,Vl(t.eventQueue_,tw(n),i);for(let a=0;a<r.length;a++)ky(r[a])}}const dN=function(t,n){const e=Ube(t),r=e.namespace;return"firebase.com"===e.domain&&Td(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==e.domain&&Td("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ra("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new d2(e.host,e.secure,r,"ws"===e.scheme||"wss"===e.scheme,n,"",r!==e.subdomain),path:new Fr(e.pathString)}},Ube=function(t){let n="",e="",r="",i="",o="",a=!0,c="https",f=443;if("string"==typeof t){let _=t.indexOf("//");_>=0&&(c=t.substring(0,_-1),t=t.substring(_+2));let x=t.indexOf("/");-1===x&&(x=t.length);let C=t.indexOf("?");-1===C&&(C=t.length),n=t.substring(0,Math.min(x,C)),x<C&&(i=function Bbe(t){let n="";const e=t.split("/");for(let r=0;r<e.length;r++)if(e[r].length>0){let i=e[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}n+="/"+i}return n}(t.substring(x,C)));const A=function Vbe(t){const n={};"?"===t.charAt(0)&&(t=t.substring(1));for(const e of t.split("&")){if(0===e.length)continue;const r=e.split("=");2===r.length?n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ra(`Invalid query segment '${e}' in query '${t}'`)}return n}(t.substring(Math.min(t.length,C)));_=n.indexOf(":"),_>=0?(a="https"===c||"wss"===c,f=parseInt(n.substring(_+1),10)):_=n.length;const N=n.slice(0,_);if("localhost"===N.toLowerCase())e="localhost";else if(N.split(".").length<=2)e=N;else{const U=n.indexOf(".");r=n.substring(0,U).toLowerCase(),e=n.substring(U+1),o=r}"ns"in A&&(o=A.ns)}return{host:n,port:f,domain:e,subdomain:r,secure:a,scheme:c,pathString:i,namespace:o}},Z$="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",zbe=function(){let t=0;const n=[];return function(e){const r=e===t;let i;t=e;const o=new Array(8);for(i=7;i>=0;i--)o[i]=Z$.charAt(e%64),e=Math.floor(e/64);dt(0===e,"Cannot push at time == 0");let a=o.join("");if(r){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=Z$.charAt(n[i]);return dt(20===a.length,"nextPushId: Length should be 20."),a}}();class K${constructor(n,e,r,i){this.eventType=n,this.eventRegistration=e,this.snapshot=r,this.prevName=i}getPath(){const n=this.snapshot.ref;return"value"===this.eventType?n._path:n.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+os(this.snapshot.exportVal())}}class Y${constructor(n,e,r){this.eventRegistration=n,this.error=e,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class hN{constructor(n,e){this.snapshotCallback=n,this.cancelCallback=e}onValue(n,e){this.snapshotCallback.call(null,n,e)}onCancel(n){return dt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,n)}get hasCancelCallback(){return!!this.cancelCallback}matches(n){return this.snapshotCallback===n.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===n.snapshotCallback.userCallback&&this.snapshotCallback.context===n.snapshotCallback.context}}class Ul{constructor(n,e,r,i){this._repo=n,this._path=e,this._queryParams=r,this._orderByCalled=i}get key(){return Gn(this._path)?null:_2(this._path)}get ref(){return new Eu(this._repo,this._path)}get _queryIdentifier(){const n=t$(this._queryParams),e=c2(n);return"{}"===e?"default":e}get _queryObject(){return t$(this._queryParams)}isEqual(n){if(!((n=Po(n))instanceof Ul))return!1;const e=this._repo===n._repo,r=y2(this._path,n._path);return e&&r&&this._queryIdentifier===n._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Rye(t){let n="";for(let e=t.pieceNum_;e<t.pieces_.length;e++)""!==t.pieces_[e]&&(n+="/"+encodeURIComponent(String(t.pieces_[e])));return n||"/"}(this._path)}}class Eu extends Ul{constructor(n,e){super(n,e,new T2,!1)}get parent(){const n=HH(this._path);return null===n?null:new Eu(this._repo,n)}get root(){let n=this;for(;null!==n.parent;)n=n.parent;return n}}class kg{constructor(n,e,r){this._node=n,this.ref=e,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(n){const e=new Fr(n),r=Uy(this.ref,n);return new kg(this._node.getChild(e),r,hi)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>n(new kg(i,Uy(this.ref,r),hi)))}hasChild(n){const e=new Fr(n);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Tn(t,n){return(t=Po(t))._checkNotDeleted("ref"),void 0!==n?Uy(t._root,n):t._root}function Uy(t,n){return null===qn((t=Po(t))._path)?((e=n)&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),iN("child","path",e,!1)):iN("child","path",n,!1),new Eu(t._repo,Fi(t._path,n));var e}function Jh(t,n){t=Po(t),Ad("push",t._path),kd("push",n,t._path,!0);const e=U$(t._repo),r=zbe(e),i=Uy(t,r),o=Uy(t,r);let a;return a=null!=n?Cu(o,n).then(()=>o):Promise.resolve(o),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function ef(t){return Ad("remove",t._path),Cu(t,null)}function Cu(t,n){t=Po(t),Ad("set",t._path),kd("set",n,t._path,!1);const e=new by;return function sN(t,n,e,r,i){By(t,"set",{path:n.toString(),value:e,priority:r});const o=ow(t),a=to(e,r),c=CD(t.serverSyncTree_,n),f=X2(a,c,o),_=AD(t),x=$2(t.serverSyncTree_,n,f,_,!0);kD(t.eventQueue_,x),t.server_.put(n.toString(),a.val(!0),(A,N)=>{const U="ok"===A;U||ra("set at "+n+" failed: "+A);const ne=Np(t.serverSyncTree_,_,!U);Vl(t.eventQueue_,n,ne),Op(0,i,A,N)});const C=cN(t,n);Vy(t,C),Vl(t.eventQueue_,C,[])}(t._repo,t._path,n,null,e.wrapCallback(()=>{})),e.promise}function Md(t,n){O$("update",n,t._path,!1);const e=new by;return function Ibe(t,n,e,r){By(t,"update",{path:n.toString(),value:e});let i=!0;const o=ow(t),a={};if(Ts(e,(c,f)=>{i=!1,a[c]=M$(Fi(n,c),to(f),t.serverSyncTree_,o)}),i)Ds("update() called with empty data.  Don't do anything."),Op(0,r,"ok",void 0);else{const c=AD(t),f=function ebe(t,n,e,r){!function _ve(t,n,e,r){dt(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:n,children:e,writeId:r,visible:!0}),t.visibleWrites=O2(t.visibleWrites,n,e),t.lastWriteId=r}(t.pendingWriteTree_,n,e,r);const i=fi.fromObject(e);return Fy(t,new Oy({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,i))}(t.serverSyncTree_,n,a,c);kD(t.eventQueue_,f),t.server_.merge(n.toString(),e,(_,x)=>{const C="ok"===_;C||ra("update at "+n+" failed: "+_);const A=Np(t.serverSyncTree_,c,!C),N=A.length>0?Vy(t,n):n;Vl(t.eventQueue_,N,A),Op(0,r,_,x)}),Ts(e,_=>{const x=cN(t,Fi(n,_));Vy(t,x)}),Vl(t.eventQueue_,n,[])}}(t._repo,t._path,n,e.wrapCallback(()=>{})),e.promise}function tf(t){t=Po(t);const n=new hN(()=>{}),e=new sw(n);return function Sbe(t,n,e){const r=function obe(t,n){const e=n._path;let r=null;t.syncPointTree_.foreachOnPath(e,(_,x)=>{const C=Ca(_,e);r=r||Rp(x,C)});let i=t.syncPointTree_.get(e);i?r=r||Rp(i,Sr()):(i=new b$,t.syncPointTree_=t.syncPointTree_.set(e,i));const o=null!=r,a=o?new Ap(r,!0,!1):null;return function jve(t){return mD(t.viewCache_)}(w$(i,n,gD(t.pendingWriteTree_,n._path),o?a.getNode():Vn.EMPTY_NODE,o))}(t.serverSyncTree_,n);return null!=r?Promise.resolve(r):t.server_.get(n).then(i=>{const o=to(i).withIndex(n._queryParams.getIndex());let a;if(q2(t.serverSyncTree_,n,e,!0),n._queryParams.loadsAllData())a=Q0(t.serverSyncTree_,n._path,o);else{const c=J0(t.serverSyncTree_,n);a=T$(t.serverSyncTree_,n._path,o,c)}return Vl(t.eventQueue_,n._path,a),ED(t.serverSyncTree_,n,e,null,!0),o},i=>(By(t,"get for query "+os(n)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,e).then(r=>new kg(r,new Eu(t._repo,t._path),t._queryParams.getIndex()))}class sw{constructor(n){this.callbackContext=n}respondsTo(n){return"value"===n}createEvent(n,e){const r=e._queryParams.getIndex();return new K$("value",this,new kg(n.snapshotNode,new Eu(e._repo,e._path),r))}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,null)}createCancelEvent(n,e){return this.callbackContext.hasCancelCallback?new Y$(this,n,e):null}matches(n){return n instanceof sw&&(!n.callbackContext||!this.callbackContext||n.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class OD{constructor(n,e){this.eventType=n,this.callbackContext=e}respondsTo(n){let e="children_added"===n?"child_added":n;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(n,e){return this.callbackContext.hasCancelCallback?new Y$(this,n,e):null}createEvent(n,e){dt(null!=n.childName,"Child events should have a childName.");const r=Uy(new Eu(e._repo,e._path),n.childName),i=e._queryParams.getIndex();return new K$(n.type,this,new kg(n.snapshotNode,r,i),n.prevName)}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,n.prevName)}matches(n){return n instanceof OD&&this.eventType===n.eventType&&(!this.callbackContext||!n.callbackContext||this.callbackContext.matches(n.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Rd(t,n,e,r){return function aw(t,n,e,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const f=e,_=(x,C)=>{aN(t._repo,t,c),f(x,C)};_.userCallback=e.userCallback,_.context=e.context,e=_}const a=new hN(e,o||void 0),c="value"===n?new sw(a):new OD(n,a);return function Pbe(t,n,e){let r;r=".info"===qn(n._path)?q2(t.infoSyncTree_,n,e):q2(t.serverSyncTree_,n,e),F$(t.eventQueue_,n._path,r)}(t._repo,t,c),()=>aN(t._repo,t,c)}(t,"value",n,e,r)}function LD(t,n,e){let r=null;const i=e?new hN(e):null;"value"===n?r=new sw(i):n&&(r=new OD(n,i)),aN(t._repo,t,r)}class Du{}class Gbe extends Du{constructor(n){super(),this._limit=n,this.type="limitToLast"}_apply(n){if(n._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ul(n._repo,n._path,function nve(t,n){const e=t.copy();return e.limitSet_=!0,e.limit_=n,e.viewFrom_="r",e}(n._queryParams,this._limit),n._orderByCalled)}}(function Gve(t){dt(!bD,"__referenceConstructor has already been defined"),bD=t})(Eu),function Xve(t){dt(!xD,"__referenceConstructor has already been defined"),xD=t}(Eu);const fN={};function eq(t,n,e,r,i){let o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||Td("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ds("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let f,_,a=dN(o,i),c=a.repoInfo;typeof process<"u"&&process.env&&(_=process.env.FIREBASE_DATABASE_EMULATOR_HOST),_?(f=!0,o=`http://${_}?ns=${c.namespace}`,a=dN(o,i),c=a.repoInfo):f=!a.repoInfo.secure;const x=i&&f?new U0(U0.OWNER):new aye(t.name,t.options,n);(function(t,n){const e=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!ID(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==e.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),N$(t)}(e))throw new Error(fg(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),Gn(a.path)||Td("Database URL must point to the root of a Firebase Database (not including a child path).");const C=function r0e(t,n,e,r){let i=fN[n.name];i||(i={},fN[n.name]=i);let o=i[t.toURLString()];return o&&Td("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Cbe(t,false,e,r),i[t.toURLString()]=o,o}(c,t,x,new sye(t.name,e));return new o0e(C,t)}class o0e{constructor(n,e){this._repoInternal=n,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Dbe(t,n,e){if(t.stats_=p2(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new dD(t.repoInfo_,(r,i,o,a)=>{z$(t,r,i,o,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>j$(t,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{os(e)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Cg(t.repoInfo_,n,(r,i,o,a)=>{z$(t,r,i,o,a)},r=>{j$(t,r)},r=>{!function Tbe(t,n){Ts(n,(e,r)=>{oN(t,e,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,e),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function uye(t,n){const e=t.toString();return f2[e]||(f2[e]=n()),f2[e]}(t.repoInfo_,()=>new uve(t.stats_,t.server_)),t.infoData_=new ove,t.infoSyncTree_=new D$({startListening:(r,i,o,a)=>{let c=[];const f=t.infoData_.getNode(r._path);return f.isEmpty()||(c=Q0(t.infoSyncTree_,r._path,f),setTimeout(()=>{a("ok")},0)),c},stopListening:()=>{}}),oN(t,"connected",!1),t.serverSyncTree_=new D$({startListening:(r,i,o,a)=>(t.server_.listen(r,o,i,(c,f)=>{const _=a(c,f);Vl(t.eventQueue_,r._path,_)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Eu(this._repo,Sr())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function n0e(t,n){const e=fN[n];(!e||e[t.key]!==t)&&Td(`Database ${n}(${t.repoInfo_}) has already been deleted.`),function $$(t){t.persistentConnection_&&t.persistentConnection_.interrupt("repo_interrupt")}(t),delete e[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){null===this._rootInternal&&Td("Cannot call "+n+" on a deleted database.")}}Cg.prototype.simpleListen=function(t,n){this.sendRequest("q",{p:t},n)},Cg.prototype.echo=function(t,n){this.sendRequest("echo",{d:t},n)},function l0e(t){(function sH(t){s2=t})(_g),gg(new Cp("database",(n,{instanceIdentifier:e})=>eq(n.getProvider("app").getImmediate(),n.getProvider("auth-internal"),n.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),bu(iH,"1.0.8",t),bu(iH,"1.0.8","esm2017")}();const nq="firebasestorage.googleapis.com",rq="storageBucket";class no extends zh{constructor(n,e,r=0){super(pN(n),`Firebase Storage: ${e} (${pN(n)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,no.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return pN(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Bi=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Bi||{});function pN(t){return"storage/"+t}function mN(){return new no(Bi.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function gN(t){return new no(Bi.INVALID_ARGUMENT,t)}function aq(){return new no(Bi.APP_DELETED,"The Firebase app was deleted.")}function lw(t,n){return new no(Bi.INVALID_FORMAT,"String does not match format '"+t+"': "+n)}function cw(t){throw new no(Bi.INTERNAL_ERROR,"Internal error: "+t)}class Da{constructor(n,e){this.bucket=n,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,e){let r;try{r=Da.makeFromUrl(n,e)}catch{return new Da(n,"")}if(""===r.path)return r;throw function b0e(t){return new no(Bi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(n)}static makeFromUrl(n,e){let r=null;const i="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+i+"(/(.*))?$","i");function _(Se){Se.path_=decodeURIComponent(Se.path)}const C=e.replace(/[.]/g,"\\."),Ze=[{regex:c,indices:{bucket:1,path:3},postModify:function o(Se){"/"===Se.path.charAt(Se.path.length-1)&&(Se.path_=Se.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${C}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:_},{regex:new RegExp(`^https?://${e===nq?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:_}];for(let Se=0;Se<Ze.length;Se++){const Ee=Ze[Se],ze=Ee.regex.exec(n);if(ze){let yt=ze[Ee.indices.path];yt||(yt=""),r=new Da(ze[Ee.indices.bucket],yt),Ee.postModify(r);break}}if(null==r)throw function v0e(t){return new no(Bi.INVALID_URL,"Invalid URL '"+t+"'.")}(n);return r}}class T0e{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function FD(t){return"string"==typeof t||t instanceof String}function lq(t){return _N()&&t instanceof Blob}function _N(){return typeof Blob<"u"}function yN(t,n,e,r){if(r<n)throw gN(`Invalid value for '${t}'. Expected ${n} or greater.`);if(r>e)throw gN(`Invalid value for '${t}'. Expected ${e} or less.`)}function nf(t,n,e){let r=n;return null==e&&(r=`https://${n}`),`${e}://${r}/v0${t}`}function cq(t){const n=encodeURIComponent;let e="?";for(const r in t)t.hasOwnProperty(r)&&(e=e+(n(r)+"=")+n(t[r])+"&");return e=e.slice(0,-1),e}var zy=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(zy||{});class R0e{constructor(n,e,r,i,o,a,c,f,_,x,C,A=!0){this.url_=n,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=f,this.timeout_=_,this.progressCallback_=x,this.connectionFactory_=C,this.retry=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,U)=>{this.resolve_=N,this.reject_=U,this.start_()})}start_(){const e=(r,i)=>{const o=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(c,c.getResponse());!function k0e(t){return void 0!==t}(f)?o():o(f)}catch(f){a(f)}else if(null!==c){const f=mN();f.serverResponse=c.getErrorText(),a(this.errorCallback_?this.errorCallback_(c,f):f)}else a(i.canceled?this.appDelete_?aq():function oq(){return new no(Bi.CANCELED,"User canceled the upload/download.")}():function iq(){return new no(Bi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?e(0,new BD(!1,null,!0)):this.backoffId_=function S0e(t,n,e){let r=1,i=null,o=null,a=!1,c=0;function f(){return 2===c}let _=!1;function x(...ce){_||(_=!0,n.apply(null,ce))}function C(ce){i=setTimeout(()=>{i=null,t(N,f())},ce)}function A(){o&&clearTimeout(o)}function N(ce,...xe){if(_)return void A();if(ce)return A(),void x.call(null,ce,...xe);if(f()||a)return A(),void x.call(null,ce,...xe);let Ze;r<64&&(r*=2),1===c?(c=2,Ze=0):Ze=1e3*(r+Math.random()),C(Ze)}let U=!1;function ne(ce){U||(U=!0,A(),!_&&(null!==i?(ce||(c=2),clearTimeout(i),C(0)):ce||(c=1)))}return C(0),o=setTimeout(()=>{a=!0,ne(!0)},e),ne}((r,i)=>{if(i)return void r(!1,new BD(!1,null,!0));const o=this.connectionFactory_();this.pendingConnection_=o;const a=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const c=o.getErrorCode()===zy.NO_ERROR,f=o.getStatus();if(!c||function uq(t,n){const e=t>=500&&t<600,i=-1!==[408,429].indexOf(t),o=-1!==n.indexOf(t);return e||i||o}(f,this.additionalRetryCodes_)&&this.retry){const x=o.getErrorCode()===zy.ABORT;return void r(!1,new BD(!1,null,x))}const _=-1!==this.successCodes_.indexOf(f);r(!0,new BD(_,o))})},e,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,null!==this.backoffId_&&function I0e(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class BD{constructor(n,e,r){this.wasSuccessCode=n,this.connection=e,this.canceled=!!r}}function V0e(...t){const n=function B0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==n){const e=new n;for(let r=0;r<t.length;r++)e.append(t[r]);return e.getBlob()}if(_N())return new Blob(t);throw new no(Bi.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}class vN{constructor(n,e){this.data=n,this.contentType=e||null}}function hq(t){const n=[];for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);r<=127?n.push(r):r<=2047?n.push(192|r>>6,128|63&r):55296==(64512&r)?e<t.length-1&&56320==(64512&t.charCodeAt(e+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++e),n.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):n.push(239,191,189):56320==(64512&r)?n.push(239,191,189):n.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(n)}function fq(t,n){switch(t){case"base64":{const i=-1!==n.indexOf("-"),o=-1!==n.indexOf("_");if(i||o)throw lw(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case"base64url":{const i=-1!==n.indexOf("+"),o=-1!==n.indexOf("/");if(i||o)throw lw(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=function z0e(t){if(typeof atob>"u")throw function C0e(t){return new no(Bi.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(n)}catch(i){throw i.message.includes("polyfill")?i:lw(t,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class pq{constructor(n){this.base64=!1,this.contentType=null;const e=n.match(/^data:([^,]+)?,/);if(null===e)throw lw("data_url","Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;null!=r&&(this.base64=function q0e(t,n){return t.length>=n.length&&t.substring(t.length-n.length)===n}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=n.substring(n.indexOf(",")+1)}}class rf{constructor(n,e){let r=0,i="";lq(n)?(this.data_=n,r=n.size,i=n.type):n instanceof ArrayBuffer?(e?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),r=this.data_.length):n instanceof Uint8Array&&(e?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),r=n.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(n,e){if(lq(this.data_)){const i=function U0e(t,n,e){return t.webkitSlice?t.webkitSlice(n,e):t.mozSlice?t.mozSlice(n,e):t.slice?t.slice(n,e):null}(this.data_,n,e);return null===i?null:new rf(i)}{const r=new Uint8Array(this.data_.buffer,n,e-n);return new rf(r,!0)}}static getBlob(...n){if(_N()){const e=n.map(r=>r instanceof rf?r.data_:r);return new rf(V0e.apply(null,e))}{const e=n.map(a=>FD(a)?function dq(t,n){switch(t){case"raw":return new vN(hq(n));case"base64":case"base64url":return new vN(fq(t,n));case"data_url":return new vN(function H0e(t){const n=new pq(t);return n.base64?fq("base64",n.rest):function j0e(t){let n;try{n=decodeURIComponent(t)}catch{throw lw("data_url","Malformed data URL.")}return hq(n)}(n.rest)}(n),function $0e(t){return new pq(t).contentType}(n))}throw mN()}("raw",a).data:a.data_);let r=0;e.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return e.forEach(a=>{for(let c=0;c<a.length;c++)i[o++]=a[c]}),new rf(i,!0)}}uploadData(){return this.data_}}function bN(t){let n;try{n=JSON.parse(t)}catch{return null}return function M0e(t){return"object"==typeof t&&!Array.isArray(t)}(n)?n:null}function mq(t){const n=t.lastIndexOf("/",t.length-2);return-1===n?t:t.slice(n+1)}function Z0e(t,n){return n}class Ta{constructor(n,e,r,i){this.server=n,this.local=e||n,this.writable=!!r,this.xform=i||Z0e}}let VD=null;function uw(){if(VD)return VD;const t=[];t.push(new Ta("bucket")),t.push(new Ta("generation")),t.push(new Ta("metageneration")),t.push(new Ta("name","fullPath",!0));const e=new Ta("name");e.xform=function n(o,a){return function K0e(t){return!FD(t)||t.length<2?t:mq(t)}(a)},t.push(e);const i=new Ta("size");return i.xform=function r(o,a){return void 0!==a?Number(a):a},t.push(i),t.push(new Ta("timeCreated")),t.push(new Ta("updated")),t.push(new Ta("md5Hash",null,!0)),t.push(new Ta("cacheControl",null,!0)),t.push(new Ta("contentDisposition",null,!0)),t.push(new Ta("contentEncoding",null,!0)),t.push(new Ta("contentLanguage",null,!0)),t.push(new Ta("contentType",null,!0)),t.push(new Ta("metadata","customMetadata",!0)),VD=t,VD}function gq(t,n,e){const r=bN(n);return null===r?null:function X0e(t,n,e){const r={type:"file"},i=e.length;for(let o=0;o<i;o++){const a=e[o];r[a.local]=a.xform(r,n[a.server])}return function Y0e(t,n){Object.defineProperty(t,"ref",{get:function e(){const o=new Da(t.bucket,t.fullPath);return n._makeStorageReference(o)}})}(r,t),r}(t,r,e)}class Pd{constructor(n,e,r,i){this.url=n,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Nd(t){if(!t)throw mN()}function jy(t){return function n(e,r){let i;return i=401===e.getStatus()?e.getErrorText().includes("Firebase App Check token is invalid")?function _0e(){return new no(Bi.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function g0e(){return new no(Bi.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===e.getStatus()?function m0e(t){return new no(Bi.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===e.getStatus()?function y0e(t){return new no(Bi.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}}function dw(t){const n=jy(t);return function e(r,i){let o=n(r,i);return 404===r.getStatus()&&(o=function p0e(t){return new no(Bi.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),o.serverResponse=i.serverResponse,o}}function xq(t,n,e,r,i){const o=n.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},f=function c(){let Ze="";for(let Se=0;Se<2;Se++)Ze+=Math.random().toString().slice(2);return Ze}();a["Content-Type"]="multipart/related; boundary="+f;const _=function wq(t,n,e){const r=Object.assign({},e);return r.fullPath=t.path,r.size=n.size(),r.contentType||(r.contentType=function awe(t,n){return t&&t.contentType||n&&n.type()||"application/octet-stream"}(null,n)),r}(n,r,i),x=function wN(t,n){const e={},r=n.length;for(let i=0;i<r;i++){const o=n[i];o.writable&&(e[o.server]=t[o.local])}return JSON.stringify(e)}(_,e),N=rf.getBlob("--"+f+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+x+"\r\n--"+f+"\r\nContent-Type: "+_.contentType+"\r\n\r\n",r,"\r\n--"+f+"--");if(null===N)throw function sq(){return new no(Bi.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const U={name:_.fullPath},ne=nf(o,t.host,t._protocol),xe=t.maxUploadRetryTime,Ce=new Pd(ne,"POST",function UD(t,n){return function e(r,i){const o=gq(t,i,n);return Nd(null!==o),o}}(t,e),xe);return Ce.urlParams=U,Ce.headers=a,Ce.body=N.uploadData(),Ce.errorHandler=jy(n),Ce}class hwe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zy.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zy.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zy.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,e,r,i){if(this.sent_)throw cw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,n,!0),void 0!==i)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw cw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw cw("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw cw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw cw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",n)}}class fwe extends hwe{initXhr(){this.xhr_.responseType="text"}}function Su(){return new fwe}class Ag{constructor(n,e){this._service=n,this._location=e instanceof Da?e:Da.makeFromUrl(e,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,e){return new Ag(n,e)}get root(){const n=new Da(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mq(this._location.path)}get storage(){return this._service}get parent(){const n=function G0e(t){if(0===t.length)return null;const n=t.lastIndexOf("/");return-1===n?"":t.slice(0,n)}(this._location.path);if(null===n)return null;const e=new Da(this._location.bucket,n);return new Ag(this._service,e)}_throwIfRoot(n){if(""===this._location.path)throw function D0e(t){return new no(Bi.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(n)}}function Twe(t){t._throwIfRoot("getDownloadURL");const n=function iwe(t,n,e){const i=nf(n.fullServerUrl(),t.host,t._protocol),a=t.maxOperationRetryTime,c=new Pd(i,"GET",function nwe(t,n){return function e(r,i){const o=gq(t,i,n);return Nd(null!==o),function Q0e(t,n,e,r){const i=bN(n);if(null===i||!FD(i.downloadTokens))return null;const o=i.downloadTokens;if(0===o.length)return null;const a=encodeURIComponent;return o.split(",").map(_=>{const C=t.fullPath;return nf("/b/"+a(t.bucket)+"/o/"+a(C),e,r)+cq({alt:"media",token:_})})[0]}(o,i,t.host,t._protocol)}}(t,e),a);return c.errorHandler=dw(n),c}(t.storage,t._location,uw());return t.storage.makeRequestWithTokens(n,Su).then(e=>{if(null===e)throw function E0e(){return new no(Bi.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return e})}function kq(t,n){if(t instanceof DN){const e=t;if(null==e._bucket)throw function w0e(){return new no(Bi.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+rq+"' property when initializing the app?")}();const r=new Ag(e,e._bucket);return null!=n?kq(r,n):r}return void 0!==n?function Iq(t,n){const e=function W0e(t,n){const e=n.split("/").filter(r=>r.length>0).join("/");return 0===t.length?e:t+"/"+e}(t._location.path,n),r=new Da(t._location.bucket,e);return new Ag(t.storage,r)}(t,n):t}function Aq(t,n){const e=n?.[rq];return null==e?null:Da.makeFromBucketSpec(e,t)}class DN{constructor(n,e,r,i,o){this.app=n,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=nq,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Da.makeFromBucketSpec(i,this._host):Aq(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._bucket=null!=this._url?Da.makeFromBucketSpec(this._url,n):Aq(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){yN("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){yN("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){var n=this;return fe(function*(){if(n._overrideAuthToken)return n._overrideAuthToken;const e=n._authProvider.getImmediate({optional:!0});if(e){const r=yield e.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var n=this;return fe(function*(){const e=n._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new Ag(this,n)}_makeRequest(n,e,r,i,o=!0){if(this._deleted)return new T0e(aq());{const a=function F0e(t,n,e,r,i,o,a=!0){const c=cq(t.urlParams),f=t.url+c,_=Object.assign({},t.headers);return function O0e(t,n){n&&(t["X-Firebase-GMPID"]=n)}(_,n),function P0e(t,n){null!==n&&n.length>0&&(t.Authorization="Firebase "+n)}(_,e),function N0e(t,n){t["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}(_,o),function L0e(t,n){null!==n&&(t["X-Firebase-AppCheck"]=n)}(_,r),new R0e(f,t.method,_,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}(n,this._appId,r,i,e,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(n,e){var r=this;return fe(function*(){const[i,o]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(n,e,i,o).getPromise()})()}}const Mq="@firebase/storage",Pq="storage";function TN(t,n,e){return function Dq(t,n,e){t._throwIfRoot("uploadBytes");const r=xq(t.storage,t._location,uw(),new rf(n,!0),e);return t.storage.makeRequestWithTokens(r,Su).then(i=>({metadata:i,ref:t}))}(t=Po(t),n,e)}function SN(t){return Twe(t=Po(t))}function Nq(t){return function Swe(t){t._throwIfRoot("deleteObject");const n=function swe(t,n){const r=nf(n.fullServerUrl(),t.host,t._protocol),c=new Pd(r,"DELETE",function a(f,_){},t.maxOperationRetryTime);return c.successCodes=[200,204],c.errorHandler=dw(n),c}(t.storage,t._location);return t.storage.makeRequestWithTokens(n,Su)}(t=Po(t))}function hw(t,n){return function Awe(t,n){if(n&&function Iwe(t){return/^[A-Za-z]+:\/\//.test(t)}(n)){if(t instanceof DN)return function kwe(t,n){return new Ag(t,n)}(t,n);throw gN("To use ref(service, url), the first argument must be a Storage instance.")}return kq(t,n)}(t=Po(t),n)}function Nwe(t,{instanceIdentifier:n}){const e=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new DN(e,r,i,n,_g)}!function Owe(){gg(new Cp(Pq,Nwe,"PUBLIC").setMultipleInstances(!0)),bu(Mq,"0.13.2",""),bu(Mq,"0.13.2","esm2017")}();const IN=V6({apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",authDomain:"familyapp-e83b7.firebaseapp.com",databaseURL:"https://familyapp-e83b7-default-rtdb.europe-west1.firebasedatabase.app",projectId:"familyapp-e83b7",storageBucket:"familyapp-e83b7.appspot.com",messagingSenderId:"728695329604",appId:"1:728695329604:web:c0a1ef7ebf32de4bcd7d11"}),pi=function G_e(t=zM()){const n=b0(t,"auth");if(n.isInitialized())return n.getImmediate();const e=function Pme(t,n){const e=b0(t,"auth");if(e.isInitialized()){const i=e.getImmediate();if(PC(e.getOptions(),n??{}))return i;al(i,"already-initialized")}return e.initialize({options:n})}(t,{popupRedirectResolver:U_e,persistence:[Fge,Cge,L8]}),r=S6("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=q_e(o.toString());(function gge(t,n,e){Po(t).beforeAuthStateChanged(n,e)})(e,a,()=>a(e.currentUser)),function mge(t,n,e,r){Po(t).onIdTokenChanged(n,e,r)}(e,c=>a(c))}}const i=C6("auth");return i&&function Ome(t,n,e){const r=No(t);gt(r._canInitEmulator,r,"emulator-config-failed"),gt(/^https?:\/\//.test(n),r,"invalid-emulator-scheme");const i=!!e?.disableWarnings,o=w8(n),{host:a,port:c}=function Lme(t){const n=w8(t),e=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:x8(r.substr(o.length+1))}}{const[o,a]=r.split(":");return{host:o,port:x8(a)}}}(n);r.config.emulator={url:`${o}//${a}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function Fme(){function t(){const n=document.createElement("p"),e=n.style;n.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",n.classList.add("firebase-emulator-warning"),document.body.appendChild(n)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(e,`http://${i}`),e}(IN),Pn=function s0e(t=zM(),n){const e=b0(t,"database").getImmediate({identifier:n});if(!e._instanceStarted){const r=D6("database");r&&function a0e(t,n,e,r={}){(t=Po(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&Td("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Td('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new U0(U0.OWNER);else if(r.mockUserToken){const a="string"==typeof r.mockUserToken?r.mockUserToken:I6(r.mockUserToken,t.app.options.projectId);o=new U0(a)}!function t0e(t,n,e,r){t.repoInfo_=new d2(`${n}:${e}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,n,e,o)}(e,...r)}return e}(IN),fw=function Rwe(t=zM(),n){const r=b0(t=Po(t),Pq).getImmediate({identifier:n}),i=D6("storage");return i&&function Pwe(t,n,e,r={}){!function Mwe(t,n,e,r={}){t.host=`${n}:${e}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:I6(i,t.app.options.projectId))}(t,n,e,r)}(r,...i),r}(IN);let jD=(()=>{class t{constructor(){}getUserData(){return new H(e=>ZC(pi,i=>{i?tf(Tn(Pn,"/users/"+i.uid)).then(o=>{const a=o.val();e.next(a)}).catch(o=>{e.error(o)}):e.next(null)},i=>{e.error(i)},()=>{e.complete()}))}updateUserData(e,r){return Md(Tn(Pn,`/users/${e}`),r)}deleteOldAvatar(e){return e&&e.includes("firebasestorage.googleapis.com")?Nq(hw(fw,e)).catch(()=>{}):Promise.resolve()}compressImage(e,r=400,i=.7){return new Promise((o,a)=>{const c=new Image,f=new FileReader;f.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let C=c.width,A=c.height;C>r&&(A=Math.round(A*r/C),C=r),x.width=C,x.height=A,x.getContext("2d").drawImage(c,0,0,C,A),x.toBlob(U=>U?o(U):a("Compression echouee"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},f.onerror=a,f.readAsDataURL(e)})}uploadFile(e){return this.compressImage(e).then(r=>{const i=Date.now().toString();return TN(hw(fw,"/avatars/"+i+".jpg"),r,{contentType:"image/jpeg"}).then(a=>SN(a.ref))})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Od=(()=>{class t{constructor(){this.googleToken$=new ee,this.redirectReady=Promise.resolve(),this.allUsers=[]}signInWithGoogle(){var e=this;return fe(function*(){const r=new T8;r.addScope("https://www.googleapis.com/auth/calendar"),r.addScope("https://www.googleapis.com/auth/drive");const i=yield function n_e(t,n,e){return zP.apply(this,arguments)}(pi,r),o=T8.credentialFromResult(i);o?.accessToken&&e.googleToken$.next(o.accessToken);const a=i.user,c=Tn(Pn,"/users/"+a.uid),_=(yield tf(c)).val()||{},x=_.photoURL,C=_.displayName,A=x&&""!==x.trim(),N=C&&""!==C.trim(),U={email:a.email||"",uid:a.uid,displayName:N?C:a.displayName||"",photoURL:A?x:a.photoURL||""};yield Md(c,U)})()}signOutUser(){!function _ge(t){Po(t).signOut()}(pi)}getAllUsers(){return tf(Tn(Pn,"/users")).then(e=>{const r=e.val();return this.allUsers=r?Object.keys(r).map(i=>({id:i,...r[i]})):[],this.allUsers})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Lwe=(()=>{class t{constructor(e,r){this.editProfileService=e,this.authService=r,this.userName="",this.userPhoto=""}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{e&&(this.userName=e.displayName||"",this.userPhoto=e.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg")})}onSignOut(){this.authService.signOutUser()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Ne(jD),Ne(Od))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-sidebar"]],decls:26,vars:0,consts:[[1,"w-64","h-screen","bg-white/80","backdrop-blur-lg","border-r","border-warm-100","flex","flex-col","p-4","sticky","top-0"],[1,"flex","items-center","gap-3","px-3","py-4","mb-6"],[1,"font-display","font-extrabold","text-xl","text-gradient"],[1,"flex-1","space-y-1"],["routerLink","/home","routerLinkActive","bg-gradient-to-r from-family-pink/10 to-family-orange/10 text-family-pink",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/chat","routerLinkActive","bg-gradient-to-r from-family-coral/10 to-family-orange/10 text-family-coral",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/add-task","routerLinkActive","bg-gradient-to-r from-family-purple/10 to-family-lavender/10 text-family-purple",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/shopping","routerLinkActive","bg-gradient-to-r from-family-green/10 to-family-green/10 text-family-green",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/recipes","routerLinkActive","bg-gradient-to-r from-family-orange/10 to-family-coral/10 text-family-orange",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/map","routerLinkActive","bg-gradient-to-r from-family-sky/10 to-family-sky/10 text-family-sky",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/calendar","routerLinkActive","bg-gradient-to-r from-family-yellow/10 to-family-orange/10 text-family-orange",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/documents","routerLinkActive","bg-gradient-to-r from-family-purple/10 to-family-lavender/10 text-family-purple",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/vacances","routerLinkActive","bg-gradient-to-r from-family-coral/10 to-family-orange/10 text-family-coral",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],[1,"border-t","border-warm-100","pt-4"],[1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-400","hover:bg-red-50","hover:text-red-400","transition-all","font-medium","w-full","text-left",3,"click"]],template:function(r,i){1&r&&(O(0,"aside",0)(1,"div",1)(2,"h1",2),q(3,"Family App"),V()(),O(4,"nav",3)(5,"a",4),q(6," Tableau de bord "),V(),O(7,"a",5),q(8," Fil d'actu "),V(),O(9,"a",6),q(10," Nouvelle tache "),V(),O(11,"a",7),q(12," Courses "),V(),O(13,"a",8),q(14," Recettes "),V(),O(15,"a",9),q(16," Carte "),V(),O(17,"a",10),q(18," Calendrier "),V(),O(19,"a",11),q(20," Documents "),V(),O(21,"a",12),q(22," Vacances "),V()(),O(23,"div",13)(24,"button",14),Pe("click",function(){return i.onSignOut()}),q(25," Deconnexion "),V()()())},dependencies:[t0,yp,LA],encapsulation:2})}}return t})();const Fwe=()=>({exact:!1});function Bwe(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"a",12),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),O(2,"span"),q(3,"\u270f\ufe0f"),V(),q(4," Taches "),V(),O(5,"a",13),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),O(6,"span"),q(7,"\u{1f4c5}"),V(),q(8," Agenda "),V(),O(9,"a",14),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),O(10,"span"),q(11,"\u{1f4c1}"),V(),q(12," Docs "),V(),O(13,"a",15),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),O(14,"span"),q(15,"\u{1f37d}\ufe0f"),V(),q(16," Recettes "),V(),O(17,"a",16),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),O(18,"span"),q(19,"\u{1f3d6}\ufe0f"),V(),q(20," Vacances "),V()()}}function Vwe(t,n){if(1&t){const e=Ut();O(0,"div",17),Pe("click",function(){return Me(e),Oe(ge().showMore=!1)}),V()}}let Uwe=(()=>{class t{constructor(){this.showMore=!1}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=gr({type:t,selectors:[["app-bottom-nav"]],decls:30,vars:6,consts:[[1,"fixed","bottom-0","left-0","right-0","bg-white/90","backdrop-blur-lg","border-t","border-warm-100","pb-safe","z-50"],[1,"flex","justify-around","items-center","h-16"],["routerLink","/home","routerLinkActive","text-family-pink",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90",3,"routerLinkActiveOptions"],[1,"text-lg"],[1,"text-[9px]","font-medium"],["routerLink","/chat","routerLinkActive","text-family-coral",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],["routerLink","/map","routerLinkActive","text-family-sky",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],["routerLink","/shopping","routerLinkActive","text-family-green",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],[1,"relative"],[3,"click"],[1,"absolute","bottom-14","right-0","bg-white","rounded-2xl","shadow-lg","border","border-gray-100","p-2","min-w-[140px]","z-50"],[1,"fixed","inset-0","z-40"],["routerLink","/add-task","routerLinkActive","text-family-purple",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/calendar","routerLinkActive","text-family-orange",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/documents","routerLinkActive","text-family-purple",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/recipes","routerLinkActive","text-family-orange",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/vacances","routerLinkActive","text-family-coral",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],[1,"fixed","inset-0","z-40",3,"click"]],template:function(r,i){1&r&&(O(0,"nav",0)(1,"div",1)(2,"a",2)(3,"span",3),q(4,"\u{1f3e0}"),V(),O(5,"span",4),q(6,"Accueil"),V()(),O(7,"a",5)(8,"span",3),q(9,"\u{1f4f1}"),V(),O(10,"span",4),q(11,"Fil"),V()(),O(12,"a",6)(13,"span",3),q(14,"\u{1f5fa}\ufe0f"),V(),O(15,"span",4),q(16,"Carte"),V()(),O(17,"a",7)(18,"span",3),q(19,"\u{1f6d2}"),V(),O(20,"span",4),q(21,"Courses"),V()(),O(22,"div",8)(23,"button",9),Pe("click",function(){return i.showMore=!i.showMore}),O(24,"span",3),q(25,"\u2022\u2022\u2022"),V(),O(26,"span",4),q(27,"Plus"),V()(),ot(28,Bwe,21,0,"div",10),V()()(),ot(29,Vwe,1,0,"div",11)),2&r&&(Y(2),pn("routerLinkActiveOptions",function CV(t,n){const e=jn()+t,r=Le();return r[e]===Lr?pd(r,e,n()):function nb(t,n){return t[n]}(r,e)}(5,Fwe)),Y(21),is(i.showMore?"flex flex-col items-center justify-center gap-0.5 text-family-pink transition-all active:scale-90":"flex flex-col items-center justify-center gap-0.5 text-gray-400 transition-all active:scale-90"),Y(5),st(i.showMore?28:-1),Y(),st(i.showMore?29:-1))},dependencies:[t0,yp,LA,Ic],encapsulation:2})}}return t})();function zwe(t,n){if(1&t&&(O(0,"a",0),ut(1,"img",1),O(2,"span",2),q(3),V()()),2&t){const e=ge();Y(),pn("src",e.fileUrl,vs),Y(2),xt(e.user.displayName)}}let jwe=(()=>{class t{constructor(e){this.editProfileService=e,this.user=null}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{this.user=e,this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"},e=>{console.error(e)})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Ne(jD))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-user-avatar"]],decls:1,vars:1,consts:[["routerLink","/user-profile",1,"flex","items-center","gap-2","hover:opacity-80","transition-opacity"],["alt","Photo de profil","referrerpolicy","no-referrer",1,"w-9","h-9","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"font-medium","text-sm","text-gray-700","hidden","md:inline"]],template:function(r,i){1&r&&ot(0,zwe,4,2,"a",0),2&r&&st(i.user?0:-1)},dependencies:[t0,yp],encapsulation:2})}}return t})(),Hwe=(()=>{class t{constructor(e){this.authService=e}onSignOut(){this.authService.signOutUser()}static{this.\u0275fac=function(r){return new(r||t)(Ne(Od))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-top-bar"]],decls:9,vars:0,consts:[[1,"flex","items-center","justify-between","px-4","md:px-6","py-3","bg-white/60","backdrop-blur-sm","border-b","border-warm-100"],[1,"flex","items-center","gap-2","md:hidden"],[1,"font-display","font-bold","text-lg","text-gradient"],[1,"hidden","md:block"],[1,"flex","items-center","gap-3"],[1,"md:hidden","text-gray-400","hover:text-red-400","transition-colors","text-sm","font-medium",3,"click"]],template:function(r,i){1&r&&(O(0,"header",0)(1,"div",1)(2,"span",2),q(3,"Family App"),V()(),ut(4,"div",3),O(5,"div",4),ut(6,"app-user-avatar"),O(7,"button",5),Pe("click",function(){return i.onSignOut()}),q(8," Deconnexion "),V()()())},dependencies:[jwe],encapsulation:2})}}return t})(),Oq=(()=>{class t{constructor(){this.watchId=null}startTracking(){if(!navigator.geolocation)return;const e=pi.currentUser;e&&(this.watchId=navigator.geolocation.watchPosition(r=>{Cu(Tn(Pn,`/locations/${e.uid}`),{lat:r.coords.latitude,lng:r.coords.longitude,timestamp:Date.now(),displayName:e.displayName||"",photoURL:e.photoURL||""})},()=>{},{enableHighAccuracy:!0,maximumAge:3e4,timeout:1e4}))}stopTracking(){null!==this.watchId&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null)}listenAllLocations(e){const r=Tn(Pn,"/locations");return Rd(r,o=>{e(o.val()||{})}),()=>LD(r)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Lq(t=0,n=tM){return t<0&&(t=0),Fj(t,t,n)}let $we=(()=>{class t{constructor(e,r,i){this.swUpdate=e,this.snackBar=r,this.appRef=i}init(){this.swUpdate.isEnabled&&(Fb(this.appRef.isStable.pipe(mp(o=>!0===o)),Lq(18e5)).subscribe(()=>{this.swUpdate.checkForUpdate().catch(()=>{})}),this.swUpdate.versionUpdates.pipe(Es(o=>"VERSION_READY"===o.type)).subscribe(()=>{this.showUpdateNotification()}))}showUpdateNotification(){this.snackBar.open("\u{1f680} Nouvelle version disponible !","Mettre \xe0 jour",{duration:0,horizontalPosition:"center",verticalPosition:"bottom",panelClass:["update-snackbar"]}).onAction().subscribe(()=>{this.applyUpdate()})}applyUpdate(){this.swUpdate.activateUpdate().then(()=>{window.location.reload()})}static{this.\u0275fac=function(r){return new(r||t)(Tt(DM),Tt(xp),Tt(tl))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function qwe(t,n){1&t&&(O(0,"div",0),ut(1,"app-sidebar",1),O(2,"div",2),ut(3,"app-top-bar"),O(4,"main",3),ut(5,"router-outlet"),V(),ut(6,"app-bottom-nav",4),V()())}function Gwe(t,n){1&t&&ut(0,"router-outlet")}let Wwe=(()=>{class t{constructor(e,r){this.locationService=e,this.updateService=r,this.title="FamilyApp",this.isAuth=!1}ngOnInit(){this.updateService.init(),ZC(pi,e=>{this.isAuth=!!e,e?this.locationService.startTracking():this.locationService.stopTracking()})}static{this.\u0275fac=function(r){return new(r||t)(Ne(Oq),Ne($we))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen"],[1,"hidden","md:flex","flex-shrink-0"],[1,"flex-1","flex","flex-col","min-h-screen","overflow-hidden"],[1,"flex-1","overflow-y-auto","p-4","md:p-6","pb-24","md:pb-6"],[1,"md:hidden"]],template:function(r,i){1&r&&ot(0,qwe,7,0,"div",0)(1,Gwe,1,0,"router-outlet"),2&r&&st(i.isAuth?0:1)},dependencies:[DA,Lwe,Uwe,Hwe],encapsulation:2})}}return t})(),Fq=(()=>{class t{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,r){this._renderer=e,this._elementRef=r}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(r){return new(r||t)(Ne(Xa),Ne(Ur))};static \u0275dir=Ft({type:t})}return t})(),Mg=(()=>{class t extends Fq{static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,features:[Yn]})}return t})();const Ld=new Ue(""),Kwe={provide:Ld,useExisting:Jn(()=>kN),multi:!0};let kN=(()=>{class t extends Mg{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){1&r&&Pe("change",function(a){return i.onChange(a.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Mr([Kwe]),Yn]})}return t})();const Ywe={provide:Ld,useExisting:Jn(()=>zl),multi:!0},Qwe=new Ue("");let zl=(()=>{class t extends Fq{_compositionMode;_composing=!1;constructor(e,r,i){super(e,r),this._compositionMode=i,null==this._compositionMode&&(this._compositionMode=!function Xwe(){const t=fp()?fp().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(r){return new(r||t)(Ne(Xa),Ne(Ur),Ne(Qwe,8))};static \u0275dir=Ft({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&Pe("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Mr([Ywe]),Yn]})}return t})();function AN(t){return null==t||0===MN(t)}function MN(t){return null==t?null:Array.isArray(t)||"string"==typeof t?t.length:t instanceof Set?t.size:null}const ia=new Ue(""),Fp=new Ue(""),Jwe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Fd{static min(n){return Bq(n)}static max(n){return Vq(n)}static required(n){return Uq(n)}static requiredTrue(n){return function zq(t){return!0===t.value?null:{required:!0}}(n)}static email(n){return function jq(t){return AN(t.value)||Jwe.test(t.value)?null:{email:!0}}(n)}static minLength(n){return function Hq(t){return n=>{const e=n.value?.length??MN(n.value);return null===e||0===e?null:e<t?{minlength:{requiredLength:t,actualLength:e}}:null}}(n)}static maxLength(n){return function $q(t){return n=>{const e=n.value?.length??MN(n.value);return null!==e&&e>t?{maxlength:{requiredLength:t,actualLength:e}}:null}}(n)}static pattern(n){return function qq(t){if(!t)return HD;let n,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),r=>{if(AN(r.value))return null;const i=r.value;return n.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(n)}static nullValidator(n){return null}static compose(n){return Xq(n)}static composeAsync(n){return Qq(n)}}function Bq(t){return n=>{if(null==n.value||null==t)return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}function Vq(t){return n=>{if(null==n.value||null==t)return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}function Uq(t){return AN(t.value)?{required:!0}:null}function HD(t){return null}function Gq(t){return null!=t}function Wq(t){return ub(t)?xs(t):t}function Zq(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function Kq(t,n){return n.map(e=>e(t))}function Yq(t){return t.map(n=>function exe(t){return!t.validate}(n)?n:e=>n.validate(e))}function Xq(t){if(!t)return null;const n=t.filter(Gq);return 0==n.length?null:function(e){return Zq(Kq(e,n))}}function RN(t){return null!=t?Xq(Yq(t)):null}function Qq(t){if(!t)return null;const n=t.filter(Gq);return 0==n.length?null:function(e){return function Zwe(...t){const n=Az(t),{args:e,keys:r}=Mz(t),i=new H(o=>{const{length:a}=e;if(!a)return void o.complete();const c=new Array(a);let f=a,_=a;for(let x=0;x<a;x++){let C=!1;kc(e[x]).subscribe(new li(o,A=>{C||(C=!0,_--),c[x]=A},()=>f--,void 0,()=>{(!f||!C)&&(_||o.next(r?Pz(r,c):c),o.complete())}))}});return n?i.pipe(Rz(n)):i}(Kq(e,n).map(Wq)).pipe(mr(Zq))}}function PN(t){return null!=t?Qq(Yq(t)):null}function Jq(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function eG(t){return t._rawValidators}function tG(t){return t._rawAsyncValidators}function NN(t){return t?Array.isArray(t)?t:[t]:[]}function $D(t,n){return Array.isArray(t)?t.includes(n):t===n}function nG(t,n){const e=NN(n);return NN(t).forEach(i=>{$D(e,i)||e.push(i)}),e}function rG(t,n){return NN(n).filter(e=>!$D(t,e))}class iG{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=RN(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=PN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class oa extends iG{name;get formDirective(){return null}get path(){return null}}class Bp extends iG{_parent=null;name=null;valueAccessor=null}class oG{_cd;constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let Iu=(()=>{class t extends oG{constructor(e){super(e)}static \u0275fac=function(r){return new(r||t)(Ne(Bp,2))};static \u0275dir=Ft({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&js("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Yn]})}return t})(),pw=(()=>{class t extends oG{constructor(e){super(e)}static \u0275fac=function(r){return new(r||t)(Ne(oa,10))};static \u0275dir=Ft({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&js("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Yn]})}return t})();const mw="VALID",GD="INVALID",$y="PENDING",gw="DISABLED";class qy{}class lG extends qy{value;source;constructor(n,e){super(),this.value=n,this.source=e}}class FN extends qy{pristine;source;constructor(n,e){super(),this.pristine=n,this.source=e}}class BN extends qy{touched;source;constructor(n,e){super(),this.touched=n,this.source=e}}class WD extends qy{status;source;constructor(n,e){super(),this.status=n,this.source=e}}class cG extends qy{source;constructor(n){super(),this.source=n}}class VN extends qy{source;constructor(n){super(),this.source=n}}function UN(t){return(ZD(t)?t.validators:t)||null}function zN(t,n){return(ZD(n)?n.asyncValidators:t)||null}function ZD(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function uG(t,n,e){const r=t.controls;if(!(n?Object.keys(r):r).length)throw new ue(1e3,"");if(!r[e])throw new ue(1001,"")}function dG(t,n,e){t._forEachChild((r,i)=>{if(void 0===e[i])throw new ue(1002,"")})}class KD{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(n,e){this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return Er(this.statusReactive)}set status(n){Er(()=>this.statusReactive.set(n))}_status=ii(()=>this.statusReactive());statusReactive=Pi(void 0);get valid(){return this.status===mw}get invalid(){return this.status===GD}get pending(){return this.status==$y}get disabled(){return this.status===gw}get enabled(){return this.status!==gw}errors;get pristine(){return Er(this.pristineReactive)}set pristine(n){Er(()=>this.pristineReactive.set(n))}_pristine=ii(()=>this.pristineReactive());pristineReactive=Pi(!0);get dirty(){return!this.pristine}get touched(){return Er(this.touchedReactive)}set touched(n){Er(()=>this.touchedReactive.set(n))}_touched=ii(()=>this.touchedReactive());touchedReactive=Pi(!1);get untouched(){return!this.touched}_events=new ee;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(nG(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(nG(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(rG(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(rG(n,this._rawAsyncValidators))}hasValidator(n){return $D(this._rawValidators,n)}hasAsyncValidator(n){return $D(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){const e=!1===this.touched;this.touched=!0;const r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched({...n,sourceControl:r}),e&&!1!==n.emitEvent&&this._events.next(new BN(!0,r))}markAllAsDirty(n={}){this.markAsDirty({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(n))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(n))}markAsUntouched(n={}){const e=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const r=n.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,r),e&&!1!==n.emitEvent&&this._events.next(new BN(!1,r))}markAsDirty(n={}){const e=!0===this.pristine;this.pristine=!1;const r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty({...n,sourceControl:r}),e&&!1!==n.emitEvent&&this._events.next(new FN(!1,r))}markAsPristine(n={}){const e=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const r=n.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,r),e&&!1!==n.emitEvent&&this._events.next(new FN(!0,r))}markAsPending(n={}){this.status=$y;const e=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new WD(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending({...n,sourceControl:e})}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=gw,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue();const r=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new lG(this.value,r)),this._events.next(new WD(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e},this),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=mw,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e},this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,e){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===mw||this.status===$y)&&this._runAsyncValidator(r,n.emitEvent)}const e=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new lG(this.value,e)),this._events.next(new WD(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity({...n,sourceControl:e})}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?gw:mw}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,e){if(this.asyncValidator){this.status=$y,this._hasOwnPendingAsyncValidator={emitEvent:!1!==e,shouldHaveEmitted:!1!==n};const r=Wq(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:e,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const n=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent,this,e.shouldHaveEmitted)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,i)=>r&&r._find(i),this)}getError(n,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,e,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new WD(this.status,e)),this._parent&&this._parent._updateControlsErrors(n,e,r)}_initObservables(){this.valueChanges=new Zn,this.statusChanges=new Zn}_calculateStatus(){return this._allControlsDisabled()?gw:this.errors?GD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus($y)?$y:this._anyControlsHaveStatus(GD)?GD:mw}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,e){const r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,e),i&&this._events.next(new FN(this.pristine,e))}_updateTouched(n={},e){this.touched=this._anyControlsTouched(),this._events.next(new BN(this.touched,e)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,e)}_onDisabledChange=[];_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){ZD(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function axe(t){return Array.isArray(t)?RN(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function lxe(t){return Array.isArray(t)?PN(t):t||null}(this._rawAsyncValidators)}}class _w extends KD{constructor(n,e,r){super(UN(e),zN(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,r={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){dG(this,0,n),Object.keys(n).forEach(r=>{uG(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(r=>{const i=this.controls[r];i&&i.patchValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((r,i)=>{r.reset(n?n[i]:null,{...e,onlySelf:!0})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),!1!==e?.emitEvent&&this._events.next(new VN(this))}getRawValue(){return this._reduceChildren({},(n,e,r)=>(n[r]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&n(r,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,i)=>((r.enabled||this.disabled)&&(e[i]=r.value),e))}_reduceChildren(n,e){let r=n;return this._forEachChild((i,o)=>{r=e(r,i,o)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class hG extends _w{}const Rg=new Ue("",{factory:()=>yw}),yw="always";function YD(t,n){return[...n.path,t]}function vw(t,n,e=yw){jN(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function uxe(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&fG(t,n)})}(t,n),function hxe(t,n){const e=(r,i)=>{n.valueAccessor.writeValue(r),i&&n.viewToModelUpdate(r)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function dxe(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&fG(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function cxe(t,n){if(n.valueAccessor.setDisabledState){const e=r=>{n.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function XD(t,n,e=!0){const r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),JD(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function QD(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function jN(t,n){const e=eG(t);null!==n.validator?t.setValidators(Jq(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const r=tG(t);null!==n.asyncValidator?t.setAsyncValidators(Jq(r,n.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();QD(n._rawValidators,i),QD(n._rawAsyncValidators,i)}function JD(t,n){let e=!1;if(null!==t){if(null!==n.validator){const i=eG(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.validator);o.length!==i.length&&(e=!0,t.setValidators(o))}}if(null!==n.asyncValidator){const i=tG(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.asyncValidator);o.length!==i.length&&(e=!0,t.setAsyncValidators(o))}}}const r=()=>{};return QD(n._rawValidators,r),QD(n._rawAsyncValidators,r),e}function fG(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function $N(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function qN(t,n){if(!n)return null;let e,r,i;return Array.isArray(n),n.forEach(o=>{o.constructor===zl?e=o:function mxe(t){return Object.getPrototypeOf(t.constructor)===Mg}(o)?r=o:i=o}),i||r||e||null}function gG(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function _G(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}Promise.resolve();const ww=class extends KD{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(n=null,e,r){super(UN(e),zN(r,e)),this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ZD(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=_G(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),e.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,!1!==e?.emitEvent&&this._events.next(new VN(this))}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){gG(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){gG(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){_G(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},xxe={provide:Bp,useExisting:Jn(()=>Vp)},yG=Promise.resolve();let Vp=(()=>{class t extends Bp{_changeDetectorRef;callSetDisabledState;control=new ww;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Zn;constructor(e,r,i,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=qN(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),$N(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){vw(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){yG.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,i=0!==r&&ws(r);yG.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?YD(e,this._parent):[e]}static \u0275fac=function(r){return new(r||t)(Ne(oa,9),Ne(ia,10),Ne(Fp,10),Ne(Ld,10),Ne(Mh,8),Ne(Rg,8))};static \u0275dir=Ft({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Mr([xxe]),Yn,Ho]})}return t})(),xw=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return t})();const Exe={provide:Ld,useExisting:Jn(()=>GN),multi:!0};let GN=(()=>{class t extends Mg{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){1&r&&Pe("input",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Mr([Exe]),Yn]})}return t})();class wG extends KD{constructor(n,e,r){super(UN(e),zN(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){Array.isArray(n)?n.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,r={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,e={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,r={}){let i=this._adjustIndex(n);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){dG(this,0,n),n.forEach((r,i)=>{uG(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((r,i)=>{r.reset(n[i],{...e,onlySelf:!0})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),!1!==e?.emitEvent&&this._events.next(new VN(this))}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,r)=>{n(e,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}let rT=(()=>{class t extends oa{callSetDisabledState;get submitted(){return Er(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=ii(()=>this._submittedReactive());_submittedReactive=Pi(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(e,r,i){super(),this.callSetDisabledState=i,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this.onChanges(e)}ngOnDestroy(){this.onDestroy()}onChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(JD(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(e){const r=this.form.get(e.path);return vw(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){XD(e.control||null,e,!1),function gxe(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}getFormArray(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}updateModel(e,r){this.form.get(e.path).setValue(r)}onReset(){this.resetForm()}resetForm(e=void 0,r={}){this.form.reset(e,r),this._submittedReactive.set(!1)}onSubmit(e){return this.submitted=!0,function mG(t,n){t._syncPendingControls(),n.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new cG(this.control)),"dialog"===e?.target?.method}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,i=this.form.get(e.path);r!==i&&(XD(r||null,e),(t=>t instanceof ww)(i)&&(vw(i,e,this.callSetDisabledState),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);(function pG(t,n){jN(t,n)})(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function fxe(t,n){return JD(t,n)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){jN(this.form,this),this._oldForm&&JD(this._oldForm,this)}_checkFormPresent(){}static \u0275fac=function(r){return new(r||t)(Ne(ia,10),Ne(Fp,10),Ne(Rg,8))};static \u0275dir=Ft({type:t,features:[Yn,Ho]})}return t})();const WN=new Ue(""),Mxe={provide:Bp,useExisting:Jn(()=>Gy)};let Gy=(()=>{class t extends Bp{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new Zn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,r,i,o,a){super(),this._ngModelWarningConfig=a,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=qN(0,o)}ngOnChanges(e){this._added||this._setUpControl(),$N(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return YD(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||t)(Ne(oa,13),Ne(ia,10),Ne(Fp,10),Ne(Ld,10),Ne(WN,8))};static \u0275dir=Ft({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Mr([Mxe]),Yn,Ho]})}return t})();const Rxe={provide:oa,useExisting:Jn(()=>Wy)};let Wy=(()=>{class t extends rT{form=null;ngSubmit=new Zn;get control(){return this.form}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&Pe("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Mr([Rxe]),Yn]})}return t})();const Pxe={provide:Ld,useExisting:Jn(()=>Up),multi:!0};function DG(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Up=(()=>{class t extends Mg{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;appRefInjector=Q(tl).injector;destroyRef=Q(cr);cdr=Q(Mh);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,hu({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(e){this.cdr.markForCheck(),this.value=e;const i=DG(this._getOptionId(e),e);this.setProperty("value",i)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function Nxe(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){1&r&&Pe("change",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Mr([Pxe]),Yn]})}return t})(),Zy=(()=>{class t{_element;_renderer;_select;id;constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(DG(this.id,e)),this._select._writeValueAfterRender())}set value(e){this._setElementValue(e),this._select&&this._select._writeValueAfterRender()}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||t)(Ne(Ur),Ne(Xa),Ne(Up,9))};static \u0275dir=Ft({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return t})();const Oxe={provide:Ld,useExisting:Jn(()=>ZN),multi:!0};function TG(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let ZN=(()=>{class t extends Mg{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){let r;if(this.value=e,Array.isArray(e)){const i=e.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const i=[],o=r.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const _=this._getOptionValue(a[c].value);i.push(_)}}else{const a=r.options;for(let c=0;c<a.length;c++){const f=a[c];if(f.selected){const _=this._getOptionValue(f.value);i.push(_)}}}this.value=i,e(i)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function Lxe(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){1&r&&Pe("change",function(a){return i.onChange(a.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Mr([Oxe]),Yn]})}return t})(),Ky=(()=>{class t{_element;_renderer;_select;id;_value;constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(TG(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(TG(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||t)(Ne(Ur),Ne(Xa),Ne(ZN,9))};static \u0275dir=Ft({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return t})();function IG(t){return"number"==typeof t?t:parseFloat(t)}let Pg=(()=>{class t{_validator=HD;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):HD,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,features:[Ho]})}return t})();const Fxe={provide:ia,useExisting:Jn(()=>KN),multi:!0};let KN=(()=>{class t extends Pg{max;inputName="max";normalizeInput=e=>IG(e);createValidator=e=>Vq(e);static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(r,i){2&r&&na("max",i._enabled?i.max:null)},inputs:{max:"max"},standalone:!1,features:[Mr([Fxe]),Yn]})}return t})();const Bxe={provide:ia,useExisting:Jn(()=>YN),multi:!0};let YN=(()=>{class t extends Pg{min;inputName="min";normalizeInput=e=>IG(e);createValidator=e=>Bq(e);static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){2&r&&na("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[Mr([Bxe]),Yn]})}return t})();const Vxe={provide:ia,useExisting:Jn(()=>Yy),multi:!0};let Yy=(()=>{class t extends Pg{required;inputName="required";normalizeInput=ws;createValidator=e=>Uq;enabled(e){return e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Gr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){2&r&&na("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Mr([Vxe]),Yn]})}return t})(),NG=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({})}return t})();function OG(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let oT=(()=>{class t{useNonNullable=!1;get nonNullable(){const e=new t;return e.useNonNullable=!0,e}group(e,r=null){const i=this._reduceControls(e);let o={};return OG(r)?o=r:null!==r&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new _w(i,o)}record(e,r=null){const i=this._reduceControls(e);return new hG(i,r)}control(e,r,i){let o={};return this.useNonNullable?(OG(r)?o=r:(o.validators=r,o.asyncValidators=i),new ww(e,{...o,nonNullable:!0})):new ww(e,r,i)}array(e,r,i){const o=e.map(a=>this._createControl(a));return new wG(o,r,i)}_reduceControls(e){const r={};return Object.keys(e).forEach(i=>{r[i]=this._createControl(e[i])}),r}_createControl(e){return e instanceof ww||e instanceof KD?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Xy=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Rg,useValue:e.callSetDisabledState??yw}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[NG]})}return t})(),sT=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:WN,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Rg,useValue:e.callSetDisabledState??yw}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({imports:[NG]})}return t})();class qxe{constructor(n,e,r,i,o,a,c){this.id=n,this.name=e,this.urg=r,this.title=i,this.descriptif=o,this.statut=a,this.createdDate=c}}let Cw=(()=>{class t{constructor(){this._tasks=Pi([]),this.tasks=this._tasks.asReadonly(),this.todoTasks=ii(()=>this._tasks().filter(e=>"todo"===e.statut)),this.inProgressTasks=ii(()=>this._tasks().filter(e=>"inProgress"===e.statut)),this.doneTasks=ii(()=>this._tasks().filter(e=>"done"===e.statut)),this.initListener()}initListener(){Rd(Tn(Pn,"/tasks"),e=>{this._tasks.set(e.val()?e.val():[])})}saveTasks(){Cu(Tn(Pn,"/tasks"),this._tasks())}generateUniqueId(){return`${Date.now()}-${Math.random().toString(36).substring(2,15)}`}createNewTask(e){e.id=this.generateUniqueId(),this._tasks.update(r=>[...r,e]),this.saveTasks()}removeTask(e){this._tasks().some(i=>i.id===e)&&(this._tasks.update(i=>i.filter(o=>o.id!==e)),this.saveTasks())}getTaskById(e){return this._tasks().find(r=>r.id===e)||null}updateTaskById(e,r){this._tasks().some(o=>o.id===e)&&(this._tasks.update(o=>o.map(a=>a.id===e?r:a)),this.saveTasks())}updateTaskStatus(e){this._tasks.update(r=>r.map(i=>i.id===e.id?e:i)),this.saveTasks()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const Gxe=(t,n)=>n.uid;function Wxe(t,n){1&t&&(xn(),O(0,"svg",7),ut(1,"path",24),V())}function Zxe(t,n){1&t&&(xn(),O(0,"svg",25),ut(1,"path",24),V())}function Kxe(t,n){1&t&&ut(0,"img",26),2&t&&pn("src",ge().$implicit.photoURL,vs)}function Yxe(t,n){if(1&t){const e=Ut();O(0,"button",6),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().toggleUser(i.displayName||i.email||""))}),O(1,"div"),ot(2,Zxe,2,0,":svg:svg",25),V(),ot(3,Kxe,1,1,"img",26),O(4,"span",27),q(5),V()()}if(2&t){const e=n.$implicit,r=ge();is(r.isUserSelected(e.displayName||e.email||"")?"flex items-center gap-2 p-2.5 rounded-xl bg-family-purple/10 border-2 border-family-purple transition-all":"flex items-center gap-2 p-2.5 rounded-xl bg-gray-50 border-2 border-transparent hover:border-gray-200 transition-all"),Y(),is(r.isUserSelected(e.displayName||e.email||"")?"w-4 h-4 rounded flex-shrink-0 bg-family-purple flex items-center justify-center":"w-4 h-4 rounded flex-shrink-0 border-2 border-gray-300"),Y(),st(r.isUserSelected(e.displayName||e.email||"")?2:-1),Y(),st(e.photoURL?3:-1),Y(2),xt(e.displayName||e.email)}}let Xxe=(()=>{class t{constructor(e,r,i,o,a){this.formBuilder=e,this.ts=r,this.router=i,this._snackBar=o,this.userService=a,this.allUsers=[],this.selectedUsers=new Set,this.selectAll=!1}ngOnInit(){this.userService.getAllUsers().then(e=>{this.allUsers=e}).catch(()=>{this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3})}),this.initForm()}initForm(){this.addTaskForm=this.formBuilder.group({urg:["",[Fd.required]],title:["",[Fd.required]],descriptif:[""]})}toggleUser(e){this.selectedUsers.has(e)?this.selectedUsers.delete(e):this.selectedUsers.add(e),this.selectAll=!1}toggleSelectAll(){this.selectAll=!this.selectAll,this.selectAll&&this.selectedUsers.clear()}isUserSelected(e){return this.selectedUsers.has(e)}get hasSelection(){return this.selectAll||this.selectedUsers.size>0}goBack(){this.router.navigate(["/home"])}onSubmit(){if(!this.hasSelection)return void this._snackBar.open("S\xe9lectionne au moins une personne","",{duration:3e3});const e=this.selectAll?"Tout le monde":Array.from(this.selectedUsers).join(", "),r=this.addTaskForm.get("urg")?.value,i=this.addTaskForm.get("title")?.value,o=this.addTaskForm.get("descriptif")?.value,c=(new Date).toISOString(),f=new qxe("",e,r,i,o,"Nouveau",c);this.ts.createNewTask(f),this._snackBar.open("Tache ajout\xe9e","avec succ\xe8s !!",{duration:5e3}),this.router.navigate(["/home"])}static{this.\u0275fac=function(r){return new(r||t)(Ne(oT),Ne(Cw),Ne($s),Ne(xp),Ne(Od))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-add-task"]],decls:42,vars:7,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","mb-2","text-sm","font-medium","text-gray-600"],[1,"space-y-2"],["type","button",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-3","h-3","text-white"],[1,"font-medium","text-gray-700"],[1,"grid","grid-cols-2","gap-2"],["type","button",3,"class"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","","disabled",""],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","Decrivez la tache...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient","px-6","py-2","text-sm","font-medium",3,"disabled"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-2.5","h-2.5","text-white"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","object-cover",3,"src"],[1,"text-sm","font-medium","text-gray-700","truncate"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1)(2,"h3",2),q(3,"\u270f\ufe0f Ajouter une Tache"),V(),O(4,"form",3),Pe("ngSubmit",function(){return i.onSubmit()}),O(5,"div")(6,"label",4),q(7,"Tache pour"),V(),O(8,"div",5)(9,"button",6),Pe("click",function(){return i.toggleSelectAll()}),O(10,"div"),ot(11,Wxe,2,0,":svg:svg",7),V(),O(12,"span",8),q(13,"Tout le monde"),V()(),O(14,"div",9),On(15,Yxe,6,7,"button",10,Gxe),V()()(),O(17,"div")(18,"label",11),q(19,"Priorite"),V(),O(20,"select",12)(21,"option",13),q(22,"Choisir..."),V(),O(23,"option",14),q(24,"Urgent !"),V(),O(25,"option",15),q(26,"Relativement urgent"),V(),O(27,"option",16),q(28,"Pas Urgent"),V()()(),O(29,"div")(30,"label",17),q(31,"Titre"),V(),ut(32,"input",18),V(),O(33,"div")(34,"label",19),q(35,"Descriptif"),V(),ut(36,"textarea",20),V(),O(37,"div",21)(38,"button",22),Pe("click",function(){return i.goBack()}),q(39,"Retour"),V(),O(40,"button",23),q(41,"Ajouter"),V()()()()()),2&r&&(Y(4),pn("formGroup",i.addTaskForm),Y(5),is(i.selectAll?"w-full flex items-center gap-3 p-3 rounded-xl bg-gradient-to-r from-family-purple/10 to-family-pink/10 border-2 border-family-purple transition-all":"w-full flex items-center gap-3 p-3 rounded-xl bg-gray-50 border-2 border-transparent hover:border-gray-200 transition-all"),Y(),is(i.selectAll?"w-5 h-5 rounded-full bg-family-purple flex items-center justify-center":"w-5 h-5 rounded-full border-2 border-gray-300"),Y(),st(i.selectAll?11:-1),Y(4),Ln(i.allUsers),Y(25),pn("disabled",i.addTaskForm.invalid||!i.hasSelection))},dependencies:[sT,xw,Zy,Ky,zl,Up,Iu,pw,Yy,Wy,Gy,Ic],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:80%;margin:20px auto;padding:10px 30px}@media only screen and (min-width:1224px){.mat-card[_ngcontent-%COMP%]{width:80%}}"]})}}return t})();function Qxe(t,n){if(1&t&&(Yt(0,"p",14),q(1),Gt()),2&t){const e=ge();Y(),xt(e.errorMessage)}}let Jxe=(()=>{class t{constructor(e,r){this.authService=e,this.router=r,this.errorMessage=""}signInWithGoogle(){this.authService.signInWithGoogle().then(()=>{this.router.navigate(["/home"])},e=>{console.error("Google Sign-In error:",e);const r=e?.code||"";this.errorMessage="auth/popup-closed-by-user"===r||"auth/cancelled-popup-request"===r?"":`Erreur lors de la connexion Google (${r})`})}static{this.\u0275fac=function(r){return new(r||t)(Ne(Od),Ne($s))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-signin"]],decls:20,vars:1,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-family-pink","via-family-coral","to-family-orange","p-4"],[1,"w-full","max-w-md"],[1,"text-center","mb-8"],[1,"text-6xl","block","mb-2"],[1,"font-display","font-extrabold","text-3xl","text-white"],[1,"text-white/80","mt-1"],[1,"bg-white","rounded-3xl","shadow-fun","p-8"],[1,"font-display","font-bold","text-xl","text-center","text-gray-800","mb-6"],[1,"w-full","flex","items-center","justify-center","gap-3","px-6","py-3","rounded-2xl","border-2","border-gray-200","bg-white","hover:bg-gray-50","transition-all","hover:shadow-md","text-gray-700","font-semibold",3,"click"],["viewBox","0 0 24 24",1,"w-5","h-5"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],[1,"mt-4","text-red-400","text-center","text-sm"]],template:function(r,i){1&r&&(Yt(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),q(4,"\u{1f468}\u200d\u{1f469}\u200d\u{1f467}\u200d\u{1f466}"),Gt(),Yt(5,"h1",4),q(6,"Family App"),Gt(),Yt(7,"p",5),q(8,"Votre espace famille"),Gt()(),Yt(9,"div",6)(10,"h2",7),q(11,"Connexion \u{1f44b}"),Gt(),Yt(12,"button",8),ba("click",function(){return i.signInWithGoogle()}),xn(),Yt(13,"svg",9),md(14,"path",10)(15,"path",11)(16,"path",12)(17,"path",13),Gt(),q(18," Se connecter avec Google "),Gt(),ot(19,Qxe,2,1,"p",14),Gt()()()),2&r&&(Y(19),st(i.errorMessage?19:-1))},styles:["mat-card[_ngcontent-%COMP%]{width:300px;margin-top:20px}"]})}}return t})();function XN(t){const n=t.cloneNode(!0),e=n.querySelectorAll("[id]"),r=t.nodeName.toLowerCase();n.removeAttribute("id");for(let i=0;i<e.length;i++)e[i].removeAttribute("id");return"canvas"===r?BG(t,n):("input"===r||"select"===r||"textarea"===r)&&FG(t,n),LG("canvas",t,n,BG),LG("input, textarea, select",t,n,FG),n}function LG(t,n,e,r){const i=n.querySelectorAll(t);if(i.length){const o=e.querySelectorAll(t);for(let a=0;a<i.length;a++)r(i[a],o[a])}}let e1e=0;function FG(t,n){"file"!==n.type&&(n.value=t.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${e1e++}`)}function BG(t,n){const e=n.getContext("2d");if(e)try{e.drawImage(t,0,0)}catch{}}function QN(t){const n=t.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function JN(t,n,e){const{top:r,bottom:i,left:o,right:a}=t;return e>=r&&e<=i&&n>=o&&n<=a}function Dw(t,n,e){t.top+=n,t.bottom=t.top+t.height,t.left+=e,t.right=t.left+t.width}function VG(t,n,e,r){const{top:i,right:o,bottom:a,left:c,width:f,height:_}=t,x=f*n,C=_*n;return r>i-C&&r<a+C&&e>c-x&&e<o+x}class UG{_document;positions=new Map;constructor(n){this._document=n}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:QN(e)})})}handleScroll(n){const e=Fl(n),r=this.positions.get(e);if(!r)return null;const i=r.scrollPosition;let o,a;if(e===this._document){const _=this.getViewportScrollPosition();o=_.top,a=_.left}else o=e.scrollTop,a=e.scrollLeft;const c=i.top-o,f=i.left-a;return this.positions.forEach((_,x)=>{_.clientRect&&e!==x&&e.contains(x)&&Dw(_.clientRect,c,f)}),i.top=o,i.left=a,{top:c,left:f}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function zG(t,n){const e=t.rootNodes;if(1===e.length&&e[0].nodeType===n.ELEMENT_NODE)return e[0];const r=n.createElement("div");return e.forEach(i=>r.appendChild(i)),r}function eO(t,n,e){for(let r in n)if(n.hasOwnProperty(r)){const i=n[r];i?t.setProperty(r,i,e?.has(r)?"important":""):t.removeProperty(r)}return t}function Qy(t,n){const e=n?"":"none";eO(t.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function jG(t,n,e){eO(t.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},e)}function aT(t,n){return n&&"none"!=n?t+" "+n:t}function HG(t,n){t.style.width=`${n.width}px`,t.style.height=`${n.height}px`,t.style.transform=Tw(n.left,n.top)}function Tw(t,n){return`translate3d(${Math.round(t)}px, ${Math.round(n)}px, 0)`}const Sw={capture:!0},tO={passive:!1,capture:!0};let n1e=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=gr({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(r,i){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}\n"],encapsulation:2,changeDetection:0})}return t})(),lT=(()=>{class t{_ngZone=Q(sn);_document=Q(Wn);_styleLoader=Q(my);_renderer=Q(Rl).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new ee;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=Pi([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new ee;pointerUp=new ee;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,tO)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._cleanupDocumentTouchmove?.()}startDragging(e,r){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(n1e),this._activeDragInstances.update(i=>[...i,e]),1===this._activeDragInstances().length)){const i=r.type.startsWith("touch"),o=c=>this.pointerUp.next(c),a=[["scroll",c=>this._scroll.next(c),Sw],["selectstart",this._preventDefaultWhileDragging,tO]];i?a.push(["touchend",o,Sw],["touchcancel",o,Sw]):a.push(["mouseup",o,Sw]),i||a.push(["mousemove",c=>this.pointerMove.next(c),tO]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=a.map(([c,f,_])=>this._renderer.listen(this._document,c,f,_))})}}stopDragging(e){this._activeDragInstances.update(r=>{const i=r.indexOf(e);return i>-1?(r.splice(i,1),[...r]):r}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){const r=[this._scroll];return e&&e!==this._document&&r.push(new H(i=>this._ngZone.runOutsideAngular(()=>{const o=this._renderer.listen(e,"scroll",a=>{this._activeDragInstances().length&&i.next(a)},Sw);return()=>{o()}}))),CC(...r)}registerDirectiveNode(e,r){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,r)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function $G(t){const n=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*n}function nO(t,n){return t.getPropertyValue(n).split(",").map(r=>r.trim())}const i1e=new Set(["position"]);class o1e{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView=null;_preview;get element(){return this._preview}constructor(n,e,r,i,o,a,c,f,_,x){this._document=n,this._rootElement=e,this._direction=r,this._initialDomRect=i,this._previewTemplate=o,this._previewClass=a,this._pickupPositionOnPage=c,this._initialTransform=f,this._zIndex=_,this._renderer=x}attach(n){this._preview=this._createPreview(),n.appendChild(this._preview),qG(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(n){this._preview.style.transform=n}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(n){this._preview.classList.add(n)}getTransitionDuration(){return function r1e(t){const n=getComputedStyle(t),e=nO(n,"transition-property"),r=e.find(c=>"transform"===c||"all"===c);if(!r)return 0;const i=e.indexOf(r),o=nO(n,"transition-duration"),a=nO(n,"transition-delay");return $G(o[i])+$G(a[i])}(this._preview)}addEventListener(n,e){return this._renderer.listen(this._preview,n,e)}_createPreview(){const n=this._previewTemplate,e=this._previewClass,r=n?n.template:null;let i;if(r&&n){const o=n.matchSize?this._initialDomRect:null,a=n.viewContainer.createEmbeddedView(r,n.context);a.detectChanges(),i=zG(a,this._document),this._previewEmbeddedView=a,n.matchSize?HG(i,o):i.style.transform=Tw(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=XN(this._rootElement),HG(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return eO(i.style,{"pointer-events":"none",margin:qG(i)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},i1e),Qy(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(o=>i.classList.add(o)):i.classList.add(e)),i}}function qG(t){return"showPopover"in t}const s1e={passive:!0},GG={passive:!1},a1e={passive:!1,capture:!0},WG="cdk-drag-placeholder",ZG=new Set(["position"]);function KG(t,n,e={dragStartThreshold:5,pointerDirectionChangeThreshold:5}){const r=t.get(Xa,null,{optional:!0})||t.get(Rl).createRenderer(null,null);return new c1e(n,e,t.get(Wn),t.get(sn),t.get(yy),t.get(lT),r)}class c1e{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview=null;_previewContainer;_placeholderRef=null;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=Pi(!1);_hasMoved=!1;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new ee;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement=null;_rootElementTapHighlight;_pointerMoveSubscription=Qn.EMPTY;_pointerUpSubscription=Qn.EMPTY;_scrollSubscription=Qn.EMPTY;_resizeSubscription=Qn.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef=null;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){n!==this._disabled&&(this._disabled=n,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Qy(e,n)))}_disabled=!1;beforeStarted=new ee;started=new ee;released=new ee;ended=new ee;entered=new ee;exited=new ee;dropped=new ee;moved=this._moveEvents;data;constrainPosition;constructor(n,e,r,i,o,a,c){this._config=e,this._document=r,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=a,this._renderer=c,this.withRootElement(n).withParent(e.parentDragRef||null),this._parentPositions=new UG(r),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(r=>sl(r)),this._handles.forEach(r=>Qy(r,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(r=>{this._handles.indexOf(r)>-1&&e.add(r)}),this._disabledHandles=e,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const e=sl(n);if(e!==this._rootElement){this._removeRootElementListeners();const r=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[r.listen(e,"mousedown",this._pointerDown,GG),r.listen(e,"touchstart",this._pointerDown,s1e),r.listen(e,"dragstart",this._nativeDragStart,GG)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?sl(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&function t1e(t,n){return n.left<t.left||n.left+n.width>t.right||n.top<t.top||n.top+n.height>t.bottom}(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){const n=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect();let r=0,i=0;e.left<n.left?r=n.left-e.left:e.right>n.right&&(r=n.right-e.right),e.top<n.top?i=n.top-e.top:e.bottom>n.bottom&&(i=n.bottom-e.bottom);let c=this._activeTransform.x+r,f=this._activeTransform.y+i;this._rootElement.style.transform=Tw(c,f),this._activeTransform={x:c,y:f},this._passiveTransform={x:c,y:f}}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),Qy(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),Qy(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=n=>{if(this.beforeStarted.next(),this._handles.length){const e=this._getTargetHandle(n);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,n)}else this.disabled||this._initializeDragSequence(this._rootElement,n)};_pointerMove=n=>{const e=this._getPointerPositionOnPage(n);if(!this._hasStartedDragging()){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const c=Date.now()>=this._dragStartTime+this._getDragStartDelay(n),f=this._dropContainer;if(!c)return void this._endDragSequence(n);(!f||!f.isDragging()&&!f.isReceiving())&&(n.cancelable&&n.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(n)))}return}n.cancelable&&n.preventDefault();const r=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(r),this._dropContainer)this._updateActiveDropContainer(r,e);else{const i=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=r.x-i.x+this._passiveTransform.x,o.y=r.y-i.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:r,event:n,distance:this._getDragDistance(r),delta:this._pointerDirectionDelta})})};_pointerUp=n=>{this._endDragSequence(n)};_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){Iw(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._getShadowRoot(),r=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",u1e,a1e)}),r){const i=this._rootElement,o=i.parentNode,a=this._placeholder=this._createPlaceholderElement(),c=this._marker=this._marker||this._document.createComment("");o.insertBefore(c,i),this._initialTransform=i.style.transform||"",this._preview=new o1e(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,e)),jG(i,!1,ZG),this._document.body.appendChild(o.replaceChild(a,i)),this.started.next({source:this,event:n}),r.start(),this._initialContainer=r,this._initialIndex=r.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(r?r.getScrollableParents():[])}_initializeDragSequence(n,e){this._parentDragRef&&e.stopPropagation();const r=this.isDragging(),i=Iw(e),o=!i&&0!==e.button,a=this._rootElement,c=Fl(e),f=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),_=i?GA(e):qA(e);if(c&&c.draggable&&"mousedown"===e.type&&e.preventDefault(),r||o||f||_)return;if(this._handles.length){const A=a.style;this._rootElementTapHighlight=A.webkitTapHighlightColor||"",A.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(A=>this._updateOnScroll(A)),this._boundaryElement&&(this._boundaryRect=QN(this._boundaryElement));const x=this._previewTemplate;this._pickupPositionInElement=x&&x.template&&!x.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,n,e);const C=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:C.x,y:C.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(n){jG(this._rootElement,!0,ZG),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,r=e.getItemIndex(this),i=this._getPointerPositionOnPage(n),o=this._getDragDistance(i),a=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:o,dropPoint:i,event:n}),this.dropped.next({item:this,currentIndex:r,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:o,dropPoint:i,event:n}),e.drop(this,r,this._initialIndex,this._initialContainer,a,o,i,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:e},{x:r,y:i}){let o=this._initialContainer._getSiblingContainerFromPosition(this,n,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{const a=this._dropContainer.getItemIndex(this),c=this._dropContainer.getItemAtIndex(a+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,c),this._dropContainer=o,this._dropContainer.enter(this,n,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(r,i),this._dropContainer._sortItem(this,n,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,e):this._applyPreviewTransform(n-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const e=this._preview.getTransitionDuration();return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(r=>{const i=c=>{(!c||this._preview&&Fl(c)===this._preview.element&&"transform"===c.propertyName)&&(a(),r(),clearTimeout(o))},o=setTimeout(i,1.5*e),a=this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,e=n?n.template:null;let r;return e?(this._placeholderRef=n.viewContainer.createEmbeddedView(e,n.context),this._placeholderRef.detectChanges(),r=zG(this._placeholderRef,this._document)):r=XN(this._rootElement),r.style.pointerEvents="none",r.classList.add(WG),r}_getPointerPositionInElement(n,e,r){const i=e===this._rootElement?null:e,o=i?i.getBoundingClientRect():n,a=Iw(r)?r.targetTouches[0]:r,c=this._getViewportScrollPosition();return{x:o.left-n.left+(a.pageX-o.left-c.left),y:o.top-n.top+(a.pageY-o.top-c.top)}}_getPointerPositionOnPage(n){const e=this._getViewportScrollPosition(),r=Iw(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,i=r.pageX-e.left,o=r.pageY-e.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const c=this._ownerSVGElement.createSVGPoint();return c.x=i,c.y=o,c.matrixTransform(a.inverse())}}return{x:i,y:o}}_getConstrainedPointerPosition(n){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:r,y:i}=this.constrainPosition?this.constrainPosition(n,this,this._initialDomRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===e?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===e)&&(r=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:o,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,c=this._boundaryRect,{width:f,height:_}=this._getPreviewRect(),x=c.top+a,C=c.bottom-(_-a);r=YG(r,c.left+o,c.right-(f-o)),i=YG(i,x,C)}return{x:r,y:i}}_updatePointerDirectionDelta(n){const{x:e,y:r}=n,i=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,a=Math.abs(e-o.x),c=Math.abs(r-o.y);return a>this._config.pointerDirectionChangeThreshold&&(i.x=e>o.x?1:-1,o.x=e),c>this._config.pointerDirectionChangeThreshold&&(i.y=r>o.y?1:-1,o.y=r),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,Qy(this._rootElement,n))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(n=>n()),this._rootElementCleanups=void 0}_applyRootElementTransform(n,e){const r=1/this.scale,i=Tw(n*r,e*r),o=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=o.transform&&"none"!=o.transform?o.transform:""),o.transform=aT(i,this._initialTransform)}_applyPreviewTransform(n,e){const r=this._previewTemplate?.template?void 0:this._initialTransform,i=Tw(n,e);this._preview.setTransform(aT(i,r))}_getDragDistance(n){const e=this._pickupPositionOnPage;return e?{x:n.x-e.x,y:n.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:e}=this._passiveTransform;if(0===n&&0===e||this.isDragging()||!this._boundaryElement)return;const r=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===r.width&&0===r.height)return;const o=i.left-r.left,a=r.right-i.right,c=i.top-r.top,f=r.bottom-i.bottom;i.width>r.width?(o>0&&(n+=o),a>0&&(n-=a)):n=0,i.height>r.height?(c>0&&(e+=c),f>0&&(e-=f)):e=0,(n!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:n})}_getDragStartDelay(n){const e=this.dragStartDelay;return"number"==typeof e?e:Iw(n)?e.touch:e?e.mouse:0}_updateOnScroll(n){const e=this._parentPositions.handleScroll(n);if(e){const r=Fl(n);this._boundaryRect&&r!==this._boundaryElement&&r.contains(this._boundaryElement)&&Dw(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=aC(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,e){const r=this._previewContainer||"global";if("parent"===r)return n;if("global"===r){const i=this._document;return e||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return sl(r)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=n=>{if(this._handles.length){const e=this._getTargetHandle(n);e&&!this._disabledHandles.has(e)&&!this.disabled&&n.preventDefault()}else this.disabled||n.preventDefault()};_getTargetHandle(n){return this._handles.find(e=>n.target&&(n.target===e||e.contains(n.target)))}_conditionallyInsertAnchor(n,e,r){if(n===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){const i=this._anchor??=XN(this._placeholder);i.classList.remove(WG),i.classList.add("cdk-drag-anchor"),i.style.transform="",r?r.before(i):sl(e.element).appendChild(i)}}}function YG(t,n,e){return Math.max(n,Math.min(e,t))}function Iw(t){return"t"===t.type[0]}function u1e(t){t.preventDefault()}function rO(t,n,e){const r=kw(n,t.length-1),i=kw(e,t.length-1);if(r===i)return;const o=t[r],a=i<r?-1:1;for(let c=r;c!==i;c+=a)t[c]=t[c+a];t[i]=o}function kw(t,n){return Math.max(0,Math.min(n,t))}class XG{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction="ltr";constructor(n){this._dragDropRegistry=n}_previousSwap={drag:null,delta:0,overlaps:!1};start(n){this.withItems(n)}sort(n,e,r,i){const o=this._itemPositions,a=this._getItemIndexFromPointerPosition(n,e,r,i);if(-1===a&&o.length>0)return null;const c="horizontal"===this.orientation,f=o.findIndex(ce=>ce.drag===n),_=o[a],C=_.clientRect,A=f>a?1:-1,N=this._getItemOffsetPx(o[f].clientRect,C,A),U=this._getSiblingOffsetPx(f,o,A),ne=o.slice();return rO(o,f,a),o.forEach((ce,xe)=>{if(ne[xe]===ce)return;const Ce=ce.drag===n,Ze=Ce?N:U,Se=Ce?n.getPlaceholderElement():ce.drag.getRootElement();ce.offset+=Ze;const Ee=Math.round(ce.offset*(1/ce.drag.scale));c?(Se.style.transform=aT(`translate3d(${Ee}px, 0, 0)`,ce.initialTransform),Dw(ce.clientRect,0,Ze)):(Se.style.transform=aT(`translate3d(0, ${Ee}px, 0)`,ce.initialTransform),Dw(ce.clientRect,Ze,0))}),this._previousSwap.overlaps=JN(C,e,r),this._previousSwap.drag=_.drag,this._previousSwap.delta=c?i.x:i.y,{previousIndex:f,currentIndex:a}}enter(n,e,r,i){const o=null==i||i<0?this._getItemIndexFromPointerPosition(n,e,r):i,a=this._activeDraggables,c=a.indexOf(n),f=n.getPlaceholderElement();let _=a[o];if(_===n&&(_=a[o+1]),!_&&(null==o||-1===o||o<a.length-1)&&this._shouldEnterAsFirstChild(e,r)&&(_=a[0]),c>-1&&a.splice(c,1),_&&!this._dragDropRegistry.isDragging(_)){const x=_.getRootElement();x.parentElement.insertBefore(f,x),a.splice(o,0,n)}else this._element.appendChild(f),a.push(n);f.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables?.forEach(n=>{const e=n.getRootElement();if(e){const r=this._itemPositions.find(i=>i.drag===n)?.initialTransform;e.style.transform=r||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return this._getVisualItemPositions().findIndex(e=>e.drag===n)}getItemAtIndex(n){return this._getVisualItemPositions()[n]?.drag||null}updateOnScroll(n,e){this._itemPositions.forEach(({clientRect:r})=>{Dw(r,n,e)}),this._itemPositions.forEach(({drag:r})=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(n){this._element=n}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(e=>{const r=e.getVisibleElement();return{drag:e,offset:0,initialTransform:r.style.transform||"",clientRect:QN(r)}}).sort((e,r)=>n?e.clientRect.left-r.clientRect.left:e.clientRect.top-r.clientRect.top)}_getVisualItemPositions(){return"horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(n,e,r){const i="horizontal"===this.orientation;let o=i?e.left-n.left:e.top-n.top;return-1===r&&(o+=i?e.width-n.width:e.height-n.height),o}_getSiblingOffsetPx(n,e,r){const i="horizontal"===this.orientation,o=e[n].clientRect,a=e[n+-1*r];let c=o[i?"width":"height"]*r;if(a){const f=i?"left":"top",_=i?"right":"bottom";-1===r?c-=a.clientRect[f]-o[_]:c+=o[f]-a.clientRect[_]}return c}_shouldEnterAsFirstChild(n,e){if(!this._activeDraggables.length)return!1;const r=this._itemPositions,i="horizontal"===this.orientation;if(r[0].drag!==this._activeDraggables[0]){const a=r[r.length-1].clientRect;return i?n>=a.right:e>=a.bottom}{const a=r[0].clientRect;return i?n<=a.left:e<=a.top}}_getItemIndexFromPointerPosition(n,e,r,i){const o="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:c,clientRect:f})=>c!==n&&((!i||c!==this._previousSwap.drag||!this._previousSwap.overlaps||(o?i.x:i.y)!==this._previousSwap.delta)&&(o?e>=Math.floor(f.left)&&e<Math.floor(f.right):r>=Math.floor(f.top)&&r<Math.floor(f.bottom))));return-1!==a&&this._sortPredicate(a,n)?a:-1}}class d1e{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(n,e){this._document=n,this._dragDropRegistry=e}start(n){const e=this._element.childNodes;this._relatedNodes=[];for(let r=0;r<e.length;r++){const i=e[r];this._relatedNodes.push([i,i.nextSibling])}this.withItems(n)}sort(n,e,r,i){const o=this._getItemIndexFromPointerPosition(n,e,r),a=this._previousSwap;if(-1===o||this._activeItems[o]===n)return null;const c=this._activeItems[o];if(a.drag===c&&a.overlaps&&a.deltaX===i.x&&a.deltaY===i.y)return null;const f=this.getItemIndex(n),_=n.getPlaceholderElement(),x=c.getRootElement();o>f?x.after(_):x.before(_),rO(this._activeItems,f,o);const C=this._getRootNode().elementFromPoint(e,r);return a.deltaX=i.x,a.deltaY=i.y,a.drag=c,a.overlaps=x===C||x.contains(C),{previousIndex:f,currentIndex:o}}enter(n,e,r,i){const o=this._activeItems.indexOf(n);o>-1&&this._activeItems.splice(o,1);let a=null==i||i<0?this._getItemIndexFromPointerPosition(n,e,r):i;-1===a&&(a=this._getClosestItemIndexToPointer(n,e,r));const c=this._activeItems[a];c&&!this._dragDropRegistry.isDragging(c)?(this._activeItems.splice(a,0,n),c.getRootElement().before(n.getPlaceholderElement())):(this._activeItems.push(n),this._element.appendChild(n.getPlaceholderElement()))}withItems(n){this._activeItems=n.slice()}withSortPredicate(n){this._sortPredicate=n}reset(){const n=this._element,e=this._previousSwap;for(let r=this._relatedNodes.length-1;r>-1;r--){const[i,o]=this._relatedNodes[r];i.parentNode===n&&i.nextSibling!==o&&(null===o?n.appendChild(i):o.parentNode===n&&n.insertBefore(i,o))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(n){return this._activeItems.indexOf(n)}getItemAtIndex(n){return this._activeItems[n]||null}updateOnScroll(){this._activeItems.forEach(n=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(n){n!==this._element&&(this._element=n,this._rootNode=void 0)}_getItemIndexFromPointerPosition(n,e,r){const i=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(r)),o=i?this._activeItems.findIndex(a=>{const c=a.getRootElement();return i===c||c.contains(i)}):-1;return-1!==o&&this._sortPredicate(o,n)?o:-1}_getRootNode(){return this._rootNode||(this._rootNode=aC(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(n,e,r){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let i=1/0,o=-1;for(let a=0;a<this._activeItems.length;a++){const c=this._activeItems[a];if(c!==n){const{x:f,y:_}=c.getRootElement().getBoundingClientRect(),x=Math.hypot(e-f,r-_);x<i&&(i=x,o=a)}}return o}}var Lc=function(t){return t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t}(Lc||{}),Sa=function(t){return t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t}(Sa||{});function e7(t,n){return new h1e(n,t.get(lT),t.get(Wn),t.get(sn),t.get(yy))}class h1e{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new ee;entered=new ee;exited=new ee;dropped=new ee;sorted=new ee;receivingStarted=new ee;receivingStopped=new ee;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Qn.EMPTY;_verticalScrollDirection=Lc.NONE;_horizontalScrollDirection=Sa.NONE;_scrollNode;_stopScrollTimers=new ee;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(n,e,r,i,o){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=o;const a=this.element=sl(n);this._document=r,this.withOrientation("vertical").withElementContainer(a),e.registerDropContainer(this),this._parentPositions=new UG(r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,e,r,i){this._draggingStarted(),null==i&&this.sortingDisabled&&(i=this._draggables.indexOf(n)),this._sortStrategy.enter(n,e,r,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,e,r,i,o,a,c,f={}){this._reset(),this.dropped.next({item:n,currentIndex:e,previousIndex:r,container:this,previousContainer:i,isPointerOverContainer:o,distance:a,dropPoint:c,event:f})}withItems(n){const e=this._draggables;return this._draggables=n,n.forEach(r=>r._withDropContainer(this)),this.isDragging()&&(e.filter(i=>i.isDragging()).every(i=>-1===n.indexOf(i))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._direction=n,this._sortStrategy instanceof XG&&(this._sortStrategy.direction=n),this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){if("mixed"===n)this._sortStrategy=new d1e(this._document,this._dragDropRegistry);else{const e=new XG(this._dragDropRegistry);e.direction=this._direction,e.orientation=n,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,r)=>this.sortPredicate(e,r,this)),this}withScrollableParents(n){const e=this._container;return this._scrollableElements=-1===n.indexOf(e)?[e,...n]:n.slice(),this}withElementContainer(n){if(n===this._container)return this;sl(this.element);const r=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(n);return r>-1&&this._scrollableElements.splice(r,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(n),this._cachedShadowRoot=null,this._scrollableElements.unshift(n),this._container=n,this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}getItemAtIndex(n){return this._isDragging?this._sortStrategy.getItemAtIndex(n):this._draggables[n]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,e,r,i){if(this.sortingDisabled||!this._domRect||!VG(this._domRect,.05,e,r))return;const o=this._sortStrategy.sort(n,e,r,i);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,e){if(this.autoScrollDisabled)return;let r,i=Lc.NONE,o=Sa.NONE;if(this._parentPositions.positions.forEach((a,c)=>{c===this._document||!a.clientRect||r||VG(a.clientRect,.05,n,e)&&([i,o]=function f1e(t,n,e,r,i){const o=t7(n,i),a=n7(n,r);let c=Lc.NONE,f=Sa.NONE;if(o){const _=t.scrollTop;o===Lc.UP?_>0&&(c=Lc.UP):t.scrollHeight-_>t.clientHeight&&(c=Lc.DOWN)}if(a){const _=t.scrollLeft;"rtl"===e?a===Sa.RIGHT?_<0&&(f=Sa.RIGHT):t.scrollWidth+_>t.clientWidth&&(f=Sa.LEFT):a===Sa.LEFT?_>0&&(f=Sa.LEFT):t.scrollWidth-_>t.clientWidth&&(f=Sa.RIGHT)}return[c,f]}(c,a.clientRect,this._direction,n,e),(i||o)&&(r=c))}),!i&&!o){const{width:a,height:c}=this._viewportRuler.getViewportSize(),f={width:a,height:c,top:0,right:a,bottom:c,left:0};i=t7(f,e),o=n7(f,n),r=window}r&&(i!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||r!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=o,this._scrollNode=r,(i||o)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const n=this._container.style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Lq(0,Oj).pipe(vd(this._stopScrollTimers)).subscribe(()=>{const n=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===Lc.UP?n.scrollBy(0,-e):this._verticalScrollDirection===Lc.DOWN&&n.scrollBy(0,e),this._horizontalScrollDirection===Sa.LEFT?n.scrollBy(-e,0):this._horizontalScrollDirection===Sa.RIGHT&&n.scrollBy(e,0)})};_isOverContainer(n,e){return null!=this._domRect&&JN(this._domRect,n,e)}_getSiblingContainerFromPosition(n,e,r){return this._siblings.find(i=>i._canReceive(n,e,r))}_canReceive(n,e,r){if(!this._domRect||!JN(this._domRect,e,r)||!this.enterPredicate(n,this))return!1;const i=this._getShadowRoot().elementFromPoint(e,r);return!!i&&(i===this._container||this._container.contains(i))}_startReceiving(n,e){const r=this._activeSiblings;!r.has(n)&&e.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(r.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:e}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(n);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=aC(this._container);this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,n))}}function t7(t,n){const{top:e,bottom:r,height:i}=t,o=.05*i;return n>=e-o&&n<=e+o?Lc.UP:n>=r-o&&n<=r+o?Lc.DOWN:Lc.NONE}function n7(t,n){const{left:e,right:r,width:i}=t,o=.05*i;return n>=e-o&&n<=e+o?Sa.LEFT:n>=r-o&&n<=r+o?Sa.RIGHT:Sa.NONE}let p1e=(()=>{class t{_injector=Q(An);constructor(){}createDrag(e,r){return KG(this._injector,e,r)}createDropList(e){return e7(this._injector,e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Aw=new Ue("CDK_DRAG_PARENT"),r7=new Ue("CdkDragHandle"),i7=new Ue("CDK_DRAG_CONFIG"),o7=new Ue("CdkDropList");let s7=(()=>{class t{element=Q(Ur);dropContainer=Q(o7,{optional:!0,skipSelf:!0});_ngZone=Q(sn);_viewContainerRef=Q(Pl);_dir=Q(_y,{optional:!0});_changeDetectorRef=Q(Mh);_selfHandle=Q(r7,{optional:!0,self:!0});_parentDrag=Q(Aw,{optional:!0,skipSelf:!0});_dragDropRegistry=Q(lT);_destroyed=new ee;_handles=new ae([]);_previewTemplate=null;_placeholderTemplate=null;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!(!this.dropContainer||!this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled=!1;constrainPosition;previewClass;previewContainer;scale=1;started=new Zn;released=new Zn;ended=new Zn;entered=new Zn;exited=new Zn;dropped=new Zn;moved=new H(e=>{const r=this._dragRef.moved.pipe(mr(i=>({source:this,pointerPosition:i.pointerPosition,event:i.event,delta:i.delta,distance:i.distance}))).subscribe(e);return()=>{r.unsubscribe()}});_injector=Q(An);constructor(){const e=this.dropContainer,r=Q(i7,{optional:!0});this._dragRef=KG(this._injector,this.element,{dragStartThreshold:r&&null!=r.dragStartThreshold?r.dragStartThreshold:5,pointerDirectionChangeThreshold:r&&null!=r.pointerDirectionChangeThreshold?r.pointerDirectionChangeThreshold:5,zIndex:r?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),r&&this._assignDefaults(r),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(vd(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){hu(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){const r=e.rootElementSelector,i=e.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){const r=this._handles.getValue();r.push(e),this._handles.next(r)}_removeHandle(e){const r=this._handles.getValue(),i=r.indexOf(e);i>-1&&(r.splice(i,1),this._handles.next(r))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const e=this.element.nativeElement;let r=e;this.rootElementSelector&&(r=void 0!==e.closest?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||e)}_getBoundaryElement(){const e=this.boundaryElement;return e?"string"==typeof e?this.element.nativeElement.closest(e):sl(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const r=this._dir,i=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay="object"==typeof i&&i?i:lC(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),r&&e.withDirection(r.value)}}),e.beforeStarted.pipe(Hs(1)).subscribe(()=>{if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let r=this.element.nativeElement.parentElement;for(;r;){const i=this._dragDropRegistry.getDragDirectiveForNode(r);if(i){e.withParent(i._dragRef);break}r=r.parentElement}})}_handleEvents(e){e.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),e.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),e.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),e.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(e){const{lockAxis:r,dragStartDelay:i,constrainPosition:o,previewClass:a,boundaryElement:c,draggingDisabled:f,rootElementSelector:_,previewContainer:x}=e;this.disabled=f??!1,this.dragStartDelay=i||0,this.lockAxis=r||null,o&&(this.constrainPosition=o),a&&(this.previewClass=a),c&&(this.boundaryElement=c),_&&(this.rootElementSelector=_),x&&(this.previewContainer=x)}_setupHandlesListener(){this._handles.pipe(Fh(e=>{const r=e.map(i=>i.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),il(e=>CC(...e.map(r=>r._stateChanges.pipe(ly(r))))),vd(this._destroyed)).subscribe(e=>{const r=this._dragRef,i=e.element.nativeElement;e.disabled?r.disableHandle(i):r.enableHandle(i)})}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,i){2&r&&js("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",ws],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",M4]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Mr([{provide:Aw,useExisting:t}]),Ho]})}return t})();const iO=new Ue("CdkDropListGroup");let a7=(()=>{class t{_items=new Set;disabled=!1;ngOnDestroy(){this._items.clear()}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:[2,"cdkDropListGroupDisabled","disabled",ws]},exportAs:["cdkDropListGroup"],features:[Mr([{provide:iO,useExisting:t}])]})}return t})(),l7=(()=>{class t{element=Q(Ur);_changeDetectorRef=Q(Mh);_scrollDispatcher=Q(wC);_dir=Q(_y,{optional:!0});_group=Q(iO,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new ee;_scrollableParentsResolved=!1;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation="vertical";id=Q(vu).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled=!1;sortingDisabled=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled=!1;autoScrollStep;elementContainerSelector=null;hasAnchor=!1;dropped=new Zn;entered=new Zn;exited=new Zn;sorted=new Zn;_unsortedItems=new Set;constructor(){const e=Q(i7,{optional:!0}),r=Q(An);this._dropListRef=e7(r,this.element),this._dropListRef.data=this,e&&this._assignDefaults(e),this._dropListRef.enterPredicate=(i,o)=>this.enterPredicate(i.data,o.data),this._dropListRef.sortPredicate=(i,o,a)=>this.sortPredicate(i,o.data,a.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){const r=this._latestSortedRefs.indexOf(e._dragRef);r>-1&&(this._latestSortedRefs.splice(r,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,r)=>e._dragRef.getVisibleElement().compareDocumentPosition(r._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(ly(this._dir.value),vd(this._destroyed)).subscribe(r=>e.withDirection(r)),e.beforeStarted.subscribe(()=>{const r=c0(this.connectedTo).map(i=>"string"==typeof i?t._dropLists.find(a=>a.id===i):i);if(this._group&&this._group._items.forEach(i=>{-1===r.indexOf(i)&&r.push(i)}),!this._scrollableParentsResolved){const i=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(i),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){const i=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(i)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=lC(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(r.filter(i=>i&&i!==this).map(i=>i._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(r=>{this.entered.emit({container:this,item:r.item.data,currentIndex:r.currentIndex})}),e.exited.subscribe(r=>{this.exited.emit({container:this,item:r.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(r=>{this.sorted.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:r.item.data})}),e.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,item:r.item.data,isPointerOverContainer:r.isPointerOverContainer,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),CC(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){const{lockAxis:r,draggingDisabled:i,sortingDisabled:o,listAutoScrollDisabled:a,listOrientation:c}=e;this.disabled=i??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=a??!1,this.orientation=c||"vertical",this.lockAxis=r||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(r,i){2&r&&(na("id",i.id),js("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",ws],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",ws],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",ws],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",ws]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Mr([{provide:iO,useValue:void 0},{provide:o7,useExisting:t}])]})}return t})(),v1e=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ao({type:t});static \u0275inj=Hr({providers:[p1e],imports:[cM]})}return t})(),b1e=(()=>{class t{constructor(e){this.tasksService=e}transferTask(e,r,i,o){const a={...r,statut:o};this.tasksService.updateTaskStatus(a),e.splice(e.indexOf(r),1),i.push(a)}static{this.\u0275fac=function(r){return new(r||t)(Tt(Cw))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function w1e(t,n){1&t&&ut(0,"img",24),2&t&&pn("src",n.$implicit,vs)}function x1e(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"div",19),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().onEdit(i.id))}),O(2,"span",20),q(3),V(),O(4,"h4",21),q(5),V(),O(6,"div",22)(7,"div",23),On(8,w1e,1,1,"img",24,nl),V(),O(10,"span",25),q(11),V()()()()}if(2&t){const e=n.$implicit,r=ge();Y(2),pn("ngClass",r.getUrgencyClass(e.urg)),Y(),xt(e.urg),Y(2),xt(e.title),Y(3),Ln(r.getAssigneeAvatars(e)),Y(3),xt(e.name)}}function E1e(t,n){1&t&&ut(0,"img",24),2&t&&pn("src",n.$implicit,vs)}function C1e(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"div",26),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().onEdit(i.id))}),O(2,"span",20),q(3),V(),O(4,"h4",21),q(5),V(),O(6,"div",22)(7,"div",23),On(8,E1e,1,1,"img",24,nl),V(),O(10,"span",25),q(11),V()()()()}if(2&t){const e=n.$implicit,r=ge();Y(2),pn("ngClass",r.getUrgencyClass(e.urg)),Y(),xt(e.urg),Y(2),xt(e.title),Y(3),Ln(r.getAssigneeAvatars(e)),Y(3),xt(e.name)}}function D1e(t,n){1&t&&ut(0,"img",24),2&t&&pn("src",n.$implicit,vs)}function T1e(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"div",27),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().onEdit(i.id))}),O(2,"span",20),q(3),V(),O(4,"h4",21),q(5),V(),O(6,"div",22)(7,"div",23),On(8,D1e,1,1,"img",24,nl),V(),O(10,"span",25),q(11),V()()()()}if(2&t){const e=n.$implicit,r=ge();Y(2),pn("ngClass",r.getUrgencyClass(e.urg)),Y(),xt(e.urg),Y(2),xt(e.title),Y(3),Ln(r.getAssigneeAvatars(e)),Y(3),xt(e.name)}}function S1e(t,n){1&t&&ut(0,"img",24),2&t&&pn("src",n.$implicit,vs)}function I1e(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"div",28),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().onEdit(i.id))}),O(2,"span",20),q(3),V(),O(4,"h4",21),q(5),V(),O(6,"div",22)(7,"div",23),On(8,S1e,1,1,"img",24,nl),V(),O(10,"span",25),q(11),V()()()()}if(2&t){const e=n.$implicit,r=ge();Y(2),pn("ngClass",r.getUrgencyClass(e.urg)),Y(),xt(e.urg),Y(2),xt(e.title),Y(3),Ln(r.getAssigneeAvatars(e)),Y(3),xt(e.name)}}function k1e(t,n){1&t&&ut(0,"img",24),2&t&&pn("src",n.$implicit,vs)}function A1e(t,n){if(1&t){const e=Ut();O(0,"div",10)(1,"div",29),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().onEdit(i.id))}),O(2,"span",20),q(3),V(),O(4,"h4",21),q(5),V(),O(6,"div",22)(7,"div",23),On(8,k1e,1,1,"img",24,nl),V(),O(10,"span",25),q(11),V()()()()}if(2&t){const e=n.$implicit,r=ge();Y(2),pn("ngClass",r.getUrgencyClass(e.urg)),Y(),xt(e.urg),Y(2),xt(e.title),Y(3),Ln(r.getAssigneeAvatars(e)),Y(3),xt(e.name)}}let M1e=(()=>{class t{constructor(e,r,i,o,a){this.ts=e,this.dialog=r,this.router=i,this.kanbanService=o,this.authService=a,this.userAvatars={},this.allUserAvatars=[],this.new=[],this.en_cours=[],this.fait=[],this.bloquer=[],this.archiver=[],Do(()=>{const c=this.ts.tasks();this.new=c.filter(f=>"Nouveau"===f.statut),this.en_cours=c.filter(f=>"En cours"===f.statut),this.fait=c.filter(f=>"Fait"===f.statut),this.bloquer=c.filter(f=>"Bloque"===f.statut),this.archiver=c.filter(f=>"Archive"===f.statut)})}ngOnInit(){this.authService.getAllUsers().then(e=>{e.forEach(r=>{r.displayName&&r.photoURL&&(this.userAvatars[r.displayName]=r.photoURL,this.allUserAvatars.push(r.photoURL))})})}isForEveryone(e){return"Tout le monde"===e.name}getAssigneeAvatars(e){return this.isForEveryone(e)?this.allUserAvatars:e.name.split(",").map(i=>i.trim()).map(i=>this.userAvatars[i]).filter(i=>null!=i)}drop(e){if(e.previousContainer===e.container)rO(e.container.data,e.previousIndex,e.currentIndex);else{const r=e.previousContainer.data[e.previousIndex],i=this.getStatusFromContainer(e.container.id);this.kanbanService.transferTask(e.previousContainer.data,r,e.container.data,i)}}getStatusFromContainer(e){switch(e){case"newContainer":default:return"Nouveau";case"inProgressContainer":return"En cours";case"doneContainer":return"Fait";case"bloqueContainer":return"Bloque";case"archiveContainer":return"Archive"}}getUrgencyClass(e){switch(e){case"Urgent":return"flex h-6 items-center rounded-full bg-red-100 px-3 text-xs font-semibold text-red-600";case"Relativement urgent":return"flex h-6 items-center rounded-full bg-yellow-100 px-3 text-xs font-semibold text-yellow-600";case"Pas urgent":return"flex h-6 items-center rounded-full bg-green-100 px-3 text-xs font-semibold text-green-600";default:return"flex h-6 items-center rounded-full bg-gray-100 px-3 text-xs font-semibold text-gray-600"}}onEdit(e){this.router.navigate(["/task/edit",e])}static{this.\u0275fac=function(r){return new(r||t)(Ne(Cw),Ne(hg),Ne($s),Ne(b1e),Ne(Od))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-kanban"]],decls:50,vars:10,consts:[["cdkDropListGroup","",1,"flex","flex-col"],[1,"flex","flex-grow","space-x-4","overflow-x-auto","pb-4"],[1,"flex","w-64","flex-shrink-0","flex-col"],[1,"flex","items-center","px-2","mb-3"],[1,"font-display","font-bold","text-gray-700"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-sky/20","text-xs","font-bold","text-family-sky"],["routerLink","/add-task",1,"ml-auto","text-family-pink","hover:text-family-coral","transition-colors"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v12m6-6H6"],["id","newContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag",""],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-orange/20","text-xs","font-bold","text-family-orange"],["id","inProgressContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-green/20","text-xs","font-bold","text-family-green"],["id","doneContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-red-100","text-xs","font-bold","text-red-500"],["id","bloqueContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-purple/20","text-xs","font-bold","text-family-purple"],["id","archiveContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-sky","hover:shadow-card-hover","transition-shadow",3,"click"],[3,"ngClass"],[1,"mt-2","text-sm","font-semibold","text-gray-700"],[1,"flex","items-center","gap-1.5","mt-1"],[1,"flex","-space-x-1.5"],["referrerpolicy","no-referrer",1,"w-5","h-5","rounded-full","object-cover","ring-1","ring-white",3,"src"],[1,"text-xs","text-gray-400","truncate"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-orange","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-green","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-red-400","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-purple","hover:shadow-card-hover","transition-shadow",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),q(5,"\u{1f195} Nouveau"),V(),O(6,"span",5),q(7),V(),O(8,"button",6),xn(),O(9,"svg",7),ut(10,"path",8),V()()(),Ri(),O(11,"div",9),Pe("cdkDropListDropped",function(a){return i.drop(a)}),On(12,x1e,12,4,"div",10,nl),V()(),O(14,"div",2)(15,"div",3)(16,"span",4),q(17,"\u{1f504} En cours"),V(),O(18,"span",11),q(19),V()(),O(20,"div",12),Pe("cdkDropListDropped",function(a){return i.drop(a)}),On(21,C1e,12,4,"div",10,nl),V()(),O(23,"div",2)(24,"div",3)(25,"span",4),q(26,"\u2705 Fait"),V(),O(27,"span",13),q(28),V()(),O(29,"div",14),Pe("cdkDropListDropped",function(a){return i.drop(a)}),On(30,T1e,12,4,"div",10,nl),V()(),O(32,"div",2)(33,"div",3)(34,"span",4),q(35,"\u{1f6ab} Bloque"),V(),O(36,"span",15),q(37),V()(),O(38,"div",16),Pe("cdkDropListDropped",function(a){return i.drop(a)}),On(39,I1e,12,4,"div",10,nl),V()(),O(41,"div",2)(42,"div",3)(43,"span",4),q(44,"\u{1f4e6} Archive"),V(),O(45,"span",17),q(46),V()(),O(47,"div",18),Pe("cdkDropListDropped",function(a){return i.drop(a)}),On(48,A1e,12,4,"div",10,nl),V()()()()),2&r&&(Y(7),xt(i.new.length||0),Y(4),pn("cdkDropListData",i.new),Y(),Ln(i.new),Y(7),xt(i.en_cours.length),Y(),pn("cdkDropListData",i.en_cours),Y(),Ln(i.en_cours),Y(7),xt(i.fait.length),Y(),pn("cdkDropListData",i.fait),Y(),Ln(i.fait),Y(7),xt(i.bloquer.length),Y(),pn("cdkDropListData",i.bloquer),Y(),Ln(i.bloquer),Y(7),xt(i.archiver.length),Y(),pn("cdkDropListData",i.archiver),Y(),Ln(i.archiver))},dependencies:[Ic,nz,v1e,l7,a7,s7,t0,yp],styles:[".drop-container[_ngcontent-%COMP%]{min-height:100vh;border:1px dashed #ccc}"]})}}return t})(),c7=(()=>{class t{constructor(){this._vacations=Pi([]),this.vacations=this._vacations.asReadonly(),this.upcomingVacations=ii(()=>{const e=new Date;return this._vacations().filter(r=>new Date(r.startDate)>e)}),this.nextVacation=ii(()=>this.upcomingVacations()[0]||null),this.vacationsRef=Tn(Pn,"/vacations"),this.initListener()}initListener(){Rd(this.vacationsRef,e=>{const r=e.val();if(!r)return void this._vacations.set([]);const i=Object.keys(r).map(o=>({...r[o],id:o}));i.sort((o,a)=>new Date(o.startDate).getTime()-new Date(a.startDate).getTime()),this._vacations.set(i)})}addVacation(e){var r=this;return fe(function*(){const i=Jh(r.vacationsRef);return yield Cu(i,{...e,id:i.key}),i.key})()}updateVacation(e,r){return fe(function*(){yield Md(Tn(Pn,`/vacations/${e}`),r)})()}deleteVacation(e){return fe(function*(){yield ef(Tn(Pn,`/vacations/${e}`))})()}listenChecklist(e,r){const i=Tn(Pn,`/vacations/${e}/checklist`);return Rd(i,o=>{const a=o.val();r(a?Object.keys(a).map(c=>({...a[c],id:c})):[])}),()=>LD(i)}addChecklistItem(e,r){return fe(function*(){const i=pi.currentUser,o=Jh(Tn(Pn,`/vacations/${e}/checklist`));yield Cu(o,{id:o.key,text:r,checked:!1,addedBy:i?.displayName||""})})()}toggleChecklistItem(e,r,i){return fe(function*(){yield Md(Tn(Pn,`/vacations/${e}/checklist/${r}`),{checked:i})})()}deleteChecklistItem(e,r){return fe(function*(){yield ef(Tn(Pn,`/vacations/${e}/checklist/${r}`))})()}listenPhotos(e,r){const i=Tn(Pn,`/vacations/${e}/photos`);return Rd(i,o=>{const a=o.val();if(!a)return void r([]);const c=Object.keys(a).map(f=>({...a[f],id:f}));c.sort((f,_)=>new Date(_.addedAt).getTime()-new Date(f.addedAt).getTime()),r(c)}),()=>LD(i)}uploadPhoto(e,r,i){return fe(function*(){const o=pi.currentUser;if(!o)return;const a=`vacations/${e}/${Date.now()}_${r.name}`,c=hw(fw,a);yield TN(c,r);const f=yield SN(c),_=Jh(Tn(Pn,`/vacations/${e}/photos`));yield Cu(_,{id:_.key,url:f,caption:i||"",addedBy:o.uid,addedByName:o.displayName||"",addedAt:(new Date).toISOString()})})()}deletePhoto(e,r){return fe(function*(){yield ef(Tn(Pn,`/vacations/${e}/photos/${r.id}`))})()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function R1e(t,n){if(1&t&&(O(0,"a",14)(1,"div",17),q(2,"\u{1f3d6}\ufe0f"),V(),O(3,"div",18)(4,"div",19),q(5),V(),O(6,"div",20),q(7),V()(),O(8,"div",21)(9,"div",22),q(10),V()()()),2&t){const e=n,r=ge();Y(5),xt(e.title),Y(2),xt(e.destination),Y(3),_r("J-",r.daysUntil(e.startDate))}}let P1e=(()=>{class t{constructor(e,r){this.vacService=e,this.router=r,this.nextVacation=this.vacService.nextVacation}daysUntil(e){const r=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(r/864e5))}onEdit(e){this.router.navigate(["/task/edit",e])}static{this.\u0275fac=function(r){return new(r||t)(Ne(c7),Ne($s))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-home"]],decls:51,vars:1,consts:[[1,"card-fun","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","mb-6"],["routerLink","/chat",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],[1,"text-3xl","mb-2"],[1,"font-display","font-semibold","text-gray-700","text-sm"],["routerLink","/add-task",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/shopping",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/map",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/calendar",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/documents",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/vacances",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/recipes",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/vacances",1,"card-fun","p-4","mb-6","flex","items-center","gap-4","hover:shadow-card-hover","transition-shadow","cursor-pointer","bg-gradient-to-r","from-family-coral/5","to-family-orange/5"],[1,"card-fun","p-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"text-3xl"],[1,"flex-1"],[1,"font-display","font-bold","text-gray-700"],[1,"text-sm","text-gray-500"],[1,"text-center"],[1,"text-2xl","font-display","font-extrabold","text-family-pink"]],template:function(r,i){if(1&r&&(O(0,"div",0)(1,"h1",1),q(2,"Bonjour la famille ! \u{1f44b}"),V(),O(3,"p",2),q(4,"Bienvenue sur votre espace famille"),V()(),O(5,"div",3)(6,"a",4)(7,"div",5),q(8,"\u{1f4f1}"),V(),O(9,"div",6),q(10,"Fil d'actu"),V()(),O(11,"a",7)(12,"div",5),q(13,"\u270f\ufe0f"),V(),O(14,"div",6),q(15,"Nouvelle tache"),V()(),O(16,"a",8)(17,"div",5),q(18,"\u{1f6d2}"),V(),O(19,"div",6),q(20,"Courses"),V()(),O(21,"a",9)(22,"div",5),q(23,"\u{1f5fa}\ufe0f"),V(),O(24,"div",6),q(25,"Carte"),V()(),O(26,"a",10)(27,"div",5),q(28,"\u{1f4c5}"),V(),O(29,"div",6),q(30,"Calendrier"),V()(),O(31,"a",11)(32,"div",5),q(33,"\u{1f4c1}"),V(),O(34,"div",6),q(35,"Documents"),V()(),O(36,"a",12)(37,"div",5),q(38,"\u{1f3d6}\ufe0f"),V(),O(39,"div",6),q(40,"Vacances"),V()(),O(41,"a",13)(42,"div",5),q(43,"\u{1f37d}\ufe0f"),V(),O(44,"div",6),q(45,"Recettes"),V()()(),ot(46,R1e,11,3,"a",14),O(47,"div",15)(48,"h2",16),q(49,"\u{1f4cb} Tableau des taches"),V(),ut(50,"app-kanban"),V()),2&r){let o;Y(46),st((o=i.nextVacation())?46:-1,o)}},dependencies:[M1e,t0,yp],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:300px;margin:20px auto;padding:10px 30px}h1[_ngcontent-%COMP%]{margin:10px}.close-button[_ngcontent-%COMP%], .edit-button[_ngcontent-%COMP%]{float:right;top:-14px;right:-30px}"]})}}return t})();var sf=Vd(197),oO=Vd.n(sf);function sO(t,n,e,r){return new(e||(e=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(C){a(C)}}function f(x){try{_(r.throw(x))}catch(C){a(C)}}function _(x){x.done?o(x.value):function i(o){return o instanceof e?o:new e(function(a){a(o)})}(x.value).then(c,f)}_((r=r.apply(t,n||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var aO,u7,cT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function d7(){if(u7)return aO;u7=1,aO=function n(){for(var e={},r=0;r<arguments.length;r++){var i=arguments[r];for(var o in i)t.call(i,o)&&(e[o]=i[o])}return e};var t=Object.prototype.hasOwnProperty;return aO}var h7,cO,f7,uO,p7,dO,m7,lO={exports:{}};var g7,hO,_7,y7,V1e=uT(function F1e(){if(m7)return dO;m7=1;var t=function L1e(){if(p7)return uO;p7=1;var t=d7(),n=function N1e(){return h7||(h7=1,lO.exports=e={},e.simpleFilter=function(r,i){return i.filter(function(o){return e.test(r,o)})},e.test=function(r,i){return null!==e.match(r,i)},e.match=function(r,i,o){var U,a=0,c=[],f=i.length,_=0,x=0,C=(o=o||{}).pre||"",A=o.post||"",N=o.caseSensitive&&i||i.toLowerCase();r=o.caseSensitive&&r||r.toLowerCase();for(var ne=0;ne<f;ne++)U=i[ne],N[ne]===r[a]?(U=C+U+A,a+=1,x+=1+x):x=0,_+=x,c[c.length]=U;return a===r.length?(_=N===r?1/0:_,{rendered:c.join(""),score:_}):null},e.filter=function(r,i,o){return i&&0!==i.length?"string"!=typeof r?i:(o=o||{},i.reduce(function(a,c,f,_){var x=c;o.extract&&(x=o.extract(c));var C=e.match(r,x,o);return null!=C&&(a[a.length]={string:C.rendered,score:C.score,index:f,original:c}),a},[]).sort(function(a,c){return c.score-a.score||a.index-c.index})):[]}),lO.exports;var e}(),e=function O1e(){if(f7)return cO;f7=1;var t=function(n){return this.component=n,this.items=[],this.active=n.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,n.el.parentNode.insertBefore(this.wrapper,n.el.nextSibling),this};return t.prototype.show=function(){this.element.style.display="block"},t.prototype.hide=function(){this.element.style.display="none"},t.prototype.add=function(n){this.items.push(n)},t.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},t.prototype.isEmpty=function(){return!this.items.length},t.prototype.isVisible=function(){return"block"===this.element.style.display},t.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var n=0;n<this.items.length;n++)this.drawItem(this.items[n],this.active===n);this.show()}else this.hide()},t.prototype.drawItem=function(n,e){var r=document.createElement("li"),i=document.createElement("a");e&&(r.className+=" active"),i.innerHTML=n.string,r.appendChild(i),this.element.appendChild(r),r.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),r.addEventListener("mouseup",function(){this.handleMouseUp.call(this,n)}.bind(this))},t.prototype.handleMouseUp=function(n){this.selectingListItem=!1,this.component.value(n.original),this.clear(),this.draw()},t.prototype.move=function(n){this.active=n,this.draw()},t.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},t.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},t.prototype.drawError=function(n){var e=document.createElement("li");e.innerHTML=n,this.element.appendChild(e),this.show()},cO=t}(),r=function(i,o,a){return this.options=t({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},a=a||{}),this.el=i,this.data=o||[],this.list=new e(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(c){this.handleKeyUp(c.keyCode,c)}.bind(this),!1),this.el.addEventListener("keydown",function(c){this.handleKeyDown(c)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(c){this.handlePaste(c)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return r.prototype.handleKeyUp=function(i,o){if(40!==i&&38!==i&&27!==i&&9!==i){if(13===i)return void(this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),o.stopPropagation()));this.handleInputChange(this.el.value)}},r.prototype.handleKeyDown=function(i){switch(i.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&i.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},r.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},r.prototype.handlePaste=function(i){if(i.clipboardData)this.handleInputChange(i.clipboardData.getData("Text"));else{var o=this;setTimeout(function(){o.handleInputChange(i.target.value)},100)}},r.prototype.handleInputChange=function(i){this.query=this.normalize(i),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(o){for(var a=0;a<o.length&&(this.list.add(o[a]),a!==this.options.limit-1);a++);this.list.draw()}.bind(this))},r.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},r.prototype.update=function(i){this.data=i,this.handleKeyUp()},r.prototype.clear=function(){this.data=[],this.list.clear()},r.prototype.normalize=function(i){return i.toLowerCase()},r.prototype.match=function(i,o){return i.indexOf(o)>-1},r.prototype.value=function(i){if(this.selected=i,this.el.value=this.getItemValue(i||{place_name:this.query}),document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!1),this.el.dispatchEvent(o)}else this.el.fireEvent("onchange")},r.prototype.getCandidates=function(i){var o={pre:"<strong>",post:"</strong>",extract:function(c){return this.getItemValue(c)}.bind(this)};i(this.options.filter?n.filter(this.query,this.data,o).map(function(c){return{original:c.original,string:this.render(c.original,c.string)}}.bind(this)):this.data.map(function(c){return{original:c,string:this.render(c)}}.bind(this)))},r.prototype.getItemValue=function(i){return i},r.prototype.render=function(i,o){if(o)return o;for(var a=this.getItemValue(i.original?i.original:i),c=this.normalize(a),f=c.lastIndexOf(this.query);f>-1;){var _=f+this.query.length;a=a.slice(0,f)+"<strong>"+a.slice(f,_)+"</strong>"+a.slice(_),f=c.slice(0,f).lastIndexOf(this.query)}return a},r.prototype.renderError=function(i){this.list.drawError(i)},uO=r}();return dO=t,typeof window<"u"&&(window.Suggestions=t),dO}()),dT={exports:{}},U1e=dT.exports,H1e=uT(function z1e(){return g7||(g7=1,n=U1e,r=function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(f){return f.match(e)||[]}function o(f){return{language:(f=r(f))[1]||"",extlang:f[2]||"",script:f[3]||"",region:f[4]||""}}function a(f,_,x){Object.defineProperty(f,_,{value:x,enumerable:!0})}function c(f,_,x){function C(A){return r(A)[f]||""}a(C,"pattern",_),a(o,x,C)}return c(1,/^[a-zA-Z]{2,3}$/,"language"),c(2,/^[a-zA-Z]{3}$/,"extlang"),c(3,/^[a-zA-Z]{4}$/,"script"),c(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(o,"split",function i(f){return r(f).filter(function(_,x){return _&&x})}),o},(t=dT).exports?t.exports=r():n.subtag=r()),dT.exports;var t,n,r}()),q1e=function $1e(){if(_7)return hO;_7=1;var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,_="object"==typeof self&&self&&self.Object===Object&&self,x="object"==typeof cT&&cT&&cT.Object===Object&&cT||_||Function("return this")(),A=Object.prototype.toString,N=Math.max,U=Math.min,ne=function(){return x.Date.now()};function xe(Ee){var ze=typeof Ee;return!!Ee&&("object"==ze||"function"==ze)}function Se(Ee){if("number"==typeof Ee)return Ee;if(function Ze(Ee){return"symbol"==typeof Ee||function Ce(Ee){return!!Ee&&"object"==typeof Ee}(Ee)&&"[object Symbol]"==A.call(Ee)}(Ee))return NaN;if(xe(Ee)){var ze="function"==typeof Ee.valueOf?Ee.valueOf():Ee;Ee=xe(ze)?ze+"":ze}if("string"!=typeof Ee)return 0===Ee?Ee:+Ee;Ee=Ee.replace(r,"");var Xe=o.test(Ee);return Xe||a.test(Ee)?c(Ee.slice(2),Xe?2:8):i.test(Ee)?NaN:+Ee}return hO=function ce(Ee,ze,Xe){var yt,an,un,Vi,Di,ul,Bd=0,Pw=!1,Nt=!1,Jt=!0;if("function"!=typeof Ee)throw new TypeError("Expected a function");function dn(ir){var sa=yt,Is=an;return yt=an=void 0,Bd=ir,Vi=Ee.apply(Is,sa)}function jl(ir){var sa=ir-ul;return void 0===ul||sa>=ze||sa<0||Nt&&ir-Bd>=un}function Ss(){var ir=ne();if(jl(ir))return Au(ir);Di=setTimeout(Ss,function Xo(ir){var Ng=ze-(ir-ul);return Nt?U(Ng,un-(ir-Bd)):Ng}(ir))}function Au(ir){return Di=void 0,Jt&&yt?dn(ir):(yt=an=void 0,Vi)}function Nw(){var ir=ne(),sa=jl(ir);if(yt=arguments,an=this,ul=ir,sa){if(void 0===Di)return function hr(ir){return Bd=ir,Di=setTimeout(Ss,ze),Pw?dn(ir):Vi}(ul);if(Nt)return Di=setTimeout(Ss,ze),dn(ul)}return void 0===Di&&(Di=setTimeout(Ss,ze)),Vi}return ze=Se(ze)||0,xe(Xe)&&(Pw=!!Xe.leading,un=(Nt="maxWait"in Xe)?N(Se(Xe.maxWait)||0,ze):un,Jt="trailing"in Xe?!!Xe.trailing:Jt),Nw.cancel=function Ti(){void 0!==Di&&clearTimeout(Di),Bd=0,yt=ul=an=Di=void 0},Nw.flush=function pT(){return void 0===Di?Vi:Au(ne())},Nw},hO}(),G1e=uT(q1e),ku=uT(d7()),hT={exports:{}},K1e=function Z1e(){if(y7)return hT.exports;y7=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(Ee,ze,Xe){return Function.prototype.apply.call(Ee,ze,Xe)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(Ee){return Object.getOwnPropertyNames(Ee).concat(Object.getOwnPropertySymbols(Ee))}:function(Ee){return Object.getOwnPropertyNames(Ee)};var i=Number.isNaN||function(Ee){return Ee!=Ee};function o(){o.init.call(this)}hT.exports=o,hT.exports.once=function xe(Se,Ee){return new Promise(function(ze,Xe){function yt(un){Se.removeListener(Ee,an),Xe(un)}function an(){"function"==typeof Se.removeListener&&Se.removeListener("error",yt),ze([].slice.call(arguments))}Ze(Se,Ee,an,{once:!0}),"error"!==Ee&&function Ce(Se,Ee,ze){"function"==typeof Se.on&&Ze(Se,"error",Ee,ze)}(Se,yt,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function c(Se){if("function"!=typeof Se)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Se)}function f(Se){return void 0===Se._maxListeners?o.defaultMaxListeners:Se._maxListeners}function _(Se,Ee,ze,Xe){var yt,an,un;if(c(ze),void 0===(an=Se._events)?(an=Se._events=Object.create(null),Se._eventsCount=0):(void 0!==an.newListener&&(Se.emit("newListener",Ee,ze.listener?ze.listener:ze),an=Se._events),un=an[Ee]),void 0===un)un=an[Ee]=ze,++Se._eventsCount;else if("function"==typeof un?un=an[Ee]=Xe?[ze,un]:[un,ze]:Xe?un.unshift(ze):un.push(ze),(yt=f(Se))>0&&un.length>yt&&!un.warned){un.warned=!0;var Vi=new Error("Possible EventEmitter memory leak detected. "+un.length+" "+String(Ee)+" listeners added. Use emitter.setMaxListeners() to increase limit");Vi.name="MaxListenersExceededWarning",Vi.emitter=Se,Vi.type=Ee,Vi.count=un.length,function r(Se){console&&console.warn&&console.warn(Se)}(Vi)}return Se}function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(Se,Ee,ze){var Xe={fired:!1,wrapFn:void 0,target:Se,type:Ee,listener:ze},yt=x.bind(Xe);return yt.listener=ze,Xe.wrapFn=yt,yt}function A(Se,Ee,ze){var Xe=Se._events;if(void 0===Xe)return[];var yt=Xe[Ee];return void 0===yt?[]:"function"==typeof yt?ze?[yt.listener||yt]:[yt]:ze?function ce(Se){for(var Ee=new Array(Se.length),ze=0;ze<Ee.length;++ze)Ee[ze]=Se[ze].listener||Se[ze];return Ee}(yt):U(yt,yt.length)}function N(Se){var Ee=this._events;if(void 0!==Ee){var ze=Ee[Se];if("function"==typeof ze)return 1;if(void 0!==ze)return ze.length}return 0}function U(Se,Ee){for(var ze=new Array(Ee),Xe=0;Xe<Ee;++Xe)ze[Xe]=Se[Xe];return ze}function Ze(Se,Ee,ze,Xe){if("function"==typeof Se.on)Xe.once?Se.once(Ee,ze):Se.on(Ee,ze);else{if("function"!=typeof Se.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Se);Se.addEventListener(Ee,function yt(an){Xe.once&&Se.removeEventListener(Ee,yt),ze(an)})}}return Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(Se){if("number"!=typeof Se||Se<0||i(Se))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Se+".");a=Se}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(Ee){if("number"!=typeof Ee||Ee<0||i(Ee))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ee+".");return this._maxListeners=Ee,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(Ee){for(var ze=[],Xe=1;Xe<arguments.length;Xe++)ze.push(arguments[Xe]);var yt="error"===Ee,an=this._events;if(void 0!==an)yt=yt&&void 0===an.error;else if(!yt)return!1;if(yt){var un;if(ze.length>0&&(un=ze[0]),un instanceof Error)throw un;var Vi=new Error("Unhandled error."+(un?" ("+un.message+")":""));throw Vi.context=un,Vi}var Di=an[Ee];if(void 0===Di)return!1;if("function"==typeof Di)n(Di,this,ze);else{var ul=Di.length,Bd=U(Di,ul);for(Xe=0;Xe<ul;++Xe)n(Bd[Xe],this,ze)}return!0},o.prototype.on=o.prototype.addListener=function(Ee,ze){return _(this,Ee,ze,!1)},o.prototype.prependListener=function(Ee,ze){return _(this,Ee,ze,!0)},o.prototype.once=function(Ee,ze){return c(ze),this.on(Ee,C(this,Ee,ze)),this},o.prototype.prependOnceListener=function(Ee,ze){return c(ze),this.prependListener(Ee,C(this,Ee,ze)),this},o.prototype.off=o.prototype.removeListener=function(Ee,ze){var Xe,yt,an,un,Vi;if(c(ze),void 0===(yt=this._events))return this;if(void 0===(Xe=yt[Ee]))return this;if(Xe===ze||Xe.listener===ze)0===--this._eventsCount?this._events=Object.create(null):(delete yt[Ee],yt.removeListener&&this.emit("removeListener",Ee,Xe.listener||ze));else if("function"!=typeof Xe){for(an=-1,un=Xe.length-1;un>=0;un--)if(Xe[un]===ze||Xe[un].listener===ze){Vi=Xe[un].listener,an=un;break}if(an<0)return this;0===an?Xe.shift():function ne(Se,Ee){for(;Ee+1<Se.length;Ee++)Se[Ee]=Se[Ee+1];Se.pop()}(Xe,an),1===Xe.length&&(yt[Ee]=Xe[0]),void 0!==yt.removeListener&&this.emit("removeListener",Ee,Vi||ze)}return this},o.prototype.removeAllListeners=function(Ee){var ze,Xe,yt;if(void 0===(Xe=this._events))return this;if(void 0===Xe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==Xe[Ee]&&(0===--this._eventsCount?this._events=Object.create(null):delete Xe[Ee]),this;if(0===arguments.length){var un,an=Object.keys(Xe);for(yt=0;yt<an.length;++yt)"removeListener"!==(un=an[yt])&&this.removeAllListeners(un);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(ze=Xe[Ee]))this.removeListener(Ee,ze);else if(void 0!==ze)for(yt=ze.length-1;yt>=0;yt--)this.removeListener(Ee,ze[yt]);return this},o.prototype.listeners=function(Ee){return A(this,Ee,!0)},o.prototype.rawListeners=function(Ee){return A(this,Ee,!1)},o.listenerCount=function(Se,Ee){return"function"==typeof Se.listenerCount?Se.listenerCount(Ee):N.call(Se,Ee)},o.prototype.listenerCount=N,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},hT.exports}();const v7={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};var Mw={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a",es:"Buscar"},errorNoResults:{en:"No results found",de:"Keine Ergebnisse gefunden",es:"No hay resultados",fr:"Aucun r\xe9sultat trouv\xe9"},errorConnectionFailed:{en:"There was an error reaching the server",de:"Verbindung fehlgeschlagen",es:"Error al conectarse al servidor",fr:"Une erreur est survenue lors de la connexion au serveur"}};const Y1e=/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;class X1e{constructor(n,e,r=(i,o,a)=>new V1e(i,o,a)){this.options={zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:void 0,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,proximityMinZoom:9,getItemValue:i=>null!=i.text?i.text:i.place_name,render:i=>{if(!("geometry"in i)){const a=i.text,c=a.toLowerCase().indexOf(this._typeahead.query.toLowerCase()),f=this._typeahead.query.length;return'<div class="maplibregl-ctrl-geocoder--suggestion"><svg class="maplibregl-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="maplibregl-ctrl-geocoder--suggestion-info"><div class="maplibregl-ctrl-geocoder--suggestion-title">'+a.substring(0,c)+'<span class="maplibregl-ctrl-geocoder--suggestion-match">'+a.substring(c,c+f)+"</span>"+a.substring(c+f)+"</div></div></div>"}const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--result"><svg class="maplibregl-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"},popupRender:i=>{const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--suggestion popup-suggestion"><div class="maplibregl-ctrl-geocoder--suggestion-title popup-suggestion-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--suggestion-address popup-suggestion-address">'+o.splice(1,o.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},this._eventEmitter=new K1e.EventEmitter,this.options=ku({},this.options,e),this.fresh=!0,this.lastSelected=null,this.geocoderApi=n,this.typeaheadFactory=r}addTo(n){function e(r,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const o=r.onAdd();i.appendChild(o)}if(n instanceof HTMLElement)e(this,n);else if("string"==typeof n){const r=document.querySelectorAll(n);if(0===r.length)throw new Error("Element "+n+"not found.");if(r.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,r[0])}else{if(!("addControl"in n))throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element");n.addControl(this)}}onAdd(n){if(n&&"string"!=typeof n&&(this._map=n),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);const e=this.container=document.createElement("div");e.className="maplibregl-ctrl-geocoder maplibregl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";const r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="search",this._inputEl.className="maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",G1e(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);const i=document.createElement("div");i.classList.add("maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("type","button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="maplibregl-ctrl-geocoder--button";const o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),i.appendChild(this._clearEl),i.appendChild(this._loadingEl),e.appendChild(r),e.appendChild(this._inputEl),e.appendChild(i),this._typeahead=this.typeaheadFactory(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.container.addEventListener("click",()=>{this._typeahead.update(this._typeahead.data)}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),e}createIcon(n,e){const r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("class","maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+n),r.setAttribute("viewBox","0 0 18 18"),r.setAttribute("xml:space","preserve"),r.setAttribute("width","18"),r.setAttribute("height","18"),"innerHTML"in r)r.innerHTML=e;else{const i=document.createElement("div");i.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",r.appendChild(i.firstChild.firstChild)}return r}onRemove(){return this.container.remove(),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this}_onPaste(n){const e=(n.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)}_onKeyDown(n){if("Escape"===n.key&&this.options.clearAndBlurOnEsc)return this._clear(n),void this._inputEl.blur();const e=this._inputEl.value;if(!e)return this.fresh=!0,"Tab"!==n.key&&this.clear(n),void(this._clearEl.style.display="none");if(!n.metaKey&&"Tab"!==n.key&&"Escape"!==n.key&&"ArrowLeft"!==n.key&&"ArrowRight"!==n.key&&"ArrowUp"!==n.key&&"ArrowDown"!==n.key){if("Enter"===n.key){if(this.options.showResultsWhileTyping)return void(null==this._typeahead.selected&&this.geocoderApi.getSuggestions?this._geocode(e,!0):null==this._typeahead.selected&&this.options.showResultMarkers&&this._fitBoundsForMarkers());this._typeahead.selected||this._geocode(e)}e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)}}_showButton(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")}_hideButton(){this._typeahead.selected&&(this._clearEl.style.display="none")}_onBlur(n){this.options.clearOnBlur&&this._clearOnBlur(n),this.options.collapsed&&this._collapse()}_onChange(){var n;const e=this._typeahead.selected;if(e){if(!("geometry"in e))return void(e.placeId?this._geocode(e.placeId,!0,!0):this._geocode(e.text,!0));if(JSON.stringify(e)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){let r;if(this._removeResultMarkers(),e.properties&&v7[e.properties.short_code])r=ku({},this.options.flyTo),this._map&&this._map.fitBounds(v7[e.properties.short_code].bbox,r);else if(e.bbox){const i=e.bbox;r=ku({},this.options.flyTo),this._map&&this._map.fitBounds([[i[0],i[1]],[i[2],i[3]]],r)}else r=ku({},{zoom:this.options.zoom},this.options.flyTo),e.center?r.center=e.center:"Point"===(null===(n=e.geometry)||void 0===n?void 0:n.type)&&e.geometry.coordinates&&(r.center=e.geometry.coordinates),this._map&&this._map.flyTo(r)}this.options.marker&&this._maplibregl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:e})}}}_getConfigForRequest(){return["bbox","limit","proximity","countries","types","language","reverseMode"].reduce((r,i)=>(this.options[i]&&(r[i]=["countries","types","language"].indexOf(i)>-1?this.options[i].split(/[\s,]+/):this.options[i],"proximity"===i&&this.options[i]&&"number"==typeof this.options[i].longitude&&"number"==typeof this.options[i].latitude&&(r[i]=[this.options[i].longitude,this.options[i].latitude])),r),{})}_geocode(n){return sO(this,arguments,void 0,function*(e,r=!1,i=!1){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:e});const o=this._getConfigForRequest(),a=this._createGeocodeRequest(o,e,r,i),c=this.options.localGeocoder&&this.options.localGeocoder(e)||[];try{const f=yield a;yield this._handleGeocodeResponse(f,o,e,r,c)}catch(f){this._handleGeocodeErrorResponse(f,c)}return a})}_createGeocodeRequest(n,e,r,i){return this.options.localGeocoderOnly?Promise.resolve({}):this.options.reverseGeocode&&Y1e.test(e)?this._createReverseGeocodeRequest(e,n):(n.query=e,this.geocoderApi.getSuggestions?r?this.geocoderApi.searchByPlaceId&&i?this.geocoderApi.searchByPlaceId(n):this.geocoderApi.forwardGeocode(n):this.geocoderApi.getSuggestions(n):this.geocoderApi.forwardGeocode(n))}_createReverseGeocodeRequest(n,e){const r=n.split(/[\s(,)?]+/).map(i=>parseFloat(i)).reverse();return e.query=r,e.limit=1,"proximity"in e&&delete e.proximity,this.geocoderApi.reverseGeocode(e)}_handleGeocodeResponse(n,e,r,i,o){return sO(this,void 0,void 0,function*(){this._loadingEl.style.display="none";let a={};a=n||{type:"FeatureCollection",features:[]},a.config=e,this.fresh&&(this.fresh=!1),a.features=a.features?o.concat(a.features):o;const c=this.options.externalGeocoder&&this.options.externalGeocoder(r,a.features,e)||Promise.resolve([]);try{const _=yield c;a.features=a.features?_.concat(a.features):_}catch{}this.options.filter&&a.features.length&&(a.features=a.features.filter(this.options.filter));let f=[];f="suggestions"in a?a.suggestions:"place"in a?Array.isArray(a.place)?a.place:[a.place]:a.features,f.length?(this._clearEl.style.display="block",this._typeahead.update(f),(!this.options.showResultsWhileTyping||i)&&this.options.showResultMarkers&&(a.features.length>0||"place"in a)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",a)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",a))})}_handleGeocodeErrorResponse(n,e){this._loadingEl.style.display="none",e.length&&this.options.localGeocoder?(this._clearEl.style.display="block",this._typeahead.update(e)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:e}),this._eventEmitter.emit("error",{error:n})}_clear(n){n&&n.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0}clear(n){this._clear(n),this._inputEl.focus()}_clearOnBlur(n){n.relatedTarget&&this._clear(n)}_onQueryResult(n){if(!("features"in n)||!n.features.length)return;const e=n.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}_updateProximity(){if(this._map)if(this._map.getZoom()>this.options.proximityMinZoom){const n=this._map.getCenter().wrap();this.setProximity({longitude:n.lng,latitude:n.lat})}else this.setProximity(null)}_collapse(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("maplibregl-ctrl-geocoder--collapsed")}_unCollapse(){this.container.classList.remove("maplibregl-ctrl-geocoder--collapsed")}query(n){return sO(this,void 0,void 0,function*(){const e=yield this._geocode(n);this._onQueryResult(e)})}_renderError(){const n=`<div class='maplibre-gl-geocoder--error'>${this._localize("errorConnectionFailed")}</div>`;this._renderMessage(n)}_renderNoResults(){const n=`<div class='maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>\n        ${this._localize("errorNoResults")}</div>`;this._renderMessage(n)}_renderMessage(n){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(n)}_localize(n){const e=H1e.language(this.options.language.split(",")[0]);return this.options.language&&Mw?.[n][e]?Mw[n][e]:Mw[n].en}_fitBoundsForMarkers(){var n;if(this._typeahead.data.length<1)return;const e=this._typeahead.data.filter(r=>"string"!=typeof r).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){const i=ku({},{padding:100},this.options.flyTo),o=new this._maplibregl.LngLatBounds;for(const a of e)"geometry"in a&&"Point"===(null===(n=a.geometry)||void 0===n?void 0:n.type)&&o.extend(a.geometry.coordinates);this._map.fitBounds(o,i)}return e.length>0&&this._maplibregl&&this._handleResultMarkers(e),this}setInput(n){return this._inputEl.value=n,this._typeahead.selected=null,this._typeahead.clear(),n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n),this}setProximity(n){return this.options.proximity=n,this}getProximity(){return this.options.proximity}setRenderFunction(n){return n&&"function"==typeof n&&(this._typeahead.render=n),this}getRenderFunction(){return this._typeahead.render}setLanguage(n){return this.options.language=n||this.options.language||navigator.language,this}getLanguage(){return this.options.language}getZoom(){return this.options.zoom}setZoom(n){return this.options.zoom=n,this}getFlyTo(){return this.options.flyTo}setFlyTo(n){return this.options.flyTo=n,this}getPlaceholder(){return this.options.placeholder}setPlaceholder(n){return this.options.placeholder=n||this.options.placeholder||this._localize("placeholder"),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this}getBbox(){return this.options.bbox}setBbox(n){return this.options.bbox=n,this}getCountries(){return this.options.countries}setCountries(n){return this.options.countries=n,this}getTypes(){return this.options.types}setTypes(n){return this.options.types=n,this}getMinLength(){return this.options.minLength}setMinLength(n){return this.options.minLength=n,this._typeahead&&(this._typeahead.options.minLength=n),this}getLimit(){return this.options.limit}setLimit(n){return this.options.limit=n,this._typeahead&&(this._typeahead.options.limit=n),this}getFilter(){return this.options.filter}setFilter(n){return this.options.filter=n,this}setGeocoderApi(n){return this.geocoderApi=n,this}getGeocoderApi(){return this.geocoderApi}_handleMarker(n){var e;if(!this._map)return;this._removeMarker();const i=ku({},{color:"#4668F2"},this.options.marker);this.mapMarker=new this._maplibregl.Marker(i);let o=null;if(this.options.popup){const c=ku({},{},this.options.popup);o=new this._maplibregl.Popup(c).setHTML(this.options.popupRender(n))}return n.center?(this.mapMarker.setLngLat(n.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):"Point"===(null===(e=n.geometry)||void 0===e?void 0:e.type)&&n.geometry.coordinates&&(this.mapMarker.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}_removeMarker(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)}_handleResultMarkers(n){if(!this._map)return;this._removeResultMarkers();let r=ku({},{color:"#4668F2"},this.options.showResultMarkers);for(const i of n){let o;if(this.options.showResultMarkers){this.options.showResultMarkers&&this.options.showResultMarkers.element&&(o=this.options.showResultMarkers.element.cloneNode(!0),r=ku(r,{element:o}));const a=new this._maplibregl.Marker(ku({},r,{element:o}));let c;if(this.options.popup){const _=ku({},{},this.options.popup);c=new this._maplibregl.Popup(_).setHTML(this.options.popupRender(i))}i.center?(a.setLngLat(i.center).addTo(this._map),this.options.popup&&a.setPopup(c)):i.geometry&&i.geometry.type&&"Point"===i.geometry.type&&i.geometry.coordinates&&(a.setLngLat(i.geometry.coordinates).addTo(this._map),this.options.popup&&a.setPopup(c)),this.resultMarkers.push(a)}}return this}_removeResultMarkers(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(n){n.remove()}),this.resultMarkers=[])}on(n,e){return this._eventEmitter.on(n,e),this}once(n){return new Promise(e=>{this._eventEmitter.once(n,e)})}off(n,e){return this._eventEmitter.removeListener(n,e),this}}const Q1e=["map"];let J1e=(()=>{class t{constructor(e){var r;this.locationService=e,this.markers={},this.unsubscribeLocations=null,this.centeredOnSelf=!1,this.geocoderApi={forwardGeocode:(r=fe(function*(i){const o=[];try{const a=`https://nominatim.openstreetmap.org/search?q=${i.query}&format=geojson&polygon_geojson=1&addressdetails=1`,f=yield(yield fetch(a)).json();for(const _ of f.features){const x=[_.bbox[0]+(_.bbox[2]-_.bbox[0])/2,_.bbox[1]+(_.bbox[3]-_.bbox[1])/2];o.push({type:"Feature",geometry:{type:"Point",coordinates:x},place_name:_.properties.display_name,properties:_.properties,text:_.properties.display_name,place_type:["place"],center:x})}}catch(a){console.error(`Failed to forwardGeocode with error: ${a}`)}return{type:"FeatureCollection",features:o}}),function(o){return r.apply(this,arguments)})}}ngAfterViewInit(){this.map=new sf.Map({container:this.mapContainer.nativeElement,style:"https://maps.geoapify.com/v1/styles/maptiler-3d/style.json?apiKey=793f93202015411eaa6fceaeadaad99c",center:[2.213749,46.227638],zoom:5}),this.map.addControl(new(oO().NavigationControl)({visualizePitch:!0,showZoom:!0,showCompass:!0})),this.map.addControl(new(oO().FullscreenControl)),this.map.addControl(new X1e(this.geocoderApi,{maplibregl:oO()}),"top-left"),this.map.on("load",()=>{this.unsubscribeLocations=this.locationService.listenAllLocations(o=>{this.updateFamilyMarkers(o);const a=pi.currentUser?.uid;a&&o[a]&&!this.centeredOnSelf&&(this.map.flyTo({center:[o[a].lng,o[a].lat],zoom:14}),this.centeredOnSelf=!0)})})}updateFamilyMarkers(e){const r=pi.currentUser?.uid,i=new Set;for(const[o,a]of Object.entries(e)){i.add(o);const c=o===r;if(this.markers[o])this.markers[o].setLngLat([a.lng,a.lat]),this.markers[o].getPopup()?.setHTML(this.buildPopupHtml(a));else{const f=document.createElement("div");if(f.className="family-marker",f.style.cssText=`width:40px;height:40px;border-radius:50%;border:3px solid ${c?"#3b82f6":"#ec4899"};overflow:hidden;background:#fff;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.3);`,a.photoURL){const C=document.createElement("img");C.src=a.photoURL,C.style.cssText="width:100%;height:100%;object-fit:cover;",C.referrerPolicy="no-referrer",f.appendChild(C)}else f.style.display="flex",f.style.alignItems="center",f.style.justifyContent="center",f.style.fontSize="14px",f.style.fontWeight="bold",f.style.color="#ec4899",f.textContent=(a.displayName||"?")[0].toUpperCase();const x=new sf.Popup({offset:25}).setHTML(this.buildPopupHtml(a));this.markers[o]=new sf.Marker({element:f}).setLngLat([a.lng,a.lat]).setPopup(x).addTo(this.map)}}for(const o of Object.keys(this.markers))i.has(o)||(this.markers[o].remove(),delete this.markers[o])}buildPopupHtml(e){const i=new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});return`<div style="font-family:sans-serif;text-align:center;">\n      <strong>${e.displayName||"Membre"}</strong><br>\n      <span style="color:#888;font-size:12px;">${i}</span>\n    </div>`}ngOnDestroy(){this.unsubscribeLocations&&this.unsubscribeLocations(),Object.values(this.markers).forEach(e=>e.remove())}static{this.\u0275fac=function(r){return new(r||t)(Ne(Oq))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-map"]],viewQuery:function(r,i){if(1&r&&dp(Q1e,5),2&r){let o;gd(o=_d())&&(i.mapContainer=o.first)}},decls:5,vars:0,consts:[["map",""],[1,"card-fun","p-4","h-[calc(100vh-12rem)]"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-3"],[1,"map-container","rounded-xl","overflow-hidden","h-[calc(100%-3rem)]"]],template:function(r,i){1&r&&(Yt(0,"div",1)(1,"h2",2),q(2,"\u{1f5fa}\ufe0f Carte"),Gt(),md(3,"div",3,0),Gt())},styles:[".map-container[_ngcontent-%COMP%]{height:100%}"]})}}return t})(),Fc=(()=>{class t{constructor(e,r){this.router=e,this.authService=r}canActivate(){return this.authService.redirectReady.then(()=>new Promise(e=>{ZC(pi,r=>{r?e(!0):(this.router.navigate(["/auth","signin"]),e(!1))})}))}static{this.\u0275fac=function(r){return new(r||t)(Tt($s),Tt(Od))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac})}}return t})();const b7=[{key:"fruits_legumes",label:"Fruits & L\xe9gumes",icon:"\u{1f966}"},{key:"produits_laitiers",label:"Produits laitiers",icon:"\u{1f9c0}"},{key:"viandes",label:"Viandes & Poissons",icon:"\u{1f969}"},{key:"epicerie",label:"\xc9picerie",icon:"\u{1f35d}"},{key:"boissons",label:"Boissons",icon:"\u{1f964}"},{key:"surgeles",label:"Surgel\xe9s",icon:"\u{1f9ca}"},{key:"hygiene",label:"Hygi\xe8ne & Maison",icon:"\u{1f9f4}"},{key:"autre",label:"Autre",icon:"\u{1f4e6}"}],eEe=["\u{1f6d2}","\u{1f3e0}","\u{1f389}","\u{1f37d}\ufe0f","\u{1f382}","\u{1f3d5}\ufe0f","\u{1f384}","\u{1f415}","\u{1f476}","\u{1f4bc}"];let fO=(()=>{class t{constructor(){this._lists=Pi([]),this._activeListId=Pi(null),this._items=Pi([]),this._migrationDone=!1,this.lists=this._lists.asReadonly(),this.activeListId=this._activeListId.asReadonly(),this.items=this._items.asReadonly(),this.activeList=ii(()=>{const e=this._activeListId();return this._lists().find(r=>r.id===e)||null}),this.uncheckedItems=ii(()=>this._items().filter(e=>!e.checked)),this.checkedItems=ii(()=>this._items().filter(e=>e.checked)),this.totalUnchecked=ii(()=>this.uncheckedItems().length),this.itemsUnsubscribe=null,this.initListsListener()}initListsListener(){var e=this;return fe(function*(){yield e.checkAndMigrate(),Rd(Tn(Pn,"/shopping_lists"),r=>{const i=r.val();if(i){const o=Object.keys(i).map(a=>({id:a,name:i[a].name||"Liste",icon:i[a].icon||"\u{1f6d2}",createdBy:i[a].createdBy||"",createdAt:i[a].createdAt||""}));e._lists.set(o),!e._activeListId()&&o.length>0&&e.setActiveList(o[0].id)}else e._lists.set([]),e._activeListId.set(null),e._items.set([])})})()}checkAndMigrate(){var e=this;return fe(function*(){if(e._migrationDone||(e._migrationDone=!0,(yield tf(Tn(Pn,"/shopping_lists"))).exists()))return;const i=yield tf(Tn(Pn,"/shopping"));if(!i.exists())return;const o=i.val(),a=Object.keys(o).map(A=>({...o[A],id:A}));if(0===a.length)return;const c=pi.currentUser,_=Jh(Tn(Pn,"/shopping_lists")).key,x={name:"Courses",icon:"\u{1f6d2}",createdBy:c?.uid||"",createdAt:(new Date).toISOString()},C={};C[`/shopping_lists/${_}/name`]=x.name,C[`/shopping_lists/${_}/icon`]=x.icon,C[`/shopping_lists/${_}/createdBy`]=x.createdBy,C[`/shopping_lists/${_}/createdAt`]=x.createdAt,a.forEach(A=>{const{id:N,...U}=A;C[`/shopping_lists/${_}/items/${N}`]=U}),C["/shopping"]=null,yield Md(Tn(Pn),C)})()}setActiveList(e){this._activeListId.set(e),this.itemsUnsubscribe&&this.itemsUnsubscribe();const r=Rd(Tn(Pn,`/shopping_lists/${e}/items`),i=>{const o=i.val();this._items.set(o?Object.keys(o).map(a=>({...o[a],id:a})):[])});this.itemsUnsubscribe=r}createList(e,r){return fe(function*(){const i=pi.currentUser,o=Jh(Tn(Pn,"/shopping_lists")),a=o.key;return yield Cu(o,{name:e,icon:r,createdBy:i?.uid||"",createdAt:(new Date).toISOString()}),a})()}deleteList(e){var r=this;return fe(function*(){if(yield ef(Tn(Pn,`/shopping_lists/${e}`)),r._activeListId()===e){const i=r._lists().filter(o=>o.id!==e);i.length>0?r.setActiveList(i[0].id):(r._activeListId.set(null),r._items.set([]))}})()}addItem(e){const r=this._activeListId();r&&Jh(Tn(Pn,`/shopping_lists/${r}/items`),e)}removeItem(e){const r=this._activeListId();r&&ef(Tn(Pn,`/shopping_lists/${r}/items/${e}`))}toggleChecked(e,r){const i=this._activeListId();i&&Md(Tn(Pn,`/shopping_lists/${i}/items/${e}`),{checked:r})}clearChecked(){const e=this._activeListId();if(!e)return;const r=this._items().filter(o=>o.checked),i={};r.forEach(o=>i[`/shopping_lists/${e}/items/${o.id}`]=null),Md(Tn(Pn),i)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const pO=(t,n)=>n.id,w7=(t,n)=>n.key;function tEe(t,n){if(1&t&&(O(0,"h1",9),q(1),V(),O(2,"p",10),q(3),V()),2&t){const e=ge();Y(),bs("",e.activeList().icon," ",e.activeList().name),Y(2),Q1("",e.totalItems()," article",e.totalItems()>1?"s":""," restant",e.totalItems()>1?"s":"")}}function nEe(t,n){1&t&&(O(0,"h1",9),q(1,"\u{1f6d2} Liste de courses"),V(),O(2,"p",10),q(3,"Aucune liste s\xe9lectionn\xe9e"),V())}function rEe(t,n){if(1&t){const e=Ut();O(0,"button",11),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().selectList(i.id))}),q(1),V()}if(2&t){let e;const r=n.$implicit;is((null==(e=ge().activeList())?null:e.id)===r.id?"flex-shrink-0 px-4 py-2 rounded-full bg-gradient-to-r from-family-purple to-family-pink text-white font-medium text-sm shadow-md":"flex-shrink-0 px-4 py-2 rounded-full bg-white border border-gray-200 text-gray-600 font-medium text-sm hover:border-family-purple transition-colors"),Y(),bs(" ",r.icon," ",r.name," ")}}function iEe(t,n){if(1&t){const e=Ut();O(0,"button",18),Pe("click",function(){return Me(e),Oe(ge(2).showAddForm=!0)}),xn(),O(1,"svg",19),ut(2,"path",6),V(),Ri(),O(3,"span",20),q(4,"Ajouter un article"),V()()}}function oEe(t,n){if(1&t&&(O(0,"option",26),q(1),V()),2&t){const e=n.$implicit;pn("value",e.key),Y(),bs("",e.icon," ",e.label)}}function sEe(t,n){if(1&t){const e=Ut();O(0,"div",15)(1,"div",21)(2,"input",22),go("ngModelChange",function(i){Me(e);const o=ge(2);return Ro(o.newItemName,i)||(o.newItemName=i),Oe(i)}),Pe("keyup.enter",function(){return Me(e),Oe(ge(2).addItem())}),V(),O(3,"div",23)(4,"input",24),go("ngModelChange",function(i){Me(e);const o=ge(2);return Ro(o.newItemQuantity,i)||(o.newItemQuantity=i),Oe(i)}),V(),O(5,"select",25),go("ngModelChange",function(i){Me(e);const o=ge(2);return Ro(o.newItemCategory,i)||(o.newItemCategory=i),Oe(i)}),On(6,oEe,2,3,"option",26,w7),V()(),O(8,"div",27)(9,"button",28),Pe("click",function(){return Me(e),Oe(ge(2).showAddForm=!1)}),q(10,"Annuler"),V(),O(11,"button",29),Pe("click",function(){return Me(e),Oe(ge(2).addItem())}),q(12,"Ajouter"),V()()()()}if(2&t){const e=ge(2);Y(2),mo("ngModel",e.newItemName),Y(2),mo("ngModel",e.newItemQuantity),Y(),mo("ngModel",e.newItemCategory),Y(),Ln(e.categories),Y(5),pn("disabled",!e.newItemName.trim())}}function aEe(t,n){if(1&t&&(O(0,"span",36),q(1),V()),2&t){const e=ge().$implicit;Y(),_r("x",e.quantity)}}function lEe(t,n){1&t&&ut(0,"img",41),2&t&&pn("src",ge(2).$implicit.addedByPhoto,vs)}function cEe(t,n){if(1&t&&(O(0,"div",37),ot(1,lEe,1,1,"img",41),O(2,"span",42),q(3),V()()),2&t){const e=ge().$implicit;Y(),st(e.addedByPhoto?1:-1),Y(2),xt(e.addedByName)}}function uEe(t,n){if(1&t){const e=Ut();O(0,"div",32)(1,"button",33),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).toggleChecked(i))}),V(),O(2,"div",34)(3,"span",35),q(4),V(),ot(5,aEe,2,1,"span",36),ot(6,cEe,4,2,"div",37),V(),O(7,"button",38),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).removeItem(i))}),xn(),O(8,"svg",39),ut(9,"path",40),V()()()}if(2&t){const e=n.$implicit;Y(4),xt(e.nom),Y(),st(e.quantity&&"1"!==e.quantity?5:-1),Y(),st(e.addedByName?6:-1)}}function dEe(t,n){if(1&t&&(O(0,"div",16)(1,"h3",30)(2,"span"),q(3),V(),q(4),V(),O(5,"div",31),On(6,uEe,10,3,"div",32,pO),V()()),2&t){const e=n.$implicit;Y(3),xt(e.icon),Y(),_r(" ",e.label," "),Y(2),Ln(e.items)}}function hEe(t,n){if(1&t){const e=Ut();O(0,"div",47)(1,"button",48),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).toggleChecked(i))}),xn(),O(2,"svg",49),ut(3,"path",50),V()(),Ri(),O(4,"span",51),q(5),V()()}if(2&t){const e=n.$implicit;Y(5),xt(e.nom)}}function fEe(t,n){if(1&t){const e=Ut();O(0,"div",17)(1,"div",43)(2,"h3",44)(3,"span"),q(4,"\u2705"),V(),q(5),V(),O(6,"button",45),Pe("click",function(){return Me(e),Oe(ge(2).clearChecked())}),q(7," Vider le panier "),V()(),O(8,"div",46),On(9,hEe,6,1,"div",47,pO),V()()}if(2&t){const e=ge(2);Y(5),_r(" Dans le panier (",e.checkedItems().length,") "),Y(4),Ln(e.checkedItems())}}function pEe(t,n){1&t&&(O(0,"div",7)(1,"div",52),q(2,"\u{1f6d2}"),V(),O(3,"p",20),q(4,"Liste vide"),V(),O(5,"p",53),q(6,"Ajoute ton premier article !"),V()())}function mEe(t,n){if(1&t){const e=Ut();O(0,"div",12)(1,"button",13),Pe("click",function(){return Me(e),Oe(ge().openDeleteListModal())}),q(2," Supprimer cette liste "),V()(),ot(3,iEe,5,0,"button",14),ot(4,sEe,13,4,"div",15),On(5,dEe,8,2,"div",16,w7),ot(7,fEe,11,1,"div",17),ot(8,pEe,7,0,"div",7)}if(2&t){const e=ge();Y(3),st(e.showAddForm?-1:3),Y(),st(e.showAddForm?4:-1),Y(),Ln(e.uncheckedByCategory()),Y(2),st(e.checkedItems().length>0?7:-1),Y(),st(0===e.uncheckedByCategory().length&&0===e.checkedItems().length?8:-1)}}function gEe(t,n){if(1&t){const e=Ut();O(0,"div",7)(1,"div",52),q(2,"\u{1f4dd}"),V(),O(3,"p",20),q(4,"Aucune liste"),V(),O(5,"p",54),q(6,"Cr\xe9e ta premi\xe8re liste de courses !"),V(),O(7,"button",55),Pe("click",function(){return Me(e),Oe(ge().openNewListModal())}),q(8," Cr\xe9er une liste "),V()()}}function _Ee(t,n){if(1&t){const e=Ut();O(0,"button",11),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).newListIcon=i)}),q(1),V()}if(2&t){const e=n.$implicit;is(ge(2).newListIcon===e?"w-10 h-10 rounded-xl bg-family-purple/10 text-xl flex items-center justify-center ring-2 ring-family-purple":"w-10 h-10 rounded-xl bg-gray-100 text-xl flex items-center justify-center hover:bg-gray-200 transition-colors"),Y(),_r(" ",e," ")}}function yEe(t,n){if(1&t){const e=Ut();O(0,"div",8)(1,"div",56)(2,"div",57)(3,"h2",58),q(4,"Nouvelle liste"),V(),O(5,"div",59)(6,"input",60),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.newListName,i)||(o.newListName=i),Oe(i)}),Pe("keyup.enter",function(){return Me(e),Oe(ge().createList())}),V(),O(7,"div")(8,"label",61),q(9,"Ic\xf4ne"),V(),O(10,"div",62),On(11,_Ee,2,3,"button",3,nl),V()()(),O(13,"div",63)(14,"button",64),Pe("click",function(){return Me(e),Oe(ge().closeNewListModal())}),q(15," Annuler "),V(),O(16,"button",65),Pe("click",function(){return Me(e),Oe(ge().createList())}),q(17," Cr\xe9er "),V()()()()()}if(2&t){const e=ge();Y(6),mo("ngModel",e.newListName),Y(5),Ln(e.listIcons),Y(5),pn("disabled",!e.newListName.trim())}}function vEe(t,n){if(1&t){const e=Ut();O(0,"div",8)(1,"div",56)(2,"div",57)(3,"div",1)(4,"div",66),q(5,"\u{1f5d1}\ufe0f"),V(),O(6,"h2",67),q(7,"Supprimer la liste ?"),V(),O(8,"p",68),q(9),V()(),O(10,"div",23)(11,"button",64),Pe("click",function(){return Me(e),Oe(ge().closeDeleteListModal())}),q(12," Annuler "),V(),O(13,"button",69),Pe("click",function(){return Me(e),Oe(ge().confirmDeleteList())}),q(14," Supprimer "),V()()()()()}if(2&t){let e;const r=ge();Y(9),bs(' "',null==(e=r.activeList())?null:e.icon," ",null==(e=r.activeList())?null:e.name,'" et tous ses articles seront supprim\xe9s d\xe9finitivement. ')}}let bEe=(()=>{class t{constructor(e){this.shoppingService=e,this.categories=b7,this.listIcons=eEe,this.newItemName="",this.newItemCategory="autre",this.newItemQuantity="",this.showAddForm=!1,this.showNewListModal=!1,this.newListName="",this.newListIcon="\u{1f6d2}",this.showDeleteListModal=!1,this.lists=this.shoppingService.lists,this.activeList=this.shoppingService.activeList,this.items=this.shoppingService.items,this.uncheckedByCategory=ii(()=>{const r=this.shoppingService.items();return this.categories.map(i=>({...i,items:r.filter(o=>!o.checked&&o.category===i.key)})).filter(i=>i.items.length>0)}),this.checkedItems=ii(()=>this.shoppingService.items().filter(r=>r.checked)),this.totalItems=ii(()=>this.shoppingService.items().filter(r=>!r.checked).length)}selectList(e){this.shoppingService.setActiveList(e)}openNewListModal(){this.newListName="",this.newListIcon="\u{1f6d2}",this.showNewListModal=!0}closeNewListModal(){this.showNewListModal=!1}createList(){var e=this;return fe(function*(){const r=e.newListName.trim();if(!r)return;const i=yield e.shoppingService.createList(r,e.newListIcon);e.shoppingService.setActiveList(i),e.closeNewListModal()})()}openDeleteListModal(){this.showDeleteListModal=!0}closeDeleteListModal(){this.showDeleteListModal=!1}confirmDeleteList(){var e=this;return fe(function*(){const r=e.activeList();r&&(yield e.shoppingService.deleteList(r.id),e.closeDeleteListModal())})()}addItem(){var e=this;return fe(function*(){const r=e.newItemName.trim();if(!r)return;const i=pi.currentUser;let o="",a="";if(i){const f=(yield tf(Tn(Pn,`/users/${i.uid}`))).val()||{};o=f.displayName||i.displayName||"",a=f.photoURL||i.photoURL||""}e.shoppingService.addItem({nom:r,category:e.newItemCategory,quantity:e.newItemQuantity.trim()||"1",checked:!1,addedBy:i?.uid||"",addedByName:o,addedByPhoto:a,addedAt:(new Date).toISOString()}),e.newItemName="",e.newItemQuantity="",e.newItemCategory="autre",e.showAddForm=!1})()}toggleChecked(e){this.shoppingService.toggleChecked(e.id,!e.checked)}removeItem(e){this.shoppingService.removeItem(e.id)}clearChecked(){this.shoppingService.clearChecked()}getCategoryIcon(e){return this.categories.find(r=>r.key===e)?.icon||"\u{1f4e6}"}static{this.\u0275fac=function(r){return new(r||t)(Ne(fO))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-shopping"]],decls:14,vars:4,consts:[[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-4"],[1,"flex","items-center","gap-2","mb-6","overflow-x-auto","pb-2","scrollbar-hide"],[3,"class"],[1,"flex-shrink-0","min-w-10","w-10","h-10","aspect-square","rounded-full","bg-white","border-2","border-dashed","border-gray-300","flex","items-center","justify-center","text-gray-400","hover:border-family-purple","hover:text-family-purple","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"text-center","py-12","text-gray-400"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"text-sm","text-gray-400","mt-1"],[3,"click"],[1,"flex","justify-end","mb-4"],[1,"text-xs","text-gray-400","hover:text-red-400","transition-colors",3,"click"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-green","transition-colors"],[1,"card-fun","p-4","mb-6"],[1,"mb-4"],[1,"mt-6"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-green","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],[1,"font-medium"],[1,"space-y-3"],["placeholder","Nom de l'article...","autofocus","",1,"input-fun","w-full",3,"ngModelChange","keyup.enter","ngModel"],[1,"flex","gap-3"],["placeholder","Qt\xe9 (ex: 2, 500g...)",1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","justify-end","gap-2"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","text-sm","font-medium",3,"click"],[1,"btn-gradient","text-sm","px-6","py-2",3,"click","disabled"],[1,"font-display","font-bold","text-sm","text-gray-500","mb-2","flex","items-center","gap-1.5"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],[1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors"],[1,"w-6","h-6","rounded-full","border-2","border-gray-300","flex-shrink-0","hover:border-family-green","transition-colors",3,"click"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-700"],[1,"text-xs","text-gray-400","ml-2"],[1,"flex","items-center","gap-1.5","mt-0.5"],[1,"text-gray-300","hover:text-red-400","transition-colors","flex-shrink-0",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],["referrerpolicy","no-referrer",1,"w-4","h-4","rounded-full","object-cover",3,"src"],[1,"text-xs","text-gray-400","truncate"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-display","font-bold","text-sm","text-gray-400","flex","items-center","gap-1.5"],[1,"text-xs","text-red-400","hover:text-red-500","transition-colors","font-medium",3,"click"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100","opacity-60"],[1,"flex","items-center","gap-3","px-4","py-3"],[1,"w-6","h-6","rounded-full","bg-family-green","flex-shrink-0","flex","items-center","justify-center",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-3.5","h-3.5","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],[1,"flex-1","line-through","text-gray-400"],[1,"text-4xl","mb-3"],[1,"text-sm"],[1,"text-sm","mb-4"],[1,"btn-gradient","text-sm","px-6","py-2",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full"],[1,"p-6"],[1,"font-display","text-xl","font-bold","text-gray-800","mb-4"],[1,"space-y-4"],["placeholder","Nom de la liste...","autofocus","",1,"input-fun","w-full",3,"ngModelChange","keyup.enter","ngModel"],[1,"text-sm","text-gray-500","mb-2","block"],[1,"flex","flex-wrap","gap-2"],[1,"flex","gap-3","mt-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","btn-gradient","py-2.5",3,"click","disabled"],[1,"text-4xl","mb-2"],[1,"font-display","text-xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500","mt-2"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1),ot(2,tEe,4,5)(3,nEe,4,0),V(),O(4,"div",2),On(5,rEe,2,4,"button",3,pO),O(7,"button",4),Pe("click",function(){return i.openNewListModal()}),xn(),O(8,"svg",5),ut(9,"path",6),V()()(),ot(10,mEe,9,4)(11,gEe,9,0,"div",7),V(),ot(12,yEe,18,2,"div",8),ot(13,vEe,15,2,"div",8)),2&r&&(Y(2),st(i.activeList()?2:3),Y(3),Ln(i.lists()),Y(5),st(i.activeList()?10:11),Y(2),st(i.showNewListModal?12:-1),Y(),st(i.showDeleteListModal?13:-1))},dependencies:[Ic,Xy,Zy,Ky,zl,Up,Iu,Vp],styles:["select.input-fun[_ngcontent-%COMP%]{appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}"]})}}return t})(),x7=(()=>{class t{constructor(e,r){this.dialogRef=e,this.data=r,this.customMessage=r.customMessage}static{this.\u0275fac=function(r){return new(r||t)(Ne(dg),Ne(TC))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-confirm-dialog"]],decls:8,vars:1,consts:[[1,"p-6","max-w-sm"],[1,"font-display","text-lg","font-semibold","text-gray-700"],[1,"flex","justify-end","gap-3","mt-6"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"btn-gradient","px-6","py-2",3,"click"]],template:function(r,i){1&r&&(Yt(0,"div",0)(1,"h2",1),q(2),Gt(),Yt(3,"div",2)(4,"button",3),ba("click",function(){return i.dialogRef.close()}),q(5,"Non"),Gt(),Yt(6,"button",4),ba("click",function(){return i.dialogRef.close(!0)}),q(7,"Oui"),Gt()()()),2&r&&(Y(2),xt(i.customMessage))},encapsulation:2})}}return t})();const wEe=(t,n)=>n.uid;function xEe(t,n){1&t&&(xn(),O(0,"svg",7),ut(1,"path",31),V())}function EEe(t,n){1&t&&(xn(),O(0,"svg",32),ut(1,"path",31),V())}function CEe(t,n){1&t&&ut(0,"img",33),2&t&&pn("src",ge().$implicit.photoURL,vs)}function DEe(t,n){if(1&t){const e=Ut();O(0,"button",6),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().toggleUser(i.displayName||i.email||""))}),O(1,"div"),ot(2,EEe,2,0,":svg:svg",32),V(),ot(3,CEe,1,1,"img",33),O(4,"span",34),q(5),V()()}if(2&t){const e=n.$implicit,r=ge();is(r.isUserSelected(e.displayName||e.email||"")?"flex items-center gap-2 p-2.5 rounded-xl bg-family-purple/10 border-2 border-family-purple transition-all":"flex items-center gap-2 p-2.5 rounded-xl bg-gray-50 border-2 border-transparent hover:border-gray-200 transition-all"),Y(),is(r.isUserSelected(e.displayName||e.email||"")?"w-4 h-4 rounded flex-shrink-0 bg-family-purple flex items-center justify-center":"w-4 h-4 rounded flex-shrink-0 border-2 border-gray-300"),Y(),st(r.isUserSelected(e.displayName||e.email||"")?2:-1),Y(),st(e.photoURL?3:-1),Y(2),xt(e.displayName||e.email)}}let TEe=(()=>{class t{constructor(e,r,i,o,a,c,f){this.route=e,this.tasksService=r,this.formBuilder=i,this._snackBar=o,this.router=a,this.dialog=c,this.userService=f,this.taskToEdit=null,this.allUsers=[],this.selectedUsers=new Set,this.selectAll=!1,Do(()=>{if(this.taskToEdit)return;const _=this.route.snapshot.params.id,x=this.tasksService.tasks().find(C=>C.id===_);x&&(this.taskToEdit=x,this.editTaskForm=this.formBuilder.group({id:[x.id,[Fd.required]],urg:[x.urg,[Fd.required]],title:[x.title,[Fd.required]],descriptif:[x.descriptif],createdDate:[x.createdDate||""],statut:[x.statut||""]}),"Tout le monde"===x.name?this.selectAll=!0:x.name.split(", ").map(A=>A.trim()).filter(A=>A).forEach(A=>this.selectedUsers.add(A)))})}onDelete(e){this.dialog.open(x7,{data:{customMessage:"Etes-vous sur(e) de vouloir supprimer la tache"}}).afterClosed().subscribe(i=>{!0===i&&(this.tasksService.removeTask(e.id),this.router.navigate(["/home"]))})}ngOnInit(){this.userService.getAllUsers().then(e=>this.allUsers=e).catch(()=>this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3}))}toggleUser(e){this.selectedUsers.has(e)?this.selectedUsers.delete(e):this.selectedUsers.add(e),this.selectAll=!1}toggleSelectAll(){this.selectAll=!this.selectAll,this.selectAll&&this.selectedUsers.clear()}isUserSelected(e){return this.selectedUsers.has(e)}get hasSelection(){return this.selectAll||this.selectedUsers.size>0}editTask(){this.hasSelection?this.dialog.open(x7,{data:{customMessage:"Etes-vous sur(e) de vouloir modifier la tache"}}).afterClosed().subscribe(r=>{if(!0===r){const i=this.selectAll?"Tout le monde":Array.from(this.selectedUsers).join(", "),o={...this.editTaskForm.value,name:i};this.tasksService.updateTaskById(this.route.snapshot.params.id,o),this.router.navigate(["/home"]),this._snackBar.open("Tache modifiee","avec succes !!",{duration:5e3})}}):this._snackBar.open("Selectionne au moins une personne","",{duration:3e3})}goBack(){this.router.navigate(["/home"])}static{this.\u0275fac=function(r){return new(r||t)(Ne(rg),Ne(Cw),Ne(oT),Ne(xp),Ne($s),Ne(hg),Ne(Od))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-edit-task"]],decls:56,vars:7,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],[1,"block","mb-2","text-sm","font-medium","text-gray-600"],[1,"space-y-2"],["type","button",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-3","h-3","text-white"],[1,"font-medium","text-gray-700"],[1,"grid","grid-cols-2","gap-2"],["type","button",3,"class"],["for","statut",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","statut","id","statut","required","",1,"input-fun","w-full"],["value","Nouveau"],["value","En cours"],["value","Fait"],["value","Bloque"],["value","Archive"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","Decrivez la tache...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"px-4","py-2","rounded-xl","bg-red-50","text-red-500","hover:bg-red-100","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient","px-6","py-2","text-sm","font-medium",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-2.5","h-2.5","text-white"],["referrerpolicy","no-referrer",1,"w-6","h-6","rounded-full","object-cover",3,"src"],[1,"text-sm","font-medium","text-gray-700","truncate"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1)(2,"h3",2),q(3,"\u{1f4dd} Editer la Tache"),V(),O(4,"form",3)(5,"div")(6,"label",4),q(7,"Tache pour"),V(),O(8,"div",5)(9,"button",6),Pe("click",function(){return i.toggleSelectAll()}),O(10,"div"),ot(11,xEe,2,0,":svg:svg",7),V(),O(12,"span",8),q(13,"Tout le monde"),V()(),O(14,"div",9),On(15,DEe,6,7,"button",10,wEe),V()()(),O(17,"div")(18,"label",11),q(19,"Statut"),V(),O(20,"select",12)(21,"option",13),q(22,"Nouveau"),V(),O(23,"option",14),q(24,"En cours"),V(),O(25,"option",15),q(26,"Fait"),V(),O(27,"option",16),q(28,"Bloque"),V(),O(29,"option",17),q(30,"Archive"),V()()(),O(31,"div")(32,"label",18),q(33,"Priorite"),V(),O(34,"select",19)(35,"option",20),q(36,"Urgent !"),V(),O(37,"option",21),q(38,"Relativement urgent"),V(),O(39,"option",22),q(40,"Pas Urgent"),V()()(),O(41,"div")(42,"label",23),q(43,"Titre"),V(),ut(44,"input",24),V(),O(45,"div")(46,"label",25),q(47,"Descriptif"),V(),ut(48,"textarea",26),V(),O(49,"div",27)(50,"button",28),Pe("click",function(){return i.goBack()}),q(51,"Retour"),V(),O(52,"button",29),Pe("click",function(){return i.onDelete(i.taskToEdit)}),q(53,"Supprimer"),V(),O(54,"button",30),Pe("click",function(){return i.editTask()}),q(55,"Modifier"),V()()()()()),2&r&&(Y(4),pn("formGroup",i.editTaskForm),Y(5),is(i.selectAll?"w-full flex items-center gap-3 p-3 rounded-xl bg-gradient-to-r from-family-purple/10 to-family-pink/10 border-2 border-family-purple transition-all":"w-full flex items-center gap-3 p-3 rounded-xl bg-gray-50 border-2 border-transparent hover:border-gray-200 transition-all"),Y(),is(i.selectAll?"w-5 h-5 rounded-full bg-family-purple flex items-center justify-center":"w-5 h-5 rounded-full border-2 border-gray-300"),Y(),st(i.selectAll?11:-1),Y(4),Ln(i.allUsers),Y(39),pn("disabled",i.editTaskForm.invalid||!i.hasSelection))},dependencies:[sT,xw,Zy,Ky,zl,Up,Iu,pw,Yy,Wy,Gy,Ic],encapsulation:2})}}return t})();const SEe=["previewImg"];function IEe(t,n){1&t&&(O(0,"span",15),q(1,"Charge !"),V())}function kEe(t,n){if(1&t){const e=Ut();O(0,"div",7)(1,"h3",8),q(2,"\u270f\ufe0f Modifier le profil"),V(),O(3,"form",9),Pe("ngSubmit",function(){return Me(e),Oe(ge().onSubmitProfileForm())}),O(4,"div",10),ut(5,"img",11),O(6,"label",12)(7,"span",13),q(8,"Choisir une photo"),V(),O(9,"input",14),Pe("change",function(i){return Me(e),Oe(ge().detectFiles(i))}),V()(),ot(10,IEe,2,0,"span",15),V(),O(11,"div")(12,"label",16),q(13,"Prenom"),V(),ut(14,"input",17),V(),O(15,"div")(16,"label",18),q(17,"Telephone"),V(),ut(18,"input",19),V(),O(19,"div")(20,"label",20),q(21,"Email"),V(),ut(22,"input",21),V(),O(23,"div")(24,"label",22),q(25,"Anniversaire"),V(),ut(26,"input",23),V(),O(27,"button",24),q(28,"Enregistrer"),V()()(),O(29,"div",25)(30,"h3",8),q(31,"\u{1f4c5} Google Calendar"),V(),O(32,"div",26),ut(33,"div",27),O(34,"span",28),q(35,"Connecte automatiquement via votre compte Google"),V()()()}if(2&t){const e=ge();Y(3),pn("formGroup",e.profileForm),Y(2),pn("src",e.fileUrl,vs),Y(5),st(e.fileUploaded?10:-1),Y(17),pn("disabled",e.profileForm.invalid)}}let AEe=(()=>{class t{constructor(e,r,i){this.editProfileService=e,this._snackBar=r,this.formBuilder=i,this.user=null,this.fileIsUploading=!1,this.fileUploaded=!1}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{this.user=e,this.user&&this.initForm(this.user)},()=>{this._snackBar.open("Erreur lors du chargement du profil","",{duration:5e3})})}initForm(e){this.profileForm=this.formBuilder.group({emailControl:[{value:e?.email||"",disabled:!0},[Fd.required,Fd.email]],displayNameControl:[e?.displayName||""],phoneNumberControl:[e?.phoneNumber||""],photoURLControl:[""],dateBirthControl:[e?.dateBirth?e.dateBirth.substring(0,10):""]}),this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"}loadFile(e){this.fileIsUploading=!0,this.editProfileService.deleteOldAvatar(this.user?.photoURL||"").then(()=>this.editProfileService.uploadFile(e)).then(i=>{this.fileUrl=i,this.profileForm.get("photoURLControl")?.setValue(""),this.fileIsUploading=!1,this.fileUploaded=!0})}detectFiles(e){const r=e.target;r.files?.[0]&&this.loadFile(r.files[0])}onSubmitProfileForm(){const e=this.user?.uid;if(!e)return;const r=this.profileForm.value;this.editProfileService.updateUserData(e,{displayName:r.displayNameControl||"",phoneNumber:r.phoneNumberControl||"",photoURL:this.fileUrl,dateBirth:r.dateBirthControl||""}).then(()=>this._snackBar.open("Profil mis a jour","avec succes !!",{duration:5e3})).catch(()=>this._snackBar.open("Erreur lors de la mise a jour","",{duration:5e3}))}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Ne(jD),Ne(xp),Ne(oT))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-user-profile"]],viewQuery:function(r,i){if(1&r&&dp(SEe,5),2&r){let o;gd(o=_d())&&(i.previewImg=o.first)}},decls:10,vars:4,consts:[[1,"card-fun","overflow-hidden","mb-6"],[1,"h-24","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange"],[1,"px-6","pb-6","-mt-10","flex","items-end","gap-4"],["alt","Photo de profil","referrerpolicy","no-referrer",1,"h-20","w-20","rounded-full","object-cover","ring-4","ring-white","shadow-lg",3,"src"],[1,"pb-1"],[1,"font-display","text-xl","font-bold","text-gray-700"],[1,"text-sm","text-gray-400"],[1,"card-fun","p-6","max-w-lg","mx-auto"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4"],["alt","Avatar","referrerpolicy","no-referrer",1,"h-14","w-14","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"block"],[1,"sr-only"],["formControlName","photoURLControl","type","file","accept","image/*",1,"block","w-full","text-sm","text-gray-500","file:mr-3","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-family-pink/10","file:text-family-pink","hover:file:bg-family-pink/20","transition-colors",3,"change"],[1,"text-family-green","text-sm","font-medium"],["for","prenom",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","text","id","prenom","formControlName","displayNameControl","placeholder","Prenom",1,"input-fun","w-full"],["for","phone",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","tel","id","phone","formControlName","phoneNumberControl","placeholder","Votre numero",1,"input-fun","w-full"],["for","email",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","email","id","email","formControlName","emailControl","placeholder","Votre email",1,"input-fun","w-full"],["for","dateBirth",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","date","id","dateBirth","formControlName","dateBirthControl",1,"input-fun","w-full"],["type","submit",1,"btn-gradient","w-full",3,"disabled"],[1,"card-fun","p-6","max-w-lg","mx-auto","mt-6"],[1,"flex","items-center","gap-3"],[1,"w-3","h-3","rounded-full","bg-family-green"],[1,"text-sm","text-gray-600"]],template:function(r,i){1&r&&(O(0,"div",0),ut(1,"div",1),O(2,"div",2),ut(3,"img",3),O(4,"div",4)(5,"h2",5),q(6),V(),O(7,"p",6),q(8),V()()()(),ot(9,kEe,36,4)),2&r&&(Y(3),pn("src",i.fileUrl,vs),Y(3),xt((null==i.user?null:i.user.displayName)||"Mon Profil"),Y(2),xt(null==i.user?null:i.user.email),Y(),st(i.profileForm?9:-1))},dependencies:[sT,xw,zl,Iu,pw,Wy,Gy],encapsulation:2})}}return t})();const af={production:!0,googleCalendar:{apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",clientId:"728695329604-70417p57psoofhqlsio6qjv705a0ieqf.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest","https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scopes:"https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/drive",familyCalendarId:"family12498967542838679084@group.calendar.google.com",familyDriveFolderId:"1yWZtCJZGlt2wfqmkcrJThLuY8m-aI0TW"}},MEe=(t,n)=>n.id;function REe(t,n){if(1&t&&(O(0,"option",16),q(1),V()),2&t){const e=n.$implicit;pn("value",e.id),Y(),xt(e.summary)}}function PEe(t,n){if(1&t&&(O(0,"div")(1,"label",3),q(2,"Agenda"),V(),O(3,"select",15),On(4,REe,2,2,"option",16,MEe),V()()),2&t){const e=ge();Y(4),Ln(e.data.calendars)}}function NEe(t,n){1&t&&(O(0,"div",9)(1,"div")(2,"label",3),q(3,"Heure debut"),V(),ut(4,"input",17),V(),O(5,"div")(6,"label",3),q(7,"Heure fin"),V(),ut(8,"input",18),V()())}let OEe=(()=>{class t{constructor(e,r,i){this.fb=e,this.dialogRef=r,this.data=i;const o=this.formatLocalDate(i.date),a=af.googleCalendar.familyCalendarId,c=i.calendars?.find(f=>f.id===a)?.id||i.calendars?.find(f=>f.primary)?.id||"primary";this.eventForm=this.fb.group({title:["",Fd.required],description:[""],calendarId:[c],allDay:[!0],startDate:[o,Fd.required],endDate:[o,Fd.required],startTime:["09:00"],endTime:["10:00"]})}onCancel(){this.dialogRef.close()}onSubmit(){if(this.eventForm.invalid)return;const e=this.eventForm.value;let r=e.endDate;if(e.allDay){const o=new Date(e.endDate+"T00:00:00");o.setDate(o.getDate()+1),r=this.formatLocalDate(o)}this.dialogRef.close({id:"",title:e.title,description:e.description,allDay:e.allDay,calendarId:e.calendarId||"primary",startDate:e.allDay?e.startDate:`${e.startDate}T${e.startTime}:00`,endDate:e.allDay?r:`${e.endDate}T${e.endTime}:00`})}formatLocalDate(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}static{this.\u0275fac=function(r){return new(r||t)(Ne(oT),Ne(dg),Ne(TC))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-add-event-dialog"]],decls:32,vars:4,consts:[[1,"p-6"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","placeholder","Ex. Reunion famille...","required","",1,"input-fun","w-full"],["formControlName","description","rows","3","placeholder","Details...",1,"input-fun","w-full","resize-y"],[1,"flex","items-center","gap-2","mb-2"],["type","checkbox","formControlName","allDay","id","allDay",1,"rounded"],["for","allDay",1,"text-sm","text-gray-600"],[1,"grid","grid-cols-2","gap-3"],["formControlName","startDate","type","date",1,"input-fun","w-full"],["formControlName","endDate","type","date",1,"input-fun","w-full"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"btn-gradient","px-6","py-2",3,"click","disabled"],["formControlName","calendarId",1,"input-fun","w-full"],[3,"value"],["formControlName","startTime","type","time",1,"input-fun","w-full"],["formControlName","endTime","type","time",1,"input-fun","w-full"]],template:function(r,i){if(1&r&&(O(0,"div",0)(1,"h2",1),q(2,"Nouvel evenement"),V(),O(3,"form",2)(4,"div")(5,"label",3),q(6,"Titre"),V(),ut(7,"input",4),V(),ot(8,PEe,6,0,"div"),O(9,"div")(10,"label",3),q(11,"Description"),V(),ut(12,"textarea",5),V(),O(13,"div",6),ut(14,"input",7),O(15,"label",8),q(16,"Toute la journee"),V()(),O(17,"div",9)(18,"div")(19,"label",3),q(20,"Debut"),V(),ut(21,"input",10),V(),O(22,"div")(23,"label",3),q(24,"Fin"),V(),ut(25,"input",11),V()(),ot(26,NEe,9,0,"div",9),O(27,"div",12)(28,"button",13),Pe("click",function(){return i.onCancel()}),q(29," Annuler "),V(),O(30,"button",14),Pe("click",function(){return i.onSubmit()}),q(31," Creer "),V()()()()),2&r){let o;Y(3),pn("formGroup",i.eventForm),Y(5),st(i.data.calendars&&i.data.calendars.length>1?8:-1),Y(18),st(null!=(o=i.eventForm.get("allDay"))&&o.value?-1:26),Y(4),pn("disabled",i.eventForm.invalid)}},dependencies:[sT,xw,Zy,Ky,zl,kN,Up,Iu,pw,Yy,Wy,Gy],encapsulation:2})}}return t})();function LEe(t,n){if(1&t&&(Yt(0,"div",5)(1,"span",6),q(2,"\u{1f4c5}"),Gt(),Yt(3,"span"),q(4),Gt()()),2&t){const e=ge();Y(4),xt(e.data.event.calendarName)}}function FEe(t,n){if(1&t&&(Yt(0,"span"),q(1),J_(2,"date"),Gt()),2&t){const e=ge();Y(),_r("Toute la journee \xb7 ",ey(2,1,e.data.event.startDate,"EEEE d MMMM yyyy","","fr"))}}function BEe(t,n){if(1&t&&(Yt(0,"span"),q(1),J_(2,"date"),J_(3,"date"),Gt()),2&t){const e=ge();Y(),bs("",ey(2,2,e.data.event.startDate,"EEEE d MMMM yyyy, HH:mm","","fr")," \u2014 ",ey(3,7,e.data.event.endDate,"HH:mm","","fr"))}}function VEe(t,n){if(1&t&&(Yt(0,"div",7)(1,"span",11),q(2,"\u{1f4cd}"),Gt(),Yt(3,"span"),q(4),Gt()()),2&t){const e=ge();Y(4),xt(e.data.event.location)}}function UEe(t,n){if(1&t&&(Yt(0,"div",5)(1,"span",6),q(2,"\u{1f464}"),Gt(),Yt(3,"span"),q(4,"Cree par : "),Yt(5,"span",12),q(6),Gt()()()),2&t){const e=ge();Y(6),xt(e.data.event.creatorName)}}function zEe(t,n){if(1&t&&(Yt(0,"div",8),q(1),Gt()),2&t){const e=ge();Y(),xt(e.data.event.description)}}let jEe=(()=>{class t{constructor(e,r){this.dialogRef=e,this.data=r}close(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(Ne(dg),Ne(TC))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-event-detail-dialog"]],decls:18,vars:8,consts:[[1,"p-6"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-3","h-3","rounded-full","shrink-0"],[1,"font-display","text-lg","font-bold","text-gray-700"],[1,"space-y-3","text-sm"],[1,"flex","items-center","gap-2","text-gray-500"],[1,"w-5","text-center"],[1,"flex","items-start","gap-2","text-gray-500"],[1,"mt-3","p-3","bg-gray-50","rounded-xl","text-gray-600","text-sm","whitespace-pre-wrap"],[1,"flex","justify-end","pt-4"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"w-5","text-center","shrink-0"],[1,"font-medium","text-gray-600"]],template:function(r,i){1&r&&(Yt(0,"div",0)(1,"div",1),md(2,"div",2),Yt(3,"h2",3),q(4),Gt()(),Yt(5,"div",4),ot(6,LEe,5,1,"div",5),Yt(7,"div",5)(8,"span",6),q(9,"\u{1f550}"),Gt(),ot(10,FEe,3,6,"span")(11,BEe,4,12,"span"),Gt(),ot(12,VEe,5,1,"div",7),ot(13,UEe,7,1,"div",5),ot(14,zEe,2,1,"div",8),Gt(),Yt(15,"div",9)(16,"button",10),ba("click",function(){return i.close()}),q(17," Fermer "),Gt()()()),2&r&&(Y(2),Wm("background-color",i.data.event.color||"#4285f4"),Y(2),xt(i.data.event.title),Y(2),st(i.data.event.calendarName?6:-1),Y(4),st(i.data.event.allDay?10:11),Y(2),st(i.data.event.location?12:-1),Y(),st(i.data.event.creatorName?13:-1),Y(),st(i.data.event.description?14:-1))},dependencies:[Ic,BE],encapsulation:2})}}return t})(),fT=(()=>{class t{constructor(e){this.authService=e,this.gapiLoaded=!1,this.tokenClient=null,this.accessToken=null,this.googleEmail=null,this.signInResolve=null,this.connectionChanged=new ee,this.authService.googleToken$.subscribe(r=>{this.setToken(r)}),ZC(pi,r=>{r&&!this.accessToken&&setTimeout(()=>{this.accessToken||this.requestTokenSilently()},1500)})}requestTokenSilently(){var e=this;return fe(function*(){try{yield e.loadGapi(),yield e.initTokenClient(),e.tokenClient&&e.tokenClient.requestAccessToken({prompt:""})}catch{}})()}setToken(e){this.accessToken=e,this.loadGapi().then(()=>{gapi.client.setToken({access_token:e})}).catch(()=>{}),this.fetchGoogleEmail(),this.saveConnectionStatus(!0),this.connectionChanged.next(!0)}loadGapi(){var e=this;return this.gapiLoaded?Promise.resolve():new Promise((r,i)=>{const o=()=>{typeof gapi>"u"?setTimeout(o,200):gapi.load("client",fe(function*(){try{yield gapi.client.init({discoveryDocs:af.googleCalendar.discoveryDocs}),e.gapiLoaded=!0,r()}catch(a){i(a)}}))};o()})}initTokenClient(){return new Promise(e=>{const r=()=>{typeof google>"u"||!google.accounts?.oauth2?setTimeout(r,200):(this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:af.googleCalendar.clientId,scope:af.googleCalendar.scopes,callback:i=>{i.error?this.signInResolve&&(this.signInResolve(!1),this.signInResolve=null):(this.accessToken=i.access_token||null,this.accessToken&&(gapi.client.setToken({access_token:this.accessToken}),this.fetchGoogleEmail()),this.saveConnectionStatus(!!this.accessToken),this.connectionChanged.next(!!this.accessToken),this.signInResolve&&(this.signInResolve(!!this.accessToken),this.signInResolve=null))}}),e())};r()})}signIn(){return new Promise(e=>{this.tokenClient?(this.signInResolve=e,this.tokenClient.requestAccessToken({prompt:"consent"})):e(!1)})}signOut(){if(this.accessToken){try{google.accounts.oauth2.revoke(this.accessToken)}catch{}try{gapi.client.setToken(null)}catch{}this.accessToken=null,this.googleEmail=null,this.saveConnectionStatus(!1),this.connectionChanged.next(!1)}}isConnected(){return!!this.accessToken}getAccessToken(){return this.accessToken}getGoogleEmail(){return this.googleEmail}fetchGoogleEmail(){var e=this;return fe(function*(){try{const i=yield(yield fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e.accessToken}`}})).json();e.googleEmail=i.email||null}catch{e.googleEmail=null}})()}saveConnectionStatus(e){const r=pi.currentUser?.uid;r&&Md(Tn(Pn,`/users/${r}`),{googleCalendar:{connected:e,calendarId:"primary"}})}static{this.\u0275fac=function(r){return new(r||t)(Tt(Od))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),HEe=(()=>{class t{constructor(e,r){this.googleAuth=e,this.authService=r,this.events=[],this.eventsSubject=new ee,this.calendars=[],this.calendarsSubject=new ee}emitEvents(){this.eventsSubject.next(this.events)}ensureToken(){const e=this.googleAuth.getAccessToken();e&&gapi.client.setToken({access_token:e})}getCalendars(){var e=this;return fe(function*(){if(!e.googleAuth.isConnected())return[];try{yield e.googleAuth.loadGapi(),e.ensureToken();const r=yield gapi.client.calendar.calendarList.list();console.log("Calendar list response:",r.result.items?.length,"calendars");const i=(r.result.items||[]).filter(a=>{const c=a.id||"";return!(c.includes("#weeknum")||c.includes("#contacts")||c.includes("#holiday")||c.includes("addressbook"))});e.calendars=i.map(a=>({id:a.id,summary:a.summary||a.id,backgroundColor:a.backgroundColor||"#4285f4",primary:!!a.primary}));const o=af.googleCalendar.familyCalendarId;return o&&!e.calendars.find(a=>a.id===o)&&e.calendars.push({id:o,summary:"Famille",backgroundColor:"#e67c73"}),e.calendarsSubject.next(e.calendars),e.calendars}catch{return[]}})()}getEvents(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return[];try{yield i.googleAuth.loadGapi(),i.ensureToken(),0===i.calendars.length&&(yield i.getCalendars());const o=pi.currentUser,a=i.calendars.map(function(){var _=fe(function*(x){try{return((yield gapi.client.calendar.events.list({calendarId:x.id,timeMin:e.toISOString(),timeMax:r.toISOString(),showDeleted:!1,singleEvents:!0,orderBy:"startTime"})).result.items||[]).map(A=>({id:A.id,title:A.summary||"(Sans titre)",description:A.description||"",startDate:A.start?.dateTime||A.start?.date||"",endDate:A.end?.dateTime||A.end?.date||"",allDay:!!A.start?.date,color:x.backgroundColor,calendarId:x.id,calendarName:x.summary,location:A.location||"",creatorUid:o?.uid||"",creatorName:A.creator?.displayName||A.creator?.email||""}))}catch(C){return console.error("Error fetching events from",x.id,C),[]}});return function(x){return _.apply(this,arguments)}}()),c=yield Promise.all(a),f=[];return c.forEach(_=>f.push(..._)),console.log("Total events fetched:",f.length,"from",i.calendars.length,"calendars"),f.sort((_,x)=>_.startDate.localeCompare(x.startDate)),i.events=f,i.emitEvents(),i.events}catch{return[]}})()}createEvent(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=e.calendarId||af.googleCalendar.familyCalendarId||"primary",o={summary:e.title,description:e.description||""};e.allDay?(o.start={date:e.startDate.substring(0,10)},o.end={date:e.endDate.substring(0,10)}):(o.start={dateTime:e.startDate},o.end={dateTime:e.endDate});const a=yield gapi.client.calendar.events.insert({calendarId:i,resource:o}),c=r.calendars.find(_=>_.id===i);return{id:a.result.id,title:a.result.summary,description:a.result.description||"",startDate:a.result.start?.dateTime||a.result.start?.date||"",endDate:a.result.end?.dateTime||a.result.end?.date||"",allDay:!!a.result.start?.date,calendarId:i,calendarName:c?.summary||i,color:c?.backgroundColor}}catch{return null}})()}deleteEvent(e){var r=this;return fe(function*(i,o="primary"){if(r.googleAuth.isConnected())try{yield r.googleAuth.loadGapi(),r.ensureToken(),yield gapi.client.calendar.events.delete({calendarId:o,eventId:i})}catch{}}).apply(this,arguments)}static{this.\u0275fac=function(r){return new(r||t)(Tt(fT),Tt(Od))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const mO=(t,n)=>n.id;function $Ee(t,n){if(1&t){const e=Ut();Yt(0,"div",4)(1,"div",5),q(2,"\u{1f4c5}"),Gt(),Yt(3,"h2",6),q(4,"Chargement du calendrier..."),Gt(),Yt(5,"p",7),q(6,"Connexion a Google Calendar en cours"),Gt(),Yt(7,"button",8),ba("click",function(){return Me(e),Oe(ge().connectGoogle())}),q(8," Reconnecter Google Calendar "),Gt()()}}function qEe(t,n){if(1&t&&(Yt(0,"div",24),md(1,"div",25),Yt(2,"span",26),q(3),Gt()()),2&t){const e=n.$implicit;Y(),Wm("background-color",e.backgroundColor),Y(2),xt(e.summary)}}function GEe(t,n){if(1&t&&(Yt(0,"div",17)(1,"div",23),On(2,qEe,4,3,"div",24,mO),Gt()()),2&t){const e=ge(2);Y(2),Ln(e.calendars)}}function WEe(t,n){if(1&t&&(Yt(0,"div",20),q(1),Gt()),2&t){const e=n.$implicit;Y(),xt(e)}}function ZEe(t,n){if(1&t&&(Yt(0,"span",32),q(1),Gt()),2&t){const e=ge(2).$implicit,r=ge(3);Y(),_r("S",r.getWeekNumber(e))}}function KEe(t,n){if(1&t){const e=Ut();Yt(0,"div",34),ba("click",function(i){const o=Me(e).$implicit;return ge(5).viewEvent(o),Oe(i.stopPropagation())}),q(1),Gt()}if(2&t){const e=n.$implicit;Wm("background-color",e.color||"#4285f4"),fb("title",e.calendarName?e.calendarName+" \u2014 "+e.title:e.title),Y(),_r(" ",e.title," ")}}function YEe(t,n){if(1&t){const e=Ut();Yt(0,"div",29),ba("click",function(){Me(e);const i=ge().$implicit;return Oe(ge(3).openAddEvent(i))}),Yt(1,"div",30)(2,"span",31),q(3),Gt(),ot(4,ZEe,2,1,"span",32),Gt(),On(5,KEe,2,4,"div",33,mO),Gt()}if(2&t){const e=ge().$implicit,r=ge(3);js("bg-gradient-to-br",r.isToday(e))("from-family-pink/10",r.isToday(e))("to-family-orange/10",r.isToday(e))("border-family-pink",r.isToday(e))("border-gray-100",!r.isToday(e)),Y(2),js("text-family-pink",r.isToday(e))("text-gray-600",!r.isToday(e)),Y(),_r(" ",e.getDate()," "),Y(),st(r.isMonday(e)?4:-1),Y(),Ln(r.getEventsForDay(e))}}function XEe(t,n){1&t&&md(0,"div",28)}function QEe(t,n){1&t&&ot(0,YEe,7,16,"div",27)(1,XEe,1,0,"div",28),2&t&&st(n.$implicit?0:1)}function JEe(t,n){if(1&t&&(Yt(0,"div",21),On(1,QEe,2,1,null,null,hb),Gt()),2&t){const e=n.$implicit;Y(),Ln(e)}}function eCe(t,n){if(1&t&&(Yt(0,"span",43),q(1),Gt(),q(2," \xb7 ")),2&t){const e=ge().$implicit;Y(),xt(e.calendarName)}}function tCe(t,n){1&t&&q(0),2&t&&_r(" ",ge().$implicit.creatorName," \xb7 ")}function nCe(t,n){1&t&&q(0," Toute la journee ")}function rCe(t,n){1&t&&(q(0),J_(1,"date")),2&t&&_r(" ",ey(1,1,ge().$implicit.startDate,"d MMM, HH:mm","","fr")," ")}function iCe(t,n){if(1&t){const e=Ut();Yt(0,"button",44),ba("click",function(i){Me(e);const o=ge().$implicit;return ge(3).deleteEvent(o),Oe(i.stopPropagation())}),q(1," Supprimer "),Gt()}}function oCe(t,n){if(1&t){const e=Ut();Yt(0,"div",37),ba("click",function(){const i=Me(e).$implicit;return Oe(ge(3).viewEvent(i))}),Yt(1,"div",38),md(2,"div",39),Yt(3,"div")(4,"div",40),q(5),Gt(),Yt(6,"div",41),ot(7,eCe,3,1),ot(8,tCe,1,1),ot(9,nCe,1,0)(10,rCe,2,6),Gt()()(),ot(11,iCe,2,0,"button",42),Gt()}if(2&t){const e=n.$implicit,r=ge(3);Y(2),Wm("background-color",e.color||"#4285f4"),Y(3),xt(e.title),Y(2),st(e.calendarName?7:-1),Y(),st(e.creatorName?8:-1),Y(),st(e.allDay?9:10),Y(2),st(r.canDelete(e)?11:-1)}}function sCe(t,n){if(1&t&&(Yt(0,"div",22)(1,"h3",35),q(2,"Prochains evenements"),Gt(),On(3,oCe,12,7,"div",36,mO),Gt()),2&t){const e=ge(2);Y(3),Ln(e.events)}}function aCe(t,n){if(1&t){const e=Ut();Yt(0,"div",9)(1,"div",10)(2,"div",11)(3,"button",12),ba("click",function(){return Me(e),Oe(ge().previousMonth())}),q(4," < "),Gt(),Yt(5,"h2",13),q(6),Gt(),Yt(7,"button",12),ba("click",function(){return Me(e),Oe(ge().nextMonth())}),q(8," > "),Gt(),Yt(9,"button",14),ba("click",function(){return Me(e),Oe(ge().goToday())}),q(10," Aujourd'hui "),Gt()(),Yt(11,"div",15)(12,"button",16),ba("click",function(){return Me(e),Oe(ge().openAddEvent())}),q(13," + Nouvel evenement "),Gt()()()(),ot(14,GEe,4,0,"div",17),Yt(15,"div",18)(16,"div",19),On(17,WEe,2,1,"div",20,nl),Gt(),On(19,JEe,3,0,"div",21,hb),Gt(),ot(21,sCe,5,0,"div",22)}if(2&t){const e=ge();Y(6),_r(" ",e.monthLabel," "),Y(8),st(e.calendars.length>1?14:-1),Y(3),Ln(e.weekDays),Y(2),Ln(e.daysInMonth),Y(2),st(e.events.length>0?21:-1)}}let lCe=(()=>{class t{constructor(e,r,i,o){this.googleAuth=e,this.calendarService=r,this.dialog=i,this.snackBar=o,this.isConnected=!1,this.currentDate=new Date,this.viewMode="month",this.events=[],this.calendars=[],this.daysInMonth=[],this.weekDays=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]}ngOnInit(){this.eventsSubscription=this.calendarService.eventsSubject.subscribe(e=>this.events=e.filter(r=>!this.isWeekNumberEvent(r))),this.calendarsSubscription=this.calendarService.calendarsSubject.subscribe(e=>this.calendars=e),this.connectionSubscription=this.googleAuth.connectionChanged.subscribe(e=>{this.isConnected=e,e&&this.loadEvents()}),this.initGoogle(),this.buildCalendarGrid()}initGoogle(){var e=this;return fe(function*(){try{yield e.googleAuth.loadGapi(),yield e.googleAuth.initTokenClient();const r=e.googleAuth.getAccessToken();r&&window.gapi.client.setToken({access_token:r}),e.isConnected=e.googleAuth.isConnected(),e.isConnected&&e.loadEvents()}catch{}})()}connectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&(this.loadEvents(),this.snackBar.open("Google Calendar connecte !","",{duration:3e3}))})}disconnectGoogle(){this.googleAuth.signOut(),this.isConnected=!1,this.events=[],this.snackBar.open("Google Calendar deconnecte","",{duration:3e3})}loadEvents(){const{start:e,end:r}=this.getMonthRange();this.calendarService.getEvents(e,r)}getMonthRange(){const e=this.currentDate.getFullYear(),r=this.currentDate.getMonth();return{start:new Date(e,r,1),end:new Date(e,r+1,0,23,59,59)}}buildCalendarGrid(){const e=this.currentDate.getFullYear(),r=this.currentDate.getMonth(),i=new Date(e,r,1),o=new Date(e,r+1,0);let a=i.getDay()-1;a<0&&(a=6);const c=[];for(let f=0;f<a;f++)c.push(null);for(let f=1;f<=o.getDate();f++)c.push(new Date(e,r,f));for(;c.length%7!=0;)c.push(null);this.daysInMonth=[];for(let f=0;f<c.length;f+=7)this.daysInMonth.push(c.slice(f,f+7))}isWeekNumberEvent(e){const r=e.title.trim();return/^(S|W|Wk|Semaine|Week)\s?\d{1,2}$/.test(r)||(e.calendarId?.includes("#weeknum")??!1)}getEventsForDay(e){if(!e)return[];const r=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;return this.events.filter(i=>{let o;if(i.allDay)o=i.startDate.substring(0,10);else{const a=new Date(i.startDate);o=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`}return o===r&&!this.isWeekNumberEvent(i)})}getWeekNumber(e){if(!e)return 0;const r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));const i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}isMonday(e){return!!e&&1===e.getDay()}isToday(e){if(!e)return!1;const r=new Date;return e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear()}previousMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}goToday(){this.currentDate=new Date,this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}get monthLabel(){return this.currentDate.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}openAddEvent(e){this.dialog.open(OEe,{data:{date:e||new Date,calendars:this.calendars},width:"400px"}).afterClosed().subscribe(i=>{i&&this.calendarService.createEvent(i).then(o=>{o&&(this.loadEvents(),this.snackBar.open("Evenement cree !","",{duration:3e3}))})})}viewEvent(e){this.dialog.open(jEe,{data:{event:e},width:"400px"})}canDelete(e){const r=this.googleAuth.getGoogleEmail();return!!r&&e.creatorName===r}deleteEvent(e){this.calendarService.deleteEvent(e.id,e.calendarId||"primary").then(()=>{this.loadEvents(),this.snackBar.open("Evenement supprime","",{duration:3e3})})}ngOnDestroy(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.calendarsSubscription&&this.calendarsSubscription.unsubscribe(),this.connectionSubscription&&this.connectionSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Ne(fT),Ne(HEe),Ne(hg),Ne(xp))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-calendar"]],decls:8,vars:2,consts:[[1,"max-w-4xl","mx-auto"],[1,"card-fun","bg-gradient-to-r","from-family-sky","via-family-purple","to-family-pink","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"card-fun","p-8","text-center"],[1,"text-5xl","mb-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-2"],[1,"text-gray-500","mb-6"],[1,"btn-gradient","px-6","py-3","text-lg",3,"click"],[1,"card-fun","p-4","mb-4"],[1,"flex","items-center","justify-between","flex-wrap","gap-3"],[1,"flex","items-center","gap-2"],[1,"p-2","rounded-xl","hover:bg-warm-50","transition-colors","text-gray-600",3,"click"],[1,"font-display","font-bold","text-gray-700","text-lg","capitalize","min-w-[180px]","text-center"],[1,"ml-2","px-3","py-1","rounded-xl","border","border-gray-200","text-sm","text-gray-600","hover:bg-warm-50","transition-colors",3,"click"],[1,"flex","gap-2"],[1,"btn-gradient","px-4","py-2","text-sm",3,"click"],[1,"card-fun","p-3","mb-4"],[1,"card-fun","p-4"],[1,"grid","grid-cols-7","gap-1","mb-2"],[1,"text-center","text-xs","font-semibold","text-gray-500","py-2"],[1,"grid","grid-cols-7","gap-1","mb-1"],[1,"card-fun","p-4","mt-4"],[1,"flex","flex-wrap","gap-3"],[1,"flex","items-center","gap-1.5"],[1,"w-3","h-3","rounded-full"],[1,"text-xs","text-gray-600","font-medium"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"bg-gradient-to-br","from-family-pink/10","to-family-orange/10","border-family-pink","border-gray-100"],[1,"min-h-20","p-1","rounded-xl","bg-gray-50/50"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"click"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold"],[1,"text-[9px]","text-gray-300","font-medium"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"background-color","title"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"click","title"],[1,"font-display","font-bold","text-gray-700","mb-3"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-2","h-2","rounded-full"],[1,"font-medium","text-gray-700","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors"],[1,"font-medium"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors",3,"click"]],template:function(r,i){1&r&&(Yt(0,"div",0)(1,"div",1)(2,"h1",2),q(3,"Calendrier"),Gt(),Yt(4,"p",3),q(5,"Vos evenements Google Calendar"),Gt()(),ot(6,$Ee,9,0,"div",4),ot(7,aCe,22,3),Gt()),2&r&&(Y(6),st(i.isConnected?-1:6),Y(),st(i.isConnected?7:-1))},dependencies:[Ic,BE],encapsulation:2})}}return t})(),cCe=(()=>{class t{constructor(e){this.googleAuth=e,this.files=[],this.filesSubject=new ee,this.breadcrumb=[],this.breadcrumbSubject=new ee,this.rootFolderId=null,this.currentFolderId=null}ensureToken(){const e=this.googleAuth.getAccessToken();e&&gapi.client.setToken({access_token:e})}ensureRootFolder(){var e=this;return fe(function*(){if(e.rootFolderId)return e.rootFolderId;if(!e.googleAuth.isConnected())throw new Error("Not connected");const r=af.googleCalendar.familyDriveFolderId;if(r)return e.rootFolderId=r,e.rootFolderId;yield e.googleAuth.loadGapi(),e.ensureToken();const o=(yield gapi.client.drive.files.list({q:"name='FamilyApp' and mimeType='application/vnd.google-apps.folder' and trashed=false",fields:"files(id,name)",spaces:"drive"})).result.files||[];if(o.length>0)return e.rootFolderId=o[0].id,e.rootFolderId;const a=yield gapi.client.drive.files.create({resource:{name:"FamilyApp",mimeType:"application/vnd.google-apps.folder"},fields:"id"});return e.rootFolderId=a.result.id,e.rootFolderId})()}listFiles(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return[];try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),o=e||i;r.currentFolderId=o;const a=yield gapi.client.drive.files.list({q:`'${o}' in parents and trashed=false`,fields:"files(id,name,mimeType,webViewLink,iconLink,thumbnailLink,createdTime,properties)",orderBy:"folder,name",pageSize:100,includeItemsFromAllDrives:!0,supportsAllDrives:!0,corpora:"allDrives"});return r.files=(a.result.files||[]).map(c=>({id:c.id,name:c.name,mimeType:c.mimeType,webViewLink:c.webViewLink||"",iconLink:c.iconLink||"",thumbnailLink:c.thumbnailLink||"",createdTime:c.createdTime||"",isFolder:"application/vnd.google-apps.folder"===c.mimeType,uploadedBy:c.properties?.uploadedBy||"",uploadedByName:c.properties?.uploadedByName||""})),r.filesSubject.next(r.files),r.files}catch{return[]}})()}navigateToFolder(e,r){var i=this;return fe(function*(){i.breadcrumb.push({id:e,name:r}),i.breadcrumbSubject.next(i.breadcrumb),yield i.listFiles(e)})()}navigateToBreadcrumb(e){var r=this;return fe(function*(){if(e<0)r.breadcrumb=[],r.breadcrumbSubject.next(r.breadcrumb),yield r.listFiles();else{const i=r.breadcrumb[e];r.breadcrumb=r.breadcrumb.slice(0,e+1),r.breadcrumbSubject.next(r.breadcrumb),yield r.listFiles(i.id)}})()}navigateUp(){var e=this;return fe(function*(){if(0===e.breadcrumb.length)return;e.breadcrumb.pop(),e.breadcrumbSubject.next(e.breadcrumb);const r=e.breadcrumb.length>0?e.breadcrumb[e.breadcrumb.length-1].id:void 0;yield e.listFiles(r)})()}createFolder(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),o=r.currentFolderId||i,a=pi.currentUser,c=yield gapi.client.drive.files.create({resource:{name:e,mimeType:"application/vnd.google-apps.folder",parents:[o],properties:{uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}},fields:"id,name,mimeType,createdTime"});return{id:c.result.id,name:c.result.name,mimeType:c.result.mimeType,webViewLink:"",iconLink:"",createdTime:c.result.createdTime||"",isFolder:!0,uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}}catch{return null}})()}renameFile(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return!1;try{return yield i.googleAuth.loadGapi(),i.ensureToken(),yield gapi.client.drive.files.update({fileId:e,resource:{name:r}}),!0}catch{return!1}})()}uploadFile(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),a=pi.currentUser,c={name:e.name,parents:[r.currentFolderId||i],properties:{uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}},f=r.googleAuth.getAccessToken(),_=new FormData;_.append("metadata",new Blob([JSON.stringify(c)],{type:"application/json"})),_.append("file",e);const C=yield(yield fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,mimeType,webViewLink,iconLink,thumbnailLink,createdTime,properties",{method:"POST",headers:{Authorization:`Bearer ${f}`},body:_})).json();return{id:C.id,name:C.name,mimeType:C.mimeType,webViewLink:C.webViewLink||"",iconLink:C.iconLink||"",thumbnailLink:C.thumbnailLink||"",createdTime:C.createdTime||"",isFolder:!1,uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}}catch{return null}})()}deleteFile(e){var r=this;return fe(function*(){if(r.googleAuth.isConnected())try{yield r.googleAuth.loadGapi(),r.ensureToken(),yield gapi.client.drive.files.delete({fileId:e,supportsAllDrives:!0})}catch{}})()}moveFile(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return!1;try{yield i.googleAuth.loadGapi(),i.ensureToken();const a=(yield gapi.client.drive.files.get({fileId:e,fields:"parents"})).result.parents?.join(",")||"";return yield gapi.client.drive.files.update({fileId:e,addParents:r,removeParents:a,fields:"id, parents"}),!0}catch{return!1}})()}static{this.\u0275fac=function(r){return new(r||t)(Tt(fT))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const gO=(t,n)=>n.id;function uCe(t,n){if(1&t){const e=Ut();O(0,"div",3)(1,"div",5),q(2,"\u{1f4c1}"),V(),O(3,"h2",6),q(4,"Google Drive"),V(),O(5,"p",7),q(6,"Connecte ton compte Google pour partager des documents avec la famille"),V(),O(7,"button",8),Pe("click",function(){return Me(e),Oe(ge().connectGoogle())}),q(8,"Connecter Google Drive"),V()()}}function dCe(t,n){if(1&t){const e=Ut();O(0,"span",21),q(1,"/"),V(),O(2,"button",22),Pe("click",function(){const i=Me(e).$index;return Oe(ge(2).goToBreadcrumb(i))}),q(3),V()}if(2&t){const e=n.$implicit,r=n.$index,i=ge(2);Y(2),js("text-family-purple",r===i.breadcrumb.length-1)("text-gray-500",r!==i.breadcrumb.length-1),Y(),_r(" \u{1f4c1} ",e.name," ")}}function hCe(t,n){if(1&t){const e=Ut();O(0,"button",13),Pe("click",function(){return Me(e),Oe(ge(2).goUp())}),xn(),O(1,"svg",14),ut(2,"path",23),V(),q(3," Retour "),V()}}function fCe(t,n){1&t&&(O(0,"div",19),ut(1,"div",24),q(2," Upload en cours... "),V())}function pCe(t,n){1&t&&(O(0,"div",20),ut(1,"div",25),q(2," Chargement... "),V())}function mCe(t,n){if(1&t){const e=Ut();O(0,"div",31),Pe("dragover",function(i){const o=Me(e).$implicit;return Oe(ge(4).onDragOver(i,o))})("dragleave",function(){const i=Me(e).$implicit;return Oe(ge(4).onDragLeave(i))})("drop",function(i){const o=Me(e).$implicit;return Oe(ge(4).onDrop(i,o))}),O(1,"div",32),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(4).openFolder(i))}),O(2,"span",33),q(3,"\u{1f4c1}"),V(),O(4,"span",34),q(5),V()(),O(6,"div",35)(7,"button",36),Pe("click",function(i){const o=Me(e).$implicit;return ge(4).openRenameModal(o),Oe(i.stopPropagation())}),xn(),O(8,"svg",14),ut(9,"path",37),V()(),Ri(),O(10,"button",38),Pe("click",function(i){const o=Me(e).$implicit;return ge(4).openDeleteModal(o),Oe(i.stopPropagation())}),xn(),O(11,"svg",14),ut(12,"path",39),V()()()()}if(2&t){const e=n.$implicit,r=ge(4);js("ring-2",r.dragOverFolder===e.id)("ring-family-purple",r.dragOverFolder===e.id)("bg-family-purple/5",r.dragOverFolder===e.id),Y(5),xt(e.name)}}function gCe(t,n){if(1&t&&(O(0,"div",26)(1,"h3",28),q(2,"Dossiers"),V(),O(3,"div",29),On(4,mCe,13,7,"div",30,gO),V()()),2&t){const e=ge(3);Y(4),Ln(e.folders)}}function _Ce(t,n){if(1&t&&(O(0,"span"),q(1),V()),2&t){const e=ge().$implicit;Y(),_r("",e.uploadedByName," \xb7 ")}}function yCe(t,n){if(1&t){const e=Ut();O(0,"div",42),Pe("dragstart",function(i){const o=Me(e).$implicit;return Oe(ge(4).onDragStart(i,o))})("dragend",function(){return Me(e),Oe(ge(4).onDragEnd())}),O(1,"span",43),q(2),V(),O(3,"div",44),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(4).openFile(i))}),O(4,"p",45),q(5),V(),O(6,"p",46),ot(7,_Ce,2,1,"span"),q(8),J_(9,"date"),V()(),O(10,"div",47)(11,"button",36),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(4).openRenameModal(i))}),xn(),O(12,"svg",14),ut(13,"path",37),V()(),Ri(),O(14,"button",38),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(4).openDeleteModal(i))}),xn(),O(15,"svg",14),ut(16,"path",39),V()()()()}if(2&t){const e=n.$implicit,r=ge(4);js("opacity-50",(null==r.draggedFile?null:r.draggedFile.id)===e.id),Y(2),xt(r.getFileIcon(e.mimeType)),Y(3),xt(e.name),Y(2),st(e.uploadedByName?7:-1),Y(),_r(" ",ey(9,6,e.createdTime,"d MMM yyyy","","fr")," ")}}function vCe(t,n){if(1&t&&(O(0,"div",26)(1,"h3",28),q(2,"Fichiers"),V(),O(3,"div",40),On(4,yCe,17,11,"div",41,gO),V()()),2&t){const e=ge(3);Y(4),Ln(e.documents)}}function bCe(t,n){if(1&t){const e=Ut();O(0,"div",27)(1,"div",48),q(2,"\u{1f4ed}"),V(),O(3,"p",49),q(4,"Dossier vide"),V(),O(5,"p",50),q(6,"Ajoute un fichier ou cr\xe9e un dossier !"),V(),O(7,"button",51),Pe("click",function(){return Me(e),Oe(ge(3).reconnectGoogle())}),q(8," Probl\xe8me d'acc\xe8s ? Reconnecter Google Drive "),V()()}}function wCe(t,n){if(1&t&&(ot(0,gCe,6,0,"div",26),ot(1,vCe,6,0,"div",26),ot(2,bCe,9,0,"div",27)),2&t){const e=ge(2);st(e.folders.length>0?0:-1),Y(),st(e.documents.length>0?1:-1),Y(),st(0===e.folders.length&&0===e.documents.length?2:-1)}}function xCe(t,n){if(1&t){const e=Ut();O(0,"div",9)(1,"button",10),Pe("click",function(){return Me(e),Oe(ge().goToRoot())}),q(2," \u{1f3e0} FamilyApp "),V(),On(3,dCe,4,5,null,null,gO),V(),O(5,"div",11),ot(6,hCe,4,0,"button",12),O(7,"button",13),Pe("click",function(){return Me(e),Oe(ge().openNewFolderModal())}),xn(),O(8,"svg",14),ut(9,"path",15),V(),q(10," Nouveau dossier "),V(),Ri(),O(11,"label",16),xn(),O(12,"svg",14),ut(13,"path",17),V(),q(14," Ajouter fichier "),Ri(),O(15,"input",18),Pe("change",function(i){return Me(e),Oe(ge().onFileSelected(i))}),V()()(),ot(16,fCe,3,0,"div",19),ot(17,pCe,3,0,"div",20),ot(18,wCe,3,3)}if(2&t){const e=ge();Y(),js("text-family-purple",0===e.breadcrumb.length)("text-gray-500",e.breadcrumb.length>0),Y(2),Ln(e.breadcrumb),Y(3),st(e.breadcrumb.length>0?6:-1),Y(10),st(e.uploading?16:-1),Y(),st(e.loading?17:-1),Y(),st(e.loading?-1:18)}}function ECe(t,n){if(1&t){const e=Ut();O(0,"div",52),Pe("click",function(){return Me(e),Oe(ge().closeNewFolderModal())}),O(1,"div",53),Pe("click",function(i){return Me(e),Oe(i.stopPropagation())}),O(2,"h3",54),q(3,"Nouveau dossier"),V(),O(4,"input",55),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.newFolderName,i)||(o.newFolderName=i),Oe(i)}),Pe("keydown.enter",function(){return Me(e),Oe(ge().createFolder())}),V(),O(5,"div",56)(6,"button",57),Pe("click",function(){return Me(e),Oe(ge().closeNewFolderModal())}),q(7," Annuler "),V(),O(8,"button",58),Pe("click",function(){return Me(e),Oe(ge().createFolder())}),q(9," Cr\xe9er "),V()()()()}if(2&t){const e=ge();Y(4),mo("ngModel",e.newFolderName),Y(4),pn("disabled",!e.newFolderName.trim())}}function CCe(t,n){if(1&t){const e=Ut();O(0,"div",52),Pe("click",function(){return Me(e),Oe(ge().closeRenameModal())}),O(1,"div",53),Pe("click",function(i){return Me(e),Oe(i.stopPropagation())}),O(2,"h3",54),q(3,"Renommer"),V(),O(4,"input",59),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.renameName,i)||(o.renameName=i),Oe(i)}),Pe("keydown.enter",function(){return Me(e),Oe(ge().confirmRename())}),V(),O(5,"div",56)(6,"button",57),Pe("click",function(){return Me(e),Oe(ge().closeRenameModal())}),q(7," Annuler "),V(),O(8,"button",58),Pe("click",function(){return Me(e),Oe(ge().confirmRename())}),q(9," Renommer "),V()()()()}if(2&t){const e=ge();Y(4),mo("ngModel",e.renameName),Y(4),pn("disabled",!e.renameName.trim())}}function DCe(t,n){1&t&&q(0," Le dossier et tout son contenu seront supprim\xe9s. ")}function TCe(t,n){1&t&&q(0," Ce fichier sera supprim\xe9 d\xe9finitivement. ")}function SCe(t,n){if(1&t){const e=Ut();O(0,"div",52),Pe("click",function(){return Me(e),Oe(ge().closeDeleteModal())}),O(1,"div",53),Pe("click",function(i){return Me(e),Oe(i.stopPropagation())}),O(2,"div",60)(3,"div",61),xn(),O(4,"svg",62),ut(5,"path",39),V()(),Ri(),O(6,"h3",63),q(7,"Supprimer ?"),V(),O(8,"p",64),ot(9,DCe,1,0)(10,TCe,1,0),V(),O(11,"div",56)(12,"button",57),Pe("click",function(){return Me(e),Oe(ge().closeDeleteModal())}),q(13," Annuler "),V(),O(14,"button",65),Pe("click",function(){return Me(e),Oe(ge().confirmDelete())}),q(15," Supprimer "),V()()()()()}if(2&t){const e=ge();Y(9),st(null!=e.deleteTarget&&e.deleteTarget.isFolder?9:10)}}V4(dj);let ICe=(()=>{class t{constructor(e,r,i){this.googleAuth=e,this.driveService=r,this.snackBar=i,this.isConnected=!1,this.files=[],this.breadcrumb=[],this.loading=!1,this.uploading=!1,this.showNewFolderModal=!1,this.newFolderName="",this.showRenameModal=!1,this.renameTarget=null,this.renameName="",this.showDeleteModal=!1,this.deleteTarget=null,this.draggedFile=null,this.dragOverFolder=null}ngOnInit(){this.filesSub=this.driveService.filesSubject.subscribe(e=>this.files=e),this.breadcrumbSub=this.driveService.breadcrumbSubject.subscribe(e=>this.breadcrumb=e),this.connSub=this.googleAuth.connectionChanged.subscribe(e=>{this.isConnected=e,e&&this.loadFiles()}),this.isConnected=this.googleAuth.isConnected(),this.isConnected&&this.loadFiles()}loadFiles(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.listFiles(),e.loading=!1})()}get folders(){return this.files.filter(e=>e.isFolder)}get documents(){return this.files.filter(e=>!e.isFolder)}connectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&this.loadFiles()})}reconnectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&this.loadFiles()})}openFolder(e){var r=this;return fe(function*(){r.loading=!0,yield r.driveService.navigateToFolder(e.id,e.name),r.loading=!1})()}goToRoot(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.navigateToBreadcrumb(-1),e.loading=!1})()}goToBreadcrumb(e){var r=this;return fe(function*(){r.loading=!0,yield r.driveService.navigateToBreadcrumb(e),r.loading=!1})()}goUp(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.navigateUp(),e.loading=!1})()}openNewFolderModal(){this.newFolderName="",this.showNewFolderModal=!0}closeNewFolderModal(){this.showNewFolderModal=!1,this.newFolderName=""}createFolder(){var e=this;return fe(function*(){if(!e.newFolderName.trim())return;const r=yield e.driveService.createFolder(e.newFolderName.trim());e.closeNewFolderModal(),r&&(yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Dossier cr\xe9\xe9 !","",{duration:3e3}))})()}openRenameModal(e){this.renameTarget=e,this.renameName=e.name,this.showRenameModal=!0}closeRenameModal(){this.showRenameModal=!1,this.renameTarget=null,this.renameName=""}confirmRename(){var e=this;return fe(function*(){if(!e.renameTarget||!e.renameName.trim())return;const r=yield e.driveService.renameFile(e.renameTarget.id,e.renameName.trim());e.closeRenameModal(),r&&(yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Renomm\xe9 !","",{duration:3e3}))})()}onDragStart(e,r){this.draggedFile=r,e.dataTransfer&&(e.dataTransfer.effectAllowed="move")}onDragEnd(){this.draggedFile=null,this.dragOverFolder=null}onDragOver(e,r){e.preventDefault(),this.draggedFile&&!this.draggedFile.isFolder&&(this.dragOverFolder=r.id,e.dataTransfer&&(e.dataTransfer.dropEffect="move"))}onDragLeave(e){this.dragOverFolder===e.id&&(this.dragOverFolder=null)}onDrop(e,r){var i=this;return fe(function*(){e.preventDefault(),i.dragOverFolder=null,i.draggedFile&&!i.draggedFile.isFolder&&(yield i.driveService.moveFile(i.draggedFile.id,r.id))&&(yield i.driveService.listFiles(i.driveService.currentFolderId||void 0),i.snackBar.open(`Fichier d\xe9plac\xe9 dans "${r.name}"`,"",{duration:3e3})),i.draggedFile=null})()}openDeleteModal(e){this.deleteTarget=e,this.showDeleteModal=!0}closeDeleteModal(){this.showDeleteModal=!1,this.deleteTarget=null}confirmDelete(){var e=this;return fe(function*(){e.deleteTarget&&(yield e.driveService.deleteFile(e.deleteTarget.id),e.closeDeleteModal(),yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Supprim\xe9","",{duration:3e3}))})()}onFileSelected(e){const r=e.target;r.files?.length&&(this.uploadFile(r.files[0]),r.value="")}uploadFile(e){var r=this;return fe(function*(){r.uploading=!0;const i=yield r.driveService.uploadFile(e);r.uploading=!1,i&&(yield r.driveService.listFiles(r.driveService.currentFolderId||void 0),r.snackBar.open("Document ajout\xe9 !","",{duration:3e3}))})()}openFile(e){window.open(e.webViewLink,"_blank")}getFileIcon(e){return"application/vnd.google-apps.folder"===e?"\u{1f4c1}":e.includes("pdf")?"\u{1f4c4}":e.includes("image")?"\u{1f5bc}\ufe0f":e.includes("spreadsheet")||e.includes("excel")?"\u{1f4ca}":e.includes("document")||e.includes("word")?"\u{1f4dd}":e.includes("presentation")||e.includes("powerpoint")?"\u{1f4fd}\ufe0f":"\u{1f4ce}"}ngOnDestroy(){this.filesSub&&this.filesSub.unsubscribe(),this.breadcrumbSub&&this.breadcrumbSub.unsubscribe(),this.connSub&&this.connSub.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Ne(fT),Ne(cCe),Ne(xp))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-documents"]],decls:9,vars:5,consts:[[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"card-fun","p-8","text-center"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"text-4xl","mb-4"],[1,"font-display","font-bold","text-gray-700","mb-2"],[1,"text-sm","text-gray-500","mb-4"],[1,"btn-gradient","px-6",3,"click"],[1,"flex","items-center","gap-1","text-sm","mb-4","flex-wrap"],[1,"px-2","py-1","rounded","hover:bg-gray-100","transition-colors","font-medium",3,"click"],[1,"flex","gap-2","mb-4"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors","cursor-pointer"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],["type","file",1,"hidden",3,"change"],[1,"card-fun","p-3","mb-4","flex","items-center","gap-2","text-sm","text-gray-500"],[1,"text-center","py-8","text-gray-400"],[1,"text-gray-300"],[1,"px-2","py-1","rounded","hover:bg-gray-100","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"w-4","h-4","border-2","border-family-purple","border-t-transparent","rounded-full","animate-spin"],[1,"w-6","h-6","border-2","border-family-purple","border-t-transparent","rounded-full","animate-spin","mx-auto","mb-2"],[1,"mb-4"],[1,"text-center","py-12","text-gray-400"],[1,"font-display","font-bold","text-xs","text-gray-400","uppercase","tracking-wider","mb-2"],[1,"grid","grid-cols-2","gap-2"],[1,"card-fun","p-3","cursor-pointer","hover:shadow-card-hover","transition-all","group","relative",3,"ring-2","ring-family-purple","bg-family-purple/5"],[1,"card-fun","p-3","cursor-pointer","hover:shadow-card-hover","transition-all","group","relative",3,"dragover","dragleave","drop"],[1,"flex","items-center","gap-2",3,"click"],[1,"text-2xl"],[1,"font-medium","text-gray-700","truncate","flex-1"],[1,"absolute","top-2","right-2","opacity-0","group-hover:opacity-100","transition-opacity","flex","gap-1"],[1,"p-1","text-gray-400","hover:text-family-purple",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"p-1","text-gray-400","hover:text-red-400",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],["draggable","true",1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors","group","cursor-grab","active:cursor-grabbing",3,"opacity-50"],["draggable","true",1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors","group","cursor-grab","active:cursor-grabbing",3,"dragstart","dragend"],[1,"text-xl","flex-shrink-0"],[1,"flex-1","min-w-0","cursor-pointer",3,"click"],[1,"font-medium","text-gray-700","truncate","hover:text-family-purple","transition-colors"],[1,"text-xs","text-gray-400","truncate"],[1,"opacity-0","group-hover:opacity-100","transition-opacity","flex","gap-1"],[1,"text-4xl","mb-3"],[1,"font-medium"],[1,"text-sm","mb-4"],[1,"text-sm","text-family-purple","hover:underline",3,"click"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full","p-6",3,"click"],[1,"text-lg","font-bold","text-gray-800","mb-4"],["placeholder","Nom du dossier","autofocus","",1,"input-fun","w-full","mb-4",3,"ngModelChange","keydown.enter","ngModel"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-family-purple","text-white","font-medium","hover:bg-family-purple/90","disabled:opacity-40","transition-colors",3,"click","disabled"],["placeholder","Nouveau nom","autofocus","",1,"input-fun","w-full","mb-4",3,"ngModelChange","keydown.enter","ngModel"],[1,"text-center"],[1,"w-14","h-14","mx-auto","mb-4","rounded-full","bg-red-100","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-red-500"],[1,"text-lg","font-bold","text-gray-800","mb-2"],[1,"text-sm","text-gray-500","mb-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"div",1)(2,"h1",2),q(3,"\u{1f5c2}\ufe0f Documents famille"),V()(),ot(4,uCe,9,0,"div",3),ot(5,xCe,19,8),V(),ot(6,ECe,10,2,"div",4),ot(7,CCe,10,2,"div",4),ot(8,SCe,16,1,"div",4)),2&r&&(Y(4),st(i.isConnected?-1:4),Y(),st(i.isConnected?5:-1),Y(),st(i.showNewFolderModal?6:-1),Y(),st(i.showRenameModal?7:-1),Y(),st(i.showDeleteModal?8:-1))},dependencies:[Ic,Xy,zl,Iu,Vp,BE],styles:["select.input-fun[_ngcontent-%COMP%]{appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}"]})}}return t})();const kCe=(t,n)=>n.name;function ACe(t,n){if(1&t){const e=Ut();O(0,"button",16),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).selectDestination(i))}),q(1),V()}if(2&t){const e=n.$implicit;Y(),_r(" ",e.name," ")}}function MCe(t,n){if(1&t&&(O(0,"div",8),On(1,ACe,2,1,"button",15,kCe),V()),2&t){const e=ge();Y(),Ln(e.geoResults)}}let RCe=(()=>{class t{constructor(e){this.dialogRef=e,this.title="",this.destinationQuery="",this.destination="",this.startDate="",this.endDate="",this.description="",this.geoResults=[]}get canSave(){return!!(this.title.trim()&&this.destination&&this.startDate&&this.endDate)}searchDestination(){var e=this;clearTimeout(this.searchTimeout),this.destinationQuery.length<3?this.geoResults=[]:this.searchTimeout=setTimeout(fe(function*(){try{const i=yield(yield fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(e.destinationQuery)}&format=json&limit=5`)).json();e.geoResults=i.map(o=>({name:o.display_name,lat:parseFloat(o.lat),lng:parseFloat(o.lon)}))}catch{e.geoResults=[]}}),400)}selectDestination(e){this.destination=e.name,this.destinationQuery=e.name,this.lat=e.lat,this.lng=e.lng,this.geoResults=[]}save(){if(!this.canSave)return;const e=pi.currentUser,r={title:this.title.trim(),destination:this.destination,lat:this.lat,lng:this.lng,startDate:this.startDate,endDate:this.endDate,description:this.description.trim()||void 0,createdBy:e?.uid||"",createdByName:e?.displayName||"",status:"planning"};this.dialogRef.close(r)}static{this.\u0275fac=function(r){return new(r||t)(Ne(dg))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-add-vacation-dialog"]],decls:34,vars:7,consts:[[1,"p-6"],[1,"font-display","text-xl","font-bold","mb-4"],[1,"text-gradient"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-600","mb-1"],["placeholder","Ex: Vacances a Barcelone",1,"input-fun","w-full","text-sm",3,"ngModelChange","ngModel"],[1,"relative"],["placeholder","Rechercher un lieu...",1,"input-fun","w-full","text-sm",3,"ngModelChange","input","ngModel"],[1,"absolute","z-10","mt-1","w-full","bg-white","rounded-xl","shadow-lg","border","border-gray-100","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-2","gap-3"],["type","date",1,"input-fun","w-full","text-sm",3,"ngModelChange","ngModel"],["rows","2","placeholder","Notes, idees...",1,"input-fun","w-full","text-sm","resize-none",3,"ngModelChange","ngModel"],[1,"flex","gap-3","mt-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","text-sm","font-medium",3,"click"],[1,"flex-1","btn-gradient","text-sm","disabled:opacity-50",3,"click","disabled"],[1,"w-full","text-left","px-4","py-2","text-sm","hover:bg-gray-50","transition-colors","truncate"],[1,"w-full","text-left","px-4","py-2","text-sm","hover:bg-gray-50","transition-colors","truncate",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0)(1,"h2",1)(2,"span"),q(3,"\u{1f3d6}\ufe0f"),V(),O(4,"span",2),q(5,"Nouveau voyage"),V()(),O(6,"div",3)(7,"div")(8,"label",4),q(9,"Titre"),V(),O(10,"input",5),go("ngModelChange",function(a){return Ro(i.title,a)||(i.title=a),a}),V()(),O(11,"div",6)(12,"label",4),q(13,"Destination"),V(),O(14,"input",7),go("ngModelChange",function(a){return Ro(i.destinationQuery,a)||(i.destinationQuery=a),a}),Pe("input",function(){return i.searchDestination()}),V(),ot(15,MCe,3,0,"div",8),V(),O(16,"div",9)(17,"div")(18,"label",4),q(19,"Debut"),V(),O(20,"input",10),go("ngModelChange",function(a){return Ro(i.startDate,a)||(i.startDate=a),a}),V()(),O(21,"div")(22,"label",4),q(23,"Fin"),V(),O(24,"input",10),go("ngModelChange",function(a){return Ro(i.endDate,a)||(i.endDate=a),a}),V()()(),O(25,"div")(26,"label",4),q(27,"Description (optionnel)"),V(),O(28,"textarea",11),go("ngModelChange",function(a){return Ro(i.description,a)||(i.description=a),a}),V()()(),O(29,"div",12)(30,"button",13),Pe("click",function(){return i.dialogRef.close()}),q(31," Annuler "),V(),O(32,"button",14),Pe("click",function(){return i.save()}),q(33," Creer "),V()()()),2&r&&(Y(10),mo("ngModel",i.title),Y(4),mo("ngModel",i.destinationQuery),Y(),st(i.geoResults.length?15:-1),Y(5),mo("ngModel",i.startDate),Y(4),mo("ngModel",i.endDate),Y(4),mo("ngModel",i.description),Y(4),pn("disabled",!i.canSave))},dependencies:[Ic,Xy,zl,Iu,Vp,_6],encapsulation:2})}}return t})();const PCe=["detailMap"],Rw=(t,n)=>n.id;function NCe(t,n){if(1&t){const e=Ut();O(0,"div",14),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).selectVacation(i))}),O(1,"div",15)(2,"span",16),q(3,"En cours"),V(),O(4,"span",17),q(5,"\u2708\ufe0f"),V()(),O(6,"h3",18),q(7),V(),O(8,"p",19),q(9),V(),O(10,"p",20),q(11),V()()}if(2&t){const e=n.$implicit,r=ge(2);Y(7),xt(e.title),Y(2),bs("",e.destination," \xb7 ",r.durationDays(e)," jours"),Y(2),bs("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate))}}function OCe(t,n){1&t&&(O(0,"h2",10),q(1,"A venir"),V())}function LCe(t,n){if(1&t){const e=Ut();O(0,"div",21),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).selectVacation(i))}),O(1,"div",22)(2,"div")(3,"h3",18),q(4),V(),O(5,"p",19),q(6),V(),O(7,"p",20),q(8),V()(),O(9,"div",23)(10,"div",24),q(11),V(),O(12,"div",25),q(13,"jours"),V()()()()}if(2&t){const e=n.$implicit,r=ge(2);Y(4),xt(e.title),Y(2),xt(e.destination),Y(2),bs("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate)),Y(3),xt(r.daysUntil(e.startDate))}}function FCe(t,n){1&t&&(O(0,"h2",10),q(1,"Souvenirs"),V())}function BCe(t,n){if(1&t){const e=Ut();O(0,"div",26),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).selectVacation(i))}),O(1,"h3",18),q(2),V(),O(3,"p",19),q(4),V(),O(5,"p",20),q(6),V()()}if(2&t){const e=n.$implicit,r=ge(2);Y(2),xt(e.title),Y(2),bs("",e.destination," \xb7 ",r.durationDays(e)," jours"),Y(2),bs("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate))}}function VCe(t,n){1&t&&(O(0,"div",13)(1,"div",27),q(2,"\u{1f334}"),V(),O(3,"p",8),q(4,"Aucune vacance planifiee"),V(),O(5,"p",28),q(6,"Planifie ton prochain voyage !"),V()())}function UCe(t,n){if(1&t){const e=Ut();O(0,"div",1)(1,"div",2)(2,"h1",3)(3,"span"),q(4,"\u{1f3d6}\ufe0f"),V(),O(5,"span",4),q(6,"Vacances"),V()()(),O(7,"button",5),Pe("click",function(){return Me(e),Oe(ge().openAdd())}),xn(),O(8,"svg",6),ut(9,"path",7),V(),Ri(),O(10,"span",8),q(11,"Planifier des vacances"),V()(),On(12,NCe,12,5,"div",9,Rw),ot(14,OCe,2,0,"h2",10),On(15,LCe,14,5,"div",11,Rw),ot(17,FCe,2,0,"h2",10),On(18,BCe,7,5,"div",12,Rw),ot(20,VCe,7,0,"div",13),V()}if(2&t){const e=ge();Y(12),Ln(e.ongoing()),Y(2),st(e.upcoming().length?14:-1),Y(),Ln(e.upcoming()),Y(2),st(e.past().length?17:-1),Y(),Ln(e.past()),Y(2),st(e.vacations().length?-1:20)}}function zCe(t,n){if(1&t&&(O(0,"div",35)(1,"div",42),q(2),V(),O(3,"div",43),q(4,"jours"),V()()),2&t){const e=ge(2);Y(2),xt(e.daysUntil(e.selectedVacation.startDate))}}function jCe(t,n){if(1&t&&(O(0,"p",36),q(1),V()),2&t){const e=ge(2);Y(),xt(e.selectedVacation.description)}}function HCe(t,n){if(1&t&&(O(0,"div",44)(1,"div",51)(2,"span"),q(3),V(),O(4,"span"),q(5),V()(),O(6,"div",52),ut(7,"div",53),V()()),2&t){const e=ge(3);Y(3),_r("",e.checklistProgress,"% complete"),Y(2),_r("",e.checklist.length," elements"),Y(2),Wm("width",e.checklistProgress,"%")}}function $Ce(t,n){if(1&t){const e=Ut();O(0,"div",49)(1,"input",54),Pe("change",function(){const i=Me(e).$implicit;return Oe(ge(3).toggleItem(i))}),V(),O(2,"span"),q(3),V(),O(4,"button",55),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).deleteItem(i))}),xn(),O(5,"svg",30),ut(6,"path",56),V()()()}if(2&t){const e=n.$implicit;Y(),pn("checked",e.checked),Y(),is(e.checked?"flex-1 text-sm text-gray-400 line-through":"flex-1 text-sm text-gray-700"),Y(),_r(" ",e.text," ")}}function qCe(t,n){1&t&&(O(0,"div",50)(1,"div",57),q(2,"\u{1f4dd}"),V(),q(3," Ajoute des elements a ta checklist "),V())}function GCe(t,n){if(1&t){const e=Ut();ot(0,HCe,8,4,"div",44),O(1,"div",45)(2,"input",46),go("ngModelChange",function(i){Me(e);const o=ge(2);return Ro(o.newItemText,i)||(o.newItemText=i),Oe(i)}),Pe("keyup.enter",function(){return Me(e),Oe(ge(2).addItem())}),V(),O(3,"button",47),Pe("click",function(){return Me(e),Oe(ge(2).addItem())}),q(4,"+"),V()(),O(5,"div",48),On(6,$Ce,7,4,"div",49,Rw),V(),ot(8,qCe,4,0,"div",50)}if(2&t){const e=ge(2);st(e.checklist.length?0:-1),Y(2),mo("ngModel",e.newItemText),Y(4),Ln(e.checklist),Y(2),st(e.checklist.length?-1:8)}}function WCe(t,n){1&t&&(O(0,"div",60),ut(1,"div",64),q(2," Upload en cours... "),V())}function ZCe(t,n){1&t&&(O(0,"div",61),q(1,"\u{1f4f7} Ajouter une photo"),V())}function KCe(t,n){if(1&t){const e=Ut();O(0,"div",63),ut(1,"img",65),O(2,"div",66)(3,"p",67),q(4),V()(),O(5,"button",68),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).deletePhoto(i))}),xn(),O(6,"svg",69),ut(7,"path",56),V()()()}if(2&t){const e=n.$implicit;Y(),pn("src",e.url,vs),Y(3),xt(e.addedByName)}}function YCe(t,n){1&t&&(O(0,"div",50)(1,"div",57),q(2,"\u{1f4f8}"),V(),q(3," Ajoute des photos de tes vacances "),V())}function XCe(t,n){if(1&t){const e=Ut();O(0,"label",58)(1,"input",59),Pe("change",function(i){return Me(e),Oe(ge(2).onPhotoSelected(i))}),V(),ot(2,WCe,3,0,"div",60)(3,ZCe,2,0,"div",61),V(),O(4,"div",62),On(5,KCe,8,2,"div",63,Rw),V(),ot(7,YCe,4,0,"div",50)}if(2&t){const e=ge(2);Y(2),st(e.uploading?2:3),Y(3),Ln(e.photos),Y(2),st(e.photos.length||e.uploading?-1:7)}}function QCe(t,n){1&t&&ut(0,"div",39,0)}function JCe(t,n){if(1&t){const e=Ut();O(0,"div",1)(1,"button",29),Pe("click",function(){return Me(e),Oe(ge().backToList())}),xn(),O(2,"svg",30),ut(3,"path",31),V(),q(4," Retour "),V(),Ri(),O(5,"div",32)(6,"div",22)(7,"div")(8,"h1",33),q(9),V(),O(10,"p",34),q(11),V(),O(12,"p",20),q(13),V()(),ot(14,zCe,5,1,"div",35),V(),ot(15,jCe,2,1,"p",36),V(),O(16,"div",37)(17,"button",38),Pe("click",function(){return Me(e),Oe(ge().onTabChange("checklist"))}),q(18," Checklist "),V(),O(19,"button",38),Pe("click",function(){return Me(e),Oe(ge().onTabChange("photos"))}),q(20," Photos "),V(),O(21,"button",38),Pe("click",function(){return Me(e),Oe(ge().onTabChange("map"))}),q(22," Carte "),V()(),ot(23,GCe,9,3),ot(24,XCe,8,2),ot(25,QCe,2,0,"div",39),O(26,"div",40)(27,"button",41),Pe("click",function(){return Me(e),Oe(ge().deleteVacation())}),q(28," Supprimer ce voyage "),V()()()}if(2&t){const e=ge();Y(9),xt(e.selectedVacation.title),Y(2),_r("\u{1f4cd} ",e.selectedVacation.destination),Y(2),Q1("",e.formatDate(e.selectedVacation.startDate)," \u2192 ",e.formatDate(e.selectedVacation.endDate)," \xb7 ",e.durationDays(e.selectedVacation)," jours"),Y(),st(e.daysUntil(e.selectedVacation.startDate)>0?14:-1),Y(),st(e.selectedVacation.description?15:-1),Y(2),is("checklist"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-pink shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),Y(2),is("photos"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-coral shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),Y(2),is("map"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-sky shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),Y(2),st("checklist"===e.activeTab?23:-1),Y(),st("photos"===e.activeTab?24:-1),Y(),st("map"===e.activeTab?25:-1)}}let eDe=(()=>{class t{constructor(e,r){this.vacService=e,this.dialog=r,this.vacations=this.vacService.vacations,this.selectedVacation=null,this.activeTab="checklist",this.checklist=[],this.photos=[],this.newItemText="",this.uploading=!1,this.unsubChecklist=null,this.unsubPhotos=null,this.map=null,this.upcoming=ii(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.startDate>i)}),this.ongoing=ii(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.startDate<=i&&o.endDate>=i)}),this.past=ii(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.endDate<i)})}daysUntil(e){const r=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(r/864e5))}durationDays(e){const r=new Date(e.endDate).getTime()-new Date(e.startDate).getTime();return Math.max(1,Math.ceil(r/864e5))}formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}openAdd(){this.dialog.open(RCe,{width:"95vw",maxWidth:"500px",panelClass:"rounded-dialog"}).afterClosed().subscribe(r=>{r&&this.vacService.addVacation(r)})}selectVacation(e){this.selectedVacation=e,this.activeTab="checklist",this.cleanupDetail(),this.unsubChecklist=this.vacService.listenChecklist(e.id,r=>this.checklist=r),this.unsubPhotos=this.vacService.listenPhotos(e.id,r=>this.photos=r)}backToList(){this.selectedVacation=null,this.cleanupDetail()}cleanupDetail(){this.unsubChecklist?.(),this.unsubPhotos?.(),this.unsubChecklist=null,this.unsubPhotos=null,this.map?.remove(),this.map=null,this.checklist=[],this.photos=[]}addItem(){var e=this;return fe(function*(){!e.newItemText.trim()||!e.selectedVacation||(yield e.vacService.addChecklistItem(e.selectedVacation.id,e.newItemText.trim()),e.newItemText="")})()}toggleItem(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.toggleChecklistItem(r.selectedVacation.id,e.id,!e.checked))})()}deleteItem(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.deleteChecklistItem(r.selectedVacation.id,e.id))})()}get checklistProgress(){return this.checklist.length?Math.round(this.checklist.filter(e=>e.checked).length/this.checklist.length*100):0}onPhotoSelected(e){var r=this;return fe(function*(){const i=e.target;!i.files?.length||!r.selectedVacation||(r.uploading=!0,yield r.vacService.uploadPhoto(r.selectedVacation.id,i.files[0]),r.uploading=!1,i.value="")})()}deletePhoto(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.deletePhoto(r.selectedVacation.id,e))})()}onTabChange(e){this.activeTab=e,"map"===e&&setTimeout(()=>this.initMap(),100)}initMap(){if(!this.mapContainer||!this.selectedVacation)return;this.map?.remove();const e=this.selectedVacation;this.map=new sf.Map({container:this.mapContainer.nativeElement,style:"https://maps.geoapify.com/v1/styles/maptiler-3d/style.json?apiKey=793f93202015411eaa6fceaeadaad99c",center:[e.lng||2.35,e.lat||48.85],zoom:e.lat?10:5}),e.lat&&e.lng&&new sf.Marker({color:"#ec4899"}).setLngLat([e.lng,e.lat]).setPopup((new sf.Popup).setHTML(`<strong>${e.destination}</strong>`)).addTo(this.map);for(const i of this.photos)if(i.lat&&i.lng){const o=document.createElement("div");o.style.cssText="width:30px;height:30px;border-radius:50%;border:2px solid #fff;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.3);cursor:pointer;";const a=document.createElement("img");a.src=i.url,a.style.cssText="width:100%;height:100%;object-fit:cover;",o.appendChild(a),new sf.Marker({element:o}).setLngLat([i.lng,i.lat]).setPopup((new sf.Popup).setHTML(`<img src="${i.url}" style="max-width:150px;border-radius:8px;"/>`)).addTo(this.map)}}deleteVacation(){var e=this;return fe(function*(){e.selectedVacation&&(yield e.vacService.deleteVacation(e.selectedVacation.id),e.backToList())})()}ngOnDestroy(){this.cleanupDetail()}static{this.\u0275fac=function(r){return new(r||t)(Ne(c7),Ne(hg))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-vacances"]],viewQuery:function(r,i){if(1&r&&dp(PCe,5),2&r){let o;gd(o=_d())&&(i.mapContainer=o.first)}},decls:2,vars:2,consts:[["detailMap",""],[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold"],[1,"text-gradient"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-pink","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"font-medium"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","border-l-4","border-green-400"],[1,"font-display","font-bold","text-sm","text-gray-500","mb-2","mt-6"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","opacity-80"],[1,"text-center","py-12","text-gray-400"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","border-l-4","border-green-400",3,"click"],[1,"flex","items-center","gap-2","mb-1"],[1,"bg-green-100","text-green-700","text-xs","font-bold","px-2","py-0.5","rounded-full"],[1,"text-lg"],[1,"font-display","font-bold","text-gray-700"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"flex","justify-between","items-start"],[1,"text-center","flex-shrink-0","ml-4"],[1,"text-2xl","font-display","font-extrabold","text-family-pink"],[1,"text-[10px]","text-gray-400","font-medium"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","opacity-80",3,"click"],[1,"text-4xl","mb-3"],[1,"text-sm"],[1,"flex","items-center","gap-1","text-gray-500","hover:text-gray-700","mb-4","text-sm","font-medium",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"card-fun","p-5","mb-4"],[1,"font-display","text-xl","font-bold","text-gray-700"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-center","flex-shrink-0"],[1,"text-sm","text-gray-600","mt-3"],[1,"flex","gap-1","mb-4","bg-gray-100","rounded-xl","p-1"],[3,"click"],[1,"w-full","h-80","rounded-xl","overflow-hidden","shadow-sm"],[1,"mt-8","mb-8","text-center"],[1,"text-sm","text-red-400","hover:text-red-600","transition-colors",3,"click"],[1,"text-3xl","font-display","font-extrabold","text-family-pink"],[1,"text-[10px]","text-gray-400"],[1,"mb-4"],[1,"flex","gap-2","mb-4"],["placeholder","Ajouter un element...",1,"flex-1","input-fun","text-sm",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-gradient","px-4","text-sm",3,"click"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],[1,"flex","items-center","gap-3","px-4","py-3"],[1,"text-center","py-8","text-gray-400","text-sm"],[1,"flex","justify-between","text-xs","text-gray-500","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"bg-gradient-to-r","from-family-pink","to-family-coral","h-2","rounded-full","transition-all"],["type","checkbox",1,"w-4","h-4","rounded","border-gray-300","text-family-pink","focus:ring-family-pink",3,"change","checked"],[1,"text-gray-300","hover:text-red-400","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"text-2xl","mb-2"],[1,"block","card-fun","p-4","mb-4","text-center","cursor-pointer","hover:shadow-card-hover","transition-shadow"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"flex","items-center","justify-center","gap-2","text-sm","text-gray-500"],[1,"text-gray-500","text-sm","font-medium"],[1,"grid","grid-cols-2","gap-3"],[1,"relative","group"],[1,"w-4","h-4","border-2","border-family-coral","border-t-transparent","rounded-full","animate-spin"],["loading","lazy",1,"w-full","aspect-square","object-cover","rounded-xl","shadow-sm",3,"src"],[1,"absolute","bottom-0","left-0","right-0","bg-gradient-to-t","from-black/50","to-transparent","p-2","rounded-b-xl"],[1,"text-white","text-xs","truncate"],[1,"absolute","top-2","right-2","w-6","h-6","bg-white/80","rounded-full","flex","items-center","justify-center","opacity-100","md:opacity-0","md:group-hover:opacity-100","transition-opacity","text-red-400",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3","h-3"]],template:function(r,i){1&r&&(ot(0,UCe,21,3,"div",1),ot(1,JCe,29,16,"div",1)),2&r&&(st(i.selectedVacation?-1:0),Y(),st(i.selectedVacation?1:-1))},dependencies:[Ic,Xy,zl,Iu,Vp],encapsulation:2})}}return t})(),tDe=(()=>{class t{constructor(){this.messagesRef=Tn(Pn,"/chat/messages")}listenMessages(e){const r=function Jbe(t,...n){let e=Po(t);for(const r of n)e=r._apply(e);return e}(this.messagesRef,function Wbe(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Gbe(t)}(100)),i=pi.currentUser?.uid;return Rd(r,o=>{const a=o.val();if(!a)return void e([]);const c=Object.keys(a).map(f=>{const _={...a[f],id:f};return _._likeCount=_.likes?Object.keys(_.likes).length:0,_._liked=!!i&&!!_.likes?.[i],_.comments?(_._comments=Object.keys(_.comments).map(x=>({..._.comments[x],id:x})).sort((x,C)=>x.timestamp-C.timestamp),_._commentCount=_._comments.length):(_._comments=[],_._commentCount=0),_}).sort((f,_)=>_.timestamp-f.timestamp);e(c)}),()=>LD(r)}sendMessage(e,r){var i=this;return fe(function*(){const o=pi.currentUser;if(!o||!e.trim()&&!r)return;let a;r&&(a=yield i.uploadImage(r));const c=Jh(i.messagesRef);yield Cu(c,{id:c.key,text:e.trim(),uid:o.uid,displayName:o.displayName||"",photoURL:o.photoURL||"",timestamp:Date.now(),...a&&{imageURL:a}})})()}uploadImage(e){var r=this;return fe(function*(){const i=yield r.compressImage(e),o=`${Date.now()}_${Math.random().toString(36).substring(2,11)}.jpg`,a=hw(fw,`feed/${o}`);return SN((yield TN(a,i,{contentType:"image/jpeg"})).ref)})()}compressImage(e,r=1200,i=.7){return new Promise((o,a)=>{const c=new Image,f=new FileReader;f.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let C=c.width,A=c.height;C>r&&(A=Math.round(A*r/C),C=r),x.width=C,x.height=A,x.getContext("2d").drawImage(c,0,0,C,A),x.toBlob(U=>U?o(U):a("Compression failed"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},f.onerror=a,f.readAsDataURL(e)})}toggleLike(e){return fe(function*(){const r=pi.currentUser?.uid;if(!r)return;const i=Tn(Pn,`/chat/messages/${e}/likes/${r}`);(yield tf(i)).val()?yield ef(i):yield Cu(i,!0)})()}addComment(e,r){return fe(function*(){const i=pi.currentUser;if(!i||!r.trim())return;const o=Jh(Tn(Pn,`/chat/messages/${e}/comments`));yield Cu(o,{text:r.trim(),uid:i.uid,displayName:i.displayName||"",photoURL:i.photoURL||"",timestamp:Date.now()})})()}deleteComment(e,r){return fe(function*(){yield ef(Tn(Pn,`/chat/messages/${e}/comments/${r}`))})()}deleteMessage(e){return fe(function*(){if(e.imageURL)try{const r=hw(fw,e.imageURL);yield Nq(r)}catch{console.log("Image not found or already deleted")}yield ef(Tn(Pn,`/chat/messages/${e.id}`))})()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const nDe=["messagesContainer"],rDe=["fileInput"],E7=(t,n)=>n.id;function iDe(t,n){1&t&&(O(0,"div",7)(1,"div",20),q(2,"\u{1f4f1}"),V(),O(3,"p",21),q(4,"Aucune publication"),V(),O(5,"p",22),q(6,"Partage un moment avec ta famille !"),V()())}function oDe(t,n){if(1&t&&(O(0,"div",23),ut(1,"div",40),O(2,"span",41),q(3),V(),ut(4,"div",40),V()),2&t){const e=ge().$implicit,r=ge();Y(3),xt(r.formatDate(e.timestamp))}}function sDe(t,n){1&t&&ut(0,"img",26),2&t&&pn("src",ge().$implicit.photoURL,vs)}function aDe(t,n){if(1&t&&(O(0,"div",27),q(1),V()),2&t){const e=ge().$implicit;Y(),_r(" ",(e.displayName||"?")[0].toUpperCase()," ")}}function lDe(t,n){if(1&t){const e=Ut();O(0,"button",42),Pe("click",function(){Me(e);const i=ge().$implicit;return Oe(ge().openDeleteModal(i))}),xn(),O(1,"svg",17),ut(2,"path",43),V()()}}function cDe(t,n){1&t&&ut(0,"img",32),2&t&&pn("src",ge().$implicit.imageURL,vs)}function uDe(t,n){if(1&t&&(O(0,"div",33)(1,"p",44),q(2),V()()),2&t){const e=ge().$implicit;Y(2),xt(e.text)}}function dDe(t,n){1&t&&ut(0,"img",50),2&t&&pn("src",ge().$implicit.photoURL,vs)}function hDe(t,n){if(1&t&&(O(0,"div",51),q(1),V()),2&t){const e=ge().$implicit;Y(),_r(" ",(e.displayName||"?")[0].toUpperCase()," ")}}function fDe(t,n){if(1&t){const e=Ut();O(0,"button",58),Pe("click",function(){Me(e);const i=ge().$implicit,o=ge(3).$implicit;return Oe(ge().deleteComment(o.id,i.id))}),q(1," Supprimer "),V()}}function pDe(t,n){if(1&t&&(O(0,"div",49),ot(1,dDe,1,1,"img",50)(2,hDe,2,1,"div",51),O(3,"div",28)(4,"div",52)(5,"p",53),q(6),V(),O(7,"p",54),q(8),V()(),O(9,"div",55)(10,"span",56),q(11),V(),ot(12,fDe,2,0,"button",57),V()()()),2&t){const e=n.$implicit,r=ge(4);Y(),st(e.photoURL?1:2),Y(5),xt(e.displayName||"Anonyme"),Y(2),xt(e.text),Y(3),xt(r.formatTime(e.timestamp)),Y(),st(e.uid===r.currentUid?12:-1)}}function mDe(t,n){if(1&t&&(O(0,"div",45),On(1,pDe,13,5,"div",49,E7),V()),2&t){const e=ge(2).$implicit;Y(),Ln(e._comments)}}function gDe(t,n){if(1&t){const e=Ut();O(0,"div",39),ot(1,mDe,3,0,"div",45),O(2,"div",46)(3,"input",47),go("ngModelChange",function(i){Me(e);const o=ge().$implicit,a=ge();return Ro(a.commentInputs[o.id],i)||(a.commentInputs[o.id]=i),Oe(i)}),Pe("keydown.enter",function(){Me(e);const i=ge().$implicit;return Oe(ge().addComment(i.id))}),V(),O(4,"button",48),Pe("click",function(){Me(e);const i=ge().$implicit;return Oe(ge().addComment(i.id))}),xn(),O(5,"svg",17),ut(6,"path",18),V()()()()}if(2&t){const e=ge().$implicit,r=ge();Y(),st(e._comments&&e._comments.length>0?1:-1),Y(2),mo("ngModel",r.commentInputs[e.id]),Y(),pn("disabled",!(null!=r.commentInputs[e.id]&&r.commentInputs[e.id].trim()))}}function _De(t,n){if(1&t){const e=Ut();ot(0,oDe,5,1,"div",23),O(1,"div",24)(2,"div",25),ot(3,sDe,1,1,"img",26)(4,aDe,2,1,"div",27),O(5,"div",28)(6,"p",29),q(7),V(),O(8,"p",30),q(9),V()(),ot(10,lDe,3,0,"button",31),V(),ot(11,cDe,1,1,"img",32),ot(12,uDe,3,1,"div",33),O(13,"div",34)(14,"button",35),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().toggleLike(i))}),O(15,"span",36),q(16),V(),O(17,"span",37),q(18),V()(),O(19,"button",38),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge().toggleComments(i.id))}),O(20,"span",36),q(21,"\u{1f4ac}"),V(),O(22,"span",37),q(23),V()()(),ot(24,gDe,7,3,"div",39),V()}if(2&t){const e=n.$implicit,r=n.$index,i=ge();st(i.showDateSeparator(r)?0:-1),Y(3),st(e.photoURL?3:4),Y(4),xt(e.displayName||"Anonyme"),Y(2),xt(i.formatTime(e.timestamp)),Y(),st(i.isMine(e)?10:-1),Y(),st(e.imageURL?11:-1),Y(),st(e.text?12:-1),Y(2),is(e._liked?"text-family-pink":"text-gray-400 hover:text-family-pink"),Y(2),xt(e._liked?"\u2764\ufe0f":"\u{1f90d}"),Y(2),xt(e._likeCount||0),Y(5),xt(e._commentCount||0),Y(),st(i.isCommentsExpanded(e.id)?24:-1)}}function yDe(t,n){if(1&t){const e=Ut();O(0,"div",9),ut(1,"img",59),O(2,"button",60),Pe("click",function(){return Me(e),Oe(ge().removeImage())}),xn(),O(3,"svg",61),ut(4,"path",62),V()()()}if(2&t){const e=ge();Y(),pn("src",e.imagePreview,vs)}}function vDe(t,n){if(1&t){const e=Ut();O(0,"div",63),Pe("click",function(){return Me(e),Oe(ge().closeDeleteModal())}),O(1,"div",64),Pe("click",function(i){return Me(e),Oe(i.stopPropagation())}),O(2,"div",65)(3,"div",66),xn(),O(4,"svg",67),ut(5,"path",43),V()(),Ri(),O(6,"h3",68),q(7,"Supprimer ce post ?"),V(),O(8,"p",69),q(9,"Cette action est irr\xe9versible."),V(),O(10,"div",70)(11,"button",71),Pe("click",function(){return Me(e),Oe(ge().closeDeleteModal())}),q(12," Annuler "),V(),O(13,"button",72),Pe("click",function(){return Me(e),Oe(ge().confirmDelete())}),q(14," Supprimer "),V()()()()()}}let bDe=(()=>{class t{constructor(e){this.chatService=e,this.messages=[],this.newMessage="",this.currentUid="",this.selectedImage=null,this.imagePreview=null,this.unsubscribe=null,this.shouldScroll=!0,this.showDeleteModal=!1,this.messageToDelete=null,this.expandedComments=new Set,this.commentInputs={}}ngOnInit(){this.currentUid=pi.currentUser?.uid||"",this.unsubscribe=this.chatService.listenMessages(e=>{this.messages=e,this.shouldScroll=!0})}ngAfterViewChecked(){this.shouldScroll&&(this.scrollToTop(),this.shouldScroll=!1)}scrollToTop(){const e=this.messagesContainer?.nativeElement;e&&(e.scrollTop=0)}isMine(e){return e.uid===this.currentUid}formatTime(e){const r=new Date(e),i=new Date,o=new Date(i);o.setDate(o.getDate()-1);const a=r.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});return r.toDateString()===i.toDateString()?`Aujourd'hui \xe0 ${a}`:r.toDateString()===o.toDateString()?`Hier \xe0 ${a}`:`${r.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})} \xe0 ${a}`}formatDate(e){const r=new Date(e),i=new Date,o=new Date(i);return o.setDate(o.getDate()-1),r.toDateString()===i.toDateString()?"Aujourd'hui":r.toDateString()===o.toDateString()?"Hier":r.toLocaleDateString("fr-FR",{day:"numeric",month:"long"})}showDateSeparator(e){return 0===e||new Date(this.messages[e-1].timestamp).toDateString()!==new Date(this.messages[e].timestamp).toDateString()}openFilePicker(){this.fileInput.nativeElement.click()}onFileSelected(e){const r=e.target;if(r.files&&r.files[0]){this.selectedImage=r.files[0];const i=new FileReader;i.onload=o=>{this.imagePreview=o.target?.result},i.readAsDataURL(this.selectedImage)}}removeImage(){this.selectedImage=null,this.imagePreview=null,this.fileInput&&(this.fileInput.nativeElement.value="")}send(){var e=this;return fe(function*(){if(!e.newMessage.trim()&&!e.selectedImage)return;const r=e.newMessage,i=e.selectedImage;e.newMessage="",e.removeImage(),yield e.chatService.sendMessage(r,i||void 0)})()}toggleLike(e){var r=this;return fe(function*(){yield r.chatService.toggleLike(e.id)})()}openDeleteModal(e){e.uid===this.currentUid&&(this.messageToDelete=e,this.showDeleteModal=!0)}closeDeleteModal(){this.showDeleteModal=!1,this.messageToDelete=null}confirmDelete(){var e=this;return fe(function*(){e.messageToDelete&&(yield e.chatService.deleteMessage(e.messageToDelete),e.closeDeleteModal())})()}toggleComments(e){this.expandedComments.has(e)?this.expandedComments.delete(e):this.expandedComments.add(e)}isCommentsExpanded(e){return this.expandedComments.has(e)}addComment(e){var r=this;return fe(function*(){const i=r.commentInputs[e]?.trim();i&&(r.commentInputs[e]="",yield r.chatService.addComment(e,i))})()}deleteComment(e,r){var i=this;return fe(function*(){yield i.chatService.deleteComment(e,r)})()}ngOnDestroy(){this.unsubscribe?.()}static{this.\u0275fac=function(r){return new(r||t)(Ne(tDe))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-chat"]],viewQuery:function(r,i){if(1&r&&dp(nDe,5)(rDe,5),2&r){let o;gd(o=_d())&&(i.messagesContainer=o.first),gd(o=_d())&&(i.fileInput=o.first)}},decls:25,vars:5,consts:[["messagesContainer",""],["fileInput",""],[1,"flex","flex-col","h-[calc(100dvh-10rem)]","md:h-[calc(100vh-6rem)]","max-w-2xl","mx-auto","pb-15","md:pb-0"],[1,"text-center","py-3","flex-shrink-0"],[1,"font-display","text-2xl","font-bold"],[1,"text-gradient"],[1,"flex-1","overflow-y-auto","px-4","space-y-4","pb-4"],[1,"text-center","py-12","text-gray-400"],[1,"flex-shrink-0","px-4","py-3","bg-white/80","backdrop-blur-sm","border-t","border-gray-100"],[1,"relative","mb-3","inline-block"],[1,"flex","gap-2","items-end"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"p-2.5","text-gray-400","hover:text-family-pink","transition-colors","flex-shrink-0",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],["placeholder","Quoi de neuf ?","rows","1",1,"flex-1","input-fun","text-sm","resize-none","max-h-24","overflow-y-auto",3,"ngModelChange","keydown.enter","ngModel"],[1,"btn-gradient","px-4","py-2.5","rounded-xl","text-sm","disabled:opacity-40","flex-shrink-0",3,"click","disabled"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"text-4xl","mb-3"],[1,"font-medium"],[1,"text-sm"],[1,"flex","items-center","gap-3","py-2"],[1,"card-fun","overflow-hidden"],[1,"flex","items-center","gap-3","p-3"],["referrerpolicy","no-referrer",1,"w-10","h-10","rounded-full","object-cover","border-2","border-gray-100",3,"src"],[1,"w-10","h-10","rounded-full","bg-gradient-to-br","from-family-pink","to-family-coral","flex","items-center","justify-center","text-white","font-bold"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-700","truncate"],[1,"text-xs","text-gray-400"],[1,"text-gray-300","hover:text-red-400","transition-colors","p-1"],["loading","lazy",1,"w-full","object-contain","max-h-96","bg-gray-50",3,"src"],[1,"px-4","py-3"],[1,"flex","items-center","gap-4","px-4","py-3","border-t","border-gray-50"],[1,"flex","items-center","gap-1.5","transition-colors",3,"click"],[1,"text-lg"],[1,"text-sm","font-medium"],[1,"flex","items-center","gap-1.5","text-gray-400","hover:text-family-sky","transition-colors",3,"click"],[1,"px-4","pb-4","border-t","border-gray-50"],[1,"flex-1","h-px","bg-gray-200"],[1,"text-xs","text-gray-400","font-medium"],[1,"text-gray-300","hover:text-red-400","transition-colors","p-1",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-gray-700","whitespace-pre-wrap","break-words"],[1,"space-y-3","pt-3"],[1,"flex","gap-2","mt-3","pt-3","border-t","border-gray-50"],["placeholder","\xc9crire un commentaire...",1,"flex-1","text-sm","px-3","py-2","rounded-full","bg-gray-50","border-0","focus:ring-2","focus:ring-family-pink/30","outline-none",3,"ngModelChange","keydown.enter","ngModel"],[1,"px-3","py-2","text-family-pink","hover:text-family-coral","disabled:opacity-40","transition-colors",3,"click","disabled"],[1,"flex","gap-2"],["referrerpolicy","no-referrer",1,"w-7","h-7","rounded-full","object-cover","flex-shrink-0",3,"src"],[1,"w-7","h-7","rounded-full","bg-gradient-to-br","from-family-sky","to-family-purple","flex","items-center","justify-center","text-white","text-xs","font-bold","flex-shrink-0"],[1,"bg-gray-50","rounded-xl","px-3","py-2"],[1,"text-xs","font-semibold","text-gray-700"],[1,"text-sm","text-gray-600","break-words"],[1,"flex","items-center","gap-2","mt-1","px-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-gray-400","hover:text-red-400"],[1,"text-[10px]","text-gray-400","hover:text-red-400",3,"click"],[1,"h-20","rounded-lg","object-cover",3,"src"],[1,"absolute","-top-2","-right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","shadow-md","hover:bg-red-600","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full","p-6","animate-fade-in",3,"click"],[1,"text-center"],[1,"w-14","h-14","mx-auto","mb-4","rounded-full","bg-red-100","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-red-500"],[1,"text-lg","font-bold","text-gray-800","mb-2"],[1,"text-sm","text-gray-500","mb-6"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){if(1&r){const o=Ut();O(0,"div",2)(1,"div",3)(2,"h1",4)(3,"span"),q(4,"\u{1f4f1}"),V(),O(5,"span",5),q(6,"Fil d'actu"),V()()(),O(7,"div",6,0),ot(9,iDe,7,0,"div",7),On(10,_De,25,13,null,null,E7),V(),O(12,"div",8),ot(13,yDe,5,1,"div",9),O(14,"div",10)(15,"input",11,1),Pe("change",function(c){return Me(o),Oe(i.onFileSelected(c))}),V(),O(17,"button",12),Pe("click",function(){return Me(o),Oe(i.openFilePicker())}),xn(),O(18,"svg",13),ut(19,"path",14),V()(),Ri(),O(20,"textarea",15),go("ngModelChange",function(c){return Me(o),Ro(i.newMessage,c)||(i.newMessage=c),Oe(c)}),Pe("keydown.enter",function(c){return Me(o),c.preventDefault(),Oe(i.send())}),V(),O(21,"button",16),Pe("click",function(){return Me(o),Oe(i.send())}),xn(),O(22,"svg",17),ut(23,"path",18),V()()()()(),ot(24,vDe,15,0,"div",19)}2&r&&(Y(9),st(i.messages.length?-1:9),Y(),Ln(i.messages),Y(3),st(i.imagePreview?13:-1),Y(7),mo("ngModel",i.newMessage),Y(),pn("disabled",!i.newMessage.trim()&&!i.selectedImage),Y(3),st(i.showDeleteModal?24:-1))},dependencies:[Ic,Xy,zl,Iu,Vp],encapsulation:2})}}return t})();const wDe=["\u{1f35d}","\u{1f355}","\u{1f354}","\u{1f957}","\u{1f372}","\u{1f35c}","\u{1f958}","\u{1f370}","\u{1f967}","\u{1f373}","\u{1f96a}","\u{1f32e}"];let xDe=(()=>{class t{constructor(e){this.shoppingService=e,this._recipes=Pi([]),this.recipes=this._recipes.asReadonly(),this.initListener()}initListener(){Rd(Tn(Pn,"/recipes"),e=>{const r=e.val();if(r){const i=Object.keys(r).map(o=>({id:o,name:r[o].name||"",icon:r[o].icon||"\u{1f37d}\ufe0f",portions:r[o].portions||4,ingredients:r[o].ingredients||[],createdBy:r[o].createdBy||"",createdByName:r[o].createdByName||"",createdAt:r[o].createdAt||""}));this._recipes.set(i)}else this._recipes.set([])})}createRecipe(e){return fe(function*(){const r=pi.currentUser;let i="";r&&(i=((yield tf(Tn(Pn,`/users/${r.uid}`))).val()||{}).displayName||r.displayName||"");const a=Jh(Tn(Pn,"/recipes")).key;return yield Md(Tn(Pn,`/recipes/${a}`),{...e,createdBy:r?.uid||"",createdByName:i,createdAt:(new Date).toISOString()}),a})()}updateRecipe(e,r){return fe(function*(){yield Md(Tn(Pn,`/recipes/${e}`),r)})()}deleteRecipe(e){return fe(function*(){yield ef(Tn(Pn,`/recipes/${e}`))})()}getRecipe(e){return this._recipes().find(r=>r.id===e)}addToShoppingList(e,r){var i=this;return fe(function*(o,a,c=1){const f=pi.currentUser;let _="",x="";if(f){const A=(yield tf(Tn(Pn,`/users/${f.uid}`))).val()||{};_=A.displayName||f.displayName||"",x=A.photoURL||f.photoURL||""}i.shoppingService.setActiveList(a);for(const C of o.ingredients){const A=i.adjustQuantity(C.quantity,c);i.shoppingService.addItem({nom:C.nom,category:C.category,quantity:A,checked:!1,addedBy:f?.uid||"",addedByName:_,addedByPhoto:x,addedAt:(new Date).toISOString()})}}).apply(this,arguments)}adjustQuantity(e,r){const i=e.match(/^(\d+(?:[.,]\d+)?)\s*(.*)$/);if(i){const o=parseFloat(i[1].replace(",",".")),a=i[2],c=Math.round(o*r*10)/10;return a?`${c} ${a}`:`${c}`}return e}static{this.\u0275fac=function(r){return new(r||t)(Tt(fO))}}static{this.\u0275prov=$e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const C7=(t,n)=>n.id,EDe=(t,n)=>n.key;function CDe(t,n){if(1&t&&(O(0,"p",17),q(1),V()),2&t){const e=ge().$implicit;Y(),_r("par ",e.createdByName)}}function DDe(t,n){if(1&t){const e=Ut();O(0,"div",11)(1,"div",12)(2,"div",13),q(3),V(),O(4,"div",14)(5,"h3",15),q(6),V(),O(7,"p",16),q(8),V(),ot(9,CDe,2,1,"p",17),V(),O(10,"div",18)(11,"button",19),Pe("click",function(i){const o=Me(e).$implicit;return ge(3).openAddToListModal(o),Oe(i.stopPropagation())}),xn(),O(12,"svg",6),ut(13,"path",20),V()(),Ri(),O(14,"button",21),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(3).openDetail(i))}),xn(),O(15,"svg",6),ut(16,"path",22)(17,"path",23),V()()()()()}if(2&t){const e=n.$implicit;Y(3),xt(e.icon),Y(3),xt(e.name),Y(2),UI(" ",e.ingredients.length," ingr\xe9dient",e.ingredients.length>1?"s":""," \u2022 ",e.portions," portion",e.portions>1?"s":""," "),Y(),st(e.createdByName?9:-1)}}function TDe(t,n){if(1&t&&(O(0,"div",9),On(1,DDe,18,7,"div",11,C7),V()),2&t){const e=ge(2);Y(),Ln(e.recipes())}}function SDe(t,n){1&t&&(O(0,"div",10)(1,"div",24),q(2,"\u{1f468}\u200d\u{1f373}"),V(),O(3,"p",8),q(4,"Aucune recette"),V(),O(5,"p",25),q(6,"Cr\xe9e ta premi\xe8re recette familiale !"),V()())}function IDe(t,n){if(1&t){const e=Ut();O(0,"div",2)(1,"h1",3),q(2,"\u{1f37d}\ufe0f Recettes"),V(),O(3,"p",4),q(4),V()(),O(5,"button",5),Pe("click",function(){return Me(e),Oe(ge().openCreateForm())}),xn(),O(6,"svg",6),ut(7,"path",7),V(),Ri(),O(8,"span",8),q(9,"Cr\xe9er une recette"),V()(),ot(10,TDe,3,0,"div",9)(11,SDe,7,0,"div",10)}if(2&t){const e=ge();Y(4),bs("",e.recipes().length," recette",e.recipes().length>1?"s":""),Y(6),st(e.recipes().length>0?10:11)}}function kDe(t,n){if(1&t&&(O(0,"div",42)(1,"span",43),q(2),V(),O(3,"span",44),q(4),V(),O(5,"span",16),q(6),V()()),2&t){const e=n.$implicit,r=ge(2);Y(2),xt(r.getCategoryIcon(e.category)),Y(2),xt(e.nom),Y(2),xt(e.quantity)}}function ADe(t,n){if(1&t){const e=Ut();O(0,"div",26)(1,"button",27),Pe("click",function(){return Me(e),Oe(ge().backToList())}),xn(),O(2,"svg",6),ut(3,"path",28),V(),q(4," Retour "),V()(),Ri(),O(5,"div",2)(6,"div",29),q(7),V(),O(8,"h1",30),q(9),V(),O(10,"p",31),q(11),V()(),O(12,"div",32)(13,"button",33),Pe("click",function(){Me(e);const i=ge();return Oe(i.openAddToListModal(i.selectedRecipe))}),xn(),O(14,"svg",34),ut(15,"path",20),V(),q(16," Ajouter aux courses "),V(),Ri(),O(17,"button",35),Pe("click",function(){Me(e);const i=ge();return Oe(i.openEditForm(i.selectedRecipe))}),xn(),O(18,"svg",34),ut(19,"path",36),V(),q(20," Modifier "),V(),Ri(),O(21,"button",37),Pe("click",function(){Me(e);const i=ge();return Oe(i.openDeleteModal(i.selectedRecipe))}),xn(),O(22,"svg",34),ut(23,"path",38),V()()(),Ri(),O(24,"div",39)(25,"h2",40),q(26,"Ingr\xe9dients"),V(),O(27,"div",41),On(28,kDe,7,3,"div",42,hb),V()()}if(2&t){const e=ge();Y(7),xt(e.selectedRecipe.icon),Y(2),xt(e.selectedRecipe.name),Y(2),bs("",e.selectedRecipe.portions," portion",e.selectedRecipe.portions>1?"s":""),Y(17),Ln(e.selectedRecipe.ingredients)}}function MDe(t,n){if(1&t){const e=Ut();O(0,"button",64),Pe("click",function(){const i=Me(e).$implicit;return Oe(ge(2).recipeIcon=i)}),q(1),V()}if(2&t){const e=n.$implicit;is(ge(2).recipeIcon===e?"w-10 h-10 rounded-xl bg-family-purple/10 text-xl flex items-center justify-center ring-2 ring-family-purple":"w-10 h-10 rounded-xl bg-gray-100 text-xl flex items-center justify-center hover:bg-gray-200 transition-colors"),Y(),_r(" ",e," ")}}function RDe(t,n){if(1&t){const e=Ut();O(0,"div",42)(1,"span",43),q(2),V(),O(3,"span",44),q(4),V(),O(5,"span",16),q(6),V(),O(7,"button",65),Pe("click",function(){const i=Me(e).$index;return Oe(ge(3).removeIngredient(i))}),xn(),O(8,"svg",34),ut(9,"path",66),V()()()}if(2&t){const e=n.$implicit,r=ge(3);Y(2),xt(r.getCategoryIcon(e.category)),Y(2),xt(e.nom),Y(2),xt(e.quantity)}}function PDe(t,n){if(1&t&&(O(0,"div",55),On(1,RDe,10,3,"div",42,hb),V()),2&t){const e=ge(2);Y(),Ln(e.recipeIngredients)}}function NDe(t,n){if(1&t&&(O(0,"option",61),q(1),V()),2&t){const e=n.$implicit;pn("value",e.key),Y(),bs("",e.icon," ",e.label)}}function ODe(t,n){if(1&t){const e=Ut();O(0,"div",26)(1,"button",27),Pe("click",function(){return Me(e),Oe(ge().backToList())}),xn(),O(2,"svg",6),ut(3,"path",28),V(),q(4," Annuler "),V()(),Ri(),O(5,"div",2)(6,"h1",3),q(7),V()(),O(8,"div",45)(9,"div",46)(10,"input",47),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.recipeName,i)||(o.recipeName=i),Oe(i)}),V(),O(11,"div",48)(12,"div",49)(13,"label",50),q(14,"Ic\xf4ne"),V(),O(15,"div",51),On(16,MDe,2,3,"button",52,nl),V()(),O(18,"div",53)(19,"label",50),q(20,"Portions"),V(),O(21,"input",54),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.recipePortions,i)||(o.recipePortions=i),Oe(i)}),V()()()(),O(22,"div",39)(23,"h2",40),q(24,"Ingr\xe9dients"),V(),ot(25,PDe,3,0,"div",55),O(26,"div",56)(27,"input",57),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.newIngredientName,i)||(o.newIngredientName=i),Oe(i)}),Pe("keyup.enter",function(){return Me(e),Oe(ge().addIngredient())}),V(),O(28,"div",58)(29,"input",59),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.newIngredientQuantity,i)||(o.newIngredientQuantity=i),Oe(i)}),V(),O(30,"select",60),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.newIngredientCategory,i)||(o.newIngredientCategory=i),Oe(i)}),On(31,NDe,2,3,"option",61,EDe),V()(),O(33,"button",62),Pe("click",function(){return Me(e),Oe(ge().addIngredient())}),q(34," + Ajouter ingr\xe9dient "),V()()(),O(35,"button",63),Pe("click",function(){return Me(e),Oe(ge().saveRecipe())}),q(36),V()()}if(2&t){const e=ge();Y(7),_r(" ","create"===e.editMode?"Nouvelle recette":"Modifier la recette"," "),Y(3),mo("ngModel",e.recipeName),Y(6),Ln(e.recipeIcons),Y(5),mo("ngModel",e.recipePortions),Y(4),st(e.recipeIngredients.length>0?25:-1),Y(2),mo("ngModel",e.newIngredientName),Y(2),mo("ngModel",e.newIngredientQuantity),Y(),mo("ngModel",e.newIngredientCategory),Y(),Ln(e.categories),Y(2),pn("disabled",!e.newIngredientName.trim()),Y(2),pn("disabled",!e.recipeName.trim()||0===e.recipeIngredients.length),Y(),_r(" ","create"===e.editMode?"Cr\xe9er la recette":"Enregistrer"," ")}}function LDe(t,n){if(1&t&&(O(0,"option",61),q(1),V()),2&t){const e=n.$implicit;pn("value",e.id),Y(),bs("",e.icon," ",e.name)}}function FDe(t,n){if(1&t){const e=Ut();O(0,"div",1)(1,"div",67)(2,"div",68)(3,"h2",69),q(4,"Ajouter aux courses"),V(),O(5,"div",70)(6,"div")(7,"label",50),q(8,"Liste de courses"),V(),O(9,"select",71),go("ngModelChange",function(i){Me(e);const o=ge();return Ro(o.selectedListId,i)||(o.selectedListId=i),Oe(i)}),On(10,LDe,2,3,"option",61,C7),V()(),O(12,"div")(13,"label",50),q(14),V(),O(15,"div",72)(16,"button",73),Pe("click",function(){return Me(e),Oe(ge().decreaseMultiplier())}),xn(),O(17,"svg",6),ut(18,"path",74),V()(),Ri(),O(19,"div",75)(20,"span",76),q(21),V(),O(22,"p",77),q(23),V()(),O(24,"button",73),Pe("click",function(){return Me(e),Oe(ge().increaseMultiplier())}),xn(),O(25,"svg",6),ut(26,"path",7),V()()()(),Ri(),O(27,"p",78),q(28),V()(),O(29,"div",79)(30,"button",80),Pe("click",function(){return Me(e),Oe(ge().closeAddToListModal())}),q(31," Annuler "),V(),O(32,"button",81),Pe("click",function(){return Me(e),Oe(ge().confirmAddToList())}),q(33," Ajouter "),V()()()()()}if(2&t){const e=ge();Y(9),mo("ngModel",e.selectedListId),Y(),Ln(e.shoppingLists()),Y(4),_r(" Portions (recette: ",e.selectedRecipe.portions,") "),Y(7),_r("x",e.portionMultiplier),Y(2),_r("",e.selectedRecipe.portions*e.portionMultiplier," portions"),Y(5),bs(" ",e.selectedRecipe.ingredients.length," ingr\xe9dient",e.selectedRecipe.ingredients.length>1?"s":""," seront ajout\xe9s "),Y(4),pn("disabled",!e.selectedListId)}}function BDe(t,n){if(1&t){const e=Ut();O(0,"div",1)(1,"div",67)(2,"div",68)(3,"div",82)(4,"div",83),q(5,"\u{1f5d1}\ufe0f"),V(),O(6,"h2",84),q(7,"Supprimer la recette ?"),V(),O(8,"p",85),q(9),V()(),O(10,"div",58)(11,"button",80),Pe("click",function(){return Me(e),Oe(ge().closeDeleteModal())}),q(12," Annuler "),V(),O(13,"button",86),Pe("click",function(){return Me(e),Oe(ge().confirmDelete())}),q(14," Supprimer "),V()()()()()}if(2&t){const e=ge();Y(9),bs(' "',e.recipeToDelete.icon," ",e.recipeToDelete.name,'" sera supprim\xe9e d\xe9finitivement. ')}}const VDe=[{path:"auth/signin",component:Jxe},{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",canActivate:[Fc],component:P1e},{path:"user-profile",canActivate:[Fc],component:AEe},{path:"add-task",canActivate:[Fc],component:Xxe},{path:"shopping",canActivate:[Fc],component:bEe},{path:"map",canActivate:[Fc],component:J1e},{path:"calendar",canActivate:[Fc],component:lCe},{path:"documents",canActivate:[Fc],component:ICe},{path:"vacances",canActivate:[Fc],component:eDe},{path:"chat",canActivate:[Fc],component:bDe},{path:"recipes",canActivate:[Fc],component:(()=>{class t{constructor(e,r,i){this.recipesService=e,this.shoppingService=r,this.snackBar=i,this.recipeIcons=wDe,this.categories=b7,this.recipes=this.recipesService.recipes,this.shoppingLists=this.shoppingService.lists,this.view="list",this.selectedRecipe=null,this.editMode="create",this.recipeName="",this.recipeIcon="\u{1f35d}",this.recipePortions=4,this.recipeIngredients=[],this.newIngredientName="",this.newIngredientQuantity="",this.newIngredientCategory="autre",this.showAddToListModal=!1,this.selectedListId="",this.portionMultiplier=1,this.showDeleteModal=!1,this.recipeToDelete=null}openCreateForm(){this.editMode="create",this.recipeName="",this.recipeIcon="\u{1f35d}",this.recipePortions=4,this.recipeIngredients=[],this.view="edit"}openEditForm(e){this.editMode="edit",this.selectedRecipe=e,this.recipeName=e.name,this.recipeIcon=e.icon,this.recipePortions=e.portions,this.recipeIngredients=[...e.ingredients],this.view="edit"}openDetail(e){this.selectedRecipe=e,this.view="detail"}backToList(){this.view="list",this.selectedRecipe=null}addIngredient(){const e=this.newIngredientName.trim();e&&(this.recipeIngredients.push({nom:e,quantity:this.newIngredientQuantity.trim()||"1",category:this.newIngredientCategory}),this.newIngredientName="",this.newIngredientQuantity="",this.newIngredientCategory="autre")}removeIngredient(e){this.recipeIngredients.splice(e,1)}saveRecipe(){var e=this;return fe(function*(){const r=e.recipeName.trim();!r||0===e.recipeIngredients.length||("create"===e.editMode?(yield e.recipesService.createRecipe({name:r,icon:e.recipeIcon,portions:e.recipePortions,ingredients:e.recipeIngredients}),e.snackBar.open("Recette cr\xe9\xe9e !","",{duration:3e3})):e.selectedRecipe&&(yield e.recipesService.updateRecipe(e.selectedRecipe.id,{name:r,icon:e.recipeIcon,portions:e.recipePortions,ingredients:e.recipeIngredients}),e.snackBar.open("Recette mise \xe0 jour !","",{duration:3e3})),e.backToList())})()}openDeleteModal(e){this.recipeToDelete=e,this.showDeleteModal=!0}closeDeleteModal(){this.showDeleteModal=!1,this.recipeToDelete=null}confirmDelete(){var e=this;return fe(function*(){e.recipeToDelete&&(yield e.recipesService.deleteRecipe(e.recipeToDelete.id),e.closeDeleteModal(),e.snackBar.open("Recette supprim\xe9e","",{duration:3e3}),"list"!==e.view&&e.backToList())})()}openAddToListModal(e){this.selectedRecipe=e,this.portionMultiplier=1;const r=this.shoppingLists();this.selectedListId=r.length>0?r[0].id:"",this.showAddToListModal=!0}closeAddToListModal(){this.showAddToListModal=!1}decreaseMultiplier(){this.portionMultiplier>.5&&(this.portionMultiplier-=.5)}increaseMultiplier(){this.portionMultiplier+=.5}confirmAddToList(){var e=this;return fe(function*(){if(!e.selectedRecipe||!e.selectedListId)return;yield e.recipesService.addToShoppingList(e.selectedRecipe,e.selectedListId,e.portionMultiplier);const r=e.shoppingLists().find(i=>i.id===e.selectedListId);e.snackBar.open(`${e.selectedRecipe.ingredients.length} ingr\xe9dients ajout\xe9s \xe0 "${r?.name}"`,"",{duration:3e3}),e.closeAddToListModal()})()}getCategoryIcon(e){return this.categories.find(r=>r.key===e)?.icon||"\u{1f4e6}"}static{this.\u0275fac=function(r){return new(r||t)(Ne(xDe),Ne(fO),Ne(xp))}}static{this.\u0275cmp=gr({type:t,selectors:[["app-recipes"]],decls:6,vars:5,consts:[[1,"max-w-2xl","mx-auto","px-4"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"text-sm","text-gray-400","mt-1"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-purple","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"font-medium"],[1,"space-y-3"],[1,"text-center","py-12","text-gray-400"],[1,"card-fun","p-4","hover:shadow-md","transition-shadow"],[1,"flex","items-start","gap-3"],[1,"text-3xl"],[1,"flex-1","min-w-0"],[1,"font-display","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"],[1,"flex","items-center","gap-1"],["title","Ajouter aux courses",1,"p-2","rounded-lg","text-gray-400","hover:text-family-green","hover:bg-family-green/10","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"],["title","Voir d\xe9tails",1,"p-2","rounded-lg","text-gray-400","hover:text-family-purple","hover:bg-family-purple/10","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"text-4xl","mb-3"],[1,"text-sm"],[1,"mb-4"],[1,"flex","items-center","gap-1","text-gray-500","hover:text-gray-700","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"text-5xl","mb-2"],[1,"font-display","text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500","mt-1"],[1,"flex","justify-center","gap-3","mb-6"],[1,"btn-gradient","text-sm","px-4","py-2","flex","items-center","gap-2",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","text-sm","font-medium","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"px-4","py-2","rounded-xl","border","border-red-200","text-red-500","hover:bg-red-50","transition-colors","text-sm","font-medium",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"card-fun","p-4"],[1,"font-display","font-bold","text-gray-700","mb-3"],[1,"divide-y","divide-gray-100"],[1,"flex","items-center","gap-3","py-2"],[1,"text-lg"],[1,"flex-1","text-gray-700"],[1,"space-y-6"],[1,"card-fun","p-4","space-y-4"],["placeholder","Nom de la recette...",1,"input-fun","w-full","text-lg","font-medium",3,"ngModelChange","ngModel"],[1,"flex","gap-4"],[1,"flex-1"],[1,"text-sm","text-gray-500","mb-2","block"],[1,"flex","flex-wrap","gap-2"],[3,"class"],[1,"w-32"],["type","number","min","1","max","20",1,"input-fun","w-full","text-center",3,"ngModelChange","ngModel"],[1,"divide-y","divide-gray-100","mb-4"],[1,"bg-gray-50","rounded-xl","p-3","space-y-3"],["placeholder","Nom de l'ingr\xe9dient...",1,"input-fun","w-full",3,"ngModelChange","keyup.enter","ngModel"],[1,"flex","gap-3"],["placeholder","Quantit\xe9 (ex: 200g, 2...)",1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[3,"value"],[1,"w-full","py-2","rounded-xl","border-2","border-dashed","border-gray-300","text-gray-500","font-medium","hover:border-family-green","hover:text-family-green","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"w-full","btn-gradient","py-3","font-medium","disabled:opacity-50",3,"click","disabled"],[3,"click"],[1,"text-gray-300","hover:text-red-400","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full"],[1,"p-6"],[1,"font-display","text-xl","font-bold","text-gray-800","mb-4"],[1,"space-y-4"],[1,"input-fun","w-full",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-xl","bg-gray-100","flex","items-center","justify-center","hover:bg-gray-200","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M20 12H4"],[1,"flex-1","text-center"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-500","text-center"],[1,"flex","gap-3","mt-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","btn-gradient","py-2.5",3,"click","disabled"],[1,"text-center","mb-4"],[1,"text-4xl","mb-2"],[1,"font-display","text-xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500","mt-2"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){1&r&&(O(0,"div",0),ot(1,IDe,12,3),ot(2,ADe,30,4),ot(3,ODe,37,10),V(),ot(4,FDe,34,7,"div",1),ot(5,BDe,15,2,"div",1)),2&r&&(Y(),st("list"===i.view?1:-1),Y(),st("detail"===i.view&&i.selectedRecipe?2:-1),Y(),st("edit"===i.view?3:-1),Y(),st(i.showAddToListModal&&i.selectedRecipe?4:-1),Y(),st(i.showDeleteModal&&i.recipeToDelete?5:-1))},dependencies:[Ic,Xy,Zy,Ky,zl,GN,Up,Iu,YN,KN,Vp],encapsulation:2})}}return t})()},{path:"task/edit/:id",canActivate:[Fc],component:TEe}];V4(dj),function _re(){return mk.apply(this,arguments)}(Wwe,{providers:[function xte(t){const n=t?.scheduleInRootZone,e=function wte({ngZoneFactory:t,scheduleInRootZone:n}){return t??=()=>new sn({...i4(),scheduleInRootZone:n}),[{provide:nd,useValue:!1},{provide:sn,useFactory:t},{provide:Xs,multi:!0,useFactory:()=>{const e=Q(vte,{optional:!0});return()=>e.initialize()}},{provide:Xs,multi:!0,useFactory:()=>{const e=Q(Ete);return()=>{e.initialize()}}},{provide:Qw,useValue:n??sm}]}({ngZoneFactory:()=>{const r=i4(t);return r.scheduleInRootZone=n,r.shouldCoalesceEventChangeDetection&&ns("NgZone_CoalesceEvent"),new sn(r)},scheduleInRootZone:n});return Ha([{provide:bte,useValue:!0},e])}(),function Lce(t,...n){return Ha([{provide:e0,multi:!0,useValue:t},[],{provide:rg,useFactory:H5},{provide:lI,multi:!0,useFactory:$5},n.map(e=>e.\u0275providers)])}(VDe),function moe(){return ns("NgEagerAnimations"),[...poe]}(),function xue(...t){const n=[fue,jA,{provide:HA,useExisting:jA},{provide:sC,useFactory:()=>Q(nj,{optional:!0})??Q(rj)},{provide:s0,useValue:wue,multi:!0}];for(const e of t)n.push(...e.\u0275providers);return Ha(n)}(),Sf(xhe,_6,zhe.register("ngsw-worker.js",{enabled:af.production,registrationStrategy:"registerWhenStable:30000"})),Od,Fc,Cw,jD,{provide:Ah,useValue:"fr-FR"}]}).catch(t=>console.error(t))},197(Jy){Jy.exports=function(){"use strict";var lf,Vd,ro;function Ud(v,Qo){if(lf)if(Vd){var He="var sharedChunk = {}; ("+lf+")(sharedChunk); ("+Vd+")(sharedChunk);",St={};lf(St),ro=Qo(St),typeof window<"u"&&(ro.workerUrl=window.URL.createObjectURL(new Blob([He],{type:"text/javascript"})))}else Vd=Qo;else lf=Qo}return Ud(0,function(v){function Qo(s,l){return s(l={exports:{}},l.exports),l.exports}var He=St;function St(s,l,u,m){this.cx=3*s,this.bx=3*(u-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=m,this.p2x=u,this.p2y=m}St.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},St.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},St.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},St.prototype.solveCurveX=function(s,l){var u,m,y,b,E;for(void 0===l&&(l=1e-6),y=s,E=0;E<8;E++){if(b=this.sampleCurveX(y)-s,Math.abs(b)<l)return y;var S=this.sampleCurveDerivativeX(y);if(Math.abs(S)<1e-6)break;y-=b/S}if((y=s)<(u=0))return u;if(y>(m=1))return m;for(;u<m;){if(b=this.sampleCurveX(y),Math.abs(b-s)<l)return y;s>b?u=y:m=y,y=.5*(m-u)+u}return y},St.prototype.solve=function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))};var Wt=dl;function dl(s,l){this.x=s,this.y=l}dl.prototype={clone:function(){return new dl(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,l){return this.clone()._rotateAround(s,l)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var l=s.x-this.x,u=s.y-this.y;return l*l+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,l){return Math.atan2(this.x*l-this.y*s,this.x*s+this.y*l)},_matMult:function(s){var l=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=l,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var l=Math.cos(s),u=Math.sin(s),m=u*this.x+l*this.y;return this.x=l*this.x-u*this.y,this.y=m,this},_rotateAround:function(s,l){var u=Math.cos(s),m=Math.sin(s),y=l.y+m*(this.x-l.x)+u*(this.y-l.y);return this.x=l.x+u*(this.x-l.x)-m*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},dl.convert=function(s){return s instanceof dl?s:Array.isArray(s)?new dl(s[0],s[1]):s};var bt=typeof self<"u"?self:{},Hl=Math.pow(2,53)-1;function Oo(s,l,u,m){var y=new He(s,l,u,m);return function(b){return y.solve(b)}}var Bc=Oo(.25,.1,.25,1);function io(s,l,u){return Math.min(u,Math.max(l,s))}function Mu(s,l,u){var m=u-l,y=((s-l)%m+m)%m+l;return y===l?u:y}function Ui(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}var cf=1;function hl(){return cf++}function ss(){return function s(l){return l?(l^16*Math.random()>>l/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function Ru(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function Ia(s,l){s.forEach(function(u){l[u]&&(l[u]=l[u].bind(l))})}function Vc(s,l){return-1!==s.indexOf(l,s.length-l.length)}function zi(s,l,u){var m={};for(var y in s)m[y]=l.call(u||this,s[y],y,s);return m}function ks(s,l,u){var m={};for(var y in s)l.call(u||this,s[y],y,s)&&(m[y]=s[y]);return m}function Gs(s){return Array.isArray(s)?s.map(Gs):"object"==typeof s&&s?zi(s,Gs):s}var $l={};function yr(s){$l[s]||(typeof console<"u"&&console.warn(s),$l[s]=!0)}function Lo(s,l,u){return(u.y-s.y)*(l.x-s.x)>(l.y-s.y)*(u.x-s.x)}function zp(s){for(var l=0,u=0,m=s.length,y=m-1,b=void 0,E=void 0;u<m;y=u++)l+=((E=s[y]).x-(b=s[u]).x)*(b.y+E.y);return l}function As(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ql(s){var l={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(m,y,b,E){var S=b||E;return l[y]=!S||S.toLowerCase(),""}),l["max-age"]){var u=parseInt(l["max-age"],10);isNaN(u)?delete l["max-age"]:l["max-age"]=u}return l}var Pu=null;function ka(s){if(null==Pu){var l=s.navigator?s.navigator.userAgent:null;Pu=!!s.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Pu}function Ms(s){try{var l=bt[s];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}var oo,Aa,Uc,Gl,fl=bt.performance&&bt.performance.now?bt.performance.now.bind(bt.performance):Date.now.bind(Date),jp=bt.requestAnimationFrame||bt.mozRequestAnimationFrame||bt.webkitRequestAnimationFrame||bt.msRequestAnimationFrame,ji=bt.cancelAnimationFrame||bt.mozCancelAnimationFrame||bt.webkitCancelAnimationFrame||bt.msCancelAnimationFrame,pl={now:fl,frame:function(s){var l=jp(s);return{cancel:function(){return ji(l)}}},getImageData:function(s,l){void 0===l&&(l=0);var u=bt.document.createElement("canvas"),m=u.getContext("2d");if(!m)throw new Error("failed to create canvas 2d context");return u.width=s.width,u.height=s.height,m.drawImage(s,0,0,s.width,s.height),m.getImageData(-l,-l,s.width+2*l,s.height+2*l)},resolveURL:function(s){return oo||(oo=bt.document.createElement("a")),oo.href=s,oo.href},hardwareConcurrency:bt.navigator&&bt.navigator.hardwareConcurrency||4,get devicePixelRatio(){return bt.devicePixelRatio},get prefersReducedMotion(){return!!bt.matchMedia&&(null==Aa&&(Aa=bt.matchMedia("(prefers-reduced-motion: reduce)")),Aa.matches)}},or={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ma={supported:!1,testSupport:function(s){!ml&&Gl&&(Ws?Sn(s):Uc=s)}},ml=!1,Ws=!1;function Sn(s){var l=s.createTexture();s.bindTexture(s.TEXTURE_2D,l);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,Gl),s.isContextLost())return;Ma.supported=!0}catch{}s.deleteTexture(l),ml=!0}bt.document&&((Gl=bt.document.createElement("img")).onload=function(){Uc&&Sn(Uc),Uc=null,Ws=!0},Gl.onerror=function(){ml=!0,Uc=null},Gl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Ra="01",Fo=function(s,l){this._transformRequestFn=s,this._customAccessToken=l,this._createSkuToken()};function Zs(s){return 0===s.indexOf("mapbox:")}Fo.prototype._createSkuToken=function(){var s=function(){for(var l="",u=0;u<10;u++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ra,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt},Fo.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Fo.prototype.transformRequest=function(s,l){return this._transformRequestFn&&this._transformRequestFn(s,l)||{url:s}},Fo.prototype.normalizeStyleURL=function(s,l){if(!Zs(s))return s;var u=as(s);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},Fo.prototype.normalizeGlyphsURL=function(s,l){if(!Zs(s))return s;var u=as(s);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},Fo.prototype.normalizeSourceURL=function(s,l){if(!Zs(s))return s;var u=as(s);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||l)},Fo.prototype.normalizeSpriteURL=function(s,l,u,m){var y=as(s);return Zs(s)?(y.path="/styles/v1"+y.path+"/sprite"+l+u,this._makeAPIURL(y,this._customAccessToken||m)):(y.path+=""+l+u,gl(y))},Fo.prototype.normalizeTileURL=function(s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Zs(s))return s;var u=as(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(pl.devicePixelRatio>=2||512===l?"@2x":"")+(Ma.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var m=this._customAccessToken||function(y){for(var b=0,E=y;b<E.length;b+=1){var S=E[b].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(u.params)||or.ACCESS_TOKEN;return or.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,m)},Fo.prototype.canonicalizeTileURL=function(s,l){var u=as(s);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return s;var m="mapbox://tiles/";m+=u.path.replace("/v4/","");var y=u.params;return l&&(y=y.filter(function(b){return!b.match(/^access_token=/)})),y.length&&(m+="?"+y.join("&")),m},Fo.prototype.canonicalizeTileset=function(s,l){for(var u=!!l&&Zs(l),m=[],y=0,b=s.tiles||[];y<b.length;y+=1){var E=b[y];aa(E)?m.push(this.canonicalizeTileURL(E,u)):m.push(E)}return m},Fo.prototype._makeAPIURL=function(s,l){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",m=as(or.API_URL);if(s.protocol=m.protocol,s.authority=m.authority,"http"===s.protocol){var y=s.params.indexOf("secure");y>=0&&s.params.splice(y,1)}if("/"!==m.path&&(s.path=""+m.path+s.path),!or.REQUIRE_ACCESS_TOKEN)return gl(s);if(!(l=l||or.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===l[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return s.params=s.params.filter(function(b){return-1===b.indexOf("access_token")}),s.params.push("access_token="+l),gl(s)},Fo.prototype.setTransformRequest=function(s){this._transformRequestFn=s};var Hp=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function aa(s){return Hp.test(s)}var vr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function as(s){var l=s.match(vr);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function gl(s){var l=s.params.length?"?"+s.params.join("&"):"";return s.protocol+"://"+s.authority+s.path+l}function _l(s){if(!s)return null;var l=s.split(".");if(!l||3!==l.length)return null;try{return JSON.parse(decodeURIComponent(bt.atob(l[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Qn=function(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Qn.prototype.getStorageKey=function(s){var l,u=_l(or.ACCESS_TOKEN);return l=u&&u.u?bt.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(m,y){return String.fromCharCode(+("0x"+y))})):or.ACCESS_TOKEN||"",s?"mapbox.eventData."+s+":"+l:"mapbox.eventData:"+l},Qn.prototype.fetchEventData=function(){var s=Ms("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{var m=bt.localStorage.getItem(l);m&&(this.eventData=JSON.parse(m));var y=bt.localStorage.getItem(u);y&&(this.anonId=y)}catch{yr("Unable to read from LocalStorage")}},Qn.prototype.saveEventData=function(){var s=Ms("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{bt.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&bt.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{yr("Unable to write to LocalStorage")}},Qn.prototype.processRequests=function(s){},Qn.prototype.postEvent=function(s,l,u,m){var y=this;if(or.EVENTS_URL){var b=as(or.EVENTS_URL);b.params.push("access_token="+(m||or.ACCESS_TOKEN||""));var E={event:this.type,created:new Date(s).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:Ra,userId:this.anonId},S=l?Ui(E,l):E,k={url:gl(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=B(k,function(M){y.pendingRequest=null,u(M),y.saveEventData(),y.processRequests(m)})}},Qn.prototype.queueRequest=function(s,l){this.queue.push(s),this.processRequests(l)};var Rs,Wl,Ks=function(s){function l(){s.call(this,"map.load"),this.success={},this.skuToken=""}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postMapLoadEvent=function(u,m,y,b){this.skuToken=y,(or.EVENTS_URL&&b||or.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(E){return Zs(E)||aa(E)}))&&this.queueRequest({id:m,timestamp:Date.now()},b)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){var y=this.queue.shift(),b=y.id,E=y.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),Ru(this.anonId)||(this.anonId=ss()),this.postEvent(E,{skuToken:this.skuToken},function(S){S||b&&(m.success[b]=!0)},u))}},l}(Qn),Pa=new(function(s){function l(u){s.call(this,"appUserTurnstile"),this._customAccessToken=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postTurnstileEvent=function(u,m){or.EVENTS_URL&&or.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return Zs(y)||aa(y)})&&this.queueRequest(Date.now(),m)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=_l(or.ACCESS_TOKEN),b=y?y.u:or.ACCESS_TOKEN,E=b!==this.eventData.tokenU;Ru(this.anonId)||(this.anonId=ss(),E=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var k=new Date(this.eventData.lastSuccess),M=new Date(S),P=(S-this.eventData.lastSuccess)/864e5;E=E||P>=1||P<-1||k.getDate()!==M.getDate()}else E=!0;if(!E)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(L){L||(m.eventData.lastSuccess=S,m.eventData.tokenU=b)},u)}},l}(Qn)),zc=Pa.postTurnstileEvent.bind(Pa),Nu=new Ks,Na=Nu.postMapLoadEvent.bind(Nu),Ou=500,uf=50;function Lu(){bt.caches&&!Rs&&(Rs=bt.caches.open("mapbox-tiles"))}function jc(s){var l=s.indexOf("?");return l<0?s:s.slice(0,l)}var Ps,Zl=1/0;function zd(){return null==Ps&&(Ps=bt.OffscreenCanvas&&new bt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof bt.createImageBitmap),Ps}var Fu={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Fu);var jd=function(s){function l(u,m,y){401===m&&aa(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),s.call(this,u),this.status=m,this.url=y,this.name=this.constructor.name,this.message=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},l}(Error),yl=As()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===bt.location.protocol?bt.parent:bt).location.href};function Kl(s,l){var u,m=new bt.AbortController,y=new bt.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:yl(),signal:m.signal}),b=!1,E=!1,S=(u=y.url).indexOf("sku=")>0&&aa(u);"json"===s.type&&y.headers.set("Accept","application/json");var k=function(P,L,z){if(!E){if(P&&"SecurityError"!==P.message&&yr(P),L&&z)return M(L);var G=Date.now();bt.fetch(y).then(function(te){if(te.ok){var J=S?te.clone():null;return M(te,J,G)}return l(new jd(te.statusText,te.status,s.url))}).catch(function(te){20!==te.code&&l(new Error(te.message))})}},M=function(P,L,z){("arrayBuffer"===s.type?P.arrayBuffer():"json"===s.type?P.json():P.text()).then(function(G){E||(L&&z&&function(te,J,pe){if(Lu(),Rs){var he={status:J.status,statusText:J.statusText,headers:new bt.Headers};J.headers.forEach(function(ve,Ie){return he.headers.set(Ie,ve)});var be=ql(J.headers.get("Cache-Control")||"");be["no-store"]||(be["max-age"]&&he.headers.set("Expires",new Date(pe+1e3*be["max-age"]).toUTCString()),new Date(he.headers.get("Expires")).getTime()-pe<42e4||function(ve,Ie){if(void 0===Wl)try{new Response(new ReadableStream),Wl=!0}catch{Wl=!1}Wl?Ie(ve.body):ve.blob().then(Ie)}(J,function(ve){var Ie=new bt.Response(ve,he);Lu(),Rs&&Rs.then(function(ke){return ke.put(jc(te.url),Ie)}).catch(function(ke){return yr(ke.message)})}))}}(y,L,z),b=!0,l(null,G,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(function(G){E||l(new Error(G.message))})};return S?function(P,L){if(Lu(),!Rs)return L(null);var z=jc(P.url);Rs.then(function(G){G.match(z).then(function(te){var J=function(pe){if(!pe)return!1;var he=new Date(pe.headers.get("Expires")||0),be=ql(pe.headers.get("Cache-Control")||"");return he>Date.now()&&!be["no-cache"]}(te);G.delete(z),J&&G.put(z,te.clone()),L(null,te,J)}).catch(L)}).catch(L)}(y,k):k(null,null),{cancel:function(){E=!0,b||m.abort()}}}var Oa,Hc,Yl=function(s,l){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(As()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l);if(!As()){var u=s.url.substring(0,s.url.indexOf("://"));return(or.REGISTERED_PROTOCOLS[u]||Kl)(s,l)}}if(!(/^file:/.test(m=s.url)||/^file:/.test(yl())&&!/^\w+:/.test(m))){if(bt.fetch&&bt.Request&&bt.AbortController&&bt.Request.prototype.hasOwnProperty("signal"))return Kl(s,l);if(As()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l,void 0,!0)}var m;return function(y,b){var E=new bt.XMLHttpRequest;for(var S in E.open(y.method||"GET",y.url,!0),"arrayBuffer"===y.type&&(E.responseType="arraybuffer"),y.headers)E.setRequestHeader(S,y.headers[S]);return"json"===y.type&&(E.responseType="text",E.setRequestHeader("Accept","application/json")),E.withCredentials="include"===y.credentials,E.onerror=function(){b(new Error(E.statusText))},E.onload=function(){if((E.status>=200&&E.status<300||0===E.status)&&null!==E.response){var k=E.response;if("json"===y.type)try{k=JSON.parse(E.response)}catch(M){return b(M)}b(null,k,E.getResponseHeader("Cache-Control"),E.getResponseHeader("Expires"))}else b(new jd(E.statusText,E.status,y.url))},E.send(y.body),{cancel:function(){return E.abort()}}}(s,l)},sr=function(s,l){return Yl(Ui(s,{type:"arrayBuffer"}),l)},B=function(s,l){return Yl(Ui(s,{method:"POST"}),l)},j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Oa=[],Hc=0;var H=function(s,l){if(Ma.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Hc>=or.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:s,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return Oa.push(u),u}Hc++;var m=!1,y=function(){if(!m)for(m=!0,Hc--;Oa.length&&Hc<or.MAX_PARALLEL_IMAGE_REQUESTS;){var E=Oa.shift();E.cancelled||(E.cancel=H(E.requestParameters,E.callback).cancel)}},b=sr(s,function(E,S,k,M){var L,z;y(),E?l(E):S&&(zd()?(L=l,z=new bt.Blob([new Uint8Array(S)],{type:"image/png"}),bt.createImageBitmap(z).then(function(G){L(null,G)}).catch(function(G){L(new Error("Could not load image because of "+G.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(P,L,z,G){var te=new bt.Image,J=bt.URL;te.onload=function(){L(null,te),J.revokeObjectURL(te.src),te.onload=null,bt.requestAnimationFrame(function(){te.src=j})},te.onerror=function(){return L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var pe=new bt.Blob([new Uint8Array(P)],{type:"image/png"});te.cacheControl=z,te.expires=G,te.src=P.byteLength?J.createObjectURL(pe):j}(S,l,k,M))});return{cancel:function(){b.cancel(),y()}}};function K(s,l,u){u[s]&&-1!==u[s].indexOf(l)||(u[s]=u[s]||[],u[s].push(l))}function oe(s,l,u){if(u&&u[s]){var m=u[s].indexOf(l);-1!==m&&u[s].splice(m,1)}}var me=function(s,l){void 0===l&&(l={}),Ui(this,l),this.type=s},ye=function(s){function l(u,m){void 0===m&&(m={}),s.call(this,"error",Ui({error:u},m))}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(me),ee=function(){};ee.prototype.on=function(s,l){return this._listeners=this._listeners||{},K(s,l,this._listeners),this},ee.prototype.off=function(s,l){return oe(s,l,this._listeners),oe(s,l,this._oneTimeListeners),this},ee.prototype.once=function(s,l){return this._oneTimeListeners=this._oneTimeListeners||{},K(s,l,this._oneTimeListeners),this},ee.prototype.fire=function(s,l){"string"==typeof s&&(s=new me(s,l||{}));var u=s.type;if(this.listens(u)){s.target=this;for(var m=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];m<y.length;m+=1)y[m].call(this,s);for(var b=0,E=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];b<E.length;b+=1){var S=E[b];oe(u,S,this._oneTimeListeners),S.call(this,s)}var k=this._eventedParent;k&&(Ui(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),k.fire(s))}else s instanceof ye&&console.error(s.error);return this},ee.prototype.listens=function(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)},ee.prototype.setEventedParent=function(s,l){return this._eventedParent=s,this._eventedParentData=l,this};var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ae=function(s,l,u,m){this.message=(s?s+": ":"")+u,m&&(this.identifier=m),null!=l&&l.__line__&&(this.line=l.__line__)};function qe(s){var l=s.value;return l?[new ae(s.key,l,"constants have been deprecated as of v8")]:[]}function Je(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}function Te(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Ge(s){if(Array.isArray(s))return s.map(Ge);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){var l={};for(var u in s)l[u]=Ge(s[u]);return l}return Te(s)}var ht=function(s){function l(u,m){s.call(this,m),this.message=m,this.key=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Error),pt=function(s,l){void 0===l&&(l=[]),this.parent=s,this.bindings={};for(var u=0,m=l;u<m.length;u+=1){var y=m[u];this.bindings[y[0]]=y[1]}};pt.prototype.concat=function(s){return new pt(this,s)},pt.prototype.get=function(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(s+" not found in scope.")},pt.prototype.has=function(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)};var Et={kind:"null"},Fe={kind:"number"},rt={kind:"string"},je={kind:"boolean"},en={kind:"color"},tn={kind:"object"},ue={kind:"value"},fr={kind:"collator"},Ht={kind:"formatted"},ln={kind:"resolvedImage"};function Ir(s,l){return{kind:"array",itemType:s,N:l}}function Un(s){if("array"===s.kind){var l=Un(s.itemType);return"number"==typeof s.N?"array<"+l+", "+s.N+">":"value"===s.itemType.kind?"array":"array<"+l+">"}return s.kind}var _t=[Et,Fe,rt,je,en,Ht,tn,Ir(ue),ln];function Br(s,l){if("error"===l.kind)return null;if("array"===s.kind){if("array"===l.kind&&(0===l.N&&"value"===l.itemType.kind||!Br(s.itemType,l.itemType))&&("number"!=typeof s.N||s.N===l.N))return null}else{if(s.kind===l.kind)return null;if("value"===s.kind)for(var u=0,m=_t;u<m.length;u+=1)if(!Br(m[u],l))return null}return"Expected "+Un(s)+" but found "+Un(l)+" instead."}function En(s,l){return l.some(function(u){return u.kind===s.kind})}function mn(s,l){return l.some(function(u){return"null"===u?null===s:"array"===u?Array.isArray(s):"object"===u?s&&!Array.isArray(s)&&"object"==typeof s:u===typeof s})}var Hd=Qo(function(s,l){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function m(S){return(S=Math.round(S))<0?0:S>255?255:S}function y(S){return m("%"===S[S.length-1]?parseFloat(S)/100*255:parseInt(S))}function b(S){return(k="%"===S[S.length-1]?parseFloat(S)/100:parseFloat(S))<0?0:k>1?1:k;var k}function E(S,k,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?S+(k-S)*M*6:2*M<1?k:3*M<2?S+(k-S)*(2/3-M)*6:S}try{l.parseCSSColor=function(S){var k,M=S.replace(/ /g,"").toLowerCase();if(M in u)return u[M].slice();if("#"===M[0])return 4===M.length?(k=parseInt(M.substr(1),16))>=0&&k<=4095?[(3840&k)>>4|(3840&k)>>8,240&k|(240&k)>>4,15&k|(15&k)<<4,1]:null:7===M.length&&(k=parseInt(M.substr(1),16))>=0&&k<=16777215?[(16711680&k)>>16,(65280&k)>>8,255&k,1]:null;var P=M.indexOf("("),L=M.indexOf(")");if(-1!==P&&L+1===M.length){var z=M.substr(0,P),G=M.substr(P+1,L-(P+1)).split(","),te=1;switch(z){case"rgba":if(4!==G.length)return null;te=b(G.pop());case"rgb":return 3!==G.length?null:[y(G[0]),y(G[1]),y(G[2]),te];case"hsla":if(4!==G.length)return null;te=b(G.pop());case"hsl":if(3!==G.length)return null;var J=(parseFloat(G[0])%360+360)%360/360,pe=b(G[1]),he=b(G[2]),be=he<=.5?he*(pe+1):he+pe-he*pe,ve=2*he-be;return[m(255*E(ve,be,J+1/3)),m(255*E(ve,be,J)),m(255*E(ve,be,J-1/3)),te];default:return null}}return null}}catch{}}).parseCSSColor,wn=function(s,l,u,m){void 0===m&&(m=1),this.r=s,this.g=l,this.b=u,this.a=m};wn.parse=function(s){if(s){if(s instanceof wn)return s;if("string"==typeof s){var l=Hd(s);if(l)return new wn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3])}}},wn.prototype.toString=function(){var s=this.toArray(),l=s[1],u=s[2],m=s[3];return"rgba("+Math.round(s[0])+","+Math.round(l)+","+Math.round(u)+","+m+")"},wn.prototype.toArray=function(){var s=this.a;return 0===s?[0,0,0,0]:[255*this.r/s,255*this.g/s,255*this.b/s,s]},wn.black=new wn(0,0,0,1),wn.white=new wn(1,1,1,1),wn.transparent=new wn(0,0,0,0),wn.red=new wn(1,0,0,1);var Jn=function(s,l,u){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Jn.prototype.compare=function(s,l){return this.collator.compare(s,l)},Jn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var _n=function(s,l,u,m,y){this.text=s,this.image=l,this.scale=u,this.fontStack=m,this.textColor=y},si=function(s){this.sections=s};si.fromString=function(s){return new si([new _n(s,null,null,null,null)])},si.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(s){return 0!==s.text.length||s.image&&0!==s.image.name.length})},si.factory=function(s){return s instanceof si?s:si.fromString(s)},si.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(s){return s.text}).join("")},si.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];if(m.image)s.push(["image",m.image.name]);else{s.push(m.text);var y={};m.fontStack&&(y["text-font"]=["literal",m.fontStack.split(",")]),m.scale&&(y["font-scale"]=m.scale),m.textColor&&(y["text-color"]=["rgba"].concat(m.textColor.toArray())),s.push(y)}}return s};var kr=function(s){this.name=s.name,this.available=s.available};function Og(s,l,u,m){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof l&&l>=0&&l<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===m||"number"==typeof m&&m>=0&&m<=1?null:"Invalid rgba value ["+[s,l,u,m].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof m?[s,l,u,m]:[s,l,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function $c(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof wn||s instanceof Jn||s instanceof si||s instanceof kr)return!0;if(Array.isArray(s)){for(var l=0,u=s;l<u.length;l+=1)if(!$c(u[l]))return!1;return!0}if("object"==typeof s){for(var m in s)if(!$c(s[m]))return!1;return!0}return!1}function Hi(s){if(null===s)return Et;if("string"==typeof s)return rt;if("boolean"==typeof s)return je;if("number"==typeof s)return Fe;if(s instanceof wn)return en;if(s instanceof Jn)return fr;if(s instanceof si)return Ht;if(s instanceof kr)return ln;if(Array.isArray(s)){for(var l,u=s.length,m=0,y=s;m<y.length;m+=1){var b=Hi(y[m]);if(l){if(l===b)continue;l=ue;break}l=b}return Ir(l||ue,u)}return tn}function Bo(s){var l=typeof s;return null===s?"":"string"===l||"number"===l||"boolean"===l?String(s):s instanceof wn||s instanceof si||s instanceof kr?s.toString():JSON.stringify(s)}kr.prototype.toString=function(){return this.name},kr.fromString=function(s){return s?new kr({name:s,available:!1}):null},kr.prototype.serialize=function(){return["image",this.name]};var la=function(s,l){this.type=s,this.value=l};la.parse=function(s,l){if(2!==s.length)return l.error("'literal' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(!$c(s[1]))return l.error("invalid value");var u=s[1],m=Hi(u),y=l.expectedType;return"array"!==m.kind||0!==m.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(m=y),new la(m,u)},la.prototype.evaluate=function(){return this.value},la.prototype.eachChild=function(){},la.prototype.outputDefined=function(){return!0},la.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof wn?["rgba"].concat(this.value.toArray()):this.value instanceof si?this.value.serialize():this.value};var Rr=function(s){this.name="ExpressionEvaluationError",this.message=s};Rr.prototype.toJSON=function(){return this.message};var ls={string:rt,number:Fe,boolean:je,object:tn},_o=function(s,l){this.type=s,this.args=l};_o.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u,m=1,y=s[0];if("array"===y){var b,E;if(s.length>2){var S=s[1];if("string"!=typeof S||!(S in ls)||"object"===S)return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=ls[S],m++}else b=ue;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=s[2],m++}u=Ir(b,E)}else u=ls[y];for(var k=[];m<s.length;m++){var M=l.parse(s[m],m,ue);if(!M)return null;k.push(M)}return new _o(u,k)},_o.prototype.evaluate=function(s){for(var l=0;l<this.args.length;l++){var u=this.args[l].evaluate(s);if(!Br(this.type,Hi(u)))return u;if(l===this.args.length-1)throw new Rr("Expected value to be of type "+Un(this.type)+", but found "+Un(Hi(u))+" instead.")}return null},_o.prototype.eachChild=function(s){this.args.forEach(s)},_o.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},_o.prototype.serialize=function(){var s=this.type,l=[s.kind];if("array"===s.kind){var u=s.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){l.push(u.kind);var m=s.N;("number"==typeof m||this.args.length>1)&&l.push(m)}}return l.concat(this.args.map(function(y){return y.serialize()}))};var cs=function(s){this.type=Ht,this.sections=s};cs.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[1];if(!Array.isArray(u)&&"object"==typeof u)return l.error("First argument must be an image or text section.");for(var m=[],y=!1,b=1;b<=s.length-1;++b){var E=s[b];if(y&&"object"==typeof E&&!Array.isArray(E)){y=!1;var S=null;if(E["font-scale"]&&!(S=l.parse(E["font-scale"],1,Fe)))return null;var k=null;if(E["text-font"]&&!(k=l.parse(E["text-font"],1,Ir(rt))))return null;var M=null;if(E["text-color"]&&!(M=l.parse(E["text-color"],1,en)))return null;var P=m[m.length-1];P.scale=S,P.font=k,P.textColor=M}else{var L=l.parse(s[b],1,ue);if(!L)return null;var z=L.type.kind;if("string"!==z&&"value"!==z&&"null"!==z&&"resolvedImage"!==z)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:L,scale:null,font:null,textColor:null})}}return new cs(m)},cs.prototype.evaluate=function(s){return new si(this.sections.map(function(l){var u=l.content.evaluate(s);return Hi(u)===ln?new _n("",u,null,null,null):new _n(Bo(u),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))},cs.prototype.eachChild=function(s){for(var l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s(m.content),m.scale&&s(m.scale),m.font&&s(m.font),m.textColor&&s(m.textColor)}},cs.prototype.outputDefined=function(){return!1},cs.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s.push(m.content.serialize());var y={};m.scale&&(y["font-scale"]=m.scale.serialize()),m.font&&(y["text-font"]=m.font.serialize()),m.textColor&&(y["text-color"]=m.textColor.serialize()),s.push(y)}return s};var Xl=function(s){this.type=ln,this.input=s};Xl.parse=function(s,l){if(2!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,rt);return u?new Xl(u):l.error("No image name provided.")},Xl.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=kr.fromString(l);return u&&s.availableImages&&(u.available=s.availableImages.indexOf(l)>-1),u},Xl.prototype.eachChild=function(s){s(this.input)},Xl.prototype.outputDefined=function(){return!1},Xl.prototype.serialize=function(){return["image",this.input.serialize()]};var ev={"to-boolean":je,"to-color":en,"to-number":Fe,"to-string":rt},ca=function(s,l){this.type=s,this.args=l};ca.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[0];if(("to-boolean"===u||"to-string"===u)&&2!==s.length)return l.error("Expected one argument.");for(var m=ev[u],y=[],b=1;b<s.length;b++){var E=l.parse(s[b],b,ue);if(!E)return null;y.push(E)}return new ca(m,y)},ca.prototype.evaluate=function(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){for(var l,u,m=0,y=this.args;m<y.length;m+=1){if(u=null,(l=y[m].evaluate(s))instanceof wn)return l;if("string"==typeof l){var b=s.parseColor(l);if(b)return b}else if(Array.isArray(l)&&!(u=l.length<3||l.length>4?"Invalid rbga value "+JSON.stringify(l)+": expected an array containing either three or four numeric values.":Og(l[0],l[1],l[2],l[3])))return new wn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Rr(u||"Could not parse color from value '"+("string"==typeof l?l:String(JSON.stringify(l)))+"'")}if("number"===this.type.kind){for(var E=null,S=0,k=this.args;S<k.length;S+=1){if(null===(E=k[S].evaluate(s)))return 0;var M=Number(E);if(!isNaN(M))return M}throw new Rr("Could not convert "+JSON.stringify(E)+" to number.")}return"formatted"===this.type.kind?si.fromString(Bo(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?kr.fromString(Bo(this.args[0].evaluate(s))):Bo(this.args[0].evaluate(s))},ca.prototype.eachChild=function(s){this.args.forEach(s)},ca.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},ca.prototype.serialize=function(){if("formatted"===this.type.kind)return new cs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Xl(this.args[0]).serialize();var s=["to-"+this.type.kind];return this.eachChild(function(l){s.push(l.serialize())}),s};var yo=["Unknown","Point","LineString","Polygon"],Rt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Rt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Rt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?yo[this.feature.type]:this.feature.type:null},Rt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Rt.prototype.canonicalID=function(){return this.canonical},Rt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Rt.prototype.parseColor=function(s){var l=this._parseColorCache[s];return l||(l=this._parseColorCache[s]=wn.parse(s)),l};var so=function(s,l,u,m){this.name=s,this.type=l,this._evaluate=u,this.args=m};so.prototype.evaluate=function(s){return this._evaluate(s,this.args)},so.prototype.eachChild=function(s){this.args.forEach(s)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return[this.name].concat(this.args.map(function(s){return s.serialize()}))},so.parse=function(s,l){var u,m=s[0],y=so.definitions[m];if(!y)return l.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,S=E.filter(function(At){var at=At[0];return!Array.isArray(at)||at.length===s.length-1}),k=null,M=0,P=S;M<P.length;M+=1){var L=P[M],z=L[0],G=L[1];k=new Os(l.registry,l.path,null,l.scope);for(var te=[],J=!1,pe=1;pe<s.length;pe++){var he=s[pe],be=Array.isArray(z)?z[pe-1]:z.type,ve=k.parse(he,1+te.length,be);if(!ve){J=!0;break}te.push(ve)}if(!J)if(Array.isArray(z)&&z.length!==te.length)k.error("Expected "+z.length+" arguments, but found "+te.length+" instead.");else{for(var Ie=0;Ie<te.length;Ie++){var ke=Array.isArray(z)?z[Ie]:z.type,Be=te[Ie];k.concat(Ie+1).checkSubtype(ke,Be.type)}if(0===k.errors.length)return new so(m,b,G,te)}}if(1===S.length)(u=l.errors).push.apply(u,k.errors);else{for(var Ye=(S.length?S:E).map(function(At){var at;return at=At[0],Array.isArray(at)?"("+at.map(Un).join(", ")+")":"("+Un(at.type)+"...)"}).join(" | "),nt=[],wt=1;wt<s.length;wt++){var it=l.parse(s[wt],1+nt.length);if(!it)return null;nt.push(Un(it.type))}l.error("Expected arguments of type "+Ye+", but found ("+nt.join(", ")+") instead.")}return null},so.register=function(s,l){for(var u in so.definitions=l,l)s[u]=so};var Si=function(s,l,u){this.type=fr,this.locale=u,this.caseSensitive=s,this.diacriticSensitive=l};function Bu(s,l){s[0]=Math.min(s[0],l[0]),s[1]=Math.min(s[1],l[1]),s[2]=Math.max(s[2],l[0]),s[3]=Math.max(s[3],l[1])}function $p(s,l){return!(s[0]<=l[0]||s[2]>=l[2]||s[1]<=l[1]||s[3]>=l[3])}function Ow(s,l){var u=(180+s[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(u*y*8192),Math.round(m*y*8192)]}function $e(s,l,u){return l[1]>s[1]!=u[1]>s[1]&&s[0]<(u[0]-l[0])*(s[1]-l[1])/(u[1]-l[1])+l[0]}function Hr(s,l){for(var u,m,y,b,E,S,k,M=!1,P=0,L=l.length;P<L;P++)for(var z=l[P],G=0,te=z.length;G<te-1;G++){if((b=(u=s)[0]-(m=z[G])[0])*(k=u[1]-(y=z[G+1])[1])-(S=u[0]-y[0])*(E=u[1]-m[1])==0&&b*S<=0&&E*k<=0)return!1;$e(s,z[G],z[G+1])&&(M=!M)}return M}function df(s,l){for(var u=0;u<l.length;u++)if(Hr(s,l[u]))return!0;return!1}function Lg(s,l,u,m){var y=m[0]-u[0],b=m[1]-u[1],E=(s[0]-u[0])*b-y*(s[1]-u[1]),S=(l[0]-u[0])*b-y*(l[1]-u[1]);return E>0&&S<0||E<0&&S>0}function tv(s,l,u){for(var m=0,y=u;m<y.length;m+=1)for(var b=y[m],E=0;E<b.length-1;++E)if((L=[(P=b[E+1])[0]-(M=b[E])[0],P[1]-M[1]])[0]*(z=[(k=l)[0]-(S=s)[0],k[1]-S[1]])[1]-L[1]*z[0]!=0&&Lg(S,k,M,P)&&Lg(M,P,S,k))return!0;var S,k,M,P,L,z;return!1}function qp(s,l){for(var u=0;u<s.length;++u)if(!Hr(s[u],l))return!1;for(var m=0;m<s.length-1;++m)if(tv(s[m],s[m+1],l))return!1;return!0}function qc(s,l){for(var u=0;u<l.length;u++)if(qp(s,l[u]))return!0;return!1}function Gc(s,l,u){for(var m=[],y=0;y<s.length;y++){for(var b=[],E=0;E<s[y].length;E++){var S=Ow(s[y][E],u);Bu(l,S),b.push(S)}m.push(b)}return m}function Wc(s,l,u){for(var m=[],y=0;y<s.length;y++){var b=Gc(s[y],l,u);m.push(b)}return m}function Ue(s,l,u,m){if(s[0]<u[0]||s[0]>u[2]){var y=.5*m,b=s[0]-u[0]>y?-m:u[0]-s[0]>y?m:0;0===b&&(b=s[0]-u[2]>y?-m:u[2]-s[0]>y?m:0),s[0]+=b}Bu(l,s)}function Vu(s,l,u,m){for(var y=8192*Math.pow(2,m.z),b=[8192*m.x,8192*m.y],E=[],S=0,k=s;S<k.length;S+=1)for(var M=0,P=k[S];M<P.length;M+=1){var L=P[M],z=[L.x+b[0],L.y+b[1]];Ue(z,l,u,y),E.push(z)}return E}function Ql(s,l,u,m){for(var y,b=8192*Math.pow(2,m.z),E=[8192*m.x,8192*m.y],S=[],k=0,M=s;k<M.length;k+=1){for(var P=[],L=0,z=M[k];L<z.length;L+=1){var G=z[L],te=[G.x+E[0],G.y+E[1]];Bu(l,te),P.push(te)}S.push(P)}if(l[2]-l[0]<=b/2){(y=l)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var J=0,pe=S;J<pe.length;J+=1)for(var he=0,be=pe[J];he<be.length;he+=1)Ue(be[he],l,u,b)}return S}Si.parse=function(s,l){if(2!==s.length)return l.error("Expected one argument.");var u=s[1];if("object"!=typeof u||Array.isArray(u))return l.error("Collator options argument must be an object.");var m=l.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,je);if(!m)return null;var y=l.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,je);if(!y)return null;var b=null;return u.locale&&!(b=l.parse(u.locale,1,rt))?null:new Si(m,y,b)},Si.prototype.evaluate=function(s){return new Jn(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)},Si.prototype.eachChild=function(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)},Si.prototype.outputDefined=function(){return!1},Si.prototype.serialize=function(){var s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]};var ao=function(s,l){this.type=je,this.geojson=s,this.geometries=l};function Ns(s){if(s instanceof so&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof ao)return!1;var l=!0;return s.eachChild(function(u){l&&!Ns(u)&&(l=!1)}),l}function Jl(s){if(s instanceof so&&"feature-state"===s.name)return!1;var l=!0;return s.eachChild(function(u){l&&!Jl(u)&&(l=!1)}),l}function hf(s,l){if(s instanceof so&&l.indexOf(s.name)>=0)return!1;var u=!0;return s.eachChild(function(m){u&&!hf(m,l)&&(u=!1)}),u}ao.parse=function(s,l){if(2!==s.length)return l.error("'within' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if($c(s[1])){var u=s[1];if("FeatureCollection"===u.type)for(var m=0;m<u.features.length;++m){var y=u.features[m].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new ao(u,u.features[m].geometry)}else if("Feature"===u.type){var b=u.geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new ao(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new ao(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ao.prototype.evaluate=function(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Gc(u.coordinates,y,b),S=Vu(l.geometry(),m,y,b);if(!$p(m,y))return!1;for(var k=0,M=S;k<M.length;k+=1)if(!Hr(M[k],E))return!1}if("MultiPolygon"===u.type){var P=Wc(u.coordinates,y,b),L=Vu(l.geometry(),m,y,b);if(!$p(m,y))return!1;for(var z=0,G=L;z<G.length;z+=1)if(!df(G[z],P))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Gc(u.coordinates,y,b),S=Ql(l.geometry(),m,y,b);if(!$p(m,y))return!1;for(var k=0,M=S;k<M.length;k+=1)if(!qp(M[k],E))return!1}if("MultiPolygon"===u.type){var P=Wc(u.coordinates,y,b),L=Ql(l.geometry(),m,y,b);if(!$p(m,y))return!1;for(var z=0,G=L;z<G.length;z+=1)if(!qc(G[z],P))return!1}return!0}(s,this.geometries)}return!1},ao.prototype.eachChild=function(){},ao.prototype.outputDefined=function(){return!0},ao.prototype.serialize=function(){return["within",this.geojson]};var ec=function(s,l){this.type=l.type,this.name=s,this.boundExpression=l};ec.parse=function(s,l){if(2!==s.length||"string"!=typeof s[1])return l.error("'var' expression requires exactly one string literal argument.");var u=s[1];return l.scope.has(u)?new ec(u,l.scope.get(u)):l.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},ec.prototype.evaluate=function(s){return this.boundExpression.evaluate(s)},ec.prototype.eachChild=function(){},ec.prototype.outputDefined=function(){return!1},ec.prototype.serialize=function(){return["var",this.name]};var Os=function(s,l,u,m,y){void 0===l&&(l=[]),void 0===m&&(m=new pt),void 0===y&&(y=[]),this.registry=s,this.path=l,this.key=l.map(function(b){return"["+b+"]"}).join(""),this.scope=m,this.errors=y,this.expectedType=u};function tc(s,l){for(var u,m=s.length-1,y=0,b=m,E=0;y<=b;)if((u=s[E=Math.floor((y+b)/2)])<=l){if(E===m||l<s[E+1])return E;y=E+1}else{if(!(u>l))throw new Rr("Input is not a number.");b=E-1}return 0}Os.prototype.parse=function(s,l,u,m,y){return void 0===y&&(y={}),l?this.concat(l,u,m)._parse(s,y):this._parse(s,y)},Os.prototype._parse=function(s,l){function u(M,P,L){return"assert"===L?new _o(P,[M]):"coerce"===L?new ca(P,[M]):M}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var m=s[0];if("string"!=typeof m)return this.error("Expression name must be a string, but found "+typeof m+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[m];if(y){var b=y.parse(s,this);if(!b)return null;if(this.expectedType){var E=this.expectedType,S=b.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==S.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==S.kind&&"string"!==S.kind){if(this.checkSubtype(E,S))return null}else b=u(b,E,l.typeAnnotation||"coerce");else b=u(b,E,l.typeAnnotation||"assert")}if(!(b instanceof la)&&"resolvedImage"!==b.type.kind&&function M(P){if(P instanceof ec)return M(P.boundExpression);if(P instanceof so&&"error"===P.name||P instanceof Si||P instanceof ao)return!1;var L=P instanceof ca||P instanceof _o,z=!0;return P.eachChild(function(G){z=L?z&&M(G):z&&G instanceof la}),!!z&&Ns(P)&&hf(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var k=new Rt;try{b=new la(b.type,b.evaluate(k))}catch(M){return this.error(M.message),null}}return b}return this.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof s+" instead.")},Os.prototype.concat=function(s,l,u){var m="number"==typeof s?this.path.concat(s):this.path,y=u?this.scope.concat(u):this.scope;return new Os(this.registry,m,l||null,y,this.errors)},Os.prototype.error=function(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];var m=""+this.key+l.map(function(y){return"["+y+"]"}).join("");this.errors.push(new ht(m,s))},Os.prototype.checkSubtype=function(s,l){var u=Br(s,l);return u&&this.error(u),u};var La=function(s,l,u){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(var m=0,y=u;m<y.length;m+=1){var b=y[m],E=b[1];this.labels.push(b[0]),this.outputs.push(E)}};function mi(s,l,u){return s*(1-u)+l*u}La.parse=function(s,l){if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");var u=l.parse(s[1],1,Fe);if(!u)return null;var m=[],y=null;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);for(var b=1;b<s.length;b+=2){var E=1===b?-1/0:s[b],S=s[b+1],k=b,M=b+1;if("number"!=typeof E)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);var P=l.parse(S,M,y);if(!P)return null;y=y||P.type,m.push([E,P])}return new La(y,u,m)},La.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;return m>=l[y-1]?u[y-1].evaluate(s):u[tc(l,m)].evaluate(s)},La.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},La.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},La.prototype.serialize=function(){for(var s=["step",this.input.serialize()],l=0;l<this.labels.length;l++)l>0&&s.push(this.labels[l]),s.push(this.outputs[l].serialize());return s};var Gp=Object.freeze({__proto__:null,number:mi,color:function(s,l,u){return new wn(mi(s.r,l.r,u),mi(s.g,l.g,u),mi(s.b,l.b,u),mi(s.a,l.a,u))},array:function(s,l,u){return s.map(function(m,y){return mi(m,l[y],u)})}}),nv=6/29*3*(6/29),rv=Math.PI/180,Lw=180/Math.PI;function $d(s){return s>.008856451679035631?Math.pow(s,1/3):s/nv+4/29}function ff(s){return s>6/29?s*s*s:nv*(s-4/29)}function Wp(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Zp(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Kp(s){var l=Zp(s.r),u=Zp(s.g),m=Zp(s.b),y=$d((.4124564*l+.3575761*u+.1804375*m)/.95047),b=$d((.2126729*l+.7151522*u+.072175*m)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-$d((.0193339*l+.119192*u+.9503041*m)/1.08883)),alpha:s.a}}function nc(s){var l=(s.l+16)/116,u=isNaN(s.a)?l:l+s.a/500,m=isNaN(s.b)?l:l-s.b/200;return l=1*ff(l),u=.95047*ff(u),m=1.08883*ff(m),new wn(Wp(3.2404542*u-1.5371385*l-.4985314*m),Wp(-.969266*u+1.8760108*l+.041556*m),Wp(.0556434*u-.2040259*l+1.0572252*m),s.alpha)}function qd(s,l,u){var m=l-s;return s+u*(m>180||m<-180?m-360*Math.round(m/360):m)}var Uu={forward:Kp,reverse:nc,interpolate:function(s,l,u){return{l:mi(s.l,l.l,u),a:mi(s.a,l.a,u),b:mi(s.b,l.b,u),alpha:mi(s.alpha,l.alpha,u)}}},us={forward:function(s){var l=Kp(s),u=l.l,m=l.a,y=l.b,b=Math.atan2(y,m)*Lw;return{h:b<0?b+360:b,c:Math.sqrt(m*m+y*y),l:u,alpha:s.a}},reverse:function(s){var l=s.h*rv,u=s.c;return nc({l:s.l,a:Math.cos(l)*u,b:Math.sin(l)*u,alpha:s.alpha})},interpolate:function(s,l,u){return{h:qd(s.h,l.h,u),c:mi(s.c,l.c,u),l:mi(s.l,l.l,u),alpha:mi(s.alpha,l.alpha,u)}}},pf=Object.freeze({__proto__:null,lab:Uu,hcl:us}),cn=function(s,l,u,m,y){this.type=s,this.operator=l,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(var b=0,E=y;b<E.length;b+=1){var S=E[b],k=S[1];this.labels.push(S[0]),this.outputs.push(k)}};function Fg(s,l,u,m){var y=m-u,b=s-u;return 0===y?0:1===l?b/y:(Math.pow(l,b)-1)/(Math.pow(l,y)-1)}cn.interpolationFactor=function(s,l,u,m){var y=0;if("exponential"===s.name)y=Fg(l,s.base,u,m);else if("linear"===s.name)y=Fg(l,1,u,m);else if("cubic-bezier"===s.name){var b=s.controlPoints;y=new He(b[0],b[1],b[2],b[3]).solve(Fg(l,1,u,m))}return y},cn.parse=function(s,l){var u=s[0],m=s[1],y=s[2],b=s.slice(3);if(!Array.isArray(m)||0===m.length)return l.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){var E=m[1];if("number"!=typeof E)return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:E}}else{if("cubic-bezier"!==m[0])return l.error("Unknown interpolation type "+String(m[0]),1,0);var S=m.slice(1);if(4!==S.length||S.some(function(pe){return"number"!=typeof pe||pe<0||pe>1}))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:S}}if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(!(y=l.parse(y,2,Fe)))return null;var k=[],M=null;"interpolate-hcl"===u||"interpolate-lab"===u?M=en:l.expectedType&&"value"!==l.expectedType.kind&&(M=l.expectedType);for(var P=0;P<b.length;P+=2){var L=b[P],z=b[P+1],G=P+3,te=P+4;if("number"!=typeof L)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(k.length&&k[k.length-1][0]>=L)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);var J=l.parse(z,te,M);if(!J)return null;M=M||J.type,k.push([L,J])}return"number"===M.kind||"color"===M.kind||"array"===M.kind&&"number"===M.itemType.kind&&"number"==typeof M.N?new cn(M,u,m,y,k):l.error("Type "+Un(M)+" is not interpolatable.")},cn.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;if(m>=l[y-1])return u[y-1].evaluate(s);var b=tc(l,m),E=cn.interpolationFactor(this.interpolation,m,l[b],l[b+1]),S=u[b].evaluate(s),k=u[b+1].evaluate(s);return"interpolate"===this.operator?Gp[this.type.kind.toLowerCase()](S,k,E):"interpolate-hcl"===this.operator?us.reverse(us.interpolate(us.forward(S),us.forward(k),E)):Uu.reverse(Uu.interpolate(Uu.forward(S),Uu.forward(k),E))},cn.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},cn.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},cn.prototype.serialize=function(){var s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var l=[this.operator,s,this.input.serialize()],u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l};var ai=function(s,l){this.type=s,this.args=l};ai.parse=function(s,l){if(s.length<2)return l.error("Expectected at least one argument.");var u=null,m=l.expectedType;m&&"value"!==m.kind&&(u=m);for(var y=[],b=0,E=s.slice(1);b<E.length;b+=1){var S=l.parse(E[b],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,y.push(S)}var k=m&&y.some(function(M){return Br(m,M.type)});return new ai(k?ue:u,y)},ai.prototype.evaluate=function(s){for(var l,u=null,m=0,y=0,b=this.args;y<b.length&&(m++,(u=b[y].evaluate(s))&&u instanceof kr&&!u.available&&(l||(l=u.name),u=null,m===this.args.length&&(u=l)),null===u);y+=1);return u},ai.prototype.eachChild=function(s){this.args.forEach(s)},ai.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},ai.prototype.serialize=function(){var s=["coalesce"];return this.eachChild(function(l){s.push(l.serialize())}),s};var lo=function(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l};lo.prototype.evaluate=function(s){return this.result.evaluate(s)},lo.prototype.eachChild=function(s){for(var l=0,u=this.bindings;l<u.length;l+=1)s(u[l][1]);s(this.result)},lo.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found "+(s.length-1)+" instead.");for(var u=[],m=1;m<s.length-1;m+=2){var y=s[m];if("string"!=typeof y)return l.error("Expected string, but found "+typeof y+" instead.",m);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",m);var b=l.parse(s[m+1],m+1);if(!b)return null;u.push([y,b])}var E=l.parse(s[s.length-1],s.length-1,l.expectedType,u);return E?new lo(u,E):null},lo.prototype.outputDefined=function(){return this.result.outputDefined()},lo.prototype.serialize=function(){for(var s=["let"],l=0,u=this.bindings;l<u.length;l+=1){var m=u[l];s.push(m[0],m[1].serialize())}return s.push(this.result.serialize()),s};var Fa=function(s,l,u){this.type=s,this.index=l,this.input=u};Fa.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,Fe),m=l.parse(s[2],2,Ir(l.expectedType||ue));return u&&m?new Fa(m.type.itemType,u,m):null},Fa.prototype.evaluate=function(s){var l=this.index.evaluate(s),u=this.input.evaluate(s);if(l<0)throw new Rr("Array index out of bounds: "+l+" < 0.");if(l>=u.length)throw new Rr("Array index out of bounds: "+l+" > "+(u.length-1)+".");if(l!==Math.floor(l))throw new Rr("Array index must be an integer, but found "+l+" instead.");return u[l]},Fa.prototype.eachChild=function(s){s(this.index),s(this.input)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ys=function(s,l){this.type=je,this.needle=s,this.haystack=l};Ys.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,ue);return u&&m?En(u.type,[je,rt,Fe,Et,ue])?new Ys(u,m):l.error("Expected first argument to be of type boolean, string, number or null, but found "+Un(u.type)+" instead"):null},Ys.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!u)return!1;if(!mn(l,["boolean","string","number","null"]))throw new Rr("Expected first argument to be of type boolean, string, number or null, but found "+Un(Hi(l))+" instead.");if(!mn(u,["string","array"]))throw new Rr("Expected second argument to be of type array or string, but found "+Un(Hi(u))+" instead.");return u.indexOf(l)>=0},Ys.prototype.eachChild=function(s){s(this.needle),s(this.haystack)},Ys.prototype.outputDefined=function(){return!0},Ys.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var nn=function(s,l,u){this.type=Fe,this.needle=s,this.haystack=l,this.fromIndex=u};nn.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,ue);if(!u||!m)return null;if(!En(u.type,[je,rt,Fe,Et,ue]))return l.error("Expected first argument to be of type boolean, string, number or null, but found "+Un(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Fe);return y?new nn(u,m,y):null}return new nn(u,m)},nn.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!mn(l,["boolean","string","number","null"]))throw new Rr("Expected first argument to be of type boolean, string, number or null, but found "+Un(Hi(l))+" instead.");if(!mn(u,["string","array"]))throw new Rr("Expected second argument to be of type array or string, but found "+Un(Hi(u))+" instead.");if(this.fromIndex){var m=this.fromIndex.evaluate(s);return u.indexOf(l,m)}return u.indexOf(l)},nn.prototype.eachChild=function(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)},nn.prototype.outputDefined=function(){return!1},nn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var In=function(s,l,u,m,y,b){this.inputType=s,this.type=l,this.input=u,this.cases=m,this.outputs=y,this.otherwise=b};In.parse=function(s,l){if(s.length<5)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if(s.length%2!=1)return l.error("Expected an even number of arguments.");var u,m;l.expectedType&&"value"!==l.expectedType.kind&&(m=l.expectedType);for(var y={},b=[],E=2;E<s.length-1;E+=2){var S=s[E],k=s[E+1];Array.isArray(S)||(S=[S]);var M=l.concat(E);if(0===S.length)return M.error("Expected at least one branch label.");for(var P=0,L=S;P<L.length;P+=1){var z=L[P];if("number"!=typeof z&&"string"!=typeof z)return M.error("Branch labels must be numbers or strings.");if("number"==typeof z&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return M.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof z&&Math.floor(z)!==z)return M.error("Numeric branch labels must be integer values.");if(u){if(M.checkSubtype(u,Hi(z)))return null}else u=Hi(z);if(void 0!==y[String(z)])return M.error("Branch labels must be unique.");y[String(z)]=b.length}var G=l.parse(k,E,m);if(!G)return null;m=m||G.type,b.push(G)}var te=l.parse(s[1],1,ue);if(!te)return null;var J=l.parse(s[s.length-1],s.length-1,m);return J?"value"!==te.type.kind&&l.concat(1).checkSubtype(u,te.type)?null:new In(u,m,te,y,b,J):null},In.prototype.evaluate=function(s){var l=this.input.evaluate(s);return(Hi(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)},In.prototype.eachChild=function(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)},In.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})&&this.otherwise.outputDefined()},In.prototype.serialize=function(){for(var s=this,l=["match",this.input.serialize()],u=[],m={},y=0,b=Object.keys(this.cases).sort();y<b.length;y+=1){var E=b[y];void 0===(L=m[this.cases[E]])?(m[this.cases[E]]=u.length,u.push([this.cases[E],[E]])):u[L][1].push(E)}for(var S=function(G){return"number"===s.inputType.kind?Number(G):G},k=0,M=u;k<M.length;k+=1){var P=M[k],L=P[0],z=P[1];l.push(1===z.length?S(z[0]):z.map(S)),l.push(this.outputs[outputIndex$1].serialize())}return l.push(this.otherwise.serialize()),l};var zu=function(s,l,u){this.type=s,this.branches=l,this.otherwise=u};zu.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found only "+(s.length-1)+".");if(s.length%2!=0)return l.error("Expected an odd number of arguments.");var u;l.expectedType&&"value"!==l.expectedType.kind&&(u=l.expectedType);for(var m=[],y=1;y<s.length-1;y+=2){var b=l.parse(s[y],y,je);if(!b)return null;var E=l.parse(s[y+1],y+1,u);if(!E)return null;m.push([b,E]),u=u||E.type}var S=l.parse(s[s.length-1],s.length-1,u);return S?new zu(u,m,S):null},zu.prototype.evaluate=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];if(m[0].evaluate(s))return y.evaluate(s)}return this.otherwise.evaluate(s)},zu.prototype.eachChild=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];s(m[0]),s(y)}s(this.otherwise)},zu.prototype.outputDefined=function(){return this.branches.every(function(s){return s[1].outputDefined()})&&this.otherwise.outputDefined()},zu.prototype.serialize=function(){var s=["case"];return this.eachChild(function(l){s.push(l.serialize())}),s};var rc=function(s,l,u,m){this.type=s,this.input=l,this.beginIndex=u,this.endIndex=m};function mf(s,l){return"=="===s||"!="===s?"boolean"===l.kind||"string"===l.kind||"number"===l.kind||"null"===l.kind||"value"===l.kind:"string"===l.kind||"number"===l.kind||"value"===l.kind}function xr(s,l,u,m){return 0===m.compare(l,u)}function Ba(s,l,u){var m="=="!==s&&"!="!==s;return function(){function y(b,E,S){this.type=je,this.lhs=b,this.rhs=E,this.collator=S,this.hasUntypedArgument="value"===b.type.kind||"value"===E.type.kind}return y.parse=function(b,E){if(3!==b.length&&4!==b.length)return E.error("Expected two or three arguments.");var S=b[0],k=E.parse(b[1],1,ue);if(!k)return null;if(!mf(S,k.type))return E.concat(1).error('"'+S+"\" comparisons are not supported for type '"+Un(k.type)+"'.");var M=E.parse(b[2],2,ue);if(!M)return null;if(!mf(S,M.type))return E.concat(2).error('"'+S+"\" comparisons are not supported for type '"+Un(M.type)+"'.");if(k.type.kind!==M.type.kind&&"value"!==k.type.kind&&"value"!==M.type.kind)return E.error("Cannot compare types '"+Un(k.type)+"' and '"+Un(M.type)+"'.");m&&("value"===k.type.kind&&"value"!==M.type.kind?k=new _o(M.type,[k]):"value"!==k.type.kind&&"value"===M.type.kind&&(M=new _o(k.type,[M])));var P=null;if(4===b.length){if("string"!==k.type.kind&&"string"!==M.type.kind&&"value"!==k.type.kind&&"value"!==M.type.kind)return E.error("Cannot use collator to compare non-string types.");if(!(P=E.parse(b[3],3,fr)))return null}return new y(k,M,P)},y.prototype.evaluate=function(b){var E=this.lhs.evaluate(b),S=this.rhs.evaluate(b);if(m&&this.hasUntypedArgument){var k=Hi(E),M=Hi(S);if(k.kind!==M.kind||"string"!==k.kind&&"number"!==k.kind)throw new Rr('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+k.kind+", "+M.kind+") instead.")}if(this.collator&&!m&&this.hasUntypedArgument){var P=Hi(E),L=Hi(S);if("string"!==P.kind||"string"!==L.kind)return l(b,E,S)}return this.collator?u(b,E,S,this.collator.evaluate(b)):l(b,E,S)},y.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var b=[s];return this.eachChild(function(E){b.push(E.serialize())}),b},y}()}rc.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,Fe);if(!u||!m)return null;if(!En(u.type,[Ir(ue),rt,ue]))return l.error("Expected first argument to be of type array or string, but found "+Un(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Fe);return y?new rc(u.type,u,m,y):null}return new rc(u.type,u,m)},rc.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=this.beginIndex.evaluate(s);if(!mn(l,["string","array"]))throw new Rr("Expected first argument to be of type array or string, but found "+Un(Hi(l))+" instead.");if(this.endIndex){var m=this.endIndex.evaluate(s);return l.slice(u,m)}return l.slice(u)},rc.prototype.eachChild=function(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)},rc.prototype.outputDefined=function(){return!1},rc.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var ju=Ba("==",function(s,l,u){return l===u},xr),iv=Ba("!=",function(s,l,u){return l!==u},function(s,l,u,m){return!xr(0,l,u,m)}),ov=Ba("<",function(s,l,u){return l<u},function(s,l,u,m){return m.compare(l,u)<0}),Bg=Ba(">",function(s,l,u){return l>u},function(s,l,u,m){return m.compare(l,u)>0}),gf=Ba("<=",function(s,l,u){return l<=u},function(s,l,u,m){return m.compare(l,u)<=0}),Fw=Ba(">=",function(s,l,u){return l>=u},function(s,l,u,m){return m.compare(l,u)>=0}),ic=function(s,l,u,m,y){this.type=rt,this.number=s,this.locale=l,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=y};ic.parse=function(s,l){if(3!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,Fe);if(!u)return null;var m=s[2];if("object"!=typeof m||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");var y=null;if(m.locale&&!(y=l.parse(m.locale,1,rt)))return null;var b=null;if(m.currency&&!(b=l.parse(m.currency,1,rt)))return null;var E=null;if(m["min-fraction-digits"]&&!(E=l.parse(m["min-fraction-digits"],1,Fe)))return null;var S=null;return m["max-fraction-digits"]&&!(S=l.parse(m["max-fraction-digits"],1,Fe))?null:new ic(u,y,b,E,S)},ic.prototype.evaluate=function(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))},ic.prototype.eachChild=function(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)},ic.prototype.outputDefined=function(){return!1},ic.prototype.serialize=function(){var s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]};var vl=function(s){this.type=Fe,this.input=s};vl.parse=function(s,l){if(2!==s.length)return l.error("Expected 1 argument, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?l.error("Expected argument of type string or array, but found "+Un(u.type)+" instead."):new vl(u):null},vl.prototype.evaluate=function(s){var l=this.input.evaluate(s);if("string"==typeof l||Array.isArray(l))return l.length;throw new Rr("Expected value to be of type string or array, but found "+Un(Hi(l))+" instead.")},vl.prototype.eachChild=function(s){s(this.input)},vl.prototype.outputDefined=function(){return!1},vl.prototype.serialize=function(){var s=["length"];return this.eachChild(function(l){s.push(l.serialize())}),s};var Hu={"==":ju,"!=":iv,">":Bg,"<":ov,">=":Fw,"<=":gf,array:_o,at:Fa,boolean:_o,case:zu,coalesce:ai,collator:Si,format:cs,image:Xl,in:Ys,"index-of":nn,interpolate:cn,"interpolate-hcl":cn,"interpolate-lab":cn,length:vl,let:lo,literal:la,match:In,number:_o,"number-format":ic,object:_o,slice:rc,step:La,string:_o,"to-boolean":ca,"to-color":ca,"to-number":ca,"to-string":ca,var:ec,within:ao};function Vg(s,l){var u=l[0],m=l[1],y=l[2],b=l[3];u=u.evaluate(s),m=m.evaluate(s),y=y.evaluate(s);var E=b?b.evaluate(s):1,S=Og(u,m,y,E);if(S)throw new Rr(S);return new wn(u/255*E,m/255*E,y/255*E,E)}function _f(s,l){return s in l}function yf(s,l){var u=l[s];return void 0===u?null:u}function Ii(s){return{type:s}}function vf(s){return{result:"success",value:s}}function $u(s){return{result:"error",value:s}}function Gd(s){return"data-driven"===s["property-type"]||"cross-faded-data-driven"===s["property-type"]}function Va(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Wd(s){return!!s.expression&&s.expression.interpolated}function br(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function bf(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function Tt(s){return s}function Zc(s,l,u){return void 0!==s?s:void 0!==l?l:void 0!==u?u:void 0}function Q(s,l,u,m,y){return Zc(typeof u===y?m[u]:void 0,s.default,l.default)}function Zd(s,l,u){if("number"!==br(u))return Zc(s.default,l.default);var m=s.stops.length;if(1===m||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[m-1][0])return s.stops[m-1][1];var y=tc(s.stops.map(function(b){return b[0]}),u);return s.stops[y][1]}function Kd(s,l,u){var m=void 0!==s.base?s.base:1;if("number"!==br(u))return Zc(s.default,l.default);var y=s.stops.length;if(1===y||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[y-1][0])return s.stops[y-1][1];var z,G,J,pe,b=tc(s.stops.map(function(L){return L[0]}),u),E=(z=m,pe=u-(G=s.stops[b][0]),0===(J=s.stops[b+1][0]-G)?0:1===z?pe/J:(Math.pow(z,pe)-1)/(Math.pow(z,J)-1)),S=s.stops[b][1],k=s.stops[b+1][1],M=Gp[l.type]||Tt;if(s.colorSpace&&"rgb"!==s.colorSpace){var P=pf[s.colorSpace];M=function(L,z){return P.reverse(P.interpolate(P.forward(L),P.forward(z),E))}}return"function"==typeof S.evaluate?{evaluate:function(){for(var L=[],z=arguments.length;z--;)L[z]=arguments[z];var G=S.evaluate.apply(void 0,L),te=k.evaluate.apply(void 0,L);if(void 0!==G&&void 0!==te)return M(G,te,E)}}:M(S,k,E)}function wf(s,l,u){return"color"===l.type?u=wn.parse(u):"formatted"===l.type?u=si.fromString(u.toString()):"resolvedImage"===l.type?u=kr.fromString(u.toString()):br(u)===l.type||"enum"===l.type&&l.values[u]||(u=void 0),Zc(u,s.default,l.default)}so.register(Hu,{error:[{kind:"error"},[rt],function(s,l){throw new Rr(l[0].evaluate(s))}],typeof:[rt,[ue],function(s,l){return Un(Hi(l[0].evaluate(s)))}],"to-rgba":[Ir(Fe,4),[en],function(s,l){return l[0].evaluate(s).toArray()}],rgb:[en,[Fe,Fe,Fe],Vg],rgba:[en,[Fe,Fe,Fe,Fe],Vg],has:{type:je,overloads:[[[rt],function(s,l){return _f(l[0].evaluate(s),s.properties())}],[[rt,tn],function(s,l){var u=l[1];return _f(l[0].evaluate(s),u.evaluate(s))}]]},get:{type:ue,overloads:[[[rt],function(s,l){return yf(l[0].evaluate(s),s.properties())}],[[rt,tn],function(s,l){var u=l[1];return yf(l[0].evaluate(s),u.evaluate(s))}]]},"feature-state":[ue,[rt],function(s,l){return yf(l[0].evaluate(s),s.featureState||{})}],properties:[tn,[],function(s){return s.properties()}],"geometry-type":[rt,[],function(s){return s.geometryType()}],id:[ue,[],function(s){return s.id()}],zoom:[Fe,[],function(s){return s.globals.zoom}],"heatmap-density":[Fe,[],function(s){return s.globals.heatmapDensity||0}],"line-progress":[Fe,[],function(s){return s.globals.lineProgress||0}],accumulated:[ue,[],function(s){return void 0===s.globals.accumulated?null:s.globals.accumulated}],"+":[Fe,Ii(Fe),function(s,l){for(var u=0,m=0,y=l;m<y.length;m+=1)u+=y[m].evaluate(s);return u}],"*":[Fe,Ii(Fe),function(s,l){for(var u=1,m=0,y=l;m<y.length;m+=1)u*=y[m].evaluate(s);return u}],"-":{type:Fe,overloads:[[[Fe,Fe],function(s,l){var u=l[1];return l[0].evaluate(s)-u.evaluate(s)}],[[Fe],function(s,l){return-l[0].evaluate(s)}]]},"/":[Fe,[Fe,Fe],function(s,l){var u=l[1];return l[0].evaluate(s)/u.evaluate(s)}],"%":[Fe,[Fe,Fe],function(s,l){var u=l[1];return l[0].evaluate(s)%u.evaluate(s)}],ln2:[Fe,[],function(){return Math.LN2}],pi:[Fe,[],function(){return Math.PI}],e:[Fe,[],function(){return Math.E}],"^":[Fe,[Fe,Fe],function(s,l){var u=l[1];return Math.pow(l[0].evaluate(s),u.evaluate(s))}],sqrt:[Fe,[Fe],function(s,l){return Math.sqrt(l[0].evaluate(s))}],log10:[Fe,[Fe],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN10}],ln:[Fe,[Fe],function(s,l){return Math.log(l[0].evaluate(s))}],log2:[Fe,[Fe],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN2}],sin:[Fe,[Fe],function(s,l){return Math.sin(l[0].evaluate(s))}],cos:[Fe,[Fe],function(s,l){return Math.cos(l[0].evaluate(s))}],tan:[Fe,[Fe],function(s,l){return Math.tan(l[0].evaluate(s))}],asin:[Fe,[Fe],function(s,l){return Math.asin(l[0].evaluate(s))}],acos:[Fe,[Fe],function(s,l){return Math.acos(l[0].evaluate(s))}],atan:[Fe,[Fe],function(s,l){return Math.atan(l[0].evaluate(s))}],min:[Fe,Ii(Fe),function(s,l){return Math.min.apply(Math,l.map(function(u){return u.evaluate(s)}))}],max:[Fe,Ii(Fe),function(s,l){return Math.max.apply(Math,l.map(function(u){return u.evaluate(s)}))}],abs:[Fe,[Fe],function(s,l){return Math.abs(l[0].evaluate(s))}],round:[Fe,[Fe],function(s,l){var u=l[0].evaluate(s);return u<0?-Math.round(-u):Math.round(u)}],floor:[Fe,[Fe],function(s,l){return Math.floor(l[0].evaluate(s))}],ceil:[Fe,[Fe],function(s,l){return Math.ceil(l[0].evaluate(s))}],"filter-==":[je,[rt,ue],function(s,l){var u=l[0],m=l[1];return s.properties()[u.value]===m.value}],"filter-id-==":[je,[ue],function(s,l){var u=l[0];return s.id()===u.value}],"filter-type-==":[je,[rt],function(s,l){var u=l[0];return s.geometryType()===u.value}],"filter-<":[je,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<b}],"filter-id-<":[je,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<y}],"filter->":[je,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>b}],"filter-id->":[je,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>y}],"filter-<=":[je,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<=b}],"filter-id-<=":[je,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<=y}],"filter->=":[je,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>=b}],"filter-id->=":[je,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>=y}],"filter-has":[je,[ue],function(s,l){return l[0].value in s.properties()}],"filter-has-id":[je,[],function(s){return null!==s.id()&&void 0!==s.id()}],"filter-type-in":[je,[Ir(rt)],function(s,l){return l[0].value.indexOf(s.geometryType())>=0}],"filter-id-in":[je,[Ir(ue)],function(s,l){return l[0].value.indexOf(s.id())>=0}],"filter-in-small":[je,[rt,Ir(ue)],function(s,l){var u=l[0];return l[1].value.indexOf(s.properties()[u.value])>=0}],"filter-in-large":[je,[rt,Ir(ue)],function(s,l){var u=l[0],m=l[1];return function(y,b,E,S){for(;E<=S;){var k=E+S>>1;if(b[k]===y)return!0;b[k]>y?S=k-1:E=k+1}return!1}(s.properties()[u.value],m.value,0,m.value.length-1)}],all:{type:je,overloads:[[[je,je],function(s,l){var u=l[1];return l[0].evaluate(s)&&u.evaluate(s)}],[Ii(je),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(!m[u].evaluate(s))return!1;return!0}]]},any:{type:je,overloads:[[[je,je],function(s,l){var u=l[1];return l[0].evaluate(s)||u.evaluate(s)}],[Ii(je),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(m[u].evaluate(s))return!0;return!1}]]},"!":[je,[je],function(s,l){return!l[0].evaluate(s)}],"is-supported-script":[je,[rt],function(s,l){var u=s.globals&&s.globals.isSupportedScript;return!u||u(l[0].evaluate(s))}],upcase:[rt,[rt],function(s,l){return l[0].evaluate(s).toUpperCase()}],downcase:[rt,[rt],function(s,l){return l[0].evaluate(s).toLowerCase()}],concat:[rt,Ii(ue),function(s,l){return l.map(function(u){return Bo(u.evaluate(s))}).join("")}],"resolved-locale":[rt,[fr],function(s,l){return l[0].evaluate(s).resolvedLocale()}]});var Ua=function(s,l){var u;this.expression=s,this._warningHistory={},this._evaluator=new Rt,this._defaultValue=l?"color"===(u=l).type&&bf(u.default)?new wn(0,0,0,0):"color"===u.type?wn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=l&&"enum"===l.type?l.values:null};function xf(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in Hu}function za(s,l){var y,b,u=new Os(Hu,[],l?(b={color:en,string:rt,number:Fe,enum:rt,boolean:je,formatted:Ht,resolvedImage:ln},"array"===(y=l).type?Ir(b[y.value]||ue,y.length):b[y.type]):void 0),m=u.parse(s,void 0,void 0,void 0,l&&"string"===l.type?{typeAnnotation:"coerce"}:void 0);return m?vf(new Ua(m,l)):$u(u.errors)}Ua.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},Ua.prototype.evaluate=function(s,l,u,m,y,b){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{var E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Rr("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(E)+" instead.");return E}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var Yd=function(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent="constant"!==s&&!Jl(l.expression)};Yd.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},Yd.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)};var vo=function(s,l,u,m){this.kind=s,this.zoomStops=u,this._styleExpression=l,this.isStateDependent="camera"!==s&&!Jl(l.expression),this.interpolationType=m};function oc(s,l){if("error"===(s=za(s,l)).result)return s;var u=s.value.expression,m=Ns(u);if(!m&&!Gd(l))return $u([new ht("","data expressions not supported")]);var y=hf(u,["zoom"]);if(!y&&!Va(l))return $u([new ht("","zoom expressions not supported")]);var b=function E(S){var k=null;if(S instanceof lo)k=E(S.result);else if(S instanceof ai)for(var M=0,P=S.args;M<P.length&&!(k=E(P[M]));M+=1);else(S instanceof La||S instanceof cn)&&S.input instanceof so&&"zoom"===S.input.name&&(k=S);return k instanceof ht||S.eachChild(function(L){var z=E(L);z instanceof ht?k=z:!k&&z?k=new ht("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):k&&z&&k!==z&&(k=new ht("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),k}(u);return b||y?b instanceof ht?$u([b]):b instanceof cn&&!Wd(l)?$u([new ht("",'"interpolate" expressions cannot be used with this property')]):vf(b?new vo(m?"camera":"composite",s.value,b.labels,b instanceof cn?b.interpolation:void 0):new Yd(m?"constant":"source",s.value)):$u([new ht("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}vo.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},vo.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)},vo.prototype.interpolationFactor=function(s,l,u){return this.interpolationType?cn.interpolationFactor(this.interpolationType,s,l,u):0};var qu=function(s,l){this._parameters=s,this._specification=l,Je(this,function u(m,y){var b,E,S,k="color"===y.type,M=m.stops&&"object"==typeof m.stops[0][0],P=M||!(M||void 0!==m.property),L=m.type||(Wd(y)?"exponential":"interval");if(k&&((m=Je({},m)).stops&&(m.stops=m.stops.map(function(it){return[it[0],wn.parse(it[1])]})),m.default=wn.parse(m.default?m.default:y.default)),m.colorSpace&&"rgb"!==m.colorSpace&&!pf[m.colorSpace])throw new Error("Unknown color space: "+m.colorSpace);if("exponential"===L)b=Kd;else if("interval"===L)b=Zd;else if("categorical"===L){b=Q,E=Object.create(null);for(var z=0,G=m.stops;z<G.length;z+=1){var te=G[z];E[te[0]]=te[1]}S=typeof m.stops[0][0]}else{if("identity"!==L)throw new Error('Unknown function type "'+L+'"');b=wf}if(M){for(var J={},pe=[],he=0;he<m.stops.length;he++){var be=m.stops[he],ve=be[0].zoom;void 0===J[ve]&&(J[ve]={zoom:ve,type:m.type,property:m.property,default:m.default,stops:[]},pe.push(ve)),J[ve].stops.push([be[0].value,be[1]])}for(var Ie=[],ke=0,Be=pe;ke<Be.length;ke+=1){var Ye=Be[ke];Ie.push([J[Ye].zoom,u(J[Ye],y)])}var nt={name:"linear"};return{kind:"composite",interpolationType:nt,interpolationFactor:cn.interpolationFactor.bind(void 0,nt),zoomStops:Ie.map(function(it){return it[0]}),evaluate:function(it,At){var at=it.zoom;return Kd({stops:Ie,base:m.base},y,at).evaluate(at,At)}}}if(P){var wt="exponential"===L?{name:"exponential",base:void 0!==m.base?m.base:1}:null;return{kind:"camera",interpolationType:wt,interpolationFactor:cn.interpolationFactor.bind(void 0,wt),zoomStops:m.stops.map(function(it){return it[0]}),evaluate:function(it){return b(m,y,it.zoom,E,S)}}}return{kind:"source",evaluate:function(it,At){var at=At&&At.properties?At.properties[m.property]:void 0;return void 0===at?Zc(m.default,y.default):b(m,y,at,E,S)}}}(this._parameters,this._specification))};function ds(s){var l=s.key,u=s.value,m=s.valueSpec||{},y=s.objectElementValidators||{},b=s.style,E=s.styleSpec,S=[],k=br(u);if("object"!==k)return[new ae(l,u,"object expected, "+k+" found")];for(var M in u){var P=M.split(".")[0],L=m[P]||m["*"],z=void 0;if(y[P])z=y[P];else if(m[P])z=kn;else if(y["*"])z=y["*"];else{if(!m["*"]){S.push(new ae(l,u[M],'unknown property "'+M+'"'));continue}z=kn}S=S.concat(z({key:(l&&l+".")+M,value:u[M],valueSpec:L,style:b,styleSpec:E,object:u,objectKey:M},u))}for(var G in m)y[G]||m[G].required&&void 0===m[G].default&&void 0===u[G]&&S.push(new ae(l,u,'missing required property "'+G+'"'));return S}function Xd(s){var l=s.value,u=s.valueSpec,m=s.style,y=s.styleSpec,b=s.key,E=s.arrayElementValidator||kn;if("array"!==br(l))return[new ae(b,l,"array expected, "+br(l)+" found")];if(u.length&&l.length!==u.length)return[new ae(b,l,"array length "+u.length+" expected, length "+l.length+" found")];if(u["min-length"]&&l.length<u["min-length"])return[new ae(b,l,"array length at least "+u["min-length"]+" expected, length "+l.length+" found")];var S={type:u.value,values:u.values};y.$version<7&&(S.function=u.function),"object"===br(u.value)&&(S=u.value);for(var k=[],M=0;M<l.length;M++)k=k.concat(E({array:l,arrayIndex:M,value:l[M],valueSpec:S,style:m,styleSpec:y,key:b+"["+M+"]"}));return k}function Yp(s){var l=s.key,u=s.value,m=s.valueSpec,y=br(u);return"number"===y&&u!=u&&(y="NaN"),"number"!==y?[new ae(l,u,"number expected, "+y+" found")]:"minimum"in m&&u<m.minimum?[new ae(l,u,u+" is less than the minimum value "+m.minimum)]:"maximum"in m&&u>m.maximum?[new ae(l,u,u+" is greater than the maximum value "+m.maximum)]:[]}function Ef(s){var l,u,m,y=s.valueSpec,b=Te(s.value.type),E={},S="categorical"!==b&&void 0===s.value.property,k=!S,M="array"===br(s.value.stops)&&"array"===br(s.value.stops[0])&&"object"===br(s.value.stops[0][0]),P=ds({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(G){if("identity"===b)return[new ae(G.key,G.value,'identity function may not have a "stops" property')];var te=[],J=G.value;return te=te.concat(Xd({key:G.key,value:J,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:L})),"array"===br(J)&&0===J.length&&te.push(new ae(G.key,J,"array must have at least one stop")),te},default:function(G){return kn({key:G.key,value:G.value,valueSpec:y,style:G.style,styleSpec:G.styleSpec})}}});return"identity"===b&&S&&P.push(new ae(s.key,s.value,'missing required property "property"')),"identity"===b||s.value.stops||P.push(new ae(s.key,s.value,'missing required property "stops"')),"exponential"===b&&s.valueSpec.expression&&!Wd(s.valueSpec)&&P.push(new ae(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(k&&!Gd(s.valueSpec)?P.push(new ae(s.key,s.value,"property functions not supported")):S&&!Va(s.valueSpec)&&P.push(new ae(s.key,s.value,"zoom functions not supported"))),"categorical"!==b&&!M||void 0!==s.value.property||P.push(new ae(s.key,s.value,'"property" property is required')),P;function L(G){var te=[],J=G.value,pe=G.key;if("array"!==br(J))return[new ae(pe,J,"array expected, "+br(J)+" found")];if(2!==J.length)return[new ae(pe,J,"array length 2 expected, length "+J.length+" found")];if(M){if("object"!==br(J[0]))return[new ae(pe,J,"object expected, "+br(J[0])+" found")];if(void 0===J[0].zoom)return[new ae(pe,J,"object stop key must have zoom")];if(void 0===J[0].value)return[new ae(pe,J,"object stop key must have value")];if(m&&m>Te(J[0].zoom))return[new ae(pe,J[0].zoom,"stop zoom values must appear in ascending order")];Te(J[0].zoom)!==m&&(m=Te(J[0].zoom),u=void 0,E={}),te=te.concat(ds({key:pe+"[0]",value:J[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:Yp,value:z}}))}else te=te.concat(z({key:pe+"[0]",value:J[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},J));return xf(Ge(J[1]))?te.concat([new ae(pe+"[1]",J[1],"expressions are not allowed in function stops.")]):te.concat(kn({key:pe+"[1]",value:J[1],valueSpec:y,style:G.style,styleSpec:G.styleSpec}))}function z(G,te){var J=br(G.value),pe=Te(G.value),he=null!==G.value?G.value:te;if(l){if(J!==l)return[new ae(G.key,he,J+" stop domain type must match previous stop domain type "+l)]}else l=J;if("number"!==J&&"string"!==J&&"boolean"!==J)return[new ae(G.key,he,"stop domain value must be a number, string, or boolean")];if("number"!==J&&"categorical"!==b){var be="number expected, "+J+" found";return Gd(y)&&void 0===b&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ae(G.key,he,be)]}return"categorical"!==b||"number"!==J||isFinite(pe)&&Math.floor(pe)===pe?"categorical"!==b&&"number"===J&&void 0!==u&&pe<u?[new ae(G.key,he,"stop domain values must appear in ascending order")]:(u=pe,"categorical"===b&&pe in E?[new ae(G.key,he,"stop domain values must be unique")]:(E[pe]=!0,[])):[new ae(G.key,he,"integer expected, found "+pe)]}}function ja(s){var l=("property"===s.expressionContext?oc:za)(Ge(s.value),s.valueSpec);if("error"===l.result)return l.value.map(function(m){return new ae(""+s.key+m.key,s.value,m.message)});var u=l.value.expression||l.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!u.outputDefined())return[new ae(s.key,s.value,'Invalid data expression for "'+s.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===s.expressionContext&&"layout"===s.propertyType&&!Jl(u))return[new ae(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext&&!Jl(u))return[new ae(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!hf(u,["zoom","feature-state"]))return[new ae(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!Ns(u))return[new ae(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Kc(s){var l=s.key,u=s.value,m=s.valueSpec,y=[];return Array.isArray(m.values)?-1===m.values.indexOf(Te(u))&&y.push(new ae(l,u,"expected one of ["+m.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(m.values).indexOf(Te(u))&&y.push(new ae(l,u,"expected one of ["+Object.keys(m.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function bl(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(var l=0,u=s.slice(1);l<u.length;l+=1){var m=u[l];if(!bl(m)&&"boolean"!=typeof m)return!1}return!0;default:return!0}}qu.deserialize=function(s){return new qu(s._parameters,s._specification)},qu.serialize=function(s){return{_parameters:s._parameters,_specification:s._specification}};var sv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ls(s){if(null==s)return{filter:function(){return!0},needGeometry:!1};bl(s)||(s=Xs(s));var l=za(s,sv);if("error"===l.result)throw new Error(l.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,m,y){return l.value.evaluate(u,m,{},y)},needGeometry:function u(m){if(!Array.isArray(m))return!1;if("within"===m[0])return!0;for(var y=1;y<m.length;y++)if(u(m[y]))return!0;return!1}(s)}}function Pr(s,l){return s<l?-1:s>l?1:0}function Xs(s){if(!s)return!0;var l,u=s[0];return s.length<=1?"any"!==u:"=="===u?Cf(s[1],s[2],"=="):"!="===u?Ha(Cf(s[1],s[2],"==")):"<"===u||">"===u||"<="===u||">="===u?Cf(s[1],s[2],u):"any"===u?(l=s.slice(1),["any"].concat(l.map(Xs))):"all"===u?["all"].concat(s.slice(1).map(Xs)):"none"===u?["all"].concat(s.slice(1).map(Xs).map(Ha)):"in"===u?Df(s[1],s.slice(2)):"!in"===u?Ha(Df(s[1],s.slice(2))):"has"===u?Qd(s[1]):"!has"===u?Ha(Qd(s[1])):"within"!==u||s}function Cf(s,l,u){switch(s){case"$type":return["filter-type-"+u,l];case"$id":return["filter-id-"+u,l];default:return["filter-"+u,s,l]}}function Df(s,l){if(0===l.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(function(u){return typeof u!=typeof l[0]})?["filter-in-large",s,["literal",l.sort(Pr)]]:["filter-in-small",s,["literal",l]]}}function Qd(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Ha(s){return["!",s]}function Tf(s){return bl(Ge(s.value))?ja(Je({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(u){var m=u.value,y=u.key;if("array"!==br(m))return[new ae(y,m,"array expected, "+br(m)+" found")];var b,E=u.styleSpec,S=[];if(m.length<1)return[new ae(y,m,"filter array must have at least 1 element")];switch(S=S.concat(Kc({key:y+"[0]",value:m[0],valueSpec:E.filter_operator,style:u.style,styleSpec:u.styleSpec})),Te(m[0])){case"<":case"<=":case">":case">=":m.length>=2&&"$type"===Te(m[1])&&S.push(new ae(y,m,'"$type" cannot be use with operator "'+m[0]+'"'));case"==":case"!=":3!==m.length&&S.push(new ae(y,m,'filter array for operator "'+m[0]+'" must have 3 elements'));case"in":case"!in":m.length>=2&&"string"!==(b=br(m[1]))&&S.push(new ae(y+"[1]",m[1],"string expected, "+b+" found"));for(var k=2;k<m.length;k++)b=br(m[k]),"$type"===Te(m[1])?S=S.concat(Kc({key:y+"["+k+"]",value:m[k],valueSpec:E.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==b&&"number"!==b&&"boolean"!==b&&S.push(new ae(y+"["+k+"]",m[k],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var M=1;M<m.length;M++)S=S.concat(l({key:y+"["+M+"]",value:m[M],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=br(m[1]),2!==m.length?S.push(new ae(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"string"!==b&&S.push(new ae(y+"[1]",m[1],"string expected, "+b+" found"));break;case"within":b=br(m[1]),2!==m.length?S.push(new ae(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"object"!==b&&S.push(new ae(y+"[1]",m[1],"object expected, "+b+" found"))}return S}(s)}function Sf(s,l){var u=s.key,m=s.style,y=s.styleSpec,b=s.value,E=s.objectKey,S=y[l+"_"+s.layerType];if(!S)return[];var k=E.match(/^(.*)-transition$/);if("paint"===l&&k&&S[k[1]]&&S[k[1]].transition)return kn({key:u,value:b,valueSpec:y.transition,style:m,styleSpec:y});var M,P=s.valueSpec||S[E];if(!P)return[new ae(u,b,'unknown property "'+E+'"')];if("string"===br(b)&&Gd(P)&&!P.tokens&&(M=/^{([^}]+)}$/.exec(b)))return[new ae(u,b,'"'+E+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(M[1])+" }`.")];var L=[];return"symbol"===s.layerType&&("text-field"===E&&m&&!m.glyphs&&L.push(new ae(u,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&bf(Ge(b))&&"identity"===Te(b.type)&&L.push(new ae(u,b,'"text-font" does not support identity functions'))),L.concat(kn({key:s.key,value:b,valueSpec:P,style:m,styleSpec:y,expressionContext:"property",propertyType:l,propertyKey:E}))}function Yc(s){return Sf(s,"paint")}function Xp(s){return Sf(s,"layout")}function Gu(s){var l=[],u=s.value,m=s.key,y=s.style,b=s.styleSpec;u.type||u.ref||l.push(new ae(m,u,'either "type" or "ref" is required'));var E,S=Te(u.type),k=Te(u.ref);if(u.id)for(var M=Te(u.id),P=0;P<s.arrayIndex;P++){var L=y.layers[P];Te(L.id)===M&&l.push(new ae(m,u.id,'duplicate layer id "'+u.id+'", previously used at line '+L.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(te){te in u&&l.push(new ae(m,u[te],'"'+te+'" is prohibited for ref layers'))}),y.layers.forEach(function(te){Te(te.id)===k&&(E=te)}),E?E.ref?l.push(new ae(m,u.ref,"ref cannot reference another ref layer")):S=Te(E.type):l.push(new ae(m,u.ref,'ref layer "'+k+'" not found'));else if("background"!==S)if(u.source){var z=y.sources&&y.sources[u.source],G=z&&Te(z.type);z?"vector"===G&&"raster"===S?l.push(new ae(m,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===G&&"raster"!==S?l.push(new ae(m,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==G||u["source-layer"]?"raster-dem"===G&&"hillshade"!==S?l.push(new ae(m,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==S||!u.paint||!u.paint["line-gradient"]||"geojson"===G&&z.lineMetrics||l.push(new ae(m,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):l.push(new ae(m,u,'layer "'+u.id+'" must specify a "source-layer"')):l.push(new ae(m,u.source,'source "'+u.source+'" not found'))}else l.push(new ae(m,u,'missing required property "source"'));return l=l.concat(ds({key:m,value:u,valueSpec:b.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:m+".type",value:u.type,valueSpec:b.layer.type,style:s.style,styleSpec:s.styleSpec,object:u,objectKey:"type"})},filter:Tf,layout:function(te){return ds({layer:u,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(J){return Xp(Je({layerType:S},J))}}})},paint:function(te){return ds({layer:u,key:te.key,value:te.value,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{"*":function(J){return Yc(Je({layerType:S},J))}}})}}}))}function pr(s){var l=s.value,u=s.key,m=br(l);return"string"!==m?[new ae(u,l,"string expected, "+m+" found")]:[]}var Wu={promoteId:function(s){var l=s.key,u=s.value;if("string"===br(u))return pr({key:l,value:u});var m=[];for(var y in u)m.push.apply(m,pr({key:l+"."+y,value:u[y]}));return m}};function Xc(s){var l=s.value,u=s.key,m=s.styleSpec,y=s.style;if(!l.type)return[new ae(u,l,'"type" is required')];var b,E=Te(l.type);switch(E){case"vector":case"raster":case"raster-dem":return ds({key:u,value:l,valueSpec:m["source_"+E.replace("-","_")],style:s.style,styleSpec:m,objectElementValidators:Wu});case"geojson":if(b=ds({key:u,value:l,valueSpec:m.source_geojson,style:y,styleSpec:m,objectElementValidators:Wu}),l.cluster)for(var S in l.clusterProperties){var k=l.clusterProperties[S],M=k[0],P="string"==typeof M?[M,["accumulated"],["get",S]]:M;b.push.apply(b,ja({key:u+"."+S+".map",value:k[1],expressionContext:"cluster-map"})),b.push.apply(b,ja({key:u+"."+S+".reduce",value:P,expressionContext:"cluster-reduce"}))}return b;case"video":return ds({key:u,value:l,valueSpec:m.source_video,style:y,styleSpec:m});case"image":return ds({key:u,value:l,valueSpec:m.source_image,style:y,styleSpec:m});case"canvas":return[new ae(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Kc({key:u+".type",value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:m})}}function $a(s){var l=s.value,u=s.styleSpec,m=u.light,y=s.style,b=[],E=br(l);if(void 0===l)return b;if("object"!==E)return b.concat([new ae("light",l,"object expected, "+E+" found")]);for(var S in l){var k=S.match(/^(.*)-transition$/);b=b.concat(k&&m[k[1]]&&m[k[1]].transition?kn({key:S,value:l[S],valueSpec:u.transition,style:y,styleSpec:u}):m[S]?kn({key:S,value:l[S],valueSpec:m[S],style:y,styleSpec:u}):[new ae(S,l[S],'unknown property "'+S+'"')])}return b}var er={"*":function(){return[]},array:Xd,boolean:function(s){var l=s.value,u=s.key,m=br(l);return"boolean"!==m?[new ae(u,l,"boolean expected, "+m+" found")]:[]},number:Yp,color:function(s){var l=s.key,u=s.value,m=br(u);return"string"!==m?[new ae(l,u,"color expected, "+m+" found")]:null===Hd(u)?[new ae(l,u,'color expected, "'+u+'" found')]:[]},constants:qe,enum:Kc,filter:Tf,function:Ef,layer:Gu,object:ds,source:Xc,light:$a,string:pr,formatted:function(s){return 0===pr(s).length?[]:ja(s)},resolvedImage:function(s){return 0===pr(s).length?[]:ja(s)}};function kn(s){var l=s.value,u=s.valueSpec,m=s.styleSpec;return u.expression&&bf(Te(l))?Ef(s):u.expression&&xf(Ge(l))?ja(s):u.type&&er[u.type]?er[u.type](s):ds(Je({},s,{valueSpec:u.type?m[u.type]:u}))}function Jo(s){var l=s.value,u=s.key,m=pr(s);return m.length||(-1===l.indexOf("{fontstack}")&&m.push(new ae(u,l,'"glyphs" url must include a "{fontstack}" token')),-1===l.indexOf("{range}")&&m.push(new ae(u,l,'"glyphs" url must include a "{range}" token'))),m}function ua(s,l){void 0===l&&(l=X);var u=[];return u=u.concat(kn({key:"",value:s,valueSpec:l.$root,styleSpec:l,style:s,objectElementValidators:{glyphs:Jo,"*":function(){return[]}}})),s.constants&&(u=u.concat(qe({key:"constants",value:s.constants,style:s,styleSpec:l}))),If(u)}function If(s){return[].concat(s).sort(function(l,u){return l.line-u.line})}function wl(s){return function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];return If(s.apply(this,l))}}ua.source=wl(Xc),ua.light=wl($a),ua.layer=wl(Gu),ua.filter=wl(Tf),ua.paintProperty=wl(Yc),ua.layoutProperty=wl(Xp);var Zu=ua,Qp=Zu.light,sc=Zu.paintProperty,$r=Zu.layoutProperty;function da(s,l){var u=!1;if(l&&l.length)for(var m=0,y=l;m<y.length;m+=1)s.fire(new ye(new Error(y[m].message))),u=!0;return u}var $i=Fs;function Fs(s,l,u){var m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var y=new Int32Array(this.arrayBuffer);s=y[0],this.d=(l=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var E=y[3+b],S=y[3+b+1];m.push(E===S?null:y.subarray(E,S))}var k=y[3+m.length+1];this.keys=y.subarray(y[3+m.length],k),this.bboxes=y.subarray(k),this.insert=this._insertReadonly}else{this.d=l+2*u;for(var M=0;M<this.d*this.d;M++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=u,this.scale=l/s,this.uid=0;var P=u/l*s;this.min=-P,this.max=s+P}Fs.prototype.insert=function(s,l,u,m,y){this._forEachCell(l,u,m,y,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(y)},Fs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Fs.prototype._insertCell=function(s,l,u,m,y,b){this.cells[y].push(b)},Fs.prototype.query=function(s,l,u,m,y){var b=this.min,E=this.max;if(s<=b&&l<=b&&E<=u&&E<=m&&!y)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(s,l,u,m,this._queryCell,S,{},y),S},Fs.prototype._queryCell=function(s,l,u,m,y,b,E,S){var k=this.cells[y];if(null!==k)for(var M=this.keys,P=this.bboxes,L=0;L<k.length;L++){var z=k[L];if(void 0===E[z]){var G=4*z;(S?S(P[G+0],P[G+1],P[G+2],P[G+3]):s<=P[G+2]&&l<=P[G+3]&&u>=P[G+0]&&m>=P[G+1])?(E[z]=!0,b.push(M[z])):E[z]=!1}}},Fs.prototype._forEachCell=function(s,l,u,m,y,b,E,S){for(var k=this._convertToCellCoord(s),M=this._convertToCellCoord(l),P=this._convertToCellCoord(u),L=this._convertToCellCoord(m),z=k;z<=P;z++)for(var G=M;G<=L;G++){var te=this.d*G+z;if((!S||S(this._convertFromCellCoord(z),this._convertFromCellCoord(G),this._convertFromCellCoord(z+1),this._convertFromCellCoord(G+1)))&&y.call(this,s,l,u,m,te,b,E,S))return}},Fs.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Fs.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Fs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,l=3+this.cells.length+1+1,u=0,m=0;m<this.cells.length;m++)u+=this.cells[m].length;var y=new Int32Array(l+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=l,E=0;E<s.length;E++){var S=s[E];y[3+E]=b,y.set(S,b),b+=S.length}return y[3+s.length]=b,y.set(this.keys,b),y[3+s.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};var Ug=bt.ImageData,ki=bt.ImageBitmap,co={};function lt(s,l,u){void 0===u&&(u={}),Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),co[s]={klass:l,omit:u.omit||[],shallow:u.shallow||[]}}for(var Jd in lt("Object",Object),$i.serialize=function(s,l){var u=s.toArrayBuffer();return l&&l.push(u),{buffer:u}},$i.deserialize=function(s){return new $i(s.buffer)},lt("Grid",$i),lt("Color",wn),lt("Error",Error),lt("ResolvedImage",kr),lt("StylePropertyFunction",qu),lt("StyleExpression",Ua,{omit:["_evaluator"]}),lt("ZoomDependentExpression",vo),lt("ZoomConstantExpression",Yd),lt("CompoundExpression",so,{omit:["_evaluate"]}),Hu)Hu[Jd]._classRegistryKey||lt("Expression_"+Jd,Hu[Jd]);function Ku(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function ac(s){return ki&&s instanceof ki}function Vo(s,l){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Ku(s)||ac(s))return l&&l.push(s),s;if(ArrayBuffer.isView(s)){var u=s;return l&&l.push(u.buffer),u}if(s instanceof Ug)return l&&l.push(s.data.buffer),s;if(Array.isArray(s)){for(var m=[],y=0,b=s;y<b.length;y+=1)m.push(Vo(b[y],l));return m}if("object"==typeof s){var E=s.constructor,S=E._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var k=E.serialize?E.serialize(s,l):{};if(!E.serialize){for(var M in s)if(s.hasOwnProperty(M)&&!(co[S].omit.indexOf(M)>=0)){var P=s[M];k[M]=co[S].shallow.indexOf(M)>=0?P:Vo(P,l)}s instanceof Error&&(k.message=s.message)}if(k.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==S&&(k.$name=S),k}throw new Error("can't serialize object of type "+typeof s)}function qi(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Ku(s)||ac(s)||ArrayBuffer.isView(s)||s instanceof Ug)return s;if(Array.isArray(s))return s.map(qi);if("object"==typeof s){var l=s.$name||"Object",u=co[l].klass;if(!u)throw new Error("can't deserialize unregistered class "+l);if(u.deserialize)return u.deserialize(s);for(var m=Object.create(u.prototype),y=0,b=Object.keys(s);y<b.length;y+=1){var E=b[y];if("$name"!==E){var S=s[E];m[E]=co[l].shallow.indexOf(E)>=0?S:qi(S)}}return m}throw new Error("can't deserialize object of type "+typeof s)}var bo=function(){this.first=!0};bo.prototype.update=function(s,l){var u=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=u,!0))};var mt={"Latin-1 Supplement":function(s){return s>=128&&s<=255},Arabic:function(s){return s>=1536&&s<=1791},"Arabic Supplement":function(s){return s>=1872&&s<=1919},"Arabic Extended-A":function(s){return s>=2208&&s<=2303},"Hangul Jamo":function(s){return s>=4352&&s<=4607},"Unified Canadian Aboriginal Syllabics":function(s){return s>=5120&&s<=5759},Khmer:function(s){return s>=6016&&s<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(s){return s>=6320&&s<=6399},"General Punctuation":function(s){return s>=8192&&s<=8303},"Letterlike Symbols":function(s){return s>=8448&&s<=8527},"Number Forms":function(s){return s>=8528&&s<=8591},"Miscellaneous Technical":function(s){return s>=8960&&s<=9215},"Control Pictures":function(s){return s>=9216&&s<=9279},"Optical Character Recognition":function(s){return s>=9280&&s<=9311},"Enclosed Alphanumerics":function(s){return s>=9312&&s<=9471},"Geometric Shapes":function(s){return s>=9632&&s<=9727},"Miscellaneous Symbols":function(s){return s>=9728&&s<=9983},"Miscellaneous Symbols and Arrows":function(s){return s>=11008&&s<=11263},"CJK Radicals Supplement":function(s){return s>=11904&&s<=12031},"Kangxi Radicals":function(s){return s>=12032&&s<=12255},"Ideographic Description Characters":function(s){return s>=12272&&s<=12287},"CJK Symbols and Punctuation":function(s){return s>=12288&&s<=12351},Hiragana:function(s){return s>=12352&&s<=12447},Katakana:function(s){return s>=12448&&s<=12543},Bopomofo:function(s){return s>=12544&&s<=12591},"Hangul Compatibility Jamo":function(s){return s>=12592&&s<=12687},Kanbun:function(s){return s>=12688&&s<=12703},"Bopomofo Extended":function(s){return s>=12704&&s<=12735},"CJK Strokes":function(s){return s>=12736&&s<=12783},"Katakana Phonetic Extensions":function(s){return s>=12784&&s<=12799},"Enclosed CJK Letters and Months":function(s){return s>=12800&&s<=13055},"CJK Compatibility":function(s){return s>=13056&&s<=13311},"CJK Unified Ideographs Extension A":function(s){return s>=13312&&s<=19903},"Yijing Hexagram Symbols":function(s){return s>=19904&&s<=19967},"CJK Unified Ideographs":function(s){return s>=19968&&s<=40959},"Yi Syllables":function(s){return s>=40960&&s<=42127},"Yi Radicals":function(s){return s>=42128&&s<=42191},"Hangul Jamo Extended-A":function(s){return s>=43360&&s<=43391},"Hangul Syllables":function(s){return s>=44032&&s<=55215},"Hangul Jamo Extended-B":function(s){return s>=55216&&s<=55295},"Private Use Area":function(s){return s>=57344&&s<=63743},"CJK Compatibility Ideographs":function(s){return s>=63744&&s<=64255},"Arabic Presentation Forms-A":function(s){return s>=64336&&s<=65023},"Vertical Forms":function(s){return s>=65040&&s<=65055},"CJK Compatibility Forms":function(s){return s>=65072&&s<=65103},"Small Form Variants":function(s){return s>=65104&&s<=65135},"Arabic Presentation Forms-B":function(s){return s>=65136&&s<=65279},"Halfwidth and Fullwidth Forms":function(s){return s>=65280&&s<=65519}};function Jr(s){for(var l=0,u=s;l<u.length;l+=1)if(Ke(u[l].charCodeAt(0)))return!0;return!1}function Ke(s){return!(746!==s&&747!==s&&(s<4352||!(mt["Bopomofo Extended"](s)||mt.Bopomofo(s)||mt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||mt["CJK Compatibility Ideographs"](s)||mt["CJK Compatibility"](s)||mt["CJK Radicals Supplement"](s)||mt["CJK Strokes"](s)||!(!mt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||mt["CJK Unified Ideographs Extension A"](s)||mt["CJK Unified Ideographs"](s)||mt["Enclosed CJK Letters and Months"](s)||mt["Hangul Compatibility Jamo"](s)||mt["Hangul Jamo Extended-A"](s)||mt["Hangul Jamo Extended-B"](s)||mt["Hangul Jamo"](s)||mt["Hangul Syllables"](s)||mt.Hiragana(s)||mt["Ideographic Description Characters"](s)||mt.Kanbun(s)||mt["Kangxi Radicals"](s)||mt["Katakana Phonetic Extensions"](s)||mt.Katakana(s)&&12540!==s||!(!mt["Halfwidth and Fullwidth Forms"](s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!mt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||mt["Unified Canadian Aboriginal Syllabics"](s)||mt["Unified Canadian Aboriginal Syllabics Extended"](s)||mt["Vertical Forms"](s)||mt["Yijing Hexagram Symbols"](s)||mt["Yi Syllables"](s)||mt["Yi Radicals"](s))))}function Bt(s){return!(Ke(s)||(l=s,mt["Latin-1 Supplement"](l)&&(167===l||169===l||174===l||177===l||188===l||189===l||190===l||215===l||247===l)||mt["General Punctuation"](l)&&(8214===l||8224===l||8225===l||8240===l||8241===l||8251===l||8252===l||8258===l||8263===l||8264===l||8265===l||8273===l)||mt["Letterlike Symbols"](l)||mt["Number Forms"](l)||mt["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||9003===l||l>=9085&&l<=9114||l>=9150&&l<=9165||9167===l||l>=9169&&l<=9179||l>=9186&&l<=9215)||mt["Control Pictures"](l)&&9251!==l||mt["Optical Character Recognition"](l)||mt["Enclosed Alphanumerics"](l)||mt["Geometric Shapes"](l)||mt["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||mt["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||mt["CJK Symbols and Punctuation"](l)||mt.Katakana(l)||mt["Private Use Area"](l)||mt["CJK Compatibility Forms"](l)||mt["Small Form Variants"](l)||mt["Halfwidth and Fullwidth Forms"](l)||8734===l||8756===l||8757===l||l>=9984&&l<=10087||l>=10102&&l<=10131||65532===l||65533===l));var l}function Hn(s){return s>=1424&&s<=2303||mt["Arabic Presentation Forms-A"](s)||mt["Arabic Presentation Forms-B"](s)}function Gi(s,l){return!(!l&&Hn(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||mt.Khmer(s))}function Wi(s){for(var l=0,u=s;l<u.length;l+=1)if(Hn(u[l].charCodeAt(0)))return!0;return!1}var xl=null,Zi="unavailable",Nn=null,zn=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(Zi="error"),xl&&xl(s)};function hs(){rn.fire(new me("pluginStateChange",{pluginStatus:Zi,pluginURL:Nn}))}var rn=new ee,wo=function(){return Zi},eh=function(){if("deferred"!==Zi||!Nn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Zi="loading",hs(),Nn&&sr({url:Nn},function(s){s?zn(s):(Zi="loaded",hs())})},ar={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Zi||null!=ar.applyArabicShaping},isLoading:function(){return"loading"===Zi},setState:function(s){Zi=s.pluginStatus,Nn=s.pluginURL},isParsed:function(){return null!=ar.applyArabicShaping&&null!=ar.processBidirectionalText&&null!=ar.processStyledBidirectionalText},getPluginURL:function(){return Nn}},Kt=function(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new bo,this.transition={})};Kt.prototype.isSupportedScript=function(s){return function(l,u){for(var m=0,y=l;m<y.length;m+=1)if(!Gi(y[m].charCodeAt(0),u))return!1;return!0}(s,ar.isLoaded())},Kt.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Kt.prototype.getCrossfadeParameters=function(){var s=this.zoom,l=s-Math.floor(s),u=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}};var Ki=function(s,l){this.property=s,this.value=l,this.expression=function(u,m){if(bf(u))return new qu(u,m);if(xf(u)){var y=oc(u,m);if("error"===y.result)throw new Error(y.value.map(function(E){return E.key+": "+E.message}).join(", "));return y.value}var b=u;return"string"==typeof u&&"color"===m.type&&(b=wn.parse(u)),{kind:"constant",evaluate:function(){return b}}}(void 0===l?s.specification.default:l,s.specification)};Ki.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Ki.prototype.possiblyEvaluate=function(s,l,u){return this.property.possiblyEvaluate(this,s,l,u)};var Yi=function(s){this.property=s,this.value=new Ki(s,void 0)};Yi.prototype.transitioned=function(s,l){return new xo(this.property,this.value,l,Ui({},s.transition,this.transition),s.now)},Yi.prototype.untransitioned=function(){return new xo(this.property,this.value,null,{},0)};var gi=function(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)};gi.prototype.getValue=function(s){return Gs(this._values[s].value.value)},gi.prototype.setValue=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Yi(this._values[s].property)),this._values[s].value=new Ki(this._values[s].property,null===l?void 0:Gs(l))},gi.prototype.getTransition=function(s){return Gs(this._values[s].transition)},gi.prototype.setTransition=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Yi(this._values[s].property)),this._values[s].transition=Gs(l)||void 0},gi.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y);var b=this.getTransition(m);void 0!==b&&(s[m+"-transition"]=b)}return s},gi.prototype.transitioned=function(s,l){for(var u=new ha(this._properties),m=0,y=Object.keys(this._values);m<y.length;m+=1){var b=y[m];u._values[b]=this._values[b].transitioned(s,l._values[b])}return u},gi.prototype.untransitioned=function(){for(var s=new ha(this._properties),l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l];s._values[m]=this._values[m].untransitioned()}return s};var xo=function(s,l,u,m,y){this.property=s,this.value=l,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=u)};xo.prototype.possiblyEvaluate=function(s,l,u){var m=s.now||0,y=this.value.possiblyEvaluate(s,l,u),b=this.prior;if(b){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return b.possiblyEvaluate(s,l,u);var E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(s,l,u),y,function(S){if(S<=0)return 0;if(S>=1)return 1;var k=S*S,M=k*S;return 4*(S<.5?M:3*(S-k)+M-.75)}(E))}return y};var ha=function(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)};ha.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Bs(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m},ha.prototype.hasTransition=function(){for(var s=0,l=Object.keys(this._values);s<l.length;s+=1)if(this._values[l[s]].prior)return!0;return!1};var es=function(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)};es.prototype.getValue=function(s){return Gs(this._values[s].value)},es.prototype.setValue=function(s,l){this._values[s]=new Ki(this._values[s].property,null===l?void 0:Gs(l))},es.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y)}return s},es.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Bs(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m};var ts=function(s,l,u){this.property=s,this.value=l,this.parameters=u};ts.prototype.isConstant=function(){return"constant"===this.value.kind},ts.prototype.constantOr=function(s){return"constant"===this.value.kind?this.value.value:s},ts.prototype.evaluate=function(s,l,u,m){return this.property.evaluate(this.value,this.parameters,s,l,u,m)};var Bs=function(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)};Bs.prototype.get=function(s){return this._values[s]};var tt=function(s){this.specification=s};tt.prototype.possiblyEvaluate=function(s,l){return s.expression.evaluate(l)},tt.prototype.interpolate=function(s,l,u){var m=Gp[this.specification.type];return m?m(s,l,u):s};var Ot=function(s,l){this.specification=s,this.overrides=l};Ot.prototype.possiblyEvaluate=function(s,l,u,m){return new ts(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(l,null,{},u,m)}:s.expression,l)},Ot.prototype.interpolate=function(s,l,u){if("constant"!==s.value.kind||"constant"!==l.value.kind)return s;if(void 0===s.value.value||void 0===l.value.value)return new ts(this,{kind:"constant",value:void 0},s.parameters);var m=Gp[this.specification.type];return m?new ts(this,{kind:"constant",value:m(s.value.value,l.value.value,u)},s.parameters):s},Ot.prototype.evaluate=function(s,l,u,m,y,b){return"constant"===s.kind?s.value:s.evaluate(l,u,m,y,b)};var _i=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m,y,b){if(void 0===u.value)return new ts(this,{kind:"constant",value:void 0},m);if("constant"===u.expression.kind){var E=u.expression.evaluate(m,null,{},y,b),S="resolvedImage"===u.property.specification.type&&"string"!=typeof E?E.name:E,k=this._calculate(S,S,S,m);return new ts(this,{kind:"constant",value:k},m)}if("camera"===u.expression.kind){var M=this._calculate(u.expression.evaluate({zoom:m.zoom-1}),u.expression.evaluate({zoom:m.zoom}),u.expression.evaluate({zoom:m.zoom+1}),m);return new ts(this,{kind:"constant",value:M},m)}return new ts(this,u.expression,m)},l.prototype.evaluate=function(u,m,y,b,E,S){if("source"===u.kind){var k=u.evaluate(m,y,b,E,S);return this._calculate(k,k,k,m)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(m.zoom)-1},y,b),u.evaluate({zoom:Math.floor(m.zoom)},y,b),u.evaluate({zoom:Math.floor(m.zoom)+1},y,b),m):u.value},l.prototype._calculate=function(u,m,y,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:u,to:m}:{from:y,to:m}},l.prototype.interpolate=function(u){return u},l}(Ot),Lt=function(s){this.specification=s};Lt.prototype.possiblyEvaluate=function(s,l,u,m){if(void 0!==s.value){if("constant"===s.expression.kind){var y=s.expression.evaluate(l,null,{},u,m);return this._calculate(y,y,y,l)}return this._calculate(s.expression.evaluate(new Kt(Math.floor(l.zoom-1),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom+1),l)),l)}},Lt.prototype._calculate=function(s,l,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:u,to:l}},Lt.prototype.interpolate=function(s){return s};var fa=function(s){this.specification=s};fa.prototype.possiblyEvaluate=function(s,l,u,m){return!!s.expression.evaluate(l,null,{},u,m)},fa.prototype.interpolate=function(){return!1};var yi=function(s){for(var l in this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],s){var u=s[l];u.specification.overridable&&this.overridableProperties.push(l);var m=this.defaultPropertyValues[l]=new Ki(u,void 0),y=this.defaultTransitionablePropertyValues[l]=new Yi(u);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}};lt("DataDrivenProperty",Ot),lt("DataConstantProperty",tt),lt("CrossFadedDataDrivenProperty",_i),lt("CrossFadedProperty",Lt),lt("ColorRampProperty",fa);var Ai=function(s){function l(u,m){if(s.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),m.layout&&(this._unevaluatedLayout=new es(m.layout)),m.paint)){for(var y in this._transitionablePaint=new gi(m.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var b in u.layout)this.setLayoutProperty(b,u.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bs(m.paint)}}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},l.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},l.prototype.setLayoutProperty=function(u,m,y){void 0===y&&(y={}),null!=m&&this._validate($r,"layers."+this.id+".layout."+u,u,m,y)||("visibility"!==u?this._unevaluatedLayout.setValue(u,m):this.visibility=m)},l.prototype.getPaintProperty=function(u){return Vc(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},l.prototype.setPaintProperty=function(u,m,y){if(void 0===y&&(y={}),null!=m&&this._validate(sc,"layers."+this.id+".paint."+u,u,m,y))return!1;if(Vc(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),m||void 0),!1;var b=this._transitionablePaint._values[u],E="cross-faded-data-driven"===b.property.specification["property-type"],S=b.value.isDataDriven(),k=b.value;this._transitionablePaint.setValue(u,m),this._handleSpecialPaintPropertyUpdate(u);var M=this._transitionablePaint._values[u].value;return M.isDataDriven()||S||E||this._handleOverridablePaintPropertyUpdate(u,k,M)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!1},l.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},l.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},l.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},l.prototype.recalculate=function(u,m){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,m)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,m)},l.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),ks(u,function(m,y){return!(void 0===m||"layout"===y&&!Object.keys(m).length||"paint"===y&&!Object.keys(m).length)})},l.prototype._validate=function(u,m,y,b,E){return void 0===E&&(E={}),(!E||!1!==E.validate)&&da(this,u.call(Zu,{key:m,layerType:this.type,objectKey:y,value:b,styleSpec:X,style:{glyphs:!0,sprite:!0}}))},l.prototype.is3D=function(){return!1},l.prototype.isTileClipped=function(){return!1},l.prototype.hasOffscreenPass=function(){return!1},l.prototype.resize=function(){},l.prototype.isStateDependent=function(){for(var u in this.paint._values){var m=this.paint.get(u);if(m instanceof ts&&Gd(m.property.specification)&&("source"===m.value.kind||"composite"===m.value.kind)&&m.value.isStateDependent)return!0}return!1},l}(ee),kf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},fs=function(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Zt=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Cn(s,l){void 0===l&&(l=1);var u=0,m=0;return{members:s.map(function(y){var b=kf[y.type].BYTES_PER_ELEMENT,E=u=Eo(u,Math.max(l,b)),S=y.components||1;return m=Math.max(m,b),u+=b*S,{name:y.name,type:y.type,components:S,offset:E}}),size:Eo(u,Math.max(m,l)),alignment:l}}function Eo(s,l){return Math.ceil(s/l)*l}Zt.serialize=function(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}},Zt.deserialize=function(s){var l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l},Zt.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Zt.prototype.clear=function(){this.length=0},Zt.prototype.resize=function(s){this.reserve(s),this.length=s},Zt.prototype.reserve=function(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}},Zt.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Yu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.int16[b+0]=m,this.int16[b+1]=y,u},l}(Zt);Yu.prototype.bytesPerElement=4,lt("StructArrayLayout2i4",Yu);var uo=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.int16[S+0]=m,this.int16[S+1]=y,this.int16[S+2]=b,this.int16[S+3]=E,u},l}(Zt);uo.prototype.bytesPerElement=8,lt("StructArrayLayout4i8",uo);var Xi=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=6*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.int16[M+2]=b,this.int16[M+3]=E,this.int16[M+4]=S,this.int16[M+5]=k,u},l}(Zt);Xi.prototype.bytesPerElement=12,lt("StructArrayLayout2i4i12",Xi);var ps=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=4*u,P=8*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.uint8[P+4]=b,this.uint8[P+5]=E,this.uint8[P+6]=S,this.uint8[P+7]=k,u},l}(Zt);ps.prototype.bytesPerElement=8,lt("StructArrayLayout2i4ub8",ps);var ms=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.float32[b+0]=m,this.float32[b+1]=y,u},l}(Zt);ms.prototype.bytesPerElement=8,lt("StructArrayLayout2f8",ms);var lc=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,L){var z=this.length;return this.resize(z+1),this.emplace(z,u,m,y,b,E,S,k,M,P,L)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,L,z){var G=10*u;return this.uint16[G+0]=m,this.uint16[G+1]=y,this.uint16[G+2]=b,this.uint16[G+3]=E,this.uint16[G+4]=S,this.uint16[G+5]=k,this.uint16[G+6]=M,this.uint16[G+7]=P,this.uint16[G+8]=L,this.uint16[G+9]=z,u},l}(Zt);lc.prototype.bytesPerElement=20,lt("StructArrayLayout10ui20",lc);var th=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,L,z,G){var te=this.length;return this.resize(te+1),this.emplace(te,u,m,y,b,E,S,k,M,P,L,z,G)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,L,z,G,te){var J=12*u;return this.int16[J+0]=m,this.int16[J+1]=y,this.int16[J+2]=b,this.int16[J+3]=E,this.uint16[J+4]=S,this.uint16[J+5]=k,this.uint16[J+6]=M,this.uint16[J+7]=P,this.int16[J+8]=L,this.int16[J+9]=z,this.int16[J+10]=G,this.int16[J+11]=te,u},l}(Zt);th.prototype.bytesPerElement=24,lt("StructArrayLayout4i4ui4i24",th);var Vs=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.float32[E+0]=m,this.float32[E+1]=y,this.float32[E+2]=b,u},l}(Zt);Vs.prototype.bytesPerElement=12,lt("StructArrayLayout3f12",Vs);var Af=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint32[1*u+0]=m,u},l}(Zt);Af.prototype.bytesPerElement=4,lt("StructArrayLayout1ul4",Af);var Mf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P){var L=this.length;return this.resize(L+1),this.emplace(L,u,m,y,b,E,S,k,M,P)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,L){var z=10*u,G=5*u;return this.int16[z+0]=m,this.int16[z+1]=y,this.int16[z+2]=b,this.int16[z+3]=E,this.int16[z+4]=S,this.int16[z+5]=k,this.uint32[G+3]=M,this.uint16[z+8]=P,this.uint16[z+9]=L,u},l}(Zt);Mf.prototype.bytesPerElement=20,lt("StructArrayLayout6i1ul2ui20",Mf);var cc=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=6*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.int16[M+2]=b,this.int16[M+3]=E,this.int16[M+4]=S,this.int16[M+5]=k,u},l}(Zt);cc.prototype.bytesPerElement=12,lt("StructArrayLayout2i2i2i12",cc);var Xu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E){var S=this.length;return this.resize(S+1),this.emplace(S,u,m,y,b,E)},l.prototype.emplace=function(u,m,y,b,E,S){var k=4*u,M=8*u;return this.float32[k+0]=m,this.float32[k+1]=y,this.float32[k+2]=b,this.int16[M+6]=E,this.int16[M+7]=S,u},l}(Zt);Xu.prototype.bytesPerElement=16,lt("StructArrayLayout2f1f2i16",Xu);var zg=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=12*u,k=3*u;return this.uint8[S+0]=m,this.uint8[S+1]=y,this.float32[k+1]=b,this.float32[k+2]=E,u},l}(Zt);zg.prototype.bytesPerElement=12,lt("StructArrayLayout2ub2f12",zg);var Qs=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.uint16[E+0]=m,this.uint16[E+1]=y,this.uint16[E+2]=b,u},l}(Zt);Qs.prototype.bytesPerElement=6,lt("StructArrayLayout3ui6",Qs);var Jp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be){var ve=this.length;return this.resize(ve+1),this.emplace(ve,u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be,ve){var Ie=24*u,ke=12*u,Be=48*u;return this.int16[Ie+0]=m,this.int16[Ie+1]=y,this.uint16[Ie+2]=b,this.uint16[Ie+3]=E,this.uint32[ke+2]=S,this.uint32[ke+3]=k,this.uint32[ke+4]=M,this.uint16[Ie+10]=P,this.uint16[Ie+11]=L,this.uint16[Ie+12]=z,this.float32[ke+7]=G,this.float32[ke+8]=te,this.uint8[Be+36]=J,this.uint8[Be+37]=pe,this.uint8[Be+38]=he,this.uint32[ke+10]=be,this.int16[Ie+22]=ve,u},l}(Zt);Jp.prototype.bytesPerElement=48,lt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Jp);var Qu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be,ve,Ie,ke,Be,Ye,nt,wt,it,At,at,fn){var Vt=this.length;return this.resize(Vt+1),this.emplace(Vt,u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be,ve,Ie,ke,Be,Ye,nt,wt,it,At,at,fn)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,L,z,G,te,J,pe,he,be,ve,Ie,ke,Be,Ye,nt,wt,it,At,at,fn,Vt){var vt=34*u,yn=17*u;return this.int16[vt+0]=m,this.int16[vt+1]=y,this.int16[vt+2]=b,this.int16[vt+3]=E,this.int16[vt+4]=S,this.int16[vt+5]=k,this.int16[vt+6]=M,this.int16[vt+7]=P,this.uint16[vt+8]=L,this.uint16[vt+9]=z,this.uint16[vt+10]=G,this.uint16[vt+11]=te,this.uint16[vt+12]=J,this.uint16[vt+13]=pe,this.uint16[vt+14]=he,this.uint16[vt+15]=be,this.uint16[vt+16]=ve,this.uint16[vt+17]=Ie,this.uint16[vt+18]=ke,this.uint16[vt+19]=Be,this.uint16[vt+20]=Ye,this.uint16[vt+21]=nt,this.uint16[vt+22]=wt,this.uint32[yn+12]=it,this.float32[yn+13]=At,this.float32[yn+14]=at,this.float32[yn+15]=fn,this.float32[yn+16]=Vt,u},l}(Zt);Qu.prototype.bytesPerElement=68,lt("StructArrayLayout8i15ui1ul4f68",Qu);var Js=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.float32[1*u+0]=m,u},l}(Zt);Js.prototype.bytesPerElement=4,lt("StructArrayLayout1f4",Js);var jg=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.int16[E+0]=m,this.int16[E+1]=y,this.int16[E+2]=b,u},l}(Zt);jg.prototype.bytesPerElement=6,lt("StructArrayLayout3i6",jg);var em=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=4*u;return this.uint32[2*u+0]=m,this.uint16[E+2]=y,this.uint16[E+3]=b,u},l}(Zt);em.prototype.bytesPerElement=8,lt("StructArrayLayout1ul2ui8",em);var Rf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.uint16[b+0]=m,this.uint16[b+1]=y,u},l}(Zt);Rf.prototype.bytesPerElement=4,lt("StructArrayLayout2ui4",Rf);var tm=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint16[1*u+0]=m,u},l}(Zt);tm.prototype.bytesPerElement=2,lt("StructArrayLayout1ui2",tm);var d=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.float32[S+0]=m,this.float32[S+1]=y,this.float32[S+2]=b,this.float32[S+3]=E,u},l}(Zt);d.prototype.bytesPerElement=16,lt("StructArrayLayout4f16",d);var p=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Wt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(l.prototype,u),l}(fs);p.prototype.size=20;var h=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new p(this,u)},l}(Mf);lt("CollisionBoxArray",h);var g=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(m){this._structArray.uint8[this._pos1+37]=m},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(m){this._structArray.uint8[this._pos1+38]=m},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+10]=m},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(l.prototype,u),l}(fs);g.prototype.size=48;var w=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new g(this,u)},l}(Jp);lt("PlacedSymbolArray",w);var D=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+12]=m},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(l.prototype,u),l}(fs);D.prototype.size=68;var T=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new D(this,u)},l}(Qu);lt("SymbolInstanceArray",T);var I=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getoffsetX=function(u){return this.float32[1*u+0]},l}(Js);lt("GlyphOffsetArray",I);var R=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getx=function(u){return this.int16[3*u+0]},l.prototype.gety=function(u){return this.int16[3*u+1]},l.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},l}(jg);lt("SymbolLineVertexArray",R);var F=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(l.prototype,u),l}(fs);F.prototype.size=8;var W=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new F(this,u)},l}(em);lt("FeatureIndexArray",W);var Z=Cn([{name:"a_pos",components:2,type:"Int16"}],4).members,$=function(s){void 0===s&&(s=[]),this.segments=s};function se(s,l){return 256*(s=io(Math.floor(s),0,255))+io(Math.floor(l),0,255)}$.prototype.prepareSegment=function(s,l,u,m){var y=this.segments[this.segments.length-1];return s>$.MAX_VERTEX_ARRAY_LENGTH&&yr("Max vertices per segment is "+$.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+s),(!y||y.vertexLength+s>$.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==m&&(y.sortKey=m),this.segments.push(y)),y},$.prototype.get=function(){return this.segments},$.prototype.destroy=function(){for(var s=0,l=this.segments;s<l.length;s+=1){var u=l[s];for(var m in u.vaos)u.vaos[m].destroy()}},$.simpleSegment=function(s,l,u,m){return new $([{vertexOffset:s,primitiveOffset:l,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])},$.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,lt("SegmentVector",$);var re=Cn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),de=Qo(function(s){s.exports=function(l,u){var m,y,b,E,S,k,M,P;for(y=l.length-(m=3&l.length),b=u,S=3432918353,k=461845907,P=0;P<y;)M=255&l.charCodeAt(P)|(255&l.charCodeAt(++P))<<8|(255&l.charCodeAt(++P))<<16|(255&l.charCodeAt(++P))<<24,++P,b=27492+(65535&(E=5*(65535&(b=(b^=M=(65535&(M=(M=(65535&M)*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(M=0,m){case 3:M^=(255&l.charCodeAt(P+2))<<16;case 2:M^=(255&l.charCodeAt(P+1))<<8;case 1:b^=M=(65535&(M=(M=(65535&(M^=255&l.charCodeAt(P)))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),ie=Qo(function(s){s.exports=function(l,u){for(var m,y=l.length,b=u^y,E=0;y>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:b^=(255&l.charCodeAt(E+2))<<16;case 2:b^=(255&l.charCodeAt(E+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(E)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),le=de,_e=ie;le.murmur3=de,le.murmur2=_e;var we=function(){this.ids=[],this.positions=[],this.indexed=!1};we.prototype.add=function(s,l,u,m){this.ids.push(De(s)),this.positions.push(l,u,m)},we.prototype.getPositions=function(s){for(var l=De(s),u=0,m=this.ids.length-1;u<m;){var y=u+m>>1;this.ids[y]>=l?m=y:u=y+1}for(var b=[];this.ids[u]===l;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b},we.serialize=function(s,l){var u=new Float64Array(s.ids),m=new Uint32Array(s.positions);return function y(b,E,S,k){for(;S<k;){for(var M=b[S+k>>1],P=S-1,L=k+1;;){do{P++}while(b[P]<M);do{L--}while(b[L]>M);if(P>=L)break;Re(b,P,L),Re(E,3*P,3*L),Re(E,3*P+1,3*L+1),Re(E,3*P+2,3*L+2)}L-S<k-L?(y(b,E,S,L),S=L+1):(y(b,E,L+1,k),k=L)}}(u,m,0,u.length-1),l&&l.push(u.buffer,m.buffer),{ids:u,positions:m}},we.deserialize=function(s){var l=new we;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l};var Ae=Math.pow(2,53)-1;function De(s){var l=+s;return!isNaN(l)&&l<=Ae?l:le(String(s))}function Re(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}lt("FeaturePositionMap",we);var Ve=function(s,l){this.gl=s.gl,this.location=l},Qe=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},l}(Ve),We=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},l}(Ve),ct=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},l}(Ve),Ct=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},l}(Ve),kt=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},l}(Ve),It=function(s){function l(u,m){s.call(this,u,m),this.current=wn.transparent}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},l}(Ve),gn=new Float32Array(16),ft=function(s){function l(u,m){s.call(this,u,m),this.current=gn}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},l}(Ve);function Xt(s){return[se(255*s.r,255*s.g),se(255*s.b,255*s.a)]}var hn=function(s,l,u){this.value=s,this.uniformNames=l.map(function(m){return"u_"+m}),this.type=u};hn.prototype.setUniform=function(s,l,u){s.set(u.constantOr(this.value))},hn.prototype.getBinding=function(s,l,u){return"color"===this.type?new It(s,l):new We(s,l)};var et=function(s,l){this.uniformNames=l.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};et.prototype.setConstantPatternPositions=function(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr},et.prototype.setUniform=function(s,l,u,m){var y="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;y&&s.set(y)},et.prototype.getBinding=function(s,l,u){return"u_pattern"===u.substr(0,9)?new kt(s,l):new We(s,l)};var zt=function(s,l,u,m){this.expression=s,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(function(y){return{name:"a_"+y,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new m};zt.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.paintVertexArray.length,E=this.expression.evaluate(new Kt(0),l,{},m,[],y);this.paintVertexArray.resize(s),this._setPaintValue(b,s,E)},zt.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(s,l,y)},zt.prototype._setPaintValue=function(s,l,u){if("color"===this.type)for(var m=Xt(u),y=s;y<l;y++)this.paintVertexArray.emplace(y,m[0],m[1]);else{for(var b=s;b<l;b++)this.paintVertexArray.emplace(b,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},zt.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var qt=function(s,l,u,m,y,b){this.expression=s,this.uniformNames=l.map(function(E){return"u_"+E+"_t"}),this.type=u,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(function(E){return{name:"a_"+E,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new b};qt.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.expression.evaluate(new Kt(this.zoom),l,{},m,[],y),E=this.expression.evaluate(new Kt(this.zoom+1),l,{},m,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(S,s,b,E)},qt.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:this.zoom},u,m),b=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(s,l,y,b)},qt.prototype._setPaintValue=function(s,l,u,m){if("color"===this.type)for(var y=Xt(u),b=Xt(m),E=s;E<l;E++)this.paintVertexArray.emplace(E,y[0],y[1],b[0],b[1]);else{for(var S=s;S<l;S++)this.paintVertexArray.emplace(S,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}},qt.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},qt.prototype.setUniform=function(s,l){var u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=io(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);s.set(m)},qt.prototype.getBinding=function(s,l,u){return new We(s,l)};var jt=function(s,l,u,m,y,b){this.expression=s,this.type=l,this.useIntegerZoom=u,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y};jt.prototype.populatePaintArray=function(s,l,u){var m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,l.patterns&&l.patterns[this.layerId],u)},jt.prototype.updatePaintArray=function(s,l,u,m,y){this._setPaintValues(s,l,u.patterns&&u.patterns[this.layerId],y)},jt.prototype._setPaintValues=function(s,l,u,m){if(m&&u){var y=m[u.min],b=m[u.mid],E=m[u.max];if(y&&b&&E)for(var S=s;S<l;S++)this.zoomInPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],b.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],b.pixelRatio,E.pixelRatio)}},jt.prototype.upload=function(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,re.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,re.members,this.expression.isStateDependent))},jt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Pt=function(s,l,u){this.binders={},this._buffers=[];var m=[];for(var y in s.paint._values)if(u(y)){var b=s.paint.get(y);if(b instanceof ts&&Gd(b.property.specification)){var E=qr(y,s.type),S=b.value,k=b.property.specification.type,M=b.property.useIntegerZoom,P=b.property.specification["property-type"],L="cross-faded"===P||"cross-faded-data-driven"===P;if("constant"===S.kind)this.binders[y]=L?new et(S.value,E):new hn(S.value,E,k),m.push("/u_"+y);else if("source"===S.kind||L){var z=ho(y,k,"source");this.binders[y]=L?new jt(S,k,M,l,z,s.id):new zt(S,E,k,z),m.push("/a_"+y)}else{var G=ho(y,k,"composite");this.binders[y]=new qt(S,E,k,M,l,G),m.push("/z_"+y)}}}this.cacheKey=m.sort().join("")};Pt.prototype.getMaxValue=function(s){var l=this.binders[s];return l instanceof zt||l instanceof qt?l.maxValue:0},Pt.prototype.populatePaintArrays=function(s,l,u,m,y){for(var b in this.binders){var E=this.binders[b];(E instanceof zt||E instanceof qt||E instanceof jt)&&E.populatePaintArray(s,l,u,m,y)}},Pt.prototype.setConstantPatternPositions=function(s,l){for(var u in this.binders){var m=this.binders[u];m instanceof et&&m.setConstantPatternPositions(s,l)}},Pt.prototype.updatePaintArrays=function(s,l,u,m,y){var b=!1;for(var E in s)for(var S=0,k=l.getPositions(E);S<k.length;S+=1){var M=k[S],P=u.feature(M.index);for(var L in this.binders){var z=this.binders[L];if((z instanceof zt||z instanceof qt||z instanceof jt)&&!0===z.expression.isStateDependent){var G=m.paint.get(L);z.expression=G.value,z.updatePaintArray(M.start,M.end,P,s[E],y),b=!0}}}return b},Pt.prototype.defines=function(){var s=[];for(var l in this.binders){var u=this.binders[l];(u instanceof hn||u instanceof et)&&s.push.apply(s,u.uniformNames.map(function(m){return"#define HAS_UNIFORM_"+m}))}return s},Pt.prototype.getBinderAttributes=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof zt||u instanceof qt)for(var m=0;m<u.paintVertexAttributes.length;m++)s.push(u.paintVertexAttributes[m].name);else if(u instanceof jt)for(var y=0;y<re.members.length;y++)s.push(re.members[y].name)}return s},Pt.prototype.getBinderUniforms=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof hn||u instanceof et||u instanceof qt)for(var m=0,y=u.uniformNames;m<y.length;m+=1)s.push(y[m])}return s},Pt.prototype.getPaintVertexBuffers=function(){return this._buffers},Pt.prototype.getUniforms=function(s,l){var u=[];for(var m in this.binders){var y=this.binders[m];if(y instanceof hn||y instanceof et||y instanceof qt)for(var b=0,E=y.uniformNames;b<E.length;b+=1){var S=E[b];if(l[S]){var k=y.getBinding(s,l[S],S);u.push({name:S,property:m,binding:k})}}}return u},Pt.prototype.setUniforms=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1){var E=b[y],S=E.name,k=E.property;this.binders[k].setUniform(E.binding,m,u.get(k),S)}},Pt.prototype.updatePaintBuffers=function(s){for(var l in this._buffers=[],this.binders){var u=this.binders[l];if(s&&u instanceof jt){var m=2===s.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof zt||u instanceof qt)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},Pt.prototype.upload=function(s){for(var l in this.binders){var u=this.binders[l];(u instanceof zt||u instanceof qt||u instanceof jt)&&u.upload(s)}this.updatePaintBuffers()},Pt.prototype.destroy=function(){for(var s in this.binders){var l=this.binders[s];(l instanceof zt||l instanceof qt||l instanceof jt)&&l.destroy()}};var lr=function(s,l,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var m=0,y=s;m<y.length;m+=1){var b=y[m];this.programConfigurations[b.id]=new Pt(b,l,u)}this.needsUpload=!1,this._featureMap=new we,this._bufferOffset=0};function qr(s,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(l+"-","").replace(/-/g,"_")]}function ho(s,l,u){var y={"line-pattern":{source:lc,composite:lc},"fill-pattern":{source:lc,composite:lc},"fill-extrusion-pattern":{source:lc,composite:lc}}[s];return y&&y[u]||{color:{source:ms,composite:d},number:{source:Js,composite:ms}}[l][u]}lr.prototype.populatePaintArrays=function(s,l,u,m,y,b){for(var E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(s,l,m,y,b);void 0!==l.id&&this._featureMap.add(l.id,u,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0},lr.prototype.updatePaintArrays=function(s,l,u,m){for(var y=0,b=u;y<b.length;y+=1){var E=b[y];this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(s,this._featureMap,l,E,m)||this.needsUpload}},lr.prototype.get=function(s){return this.programConfigurations[s]},lr.prototype.upload=function(s){if(this.needsUpload){for(var l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}},lr.prototype.destroy=function(){for(var s in this.programConfigurations)this.programConfigurations[s].destroy()},lt("ConstantBinder",hn),lt("CrossFadedConstantBinder",et),lt("SourceExpressionBinder",zt),lt("CrossFadedCompositeBinder",jt),lt("CompositeExpressionBinder",qt),lt("ProgramConfiguration",Pt,{omit:["_buffers"]}),lt("ProgramConfigurationSet",lr);var vi=Math.pow(2,14)-1,bi=-vi-1;function ei(s){for(var l=8192/s.extent,u=s.loadGeometry(),m=0;m<u.length;m++)for(var y=u[m],b=0;b<y.length;b++){var E=y[b],S=Math.round(E.x*l),k=Math.round(E.y*l);E.x=io(S,bi,vi),E.y=io(k,bi,vi),(S<E.x||S>E.x+1||k<E.y||k>E.y+1)&&yr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Uo(s,l){return{type:s.type,id:s.id,properties:s.properties,geometry:l?ei(s):[]}}function qa(s,l,u,m,y){s.emplaceBack(2*l+(m+1)/2,2*u+(y+1)/2)}var Co=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Yu,this.indexArray=new Qs,this.segments=new $,this.programConfigurations=new lr(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function Le(s,l){for(var u=0;u<s.length;u++)if(ma(l,s[u]))return!0;for(var m=0;m<l.length;m++)if(ma(s,l[m]))return!0;return!!Qt(s,l)}function $t(s,l,u){return!!ma(s,l)||!!pa(l,s,u)}function Me(s,l){if(1===s.length)return Jc(l,s[0]);for(var u=0;u<l.length;u++)for(var m=l[u],y=0;y<m.length;y++)if(ma(s,m[y]))return!0;for(var b=0;b<s.length;b++)if(Jc(l,s[b]))return!0;for(var E=0;E<l.length;E++)if(Qt(s,l[E]))return!0;return!1}function Oe(s,l,u){if(s.length>1){if(Qt(s,l))return!0;for(var m=0;m<l.length;m++)if(pa(l[m],s,u))return!0}for(var y=0;y<s.length;y++)if(pa(s[y],l,u))return!0;return!1}function Qt(s,l){if(0===s.length||0===l.length)return!1;for(var u=0;u<s.length-1;u++)for(var m=s[u],y=s[u+1],b=0;b<l.length-1;b++)if(Qc(m,y,l[b],l[b+1]))return!0;return!1}function Qc(s,l,u,m){return Lo(s,u,m)!==Lo(l,u,m)&&Lo(s,l,u)!==Lo(s,l,m)}function pa(s,l,u){var m=u*u;if(1===l.length)return s.distSqr(l[0])<m;for(var y=1;y<l.length;y++)if(Us(s,l[y-1],l[y])<m)return!0;return!1}function Us(s,l,u){var m=l.distSqr(u);if(0===m)return s.distSqr(l);var y=((s.x-l.x)*(u.x-l.x)+(s.y-l.y)*(u.y-l.y))/m;return s.distSqr(y<0?l:y>1?u:u.sub(l)._mult(y)._add(l))}function Jc(s,l){for(var u,m,y,b=!1,E=0;E<s.length;E++)for(var S=0,k=(u=s[E]).length-1;S<u.length;k=S++)(m=u[S]).y>l.y!=(y=u[k]).y>l.y&&l.x<(y.x-m.x)*(l.y-m.y)/(y.y-m.y)+m.x&&(b=!b);return b}function ma(s,l){for(var u=!1,m=0,y=s.length-1;m<s.length;y=m++){var b=s[m],E=s[y];b.y>l.y!=E.y>l.y&&l.x<(E.x-b.x)*(l.y-b.y)/(E.y-b.y)+b.x&&(u=!u)}return u}function eu(s,l,u){var m=u[0],y=u[2];if(s.x<m.x&&l.x<m.x||s.x>y.x&&l.x>y.x||s.y<m.y&&l.y<m.y||s.y>y.y&&l.y>y.y)return!1;var b=Lo(s,l,u[0]);return b!==Lo(s,l,u[1])||b!==Lo(s,l,u[2])||b!==Lo(s,l,u[3])}function Mi(s,l,u){var m=l.paint.get(s).value;return"constant"===m.kind?m.value:u.programConfigurations.get(l.id).getMaxValue(s)}function uc(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function ea(s,l,u,m,y){if(!l[0]&&!l[1])return s;var b=Wt.convert(l)._mult(y);"viewport"===u&&b._rotate(-m);for(var E=[],S=0;S<s.length;S++)E.push(s[S].sub(b));return E}Co.prototype.populate=function(s,l,u){var m=this.layers[0],y=[],b=null,E=!1;"circle"===m.type&&(E=!(b=m.layout.get("circle-sort-key")).isConstant());for(var S=0,k=s;S<k.length;S+=1){var M=k[S],P=M.feature,L=M.id,z=M.index,G=M.sourceLayerIndex,te=this.layers[0]._featureFilter.needGeometry,J=Uo(P,te);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),J,u)){var pe=E?b.evaluate(J,{},u):void 0,he={id:L,properties:P.properties,type:P.type,sourceLayerIndex:G,index:z,geometry:te?J.geometry:ei(P),patterns:{},sortKey:pe};y.push(he)}}E&&y.sort(function(wt,it){return wt.sortKey-it.sortKey});for(var be=0,ve=y;be<ve.length;be+=1){var Ie=ve[be],ke=Ie.geometry,Be=Ie.index,Ye=Ie.sourceLayerIndex,nt=s[Be].feature;this.addFeature(Ie,ke,Be,u),l.featureIndex.insert(nt,ke,Be,Ye,this.index)}},Co.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},Co.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Co.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Co.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},Co.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Co.prototype.addFeature=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1)for(var E=0,S=b[y];E<S.length;E+=1){var k=S[E],M=k.x,P=k.y;if(!(M<0||M>=8192||P<0||P>=8192)){var L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),z=L.vertexLength;qa(this.layoutVertexArray,M,P,-1,-1),qa(this.layoutVertexArray,M,P,1,-1),qa(this.layoutVertexArray,M,P,1,1),qa(this.layoutVertexArray,M,P,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),L.vertexLength+=4,L.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,{},m)},lt("CircleBucket",Co,{omit:["layers"]});var dc=new yi({"circle-sort-key":new Ot(X.layout_circle["circle-sort-key"])}),Nr={paint:new yi({"circle-radius":new Ot(X.paint_circle["circle-radius"]),"circle-color":new Ot(X.paint_circle["circle-color"]),"circle-blur":new Ot(X.paint_circle["circle-blur"]),"circle-opacity":new Ot(X.paint_circle["circle-opacity"]),"circle-translate":new tt(X.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ot(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ot(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ot(X.paint_circle["circle-stroke-opacity"])}),layout:dc},jn=typeof Float32Array<"u"?Float32Array:Array;function Vr(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ju(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],M=l[6],P=l[7],L=l[8],z=l[9],G=l[10],te=l[11],J=l[12],pe=l[13],he=l[14],be=l[15],ve=u[0],Ie=u[1],ke=u[2],Be=u[3];return s[0]=ve*m+Ie*S+ke*L+Be*J,s[1]=ve*y+Ie*k+ke*z+Be*pe,s[2]=ve*b+Ie*M+ke*G+Be*he,s[3]=ve*E+Ie*P+ke*te+Be*be,s[4]=(ve=u[4])*m+(Ie=u[5])*S+(ke=u[6])*L+(Be=u[7])*J,s[5]=ve*y+Ie*k+ke*z+Be*pe,s[6]=ve*b+Ie*M+ke*G+Be*he,s[7]=ve*E+Ie*P+ke*te+Be*be,s[8]=(ve=u[8])*m+(Ie=u[9])*S+(ke=u[10])*L+(Be=u[11])*J,s[9]=ve*y+Ie*k+ke*z+Be*pe,s[10]=ve*b+Ie*M+ke*G+Be*he,s[11]=ve*E+Ie*P+ke*te+Be*be,s[12]=(ve=u[12])*m+(Ie=u[13])*S+(ke=u[14])*L+(Be=u[15])*J,s[13]=ve*y+Ie*k+ke*z+Be*pe,s[14]=ve*b+Ie*M+ke*G+Be*he,s[15]=ve*E+Ie*P+ke*te+Be*be,s}Math.hypot||(Math.hypot=function(){for(var s=arguments,l=0,u=arguments.length;u--;)l+=s[u]*s[u];return Math.sqrt(l)});var Qi,s,El=Ju;function Pf(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3];return s[0]=u[0]*m+u[4]*y+u[8]*b+u[12]*E,s[1]=u[1]*m+u[5]*y+u[9]*b+u[13]*E,s[2]=u[2]*m+u[6]*y+u[10]*b+u[14]*E,s[3]=u[3]*m+u[7]*y+u[11]*b+u[15]*E,s}Qi=new jn(3),jn!=Float32Array&&(Qi[0]=0,Qi[1]=0,Qi[2]=0),s=new jn(4),jn!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0);var nh=(function(){var s=new jn(2);jn!=Float32Array&&(s[0]=0,s[1]=0)}(),function(s){function l(u){s.call(this,u,Nr)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new Co(u)},l.prototype.queryRadius=function(u){var m=u;return Mi("circle-radius",this,m)+Mi("circle-stroke-width",this,m)+uc(this.paint.get("circle-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,M){for(var P=ea(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,k),L=this.paint.get("circle-radius").evaluate(m,y)+this.paint.get("circle-stroke-width").evaluate(m,y),z="map"===this.paint.get("circle-pitch-alignment"),G=z?P:function(Ye,nt){return Ye.map(function(wt){return Hg(wt,nt)})}(P,M),te=z?L*k:L,J=0,pe=b;J<pe.length;J+=1)for(var he=0,be=pe[J];he<be.length;he+=1){var ve=be[he],Ie=z?ve:Hg(ve,M),ke=te,Be=Pf([],[ve.x,ve.y,0,1],M);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ke*=Be[3]/S.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ke*=S.cameraToCenterDistance/Be[3]),$t(G,Ie,ke))return!0}return!1},l}(Ai));function Hg(s,l){var u=Pf([],[s.x,s.y,0,1],l);return new Wt(u[0]/u[3],u[1]/u[3])}var rh=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Co);function tu(s,l,u,m){var y=l.width,b=l.height;if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==y*b*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(y*b*u);return s.width=y,s.height=b,s.data=m,s}function $g(s,l,u){var m=l.width,y=l.height;if(m!==s.width||y!==s.height){var b=tu({},{width:m,height:y},u);nm(s,b,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,m),height:Math.min(s.height,y)},u),s.width=m,s.height=y,s.data=b.data}}function nm(s,l,u,m,y,b){if(0===y.width||0===y.height)return l;if(y.width>s.width||y.height>s.height||u.x>s.width-y.width||u.y>s.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||m.x>l.width-y.width||m.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var E=s.data,S=l.data,k=0;k<y.height;k++)for(var M=((u.y+k)*s.width+u.x)*b,P=((m.y+k)*l.width+m.x)*b,L=0;L<y.width*b;L++)S[P+L]=E[M+L];return l}lt("HeatmapBucket",rh,{omit:["layers"]});var hc=function(s,l){tu(this,s,1,l)};hc.prototype.resize=function(s){$g(this,s,1)},hc.prototype.clone=function(){return new hc({width:this.width,height:this.height},new Uint8Array(this.data))},hc.copy=function(s,l,u,m,y){nm(s,l,u,m,y,1)};var gs=function(s,l){tu(this,s,4,l)};gs.prototype.resize=function(s){$g(this,s,4)},gs.prototype.replace=function(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s},gs.prototype.clone=function(){return new gs({width:this.width,height:this.height},new Uint8Array(this.data))},gs.copy=function(s,l,u,m,y){nm(s,l,u,m,y,4)},lt("AlphaImage",hc),lt("RGBAImage",gs);var Bw={paint:new yi({"heatmap-radius":new Ot(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ot(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fa(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(X.paint_heatmap["heatmap-opacity"])})};function qg(s){var l={},u=s.resolution||256,m=s.clips?s.clips.length:1,y=s.image||new gs({width:u,height:m}),b=function(te,J,pe){l[s.evaluationKey]=pe;var he=s.expression.evaluate(l);y.data[te+J+0]=Math.floor(255*he.r/he.a),y.data[te+J+1]=Math.floor(255*he.g/he.a),y.data[te+J+2]=Math.floor(255*he.b/he.a),y.data[te+J+3]=Math.floor(255*he.a)};if(s.clips)for(var E=0,S=0;E<m;++E,S+=4*u)for(var k=0,M=0;k<u;k++,M+=4){var P=k/(u-1),L=s.clips[E];b(S,M,L.start*(1-P)+L.end*P)}else for(var z=0,G=0;z<u;z++,G+=4)b(0,G,z/(u-1));return y}var Vw=function(s){function l(u){s.call(this,u,Bw),this._updateColorRamp()}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new rh(u)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},l.prototype._updateColorRamp=function(){this.colorRamp=qg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},l.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},l}(Ai),Uw={paint:new yi({"hillshade-illumination-direction":new tt(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(X.paint_hillshade["hillshade-accent-color"])})},zw=function(s){function l(u){s.call(this,u,Uw)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},l}(Ai),jw=Cn([{name:"a_pos",components:2,type:"Int16"}],4).members,rm=fo,mT=fo;function fo(s,l,u){u=u||2;var m,y,b,E,S,k,M,P=l&&l.length,L=P?l[0]*u:s.length,z=ed(s,0,L,u,!0),G=[];if(!z||z.next===z.prev)return G;if(P&&(z=function(J,pe,he,be){var ve,Ie,ke,Be=[];for(ve=0,Ie=pe.length;ve<Ie;ve++)(ke=ed(J,pe[ve]*be,ve<Ie-1?pe[ve+1]*be:J.length,be,!1))===ke.next&&(ke.steiner=!0),Be.push($w(ke));for(Be.sort(Hw),ve=0;ve<Be.length;ve++)Gg(Be[ve],he),he=zo(he,he.next);return he}(s,l,z,u)),s.length>80*u){m=b=s[0],y=E=s[1];for(var te=u;te<L;te+=u)(S=s[te])<m&&(m=S),(k=s[te+1])<y&&(y=k),S>b&&(b=S),k>E&&(E=k);M=0!==(M=Math.max(b-m,E-y))?1/M:0}return xn(z,G,u,m,y,M),G}function ed(s,l,u,m,y){var b,E;if(y===av(s,l,u,m)>0)for(b=l;b<u;b+=m)E=Zn(b,s[b],s[b+1],E);else for(b=u-m;b>=l;b-=m)E=Zn(b,s[b],s[b+1],E);return E&&om(E,E.next)&&(td(E),E=E.next),E}function zo(s,l){if(!s)return s;l||(l=s);var u,m=s;do{if(u=!1,m.steiner||!om(m,m.next)&&0!==cr(m.prev,m,m.next))m=m.next;else{if(td(m),(m=l=m.prev)===m.next)break;u=!0}}while(u||m!==l);return l}function xn(s,l,u,m,y,b,E){if(s){!E&&b&&function(P,L,z,G){var te=P;do{null===te.z&&(te.z=Wg(te.x,te.y,L,z,G)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next}while(te!==P);te.prevZ.nextZ=null,te.prevZ=null,function(J){var pe,he,be,ve,Ie,ke,Be,Ye,nt=1;do{for(he=J,J=null,Ie=null,ke=0;he;){for(ke++,be=he,Be=0,pe=0;pe<nt&&(Be++,be=be.nextZ);pe++);for(Ye=nt;Be>0||Ye>0&&be;)0!==Be&&(0===Ye||!be||he.z<=be.z)?(ve=he,he=he.nextZ,Be--):(ve=be,be=be.nextZ,Ye--),Ie?Ie.nextZ=ve:J=ve,ve.prevZ=Ie,Ie=ve;he=be}Ie.nextZ=null,nt*=2}while(ke>1)}(te)}(s,m,y,b);for(var S,k,M=s;s.prev!==s.next;)if(S=s.prev,k=s.next,b?Ri(s,m,y,b):gT(s))l.push(S.i/u),l.push(s.i/u),l.push(k.i/u),td(s),s=k.next,M=k.next;else if((s=k)===M){E?1===E?xn(s=_T(zo(s),l,u),l,u,m,y,b,2):2===E&&yT(s,l,u,m,y,b):xn(zo(s),l,u,m,y,b,1);break}}}function gT(s){var l=s.prev,u=s,m=s.next;if(cr(l,u,m)>=0)return!1;for(var y=s.next.next;y!==s.prev;){if(An(l.x,l.y,u.x,u.y,m.x,m.y,y.x,y.y)&&cr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function Ri(s,l,u,m){var y=s.prev,b=s,E=s.next;if(cr(y,b,E)>=0)return!1;for(var S=y.x>b.x?y.x>E.x?y.x:E.x:b.x>E.x?b.x:E.x,k=y.y>b.y?y.y>E.y?y.y:E.y:b.y>E.y?b.y:E.y,M=Wg(y.x<b.x?y.x<E.x?y.x:E.x:b.x<E.x?b.x:E.x,y.y<b.y?y.y<E.y?y.y:E.y:b.y<E.y?b.y:E.y,l,u,m),P=Wg(S,k,l,u,m),L=s.prevZ,z=s.nextZ;L&&L.z>=M&&z&&z.z<=P;){if(L!==s.prev&&L!==s.next&&An(y.x,y.y,b.x,b.y,E.x,E.y,L.x,L.y)&&cr(L.prev,L,L.next)>=0||(L=L.prevZ,z!==s.prev&&z!==s.next&&An(y.x,y.y,b.x,b.y,E.x,E.y,z.x,z.y)&&cr(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;L&&L.z>=M;){if(L!==s.prev&&L!==s.next&&An(y.x,y.y,b.x,b.y,E.x,E.y,L.x,L.y)&&cr(L.prev,L,L.next)>=0)return!1;L=L.prevZ}for(;z&&z.z<=P;){if(z!==s.prev&&z!==s.next&&An(y.x,y.y,b.x,b.y,E.x,E.y,z.x,z.y)&&cr(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function _T(s,l,u){var m=s;do{var y=m.prev,b=m.next.next;!om(y,b)&&qw(y,m,m.next,b)&&Ga(y,b)&&Ga(b,y)&&(l.push(y.i/u),l.push(m.i/u),l.push(b.i/u),td(m),td(m.next),m=s=b),m=m.next}while(m!==s);return zo(m)}function yT(s,l,u,m,y,b){var E=s;do{for(var S=E.next.next;S!==E.prev;){if(E.i!==S.i&&Wn(E,S)){var k=Gw(E,S);return E=zo(E,E.next),k=zo(k,k.next),xn(E,l,u,m,y,b),void xn(k,l,u,m,y,b)}S=S.next}E=E.next}while(E!==s)}function Hw(s,l){return s.x-l.x}function Gg(s,l){if(l=function(m,y){var b,E=y,S=m.x,k=m.y,M=-1/0;do{if(k<=E.y&&k>=E.next.y&&E.next.y!==E.y){var P=E.x+(k-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(P<=S&&P>M){if(M=P,P===S){if(k===E.y)return E;if(k===E.next.y)return E.next}b=E.x<E.next.x?E:E.next}}E=E.next}while(E!==y);if(!b)return null;if(S===M)return b;var L,z=b,G=b.x,te=b.y,J=1/0;E=b;do{S>=E.x&&E.x>=G&&S!==E.x&&An(k<te?S:M,k,G,te,k<te?M:S,k,E.x,E.y)&&(L=Math.abs(k-E.y)/(S-E.x),Ga(E,m)&&(L<J||L===J&&(E.x>b.x||E.x===b.x&&im(b,E)))&&(b=E,J=L)),E=E.next}while(E!==z);return b}(s,l)){var u=Gw(l,s);zo(l,l.next),zo(u,u.next)}}function im(s,l){return cr(s.prev,s,l.prev)<0&&cr(l.next,s,s.next)<0}function Wg(s,l,u,m,y){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-u)*y)|s<<8))|s<<4))|s<<2))|s<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-m)*y)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function $w(s){var l=s,u=s;do{(l.x<u.x||l.x===u.x&&l.y<u.y)&&(u=l),l=l.next}while(l!==s);return u}function An(s,l,u,m,y,b,E,S){return(y-E)*(l-S)-(s-E)*(b-S)>=0&&(s-E)*(m-S)-(u-E)*(l-S)>=0&&(u-E)*(b-S)-(y-E)*(m-S)>=0}function Wn(s,l){return s.next.i!==l.i&&s.prev.i!==l.i&&!function(u,m){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==m.i&&y.next.i!==m.i&&qw(y,y.next,u,m))return!0;y=y.next}while(y!==u);return!1}(s,l)&&(Ga(s,l)&&Ga(l,s)&&function(u,m){var y=u,b=!1,E=(u.x+m.x)/2,S=(u.y+m.y)/2;do{y.y>S!=y.next.y>S&&y.next.y!==y.y&&E<(y.next.x-y.x)*(S-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next}while(y!==u);return b}(s,l)&&(cr(s.prev,s,l.prev)||cr(s,l.prev,l))||om(s,l)&&cr(s.prev,s,s.next)>0&&cr(l.prev,l,l.next)>0)}function cr(s,l,u){return(l.y-s.y)*(u.x-l.x)-(l.x-s.x)*(u.y-l.y)}function om(s,l){return s.x===l.x&&s.y===l.y}function qw(s,l,u,m){var y=Zg(cr(s,l,u)),b=Zg(cr(s,l,m)),E=Zg(cr(u,m,s)),S=Zg(cr(u,m,l));return y!==b&&E!==S||!(0!==y||!sm(s,u,l))||!(0!==b||!sm(s,m,l))||!(0!==E||!sm(u,s,m))||!(0!==S||!sm(u,l,m))}function sm(s,l,u){return l.x<=Math.max(s.x,u.x)&&l.x>=Math.min(s.x,u.x)&&l.y<=Math.max(s.y,u.y)&&l.y>=Math.min(s.y,u.y)}function Zg(s){return s>0?1:s<0?-1:0}function Ga(s,l){return cr(s.prev,s,s.next)<0?cr(s,l,s.next)>=0&&cr(s,s.prev,l)>=0:cr(s,l,s.prev)<0||cr(s,s.next,l)<0}function Gw(s,l){var u=new Kg(s.i,s.x,s.y),m=new Kg(l.i,l.x,l.y),y=s.next,b=l.prev;return s.next=l,l.prev=s,u.next=y,y.prev=u,m.next=u,u.prev=m,b.next=m,m.prev=b,m}function Zn(s,l,u,m){var y=new Kg(s,l,u);return m?(y.next=m.next,y.prev=m,m.next.prev=y,m.next=y):(y.prev=y,y.next=y),y}function td(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Kg(s,l,u){this.i=s,this.x=l,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function av(s,l,u,m){for(var y=0,b=l,E=u-m;b<u;b+=m)y+=(s[E]-s[b])*(s[b+1]+s[E+1]),E=b;return y}function yO(s,l,u,m,y){!function b(E,S,k,M,P){for(;M>k;){if(M-k>600){var L=M-k+1,z=S-k+1,G=Math.log(L),te=.5*Math.exp(2*G/3),J=.5*Math.sqrt(G*te*(L-te)/L)*(z-L/2<0?-1:1);b(E,S,Math.max(k,Math.floor(S-z*te/L+J)),Math.min(M,Math.floor(S+(L-z)*te/L+J)),P)}var pe=E[S],he=k,be=M;for(ih(E,k,S),P(E[M],pe)>0&&ih(E,k,M);he<be;){for(ih(E,he,be),he++,be--;P(E[he],pe)<0;)he++;for(;P(E[be],pe)>0;)be--}0===P(E[k],pe)?ih(E,k,be):ih(E,++be,M),be<=S&&(k=be+1),S<=be&&(M=be-1)}}(s,l,u||0,m||s.length-1,y||Yg)}function ih(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}function Yg(s,l){return s<l?-1:s>l?1:0}function lv(s,l){var u=s.length;if(u<=1)return[s];for(var m,y,b=[],E=0;E<u;E++){var S=zp(s[E]);0!==S&&(s[E].area=Math.abs(S),void 0===y&&(y=S<0),y===S<0?(m&&b.push(m),m=[s[E]]):m.push(s[E]))}if(m&&b.push(m),l>1)for(var k=0;k<b.length;k++)b[k].length<=l||(yO(b[k],l,1,b[k].length-1,sn),b[k]=b[k].slice(0,l));return b}function sn(s,l){return l.area-s.area}function cv(s,l,u){for(var m=u.patternDependencies,y=!1,b=0,E=l;b<E.length;b+=1){var S=E[b].paint.get(s+"-pattern");S.isConstant()||(y=!0);var k=S.constantOr(null);k&&(y=!0,m[k.to]=!0,m[k.from]=!0)}return y}function am(s,l,u,m,y){for(var b=y.patternDependencies,E=0,S=l;E<S.length;E+=1){var k=S[E],M=k.paint.get(s+"-pattern").value;if("constant"!==M.kind){var P=M.evaluate({zoom:m-1},u,{},y.availableImages),L=M.evaluate({zoom:m},u,{},y.availableImages),z=M.evaluate({zoom:m+1},u,{},y.availableImages);L=L&&L.name?L.name:L,z=z&&z.name?z.name:z,b[P=P&&P.name?P.name:P]=!0,b[L]=!0,b[z]=!0,u.patterns[k.id]={min:P,mid:L,max:z}}}return u}fo.deviation=function(s,l,u,m){var y=l&&l.length,b=Math.abs(av(s,0,y?l[0]*u:s.length,u));if(y)for(var E=0,S=l.length;E<S;E++)b-=Math.abs(av(s,l[E]*u,E<S-1?l[E+1]*u:s.length,u));var k=0;for(E=0;E<m.length;E+=3){var M=m[E]*u,P=m[E+1]*u,L=m[E+2]*u;k+=Math.abs((s[M]-s[L])*(s[P+1]-s[M+1])-(s[M]-s[P])*(s[L+1]-s[M+1]))}return 0===b&&0===k?0:Math.abs((k-b)/b)},fo.flatten=function(s){for(var l=s[0][0].length,u={vertices:[],holes:[],dimensions:l},m=0,y=0;y<s.length;y++){for(var b=0;b<s[y].length;b++)for(var E=0;E<l;E++)u.vertices.push(s[y][b][E]);y>0&&u.holes.push(m+=s[y-1].length)}return u},rm.default=mT;var Cl=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Yu,this.indexArray=new Qs,this.indexArray2=new Rf,this.programConfigurations=new lr(s.layers,s.zoom),this.segments=new $,this.segments2=new $,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Cl.prototype.populate=function(s,l,u){this.hasPattern=cv("fill",this.layers,l);for(var m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],M=k.feature,P=k.id,L=k.index,z=k.sourceLayerIndex,G=this.layers[0]._featureFilter.needGeometry,te=Uo(M,G);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),te,u)){var J=y?m.evaluate(te,{},u,l.availableImages):void 0,pe={id:P,properties:M.properties,type:M.type,sourceLayerIndex:z,index:L,geometry:G?te.geometry:ei(M),patterns:{},sortKey:J};b.push(pe)}}y&&b.sort(function(nt,wt){return nt.sortKey-wt.sortKey});for(var he=0,be=b;he<be.length;he+=1){var ve=be[he],Ie=ve.geometry,ke=ve.index,Be=ve.sourceLayerIndex;if(this.hasPattern){var Ye=am("fill",this.layers,ve,this.zoom,l);this.patternFeatures.push(Ye)}else this.addFeature(ve,Ie,ke,u,{});l.featureIndex.insert(s[ke].feature,Ie,ke,Be,this.index)}},Cl.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},Cl.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},Cl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Cl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Cl.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jw),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0},Cl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Cl.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=lv(l,500);b<E.length;b+=1){for(var S=E[b],k=0,M=0,P=S;M<P.length;M+=1)k+=P[M].length;for(var L=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),z=L.vertexLength,G=[],te=[],J=0,pe=S;J<pe.length;J+=1){var he=pe[J];if(0!==he.length){he!==S[0]&&te.push(G.length/2);var be=this.segments2.prepareSegment(he.length,this.layoutVertexArray,this.indexArray2),ve=be.vertexLength;this.layoutVertexArray.emplaceBack(he[0].x,he[0].y),this.indexArray2.emplaceBack(ve+he.length-1,ve),G.push(he[0].x),G.push(he[0].y);for(var Ie=1;Ie<he.length;Ie++)this.layoutVertexArray.emplaceBack(he[Ie].x,he[Ie].y),this.indexArray2.emplaceBack(ve+Ie-1,ve+Ie),G.push(he[Ie].x),G.push(he[Ie].y);be.vertexLength+=he.length,be.primitiveLength+=he.length}}for(var ke=rm(G,te),Be=0;Be<ke.length;Be+=3)this.indexArray.emplaceBack(z+ke[Be],z+ke[Be+1],z+ke[Be+2]);L.vertexLength+=k,L.primitiveLength+=ke.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},lt("FillBucket",Cl,{omit:["layers","patternFeatures"]});var vT=new yi({"fill-sort-key":new Ot(X.layout_fill["fill-sort-key"])}),uv={paint:new yi({"fill-antialias":new tt(X.paint_fill["fill-antialias"]),"fill-opacity":new Ot(X.paint_fill["fill-opacity"]),"fill-color":new Ot(X.paint_fill["fill-color"]),"fill-outline-color":new Ot(X.paint_fill["fill-outline-color"]),"fill-translate":new tt(X.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new _i(X.paint_fill["fill-pattern"])}),layout:vT},Ww=function(s){function l(u){s.call(this,u,uv)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m);var y=this.paint._values["fill-outline-color"];"constant"===y.value.kind&&void 0===y.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},l.prototype.createBucket=function(u){return new Cl(u)},l.prototype.queryRadius=function(){return uc(this.paint.get("fill-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){return Me(ea(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,k),b)},l.prototype.isTileClipped=function(){return!0},l}(Ai),Zw=Cn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Kw=Nf;function Nf(s,l,u,m,y){this.properties={},this.extent=u,this.type=0,this._pbf=s,this._geometry=-1,this._keys=m,this._values=y,s.readFields(bT,this,l)}function bT(s,l,u){1==s?l.id=u.readVarint():2==s?function(m,y){for(var b=m.readVarint()+m.pos;m.pos<b;){var E=y._keys[m.readVarint()],S=y._values[m.readVarint()];y.properties[E]=S}}(u,l):3==s?l.type=u.readVarint():4==s&&(l._geometry=u.pos)}function Yw(s){for(var l,u,m=0,y=0,b=s.length,E=b-1;y<b;E=y++)m+=((u=s[E]).x-(l=s[y]).x)*(l.y+u.y);return m}Nf.types=["Unknown","Point","LineString","Polygon"],Nf.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var l,u=s.readVarint()+s.pos,m=1,y=0,b=0,E=0,S=[];s.pos<u;){if(y<=0){var k=s.readVarint();m=7&k,y=k>>3}if(y--,1===m||2===m)b+=s.readSVarint(),E+=s.readSVarint(),1===m&&(l&&S.push(l),l=[]),l.push(new Wt(b,E));else{if(7!==m)throw new Error("unknown command "+m);l&&l.push(l[0].clone())}}return l&&S.push(l),S},Nf.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var l=s.readVarint()+s.pos,u=1,m=0,y=0,b=0,E=1/0,S=-1/0,k=1/0,M=-1/0;s.pos<l;){if(m<=0){var P=s.readVarint();u=7&P,m=P>>3}if(m--,1===u||2===u)(y+=s.readSVarint())<E&&(E=y),y>S&&(S=y),(b+=s.readSVarint())<k&&(k=b),b>M&&(M=b);else if(7!==u)throw new Error("unknown command "+u)}return[E,k,S,M]},Nf.prototype.toGeoJSON=function(s,l,u){var m,y,b=this.extent*Math.pow(2,u),E=this.extent*s,S=this.extent*l,k=this.loadGeometry(),M=Nf.types[this.type];function P(G){for(var te=0;te<G.length;te++){var J=G[te];G[te]=[360*(J.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+S)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(m=0;m<k.length;m++)L[m]=k[m][0];P(k=L);break;case 2:for(m=0;m<k.length;m++)P(k[m]);break;case 3:for(k=function(G){var te=G.length;if(te<=1)return[G];for(var J,pe,he=[],be=0;be<te;be++){var ve=Yw(G[be]);0!==ve&&(void 0===pe&&(pe=ve<0),pe===ve<0?(J&&he.push(J),J=[G[be]]):J.push(G[be]))}return J&&he.push(J),he}(k),m=0;m<k.length;m++)for(y=0;y<k[m].length;y++)P(k[m][y])}1===k.length?k=k[0]:M="Multi"+M;var z={type:"Feature",geometry:{type:M,coordinates:k},properties:this.properties};return"id"in this&&(z.id=this.id),z};var Of=Dl;function Dl(s,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Xw,this,l),this.length=this._features.length}function Xw(s,l,u){15===s?l.version=u.readVarint():1===s?l.name=u.readString():5===s?l.extent=u.readVarint():2===s?l._features.push(u.pos):3===s?l._keys.push(u.readString()):4===s&&l._values.push(function(m){for(var y=null,b=m.readVarint()+m.pos;m.pos<b;){var E=m.readVarint()>>3;y=1===E?m.readString():2===E?m.readFloat():3===E?m.readDouble():4===E?m.readVarint64():5===E?m.readVarint():6===E?m.readSVarint():7===E?m.readBoolean():null}return y}(u))}function wT(s,l,u){if(3===s){var m=new Of(u,u.readVarint()+u.pos);m.length&&(l[m.name]=m)}}Dl.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var l=this._pbf.readVarint()+this._pbf.pos;return new Kw(this._pbf,l,this.extent,this._keys,this._values)};var lm={VectorTile:function(s,l){this.layers=s.readFields(wT,{},l)},VectorTileFeature:Kw,VectorTileLayer:Of},vO=lm.VectorTileFeature.types,Pi=Math.pow(2,13);function oh(s,l,u,m,y,b,E,S){s.emplaceBack(l,u,2*Math.floor(m*Pi)+E,y*Pi*2,b*Pi*2,Math.round(S))}var fc=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Xi,this.indexArray=new Qs,this.programConfigurations=new lr(s.layers,s.zoom),this.segments=new $,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function dv(s,l){return s.x===l.x&&(s.x<0||s.x>8192)||s.y===l.y&&(s.y<0||s.y>8192)}fc.prototype.populate=function(s,l,u){this.features=[],this.hasPattern=cv("fill-extrusion",this.layers,l);for(var m=0,y=s;m<y.length;m+=1){var b=y[m],E=b.feature,S=b.id,k=b.index,M=b.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,L=Uo(E,P);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),L,u)){var z={id:S,sourceLayerIndex:M,index:k,geometry:P?L.geometry:ei(E),properties:E.properties,type:E.type,patterns:{}};this.hasPattern?this.features.push(am("fill-extrusion",this.layers,z,this.zoom,l)):this.addFeature(z,z.geometry,k,u,{}),l.featureIndex.insert(E,z.geometry,k,M,this.index,!0)}}},fc.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.features;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},fc.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},fc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},fc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fc.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zw),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},fc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},fc.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=lv(l,500);b<E.length;b+=1){for(var S=E[b],k=0,M=0,P=S;M<P.length;M+=1)k+=P[M].length;for(var L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),z=0,G=S;z<G.length;z+=1){var te=G[z];if(0!==te.length&&!((yn=te).every(function(on){return on.x<0})||yn.every(function(on){return on.x>8192})||yn.every(function(on){return on.y<0})||yn.every(function(on){return on.y>8192})))for(var J=0,pe=0;pe<te.length;pe++){var he=te[pe];if(pe>=1){var be=te[pe-1];if(!dv(he,be)){L.vertexLength+4>$.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ve=he.sub(be)._perp()._unit(),Ie=be.dist(he);J+Ie>32768&&(J=0),oh(this.layoutVertexArray,he.x,he.y,ve.x,ve.y,0,0,J),oh(this.layoutVertexArray,he.x,he.y,ve.x,ve.y,0,1,J),oh(this.layoutVertexArray,be.x,be.y,ve.x,ve.y,0,0,J+=Ie),oh(this.layoutVertexArray,be.x,be.y,ve.x,ve.y,0,1,J);var ke=L.vertexLength;this.indexArray.emplaceBack(ke,ke+2,ke+1),this.indexArray.emplaceBack(ke+1,ke+2,ke+3),L.vertexLength+=4,L.primitiveLength+=2}}}}if(L.vertexLength+k>$.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),"Polygon"===vO[s.type]){for(var Be=[],Ye=[],nt=L.vertexLength,wt=0,it=S;wt<it.length;wt+=1){var At=it[wt];if(0!==At.length){At!==S[0]&&Ye.push(Be.length/2);for(var at=0;at<At.length;at++){var fn=At[at];oh(this.layoutVertexArray,fn.x,fn.y,0,0,1,1,0),Be.push(fn.x),Be.push(fn.y)}}}for(var Vt=rm(Be,Ye),vt=0;vt<Vt.length;vt+=3)this.indexArray.emplaceBack(nt+Vt[vt],nt+Vt[vt+2],nt+Vt[vt+1]);L.primitiveLength+=Vt.length/3,L.vertexLength+=k}}var yn;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},lt("FillExtrusionBucket",fc,{omit:["layers","features"]});var xT={paint:new yi({"fill-extrusion-opacity":new tt(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ot(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _i(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ot(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ot(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Lf=function(s){function l(u){s.call(this,u,xT)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new fc(u)},l.prototype.queryRadius=function(){return uc(this.paint.get("fill-extrusion-translate"))},l.prototype.is3D=function(){return!0},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,M){var P=ea(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,k),L=this.paint.get("fill-extrusion-height").evaluate(m,y),z=this.paint.get("fill-extrusion-base").evaluate(m,y),G=function(J,pe){for(var ve=[],Ie=0,ke=J;Ie<ke.length;Ie+=1){var Be=ke[Ie],Ye=[Be.x,Be.y,0,1];Pf(Ye,Ye,pe),ve.push(new Wt(Ye[0]/Ye[3],Ye[1]/Ye[3]))}return ve}(P,M),te=function(J,pe,he,be){for(var ve=[],Ie=[],ke=be[8]*pe,Be=be[9]*pe,Ye=be[10]*pe,nt=be[11]*pe,wt=be[8]*he,it=be[9]*he,At=be[10]*he,at=be[11]*he,fn=0,Vt=J;fn<Vt.length;fn+=1){for(var vt=[],yn=[],on=0,Dn=Vt[fn];on<Dn.length;on+=1){var Mt=Dn[on],Mn=Mt.x,Cr=Mt.y,zr=be[0]*Mn+be[4]*Cr+be[12],Or=be[1]*Mn+be[5]*Cr+be[13],Dr=be[2]*Mn+be[6]*Cr+be[14],Wr=be[3]*Mn+be[7]*Cr+be[15],Ni=Dr+Ye,Oi=Wr+nt,$o=zr+wt,eo=Or+it,qo=Dr+At,ni=Wr+at,Li=new Wt((zr+ke)/Oi,(Or+Be)/Oi);Li.z=Ni/Oi,vt.push(Li);var bn=new Wt($o/ni,eo/ni);bn.z=qo/ni,yn.push(bn)}ve.push(vt),Ie.push(yn)}return[ve,Ie]}(b,z,L,M);return function(J,pe,he){var be=1/0;Me(he,pe)&&(be=ET(he,pe[0]));for(var ve=0;ve<pe.length;ve++)for(var Ie=pe[ve],ke=J[ve],Be=0;Be<Ie.length-1;Be++){var Ye=Ie[Be],nt=[Ye,Ie[Be+1],ke[Be+1],ke[Be],Ye];Le(he,nt)&&(be=Math.min(be,ET(he,nt)))}return be!==1/0&&be}(te[0],te[1],G)},l}(Ai);function nd(s,l){return s.x*l.x+s.y*l.y}function ET(s,l){if(1===s.length){for(var u,m=0,y=l[m++];!u||y.equals(u);)if(!(u=l[m++]))return 1/0;for(;m<l.length;m++){var b=l[m],E=s[0],S=u.sub(y),k=b.sub(y),M=E.sub(y),P=nd(S,S),L=nd(S,k),z=nd(k,k),G=nd(M,S),te=nd(M,k),J=P*z-L*L,pe=(z*G-L*te)/J,he=(P*te-L*G)/J,be=y.z*(1-pe-he)+u.z*pe+b.z*he;if(isFinite(be))return be}return 1/0}for(var ve=1/0,Ie=0,ke=l;Ie<ke.length;Ie+=1)ve=Math.min(ve,ke[Ie].z);return ve}var Qw=Cn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,hv=Cn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Jw=lm.VectorTileFeature.types,CT=Math.cos(Math.PI/180*37.5),Xg=Math.pow(2,14)/.5,Do=function(s){var l=this;this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){l.gradients[u.id]={}}),this.layoutVertexArray=new ps,this.layoutVertexArray2=new ms,this.indexArray=new Qs,this.programConfigurations=new lr(s.layers,s.zoom),this.segments=new $,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Do.prototype.populate=function(s,l,u){this.hasPattern=cv("line",this.layers,l);for(var m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],M=k.feature,P=k.id,L=k.index,z=k.sourceLayerIndex,G=this.layers[0]._featureFilter.needGeometry,te=Uo(M,G);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),te,u)){var J=y?m.evaluate(te,{},u):void 0,pe={id:P,properties:M.properties,type:M.type,sourceLayerIndex:z,index:L,geometry:G?te.geometry:ei(M),patterns:{},sortKey:J};b.push(pe)}}y&&b.sort(function(nt,wt){return nt.sortKey-wt.sortKey});for(var he=0,be=b;he<be.length;he+=1){var ve=be[he],Ie=ve.geometry,ke=ve.index,Be=ve.sourceLayerIndex;if(this.hasPattern){var Ye=am("line",this.layers,ve,this.zoom,l);this.patternFeatures.push(Ye)}else this.addFeature(ve,Ie,ke,u,{});l.featureIndex.insert(s[ke].feature,Ie,ke,Be,this.index)}},Do.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},Do.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},Do.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Do.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Do.prototype.upload=function(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,hv)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Qw),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},Do.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Do.prototype.lineFeatureClips=function(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}},Do.prototype.addFeature=function(s,l,u,m,y){var b=this.layers[0].layout,E=b.get("line-join").evaluate(s,{}),S=b.get("line-cap"),k=b.get("line-miter-limit"),M=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(var P=0,L=l;P<L.length;P+=1)this.addLine(L[P],s,E,S,k,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},Do.prototype.addLine=function(s,l,u,m,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var E=0;E<s.length-1;E++)this.totalDistance+=s[E].dist(s[E+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S="Polygon"===Jw[l.type],k=s.length;k>=2&&s[k-1].equals(s[k-2]);)k--;for(var M=0;M<k-1&&s[M].equals(s[M+1]);)M++;if(!(k<(S?3:2))){"bevel"===u&&(y=1.05);var P,L=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray),G=void 0,te=void 0,J=void 0,pe=void 0;this.e1=this.e2=-1,S&&(pe=s[M].sub(P=s[k-2])._unit()._perp());for(var he=M;he<k;he++)if(!(te=he===k-1?S?s[M+1]:void 0:s[he+1])||!s[he].equals(te)){pe&&(J=pe),P&&(G=P),P=s[he],pe=te?te.sub(P)._unit()._perp():J;var be=(J=J||pe).add(pe);0===be.x&&0===be.y||be._unit();var ve=J.x*pe.x+J.y*pe.y,Ie=be.x*pe.x+be.y*pe.y,ke=0!==Ie?1/Ie:1/0,Be=2*Math.sqrt(2-2*Ie),Ye=Ie<CT&&G&&te,nt=J.x*pe.y-J.y*pe.x>0;if(Ye&&he>M){var wt=P.dist(G);if(wt>2*L){var it=P.sub(P.sub(G)._mult(L/wt)._round());this.updateDistance(G,it),this.addCurrentVertex(it,J,0,0,z),G=it}}var At=G&&te,at=At?u:S?"butt":m;if(At&&"round"===at&&(ke<b?at="miter":ke<=2&&(at="fakeround")),"miter"===at&&ke>y&&(at="bevel"),"bevel"===at&&(ke>2&&(at="flipbevel"),ke<y&&(at="miter")),G&&this.updateDistance(G,P),"miter"===at)be._mult(ke),this.addCurrentVertex(P,be,0,0,z);else if("flipbevel"===at){if(ke>100)be=pe.mult(-1);else{var fn=ke*J.add(pe).mag()/J.sub(pe).mag();be._perp()._mult(fn*(nt?-1:1))}this.addCurrentVertex(P,be,0,0,z),this.addCurrentVertex(P,be.mult(-1),0,0,z)}else if("bevel"===at||"fakeround"===at){var Vt=-Math.sqrt(ke*ke-1),vt=nt?Vt:0,yn=nt?0:Vt;if(G&&this.addCurrentVertex(P,J,vt,yn,z),"fakeround"===at)for(var on=Math.round(180*Be/Math.PI/20),Dn=1;Dn<on;Dn++){var Mt=Dn/on;if(.5!==Mt){var Mn=Mt-.5;Mt+=Mt*Mn*(Mt-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*Mn*Mn+(.848013+ve*(.215638*ve-1.06021)))}var Cr=pe.sub(J)._mult(Mt)._add(J)._unit()._mult(nt?-1:1);this.addHalfVertex(P,Cr.x,Cr.y,!1,nt,0,z)}te&&this.addCurrentVertex(P,pe,-vt,-yn,z)}else if("butt"===at)this.addCurrentVertex(P,be,0,0,z);else if("square"===at){var zr=G?1:-1;this.addCurrentVertex(P,be,zr,zr,z)}else"round"===at&&(G&&(this.addCurrentVertex(P,J,0,0,z),this.addCurrentVertex(P,J,1,1,z,!0)),te&&(this.addCurrentVertex(P,pe,-1,-1,z,!0),this.addCurrentVertex(P,pe,0,0,z)));if(Ye&&he<k-1){var Or=P.dist(te);if(Or>2*L){var Dr=P.add(te.sub(P)._mult(L/Or)._round());this.updateDistance(P,Dr),this.addCurrentVertex(Dr,pe,0,0,z),P=Dr}}}}},Do.prototype.addCurrentVertex=function(s,l,u,m,y,b){void 0===b&&(b=!1);var E=l.y*m-l.x,S=-l.y-l.x*m;this.addHalfVertex(s,l.x+l.y*u,l.y-l.x*u,b,!1,u,y),this.addHalfVertex(s,E,S,b,!0,-m,y),this.distance>Xg/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(s,l,u,m,y,b))},Do.prototype.addHalfVertex=function(s,l,u,m,y,b,E){var S=.5*(this.lineClips?this.scaledDistance*(Xg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s.x<<1)+(m?1:0),(s.y<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(0===b?0:b<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var k=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),E.primitiveLength++),y?this.e2=k:this.e1=k},Do.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Do.prototype.updateDistance=function(s,l){this.distance+=s.dist(l),this.updateScaledDistance()},lt("LineBucket",Do,{omit:["layers","patternFeatures"]});var ex=new yi({"line-cap":new tt(X.layout_line["line-cap"]),"line-join":new Ot(X.layout_line["line-join"]),"line-miter-limit":new tt(X.layout_line["line-miter-limit"]),"line-round-limit":new tt(X.layout_line["line-round-limit"]),"line-sort-key":new Ot(X.layout_line["line-sort-key"])}),tx={paint:new yi({"line-opacity":new Ot(X.paint_line["line-opacity"]),"line-color":new Ot(X.paint_line["line-color"]),"line-translate":new tt(X.paint_line["line-translate"]),"line-translate-anchor":new tt(X.paint_line["line-translate-anchor"]),"line-width":new Ot(X.paint_line["line-width"]),"line-gap-width":new Ot(X.paint_line["line-gap-width"]),"line-offset":new Ot(X.paint_line["line-offset"]),"line-blur":new Ot(X.paint_line["line-blur"]),"line-dasharray":new Lt(X.paint_line["line-dasharray"]),"line-pattern":new _i(X.paint_line["line-pattern"]),"line-gradient":new fa(X.paint_line["line-gradient"])}),layout:ex},nx=new(function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m){return m=new Kt(Math.floor(m.zoom),{now:m.now,fadeDuration:m.fadeDuration,zoomHistory:m.zoomHistory,transition:m.transition}),s.prototype.possiblyEvaluate.call(this,u,m)},l.prototype.evaluate=function(u,m,y,b){return m=Ui({},m,{zoom:Math.floor(m.zoom)}),s.prototype.evaluate.call(this,u,m,y,b)},l}(Ot))(tx.paint.properties["line-width"].specification);nx.useIntegerZoom=!0;var DT=function(s){function l(u){s.call(this,u,tx),this.gradientVersion=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof La,this.gradientVersion=(this.gradientVersion+1)%Hl)},l.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m),this.paint._values["line-floorwidth"]=nx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},l.prototype.createBucket=function(u){return new Do(u)},l.prototype.queryRadius=function(u){var m=u,y=rx(Mi("line-width",this,m),Mi("line-gap-width",this,m)),b=Mi("line-offset",this,m);return y/2+Math.abs(b)+uc(this.paint.get("line-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){var M=ea(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,k),P=k/2*rx(this.paint.get("line-width").evaluate(m,y),this.paint.get("line-gap-width").evaluate(m,y)),L=this.paint.get("line-offset").evaluate(m,y);return L&&(b=function(z,G){for(var te=[],J=new Wt(0,0),pe=0;pe<z.length;pe++){for(var he=z[pe],be=[],ve=0;ve<he.length;ve++){var Ie=he[ve],ke=he[ve+1],Be=0===ve?J:Ie.sub(he[ve-1])._unit()._perp(),Ye=ve===he.length-1?J:ke.sub(Ie)._unit()._perp(),nt=Be._add(Ye)._unit();nt._mult(1/(nt.x*Ye.x+nt.y*Ye.y)),be.push(nt._mult(G)._add(Ie))}te.push(be)}return te}(b,L*k)),function(z,G,te){for(var J=0;J<G.length;J++){var pe=G[J];if(z.length>=3)for(var he=0;he<pe.length;he++)if(ma(z,pe[he]))return!0;if(Oe(z,pe,te))return!0}return!1}(M,b,P)},l.prototype.isTileClipped=function(){return!0},l}(Ai);function rx(s,l){return l>0?l+2*s:s}var ix=Cn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Er=Cn([{name:"a_projected_pos",components:3,type:"Float32"}],4),ox=(Cn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Cn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),fe=(Cn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Cn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),TT=Cn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function jo(s,l,u){return s.sections.forEach(function(m){var y,E,S;m.text=(y=m.text,E=u,"uppercase"===(S=l.layout.get("text-transform").evaluate(E,{}))?y=y.toLocaleUpperCase():"lowercase"===S&&(y=y.toLocaleLowerCase()),ar.applyArabicShaping&&(y=ar.applyArabicShaping(y)),y)}),s}Cn([{name:"triangle",components:3,type:"Uint16"}]),Cn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Cn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Cn([{type:"Float32",name:"offsetX"}]),Cn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var li={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},mr=function(s,l,u,m,y){var b,E,S=8*y-m-1,k=(1<<S)-1,M=k>>1,P=-7,L=u?y-1:0,z=u?-1:1,G=s[l+L];for(L+=z,b=G&(1<<-P)-1,G>>=-P,P+=S;P>0;b=256*b+s[l+L],L+=z,P-=8);for(E=b&(1<<-P)-1,b>>=-P,P+=m;P>0;E=256*E+s[l+L],L+=z,P-=8);if(0===b)b=1-M;else{if(b===k)return E?NaN:1/0*(G?-1:1);E+=Math.pow(2,m),b-=M}return(G?-1:1)*E*Math.pow(2,b-m)},pc=function(s,l,u,m,y,b){var E,S,k,M=8*b-y-1,P=(1<<M)-1,L=P>>1,z=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,G=m?0:b-1,te=m?1:-1,J=l<0||0===l&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(S=isNaN(l)?1:0,E=P):(E=Math.floor(Math.log(l)/Math.LN2),l*(k=Math.pow(2,-E))<1&&(E--,k*=2),(l+=E+L>=1?z/k:z*Math.pow(2,1-L))*k>=2&&(E++,k/=2),E+L>=P?(S=0,E=P):E+L>=1?(S=(l*k-1)*Math.pow(2,y),E+=L):(S=l*Math.pow(2,L-1)*Math.pow(2,y),E=0));y>=8;s[u+G]=255&S,G+=te,S/=256,y-=8);for(E=E<<y|S,M+=y;M>0;s[u+G]=255&E,G+=te,E/=256,M-=8);s[u+G-te]|=128*J},nu=Kn;function Kn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Kn.Varint=0,Kn.Fixed64=1,Kn.Bytes=2,Kn.Fixed32=5;var sh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function mc(s){return s.type===Kn.Bytes?s.readVarint()+s.pos:s.pos+1}function ah(s,l,u){var m=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));u.realloc(m);for(var y=u.pos-1;y>=s;y--)u.buf[y+m]=u.buf[y]}function bO(s,l){for(var u=0;u<s.length;u++)l.writeVarint(s[u])}function ST(s,l){for(var u=0;u<s.length;u++)l.writeSVarint(s[u])}function IT(s,l){for(var u=0;u<s.length;u++)l.writeFloat(s[u])}function kT(s,l){for(var u=0;u<s.length;u++)l.writeDouble(s[u])}function AT(s,l){for(var u=0;u<s.length;u++)l.writeBoolean(s[u])}function MT(s,l){for(var u=0;u<s.length;u++)l.writeFixed32(s[u])}function Wa(s,l){for(var u=0;u<s.length;u++)l.writeSFixed32(s[u])}function sx(s,l){for(var u=0;u<s.length;u++)l.writeFixed64(s[u])}function RT(s,l){for(var u=0;u<s.length;u++)l.writeSFixed64(s[u])}function id(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+16777216*s[l+3]}function Ff(s,l,u){s[u]=l,s[u+1]=l>>>8,s[u+2]=l>>>16,s[u+3]=l>>>24}function ax(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+(s[l+3]<<24)}function PT(s,l,u){1===s&&u.readMessage(NT,l)}function NT(s,l,u){if(3===s){var m=u.readMessage(OT,{}),y=m.width,b=m.height,E=m.left,S=m.top,k=m.advance;l.push({id:m.id,bitmap:new hc({width:y+6,height:b+6},m.bitmap),metrics:{width:y,height:b,left:E,top:S,advance:k}})}}function OT(s,l,u){1===s?l.id=u.readVarint():2===s?l.bitmap=u.readBytes():3===s?l.width=u.readVarint():4===s?l.height=u.readVarint():5===s?l.left=u.readSVarint():6===s?l.top=u.readSVarint():7===s&&(l.advance=u.readVarint())}function lx(s){for(var l=0,u=0,m=0,y=s;m<y.length;m+=1){var b=y[m];l+=b.w*b.h,u=Math.max(u,b.w)}s.sort(function(J,pe){return pe.h-J.h});for(var E=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),u),h:1/0}],S=0,k=0,M=0,P=s;M<P.length;M+=1)for(var L=P[M],z=E.length-1;z>=0;z--){var G=E[z];if(!(L.w>G.w||L.h>G.h)){if(L.x=G.x,L.y=G.y,k=Math.max(k,L.y+L.h),S=Math.max(S,L.x+L.w),L.w===G.w&&L.h===G.h){var te=E.pop();z<E.length&&(E[z]=te)}else L.h===G.h?(G.x+=L.w,G.w-=L.w):L.w===G.w?(G.y+=L.h,G.h-=L.h):(E.push({x:G.x+L.w,y:G.y,w:G.w-L.w,h:L.h}),G.y+=L.h,G.h-=L.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}Kn.prototype={destroy:function(){this.buf=null},readFields:function(s,l,u){for(u=u||this.length;this.pos<u;){var m=this.readVarint(),y=m>>3,b=this.pos;this.type=7&m,s(y,l,this),this.pos===b&&this.skip(m)}return l},readMessage:function(s,l){return this.readFields(s,l,this.readVarint()+this.pos)},readFixed32:function(){var s=id(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=ax(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=id(this.buf,this.pos)+4294967296*id(this.buf,this.pos+4);return this.pos+=8,s},readSFixed64:function(){var s=id(this.buf,this.pos)+4294967296*ax(this.buf,this.pos+4);return this.pos+=8,s},readFloat:function(){var s=mr(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=mr(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var l,u,m=this.buf;return l=127&(u=m[this.pos++]),u<128?l:(l|=(127&(u=m[this.pos++]))<<7,u<128?l:(l|=(127&(u=m[this.pos++]))<<14,u<128?l:(l|=(127&(u=m[this.pos++]))<<21,u<128?l:function(y,b,E){var S,k,M=E.buf;if(S=(112&(k=M[E.pos++]))>>4,k<128||(S|=(127&(k=M[E.pos++]))<<3,k<128)||(S|=(127&(k=M[E.pos++]))<<10,k<128)||(S|=(127&(k=M[E.pos++]))<<17,k<128)||(S|=(127&(k=M[E.pos++]))<<24,k<128)||(S|=(1&(k=M[E.pos++]))<<31,k<128))return function rd(s,l,u){return u?4294967296*l+(s>>>0):4294967296*(l>>>0)+(s>>>0)}(y,S,b);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(u=m[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,l=this.pos;return this.pos=s,s-l>=12&&sh?sh.decode(this.buf.subarray(l,s)):function(u,m,y){for(var b="",E=m;E<y;){var S,k,M,P=u[E],L=null,z=P>239?4:P>223?3:P>191?2:1;if(E+z>y)break;1===z?P<128&&(L=P):2===z?128==(192&(S=u[E+1]))&&(L=(31&P)<<6|63&S)<=127&&(L=null):3===z?(k=u[E+2],128==(192&(S=u[E+1]))&&128==(192&k)&&((L=(15&P)<<12|(63&S)<<6|63&k)<=2047||L>=55296&&L<=57343)&&(L=null)):4===z&&(k=u[E+2],M=u[E+3],128==(192&(S=u[E+1]))&&128==(192&k)&&128==(192&M)&&((L=(15&P)<<18|(63&S)<<12|(63&k)<<6|63&M)<=65535||L>=1114112)&&(L=null)),null===L?(L=65533,z=1):L>65535&&(L-=65536,b+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),b+=String.fromCharCode(L),E+=z}return b}(this.buf,l,s)},readBytes:function(){var s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l},readPackedVarint:function(s,l){if(this.type!==Kn.Bytes)return s.push(this.readVarint(l));var u=mc(this);for(s=s||[];this.pos<u;)s.push(this.readVarint(l));return s},readPackedSVarint:function(s){if(this.type!==Kn.Bytes)return s.push(this.readSVarint());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Kn.Bytes)return s.push(this.readBoolean());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Kn.Bytes)return s.push(this.readFloat());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Kn.Bytes)return s.push(this.readDouble());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Kn.Bytes)return s.push(this.readFixed32());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Kn.Bytes)return s.push(this.readSFixed32());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Kn.Bytes)return s.push(this.readFixed64());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Kn.Bytes)return s.push(this.readSFixed64());var l=mc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed64());return s},skip:function(s){var l=7&s;if(l===Kn.Varint)for(;this.buf[this.pos++]>127;);else if(l===Kn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Kn.Fixed32)this.pos+=4;else{if(l!==Kn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(s,l){this.writeVarint(s<<3|l)},realloc:function(s){for(var l=this.length||16;l<this.pos+s;)l*=2;if(l!==this.length){var u=new Uint8Array(l);u.set(this.buf),this.buf=u,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Ff(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Ff(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Ff(this.buf,-1&s,this.pos),Ff(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Ff(this.buf,-1&s,this.pos),Ff(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(l,u){var m,y,b,S;if(l>=0?(m=l%4294967296|0,y=l/4294967296|0):(y=~(-l/4294967296),4294967295^(m=~(-l%4294967296))?m=m+1|0:(m=0,y=y+1|0)),l>=0x10000000000000000||l<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),b=m,(S=u).buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,S.buf[S.pos]=127&(b>>>=7),function(b,E){var S=(7&b)<<4;E.buf[E.pos++]|=S|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(y,u)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var l=this.pos;this.pos=function(m,y,b){for(var E,S,k=0;k<y.length;k++){if((E=y.charCodeAt(k))>55295&&E<57344){if(!S){E>56319||k+1===y.length?(m[b++]=239,m[b++]=191,m[b++]=189):S=E;continue}if(E<56320){m[b++]=239,m[b++]=191,m[b++]=189,S=E;continue}E=S-55296<<10|E-56320|65536,S=null}else S&&(m[b++]=239,m[b++]=191,m[b++]=189,S=null);E<128?m[b++]=E:(E<2048?m[b++]=E>>6|192:(E<65536?m[b++]=E>>12|224:(m[b++]=E>>18|240,m[b++]=E>>12&63|128),m[b++]=E>>6&63|128),m[b++]=63&E|128)}return b}(this.buf,s,this.pos);var u=this.pos-l;u>=128&&ah(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeFloat:function(s){this.realloc(4),pc(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),pc(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var l=s.length;this.writeVarint(l),this.realloc(l);for(var u=0;u<l;u++)this.buf[this.pos++]=s[u]},writeRawMessage:function(s,l){this.pos++;var u=this.pos;s(l,this);var m=this.pos-u;m>=128&&ah(u,m,this),this.pos=u-1,this.writeVarint(m),this.pos+=m},writeMessage:function(s,l,u){this.writeTag(s,Kn.Bytes),this.writeRawMessage(l,u)},writePackedVarint:function(s,l){l.length&&this.writeMessage(s,bO,l)},writePackedSVarint:function(s,l){l.length&&this.writeMessage(s,ST,l)},writePackedBoolean:function(s,l){l.length&&this.writeMessage(s,AT,l)},writePackedFloat:function(s,l){l.length&&this.writeMessage(s,IT,l)},writePackedDouble:function(s,l){l.length&&this.writeMessage(s,kT,l)},writePackedFixed32:function(s,l){l.length&&this.writeMessage(s,MT,l)},writePackedSFixed32:function(s,l){l.length&&this.writeMessage(s,Wa,l)},writePackedFixed64:function(s,l){l.length&&this.writeMessage(s,sx,l)},writePackedSFixed64:function(s,l){l.length&&this.writeMessage(s,RT,l)},writeBytesField:function(s,l){this.writeTag(s,Kn.Bytes),this.writeBytes(l)},writeFixed32Field:function(s,l){this.writeTag(s,Kn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(s,l){this.writeTag(s,Kn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(s,l){this.writeTag(s,Kn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(s,l){this.writeTag(s,Kn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(s,l){this.writeTag(s,Kn.Varint),this.writeVarint(l)},writeSVarintField:function(s,l){this.writeTag(s,Kn.Varint),this.writeSVarint(l)},writeStringField:function(s,l){this.writeTag(s,Kn.Bytes),this.writeString(l)},writeFloatField:function(s,l){this.writeTag(s,Kn.Fixed32),this.writeFloat(l)},writeDoubleField:function(s,l){this.writeTag(s,Kn.Fixed64),this.writeDouble(l)},writeBooleanField:function(s,l){this.writeVarintField(s,!!l)}};var Bf=function(s,l){var u=l.pixelRatio,m=l.version,y=l.stretchX,b=l.stretchY,E=l.content;this.paddedRect=s,this.pixelRatio=u,this.stretchX=y,this.stretchY=b,this.content=E,this.version=m},od={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};od.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},od.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},od.tlbr.get=function(){return this.tl.concat(this.br)},od.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Bf.prototype,od);var Vf=function(s,l){var u={},m={};this.haveRenderCallbacks=[];var y=[];this.addImages(s,u,y),this.addImages(l,m,y);var b=lx(y),E=new gs({width:b.w||1,height:b.h||1});for(var S in s){var k=s[S],M=u[S].paddedRect;gs.copy(k.data,E,{x:0,y:0},{x:M.x+1,y:M.y+1},k.data)}for(var P in l){var L=l[P],z=m[P].paddedRect,G=z.x+1,te=z.y+1,J=L.data.width,pe=L.data.height;gs.copy(L.data,E,{x:0,y:0},{x:G,y:te},L.data),gs.copy(L.data,E,{x:0,y:pe-1},{x:G,y:te-1},{width:J,height:1}),gs.copy(L.data,E,{x:0,y:0},{x:G,y:te+pe},{width:J,height:1}),gs.copy(L.data,E,{x:J-1,y:0},{x:G-1,y:te},{width:1,height:pe}),gs.copy(L.data,E,{x:0,y:0},{x:G+J,y:te},{width:1,height:pe})}this.image=E,this.iconPositions=u,this.patternPositions=m};Vf.prototype.addImages=function(s,l,u){for(var m in s){var y=s[m],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(b),l[m]=new Bf(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}},Vf.prototype.patchUpdatedImages=function(s,l){for(var u in s.dispatchRenderCallbacks(this.haveRenderCallbacks),s.updatedImages)this.patchUpdatedImage(this.iconPositions[u],s.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],s.getImage(u),l)},Vf.prototype.patchUpdatedImage=function(s,l,u){if(s&&l&&s.version!==l.version){s.version=l.version;var m=s.tl;u.update(l.data,void 0,{x:m[0],y:m[1]})}},lt("ImagePosition",Bf),lt("ImageAtlas",Vf);var ta={horizontal:1,vertical:2,horizontalOnly:3},Ho=function(){this.scale=1,this.fontStack="",this.imageName=null};Ho.forText=function(s,l){var u=new Ho;return u.scale=s||1,u.fontStack=l,u},Ho.forImage=function(s){var l=new Ho;return l.imageName=s,l};var To=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Qg(s,l,u,m,y,b,E,S,k,M,P,L,z,G,te,J){var pe,he=To.fromFeature(s,y);L===ta.vertical&&he.verticalizePunctuation();var be=ar.processBidirectionalText,ve=ar.processStyledBidirectionalText;if(be&&1===he.sections.length){pe=[];for(var Ie=0,ke=be(he.toString(),pv(he,M,b,l,m,G,te));Ie<ke.length;Ie+=1){var Be=ke[Ie],Ye=new To;Ye.text=Be,Ye.sections=he.sections;for(var nt=0;nt<Be.length;nt++)Ye.sectionIndex.push(0);pe.push(Ye)}}else if(ve){pe=[];for(var wt=0,it=ve(he.text,he.sectionIndex,pv(he,M,b,l,m,G,te));wt<it.length;wt+=1){var At=it[wt],at=new To;at.text=At[0],at.sectionIndex=At[1],at.sections=he.sections,pe.push(at)}}else pe=function(vt,yn){for(var on=[],Dn=vt.text,Mt=0,Mn=0,Cr=yn;Mn<Cr.length;Mn+=1){var zr=Cr[Mn];on.push(vt.substring(Mt,zr)),Mt=zr}return Mt<Dn.length&&on.push(vt.substring(Mt,Dn.length)),on}(he,pv(he,M,b,l,m,G,te));var fn=[],Vt={positionedLines:fn,text:he.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(vt,yn,on,Dn,Mt,Mn,Cr,zr,Or,Dr,Wr,Ni){for(var Oi=0,$o=-17,eo=0,qo=0,ni="right"===zr?1:"left"===zr?0:.5,Li=0,bn=0,ur=Mt;bn<ur.length;bn+=1){var nr=ur[bn];nr.trim();var Rn=nr.getMaxScale(),So=24*(Rn-1),Io={positionedGlyphs:[],lineOffset:0};vt.positionedLines[Li]=Io;var rr=Io.positionedGlyphs,Tr=0;if(nr.length()){for(var ko=0;ko<nr.length();ko++){var $n=nr.getSection(ko),Sl=nr.getSectionIndex(ko),ys=nr.getCharCode(ko),_a=0,jr=null,gc=null,Ka=null,gm=24,Il=!(Or===ta.horizontal||!Wr&&!Ke(ys)||Wr&&(Jg[ys]||(yc=ys,mt.Arabic(yc)||mt["Arabic Supplement"](yc)||mt["Arabic Extended-A"](yc)||mt["Arabic Presentation Forms-A"](yc)||mt["Arabic Presentation Forms-B"](yc))));if($n.imageName){var mh=Dn[$n.imageName];if(!mh)continue;Ka=$n.imageName,vt.iconsInText=vt.iconsInText||!0,gc=mh.paddedRect;var _c=mh.displaySize;$n.scale=24*$n.scale/Ni,_a=So+(24-_c[1]*$n.scale),gm=(jr={width:_c[0],height:_c[1],left:1,top:-3,advance:Il?_c[1]:_c[0]}).advance;var gh=Il?_c[0]*$n.scale-24*Rn:_c[1]*$n.scale-24*Rn;gh>0&&gh>Tr&&(Tr=gh)}else{var Zf=on[$n.fontStack],_h=Zf&&Zf[ys];if(_h&&_h.rect)gc=_h.rect,jr=_h.metrics;else{var Kf=yn[$n.fontStack],c_=Kf&&Kf[ys];if(!c_)continue;jr=c_.metrics}_a=24*(Rn-$n.scale)}Il?(vt.verticalizable=!0,rr.push({glyph:ys,imageName:Ka,x:Oi,y:$o+_a,vertical:Il,scale:$n.scale,fontStack:$n.fontStack,sectionIndex:Sl,metrics:jr,rect:gc}),Oi+=gm*$n.scale+Dr):(rr.push({glyph:ys,imageName:Ka,x:Oi,y:$o+_a,vertical:Il,scale:$n.scale,fontStack:$n.fontStack,sectionIndex:Sl,metrics:jr,rect:gc}),Oi+=jr.advance*$n.scale+Dr)}0!==rr.length&&(eo=Math.max(Oi-Dr,eo),wr(rr,0,rr.length-1,ni,Tr)),Oi=0;var Yf=Mn*Rn+Tr;Io.lineOffset=Math.max(Tr,So),$o+=Yf,qo=Math.max(Yf,qo),++Li}else $o+=Mn,++Li}var yc,vc=$o- -17,Xf=mv(Cr),su=Xf.horizontalAlign,yh=Xf.verticalAlign;(function(u_,_m,Qf,ym,Jf,d_,ep,vm,h_){var bm,Iv=(_m-Qf)*Jf;bm=d_!==ep?-vm*ym- -17:(-ym*h_+.5)*ep;for(var wm=0,xm=u_;wm<xm.length;wm+=1)for(var vh=0,Em=xm[wm].positionedGlyphs;vh<Em.length;vh+=1){var au=Em[vh];au.x+=Iv,au.y+=bm}})(vt.positionedLines,ni,su,yh,eo,qo,Mn,vc,Mt.length),vt.top+=-yh*vc,vt.bottom=vt.top+vc,vt.left+=-su*eo,vt.right=vt.left+eo}(Vt,l,u,m,pe,E,S,k,L,M,z,J),!function(vt){for(var yn=0,on=vt;yn<on.length;yn+=1)if(0!==on[yn].positionedGlyphs.length)return!1;return!0}(fn)&&Vt}To.fromFeature=function(s,l){for(var u=new To,m=0;m<s.sections.length;m++){var y=s.sections[m];y.image?u.addImageSection(y):u.addTextSection(y,l)}return u},To.prototype.length=function(){return this.text.length},To.prototype.getSection=function(s){return this.sections[this.sectionIndex[s]]},To.prototype.getSectionIndex=function(s){return this.sectionIndex[s]},To.prototype.getCharCode=function(s){return this.text.charCodeAt(s)},To.prototype.verticalizePunctuation=function(){this.text=function(s){for(var l="",u=0;u<s.length;u++){var m=s.charCodeAt(u+1)||null,y=s.charCodeAt(u-1)||null;l+=m&&Bt(m)&&!li[s[u+1]]||y&&Bt(y)&&!li[s[u-1]]||!li[s[u]]?s[u]:li[s[u]]}return l}(this.text)},To.prototype.trim=function(){for(var s=0,l=0;l<this.text.length&&Jg[this.text.charCodeAt(l)];l++)s++;for(var u=this.text.length,m=this.text.length-1;m>=0&&m>=s&&Jg[this.text.charCodeAt(m)];m--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)},To.prototype.substring=function(s,l){var u=new To;return u.text=this.text.substring(s,l),u.sectionIndex=this.sectionIndex.slice(s,l),u.sections=this.sections,u},To.prototype.toString=function(){return this.text},To.prototype.getMaxScale=function(){var s=this;return this.sectionIndex.reduce(function(l,u){return Math.max(l,s.sections[u].scale)},0)},To.prototype.addTextSection=function(s,l){this.text+=s.text,this.sections.push(Ho.forText(s.scale,s.fontStack||l));for(var u=this.sections.length-1,m=0;m<s.text.length;++m)this.sectionIndex.push(u)},To.prototype.addImageSection=function(s){var l=s.image?s.image.name:"";if(0!==l.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Ho.forImage(l)),this.sectionIndex.push(this.sections.length-1)):yr("Reached maximum number of images 6401")}else yr("Can't add FormattedSection with an empty image.")},To.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Jg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_s={};function fv(s,l,u,m,y,b){if(l.imageName){var E=m[l.imageName];return E?E.displaySize[0]*l.scale*24/b+y:0}var S=u[l.fontStack],k=S&&S[s];return k?k.metrics.advance*l.scale+y:0}function cx(s,l,u,m){var y=Math.pow(s-l,2);return m?s<l?y/2:2*y:y+Math.abs(u)*u}function lh(s,l,u){var m=0;return 10===s&&(m-=1e4),u&&(m+=150),40!==s&&65288!==s||(m+=50),41!==l&&65289!==l||(m+=50),m}function ux(s,l,u,m,y,b){for(var E=null,S=cx(l,u,y,b),k=0,M=m;k<M.length;k+=1){var P=M[k],L=cx(l-P.x,u,y,b)+P.badness;L<=S&&(E=P,S=L)}return{index:s,x:l,priorBreak:E,badness:S}}function pv(s,l,u,m,y,b,E){if("point"!==b)return[];if(!s)return[];for(var S,k=[],M=function(pe,he,be,ve,Ie,ke){for(var Be=0,Ye=0;Ye<pe.length();Ye++){var nt=pe.getSection(Ye);Be+=fv(pe.getCharCode(Ye),nt,ve,Ie,he,ke)}return Be/Math.max(1,Math.ceil(Be/be))}(s,l,u,m,y,E),P=s.text.indexOf("\u200b")>=0,L=0,z=0;z<s.length();z++){var G=s.getSection(z),te=s.getCharCode(z);if(Jg[te]||(L+=fv(te,G,m,y,l,E)),z<s.length()-1){var J=!((S=te)<11904||!(mt["Bopomofo Extended"](S)||mt.Bopomofo(S)||mt["CJK Compatibility Forms"](S)||mt["CJK Compatibility Ideographs"](S)||mt["CJK Compatibility"](S)||mt["CJK Radicals Supplement"](S)||mt["CJK Strokes"](S)||mt["CJK Symbols and Punctuation"](S)||mt["CJK Unified Ideographs Extension A"](S)||mt["CJK Unified Ideographs"](S)||mt["Enclosed CJK Letters and Months"](S)||mt["Halfwidth and Fullwidth Forms"](S)||mt.Hiragana(S)||mt["Ideographic Description Characters"](S)||mt["Kangxi Radicals"](S)||mt["Katakana Phonetic Extensions"](S)||mt.Katakana(S)||mt["Vertical Forms"](S)||mt["Yi Radicals"](S)||mt["Yi Syllables"](S)));(_s[te]||J||G.imageName)&&k.push(ux(z+1,L,M,k,lh(te,s.getCharCode(z+1),J&&P),!1))}}return function pe(he){return he?pe(he.priorBreak).concat(he.index):[]}(ux(s.length(),L,M,k,0,!0))}function mv(s){var l=.5,u=.5;switch(s){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:l,verticalAlign:u}}function wr(s,l,u,m,y){if(m||y)for(var b=s[u],E=(s[u].x+b.metrics.advance*b.scale)*m,S=l;S<=u;S++)s[S].x-=E,s[S].y+=y}function Dt(s,l,u,m,y,b){var E,S=s.image;if(S.content){var k=S.content,M=S.pixelRatio||1;E=[k[0]/M,k[1]/M,S.displaySize[0]-k[2]/M,S.displaySize[1]-k[3]/M]}var P,L,z,G,te=l.left*b,J=l.right*b;"width"===u||"both"===u?(G=y[0]+te-m[3],L=y[0]+J+m[1]):L=(G=y[0]+(te+J-S.displaySize[0])/2)+S.displaySize[0];var pe=l.top*b,he=l.bottom*b;return"height"===u||"both"===u?(P=y[1]+pe-m[0],z=y[1]+he+m[2]):z=(P=y[1]+(pe+he-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:P,right:L,bottom:z,left:G,collisionPadding:E}}_s[10]=!0,_s[32]=!0,_s[38]=!0,_s[40]=!0,_s[41]=!0,_s[43]=!0,_s[45]=!0,_s[47]=!0,_s[173]=!0,_s[183]=!0,_s[8203]=!0,_s[8208]=!0,_s[8211]=!0,_s[8231]=!0;var Uf=function(s){function l(u,m,y,b){s.call(this,u,m),this.angle=y,void 0!==b&&(this.segment=b)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.clone=function(){return new l(this.x,this.y,this.angle,this.segment)},l}(Wt);function e_(s,l){var u=l.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new Kt(s+1))};if("source"===u.kind)return{kind:"source"};for(var m=u.zoomStops,y=u.interpolationType,b=0;b<m.length&&m[b]<=s;)b++;for(var E=b=Math.max(0,b-1);E<m.length&&m[E]<s+1;)E++;E=Math.min(m.length-1,E);var S=m[b],k=m[E];return"composite"===u.kind?{kind:"composite",minZoom:S,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:S,maxZoom:k,minSize:u.evaluate(new Kt(S)),maxSize:u.evaluate(new Kt(k)),interpolationType:y}}function cm(s,l,u){var m=l.uSize,y=u.lowerSize;return"source"===s.kind?y/128:"composite"===s.kind?mi(y/128,u.upperSize/128,l.uSizeT):m}function um(s,l){var u=0,m=0;if("constant"===s.kind)m=s.layoutSize;else if("source"!==s.kind){var y=s.interpolationType,b=y?io(cn.interpolationFactor(y,l,s.minZoom,s.maxZoom),0,1):0;"camera"===s.kind?m=mi(s.minSize,s.maxSize,b):u=b}return{uSizeT:u,uSize:m}}lt("Anchor",Uf);var gv=Object.freeze({__proto__:null,getSizeData:e_,evaluateSizeForFeature:cm,evaluateSizeForZoom:um,SIZE_PACK_FACTOR:128});function _v(s,l,u,m,y){if(void 0===l.segment)return!0;for(var b=l,E=l.segment+1,S=0;S>-u/2;){if(--E<0)return!1;S-=s[E].dist(b),b=s[E]}S+=s[E].dist(s[E+1]),E++;for(var k=[],M=0;S<u/2;){var P=s[E],L=s[E+1];if(!L)return!1;var z=s[E-1].angleTo(P)-P.angleTo(L);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:S,angleDelta:z}),M+=z;S-k[0].distance>m;)M-=k.shift().angleDelta;if(M>y)return!1;E++,S+=P.dist(L)}return!0}function yv(s){for(var l=0,u=0;u<s.length-1;u++)l+=s[u].dist(s[u+1]);return l}function dx(s,l,u){return s?.6*l*u:0}function ch(s,l){return Math.max(s?s.right-s.left:0,l?l.right-l.left:0)}function dm(s,l,u,m,y,b){for(var E=dx(u,y,b),S=ch(u,m)*b,k=0,M=yv(s)/2,P=0;P<s.length-1;P++){var L=s[P],z=s[P+1],G=L.dist(z);if(k+G>M){var te=(M-k)/G,J=mi(L.x,z.x,te),pe=mi(L.y,z.y,te),he=new Uf(J,pe,z.angleTo(L),P);return he._round(),!E||_v(s,he,S,E,l)?he:void 0}k+=G}}function vv(s,l,u,m,y,b,E,S,k){var M=dx(m,b,E),P=ch(m,y),L=P*E,z=0===s[0].x||s[0].x===k||0===s[0].y||s[0].y===k;return l-L<l/4&&(l=L+l/4),function G(te,J,pe,he,be,ve,Ie,ke,Be){for(var Ye=ve/2,nt=yv(te),wt=0,it=J-pe,At=[],at=0;at<te.length-1;at++){for(var fn=te[at],Vt=te[at+1],vt=fn.dist(Vt),yn=Vt.angleTo(fn);it+pe<wt+vt;){var on=((it+=pe)-wt)/vt,Dn=mi(fn.x,Vt.x,on),Mt=mi(fn.y,Vt.y,on);if(Dn>=0&&Dn<Be&&Mt>=0&&Mt<Be&&it-Ye>=0&&it+Ye<=nt){var Mn=new Uf(Dn,Mt,yn,at);Mn._round(),he&&!_v(te,Mn,ve,he,be)||At.push(Mn)}}wt+=vt}return ke||At.length||Ie||(At=G(te,wt/2,pe,he,be,ve,Ie,!0,Be)),At}(s,z?l/2*S%l:(P/2+2*b)*E*S%l,l,M,u,L,z,!1,k)}function bv(s,l,u,m,y){for(var b=[],E=0;E<s.length;E++)for(var S=s[E],k=void 0,M=0;M<S.length-1;M++){var P=S[M],L=S[M+1];P.x<l&&L.x<l||(P.x<l?P=new Wt(l,P.y+(l-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x<l&&(L=new Wt(l,P.y+(l-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y<u&&L.y<u||(P.y<u?P=new Wt(P.x+(u-P.y)/(L.y-P.y)*(L.x-P.x),u)._round():L.y<u&&(L=new Wt(P.x+(u-P.y)/(L.y-P.y)*(L.x-P.x),u)._round()),P.x>=m&&L.x>=m||(P.x>=m?P=new Wt(m,P.y+(m-P.x)/(L.x-P.x)*(L.y-P.y))._round():L.x>=m&&(L=new Wt(m,P.y+(m-P.x)/(L.x-P.x)*(L.y-P.y))._round()),P.y>=y&&L.y>=y||(P.y>=y?P=new Wt(P.x+(y-P.y)/(L.y-P.y)*(L.x-P.x),y)._round():L.y>=y&&(L=new Wt(P.x+(y-P.y)/(L.y-P.y)*(L.x-P.x),y)._round()),k&&P.equals(k[k.length-1])||b.push(k=[P]),k.push(L)))))}return b}function LT(s,l,u,m){var y=[],b=s.image,E=b.pixelRatio,S=b.paddedRect.w-2,k=b.paddedRect.h-2,M=s.right-s.left,P=s.bottom-s.top,L=b.stretchX||[[0,S]],z=b.stretchY||[[0,k]],G=function(Dn,Mt){return Dn+Mt[1]-Mt[0]},te=L.reduce(G,0),J=z.reduce(G,0),pe=S-te,he=k-J,be=0,ve=te,Ie=0,ke=J,Be=0,Ye=pe,nt=0,wt=he;if(b.content&&m){var it=b.content;be=t_(L,0,it[0]),Ie=t_(z,0,it[1]),ve=t_(L,it[0],it[2]),ke=t_(z,it[1],it[3]),Be=it[0]-be,nt=it[1]-Ie,Ye=it[2]-it[0]-ve,wt=it[3]-it[1]-ke}var At=function(Dn,Mt,Mn,Cr){var zr=wv(Dn.stretch-be,ve,M,s.left),Or=xv(Dn.fixed-Be,Ye,Dn.stretch,te),Dr=wv(Mt.stretch-Ie,ke,P,s.top),Wr=xv(Mt.fixed-nt,wt,Mt.stretch,J),Ni=wv(Mn.stretch-be,ve,M,s.left),Oi=xv(Mn.fixed-Be,Ye,Mn.stretch,te),$o=wv(Cr.stretch-Ie,ke,P,s.top),eo=xv(Cr.fixed-nt,wt,Cr.stretch,J),qo=new Wt(zr,Dr),ni=new Wt(Ni,Dr),Li=new Wt(Ni,$o),bn=new Wt(zr,$o),ur=new Wt(Or/E,Wr/E),nr=new Wt(Oi/E,eo/E),Rn=l*Math.PI/180;if(Rn){var So=Math.sin(Rn),Io=Math.cos(Rn),rr=[Io,-So,So,Io];qo._matMult(rr),ni._matMult(rr),bn._matMult(rr),Li._matMult(rr)}var Tr=Dn.stretch+Dn.fixed,ko=Mt.stretch+Mt.fixed;return{tl:qo,tr:ni,bl:bn,br:Li,tex:{x:b.paddedRect.x+1+Tr,y:b.paddedRect.y+1+ko,w:Mn.stretch+Mn.fixed-Tr,h:Cr.stretch+Cr.fixed-ko},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ur,pixelOffsetBR:nr,minFontScaleX:Ye/E/M,minFontScaleY:wt/E/P,isSDF:u}};if(m&&(b.stretchX||b.stretchY))for(var at=hx(L,pe,te),fn=hx(z,he,J),Vt=0;Vt<at.length-1;Vt++)for(var vt=at[Vt],yn=at[Vt+1],on=0;on<fn.length-1;on++)y.push(At(vt,fn[on],yn,fn[on+1]));else y.push(At({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:k+1}));return y}function t_(s,l,u){for(var m=0,y=0,b=s;y<b.length;y+=1){var E=b[y];m+=Math.max(l,Math.min(u,E[1]))-Math.max(l,Math.min(u,E[0]))}return m}function hx(s,l,u){for(var m=[{fixed:-1,stretch:0}],y=0,b=s;y<b.length;y+=1){var E=b[y],S=E[0],k=E[1],M=m[m.length-1];m.push({fixed:S-M.stretch,stretch:M.stretch}),m.push({fixed:S-M.stretch,stretch:M.stretch+(k-S)})}return m.push({fixed:l+1,stretch:u}),m}function wv(s,l,u,m){return s/l*u+m}function xv(s,l,u,m){return s-l*u/m}var n_=function(s,l,u,m,y,b,E,S,k,M){if(this.boxStartIndex=s.length,k){var P=b.top,L=b.bottom,z=b.collisionPadding;z&&(P-=z[1],L+=z[3]);var G=L-P;G>0&&(G=Math.max(10,G),this.circleDiameter=G)}else{var te=b.top*E-S,J=b.bottom*E+S,pe=b.left*E-S,he=b.right*E+S,be=b.collisionPadding;if(be&&(pe-=be[0]*E,te-=be[1]*E,he+=be[2]*E,J+=be[3]*E),M){var ve=new Wt(pe,te),Ie=new Wt(he,te),ke=new Wt(pe,J),Be=new Wt(he,J),Ye=M*Math.PI/180;ve._rotate(Ye),Ie._rotate(Ye),ke._rotate(Ye),Be._rotate(Ye),pe=Math.min(ve.x,Ie.x,ke.x,Be.x),he=Math.max(ve.x,Ie.x,ke.x,Be.x),te=Math.min(ve.y,Ie.y,ke.y,Be.y),J=Math.max(ve.y,Ie.y,ke.y,Be.y)}s.emplaceBack(l.x,l.y,pe,te,he,J,u,m,y)}this.boxEndIndex=s.length},sd=function(s,l){if(void 0===s&&(s=[]),void 0===l&&(l=fx),this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function fx(s,l){return s<l?-1:s>l?1:0}function zf(s,l,u){void 0===l&&(l=1),void 0===u&&(u=!1);for(var m=1/0,y=1/0,b=-1/0,E=-1/0,S=s[0],k=0;k<S.length;k++){var M=S[k];(!k||M.x<m)&&(m=M.x),(!k||M.y<y)&&(y=M.y),(!k||M.x>b)&&(b=M.x),(!k||M.y>E)&&(E=M.y)}var P=Math.min(b-m,E-y),L=P/2,z=new sd([],px);if(0===P)return new Wt(m,y);for(var G=m;G<b;G+=P)for(var te=y;te<E;te+=P)z.push(new ad(G+L,te+L,L,s));for(var J=function(be){for(var ve=0,Ie=0,ke=0,Be=be[0],Ye=0,nt=Be.length,wt=nt-1;Ye<nt;wt=Ye++){var it=Be[Ye],At=Be[wt],at=it.x*At.y-At.x*it.y;Ie+=(it.x+At.x)*at,ke+=(it.y+At.y)*at,ve+=3*at}return new ad(Ie/ve,ke/ve,0,be)}(s),pe=z.length;z.length;){var he=z.pop();(he.d>J.d||!J.d)&&(J=he,u&&console.log("found best %d after %d probes",Math.round(1e4*he.d)/1e4,pe)),he.max-J.d<=l||(z.push(new ad(he.p.x-(L=he.h/2),he.p.y-L,L,s)),z.push(new ad(he.p.x+L,he.p.y-L,L,s)),z.push(new ad(he.p.x-L,he.p.y+L,L,s)),z.push(new ad(he.p.x+L,he.p.y+L,L,s)),pe+=4)}return u&&(console.log("num probes: "+pe),console.log("best distance: "+J.d)),J.p}function px(s,l){return l.max-s.max}function ad(s,l,u,m){this.p=new Wt(s,l),this.h=u,this.d=function(y,b){for(var E=!1,S=1/0,k=0;k<b.length;k++)for(var M=b[k],P=0,L=M.length,z=L-1;P<L;z=P++){var G=M[P],te=M[z];G.y>y.y!=te.y>y.y&&y.x<(te.x-G.x)*(y.y-G.y)/(te.y-G.y)+G.x&&(E=!E),S=Math.min(S,Us(y,G,te))}return(E?1:-1)*Math.sqrt(S)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}sd.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},sd.prototype.pop=function(){if(0!==this.length){var s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}},sd.prototype.peek=function(){return this.data[0]},sd.prototype._up=function(s){for(var l=this.data,u=this.compare,m=l[s];s>0;){var y=s-1>>1,b=l[y];if(u(m,b)>=0)break;l[s]=b,s=y}l[s]=m},sd.prototype._down=function(s){for(var l=this.data,u=this.compare,m=this.length>>1,y=l[s];s<m;){var b=1+(s<<1),E=l[b],S=b+1;if(S<this.length&&u(l[S],E)<0&&(b=S,E=l[S]),u(E,y)>=0)break;l[s]=E,s=b}l[s]=y};var uh=Number.POSITIVE_INFINITY;function mx(s,l){return l[1]!==uh?function(u,m,y){var b=0,E=0;switch(m=Math.abs(m),y=Math.abs(y),u){case"top-right":case"top-left":case"top":E=y-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-m;break;case"top-left":case"bottom-left":case"left":b=m}return[b,E]}(s,l[0],l[1]):function(u,m){var y=0,b=0;m<0&&(m=0);var E=m/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-m;break;case"top":b=m-7}switch(u){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=m;break;case"right":y=-m}return[y,b]}(s,l[0])}function dh(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function r_(s,l,u,m,y,b,E,S,k,M,P,L,z,G,te){var J=function(Ie,ke,Be,Ye,nt,wt,it,At){for(var at=Ye.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,fn=[],Vt=0,vt=ke.positionedLines;Vt<vt.length;Vt+=1)for(var yn=vt[Vt],on=0,Dn=yn.positionedGlyphs;on<Dn.length;on+=1){var Mt=Dn[on];if(Mt.rect){var Mn=Mt.rect||{},Cr=4,zr=!0,Or=1,Dr=0,Wr=(nt||At)&&Mt.vertical,Ni=Mt.metrics.advance*Mt.scale/2;if(At&&ke.verticalizable&&(Dr=yn.lineOffset/2-(Mt.imageName?-(24-Mt.metrics.width*Mt.scale)/2:24*(Mt.scale-1))),Mt.imageName){var Oi=it[Mt.imageName];zr=Oi.sdf,Cr=1/(Or=Oi.pixelRatio)}var $o=nt?[Mt.x+Ni,Mt.y]:[0,0],eo=nt?[0,0]:[Mt.x+Ni+Be[0],Mt.y+Be[1]-Dr],qo=[0,0];Wr&&(qo=eo,eo=[0,0]);var ni=(Mt.metrics.left-Cr)*Mt.scale-Ni+eo[0],Li=(-Mt.metrics.top-Cr)*Mt.scale+eo[1],bn=ni+Mn.w*Mt.scale/Or,ur=Li+Mn.h*Mt.scale/Or,nr=new Wt(ni,Li),Rn=new Wt(bn,Li),So=new Wt(ni,ur),Io=new Wt(bn,ur);if(Wr){var rr=new Wt(-Ni,Ni- -17),Tr=-Math.PI/2,ko=12-Ni,$n=new Wt(22-ko,-(Mt.imageName?ko:0)),Sl=new(Function.prototype.bind.apply(Wt,[null].concat(qo)));nr._rotateAround(Tr,rr)._add($n)._add(Sl),Rn._rotateAround(Tr,rr)._add($n)._add(Sl),So._rotateAround(Tr,rr)._add($n)._add(Sl),Io._rotateAround(Tr,rr)._add($n)._add(Sl)}if(at){var ys=Math.sin(at),_a=Math.cos(at),jr=[_a,-ys,ys,_a];nr._matMult(jr),Rn._matMult(jr),So._matMult(jr),Io._matMult(jr)}var gc=new Wt(0,0),Ka=new Wt(0,0);fn.push({tl:nr,tr:Rn,bl:So,br:Io,tex:Mn,writingMode:ke.writingMode,glyphOffset:$o,sectionIndex:Mt.sectionIndex,isSDF:zr,pixelOffsetTL:gc,pixelOffsetBR:Ka,minFontScaleX:0,minFontScaleY:0})}}return fn}(0,u,S,y,b,E,m,s.allowVerticalPlacement),pe=s.textSizeData,he=null;"source"===pe.kind?(he=[128*y.layout.get("text-size").evaluate(E,{})])[0]>32640&&yr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===pe.kind&&((he=[128*G.compositeTextSizes[0].evaluate(E,{},te),128*G.compositeTextSizes[1].evaluate(E,{},te)])[0]>32640||he[1]>32640)&&yr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),s.addSymbols(s.text,J,he,S,b,E,M,l,k.lineStartIndex,k.lineLength,z,te);for(var be=0,ve=P;be<ve.length;be+=1)L[ve[be]]=s.text.placedSymbolArray.length-1;return 4*J.length}function hm(s){for(var l in s)return s[l];return null}function wO(s,l,u,m){var y=s.compareText;if(l in y){for(var b=y[l],E=b.length-1;E>=0;E--)if(m.dist(b[E])<u)return!0}else y[l]=[];return y[l].push(m),!1}var gx=lm.VectorTileFeature.types,_x=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function i_(s,l,u,m,y,b,E,S,k,M,P,L,z){var G=S?Math.min(32640,Math.round(S[0])):0,te=S?Math.min(32640,Math.round(S[1])):0;s.emplaceBack(l,u,Math.round(32*m),Math.round(32*y),b,E,(G<<1)+(k?1:0),te,16*M,16*P,256*L,256*z)}function Za(s,l,u){s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u)}function FT(s){for(var l=0,u=s.sections;l<u.length;l+=1)if(Wi(u[l].text))return!0;return!1}var ru=function(s){this.layoutVertexArray=new th,this.indexArray=new Qs,this.programConfigurations=s,this.segments=new $,this.dynamicLayoutVertexArray=new Vs,this.opacityVertexArray=new Af,this.placedSymbolArray=new w};ru.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},ru.prototype.upload=function(s,l,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ix.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,Er.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,_x,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(s))},ru.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},lt("SymbolBuffers",ru);var hh=function(s,l,u){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new u,this.segments=new $,this.collisionVertexArray=new zg};hh.prototype.upload=function(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,ox.members,!0)},hh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},lt("CollisionBuffers",hh);var tr=function(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(b){return b.id}),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Vr([]),this.placementViewportMatrix=Vr([]);var l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=e_(this.zoom,l["text-size"]),this.iconSizeData=e_(this.zoom,l["icon-size"]);var u=this.layers[0].layout,m=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(b){return ta[b]})),this.stateDependentLayerIds=this.layers.filter(function(b){return b.isStateDependent()}).map(function(b){return b.id}),this.sourceID=s.sourceID};tr.prototype.createArrays=function(){this.text=new ru(new lr(this.layers,this.zoom,function(s){return/^text/.test(s)})),this.icon=new ru(new lr(this.layers,this.zoom,function(s){return/^icon/.test(s)})),this.glyphOffsetArray=new I,this.lineVertexArray=new R,this.symbolInstances=new T},tr.prototype.calculateGlyphDependencies=function(s,l,u,m,y){for(var b=0;b<s.length;b++)if(l[s.charCodeAt(b)]=!0,(u||m)&&y){var E=li[s.charAt(b)];E&&(l[E.charCodeAt(0)]=!0)}},tr.prototype.populate=function(s,l,u){var m=this.layers[0],y=m.layout,b=y.get("text-font"),E=y.get("text-field"),S=y.get("icon-image"),k=("constant"!==E.value.kind||E.value.value instanceof si&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),M="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,P=y.get("symbol-sort-key");if(this.features=[],k||M){for(var L=l.iconDependencies,z=l.glyphDependencies,G=l.availableImages,te=new Kt(this.zoom),J=0,pe=s;J<pe.length;J+=1){var he=pe[J],be=he.feature,ve=he.id,Ie=he.index,ke=he.sourceLayerIndex,Be=m._featureFilter.needGeometry,Ye=Uo(be,Be);if(m._featureFilter.filter(te,Ye,u)){Be||(Ye.geometry=ei(be));var nt=void 0;if(k){var wt=m.getValueAndResolveTokens("text-field",Ye,u,G),it=si.factory(wt);FT(it)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===wo()||this.hasRTLText&&ar.isParsed())&&(nt=jo(it,m,Ye))}var At=void 0;if(M){var at=m.getValueAndResolveTokens("icon-image",Ye,u,G);At=at instanceof kr?at:kr.fromString(at)}if(nt||At){var fn=this.sortFeaturesByKey?P.evaluate(Ye,{},u):void 0;if(this.features.push({id:ve,text:nt,icon:At,index:Ie,sourceLayerIndex:ke,geometry:Ye.geometry,properties:be.properties,type:gx[be.type],sortKey:fn}),At&&(L[At.name]=!0),nt){var Vt=b.evaluate(Ye,{},u).join(","),vt="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ta.vertical)>=0;for(var yn=0,on=nt.sections;yn<on.length;yn+=1){var Dn=on[yn];if(Dn.image)L[Dn.image.name]=!0;else{var Mt=Jr(nt.toString()),Mn=Dn.fontStack||Vt,Cr=z[Mn]=z[Mn]||{};this.calculateGlyphDependencies(Dn.text,Cr,vt,this.allowVerticalPlacement,Mt)}}}}}}"line"===y.get("symbol-placement")&&(this.features=function(zr){var Or={},Dr={},Wr=[],Ni=0;function Oi(rr){Wr.push(zr[rr]),Ni++}function $o(rr,Tr,ko){var $n=Dr[rr];return delete Dr[rr],Dr[Tr]=$n,Wr[$n].geometry[0].pop(),Wr[$n].geometry[0]=Wr[$n].geometry[0].concat(ko[0]),$n}function eo(rr,Tr,ko){var $n=Or[Tr];return delete Or[Tr],Or[rr]=$n,Wr[$n].geometry[0].shift(),Wr[$n].geometry[0]=ko[0].concat(Wr[$n].geometry[0]),$n}function qo(rr,Tr,ko){var $n=ko?Tr[0][Tr[0].length-1]:Tr[0][0];return rr+":"+$n.x+":"+$n.y}for(var ni=0;ni<zr.length;ni++){var Li=zr[ni],bn=Li.geometry,ur=Li.text?Li.text.toString():null;if(ur){var nr=qo(ur,bn),Rn=qo(ur,bn,!0);if(nr in Dr&&Rn in Or&&Dr[nr]!==Or[Rn]){var So=eo(nr,Rn,bn),Io=$o(nr,Rn,Wr[So].geometry);delete Or[nr],delete Dr[Rn],Dr[qo(ur,Wr[Io].geometry,!0)]=Io,Wr[So].geometry=null}else nr in Dr?$o(nr,Rn,bn):Rn in Or?eo(nr,Rn,bn):(Oi(ni),Or[nr]=Ni-1,Dr[Rn]=Ni-1)}else Oi(ni)}return Wr.filter(function(rr){return rr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(zr,Or){return zr.sortKey-Or.sortKey})}},tr.prototype.update=function(s,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,u),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,u))},tr.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},tr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},tr.prototype.upload=function(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},tr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},tr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},tr.prototype.addToLineVertexArray=function(s,l){var u=this.lineVertexArray.length;if(void 0!==s.segment){for(var m=s.dist(l[s.segment+1]),y=s.dist(l[s.segment]),b={},E=s.segment+1;E<l.length;E++)b[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:m},E<l.length-1&&(m+=l[E+1].dist(l[E]));for(var S=s.segment||0;S>=0;S--)b[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=l[S-1].dist(l[S]));for(var k=0;k<l.length;k++){var M=b[k];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},tr.prototype.addSymbols=function(s,l,u,m,y,b,E,S,k,M,P,L){for(var z=s.indexArray,G=s.layoutVertexArray,te=s.segments.prepareSegment(4*l.length,G,z,this.canOverlap?b.sortKey:void 0),J=this.glyphOffsetArray.length,pe=te.vertexLength,he=this.allowVerticalPlacement&&E===ta.vertical?Math.PI/2:0,be=b.text&&b.text.sections,ve=0;ve<l.length;ve++){var Ie=l[ve],ke=Ie.tl,Be=Ie.tr,Ye=Ie.bl,nt=Ie.br,wt=Ie.tex,it=Ie.pixelOffsetTL,At=Ie.pixelOffsetBR,at=Ie.minFontScaleX,fn=Ie.minFontScaleY,Vt=Ie.glyphOffset,vt=Ie.isSDF,yn=Ie.sectionIndex,on=te.vertexLength,Dn=Vt[1];i_(G,S.x,S.y,ke.x,Dn+ke.y,wt.x,wt.y,u,vt,it.x,it.y,at,fn),i_(G,S.x,S.y,Be.x,Dn+Be.y,wt.x+wt.w,wt.y,u,vt,At.x,it.y,at,fn),i_(G,S.x,S.y,Ye.x,Dn+Ye.y,wt.x,wt.y+wt.h,u,vt,it.x,At.y,at,fn),i_(G,S.x,S.y,nt.x,Dn+nt.y,wt.x+wt.w,wt.y+wt.h,u,vt,At.x,At.y,at,fn),Za(s.dynamicLayoutVertexArray,S,he),z.emplaceBack(on,on+1,on+2),z.emplaceBack(on+1,on+2,on+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vt[0]),ve!==l.length-1&&yn===l[ve+1].sectionIndex||s.programConfigurations.populatePaintArrays(G.length,b,b.index,{},L,be&&be[yn])}s.placedSymbolArray.emplaceBack(S.x,S.y,J,this.glyphOffsetArray.length-J,pe,k,M,S.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],E,0,!1,0,P)},tr.prototype._addCollisionDebugVertex=function(s,l,u,m,y,b){return l.emplaceBack(0,0),s.emplaceBack(u.x,u.y,m,y,Math.round(b.x),Math.round(b.y))},tr.prototype.addCollisionDebugVertices=function(s,l,u,m,y,b,E){var S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=S.vertexLength,M=y.layoutVertexArray,P=y.collisionVertexArray,L=E.anchorX,z=E.anchorY;this._addCollisionDebugVertex(M,P,b,L,z,new Wt(s,l)),this._addCollisionDebugVertex(M,P,b,L,z,new Wt(u,l)),this._addCollisionDebugVertex(M,P,b,L,z,new Wt(u,m)),this._addCollisionDebugVertex(M,P,b,L,z,new Wt(s,m)),S.vertexLength+=4;var G=y.indexArray;G.emplaceBack(k,k+1),G.emplaceBack(k+1,k+2),G.emplaceBack(k+2,k+3),G.emplaceBack(k+3,k),S.primitiveLength+=4},tr.prototype.addDebugCollisionBoxes=function(s,l,u,m){for(var y=s;y<l;y++){var b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}},tr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new hh(cc,fe.members,Rf),this.iconCollisionBox=new hh(cc,fe.members,Rf);for(var s=0;s<this.symbolInstances.length;s++){var l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}},tr.prototype._deserializeCollisionBoxesForSymbol=function(s,l,u,m,y,b,E,S,k){for(var M={},P=l;P<u;P++){var L=s.get(P);M.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},M.textFeatureIndex=L.featureIndex;break}for(var z=m;z<y;z++){var G=s.get(z);M.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},M.verticalTextFeatureIndex=G.featureIndex;break}for(var te=b;te<E;te++){var J=s.get(te);M.iconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},M.iconFeatureIndex=J.featureIndex;break}for(var pe=S;pe<k;pe++){var he=s.get(pe);M.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},M.verticalIconFeatureIndex=he.featureIndex;break}return M},tr.prototype.deserializeCollisionBoxes=function(s){this.collisionArrays=[];for(var l=0;l<this.symbolInstances.length;l++){var u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},tr.prototype.hasTextData=function(){return this.text.segments.get().length>0},tr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},tr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},tr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},tr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},tr.prototype.addIndicesForPlacedSymbol=function(s,l){for(var u=s.placedSymbolArray.get(l),m=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<m;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)},tr.prototype.getSortedSymbolIndexes=function(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var l=Math.sin(s),u=Math.cos(s),m=[],y=[],b=[],E=0;E<this.symbolInstances.length;++E){b.push(E);var S=this.symbolInstances.get(E);m.push(0|Math.round(l*S.anchorX+u*S.anchorY)),y.push(S.featureIndex)}return b.sort(function(k,M){return m[k]-m[M]||y[M]-y[k]}),b},tr.prototype.addToSortKeyRanges=function(s,l){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})},tr.prototype.sortFeatures=function(s){var l=this;if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,m=this.symbolInstanceIndexes;u<m.length;u+=1){var y=this.symbolInstances.get(m[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(b,E,S){b>=0&&S.indexOf(b)===E&&l.addIndicesForPlacedSymbol(l.text,b)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},lt("SymbolBucket",tr,{omit:["layers","collisionBoxArray","features","compareText"]}),tr.MAX_GLYPHS=65535,tr.addDynamicAttributes=Za;var o_=new yi({"symbol-placement":new tt(X.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ot(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(X.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new tt(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ot(X.layout_symbol["icon-size"]),"icon-text-fit":new tt(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ot(X.layout_symbol["icon-image"]),"icon-rotate":new Ot(X.layout_symbol["icon-rotate"]),"icon-padding":new tt(X.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(X.layout_symbol["icon-keep-upright"]),"icon-offset":new Ot(X.layout_symbol["icon-offset"]),"icon-anchor":new Ot(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(X.layout_symbol["text-rotation-alignment"]),"text-field":new Ot(X.layout_symbol["text-field"]),"text-font":new Ot(X.layout_symbol["text-font"]),"text-size":new Ot(X.layout_symbol["text-size"]),"text-max-width":new Ot(X.layout_symbol["text-max-width"]),"text-line-height":new tt(X.layout_symbol["text-line-height"]),"text-letter-spacing":new Ot(X.layout_symbol["text-letter-spacing"]),"text-justify":new Ot(X.layout_symbol["text-justify"]),"text-radial-offset":new Ot(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(X.layout_symbol["text-variable-anchor"]),"text-anchor":new Ot(X.layout_symbol["text-anchor"]),"text-max-angle":new tt(X.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(X.layout_symbol["text-writing-mode"]),"text-rotate":new Ot(X.layout_symbol["text-rotate"]),"text-padding":new tt(X.layout_symbol["text-padding"]),"text-keep-upright":new tt(X.layout_symbol["text-keep-upright"]),"text-transform":new Ot(X.layout_symbol["text-transform"]),"text-offset":new Ot(X.layout_symbol["text-offset"]),"text-allow-overlap":new tt(X.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new tt(X.layout_symbol["text-ignore-placement"]),"text-optional":new tt(X.layout_symbol["text-optional"])}),fm={paint:new yi({"icon-opacity":new Ot(X.paint_symbol["icon-opacity"]),"icon-color":new Ot(X.paint_symbol["icon-color"]),"icon-halo-color":new Ot(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ot(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ot(X.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ot(X.paint_symbol["text-opacity"]),"text-color":new Ot(X.paint_symbol["text-color"],{runtimeType:en,getOverride:function(s){return s.textColor},hasOverride:function(s){return!!s.textColor}}),"text-halo-color":new Ot(X.paint_symbol["text-halo-color"]),"text-halo-width":new Ot(X.paint_symbol["text-halo-width"]),"text-halo-blur":new Ot(X.paint_symbol["text-halo-blur"]),"text-translate":new tt(X.paint_symbol["text-translate"]),"text-translate-anchor":new tt(X.paint_symbol["text-translate-anchor"])}),layout:o_},jf=function(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Et,this.defaultValue=s};jf.prototype.evaluate=function(s){if(s.formattedSection){var l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default},jf.prototype.eachChild=function(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)},jf.prototype.outputDefined=function(){return!1},jf.prototype.serialize=function(){return null},lt("FormatSectionOverride",jf,{omit:["defaultValue"]});var yx=function(s){function l(u){s.call(this,u,fm)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){if(s.prototype.recalculate.call(this,u,m),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var y=this.layout.get("text-writing-mode");if(y){for(var b=[],E=0,S=y;E<S.length;E+=1){var k=S[E];b.indexOf(k)<0&&b.push(k)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},l.prototype.getValueAndResolveTokens=function(u,m,y,b){var k,E=this.layout.get(u).evaluate(m,{},y,b),S=this._unevaluatedLayout._values[u];return S.isDataDriven()||xf(S.value)||!E?E:(k=m.properties,E.replace(/{([^{}]+)}/g,function(P,L){return L in k?String(k[L]):""}))},l.prototype.createBucket=function(u){return new tr(u)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype._setPaintOverrides=function(){for(var u=0,m=fm.paint.overridableProperties;u<m.length;u+=1){var y=m[u];if(l.hasPaintOverride(this.layout,y)){var b,E=this.paint.get(y),S=new jf(E),k=new Ua(S,E.property.specification);b="constant"===E.value.kind||"source"===E.value.kind?new Yd("source",k):new vo("composite",k,E.value.zoomStops,E.value._interpolationType),this.paint._values[y]=new ts(E.property,b,E.parameters)}}},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!(!this.layout||m.isDataDriven()||y.isDataDriven())&&l.hasPaintOverride(this.layout,u)},l.hasPaintOverride=function(u,m){var y=u.get("text-field"),b=fm.paint.properties[m],E=!1,S=function(P){for(var L=0,z=P;L<z.length;L+=1)if(b.overrides&&b.overrides.hasOverride(z[L]))return void(E=!0)};if("constant"===y.value.kind&&y.value.value instanceof si)S(y.value.value.sections);else if("source"===y.value.kind){var k=function(P){E||(P instanceof la&&Hi(P.value)===Ht?S(P.value.sections):P instanceof cs?S(P.sections):P.eachChild(k))},M=y.value;M._styleExpression&&k(M._styleExpression.expression)}return E},l}(Ai),vx={paint:new yi({"background-color":new tt(X.paint_background["background-color"]),"background-pattern":new Lt(X.paint_background["background-pattern"]),"background-opacity":new tt(X.paint_background["background-opacity"])})},bx=function(s){function l(u){s.call(this,u,vx)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Ai),wx={paint:new yi({"raster-opacity":new tt(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(X.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(X.paint_raster["raster-saturation"]),"raster-contrast":new tt(X.paint_raster["raster-contrast"]),"raster-resampling":new tt(X.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(X.paint_raster["raster-fade-duration"])})},BT=function(s){function l(u){s.call(this,u,wx)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Ai),s_=function(s){function l(u){s.call(this,u,{}),this.implementation=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},l.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},l.prototype.recalculate=function(){},l.prototype.updateTransitions=function(){},l.prototype.hasTransition=function(){},l.prototype.serialize=function(){},l.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},l.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},l}(Ai),xO={circle:nh,heatmap:Vw,hillshade:zw,fill:Ww,"fill-extrusion":Lf,line:DT,symbol:yx,background:bx,raster:BT},Hf=bt.HTMLImageElement,xx=bt.HTMLCanvasElement,Ev=bt.HTMLVideoElement,Cv=bt.ImageData,Tl=bt.ImageBitmap,ga=function(s,l,u,m){this.context=s,this.format=u,this.texture=s.gl.createTexture(),this.update(l,m)};ga.prototype.update=function(s,l,u){var m=s.width,y=s.height,b=!(this.size&&this.size[0]===m&&this.size[1]===y||u),E=this.context,S=E.gl;if(this.useMipmap=!(!l||!l.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!l||!1!==l.premultiply)),b)this.size=[m,y],s instanceof Hf||s instanceof xx||s instanceof Ev||s instanceof Cv||Tl&&s instanceof Tl?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,s):S.texImage2D(S.TEXTURE_2D,0,this.format,m,y,0,this.format,S.UNSIGNED_BYTE,s.data);else{var k=u||{x:0,y:0},M=k.x,P=k.y;s instanceof Hf||s instanceof xx||s instanceof Ev||s instanceof Cv||Tl&&s instanceof Tl?S.texSubImage2D(S.TEXTURE_2D,0,M,P,S.RGBA,S.UNSIGNED_BYTE,s):S.texSubImage2D(S.TEXTURE_2D,0,M,P,m,y,S.RGBA,S.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},ga.prototype.bind=function(s,l,u){var m=this.context.gl;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||s),this.filter=s),l!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,l),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,l),this.wrap=l)},ga.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ga.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ci=function(s){var l=this;this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){l._triggered=!1,l._callback()})};ci.prototype.trigger=function(){var s=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){s._triggered=!1,s._callback()},0))},ci.prototype.remove=function(){delete this._channel,this._callback=function(){}};var $f=function(s,l,u){this.target=s,this.parent=l,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ia(["receive","process"],this),this.invoker=new ci(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=As()?s:bt};function Gr(s,l,u){var m=2*Math.PI*6378137/256/Math.pow(2,u);return[s*m-2*Math.PI*6378137/2,l*m-2*Math.PI*6378137/2]}$f.prototype.send=function(s,l,u,m,y){var b=this;void 0===y&&(y=!1);var E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[E]=u);var S=ka(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:s,hasCallback:!!u,targetMapId:m,mustQueue:y,sourceMapId:this.mapId,data:Vo(l,S)},S),{cancel:function(){u&&delete b.callbacks[E],b.target.postMessage({id:E,type:"<cancel>",targetMapId:m,sourceMapId:b.mapId})}}},$f.prototype.receive=function(s){var l=s.data,u=l.id;if(u&&(!l.targetMapId||this.mapId===l.targetMapId))if("<cancel>"===l.type){delete this.tasks[u];var m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m()}else As()||l.mustQueue?(this.tasks[u]=l,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,l)},$f.prototype.process=function(){if(this.taskQueue.length){var s=this.taskQueue.shift(),l=this.tasks[s];delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),l&&this.processTask(s,l)}},$f.prototype.processTask=function(s,l){var u=this;if("<response>"===l.type){var m=this.callbacks[s];delete this.callbacks[s],m&&(l.error?m(qi(l.error)):m(null,qi(l.data)))}else{var y=!1,b=ka(this.globalScope)?void 0:[],E=l.hasCallback?function(P,L){y=!0,delete u.cancelCallbacks[s],u.target.postMessage({id:s,type:"<response>",sourceMapId:u.mapId,error:P?Vo(P):null,data:Vo(L,b)},b)}:function(P){y=!0},S=null,k=qi(l.data);if(this.parent[l.type])S=this.parent[l.type](l.sourceMapId,k,E);else if(this.parent.getWorkerSource){var M=l.type.split(".");S=this.parent.getWorkerSource(l.sourceMapId,M[0],k.source)[M[1]](k,E)}else E(new Error("Could not find function "+l.type));!y&&S&&S.cancel&&(this.cancelCallbacks[s]=S.cancel)}},$f.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ti=function(s,l){s&&(l?this.setSouthWest(s).setNorthEast(l):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))};ti.prototype.setNorthEast=function(s){return this._ne=s instanceof Ar?new Ar(s.lng,s.lat):Ar.convert(s),this},ti.prototype.setSouthWest=function(s){return this._sw=s instanceof Ar?new Ar(s.lng,s.lat):Ar.convert(s),this},ti.prototype.extend=function(s){var l,u,m=this._sw,y=this._ne;if(s instanceof Ar)l=s,u=s;else{if(!(s instanceof ti))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(ti.convert(s)):this.extend(Ar.convert(s)):this;if(u=s._ne,!(l=s._sw)||!u)return this}return m||y?(m.lng=Math.min(l.lng,m.lng),m.lat=Math.min(l.lat,m.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new Ar(l.lng,l.lat),this._ne=new Ar(u.lng,u.lat)),this},ti.prototype.getCenter=function(){return new Ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ti.prototype.getSouthWest=function(){return this._sw},ti.prototype.getNorthEast=function(){return this._ne},ti.prototype.getNorthWest=function(){return new Ar(this.getWest(),this.getNorth())},ti.prototype.getSouthEast=function(){return new Ar(this.getEast(),this.getSouth())},ti.prototype.getWest=function(){return this._sw.lng},ti.prototype.getSouth=function(){return this._sw.lat},ti.prototype.getEast=function(){return this._ne.lng},ti.prototype.getNorth=function(){return this._ne.lat},ti.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ti.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ti.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ti.prototype.contains=function(s){var l=Ar.convert(s),u=l.lng,m=l.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&y},ti.convert=function(s){return!s||s instanceof ti?s:new ti(s)};var Ar=function(s,l){if(isNaN(s)||isNaN(l))throw new Error("Invalid LngLat object: ("+s+", "+l+")");if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ar.prototype.wrap=function(){return new Ar(Mu(this.lng,-180,180),this.lat)},Ar.prototype.toArray=function(){return[this.lng,this.lat]},Ar.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ar.prototype.distanceTo=function(s){var l=Math.PI/180,u=this.lat*l,m=s.lat*l,y=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((s.lng-this.lng)*l);return 6371008.8*Math.acos(Math.min(y,1))},Ar.prototype.toBounds=function(s){void 0===s&&(s=0);var l=360*s/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new ti(new Ar(this.lng-u,this.lat-l),new Ar(this.lng+u,this.lat+l))},Ar.convert=function(s){if(s instanceof Ar)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new Ar(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new Ar(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Dv=2*Math.PI*6371008.8;function qf(s){return Dv*Math.cos(s*Math.PI/180)}function Ex(s){return(180+s)/360}function Tv(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function a_(s,l){return s/qf(l)}function Gf(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}var ld=function(s,l,u){void 0===u&&(u=0),this.x=+s,this.y=+l,this.z=+u};ld.fromLngLat=function(s,l){void 0===l&&(l=0);var u=Ar.convert(s);return new ld(Ex(u.lng),Tv(u.lat),a_(l,u.lat))},ld.prototype.toLngLat=function(){return new Ar(360*this.x-180,Gf(this.y))},ld.prototype.toAltitude=function(){return this.z*qf(Gf(this.y))},ld.prototype.meterInMercatorCoordinateUnits=function(){return 1/Dv*(s=Gf(this.y),1/Math.cos(s*Math.PI/180));var s};var fh=function(s,l,u){this.z=s,this.x=l,this.y=u,this.key=Wf(0,s,s,l,u)};fh.prototype.equals=function(s){return this.z===s.z&&this.x===s.x&&this.y===s.y},fh.prototype.url=function(s,l){var u,m,y,b,E,S=(m=this.y,y=this.z,b=Gr(256*(u=this.x),256*(m=Math.pow(2,y)-m-1),y),E=Gr(256*(u+1),256*(m+1),y),b[0]+","+b[1]+","+E[0]+","+E[1]),k=function(M,P,L){for(var z,G="",te=M;te>0;te--)G+=(P&(z=1<<te-1)?1:0)+(L&z?2:0);return G}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",k).replace("{bbox-epsg-3857}",S)},fh.prototype.getTilePoint=function(s){var l=Math.pow(2,this.z);return new Wt(8192*(s.x*l-this.x),8192*(s.y*l-this.y))},fh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Cx=function(s,l){this.wrap=s,this.canonical=l,this.key=Wf(s,l.z,l.z,l.x,l.y)},wi=function(s,l,u,m,y){this.overscaledZ=s,this.wrap=l,this.canonical=new fh(u,+m,+y),this.key=Wf(l,s,u,m,y)};function Wf(s,l,u,m,y){(s*=2)<0&&(s=-1*s-1);var b=1<<u;return(b*b*s+b*y+m).toString(36)+u.toString(36)+l.toString(36)}wi.prototype.equals=function(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)},wi.prototype.scaledTo=function(s){var l=this.canonical.z-s;return s>this.canonical.z?new wi(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wi(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)},wi.prototype.calculateScaledKey=function(s,l){var u=this.canonical.z-s;return s>this.canonical.z?Wf(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):Wf(this.wrap*+l,s,s,this.canonical.x>>u,this.canonical.y>>u)},wi.prototype.isChildOf=function(s){if(s.wrap!==this.wrap)return!1;var l=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l},wi.prototype.children=function(s){if(this.overscaledZ>=s)return[new wi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var l=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new wi(l,this.wrap,l,u,m),new wi(l,this.wrap,l,u+1,m),new wi(l,this.wrap,l,u,m+1),new wi(l,this.wrap,l,u+1,m+1)]},wi.prototype.isLessThan=function(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))},wi.prototype.wrapped=function(){return new wi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},wi.prototype.unwrapTo=function(s){return new wi(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)},wi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},wi.prototype.toUnwrapped=function(){return new Cx(this.wrap,this.canonical)},wi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},wi.prototype.getTilePoint=function(s){return this.canonical.getTilePoint(new ld(s.x-this.wrap,s.y))},lt("CanonicalTileID",fh),lt("OverscaledTileID",wi,{omit:["posMatrix"]});var iu=function(s,l,u){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return yr('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=l.height;var m=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=u||"mapbox";for(var y=0;y<m;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(m,y)]=this.data[this._idx(m-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,m)]=this.data[this._idx(y,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)]};iu.prototype.get=function(s,l){var u=new Uint8Array(this.data.buffer),m=4*this._idx(s,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[m],u[m+1],u[m+2])},iu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},iu.prototype._idx=function(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)},iu.prototype._unpackMapbox=function(s,l,u){return(256*s*256+256*l+u)/10-1e4},iu.prototype._unpackTerrarium=function(s,l,u){return 256*s+l+u/256-32768},iu.prototype.getPixels=function(){return new gs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},iu.prototype.backfillBorder=function(s,l,u){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");var m=l*this.dim,y=l*this.dim+this.dim,b=u*this.dim,E=u*this.dim+this.dim;switch(l){case-1:m=y-1;break;case 1:y=m+1}switch(u){case-1:b=E-1;break;case 1:E=b+1}for(var S=-l*this.dim,k=-u*this.dim,M=b;M<E;M++)for(var P=m;P<y;P++)this.data[this._idx(P,M)]=s.data[this._idx(P+S,M+k)]},lt("DEMData",iu);var pm=function(s){this._stringToNumber={},this._numberToString=[];for(var l=0;l<s.length;l++){var u=s[l];this._stringToNumber[u]=l,this._numberToString[l]=u}};pm.prototype.encode=function(s){return this._stringToNumber[s]},pm.prototype.decode=function(s){return this._numberToString[s]};var l_=function(s,l,u,m,y){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=u,s._y=m,this.properties=s.properties,this.id=y},Sv={geometry:{configurable:!0}};Sv.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Sv.geometry.set=function(s){this._geometry=s},l_.prototype.toJSON=function(){var s={geometry:this.geometry};for(var l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(s[l]=this[l]);return s},Object.defineProperties(l_.prototype,Sv);var mm=function(){this.state={},this.stateChanges={},this.deletedStates={}};mm.prototype.updateState=function(s,l,u){var m=String(l);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},Ui(this.stateChanges[s][m],u),null===this.deletedStates[s])for(var y in this.deletedStates[s]={},this.state[s])y!==m&&(this.deletedStates[s][y]=null);else if(this.deletedStates[s]&&null===this.deletedStates[s][m])for(var b in this.deletedStates[s][m]={},this.state[s][m])u[b]||(this.deletedStates[s][m][b]=null);else for(var E in u)this.deletedStates[s]&&this.deletedStates[s][m]&&null===this.deletedStates[s][m][E]&&delete this.deletedStates[s][m][E]},mm.prototype.removeFeatureState=function(s,l,u){if(null!==this.deletedStates[s]){var m=String(l);if(this.deletedStates[s]=this.deletedStates[s]||{},u&&void 0!==l)null!==this.deletedStates[s][m]&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][u]=null);else if(void 0!==l)if(this.stateChanges[s]&&this.stateChanges[s][m])for(u in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][u]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}},mm.prototype.getState=function(s,l){var u=String(l),m=Ui({},(this.state[s]||{})[u],(this.stateChanges[s]||{})[u]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){var y=this.deletedStates[s][l];if(null===y)return{};for(var b in y)delete m[b]}return m},mm.prototype.initializeTileState=function(s,l){s.setFeatureState(this.state,l)},mm.prototype.coalesceChanges=function(s,l){var u={};for(var m in this.stateChanges){this.state[m]=this.state[m]||{};var y={};for(var b in this.stateChanges[m])this.state[m][b]||(this.state[m][b]={}),Ui(this.state[m][b],this.stateChanges[m][b]),y[b]=this.state[m][b];u[m]=y}for(var E in this.deletedStates){this.state[E]=this.state[E]||{};var S={};if(null===this.deletedStates[E])for(var k in this.state[E])S[k]={},this.state[E][k]={};else for(var M in this.deletedStates[E]){if(null===this.deletedStates[E][M])this.state[E][M]={};else for(var P=0,L=Object.keys(this.deletedStates[E][M]);P<L.length;P+=1)delete this.state[E][M][L[P]];S[M]=this.state[E][M]}u[E]=u[E]||{},Ui(u[E],S)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var z in s)s[z].setFeatureState(u,l)};var ou=function(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new $i(8192,16,0),this.grid3D=new $i(8192,16,0),this.featureIndexArray=new W,this.promoteId=l};function ph(s,l,u,m,y){return zi(s,function(b,E){var S=l instanceof Bs?l.get(E):null;return S&&S.evaluate?S.evaluate(u,m,y):S})}function Ur(s){for(var l=1/0,u=1/0,m=-1/0,y=-1/0,b=0,E=s;b<E.length;b+=1){var S=E[b];l=Math.min(l,S.x),u=Math.min(u,S.y),m=Math.max(m,S.x),y=Math.max(y,S.y)}return{minX:l,minY:u,maxX:m,maxY:y}}function Dx(s,l){return l-s}ou.prototype.insert=function(s,l,u,m,y,b){var E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,y);for(var S=b?this.grid3D:this.grid,k=0;k<l.length;k++){for(var M=l[k],P=[1/0,1/0,-1/0,-1/0],L=0;L<M.length;L++){var z=M[L];P[0]=Math.min(P[0],z.x),P[1]=Math.min(P[1],z.y),P[2]=Math.max(P[2],z.x),P[3]=Math.max(P[3],z.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&S.insert(E,P[0],P[1],P[2],P[3])}},ou.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new lm.VectorTile(new nu(this.rawTileData)).layers,this.sourceLayerCoder=new pm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ou.prototype.query=function(s,l,u,m){var y=this;this.loadVTLayers();for(var b=s.params||{},E=8192/s.tileSize/s.scale,S=Ls(b.filter),k=s.queryGeometry,M=s.queryPadding*E,P=Ur(k),L=this.grid.query(P.minX-M,P.minY-M,P.maxX+M,P.maxY+M),z=Ur(s.cameraQueryGeometry),te=0,J=this.grid3D.query(z.minX-M,z.minY-M,z.maxX+M,z.maxY+M,function(Ie,ke,Be,Ye){return function(nt,wt,it,At,at){for(var fn=0,Vt=nt;fn<Vt.length;fn+=1){var vt=Vt[fn];if(wt<=vt.x&&it<=vt.y&&At>=vt.x&&at>=vt.y)return!0}var yn=[new Wt(wt,it),new Wt(wt,at),new Wt(At,at),new Wt(At,it)];if(nt.length>2)for(var on=0,Dn=yn;on<Dn.length;on+=1)if(ma(nt,Dn[on]))return!0;for(var Mt=0;Mt<nt.length-1;Mt++)if(eu(nt[Mt],nt[Mt+1],yn))return!0;return!1}(s.cameraQueryGeometry,Ie-M,ke-M,Be+M,Ye+M)});te<J.length;te+=1)L.push(J[te]);L.sort(Dx);for(var pe,he={},be=function(Ie){var ke=L[Ie];if(ke!==pe){pe=ke;var Be=y.featureIndexArray.get(ke),Ye=null;y.loadMatchingFeature(he,Be.bucketIndex,Be.sourceLayerIndex,Be.featureIndex,S,b.layers,b.availableImages,l,u,m,function(nt,wt,it){return Ye||(Ye=ei(nt)),wt.queryIntersectsFeature(k,nt,it,Ye,y.z,s.transform,E,s.pixelPosMatrix)})}},ve=0;ve<L.length;ve++)be(ve);return he},ou.prototype.loadMatchingFeature=function(s,l,u,m,y,b,E,S,k,M,P){var L=this.bucketLayerIDs[l];if(!b||function(nt,wt){for(var it=0;it<nt.length;it++)if(wt.indexOf(nt[it])>=0)return!0;return!1}(b,L)){var z=this.sourceLayerCoder.decode(u),G=this.vtLayers[z].feature(m);if(y.needGeometry){var te=Uo(G,!0);if(!y.filter(new Kt(this.tileID.overscaledZ),te,this.tileID.canonical))return}else if(!y.filter(new Kt(this.tileID.overscaledZ),G))return;for(var J=this.getId(G,z),pe=0;pe<L.length;pe++){var he=L[pe];if(!(b&&b.indexOf(he)<0)){var be=S[he];if(be){var ve={};void 0!==J&&M&&(ve=M.getState(be.sourceLayer||"_geojsonTileLayer",J));var Ie=Ui({},k[he]);Ie.paint=ph(Ie.paint,be.paint,G,ve,E),Ie.layout=ph(Ie.layout,be.layout,G,ve,E);var ke=!P||P(G,be,ve);if(ke){var Be=new l_(G,this.z,this.x,this.y,J);Be.layer=Ie;var Ye=s[he];void 0===Ye&&(Ye=s[he]=[]),Ye.push({featureIndex:m,feature:Be,intersectionZ:ke})}}}}}},ou.prototype.lookupSymbolFeatures=function(s,l,u,m,y,b,E,S){var k={};this.loadVTLayers();for(var M=Ls(y),P=0,L=s;P<L.length;P+=1)this.loadMatchingFeature(k,u,m,L[P],M,b,E,S,l);return k},ou.prototype.hasLayer=function(s){for(var l=0,u=this.bucketLayerIDs;l<u.length;l+=1)for(var m=0,y=u[l];m<y.length;m+=1)if(s===y[m])return!0;return!1},ou.prototype.getId=function(s,l){var u=s.id;return this.promoteId&&"boolean"==typeof(u=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]])&&(u=Number(u)),u},lt("FeatureIndex",ou,{omit:["rawTileData","sourceLayerCoder"]});var Ji=function(s,l){this.tileID=s,this.uid=hl(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ji.prototype.registerFadeDuration=function(s){var l=s+this.timeAdded;l<pl.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)},Ji.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ji.prototype.loadVectorData=function(s,l,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){for(var m in s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(M,P){var L={};if(!P)return L;for(var z=function(){var J=te[G],pe=J.layerIds.map(function(ve){return P.getLayer(ve)}).filter(Boolean);if(0!==pe.length){J.layers=pe,J.stateDependentLayerIds&&(J.stateDependentLayers=J.stateDependentLayerIds.map(function(ve){return pe.filter(function(Ie){return Ie.id===ve})[0]}));for(var he=0,be=pe;he<be.length;he+=1)L[be[he].id]=J}},G=0,te=M;G<te.length;G+=1)z();return L}(s.buckets,l.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[m];if(y instanceof tr){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var E=this.buckets[b];if(E instanceof tr&&E.hasRTLText){this.hasRTLText=!0,ar.isLoading()||ar.isLoaded()||"deferred"!==wo()||eh();break}}for(var S in this.queryPadding=0,this.buckets){var k=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(S).queryRadius(k))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new h},Ji.prototype.unloadVectorData=function(){for(var s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ji.prototype.getBucket=function(s){return this.buckets[s.id]},Ji.prototype.upload=function(s){for(var l in this.buckets){var u=this.buckets[l];u.uploadPending()&&u.upload(s)}var m=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ga(s,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ga(s,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)},Ji.prototype.prepare=function(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)},Ji.prototype.queryRenderedFeatures=function(s,l,u,m,y,b,E,S,k,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:M,transform:S,params:E,queryPadding:this.queryPadding*k},s,l,u):{}},Ji.prototype.querySourceFeatures=function(s,l){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var m=u.loadVTLayers(),y=l?l.sourceLayer:"",b=m._geojsonTileLayer||m[y];if(b)for(var E=Ls(l&&l.filter),S=this.tileID.canonical,k=S.z,M=S.x,P=S.y,L={z:k,x:M,y:P},z=0;z<b.length;z++){var G=b.feature(z);if(E.needGeometry){var te=Uo(G,!0);if(!E.filter(new Kt(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!E.filter(new Kt(this.tileID.overscaledZ),G))continue;var J=u.getId(G,y),pe=new l_(G,k,M,P,J);pe.tile=L,s.push(pe)}}},Ji.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ji.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ji.prototype.setExpiryData=function(s){var l=this.expirationTime;if(s.cacheControl){var u=ql(s.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){var m=Date.now(),y=!1;if(this.expirationTime>m)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{var b=this.expirationTime-l;b?this.expirationTime=m+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ji.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ji.prototype.setFeatureState=function(s,l){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(s).length){var u=this.latestFeatureIndex.loadVTLayers();for(var m in this.buckets)if(l.style.hasLayer(m)){var y=this.buckets[m],b=y.layers[0].sourceLayer||"_geojsonTileLayer",E=u[b],S=s[b];if(E&&S&&0!==Object.keys(S).length){y.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});var k=l&&l.style&&l.style.getLayer(m);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}}},Ji.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ji.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<pl.now()},Ji.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ji.prototype.setHoldDuration=function(s){this.symbolFadeHoldUntil=pl.now()+s},Ji.prototype.setDependencies=function(s,l){for(var u={},m=0,y=l;m<y.length;m+=1)u[y[m]]=!0;this.dependencies[s]=u},Ji.prototype.hasDependency=function(s,l){for(var u=0,m=s;u<m.length;u+=1){var y=this.dependencies[m[u]];if(y)for(var b=0,E=l;b<E.length;b+=1)if(y[E[b]])return!0}return!1};var cd=bt.performance,Tx=function(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},cd.mark(this._marks.start)};Tx.prototype.finish=function(){cd.mark(this._marks.end);var s=cd.getEntriesByName(this._marks.measure);return 0===s.length&&(cd.measure(this._marks.measure,this._marks.start,this._marks.end),s=cd.getEntriesByName(this._marks.measure),cd.clearMarks(this._marks.start),cd.clearMarks(this._marks.end),cd.clearMeasures(this._marks.measure)),s},v.Actor=$f,v.AlphaImage=hc,v.CanonicalTileID=fh,v.CollisionBoxArray=h,v.Color=wn,v.DEMData=iu,v.DataConstantProperty=tt,v.DictionaryCoder=pm,v.EXTENT=8192,v.ErrorEvent=ye,v.EvaluationParameters=Kt,v.Event=me,v.Evented=ee,v.FeatureIndex=ou,v.FillBucket=Cl,v.FillExtrusionBucket=fc,v.ImageAtlas=Vf,v.ImagePosition=Bf,v.LineBucket=Do,v.LngLat=Ar,v.LngLatBounds=ti,v.MercatorCoordinate=ld,v.ONE_EM=24,v.OverscaledTileID=wi,v.Point=Wt,v.Point$1=Wt,v.Properties=yi,v.Protobuf=nu,v.RGBAImage=gs,v.RequestManager=Fo,v.RequestPerformance=Tx,v.ResourceType=Fu,v.SegmentVector=$,v.SourceFeatureState=mm,v.StructArrayLayout1ui2=tm,v.StructArrayLayout2f1f2i16=Xu,v.StructArrayLayout2i4=Yu,v.StructArrayLayout3ui6=Qs,v.StructArrayLayout4i8=uo,v.SymbolBucket=tr,v.Texture=ga,v.Tile=Ji,v.Transitionable=gi,v.Uniform1f=We,v.Uniform1i=Qe,v.Uniform2f=ct,v.Uniform3f=Ct,v.Uniform4f=kt,v.UniformColor=It,v.UniformMatrix4f=ft,v.UnwrappedTileID=Cx,v.ValidationError=ae,v.WritingMode=ta,v.ZoomHistory=bo,v.add=function(s,l,u){return s[0]=l[0]+u[0],s[1]=l[1]+u[1],s[2]=l[2]+u[2],s},v.addDynamicAttributes=Za,v.asyncAll=function(s,l,u){if(!s.length)return u(null,[]);var m=s.length,y=new Array(s.length),b=null;s.forEach(function(E,S){l(E,function(k,M){k&&(b=k),y[S]=M,0==--m&&u(b,y)})})},v.bezier=Oo,v.bindAll=Ia,v.browser=pl,v.cacheEntryPossiblyAdded=function(s){++Zl>uf&&(s.getActor().send("enforceCacheSizeLimit",Ou),Zl=0)},v.clamp=io,v.clearTileCache=function(s){var l=bt.caches.delete("mapbox-tiles");s&&l.catch(s).then(function(){return s()})},v.clipLine=bv,v.clone=function(s){var l=new jn(16);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l},v.clone$1=Gs,v.clone$2=function(s){var l=new jn(3);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l},v.collisionCircleLayout=TT,v.config=or,v.create=function(){var s=new jn(16);return jn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},v.create$1=function(){var s=new jn(9);return jn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s},v.create$2=function(){var s=new jn(4);return jn!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},v.createCommonjsModule=Qo,v.createExpression=za,v.createLayout=Cn,v.createStyleLayer=function(s){return"custom"===s.type?new s_(s):new xO[s.type](s)},v.cross=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=u[0],S=u[1],k=u[2];return s[0]=y*k-b*S,s[1]=b*E-m*k,s[2]=m*S-y*E,s},v.deepEqual=function s(l,u){if(Array.isArray(l)){if(!Array.isArray(u)||l.length!==u.length)return!1;for(var m=0;m<l.length;m++)if(!s(l[m],u[m]))return!1;return!0}if("object"==typeof l&&null!==l&&null!==u){if("object"!=typeof u||Object.keys(l).length!==Object.keys(u).length)return!1;for(var y in l)if(!s(l[y],u[y]))return!1;return!0}return l===u},v.dot=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]},v.dot$1=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]+s[3]*l[3]},v.ease=Bc,v.emitValidationErrors=da,v.endsWith=Vc,v.enforceCacheSizeLimit=function(s){Lu(),Rs&&Rs.then(function(l){l.keys().then(function(u){for(var m=0;m<u.length-s;m++)l.delete(u[m])})})},v.evaluateSizeForFeature=cm,v.evaluateSizeForZoom=um,v.evaluateVariableOffset=mx,v.evented=rn,v.extend=Ui,v.featureFilter=Ls,v.filterObject=ks,v.fromRotation=function(s,l){var u=Math.sin(l),m=Math.cos(l);return s[0]=m,s[1]=u,s[2]=0,s[3]=-u,s[4]=m,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},v.getAnchorAlignment=mv,v.getAnchorJustification=dh,v.getArrayBuffer=sr,v.getImage=H,v.getJSON=function(s,l){return Yl(Ui(s,{type:"json"}),l)},v.getRTLTextPluginStatus=wo,v.getReferrer=yl,v.getVideo=function(s,l){var u,m,y=bt.document.createElement("video");y.muted=!0,y.onloadstart=function(){l(null,y)};for(var b=0;b<s.length;b++){var E=bt.document.createElement("source");u=s[b],m=void 0,(m=bt.document.createElement("a")).href=u,(m.protocol!==bt.document.location.protocol||m.host!==bt.document.location.host)&&(y.crossOrigin="Anonymous"),E.src=s[b],y.appendChild(E)}return{cancel:function(){}}},v.identity=Vr,v.invert=function(s,l){var u=l[0],m=l[1],y=l[2],b=l[3],E=l[4],S=l[5],k=l[6],M=l[7],P=l[8],L=l[9],z=l[10],G=l[11],te=l[12],J=l[13],pe=l[14],he=l[15],be=u*S-m*E,ve=u*k-y*E,Ie=u*M-b*E,ke=m*k-y*S,Be=m*M-b*S,Ye=y*M-b*k,nt=P*J-L*te,wt=P*pe-z*te,it=P*he-G*te,At=L*pe-z*J,at=L*he-G*J,fn=z*he-G*pe,Vt=be*fn-ve*at+Ie*At+ke*it-Be*wt+Ye*nt;return Vt?(s[0]=(S*fn-k*at+M*At)*(Vt=1/Vt),s[1]=(y*at-m*fn-b*At)*Vt,s[2]=(J*Ye-pe*Be+he*ke)*Vt,s[3]=(z*Be-L*Ye-G*ke)*Vt,s[4]=(k*it-E*fn-M*wt)*Vt,s[5]=(u*fn-y*it+b*wt)*Vt,s[6]=(pe*Ie-te*Ye-he*ve)*Vt,s[7]=(P*Ye-z*Ie+G*ve)*Vt,s[8]=(E*at-S*it+M*nt)*Vt,s[9]=(m*it-u*at-b*nt)*Vt,s[10]=(te*Be-J*Ie+he*be)*Vt,s[11]=(L*Ie-P*Be-G*be)*Vt,s[12]=(S*wt-E*At-k*nt)*Vt,s[13]=(u*At-m*wt+y*nt)*Vt,s[14]=(J*ve-te*ke-pe*be)*Vt,s[15]=(P*ke-L*ve+z*be)*Vt,s):null},v.isChar=mt,v.isMapboxURL=Zs,v.keysDifference=function(s,l){var u=[];for(var m in s)m in l||u.push(m);return u},v.makeRequest=Yl,v.mapObject=zi,v.mercatorXfromLng=Ex,v.mercatorYfromLat=Tv,v.mercatorZfromAltitude=a_,v.mul=El,v.multiply=Ju,v.mvt=lm,v.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},v.normalize=function(s,l){var u=l[0],m=l[1],y=l[2],b=u*u+m*m+y*y;return b>0&&(b=1/Math.sqrt(b)),s[0]=l[0]*b,s[1]=l[1]*b,s[2]=l[2]*b,s},v.number=mi,v.offscreenCanvasSupported=zd,v.ortho=function(s,l,u,m,y,b,E){var S=1/(l-u),k=1/(m-y),M=1/(b-E);return s[0]=-2*S,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*k,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*M,s[11]=0,s[12]=(l+u)*S,s[13]=(y+m)*k,s[14]=(E+b)*M,s[15]=1,s},v.parseGlyphPBF=function(s){return new nu(s).readFields(PT,[])},v.pbf=nu,v.performSymbolLayout=function(s,l,u,m,y,b,E){s.createArrays(),s.tilePixelRatio=8192/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;var S=s.layers[0].layout,k=s.layers[0]._unevaluatedLayout._values,M={};if("composite"===s.textSizeData.kind){var P=s.textSizeData,L=P.maxZoom;M.compositeTextSizes=[k["text-size"].possiblyEvaluate(new Kt(P.minZoom),E),k["text-size"].possiblyEvaluate(new Kt(L),E)]}if("composite"===s.iconSizeData.kind){var z=s.iconSizeData,G=z.maxZoom;M.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new Kt(z.minZoom),E),k["icon-size"].possiblyEvaluate(new Kt(G),E)]}M.layoutTextSize=k["text-size"].possiblyEvaluate(new Kt(s.zoom+1),E),M.layoutIconSize=k["icon-size"].possiblyEvaluate(new Kt(s.zoom+1),E),M.textMaxSize=k["text-size"].possiblyEvaluate(new Kt(18));for(var te=24*S.get("text-line-height"),J="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),pe=S.get("text-keep-upright"),he=S.get("text-size"),be=function(){var ke=Ie[ve],Be=S.get("text-font").evaluate(ke,{},E).join(","),Ye=he.evaluate(ke,{},E),nt=M.layoutTextSize.evaluate(ke,{},E),wt=M.layoutIconSize.evaluate(ke,{},E),it={horizontal:{},vertical:void 0},At=ke.text,at=[0,0];if(At){var fn=At.toString(),Vt=24*S.get("text-letter-spacing").evaluate(ke,{},E),vt=function(bn){for(var ur=0,nr=bn;ur<nr.length;ur+=1)if(Rn=nr[ur].charCodeAt(0),mt.Arabic(Rn)||mt["Arabic Supplement"](Rn)||mt["Arabic Extended-A"](Rn)||mt["Arabic Presentation Forms-A"](Rn)||mt["Arabic Presentation Forms-B"](Rn))return!1;var Rn;return!0}(fn)?Vt:0,yn=S.get("text-anchor").evaluate(ke,{},E),on=S.get("text-variable-anchor");if(!on){var Dn=S.get("text-radial-offset").evaluate(ke,{},E);at=Dn?mx(yn,[24*Dn,uh]):S.get("text-offset").evaluate(ke,{},E).map(function(bn){return 24*bn})}var Mt=J?"center":S.get("text-justify").evaluate(ke,{},E),Mn=S.get("symbol-placement"),Cr="point"===Mn?24*S.get("text-max-width").evaluate(ke,{},E):0,zr=function(){s.allowVerticalPlacement&&Jr(fn)&&(it.vertical=Qg(At,l,u,y,Be,Cr,te,yn,"left",vt,at,ta.vertical,!0,Mn,nt,Ye))};if(!J&&on){for(var Or="auto"===Mt?on.map(function(bn){return dh(bn)}):[Mt],Dr=!1,Wr=0;Wr<Or.length;Wr++){var Ni=Or[Wr];if(!it.horizontal[Ni])if(Dr)it.horizontal[Ni]=it.horizontal[0];else{var Oi=Qg(At,l,u,y,Be,Cr,te,"center",Ni,vt,at,ta.horizontal,!1,Mn,nt,Ye);Oi&&(it.horizontal[Ni]=Oi,Dr=1===Oi.positionedLines.length)}}zr()}else{"auto"===Mt&&(Mt=dh(yn));var $o=Qg(At,l,u,y,Be,Cr,te,yn,Mt,vt,at,ta.horizontal,!1,Mn,nt,Ye);$o&&(it.horizontal[Mt]=$o),zr(),Jr(fn)&&J&&pe&&(it.vertical=Qg(At,l,u,y,Be,Cr,te,yn,Mt,vt,at,ta.vertical,!1,Mn,nt,Ye))}}var bn,ur,Rn,So,Io,eo=void 0,qo=!1;if(ke.icon&&ke.icon.name){var ni=m[ke.icon.name];ni&&(bn=y[ke.icon.name],ur=S.get("icon-offset").evaluate(ke,{},E),Rn=mv(S.get("icon-anchor").evaluate(ke,{},E)),eo={image:bn,top:Io=ur[1]-bn.displaySize[1]*Rn.verticalAlign,bottom:Io+bn.displaySize[1],left:So=ur[0]-bn.displaySize[0]*Rn.horizontalAlign,right:So+bn.displaySize[0]},qo=ni.sdf,void 0===s.sdfIcons?s.sdfIcons=ni.sdf:s.sdfIcons!==ni.sdf&&yr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ni.pixelRatio!==s.pixelRatio||0!==S.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}var Li=hm(it.horizontal)||it.vertical;s.iconsInText=!!Li&&Li.iconsInText,(Li||eo)&&function(bn,ur,nr,Rn,So,Io,rr,Tr,ko,$n,Sl){var ys=Io.textMaxSize.evaluate(ur,{});void 0===ys&&(ys=rr);var _a,jr=bn.layers[0].layout,gc=jr.get("icon-offset").evaluate(ur,{},Sl),Ka=hm(nr.horizontal),gm=rr/24,Il=bn.tilePixelRatio*gm,mh=bn.tilePixelRatio*ys/24,_c=bn.tilePixelRatio*Tr,gh=bn.tilePixelRatio*jr.get("symbol-spacing"),Zf=jr.get("text-padding")*bn.tilePixelRatio,_h=jr.get("icon-padding")*bn.tilePixelRatio,Kf=jr.get("text-max-angle")/180*Math.PI,c_="map"===jr.get("text-rotation-alignment")&&"point"!==jr.get("symbol-placement"),Yf="map"===jr.get("icon-rotation-alignment")&&"point"!==jr.get("symbol-placement"),yc=jr.get("symbol-placement"),vc=gh/2,Xf=jr.get("icon-text-fit");Rn&&"none"!==Xf&&(bn.allowVerticalPlacement&&nr.vertical&&(_a=Dt(Rn,nr.vertical,Xf,jr.get("icon-text-fit-padding"),gc,gm)),Ka&&(Rn=Dt(Rn,Ka,Xf,jr.get("icon-text-fit-padding"),gc,gm)));var su=function(p_,bh){bh.x<0||bh.x>=8192||bh.y<0||bh.y>=8192||function(Zr,Ya,VT,ud,m_,g_,kv,lu,__,y_,v_,Av,Sx,b_,w_,Mv,Rv,Ix,UT,cu,ya,wh,kx,wc,Ax){var Tm,xh,dd,np,Eh,rp=Zr.addToLineVertexArray(Ya,VT),zT=0,Pv=0,Mx=0,Rx=0,Nv=-1,Ch=-1,xc={},x_=le(""),Ov=0,Px=0;if(void 0===lu._unevaluatedLayout.getValue("text-radial-offset")?(Ov=(Tm=lu.layout.get("text-offset").evaluate(ya,{},wc).map(function(I_){return 24*I_}))[0],Px=Tm[1]):(Ov=24*lu.layout.get("text-radial-offset").evaluate(ya,{},wc),Px=uh),Zr.allowVerticalPlacement&&ud.vertical){var jT=lu.layout.get("text-rotate").evaluate(ya,{},wc)+90;np=new n_(__,Ya,y_,v_,Av,ud.vertical,Sx,b_,w_,jT),kv&&(Eh=new n_(__,Ya,y_,v_,Av,kv,Rv,Ix,w_,jT))}if(m_){var Nx=lu.layout.get("icon-rotate").evaluate(ya,{}),ip="none"!==lu.layout.get("icon-text-fit"),Ox=LT(m_,Nx,kx,ip),op=kv?LT(kv,Nx,kx,ip):void 0;dd=new n_(__,Ya,y_,v_,Av,m_,Rv,Ix,!1,Nx),zT=4*Ox.length;var E_=Zr.iconSizeData,sp=null;"source"===E_.kind?(sp=[128*lu.layout.get("icon-size").evaluate(ya,{})])[0]>32640&&yr(Zr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===E_.kind&&((sp=[128*wh.compositeIconSizes[0].evaluate(ya,{},wc),128*wh.compositeIconSizes[1].evaluate(ya,{},wc)])[0]>32640||sp[1]>32640)&&yr(Zr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Zr.addSymbols(Zr.icon,Ox,sp,cu,UT,ya,!1,Ya,rp.lineStartIndex,rp.lineLength,-1,wc),Nv=Zr.icon.placedSymbolArray.length-1,op&&(Pv=4*op.length,Zr.addSymbols(Zr.icon,op,sp,cu,UT,ya,ta.vertical,Ya,rp.lineStartIndex,rp.lineLength,-1,wc),Ch=Zr.icon.placedSymbolArray.length-1)}for(var C_ in ud.horizontal){var Lv=ud.horizontal[C_];if(!xh){x_=le(Lv.text);var EO=lu.layout.get("text-rotate").evaluate(ya,{},wc);xh=new n_(__,Ya,y_,v_,Av,Lv,Sx,b_,w_,EO)}var HT=1===Lv.positionedLines.length;if(Mx+=r_(Zr,Ya,Lv,g_,lu,w_,ya,Mv,rp,ud.vertical?ta.horizontal:ta.horizontalOnly,HT?Object.keys(ud.horizontal):[C_],xc,Nv,wh,wc),HT)break}ud.vertical&&(Rx+=r_(Zr,Ya,ud.vertical,g_,lu,w_,ya,Mv,rp,ta.vertical,["vertical"],xc,Ch,wh,wc));var Lx=xh?xh.boxStartIndex:Zr.collisionBoxArray.length,$T=xh?xh.boxEndIndex:Zr.collisionBoxArray.length,Fx=np?np.boxStartIndex:Zr.collisionBoxArray.length,Fv=np?np.boxEndIndex:Zr.collisionBoxArray.length,Bx=dd?dd.boxStartIndex:Zr.collisionBoxArray.length,D_=dd?dd.boxEndIndex:Zr.collisionBoxArray.length,T_=Eh?Eh.boxStartIndex:Zr.collisionBoxArray.length,qT=Eh?Eh.boxEndIndex:Zr.collisionBoxArray.length,uu=-1,S_=function(I_,Bv){return I_&&I_.circleDiameter?Math.max(I_.circleDiameter,Bv):Bv};uu=S_(xh,uu),uu=S_(np,uu),uu=S_(dd,uu);var Vx=(uu=S_(Eh,uu))>-1?1:0;Vx&&(uu*=Ax/24),Zr.glyphOffsetArray.length>=tr.MAX_GLYPHS&&yr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ya.sortKey&&Zr.addToSortKeyRanges(Zr.symbolInstances.length,ya.sortKey),Zr.symbolInstances.emplaceBack(Ya.x,Ya.y,xc.right>=0?xc.right:-1,xc.center>=0?xc.center:-1,xc.left>=0?xc.left:-1,xc.vertical||-1,Nv,Ch,x_,Lx,$T,Fx,Fv,Bx,D_,T_,qT,y_,Mx,Rx,zT,Pv,Vx,0,Sx,Ov,Px,uu)}(bn,bh,p_,nr,Rn,So,_a,bn.layers[0],bn.collisionBoxArray,ur.index,ur.sourceLayerIndex,bn.index,Il,Zf,c_,ko,_c,_h,Yf,gc,ur,Io,$n,Sl,rr)};if("line"===yc)for(var yh=0,u_=bv(ur.geometry,0,0,8192,8192);yh<u_.length;yh+=1)for(var _m=u_[yh],Qf=0,ym=vv(_m,gh,Kf,nr.vertical||Ka,Rn,24,mh,bn.overscaling,8192);Qf<ym.length;Qf+=1){var Jf=ym[Qf];Ka&&wO(bn,Ka.text,vc,Jf)||su(_m,Jf)}else if("line-center"===yc)for(var d_=0,ep=ur.geometry;d_<ep.length;d_+=1){var vm=ep[d_];if(vm.length>1){var h_=dm(vm,Kf,nr.vertical||Ka,Rn,24,mh);h_&&su(vm,h_)}}else if("Polygon"===ur.type)for(var bm=0,Iv=lv(ur.geometry,0);bm<Iv.length;bm+=1){var wm=Iv[bm],xm=zf(wm,16);su(wm[0],new Uf(xm.x,xm.y,0))}else if("LineString"===ur.type)for(var vh=0,Em=ur.geometry;vh<Em.length;vh+=1){var au=Em[vh];su(au,new Uf(au[0].x,au[0].y,0))}else if("Point"===ur.type)for(var Cm=0,f_=ur.geometry;Cm<f_.length;Cm+=1)for(var bc=0,Dm=f_[Cm];bc<Dm.length;bc+=1){var tp=Dm[bc];su([tp],new Uf(tp.x,tp.y,0))}}(s,ke,it,eo,m,M,nt,wt,at,qo,E)},ve=0,Ie=s.features;ve<Ie.length;ve+=1)be();b&&s.generateCollisionDebugBuffers()},v.perspective=function(s,l,u,m,y){var b,E=1/Math.tan(l/2);return s[0]=E/u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=y&&y!==1/0?(s[10]=(y+m)*(b=1/(m-y)),s[14]=2*y*m*b):(s[10]=-1,s[14]=-2*m),s},v.pick=function(s,l){for(var u={},m=0;m<l.length;m++){var y=l[m];y in s&&(u[y]=s[y])}return u},v.plugin=ar,v.polygonIntersectsPolygon=Le,v.postMapLoadEvent=Na,v.postTurnstileEvent=zc,v.potpack=lx,v.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],v.register=lt,v.registerForPluginStateChange=function(s){return s({pluginStatus:Zi,pluginURL:Nn}),rn.on("pluginStateChange",s),s},v.renderColorRamp=qg,v.rotate=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=Math.sin(u),k=Math.cos(u);return s[0]=m*k+b*S,s[1]=y*k+E*S,s[2]=m*-S+b*k,s[3]=y*-S+E*k,s},v.rotateX=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[4],E=l[5],S=l[6],k=l[7],M=l[8],P=l[9],L=l[10],z=l[11];return l!==s&&(s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[4]=b*y+M*m,s[5]=E*y+P*m,s[6]=S*y+L*m,s[7]=k*y+z*m,s[8]=M*y-b*m,s[9]=P*y-E*m,s[10]=L*y-S*m,s[11]=z*y-k*m,s},v.rotateZ=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[0],E=l[1],S=l[2],k=l[3],M=l[4],P=l[5],L=l[6],z=l[7];return l!==s&&(s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[0]=b*y+M*m,s[1]=E*y+P*m,s[2]=S*y+L*m,s[3]=k*y+z*m,s[4]=M*y-b*m,s[5]=P*y-E*m,s[6]=L*y-S*m,s[7]=z*y-k*m,s},v.scale=function(s,l,u){var m=u[0],y=u[1],b=u[2];return s[0]=l[0]*m,s[1]=l[1]*m,s[2]=l[2]*m,s[3]=l[3]*m,s[4]=l[4]*y,s[5]=l[5]*y,s[6]=l[6]*y,s[7]=l[7]*y,s[8]=l[8]*b,s[9]=l[9]*b,s[10]=l[10]*b,s[11]=l[11]*b,s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},v.scale$1=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s[3]=l[3]*u,s},v.scale$2=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s},v.setCacheLimits=function(s,l){Ou=s,uf=l},v.setRTLTextPlugin=function(s,l,u){if(void 0===u&&(u=!1),"deferred"===Zi||"loading"===Zi||"loaded"===Zi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Nn=pl.resolveURL(s),Zi="deferred",xl=l,hs(),u||eh()},v.sphericalToCartesian=function(s){var l=s[0],u=s[1],m=s[2];return u+=90,u*=Math.PI/180,m*=Math.PI/180,{x:l*Math.cos(u)*Math.sin(m),y:l*Math.sin(u)*Math.sin(m),z:l*Math.cos(m)}},v.sqrLen=function(s){var l=s[0],u=s[1];return l*l+u*u},v.styleSpec=X,v.sub=function(s,l,u){return s[0]=l[0]-u[0],s[1]=l[1]-u[1],s[2]=l[2]-u[2],s},v.symbolSize=gv,v.transformMat3=function(s,l,u){var m=l[0],y=l[1],b=l[2];return s[0]=m*u[0]+y*u[3]+b*u[6],s[1]=m*u[1]+y*u[4]+b*u[7],s[2]=m*u[2]+y*u[5]+b*u[8],s},v.transformMat4=Pf,v.translate=function(s,l,u){var m,y,b,E,S,k,M,P,L,z,G,te,J=u[0],pe=u[1],he=u[2];return l===s?(s[12]=l[0]*J+l[4]*pe+l[8]*he+l[12],s[13]=l[1]*J+l[5]*pe+l[9]*he+l[13],s[14]=l[2]*J+l[6]*pe+l[10]*he+l[14],s[15]=l[3]*J+l[7]*pe+l[11]*he+l[15]):(y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],M=l[6],P=l[7],L=l[8],z=l[9],G=l[10],te=l[11],s[0]=m=l[0],s[1]=y,s[2]=b,s[3]=E,s[4]=S,s[5]=k,s[6]=M,s[7]=P,s[8]=L,s[9]=z,s[10]=G,s[11]=te,s[12]=m*J+S*pe+L*he+l[12],s[13]=y*J+k*pe+z*he+l[13],s[14]=b*J+M*pe+G*he+l[14],s[15]=E*J+P*pe+te*he+l[15]),s},v.triggerPluginCompletionEvent=zn,v.uniqueId=hl,v.validateCustomStyleLayer=function(s){var l=[],u=s.id;return void 0===u&&l.push({message:"layers."+u+': missing required property "id"'}),void 0===s.render&&l.push({message:"layers."+u+': missing required method "render"'}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&l.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),l},v.validateLight=Qp,v.validateStyle=Zu,v.values=function(s){var l=[];for(var u in s)l.push(s[u]);return l},v.vectorTile=lm,v.version="1.15.3",v.warnOnce=yr,v.webpSupported=Ma,v.window=bt,v.wrap=Mu}),Ud(0,function(v){function Qo(B){var j=typeof B;if("number"===j||"boolean"===j||"string"===j||null==B)return JSON.stringify(B);if(Array.isArray(B)){for(var H="[",K=0,oe=B;K<oe.length;K+=1)H+=Qo(oe[K])+",";return H+"]"}for(var me=Object.keys(B).sort(),ye="{",ee=0;ee<me.length;ee++)ye+=JSON.stringify(me[ee])+":"+Qo(B[me[ee]])+",";return ye+"}"}function He(B){for(var j="",H=0,K=v.refProperties;H<K.length;H+=1)j+="/"+Qo(B[K[H]]);return j}var St=function(B){this.keyCache={},B&&this.replace(B)};St.prototype.replace=function(B){this._layerConfigs={},this._layers={},this.update(B,[])},St.prototype.update=function(B,j){for(var H=this,K=0,oe=B;K<oe.length;K+=1){var me=oe[K];this._layerConfigs[me.id]=me;var ye=this._layers[me.id]=v.createStyleLayer(me);ye._featureFilter=v.featureFilter(ye.filter),this.keyCache[me.id]&&delete this.keyCache[me.id]}for(var ee=0,X=j;ee<X.length;ee+=1){var ae=X[ee];delete this.keyCache[ae],delete this._layerConfigs[ae],delete this._layers[ae]}this.familiesBySource={};for(var qe=0,Je=function(rt,je){for(var en={},tn=0;tn<rt.length;tn++){var ue=je&&je[rt[tn].id]||He(rt[tn]);je&&(je[rt[tn].id]=ue);var fr=en[ue];fr||(fr=en[ue]=[]),fr.push(rt[tn])}var Ht=[];for(var ln in en)Ht.push(en[ln]);return Ht}(v.values(this._layerConfigs),this.keyCache);qe<Je.length;qe+=1){var Te=Je[qe].map(function(rt){return H._layers[rt.id]}),Ge=Te[0];if("none"!==Ge.visibility){var ht=Ge.source||"",pt=this.familiesBySource[ht];pt||(pt=this.familiesBySource[ht]={});var Et=Ge.sourceLayer||"_geojsonTileLayer",Fe=pt[Et];Fe||(Fe=pt[Et]=[]),Fe.push(Te)}}};var Wt=function(B){var j={},H=[];for(var K in B){var oe=B[K],me=j[K]={};for(var ye in oe){var ee=oe[+ye];if(ee&&0!==ee.bitmap.width&&0!==ee.bitmap.height){var X={x:0,y:0,w:ee.bitmap.width+2,h:ee.bitmap.height+2};H.push(X),me[ye]={rect:X,metrics:ee.metrics}}}}var ae=v.potpack(H),qe=new v.AlphaImage({width:ae.w||1,height:ae.h||1});for(var Je in B){var Te=B[Je];for(var Ge in Te){var ht=Te[+Ge];if(ht&&0!==ht.bitmap.width&&0!==ht.bitmap.height){var pt=j[Je][Ge].rect;v.AlphaImage.copy(ht.bitmap,qe,{x:0,y:0},{x:pt.x+1,y:pt.y+1},ht.bitmap)}}}this.image=qe,this.positions=j};v.register("GlyphAtlas",Wt);var dl=function(B){this.tileID=new v.OverscaledTileID(B.tileID.overscaledZ,B.tileID.wrap,B.tileID.canonical.z,B.tileID.canonical.x,B.tileID.canonical.y),this.uid=B.uid,this.zoom=B.zoom,this.pixelRatio=B.pixelRatio,this.tileSize=B.tileSize,this.source=B.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=B.showCollisionBoxes,this.collectResourceTiming=!!B.collectResourceTiming,this.returnDependencies=!!B.returnDependencies,this.promoteId=B.promoteId};function bt(B,j,H){for(var K=new v.EvaluationParameters(j),oe=0,me=B;oe<me.length;oe+=1)me[oe].recalculate(K,H)}function Hl(B,j){var H=v.getArrayBuffer(B.request,function(K,oe,me,ye){K?j(K):oe&&j(null,{vectorTile:new v.vectorTile.VectorTile(new v.pbf(oe)),rawData:oe,cacheControl:me,expires:ye})});return function(){H.cancel(),j()}}dl.prototype.parse=function(B,j,H,K,oe){var me=this;this.status="parsing",this.data=B,this.collisionBoxArray=new v.CollisionBoxArray;var ye=new v.DictionaryCoder(Object.keys(B.layers).sort()),ee=new v.FeatureIndex(this.tileID,this.promoteId);ee.bucketLayerIDs=[];var X,ae,qe,Je,Te={},Ge={featureIndex:ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:H},ht=j.familiesBySource[this.source];for(var pt in ht){var Et=B.layers[pt];if(Et){1===Et.version&&v.warnOnce('Vector tile source "'+this.source+'" layer "'+pt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Fe=ye.encode(pt),rt=[],je=0;je<Et.length;je++){var en=Et.feature(je),tn=ee.getId(en,pt);rt.push({feature:en,id:tn,index:je,sourceLayerIndex:Fe})}for(var ue=0,fr=ht[pt];ue<fr.length;ue+=1){var Ht=fr[ue],ln=Ht[0];ln.minzoom&&this.zoom<Math.floor(ln.minzoom)||ln.maxzoom&&this.zoom>=ln.maxzoom||"none"!==ln.visibility&&(bt(Ht,this.zoom,H),(Te[ln.id]=ln.createBucket({index:ee.bucketLayerIDs.length,layers:Ht,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source})).populate(rt,Ge,this.tileID.canonical),ee.bucketLayerIDs.push(Ht.map(function(En){return En.id})))}}}var Ir=v.mapObject(Ge.glyphDependencies,function(En){return Object.keys(En).map(Number)});Object.keys(Ir).length?K.send("getGlyphs",{uid:this.uid,stacks:Ir},function(En,mn){X||(X=En,ae=mn,Br.call(me))}):ae={};var Un=Object.keys(Ge.iconDependencies);Un.length?K.send("getImages",{icons:Un,source:this.source,tileID:this.tileID,type:"icons"},function(En,mn){X||(X=En,qe=mn,Br.call(me))}):qe={};var _t=Object.keys(Ge.patternDependencies);function Br(){if(X)return oe(X);if(ae&&qe&&Je){var En=new Wt(ae),mn=new v.ImageAtlas(qe,Je);for(var Hd in Te){var wn=Te[Hd];wn instanceof v.SymbolBucket?(bt(wn.layers,this.zoom,H),v.performSymbolLayout(wn,ae,En.positions,qe,mn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):wn.hasPattern&&(wn instanceof v.LineBucket||wn instanceof v.FillBucket||wn instanceof v.FillExtrusionBucket)&&(bt(wn.layers,this.zoom,H),wn.addFeatures(Ge,this.tileID.canonical,mn.patternPositions))}this.status="done",oe(null,{buckets:v.values(Te).filter(function(Jn){return!Jn.isEmpty()}),featureIndex:ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:En.image,imageAtlas:mn,glyphMap:this.returnDependencies?ae:null,iconMap:this.returnDependencies?qe:null,glyphPositions:this.returnDependencies?En.positions:null})}}_t.length?K.send("getImages",{icons:_t,source:this.source,tileID:this.tileID,type:"patterns"},function(En,mn){X||(X=En,Je=mn,Br.call(me))}):Je={},Br.call(this)};var Oo=function(B,j,H,K){this.actor=B,this.layerIndex=j,this.availableImages=H,this.loadVectorData=K||Hl,this.loading={},this.loaded={}};Oo.prototype.loadTile=function(B,j){var H=this,K=B.uid;this.loading||(this.loading={});var oe=!!(B&&B.request&&B.request.collectResourceTiming)&&new v.RequestPerformance(B.request),me=this.loading[K]=new dl(B);me.abort=this.loadVectorData(B,function(ye,ee){if(delete H.loading[K],ye||!ee)return me.status="done",H.loaded[K]=me,j(ye);var X=ee.rawData,ae={};ee.expires&&(ae.expires=ee.expires),ee.cacheControl&&(ae.cacheControl=ee.cacheControl);var qe={};if(oe){var Je=oe.finish();Je&&(qe.resourceTiming=JSON.parse(JSON.stringify(Je)))}me.vectorTile=ee.vectorTile,me.parse(ee.vectorTile,H.layerIndex,H.availableImages,H.actor,function(Te,Ge){if(Te||!Ge)return j(Te);j(null,v.extend({rawTileData:X.slice(0)},Ge,ae,qe))}),H.loaded=H.loaded||{},H.loaded[K]=me})},Oo.prototype.reloadTile=function(B,j){var H=this,K=this.loaded,oe=B.uid,me=this;if(K&&K[oe]){var ye=K[oe];ye.showCollisionBoxes=B.showCollisionBoxes;var ee=function(X,ae){var qe=ye.reloadCallback;qe&&(delete ye.reloadCallback,ye.parse(ye.vectorTile,me.layerIndex,H.availableImages,me.actor,qe)),j(X,ae)};"parsing"===ye.status?ye.reloadCallback=ee:"done"===ye.status&&(ye.vectorTile?ye.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ee):ee())}},Oo.prototype.abortTile=function(B,j){var H=this.loading,K=B.uid;H&&H[K]&&H[K].abort&&(H[K].abort(),delete H[K]),j()},Oo.prototype.removeTile=function(B,j){var H=this.loaded,K=B.uid;H&&H[K]&&delete H[K],j()};var Bc=v.window.ImageBitmap,io=function(){this.loaded={}};function Mu(B,j){if(0!==B.length){Ui(B[0],j);for(var H=1;H<B.length;H++)Ui(B[H],!j)}}function Ui(B,j){for(var H=0,K=0,oe=B.length,me=oe-1;K<oe;me=K++)H+=(B[K][0]-B[me][0])*(B[me][1]+B[K][1]);H>=0!=!!j&&B.reverse()}io.prototype.loadTile=function(B,j){var H=B.uid,K=B.encoding,oe=B.rawImageData,me=Bc&&oe instanceof Bc?this.getImageData(oe):oe,ye=new v.DEMData(H,me,K);this.loaded=this.loaded||{},this.loaded[H]=ye,j(null,ye)},io.prototype.getImageData=function(B){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(B.width,B.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=B.width,this.offscreenCanvas.height=B.height,this.offscreenCanvasContext.drawImage(B,0,0,B.width,B.height);var j=this.offscreenCanvasContext.getImageData(-1,-1,B.width+2,B.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:j.width,height:j.height},j.data)},io.prototype.removeTile=function(B){var j=this.loaded,H=B.uid;j&&j[H]&&delete j[H]};var cf=v.vectorTile.VectorTileFeature.prototype.toGeoJSON,hl=function(B){this._feature=B,this.extent=v.EXTENT,this.type=B.type,this.properties=B.tags,"id"in B&&!isNaN(B.id)&&(this.id=parseInt(B.id,10))};hl.prototype.loadGeometry=function(){if(1===this._feature.type){for(var B=[],j=0,H=this._feature.geometry;j<H.length;j+=1){var K=H[j];B.push([new v.Point$1(K[0],K[1])])}return B}for(var oe=[],me=0,ye=this._feature.geometry;me<ye.length;me+=1){for(var ee=[],X=0,ae=ye[me];X<ae.length;X+=1){var qe=ae[X];ee.push(new v.Point$1(qe[0],qe[1]))}oe.push(ee)}return oe},hl.prototype.toGeoJSON=function(B,j,H){return cf.call(this,B,j,H)};var ss=function(B){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=B.length,this._features=B};ss.prototype.feature=function(B){return new hl(this._features[B])};var Ru=v.vectorTile.VectorTileFeature,Ia=Vc;function Vc(B,j){this.options=j||{},this.features=B,this.length=B.length}function zi(B,j){this.id="number"==typeof B.id?B.id:void 0,this.type=B.type,this.rawGeometry=1===B.type?[B.geometry]:B.geometry,this.properties=B.tags,this.extent=j||4096}Vc.prototype.feature=function(B){return new zi(this.features[B],this.options.extent)},zi.prototype.loadGeometry=function(){var B=this.rawGeometry;this.geometry=[];for(var j=0;j<B.length;j++){for(var H=B[j],K=[],oe=0;oe<H.length;oe++)K.push(new v.Point$1(H[oe][0],H[oe][1]));this.geometry.push(K)}return this.geometry},zi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var B=this.geometry,j=1/0,H=-1/0,K=1/0,oe=-1/0,me=0;me<B.length;me++)for(var ye=B[me],ee=0;ee<ye.length;ee++){var X=ye[ee];j=Math.min(j,X.x),H=Math.max(H,X.x),K=Math.min(K,X.y),oe=Math.max(oe,X.y)}return[j,K,H,oe]},zi.prototype.toGeoJSON=Ru.prototype.toGeoJSON;var ks=$l,Gs=Ia;function $l(B){var j=new v.pbf;return function(H,K){for(var oe in H.layers)K.writeMessage(3,yr,H.layers[oe])}(B,j),j.finish()}function yr(B,j){var H;j.writeVarintField(15,B.version||1),j.writeStringField(1,B.name||""),j.writeVarintField(5,B.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<B.length;H++)K.feature=B.feature(H),j.writeMessage(2,Lo,K);var oe=K.keys;for(H=0;H<oe.length;H++)j.writeStringField(3,oe[H]);var me=K.values;for(H=0;H<me.length;H++)j.writeMessage(4,ka,me[H])}function Lo(B,j){var H=B.feature;void 0!==H.id&&j.writeVarintField(1,H.id),j.writeMessage(2,zp,B),j.writeVarintField(3,H.type),j.writeMessage(4,Pu,H)}function zp(B,j){var H=B.feature,K=B.keys,oe=B.values,me=B.keycache,ye=B.valuecache;for(var ee in H.properties){var X=me[ee];void 0===X&&(K.push(ee),me[ee]=X=K.length-1),j.writeVarint(X);var ae=H.properties[ee],qe=typeof ae;"string"!==qe&&"boolean"!==qe&&"number"!==qe&&(ae=JSON.stringify(ae));var Je=qe+":"+ae,Te=ye[Je];void 0===Te&&(oe.push(ae),ye[Je]=Te=oe.length-1),j.writeVarint(Te)}}function As(B,j){return(j<<3)+(7&B)}function ql(B){return B<<1^B>>31}function Pu(B,j){for(var H=B.loadGeometry(),K=B.type,oe=0,me=0,ye=H.length,ee=0;ee<ye;ee++){var X=H[ee],ae=1;1===K&&(ae=X.length),j.writeVarint(As(1,ae));for(var qe=3===K?X.length-1:X.length,Je=0;Je<qe;Je++){1===Je&&1!==K&&j.writeVarint(As(2,qe-1));var Te=X[Je].x-oe,Ge=X[Je].y-me;j.writeVarint(ql(Te)),j.writeVarint(ql(Ge)),oe+=Te,me+=Ge}3===K&&j.writeVarint(As(7,1))}}function ka(B,j){var H=typeof B;"string"===H?j.writeStringField(1,B):"boolean"===H?j.writeBooleanField(7,B):"number"===H&&(B%1!=0?j.writeDoubleField(3,B):B<0?j.writeSVarintField(6,B):j.writeVarintField(5,B))}function Ms(B,j,H,K){oo(B,H,K),oo(j,2*H,2*K),oo(j,2*H+1,2*K+1)}function oo(B,j,H){var K=B[j];B[j]=B[H],B[H]=K}function Aa(B,j,H,K){var oe=B-H,me=j-K;return oe*oe+me*me}ks.fromVectorTileJs=$l,ks.fromGeojsonVt=function(B,j){j=j||{};var H={};for(var K in B)H[K]=new Ia(B[K].features,j),H[K].name=K,H[K].version=j.version,H[K].extent=j.extent;return $l({layers:H})},ks.GeoJSONWrapper=Gs;var Uc=function(B){return B[0]},Gl=function(B){return B[1]},fl=function(B,j,H,K,oe){void 0===j&&(j=Uc),void 0===H&&(H=Gl),void 0===K&&(K=64),void 0===oe&&(oe=Float64Array),this.nodeSize=K,this.points=B;for(var me=B.length<65536?Uint16Array:Uint32Array,ye=this.ids=new me(B.length),ee=this.coords=new oe(2*B.length),X=0;X<B.length;X++)ye[X]=X,ee[2*X]=j(B[X]),ee[2*X+1]=H(B[X]);!function ae(qe,Je,Te,Ge,ht,pt){if(!(ht-Ge<=Te)){var Et=Ge+ht>>1;(function Fe(rt,je,en,tn,ue,fr){for(;ue>tn;){if(ue-tn>600){var Ht=ue-tn+1,ln=en-tn+1,Ir=Math.log(Ht),Un=.5*Math.exp(2*Ir/3),_t=.5*Math.sqrt(Ir*Un*(Ht-Un)/Ht)*(ln-Ht/2<0?-1:1);Fe(rt,je,en,Math.max(tn,Math.floor(en-ln*Un/Ht+_t)),Math.min(ue,Math.floor(en+(Ht-ln)*Un/Ht+_t)),fr)}var Br=je[2*en+fr],En=tn,mn=ue;for(Ms(rt,je,tn,en),je[2*ue+fr]>Br&&Ms(rt,je,tn,ue);En<mn;){for(Ms(rt,je,En,mn),En++,mn--;je[2*En+fr]<Br;)En++;for(;je[2*mn+fr]>Br;)mn--}je[2*tn+fr]===Br?Ms(rt,je,tn,mn):Ms(rt,je,++mn,ue),mn<=en&&(tn=mn+1),en<=mn&&(ue=mn-1)}})(qe,Je,Et,Ge,ht,pt%2),ae(qe,Je,Te,Ge,Et-1,pt+1),ae(qe,Je,Te,Et+1,ht,pt+1)}}(ye,ee,K,0,ye.length-1,0)};fl.prototype.range=function(B,j,H,K){return function(oe,me,ye,ee,X,ae,qe){for(var Je,Te,Ge=[0,oe.length-1,0],ht=[];Ge.length;){var pt=Ge.pop(),Et=Ge.pop(),Fe=Ge.pop();if(Et-Fe<=qe)for(var rt=Fe;rt<=Et;rt++)Te=me[2*rt+1],(Je=me[2*rt])>=ye&&Je<=X&&Te>=ee&&Te<=ae&&ht.push(oe[rt]);else{var je=Math.floor((Fe+Et)/2);Te=me[2*je+1],(Je=me[2*je])>=ye&&Je<=X&&Te>=ee&&Te<=ae&&ht.push(oe[je]);var en=(pt+1)%2;(0===pt?ye<=Je:ee<=Te)&&(Ge.push(Fe),Ge.push(je-1),Ge.push(en)),(0===pt?X>=Je:ae>=Te)&&(Ge.push(je+1),Ge.push(Et),Ge.push(en))}}return ht}(this.ids,this.coords,B,j,H,K,this.nodeSize)},fl.prototype.within=function(B,j,H){return function(K,oe,me,ye,ee,X){for(var ae=[0,K.length-1,0],qe=[],Je=ee*ee;ae.length;){var Te=ae.pop(),Ge=ae.pop(),ht=ae.pop();if(Ge-ht<=X)for(var pt=ht;pt<=Ge;pt++)Aa(oe[2*pt],oe[2*pt+1],me,ye)<=Je&&qe.push(K[pt]);else{var Et=Math.floor((ht+Ge)/2),Fe=oe[2*Et],rt=oe[2*Et+1];Aa(Fe,rt,me,ye)<=Je&&qe.push(K[Et]);var je=(Te+1)%2;(0===Te?me-ee<=Fe:ye-ee<=rt)&&(ae.push(ht),ae.push(Et-1),ae.push(je)),(0===Te?me+ee>=Fe:ye+ee>=rt)&&(ae.push(Et+1),ae.push(Ge),ae.push(je))}}return qe}(this.ids,this.coords,B,j,H,this.nodeSize)};var jp={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(B){return B}},ji=function(B){this.options=Ra(Object.create(jp),B),this.trees=new Array(this.options.maxZoom+1)};function pl(B,j,H,K,oe){return{x:B,y:j,zoom:1/0,id:H,parentId:-1,numPoints:K,properties:oe}}function or(B,j){var H=B.geometry.coordinates,K=H[1];return{x:Ws(H[0]),y:Sn(K),zoom:1/0,index:j,parentId:-1}}function Ma(B){return{type:"Feature",id:B.id,properties:ml(B),geometry:{type:"Point",coordinates:[(K=B.x,360*(K-.5)),(j=B.y,H=(180-360*j)*Math.PI/180,360*Math.atan(Math.exp(H))/Math.PI-90)]}};var j,H,K}function ml(B){var j=B.numPoints,H=j>=1e4?Math.round(j/1e3)+"k":j>=1e3?Math.round(j/100)/10+"k":j;return Ra(Ra({},B.properties),{cluster:!0,cluster_id:B.id,point_count:j,point_count_abbreviated:H})}function Ws(B){return B/360+.5}function Sn(B){var j=Math.sin(B*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function Ra(B,j){for(var H in j)B[H]=j[H];return B}function Fo(B){return B.x}function Zs(B){return B.y}function Hp(B,j,H,K,oe,me){var ye=oe-H,ee=me-K;if(0!==ye||0!==ee){var X=((B-H)*ye+(j-K)*ee)/(ye*ye+ee*ee);X>1?(H=oe,K=me):X>0&&(H+=ye*X,K+=ee*X)}return(ye=B-H)*ye+(ee=j-K)*ee}function aa(B,j,H,K){var oe={id:void 0===B?null:B,type:j,geometry:H,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(me){var ye=me.geometry,ee=me.type;if("Point"===ee||"MultiPoint"===ee||"LineString"===ee)vr(me,ye);else if("Polygon"===ee||"MultiLineString"===ee)for(var X=0;X<ye.length;X++)vr(me,ye[X]);else if("MultiPolygon"===ee)for(X=0;X<ye.length;X++)for(var ae=0;ae<ye[X].length;ae++)vr(me,ye[X][ae])}(oe),oe}function vr(B,j){for(var H=0;H<j.length;H+=3)B.minX=Math.min(B.minX,j[H]),B.minY=Math.min(B.minY,j[H+1]),B.maxX=Math.max(B.maxX,j[H]),B.maxY=Math.max(B.maxY,j[H+1])}function as(B,j,H,K){if(j.geometry){var oe=j.geometry.coordinates,me=j.geometry.type,ye=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),ee=[],X=j.id;if(H.promoteId?X=j.properties[H.promoteId]:H.generateId&&(X=K||0),"Point"===me)gl(oe,ee);else if("MultiPoint"===me)for(var ae=0;ae<oe.length;ae++)gl(oe[ae],ee);else if("LineString"===me)_l(oe,ee,ye,!1);else if("MultiLineString"===me){if(H.lineMetrics){for(ae=0;ae<oe.length;ae++)_l(oe[ae],ee=[],ye,!1),B.push(aa(X,"LineString",ee,j.properties));return}Qn(oe,ee,ye,!1)}else if("Polygon"===me)Qn(oe,ee,ye,!0);else{if("MultiPolygon"!==me){if("GeometryCollection"===me){for(ae=0;ae<j.geometry.geometries.length;ae++)as(B,{id:X,geometry:j.geometry.geometries[ae],properties:j.properties},H,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ae=0;ae<oe.length;ae++){var qe=[];Qn(oe[ae],qe,ye,!0),ee.push(qe)}}B.push(aa(X,me,ee,j.properties))}}function gl(B,j){j.push(Rs(B[0])),j.push(Wl(B[1])),j.push(0)}function _l(B,j,H,K){for(var oe,me,ye=0,ee=0;ee<B.length;ee++){var X=Rs(B[ee][0]),ae=Wl(B[ee][1]);j.push(X),j.push(ae),j.push(0),ee>0&&(ye+=K?(oe*ae-X*me)/2:Math.sqrt(Math.pow(X-oe,2)+Math.pow(ae-me,2))),oe=X,me=ae}var qe=j.length-3;j[2]=1,function Je(Te,Ge,ht,pt){for(var Et,Fe=pt,rt=ht-Ge>>1,je=ht-Ge,en=Te[Ge],tn=Te[Ge+1],ue=Te[ht],fr=Te[ht+1],Ht=Ge+3;Ht<ht;Ht+=3){var ln=Hp(Te[Ht],Te[Ht+1],en,tn,ue,fr);if(ln>Fe)Et=Ht,Fe=ln;else if(ln===Fe){var Ir=Math.abs(Ht-rt);Ir<je&&(Et=Ht,je=Ir)}}Fe>pt&&(Et-Ge>3&&Je(Te,Ge,Et,pt),Te[Et+2]=Fe,ht-Et>3&&Je(Te,Et,ht,pt))}(j,0,qe,H),j[qe+2]=1,j.size=Math.abs(ye),j.start=0,j.end=j.size}function Qn(B,j,H,K){for(var oe=0;oe<B.length;oe++){var me=[];_l(B[oe],me,H,K),j.push(me)}}function Rs(B){return B/360+.5}function Wl(B){var j=Math.sin(B*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function Ks(B,j,H,K,oe,me,ye,ee){if(K/=j,me>=(H/=j)&&ye<K)return B;if(ye<H||me>=K)return null;for(var X=[],ae=0;ae<B.length;ae++){var qe=B[ae],Je=qe.geometry,Te=qe.type,Ge=0===oe?qe.minX:qe.minY,ht=0===oe?qe.maxX:qe.maxY;if(Ge>=H&&ht<K)X.push(qe);else if(!(ht<H||Ge>=K)){var pt=[];if("Point"===Te||"MultiPoint"===Te)Pa(Je,pt,H,K,oe);else if("LineString"===Te)zc(Je,pt,H,K,oe,!1,ee.lineMetrics);else if("MultiLineString"===Te)Na(Je,pt,H,K,oe,!1);else if("Polygon"===Te)Na(Je,pt,H,K,oe,!0);else if("MultiPolygon"===Te)for(var Et=0;Et<Je.length;Et++){var Fe=[];Na(Je[Et],Fe,H,K,oe,!0),Fe.length&&pt.push(Fe)}if(pt.length){if(ee.lineMetrics&&"LineString"===Te){for(Et=0;Et<pt.length;Et++)X.push(aa(qe.id,Te,pt[Et],qe.tags));continue}"LineString"!==Te&&"MultiLineString"!==Te||(1===pt.length?(Te="LineString",pt=pt[0]):Te="MultiLineString"),"Point"!==Te&&"MultiPoint"!==Te||(Te=3===pt.length?"Point":"MultiPoint"),X.push(aa(qe.id,Te,pt,qe.tags))}}}return X.length?X:null}function Pa(B,j,H,K,oe){for(var me=0;me<B.length;me+=3){var ye=B[me+oe];ye>=H&&ye<=K&&(j.push(B[me]),j.push(B[me+1]),j.push(B[me+2]))}}function zc(B,j,H,K,oe,me,ye){for(var ee,X,ae=Nu(B),qe=0===oe?uf:Lu,Je=B.start,Te=0;Te<B.length-3;Te+=3){var Ge=B[Te],ht=B[Te+1],pt=B[Te+2],Et=B[Te+3],Fe=B[Te+4],rt=0===oe?Ge:ht,je=0===oe?Et:Fe,en=!1;ye&&(ee=Math.sqrt(Math.pow(Ge-Et,2)+Math.pow(ht-Fe,2))),rt<H?je>H&&(X=qe(ae,Ge,ht,Et,Fe,H),ye&&(ae.start=Je+ee*X)):rt>K?je<K&&(X=qe(ae,Ge,ht,Et,Fe,K),ye&&(ae.start=Je+ee*X)):Ou(ae,Ge,ht,pt),je<H&&rt>=H&&(X=qe(ae,Ge,ht,Et,Fe,H),en=!0),je>K&&rt<=K&&(X=qe(ae,Ge,ht,Et,Fe,K),en=!0),!me&&en&&(ye&&(ae.end=Je+ee*X),j.push(ae),ae=Nu(B)),ye&&(Je+=ee)}var tn=B.length-3;Ge=B[tn],ht=B[tn+1],pt=B[tn+2],(rt=0===oe?Ge:ht)>=H&&rt<=K&&Ou(ae,Ge,ht,pt),tn=ae.length-3,me&&tn>=3&&(ae[tn]!==ae[0]||ae[tn+1]!==ae[1])&&Ou(ae,ae[0],ae[1],ae[2]),ae.length&&j.push(ae)}function Nu(B){var j=[];return j.size=B.size,j.start=B.start,j.end=B.end,j}function Na(B,j,H,K,oe,me){for(var ye=0;ye<B.length;ye++)zc(B[ye],j,H,K,oe,me,!1)}function Ou(B,j,H,K){B.push(j),B.push(H),B.push(K)}function uf(B,j,H,K,oe,me){var ye=(me-j)/(K-j);return B.push(me),B.push(H+(oe-H)*ye),B.push(1),ye}function Lu(B,j,H,K,oe,me){var ye=(me-H)/(oe-H);return B.push(j+(K-j)*ye),B.push(me),B.push(1),ye}function jc(B,j){for(var H=[],K=0;K<B.length;K++){var oe,me=B[K],ye=me.type;if("Point"===ye||"MultiPoint"===ye||"LineString"===ye)oe=Ps(me.geometry,j);else if("MultiLineString"===ye||"Polygon"===ye){oe=[];for(var ee=0;ee<me.geometry.length;ee++)oe.push(Ps(me.geometry[ee],j))}else if("MultiPolygon"===ye)for(oe=[],ee=0;ee<me.geometry.length;ee++){for(var X=[],ae=0;ae<me.geometry[ee].length;ae++)X.push(Ps(me.geometry[ee][ae],j));oe.push(X)}H.push(aa(me.id,ye,oe,me.tags))}return H}function Ps(B,j){var H=[];H.size=B.size,void 0!==B.start&&(H.start=B.start,H.end=B.end);for(var K=0;K<B.length;K+=3)H.push(B[K]+j,B[K+1],B[K+2]);return H}function Zl(B,j){if(B.transformed)return B;var H,K,oe,me=1<<B.z,ye=B.x,ee=B.y;for(H=0;H<B.features.length;H++){var X=B.features[H],ae=X.geometry,qe=X.type;if(X.geometry=[],1===qe)for(K=0;K<ae.length;K+=2)X.geometry.push(zd(ae[K],ae[K+1],j,me,ye,ee));else for(K=0;K<ae.length;K++){var Je=[];for(oe=0;oe<ae[K].length;oe+=2)Je.push(zd(ae[K][oe],ae[K][oe+1],j,me,ye,ee));X.geometry.push(Je)}}return B.transformed=!0,B}function zd(B,j,H,K,oe,me){return[Math.round(H*(B*K-oe)),Math.round(H*(j*K-me))]}function Fu(B,j,H,K,oe){for(var me=j===oe.maxZoom?0:oe.tolerance/((1<<j)*oe.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:K,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ee=0;ee<B.length;ee++){ye.numFeatures++,jd(ye,B[ee],me,oe);var X=B[ee].minX,ae=B[ee].minY,qe=B[ee].maxX,Je=B[ee].maxY;X<ye.minX&&(ye.minX=X),ae<ye.minY&&(ye.minY=ae),qe>ye.maxX&&(ye.maxX=qe),Je>ye.maxY&&(ye.maxY=Je)}return ye}function jd(B,j,H,K){var oe=j.geometry,me=j.type,ye=[];if("Point"===me||"MultiPoint"===me)for(var ee=0;ee<oe.length;ee+=3)ye.push(oe[ee]),ye.push(oe[ee+1]),B.numPoints++,B.numSimplified++;else if("LineString"===me)yl(ye,oe,B,H,!1,!1);else if("MultiLineString"===me||"Polygon"===me)for(ee=0;ee<oe.length;ee++)yl(ye,oe[ee],B,H,"Polygon"===me,0===ee);else if("MultiPolygon"===me)for(var X=0;X<oe.length;X++){var ae=oe[X];for(ee=0;ee<ae.length;ee++)yl(ye,ae[ee],B,H,!0,0===ee)}if(ye.length){var qe=j.tags||null;if("LineString"===me&&K.lineMetrics){for(var Je in qe={},j.tags)qe[Je]=j.tags[Je];qe.mapbox_clip_start=oe.start/oe.size,qe.mapbox_clip_end=oe.end/oe.size}var Te={geometry:ye,type:"Polygon"===me||"MultiPolygon"===me?3:"LineString"===me||"MultiLineString"===me?2:1,tags:qe};null!==j.id&&(Te.id=j.id),B.features.push(Te)}}function yl(B,j,H,K,oe,me){var ye=K*K;if(K>0&&j.size<(oe?ye:K))H.numPoints+=j.length/3;else{for(var ee=[],X=0;X<j.length;X+=3)(0===K||j[X+2]>ye)&&(H.numSimplified++,ee.push(j[X]),ee.push(j[X+1])),H.numPoints++;oe&&function(ae,qe){for(var Je=0,Te=0,Ge=ae.length,ht=Ge-2;Te<Ge;ht=Te,Te+=2)Je+=(ae[Te]-ae[ht])*(ae[Te+1]+ae[ht+1]);if(Je>0===qe)for(Te=0,Ge=ae.length;Te<Ge/2;Te+=2){var pt=ae[Te],Et=ae[Te+1];ae[Te]=ae[Ge-2-Te],ae[Te+1]=ae[Ge-1-Te],ae[Ge-2-Te]=pt,ae[Ge-1-Te]=Et}}(ee,me),B.push(ee)}}function Kl(B,j){var H=(j=this.options=function(oe,me){for(var ye in me)oe[ye]=me[ye];return oe}(Object.create(this.options),j)).debug;if(H&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe,me,ye,ee,X,ae,K=function(oe,me){var ye=[];if("FeatureCollection"===oe.type)for(var ee=0;ee<oe.features.length;ee++)as(ye,oe.features[ee],me,ee);else as(ye,"Feature"===oe.type?oe:{geometry:oe},me);return ye}(B,j);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(oe=K,me=j,ye=me.buffer/me.extent,ee=oe,X=Ks(oe,1,-1-ye,ye,0,-1,2,me),ae=Ks(oe,1,1-ye,2+ye,0,-1,2,me),(X||ae)&&(ee=Ks(oe,1,-ye,1+ye,0,-1,2,me)||[],X&&(ee=jc(X,1).concat(ee)),ae&&(ee=ee.concat(jc(ae,-1)))),K=ee).length&&this.splitTile(K,0,0,0),H&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Oa(B,j,H){return 32*((1<<B)*H+j)+B}function Hc(B,j){var H=B.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);var K=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!K)return j(null,null);var oe=new ss(K.features),me=ks(oe);0===me.byteOffset&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),j(null,{vectorTile:oe,rawData:me.buffer})}ji.prototype.load=function(B){var j=this.options,H=j.log,K=j.minZoom,oe=j.maxZoom,me=j.nodeSize;H&&console.time("total time");var ye="prepare "+B.length+" points";H&&console.time(ye),this.points=B;for(var ee=[],X=0;X<B.length;X++)B[X].geometry&&ee.push(or(B[X],X));this.trees[oe+1]=new fl(ee,Fo,Zs,me,Float32Array),H&&console.timeEnd(ye);for(var ae=oe;ae>=K;ae--){var qe=+Date.now();ee=this._cluster(ee,ae),this.trees[ae]=new fl(ee,Fo,Zs,me,Float32Array),H&&console.log("z%d: %d clusters in %dms",ae,ee.length,+Date.now()-qe)}return H&&console.timeEnd("total time"),this},ji.prototype.getClusters=function(B,j){var H=((B[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,B[1])),oe=180===B[2]?180:((B[2]+180)%360+360)%360-180,me=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)H=-180,oe=180;else if(H>oe){var ye=this.getClusters([H,K,180,me],j),ee=this.getClusters([-180,K,oe,me],j);return ye.concat(ee)}for(var X=this.trees[this._limitZoom(j)],ae=[],qe=0,Je=X.range(Ws(H),Sn(me),Ws(oe),Sn(K));qe<Je.length;qe+=1){var Te=X.points[Je[qe]];ae.push(Te.numPoints?Ma(Te):this.points[Te.index])}return ae},ji.prototype.getChildren=function(B){var j=this._getOriginId(B),H=this._getOriginZoom(B),K="No cluster with the specified id.",oe=this.trees[H];if(!oe)throw new Error(K);var me=oe.points[j];if(!me)throw new Error(K);for(var ye=this.options.radius/(this.options.extent*Math.pow(2,H-1)),ee=[],X=0,ae=oe.within(me.x,me.y,ye);X<ae.length;X+=1){var qe=oe.points[ae[X]];qe.parentId===B&&ee.push(qe.numPoints?Ma(qe):this.points[qe.index])}if(0===ee.length)throw new Error(K);return ee},ji.prototype.getLeaves=function(B,j,H){var K=[];return this._appendLeaves(K,B,j=j||10,H=H||0,0),K},ji.prototype.getTile=function(B,j,H){var K=this.trees[this._limitZoom(B)],oe=Math.pow(2,B),me=this.options,ye=me.radius/me.extent,ee=(H-ye)/oe,X=(H+1+ye)/oe,ae={features:[]};return this._addTileFeatures(K.range((j-ye)/oe,ee,(j+1+ye)/oe,X),K.points,j,H,oe,ae),0===j&&this._addTileFeatures(K.range(1-ye/oe,ee,1,X),K.points,oe,H,oe,ae),j===oe-1&&this._addTileFeatures(K.range(0,ee,ye/oe,X),K.points,-1,H,oe,ae),ae.features.length?ae:null},ji.prototype.getClusterExpansionZoom=function(B){for(var j=this._getOriginZoom(B)-1;j<=this.options.maxZoom;){var H=this.getChildren(B);if(j++,1!==H.length)break;B=H[0].properties.cluster_id}return j},ji.prototype._appendLeaves=function(B,j,H,K,oe){for(var me=0,ye=this.getChildren(j);me<ye.length;me+=1){var ee=ye[me],X=ee.properties;if(X&&X.cluster?oe+X.point_count<=K?oe+=X.point_count:oe=this._appendLeaves(B,X.cluster_id,H,K,oe):oe<K?oe++:B.push(ee),B.length===H)break}return oe},ji.prototype._addTileFeatures=function(B,j,H,K,oe,me){for(var ye=0,ee=B;ye<ee.length;ye+=1){var X=j[ee[ye]],ae=X.numPoints,qe={type:1,geometry:[[Math.round(this.options.extent*(X.x*oe-H)),Math.round(this.options.extent*(X.y*oe-K))]],tags:ae?ml(X):this.points[X.index].properties},Je=void 0;ae?Je=X.id:this.options.generateId?Je=X.index:this.points[X.index].id&&(Je=this.points[X.index].id),void 0!==Je&&(qe.id=Je),me.features.push(qe)}},ji.prototype._limitZoom=function(B){return Math.max(this.options.minZoom,Math.min(+B,this.options.maxZoom+1))},ji.prototype._cluster=function(B,j){for(var H=[],K=this.options,oe=K.reduce,me=K.minPoints,ye=K.radius/(K.extent*Math.pow(2,j)),ee=0;ee<B.length;ee++){var X=B[ee];if(!(X.zoom<=j)){X.zoom=j;for(var ae=this.trees[j+1],qe=ae.within(X.x,X.y,ye),Je=X.numPoints||1,Te=Je,Ge=0,ht=qe;Ge<ht.length;Ge+=1){var pt=ae.points[ht[Ge]];pt.zoom>j&&(Te+=pt.numPoints||1)}if(Te>=me){for(var Et=X.x*Je,Fe=X.y*Je,rt=oe&&Je>1?this._map(X,!0):null,je=(ee<<5)+(j+1)+this.points.length,en=0,tn=qe;en<tn.length;en+=1){var ue=ae.points[tn[en]];if(!(ue.zoom<=j)){ue.zoom=j;var fr=ue.numPoints||1;Et+=ue.x*fr,Fe+=ue.y*fr,ue.parentId=je,oe&&(rt||(rt=this._map(X,!0)),oe(rt,this._map(ue)))}}X.parentId=je,H.push(pl(Et/Te,Fe/Te,je,Te,rt))}else if(H.push(X),Te>1)for(var Ht=0,ln=qe;Ht<ln.length;Ht+=1){var Ir=ae.points[ln[Ht]];Ir.zoom<=j||(Ir.zoom=j,H.push(Ir))}}}return H},ji.prototype._getOriginId=function(B){return B-this.points.length>>5},ji.prototype._getOriginZoom=function(B){return(B-this.points.length)%32},ji.prototype._map=function(B,j){if(B.numPoints)return j?Ra({},B.properties):B.properties;var H=this.points[B.index].properties,K=this.options.map(H);return j&&K===H?Ra({},K):K},Kl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Kl.prototype.splitTile=function(B,j,H,K,oe,me,ye){for(var ee=[B,j,H,K],X=this.options,ae=X.debug;ee.length;){K=ee.pop(),H=ee.pop(),j=ee.pop(),B=ee.pop();var qe=1<<j,Je=Oa(j,H,K),Te=this.tiles[Je];if(!Te&&(ae>1&&console.time("creation"),Te=this.tiles[Je]=Fu(B,j,H,K,X),this.tileCoords.push({z:j,x:H,y:K}),ae)){ae>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,H,K,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var Ge="z"+j;this.stats[Ge]=(this.stats[Ge]||0)+1,this.total++}if(Te.source=B,oe){if(j===X.maxZoom||j===oe)continue;var ht=1<<oe-j;if(H!==Math.floor(me/ht)||K!==Math.floor(ye/ht))continue}else if(j===X.indexMaxZoom||Te.numPoints<=X.indexMaxPoints)continue;if(Te.source=null,0!==B.length){ae>1&&console.time("clipping");var pt,Et,Fe,rt,je,en,tn=.5*X.buffer/X.extent,ue=.5-tn,fr=.5+tn,Ht=1+tn;pt=Et=Fe=rt=null,je=Ks(B,qe,H-tn,H+fr,0,Te.minX,Te.maxX,X),en=Ks(B,qe,H+ue,H+Ht,0,Te.minX,Te.maxX,X),B=null,je&&(pt=Ks(je,qe,K-tn,K+fr,1,Te.minY,Te.maxY,X),Et=Ks(je,qe,K+ue,K+Ht,1,Te.minY,Te.maxY,X),je=null),en&&(Fe=Ks(en,qe,K-tn,K+fr,1,Te.minY,Te.maxY,X),rt=Ks(en,qe,K+ue,K+Ht,1,Te.minY,Te.maxY,X),en=null),ae>1&&console.timeEnd("clipping"),ee.push(pt||[],j+1,2*H,2*K),ee.push(Et||[],j+1,2*H,2*K+1),ee.push(Fe||[],j+1,2*H+1,2*K),ee.push(rt||[],j+1,2*H+1,2*K+1)}}},Kl.prototype.getTile=function(B,j,H){var K=this.options,oe=K.extent,me=K.debug;if(B<0||B>24)return null;var ye=1<<B,ee=Oa(B,j=(j%ye+ye)%ye,H);if(this.tiles[ee])return Zl(this.tiles[ee],oe);me>1&&console.log("drilling down to z%d-%d-%d",B,j,H);for(var X,ae=B,qe=j,Je=H;!X&&ae>0;)ae--,qe=Math.floor(qe/2),Je=Math.floor(Je/2),X=this.tiles[Oa(ae,qe,Je)];return X&&X.source?(me>1&&console.log("found parent tile z%d-%d-%d",ae,qe,Je),me>1&&console.time("drilling down"),this.splitTile(X.source,ae,qe,Je,B,j,H),me>1&&console.timeEnd("drilling down"),this.tiles[ee]?Zl(this.tiles[ee],oe):null):null};var Yl=function(B){function j(H,K,oe,me){B.call(this,H,K,oe,Hc),me&&(this.loadGeoJSON=me)}return B&&(j.__proto__=B),(j.prototype=Object.create(B&&B.prototype)).constructor=j,j.prototype.loadData=function(H,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=H,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},j.prototype._loadData=function(){var H=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,oe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var me=!!(oe&&oe.request&&oe.request.collectResourceTiming)&&new v.RequestPerformance(oe.request);this.loadGeoJSON(oe,function(ye,ee){if(ye||!ee)return K(ye);if("object"!=typeof ee)return K(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."));!function Te(Ge,ht){var pt,Et=Ge&&Ge.type;if("FeatureCollection"===Et)for(pt=0;pt<Ge.features.length;pt++)Te(Ge.features[pt],ht);else if("GeometryCollection"===Et)for(pt=0;pt<Ge.geometries.length;pt++)Te(Ge.geometries[pt],ht);else if("Feature"===Et)Te(Ge.geometry,ht);else if("Polygon"===Et)Mu(Ge.coordinates,ht);else if("MultiPolygon"===Et)for(pt=0;pt<Ge.coordinates.length;pt++)Mu(Ge.coordinates[pt],ht);return Ge}(ee,!0);try{if(oe.filter){var X=v.createExpression(oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===X.result)throw new Error(X.value.map(function(Te){return Te.key+": "+Te.message}).join(", "));var ae=ee.features.filter(function(Te){return X.value.evaluate({zoom:0},Te)});ee={type:"FeatureCollection",features:ae}}H._geoJSONIndex=oe.cluster?new ji(function(Te){var Ge=Te.superclusterOptions,ht=Te.clusterProperties;if(!ht||!Ge)return Ge;for(var pt={},Et={},Fe={accumulated:null,zoom:0},rt={properties:null},je=Object.keys(ht),en=0,tn=je;en<tn.length;en+=1){var ue=tn[en],fr=ht[ue],Ht=fr[0],ln=v.createExpression(fr[1]),Ir=v.createExpression("string"==typeof Ht?[Ht,["accumulated"],["get",ue]]:Ht);pt[ue]=ln.value,Et[ue]=Ir.value}return Ge.map=function(Un){rt.properties=Un;for(var _t={},Br=0,En=je;Br<En.length;Br+=1){var mn=En[Br];_t[mn]=pt[mn].evaluate(Fe,rt)}return _t},Ge.reduce=function(Un,_t){rt.properties=_t;for(var Br=0,En=je;Br<En.length;Br+=1){var mn=En[Br];Fe.accumulated=Un[mn],Un[mn]=Et[mn].evaluate(Fe,rt)}},Ge}(oe)).load(ee.features):new Kl(Te=ee,oe.geojsonVtOptions)}catch(Te){return K(Te)}var Te;H.loaded={};var qe={};if(me){var Je=me.finish();Je&&(qe.resourceTiming={},qe.resourceTiming[oe.source]=JSON.parse(JSON.stringify(Je)))}K(null,qe)})}},j.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},j.prototype.reloadTile=function(H,K){var oe=this.loaded;return oe&&oe[H.uid]?B.prototype.reloadTile.call(this,H,K):this.loadTile(H,K)},j.prototype.loadGeoJSON=function(H,K){if(H.request)v.getJSON(H.request,K);else{if("string"!=typeof H.data)return K(new Error("Input data given to '"+H.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(H.data))}catch{return K(new Error("Input data given to '"+H.source+"' is not a valid GeoJSON object."))}}},j.prototype.removeSource=function(H,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},j.prototype.getClusterExpansionZoom=function(H,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(oe){K(oe)}},j.prototype.getClusterChildren=function(H,K){try{K(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(oe){K(oe)}},j.prototype.getClusterLeaves=function(H,K){try{K(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(oe){K(oe)}},j}(Oo),sr=function(B){var j=this;this.self=B,this.actor=new v.Actor(B,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Oo,geojson:Yl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(H,K){if(j.workerSourceTypes[H])throw new Error('Worker source with name "'+H+'" already registered.');j.workerSourceTypes[H]=K},this.self.registerRTLTextPlugin=function(H){if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=H.applyArabicShaping,v.plugin.processBidirectionalText=H.processBidirectionalText,v.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}};return sr.prototype.setReferrer=function(B,j){this.referrer=j},sr.prototype.setImages=function(B,j,H){for(var K in this.availableImages[B]=j,this.workerSources[B]){var oe=this.workerSources[B][K];for(var me in oe)oe[me].availableImages=j}H()},sr.prototype.setLayers=function(B,j,H){this.getLayerIndex(B).replace(j),H()},sr.prototype.updateLayers=function(B,j,H){this.getLayerIndex(B).update(j.layers,j.removedIds),H()},sr.prototype.loadTile=function(B,j,H){this.getWorkerSource(B,j.type,j.source).loadTile(j,H)},sr.prototype.loadDEMTile=function(B,j,H){this.getDEMWorkerSource(B,j.source).loadTile(j,H)},sr.prototype.reloadTile=function(B,j,H){this.getWorkerSource(B,j.type,j.source).reloadTile(j,H)},sr.prototype.abortTile=function(B,j,H){this.getWorkerSource(B,j.type,j.source).abortTile(j,H)},sr.prototype.removeTile=function(B,j,H){this.getWorkerSource(B,j.type,j.source).removeTile(j,H)},sr.prototype.removeDEMTile=function(B,j){this.getDEMWorkerSource(B,j.source).removeTile(j)},sr.prototype.removeSource=function(B,j,H){if(this.workerSources[B]&&this.workerSources[B][j.type]&&this.workerSources[B][j.type][j.source]){var K=this.workerSources[B][j.type][j.source];delete this.workerSources[B][j.type][j.source],void 0!==K.removeSource?K.removeSource(j,H):H()}},sr.prototype.loadWorkerSource=function(B,j,H){try{this.self.importScripts(j.url),H()}catch(K){H(K.toString())}},sr.prototype.syncRTLPluginState=function(B,j,H){try{v.plugin.setState(j);var K=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=K){this.self.importScripts(K);var oe=v.plugin.isParsed();H(oe?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),oe)}}catch(me){H(me.toString())}},sr.prototype.getAvailableImages=function(B){var j=this.availableImages[B];return j||(j=[]),j},sr.prototype.getLayerIndex=function(B){var j=this.layerIndexes[B];return j||(j=this.layerIndexes[B]=new St),j},sr.prototype.getWorkerSource=function(B,j,H){var K=this;return this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][j]||(this.workerSources[B][j]={}),this.workerSources[B][j][H]||(this.workerSources[B][j][H]=new this.workerSourceTypes[j]({send:function(oe,me,ye){K.actor.send(oe,me,ye,B)}},this.getLayerIndex(B),this.getAvailableImages(B))),this.workerSources[B][j][H]},sr.prototype.getDEMWorkerSource=function(B,j){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][j]||(this.demWorkerSources[B][j]=new io),this.demWorkerSources[B][j]},sr.prototype.enforceCacheSizeLimit=function(B,j){v.enforceCacheSizeLimit(j)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new sr(self)),sr}),Ud(0,function(v){var Qo=v.createCommonjsModule(function(d){function p(w){return!h(w)}function h(w){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,I,R=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(R);try{I=new Worker(F),T=!0}catch{T=!1}return I&&I.terminate(),URL.revokeObjectURL(F),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var I=T.getContext("2d");if(!I)return!1;var R=I.getImageData(0,0,1,1);return R&&R.width===T.width}()?(void 0===g[D=w&&w.failIfMajorPerformanceCaveat]&&(g[D]=function(T){var F,W,Z,I=(F=T,W=document.createElement("canvas"),(Z=Object.create(p.webGLContextAttributes)).failIfMajorPerformanceCaveat=F,W.probablySupportsContext?W.probablySupportsContext("webgl",Z)||W.probablySupportsContext("experimental-webgl",Z):W.supportsContext?W.supportsContext("webgl",Z)||W.supportsContext("experimental-webgl",Z):W.getContext("webgl",Z)||W.getContext("experimental-webgl",Z));if(!I)return!1;var R=I.createShader(I.VERTEX_SHADER);return!(!R||I.isContextLost())&&(I.shaderSource(R,"void main() {}"),I.compileShader(R),!0===I.getShaderParameter(R,I.COMPILE_STATUS))}(D)),g[D]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var D}d.exports?d.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=h);var g={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),He={create:function(d,p,h){var g=v.window.document.createElement(d);return void 0!==p&&(g.className=p),h&&h.appendChild(g),g},createNS:function(d,p){return v.window.document.createElementNS(d,p)}},St=v.window.document&&v.window.document.documentElement.style;function Wt(d){if(!St)return d[0];for(var p=0;p<d.length;p++)if(d[p]in St)return d[p];return d[0]}var dl,bt=Wt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);He.disableDrag=function(){St&&bt&&(dl=St[bt],St[bt]="none")},He.enableDrag=function(){St&&bt&&(St[bt]=dl)};var Hl=Wt(["transform","WebkitTransform"]);He.setTransform=function(d,p){d.style[Hl]=p};var Oo=!1;try{var Bc=Object.defineProperty({},"passive",{get:function(){Oo=!0}});v.window.addEventListener("test",Bc,Bc),v.window.removeEventListener("test",Bc,Bc)}catch{Oo=!1}He.addEventListener=function(d,p,h,g){void 0===g&&(g={}),d.addEventListener(p,h,"passive"in g&&Oo?g:g.capture)},He.removeEventListener=function(d,p,h,g){void 0===g&&(g={}),d.removeEventListener(p,h,"passive"in g&&Oo?g:g.capture)};var io=function(d){d.preventDefault(),d.stopPropagation(),v.window.removeEventListener("click",io,!0)};function Mu(d){var p=d.userImage;return!!(p&&p.render&&p.render())&&(d.data.replace(new Uint8Array(p.data.buffer)),!0)}He.suppressClick=function(){v.window.addEventListener("click",io,!0),v.window.setTimeout(function(){v.window.removeEventListener("click",io,!0)},0)},He.mousePos=function(d,p){var h=d.getBoundingClientRect();return new v.Point(p.clientX-h.left-d.clientLeft,p.clientY-h.top-d.clientTop)},He.touchPos=function(d,p){for(var h=d.getBoundingClientRect(),g=[],w=0;w<p.length;w++)g.push(new v.Point(p[w].clientX-h.left-d.clientLeft,p[w].clientY-h.top-d.clientTop));return g},He.mouseButton=function(d){return void 0!==v.window.InstallTrigger&&2===d.button&&d.ctrlKey&&v.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},He.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};var Ui=function(d){function p(){d.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var g=0,w=this.requestors;g<w.length;g+=1){var D=w[g];this._notify(D.ids,D.callback)}this.requestors=[]}},p.prototype.getImage=function(h){return this.images[h]},p.prototype.addImage=function(h,g){this._validate(h,g)&&(this.images[h]=g)},p.prototype._validate=function(h,g){var w=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),w=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),w=!1),this._validateContent(g.content,g)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),w=!1),w},p.prototype._validateStretch=function(h,g){if(!h)return!0;for(var w=0,D=0,T=h;D<T.length;D+=1){var I=T[D];if(I[0]<w||I[1]<I[0]||g<I[1])return!1;w=I[1]}return!0},p.prototype._validateContent=function(h,g){return!(h&&(4!==h.length||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},p.prototype.updateImage=function(h,g){g.version=this.images[h].version+1,this.images[h]=g,this.updatedImages[h]=!0},p.prototype.removeImage=function(h){var g=this.images[h];delete this.images[h],delete this.patterns[h],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(h,g){var w=!0;if(!this.isLoaded())for(var D=0,T=h;D<T.length;D+=1)this.images[T[D]]||(w=!1);this.isLoaded()||w?this._notify(h,g):this.requestors.push({ids:h,callback:g})},p.prototype._notify=function(h,g){for(var w={},D=0,T=h;D<T.length;D+=1){var I=T[D];this.images[I]||this.fire(new v.Event("styleimagemissing",{id:I}));var R=this.images[I];R?w[I]={data:R.data.clone(),pixelRatio:R.pixelRatio,sdf:R.sdf,version:R.version,stretchX:R.stretchX,stretchY:R.stretchY,content:R.content,hasRenderCallback:!(!R.userImage||!R.userImage.render)}:v.warnOnce('Image "'+I+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,w)},p.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},p.prototype.getPattern=function(h){var g=this.patterns[h],w=this.getImage(h);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{var D={w:w.data.width+2,h:w.data.height+2,x:0,y:0},T=new v.ImagePosition(D,w);this.patterns[h]={bin:D,position:T}}return this._updatePatternAtlas(),this.patterns[h].position},p.prototype.bind=function(h){var g=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.Texture(h,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var h=[];for(var g in this.patterns)h.push(this.patterns[g].bin);var w=v.potpack(h),D=w.w,T=w.h,I=this.atlasImage;for(var R in I.resize({width:D||1,height:T||1}),this.patterns){var F=this.patterns[R].bin,W=F.x+1,Z=F.y+1,$=this.images[R].data,se=$.width,re=$.height;v.RGBAImage.copy($,I,{x:0,y:0},{x:W,y:Z},{width:se,height:re}),v.RGBAImage.copy($,I,{x:0,y:re-1},{x:W,y:Z-1},{width:se,height:1}),v.RGBAImage.copy($,I,{x:0,y:0},{x:W,y:Z+re},{width:se,height:1}),v.RGBAImage.copy($,I,{x:se-1,y:0},{x:W-1,y:Z},{width:1,height:re}),v.RGBAImage.copy($,I,{x:0,y:0},{x:W+se,y:Z},{width:1,height:re})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(h){for(var g=0,w=h;g<w.length;g+=1){var D=w[g];if(!this.callbackDispatchedThisFrame[D]){this.callbackDispatchedThisFrame[D]=!0;var T=this.images[D];Mu(T)&&this.updateImage(D,T)}}},p}(v.Evented),cf=Ru,hl=Ru,ss=1e20;function Ru(d,p,h,g,w,D){this.fontSize=d||24,this.buffer=void 0===p?3:p,this.cutoff=g||.25,this.fontFamily=w||"sans-serif",this.fontWeight=D||"normal",this.radius=h||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Ia(d,p,h,g,w,D,T){for(var I=0;I<p;I++){for(var R=0;R<h;R++)g[R]=d[R*p+I];for(Vc(g,w,D,T,h),R=0;R<h;R++)d[R*p+I]=w[R]}for(R=0;R<h;R++){for(I=0;I<p;I++)g[I]=d[R*p+I];for(Vc(g,w,D,T,p),I=0;I<p;I++)d[R*p+I]=Math.sqrt(w[I])}}function Vc(d,p,h,g,w){h[0]=0,g[0]=-ss,g[1]=+ss;for(var D=1,T=0;D<w;D++){for(var I=(d[D]+D*D-(d[h[T]]+h[T]*h[T]))/(2*D-2*h[T]);I<=g[T];)T--,I=(d[D]+D*D-(d[h[T]]+h[T]*h[T]))/(2*D-2*h[T]);h[++T]=D,g[T]=I,g[T+1]=+ss}for(D=0,T=0;D<w;D++){for(;g[T+1]<D;)T++;p[D]=(D-h[T])*(D-h[T])+d[h[T]]}}Ru.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var w=p.data[4*g+3]/255;this.gridOuter[g]=1===w?0:0===w?ss:Math.pow(Math.max(0,.5-w),2),this.gridInner[g]=1===w?ss:0===w?0:Math.pow(Math.max(0,w-.5),2)}for(Ia(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Ia(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)h[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return h},cf.default=hl;var zi=function(d,p){this.requestManager=d,this.localIdeographFontFamily=p,this.entries={}};zi.prototype.setURL=function(d){this.url=d},zi.prototype.getGlyphs=function(d,p){var h=this,g=[];for(var w in d)for(var D=0,T=d[w];D<T.length;D+=1)g.push({stack:w,id:T[D]});v.asyncAll(g,function(I,R){var F=I.stack,W=I.id,Z=h.entries[F];Z||(Z=h.entries[F]={glyphs:{},requests:{},ranges:{}});var $=Z.glyphs[W];if(void 0===$){if($=h._tinySDF(Z,F,W))return Z.glyphs[W]=$,void R(null,{stack:F,id:W,glyph:$});var se=Math.floor(W/256);if(256*se>65535)R(new Error("glyphs > 65535 not supported"));else if(Z.ranges[se])R(null,{stack:F,id:W,glyph:$});else{var re=Z.requests[se];re||(re=Z.requests[se]=[],zi.loadGlyphRange(F,se,h.url,h.requestManager,function(de,ie){if(ie){for(var le in ie)h._doesCharSupportLocalGlyph(+le)||(Z.glyphs[+le]=ie[+le]);Z.ranges[se]=!0}for(var _e=0,we=re;_e<we.length;_e+=1)(0,we[_e])(de,ie);delete Z.requests[se]})),re.push(function(de,ie){de?R(de):ie&&R(null,{stack:F,id:W,glyph:ie[W]||null})})}}else R(null,{stack:F,id:W,glyph:$})},function(I,R){if(I)p(I);else if(R){for(var F={},W=0,Z=R;W<Z.length;W+=1){var $=Z[W],se=$.stack,re=$.id,de=$.glyph;(F[se]||(F[se]={}))[re]=de&&{id:de.id,bitmap:de.bitmap.clone(),metrics:de.metrics}}p(null,F)}})},zi.prototype._doesCharSupportLocalGlyph=function(d){return!!this.localIdeographFontFamily&&(v.isChar["CJK Unified Ideographs"](d)||v.isChar["Hangul Syllables"](d)||v.isChar.Hiragana(d)||v.isChar.Katakana(d))},zi.prototype._tinySDF=function(d,p,h){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(h)){var w=d.tinySDF;if(!w){var D="400";/bold/i.test(p)?D="900":/medium/i.test(p)?D="500":/light/i.test(p)&&(D="200"),w=d.tinySDF=new zi.TinySDF(24,3,8,.25,g,D)}return{id:h,bitmap:new v.AlphaImage({width:30,height:30},w.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},zi.loadGlyphRange=function(d,p,h,g,w){var D=256*p,T=D+255,I=g.transformRequest(g.normalizeGlyphsURL(h).replace("{fontstack}",d).replace("{range}",D+"-"+T),v.ResourceType.Glyphs);v.getArrayBuffer(I,function(R,F){if(R)w(R);else if(F){for(var W={},Z=0,$=v.parseGlyphPBF(F);Z<$.length;Z+=1){var se=$[Z];W[se.id]=se}w(null,W)}})},zi.TinySDF=cf;var ks=function(){this.specification=v.styleSpec.light.position};ks.prototype.possiblyEvaluate=function(d,p){return v.sphericalToCartesian(d.expression.evaluate(p))},ks.prototype.interpolate=function(d,p,h){return{x:v.number(d.x,p.x,h),y:v.number(d.y,p.y,h),z:v.number(d.z,p.z,h)}};var Gs=new v.Properties({anchor:new v.DataConstantProperty(v.styleSpec.light.anchor),position:new ks,color:new v.DataConstantProperty(v.styleSpec.light.color),intensity:new v.DataConstantProperty(v.styleSpec.light.intensity)}),$l=function(d){function p(h){d.call(this),this._transitionable=new v.Transitionable(Gs),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(h,g){if(void 0===g&&(g={}),!this._validate(v.validateLight,h,g))for(var w in h){var D=h[w];v.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),D):this._transitionable.setValue(w,D)}},p.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},p.prototype._validate=function(h,g,w){return(!w||!1!==w.validate)&&v.emitValidationErrors(this,h.call(v.validateStyle,v.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:v.styleSpec})))},p}(v.Evented),yr=function(d,p){this.width=d,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};yr.prototype.getDash=function(d,p){var h=d.join(",")+String(p);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(d,p)),this.dashEntry[h]},yr.prototype.getDashRanges=function(d,p,h){var g=[],w=d.length%2==1?-d[d.length-1]*h:0,D=d[0]*h,T=!0;g.push({left:w,right:D,isDash:T,zeroLength:0===d[0]});for(var I=d[0],R=1;R<d.length;R++){var F=d[R];g.push({left:w=I*h,right:D=(I+=F)*h,isDash:T=!T,zeroLength:0===F})}return g},yr.prototype.addRoundDash=function(d,p,h){for(var g=p/2,w=-h;w<=h;w++)for(var D=this.width*(this.nextRow+h+w),T=0,I=d[T],R=0;R<this.width;R++){R/I.right>1&&(I=d[++T]);var F=Math.abs(R-I.left),W=Math.abs(R-I.right),Z=Math.min(F,W),$=void 0,se=w/h*(g+1);if(I.isDash){var re=g-Math.abs(se);$=Math.sqrt(Z*Z+re*re)}else $=g-Math.sqrt(Z*Z+se*se);this.data[D+R]=Math.max(0,Math.min(255,$+128))}},yr.prototype.addRegularDash=function(d){for(var p=d.length-1;p>=0;--p){var h=d[p],g=d[p+1];h.zeroLength?d.splice(p,1):g&&g.isDash===h.isDash&&(g.left=h.left,d.splice(p,1))}var w=d[0],D=d[d.length-1];w.isDash===D.isDash&&(w.left=D.left-this.width,D.right=w.right+this.width);for(var T=this.width*this.nextRow,I=0,R=d[I],F=0;F<this.width;F++){F/R.right>1&&(R=d[++I]);var W=Math.abs(F-R.left),Z=Math.abs(F-R.right),$=Math.min(W,Z);this.data[T+F]=Math.max(0,Math.min(255,(R.isDash?$:-$)+128))}},yr.prototype.addDash=function(d,p){var h=p?7:0,g=2*h+1;if(this.nextRow+g>this.height)return v.warnOnce("LineAtlas out of space"),null;for(var w=0,D=0;D<d.length;D++)w+=d[D];if(0!==w){var T=this.width/w,I=this.getDashRanges(d,this.width,T);p?this.addRoundDash(I,T,h):this.addRegularDash(I)}var R={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:w};return this.nextRow+=g,this.dirty=!0,R},yr.prototype.bind=function(d){var p=d.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var Lo=function d(p,h){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=v.uniqueId();for(var g=this.workerPool.acquire(this.id),w=0;w<g.length;w++){var D=new d.Actor(g[w],h,this.id);D.name="Worker "+w,this.actors.push(D)}};function zp(d,p,h){var g=function(w,D){if(w)return h(w);if(D){var T=v.pick(v.extend(D,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(T.vectorLayers=D.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(I){return I.id})),T.tiles=p.canonicalizeTileset(T,d.url),h(null,T)}};return d.url?v.getJSON(p.transformRequest(p.normalizeSourceURL(d.url),v.ResourceType.Source),g):v.browser.frame(function(){return g(null,d)})}Lo.prototype.broadcast=function(d,p,h){v.asyncAll(this.actors,function(g,w){g.send(d,p,w)},h=h||function(){})},Lo.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Lo.prototype.remove=function(){this.actors.forEach(function(d){d.remove()}),this.actors=[],this.workerPool.release(this.id)},Lo.Actor=v.Actor;var As=function(d,p,h){this.bounds=v.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=p||0,this.maxzoom=h||24};As.prototype.validateBounds=function(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]},As.prototype.contains=function(d){var p=Math.pow(2,d.z),h=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*p),g=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*p),w=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*p),D=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*p);return d.x>=h&&d.x<w&&d.y>=g&&d.y<D};var ql=function(d){function p(h,g,w,D){if(d.call(this),this.id=h,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(g,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(D)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zp(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new As(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles,h.map._requestManager._customAccessToken),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(h){var g=this;return this.setSourceProperty(function(){g._options.tiles=h}),this},p.prototype.setUrl=function(h){var g=this;return this.setSourceProperty(function(){g.url=h,g._options.url=h}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),D={request:this.map._requestManager.transformRequest(w,v.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(I,R){return delete h.request,h.aborted?g(null):I&&404!==I.status?g(I):(R&&R.resourceTiming&&(h.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&h.setExpiryData(R),h.loadVectorData(R,this.map.painter),v.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}D.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state?"loading"===h.state?h.reloadCallback=g:h.request=h.actor.send("reloadTile",D,T.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",D,T.bind(this)))},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Pu=function(d){function p(h,g,w,D){d.call(this),this.id=h,this.dispatcher=w,this.setEventedParent(D),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},g),v.extend(this,v.pick(g,["url","scheme","tileSize"]))}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zp(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new As(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.loadTile=function(h,g){var w=this,D=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=v.getImage(this.map._requestManager.transformRequest(D,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){w.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var R=w.map.painter.context,F=R.gl;h.texture=w.map.painter.getTileTexture(I.width),h.texture?h.texture.update(I,{useMipmap:!0}):(h.texture=new v.Texture(R,I,F.RGBA,{useMipmap:!0}),h.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),R.extTextureFilterAnisotropic&&F.texParameterf(F.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax)),h.state="loaded",v.cacheEntryPossiblyAdded(w.dispatcher),g(null)}})},p.prototype.abortTile=function(h,g){h.request&&(h.request.cancel(),delete h.request),g()},p.prototype.unloadTile=function(h,g){h.texture&&this.map.painter.saveTileTexture(h.texture),g()},p.prototype.hasTransition=function(){return!1},p}(v.Evented),ka=function(d){function p(h,g,w,D){d.call(this,h,g,w,D),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function D(T,I){T&&(h.state="errored",g(T)),I&&(h.dem=I,h.needsHillshadePrepare=!0,h.state="loaded",g(null))}h.request=v.getImage(this.map._requestManager.transformRequest(w,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){this.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var R=v.window.ImageBitmap&&I instanceof v.window.ImageBitmap&&v.offscreenCanvasSupported()?I:v.browser.getImageData(I,1),F={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:R,encoding:this.encoding};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",F,D.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},p.prototype._getNeighboringTiles=function(h){var g=h.canonical,w=Math.pow(2,g.z),D=(g.x-1+w)%w,T=0===g.x?h.wrap-1:h.wrap,I=(g.x+1+w)%w,R=g.x+1===w?h.wrap+1:h.wrap,F={};return F[new v.OverscaledTileID(h.overscaledZ,T,g.z,D,g.y).key]={backfilled:!1},F[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y).key]={backfilled:!1},g.y>0&&(F[new v.OverscaledTileID(h.overscaledZ,T,g.z,D,g.y-1).key]={backfilled:!1},F[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},F[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y-1).key]={backfilled:!1}),g.y+1<w&&(F[new v.OverscaledTileID(h.overscaledZ,T,g.z,D,g.y+1).key]={backfilled:!1},F[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},F[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y+1).key]={backfilled:!1}),F},p.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},p}(Pu),Ms=function(d){function p(h,g,w,D){d.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=w.getActor(),this.setEventedParent(D),this._data=g.data,this._options=v.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var T=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(void 0!==g.buffer?g.buffer:128)*T,tolerance:(void 0!==g.tolerance?g.tolerance:.375)*T,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:void 0!==g.clusterMaxZoom?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:v.EXTENT,radius:(g.clusterRadius||50)*T,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)h.fire(new v.ErrorEvent(g));else{var w={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(w.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new v.Event("data",w))}})},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setData=function(h){var g=this;return this._data=h,this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(w){if(w)g.fire(new v.ErrorEvent(w));else{var D={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(D.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new v.Event("data",D))}}),this},p.prototype.getClusterExpansionZoom=function(h,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},g),this},p.prototype.getClusterChildren=function(h,g){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},g),this},p.prototype.getClusterLeaves=function(h,g,w,D){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:g,offset:w},D),this},p.prototype._updateWorkerData=function(h){var g=this;this._loaded=!1;var w=v.extend({},this.workerOptions),D=this._data;"string"==typeof D?(w.request=this.map._requestManager.transformRequest(v.browser.resolveURL(D),v.ResourceType.Source),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(D),this.actor.send(this.type+".loadData",w,function(T,I){g._removed||I&&I.abandoned||(g._loaded=!0,I&&I.resourceTiming&&I.resourceTiming[g.id]&&(g._resourceTiming=I.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:w.source},null),h(T))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(h,g){var w=this,D=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(D,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,I){return delete h.request,h.unloadVectorData(),h.aborted?g(null):T?g(T):(h.loadVectorData(I,w.map.painter,"reloadTile"===D),g(null))})},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},p.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return v.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(v.Evented),oo=v.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Aa=function(d){function p(h,g,w,D){d.call(this),this.id=h,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(D),this.options=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(h,g){var w=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,v.getImage(this.map._requestManager.transformRequest(this.url,v.ResourceType.Image),function(D,T){w._loaded=!0,D?w.fire(new v.ErrorEvent(D)):T&&(w.image=T,h&&(w.coordinates=h),g&&g(),w._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(h){var g=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){g.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setCoordinates=function(h){var g=this;this.coordinates=h;var w=h.map(v.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var I=1/0,R=1/0,F=-1/0,W=-1/0,Z=0,$=T;Z<$.length;Z+=1){var se=$[Z];I=Math.min(I,se.x),R=Math.min(R,se.y),F=Math.max(F,se.x),W=Math.max(W,se.y)}var re=Math.max(F-I,W-R),de=Math.max(0,Math.floor(-Math.log(re)/Math.LN2)),ie=Math.pow(2,de);return new v.CanonicalTileID(de,Math.floor((I+F)/2*ie),Math.floor((R+W)/2*ie))}(w),this.minzoom=this.maxzoom=this.tileID.z;var D=w.map(function(T){return g.tileID.getTilePoint(T)._round()});return this._boundsArray=new v.StructArrayLayout4i8,this._boundsArray.emplaceBack(D[0].x,D[0].y,0,0),this._boundsArray.emplaceBack(D[1].x,D[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(D[3].x,D[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(D[2].x,D[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v.Texture(h,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[w];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture)}}},p.prototype.loadTile=function(h,g){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},g(null)):(h.state="errored",g(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Uc=function(d){function p(h,g,w,D){d.call(this,h,g,w,D),this.roundZoom=!0,this.type="video",this.options=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1;var g=this.options;this.urls=[];for(var w=0,D=g.urls;w<D.length;w+=1)this.urls.push(this.map._requestManager.transformRequest(D[w],v.ResourceType.Source).url);v.getVideo(this.urls,function(T,I){h._loaded=!0,T?h.fire(new v.ErrorEvent(T)):I&&(h.video=I,h.video.loop=!0,h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(h){if(this.video){var g=this.video.seekable;h<g.start(0)||h>g.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=h}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new v.Texture(h,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[w];"loaded"!==D.state&&(D.state="loaded",D.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(Aa),Gl=function(d){function p(h,g,w,D){d.call(this,h,g,w,D),g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(I){return"number"!=typeof I})})||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "coordinates"'))),g.animate&&"boolean"!=typeof g.animate&&this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),g.canvas?"string"==typeof g.canvas||g.canvas instanceof v.window.HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=g,this.animate=void 0===g.animate||g.animate}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof v.window.HTMLCanvasElement?this.options.canvas:v.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,w=g.gl;for(var D in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.Texture(g,this.canvas,w.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[D];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var h=0,g=[this.canvas.width,this.canvas.height];h<g.length;h+=1){var w=g[h];if(isNaN(w)||w<=0)return!0}return!1},p}(Aa),fl={vector:ql,raster:Pu,"raster-dem":ka,geojson:Ms,video:Uc,image:Aa,canvas:Gl};function jp(d,p){var h=v.identity([]);return v.translate(h,h,[1,1,0]),v.scale(h,h,[.5*d.width,.5*d.height,1]),v.multiply(h,h,d.calculatePosMatrix(p.toUnwrapped()))}function ji(d,p,h,g,w,D){var T=function(de,ie,le){if(de)for(var _e=0,we=de;_e<we.length;_e+=1){var Ae=ie[we[_e]];if(Ae&&Ae.source===le&&"fill-extrusion"===Ae.type)return!0}else for(var De in ie){var Re=ie[De];if(Re.source===le&&"fill-extrusion"===Re.type)return!0}return!1}(w&&w.layers,p,d.id),I=D.maxPitchScaleFactor(),R=d.tilesIn(g,I,T);R.sort(pl);for(var F=[],W=0,Z=R;W<Z.length;W+=1){var $=Z[W];F.push({wrappedTileID:$.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(p,h,d._state,$.queryGeometry,$.cameraQueryGeometry,$.scale,w,D,I,jp(d.transform,$.tileID))})}var se=function(de){for(var ie={},le={},_e=0,we=de;_e<we.length;_e+=1){var Ae=we[_e],De=Ae.queryResults,Re=Ae.wrappedTileID,Ve=le[Re]=le[Re]||{};for(var Qe in De)for(var We=De[Qe],ct=Ve[Qe]=Ve[Qe]||{},Ct=ie[Qe]=ie[Qe]||[],kt=0,It=We;kt<It.length;kt+=1){var gn=It[kt];ct[gn.featureIndex]||(ct[gn.featureIndex]=!0,Ct.push(gn))}}return ie}(F);for(var re in se)se[re].forEach(function(de){var ie=de.feature,le=d.getFeatureState(ie.layer["source-layer"],ie.id);ie.source=ie.layer.source,ie.layer["source-layer"]&&(ie.sourceLayer=ie.layer["source-layer"]),ie.state=le});return se}function pl(d,p){var h=d.tileID,g=p.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}var or=function(d,p){this.max=d,this.onRemove=p,this.reset()};or.prototype.reset=function(){for(var d in this.data)for(var p=0,h=this.data[d];p<h.length;p+=1){var g=h[p];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},or.prototype.add=function(d,p,h){var g=this,w=d.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);var D={value:p,timeout:void 0};if(void 0!==h&&(D.timeout=setTimeout(function(){g.remove(d,D)},h)),this.data[w].push(D),this.order.push(w),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},or.prototype.has=function(d){return d.wrapped().key in this.data},or.prototype.getAndRemove=function(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null},or.prototype._getAndRemoveByKey=function(d){var p=this.data[d].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[d].length&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),p.value},or.prototype.getByKey=function(d){var p=this.data[d];return p?p[0].value:null},or.prototype.get=function(d){return this.has(d)?this.data[d.wrapped().key][0].value:null},or.prototype.remove=function(d,p){if(!this.has(d))return this;var h=d.wrapped().key,g=void 0===p?0:this.data[h].indexOf(p),w=this.data[h][g];return this.data[h].splice(g,1),w.timeout&&clearTimeout(w.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(w.value),this.order.splice(this.order.indexOf(h),1),this},or.prototype.setMaxSize=function(d){for(this.max=d;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},or.prototype.filter=function(d){var p=[];for(var h in this.data)for(var g=0,w=this.data[h];g<w.length;g+=1){var D=w[g];d(D.value)||p.push(D)}for(var T=0,I=p;T<I.length;T+=1){var R=I[T];this.remove(R.value.tileID,R)}};var Ma=function(d,p,h){this.context=d;var g=d.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Ma.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ma.prototype.updateData=function(d){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)},Ma.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ml={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ws=function(d,p,h,g){this.length=p.length,this.attributes=h,this.itemSize=p.bytesPerElement,this.dynamicDraw=g,this.context=d;var w=d.gl;this.buffer=w.createBuffer(),d.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Ws.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ws.prototype.updateData=function(d){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,d.arrayBuffer)},Ws.prototype.enableAttributes=function(d,p){for(var h=0;h<this.attributes.length;h++){var g=p.attributes[this.attributes[h].name];void 0!==g&&d.enableVertexAttribArray(g)}},Ws.prototype.setVertexAttribPointers=function(d,p,h){for(var g=0;g<this.attributes.length;g++){var w=this.attributes[g],D=p.attributes[w.name];void 0!==D&&d.vertexAttribPointer(D,w.components,d[ml[w.type]],!1,this.itemSize,w.offset+this.itemSize*(h||0))}},Ws.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Sn=function(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Sn.prototype.get=function(){return this.current},Sn.prototype.set=function(d){},Sn.prototype.getDefault=function(){return this.default},Sn.prototype.setDefault=function(){this.set(this.default)};var Ra=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(Sn),Fo=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},p}(Sn),Zs=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},p}(Sn),Hp=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(Sn),aa=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},p}(Sn),vr=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},p}(Sn),as=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(h){var g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},p}(Sn),gl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},p}(Sn),_l=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}},p}(Sn),Qn=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},p}(Sn),Rs=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}},p}(Sn),Wl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},p}(Sn),Ks=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}},p}(Sn),Pa=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},p}(Sn),zc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(Sn),Nu=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},p}(Sn),Na=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}},p}(Sn),Ou=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},p}(Sn),uf=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},p}(Sn),Lu=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},p}(Sn),jc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},p}(Sn),Ps=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(Sn),Zl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},p}(Sn),zd=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(Sn),Fu=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}},p}(Sn),jd=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},p}(Sn),yl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},p}(Sn),Kl=function(d){function p(h){d.call(this,h),this.vao=h.extVertexArrayObject}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},p}(Sn),Oa=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},p}(Sn),Hc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},p}(Sn),Yl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},p}(Sn),sr=function(d){function p(h,g){d.call(this,h),this.context=h,this.parent=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(Sn),B=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},p}(sr),j=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(sr),H=function(d,p,h,g){this.context=d,this.width=p,this.height=h;var w=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new B(d,w),g&&(this.depthAttachment=new j(d,w))};H.prototype.destroy=function(){var d=this.context.gl,p=this.colorAttachment.get();if(p&&d.deleteTexture(p),this.depthAttachment){var h=this.depthAttachment.get();h&&d.deleteRenderbuffer(h)}d.deleteFramebuffer(this.framebuffer)};var K=function(d,p,h){this.func=d,this.mask=p,this.range=h};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var oe=function(d,p,h,g,w,D){this.test=d,this.ref=p,this.mask=h,this.fail=g,this.depthFail=w,this.pass=D};oe.disabled=new oe({func:519,mask:0},0,0,7680,7680,7680);var me=function(d,p,h){this.blendFunction=d,this.blendColor=p,this.mask=h};me.disabled=new me(me.Replace=[1,0],v.Color.transparent,[!1,!1,!1,!1]),me.unblended=new me(me.Replace,v.Color.transparent,[!0,!0,!0,!0]),me.alphaBlended=new me([1,771],v.Color.transparent,[!0,!0,!0,!0]);var ye=function(d,p,h){this.enable=d,this.mode=p,this.frontFace=h};ye.disabled=new ye(!1,1029,2305),ye.backCCW=new ye(!0,1029,2305);var ee=function(d){this.gl=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ra(this),this.clearDepth=new Fo(this),this.clearStencil=new Zs(this),this.colorMask=new Hp(this),this.depthMask=new aa(this),this.stencilMask=new vr(this),this.stencilFunc=new as(this),this.stencilOp=new gl(this),this.stencilTest=new _l(this),this.depthRange=new Qn(this),this.depthTest=new Rs(this),this.depthFunc=new Wl(this),this.blend=new Ks(this),this.blendFunc=new Pa(this),this.blendColor=new zc(this),this.blendEquation=new Nu(this),this.cullFace=new Na(this),this.cullFaceSide=new Ou(this),this.frontFace=new uf(this),this.program=new Lu(this),this.activeTexture=new jc(this),this.viewport=new Ps(this),this.bindFramebuffer=new Zl(this),this.bindRenderbuffer=new zd(this),this.bindTexture=new Fu(this),this.bindVertexBuffer=new jd(this),this.bindElementBuffer=new yl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Kl(this),this.pixelStoreUnpack=new Oa(this),this.pixelStoreUnpackPremultiplyAlpha=new Hc(this),this.pixelStoreUnpackFlipY=new Yl(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=d.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(d.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)};ee.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ee.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ee.prototype.createIndexBuffer=function(d,p){return new Ma(this,d,p)},ee.prototype.createVertexBuffer=function(d,p,h){return new Ws(this,d,p,h)},ee.prototype.createRenderbuffer=function(d,p,h){var g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,d,p,h),this.bindRenderbuffer.set(null),w},ee.prototype.createFramebuffer=function(d,p,h){return new H(this,d,p,h)},ee.prototype.clear=function(d){var p=d.color,h=d.depth,g=this.gl,w=0;p&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g.clear(w)},ee.prototype.setCullFace=function(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))},ee.prototype.setDepthMode=function(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)},ee.prototype.setStencilMode=function(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)},ee.prototype.setColorMode=function(d){v.deepEqual(d.blendFunction,me.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)},ee.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var X=function(d){function p(h,g,w){var D=this;d.call(this),this.id=h,this.dispatcher=w,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(D._sourceLoaded=!0),D._sourceLoaded&&!D._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(D.reload(),D.transform&&D.update(D.transform))}),this.on("error",function(){D._sourceErrored=!0}),this._source=function(T,I,R,F){var W=new fl[I.type](T,I,R,F);if(W.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+W.id);return v.bindAll(["load","abort","unload","serialize","prepare"],W),W}(h,g,w,this),this._tiles={},this._cache=new or(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new v.SourceFeatureState}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},p.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var g=this._tiles[h];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(h,g){return this._source.loadTile(h,g)},p.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},p.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(h){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var w=this._tiles[g];w.upload(h),w.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return v.values(this._tiles).map(function(h){return h.tileID}).sort(ae).map(function(h){return h.key})},p.prototype.getRenderableIds=function(h){var g=this,w=[];for(var D in this._tiles)this._isIdRenderable(D,h)&&w.push(this._tiles[D]);return h?w.sort(function(T,I){var R=T.tileID,F=I.tileID,W=new v.Point(R.canonical.x,R.canonical.y)._rotate(g.transform.angle),Z=new v.Point(F.canonical.x,F.canonical.y)._rotate(g.transform.angle);return R.overscaledZ-F.overscaledZ||Z.y-W.y||Z.x-W.x}).map(function(T){return T.tileID.key}):w.map(function(T){return T.tileID}).sort(ae).map(function(T){return T.key})},p.prototype.hasRenderableParent=function(h){var g=this.findLoadedParent(h,0);return!!g&&this._isIdRenderable(g.tileID.key)},p.prototype._isIdRenderable=function(h,g){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(g||!this._tiles[h].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)"errored"!==this._tiles[h].state&&this._reloadTile(h,"reloading")},p.prototype._reloadTile=function(h,g){var w=this._tiles[h];w&&("loading"!==w.state&&(w.state=g),this._loadTile(w,this._tileLoaded.bind(this,w,h,g)))},p.prototype._tileLoaded=function(h,g,w,D){if(D)return h.state="errored",void(404!==D.status?this._source.fire(new v.ErrorEvent(D,{tile:h})):this.update(this.transform));h.timeAdded=v.browser.now(),"expired"===w&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(g,h),"raster-dem"===this.getSource().type&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new v.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},p.prototype._backfillDEM=function(h){for(var g=this.getRenderableIds(),w=0;w<g.length;w++){var D=g[w];if(h.neighboringTiles&&h.neighboringTiles[D]){var T=this.getTileByID(D);I(h,T),I(T,h)}}function I(R,F){R.needsHillshadePrepare=!0;var W=F.tileID.canonical.x-R.tileID.canonical.x,Z=F.tileID.canonical.y-R.tileID.canonical.y,$=Math.pow(2,R.tileID.canonical.z),se=F.tileID.key;0===W&&0===Z||Math.abs(Z)>1||(Math.abs(W)>1&&(1===Math.abs(W+$)?W+=$:1===Math.abs(W-$)&&(W-=$)),F.dem&&R.dem&&(R.dem.backfillBorder(F.dem,W,Z),R.neighboringTiles&&R.neighboringTiles[se]&&(R.neighboringTiles[se].backfilled=!0)))}},p.prototype.getTile=function(h){return this.getTileByID(h.key)},p.prototype.getTileByID=function(h){return this._tiles[h]},p.prototype._retainLoadedChildren=function(h,g,w,D){for(var T in this._tiles){var I=this._tiles[T];if(!(D[T]||!I.hasData()||I.tileID.overscaledZ<=g||I.tileID.overscaledZ>w)){for(var R=I.tileID;I&&I.tileID.overscaledZ>g+1;){var F=I.tileID.scaledTo(I.tileID.overscaledZ-1);(I=this._tiles[F.key])&&I.hasData()&&(R=F)}for(var W=R;W.overscaledZ>g;)if(h[(W=W.scaledTo(W.overscaledZ-1)).key]){D[R.key]=R;break}}}},p.prototype.findLoadedParent=function(h,g){if(h.key in this._loadedParentTiles){var w=this._loadedParentTiles[h.key];return w&&w.tileID.overscaledZ>=g?w:null}for(var D=h.overscaledZ-1;D>=g;D--){var T=h.scaledTo(D),I=this._getLoadedTile(T);if(I)return I}},p.prototype._getLoadedTile=function(h){var g=this._tiles[h.key];return g&&g.hasData()?g:this._cache.getByKey(h.wrapped().key)},p.prototype.updateCacheSize=function(h){var g=Math.ceil(h.width/this._source.tileSize)+1,w=Math.ceil(h.height/this._source.tileSize)+1,D=Math.floor(g*w*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,D):D;this._cache.setMaxSize(T)},p.prototype.handleWrapJump=function(h){var g=Math.round((h-(void 0===this._prevLng?h:this._prevLng))/360);if(this._prevLng=h,g){var w={};for(var D in this._tiles){var T=this._tiles[D];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+g),w[T.tileID.key]=T}for(var I in this._tiles=w,this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(var R in this._tiles)this._setTileReloadTimer(R,this._tiles[R])}},p.prototype.update=function(h){var g=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var w;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?w=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ve){return new v.OverscaledTileID(Ve.canonical.z,Ve.wrap,Ve.canonical.z,Ve.canonical.x,Ve.canonical.y)}):(w=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(w=w.filter(function(Ve){return g._source.hasTile(Ve)}))):w=[];var D=h.coveringZoomLevel(this._source),T=Math.max(D-p.maxOverzooming,this._source.minzoom),I=Math.max(D+p.maxUnderzooming,this._source.minzoom),R=this._updateRetainedTiles(w,D);if(qe(this._source.type)){for(var F={},W={},Z=0,$=Object.keys(R);Z<$.length;Z+=1){var se=$[Z],re=R[se],de=this._tiles[se];if(de&&!(de.fadeEndTime&&de.fadeEndTime<=v.browser.now())){var ie=this.findLoadedParent(re,T);ie&&(this._addTile(ie.tileID),F[ie.tileID.key]=ie.tileID),W[se]=re}}for(var le in this._retainLoadedChildren(W,D,I,R),F)R[le]||(this._coveredTiles[le]=!0,R[le]=F[le])}for(var _e in R)this._tiles[_e].clearFadeHold();for(var we=0,Ae=v.keysDifference(this._tiles,R);we<Ae.length;we+=1){var De=Ae[we],Re=this._tiles[De];Re.hasSymbolBuckets&&!Re.holdingForFade()?Re.setHoldDuration(this.map._fadeDuration):Re.hasSymbolBuckets&&!Re.symbolFadeFinished()||this._removeTile(De)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},p.prototype._updateRetainedTiles=function(h,g){for(var w={},D={},T=Math.max(g-p.maxOverzooming,this._source.minzoom),I=Math.max(g+p.maxUnderzooming,this._source.minzoom),R={},F=0,W=h;F<W.length;F+=1){var Z=W[F],$=this._addTile(Z);w[Z.key]=Z,$.hasData()||g<this._source.maxzoom&&(R[Z.key]=Z)}this._retainLoadedChildren(R,g,I,w);for(var se=0,re=h;se<re.length;se+=1){var de=re[se],ie=this._tiles[de.key];if(!ie.hasData()){if(g+1>this._source.maxzoom){var le=de.children(this._source.maxzoom)[0],_e=this.getTile(le);if(_e&&_e.hasData()){w[le.key]=le;continue}}else{var we=de.children(this._source.maxzoom);if(w[we[0].key]&&w[we[1].key]&&w[we[2].key]&&w[we[3].key])continue}for(var Ae=ie.wasRequested(),De=de.overscaledZ-1;De>=T;--De){var Re=de.scaledTo(De);if(D[Re.key]||(D[Re.key]=!0,!(ie=this.getTile(Re))&&Ae&&(ie=this._addTile(Re)),ie&&(w[Re.key]=Re,Ae=ie.wasRequested(),ie.hasData())))break}}}return w},p.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var g=[],w=void 0,D=this._tiles[h].tileID;D.overscaledZ>0;){if(D.key in this._loadedParentTiles){w=this._loadedParentTiles[D.key];break}g.push(D.key);var T=D.scaledTo(D.overscaledZ-1);if(w=this._getLoadedTile(T))break;D=T}for(var I=0,R=g;I<R.length;I+=1)this._loadedParentTiles[R[I]]=w}},p.prototype._addTile=function(h){var g=this._tiles[h.key];if(g)return g;(g=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,g),g.tileID=h,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,g)));var w=!!g;return w||(g=new v.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,h.key,g.state))),g?(g.uses++,this._tiles[h.key]=g,w||this._source.fire(new v.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},p.prototype._setTileReloadTimer=function(h,g){var w=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var D=g.getExpiryTimeout();D&&(this._timers[h]=setTimeout(function(){w._reloadTile(h,"expired"),delete w._timers[h]},D))},p.prototype._removeTile=function(h){var g=this._tiles[h];g&&(g.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),g.uses>0||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},p.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},p.prototype.tilesIn=function(h,g,w){var D=this,T=[],I=this.transform;if(!I)return T;for(var R=w?I.getCameraQueryGeometry(h):h,F=h.map(function(De){return I.pointCoordinate(De)}),W=R.map(function(De){return I.pointCoordinate(De)}),Z=this.getIds(),$=1/0,se=1/0,re=-1/0,de=-1/0,ie=0,le=W;ie<le.length;ie+=1){var _e=le[ie];$=Math.min($,_e.x),se=Math.min(se,_e.y),re=Math.max(re,_e.x),de=Math.max(de,_e.y)}for(var we=function(De){var Re=D._tiles[Z[De]];if(!Re.holdingForFade()){var Ve=Re.tileID,Qe=Math.pow(2,I.zoom-Re.tileID.overscaledZ),We=g*Re.queryPadding*v.EXTENT/Re.tileSize/Qe,ct=[Ve.getTilePoint(new v.MercatorCoordinate($,se)),Ve.getTilePoint(new v.MercatorCoordinate(re,de))];if(ct[0].x-We<v.EXTENT&&ct[0].y-We<v.EXTENT&&ct[1].x+We>=0&&ct[1].y+We>=0){var Ct=F.map(function(It){return Ve.getTilePoint(It)}),kt=W.map(function(It){return Ve.getTilePoint(It)});T.push({tile:Re,tileID:Ve,queryGeometry:Ct,cameraQueryGeometry:kt,scale:Qe})}}},Ae=0;Ae<Z.length;Ae++)we(Ae);return T},p.prototype.getVisibleCoordinates=function(h){for(var g=this,w=this.getRenderableIds(h).map(function(R){return g._tiles[R].tileID}),D=0,T=w;D<T.length;D+=1){var I=T[D];I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped())}return w},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(qe(this._source.type))for(var h in this._tiles){var g=this._tiles[h];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=v.browser.now())return!0}return!1},p.prototype.setFeatureState=function(h,g,w){this._state.updateState(h=h||"_geojsonTileLayer",g,w)},p.prototype.removeFeatureState=function(h,g,w){this._state.removeFeatureState(h=h||"_geojsonTileLayer",g,w)},p.prototype.getFeatureState=function(h,g){return this._state.getState(h=h||"_geojsonTileLayer",g)},p.prototype.setDependencies=function(h,g,w){var D=this._tiles[h];D&&D.setDependencies(g,w)},p.prototype.reloadTilesForDependencies=function(h,g){for(var w in this._tiles)this._tiles[w].hasDependency(h,g)&&this._reloadTile(w,"reloading");this._cache.filter(function(D){return!D.hasDependency(h,g)})},p}(v.Evented);function ae(d,p){var h=Math.abs(2*d.wrap)-+(d.wrap<0),g=Math.abs(2*p.wrap)-+(p.wrap<0);return d.overscaledZ-p.overscaledZ||g-h||p.canonical.y-d.canonical.y||p.canonical.x-d.canonical.x}function qe(d){return"raster"===d||"image"===d||"video"===d}function Je(){return new v.window.Worker(tm.workerUrl)}X.maxOverzooming=10,X.maxUnderzooming=3;var Te="mapboxgl_preloaded_worker_pool",Ge=function(){this.active={}};Ge.prototype.acquire=function(d){if(!this.workers)for(this.workers=[];this.workers.length<Ge.workerCount;)this.workers.push(new Je);return this.active[d]=!0,this.workers.slice()},Ge.prototype.release=function(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},Ge.prototype.isPreloaded=function(){return!!this.active[Te]},Ge.prototype.numActive=function(){return Object.keys(this.active).length};var ht,pt=Math.floor(v.browser.hardwareConcurrency/2);function Et(){return ht||(ht=new Ge),ht}function Fe(d,p){var h={};for(var g in d)"ref"!==g&&(h[g]=d[g]);return v.refProperties.forEach(function(w){w in p&&(h[w]=p[w])}),h}function rt(d){d=d.slice();for(var p=Object.create(null),h=0;h<d.length;h++)p[d[h].id]=d[h];for(var g=0;g<d.length;g++)"ref"in d[g]&&(d[g]=Fe(d[g],p[d[g].ref]));return d}Ge.workerCount=Math.max(Math.min(pt,6),1);var je={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function en(d,p,h){h.push({command:je.addSource,args:[d,p[d]]})}function tn(d,p,h){p.push({command:je.removeSource,args:[d]}),h[d]=!0}function ue(d,p,h,g){tn(d,h,g),en(d,p,h)}function fr(d,p,h){var g;for(g in d[h])if(d[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],p[h][g]))return!1;for(g in p[h])if(p[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],p[h][g]))return!1;return!0}function Ht(d,p,h,g,w,D){var T;for(T in p=p||{},d=d||{})d.hasOwnProperty(T)&&(v.deepEqual(d[T],p[T])||h.push({command:D,args:[g,T,p[T],w]}));for(T in p)p.hasOwnProperty(T)&&!d.hasOwnProperty(T)&&(v.deepEqual(d[T],p[T])||h.push({command:D,args:[g,T,p[T],w]}))}function ln(d){return d.id}function Ir(d,p){return d[p.id]=p,d}var Un=function(d,p){this.reset(d,p)};Un.prototype.reset=function(d,p){this.points=d||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Un.prototype.lerp=function(d){if(1===this.points.length)return this.points[0];d=v.clamp(d,0,1);for(var p=1,h=this._distances[p],g=d*this.paddedLength+this.padding;h<g&&p<this._distances.length;)h=this._distances[++p];var w=p-1,D=this._distances[w],T=h-D,I=T>0?(g-D)/T:0;return this.points[w].mult(1-I).add(this.points[p].mult(I))};var _t=function(d,p,h){var g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(d/h),this.yCellCount=Math.ceil(p/h);for(var D=0;D<this.xCellCount*this.yCellCount;D++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=p,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function Br(d,p,h,g,w){var D=v.create();return p?(v.scale(D,D,[1/w,1/w,1]),h||v.rotateZ(D,D,g.angle)):v.multiply(D,g.labelPlaneMatrix,d),D}function En(d,p,h,g,w){if(p){var D=v.clone(d);return v.scale(D,D,[w,w,1]),h||v.rotateZ(D,D,-g.angle),D}return g.glCoordMatrix}function mn(d,p){var h=[d.x,d.y,0,1];la(h,h,p);var g=h[3];return{point:new v.Point(h[0]/g,h[1]/g),signedDistanceFromCamera:g}}function Hd(d,p){return.5+d/p*.5}function wn(d,p){var h=d[0]/d[3],g=d[1]/d[3];return h>=-p[0]&&h<=p[0]&&g>=-p[1]&&g<=p[1]}function Jn(d,p,h,g,w,D,T,I){var R=g?d.textSizeData:d.iconSizeData,F=v.evaluateSizeForZoom(R,h.transform.zoom),W=[256/h.width*2+1,256/h.height*2+1],Z=g?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;Z.clear();for(var $=d.lineVertexArray,se=g?d.text.placedSymbolArray:d.icon.placedSymbolArray,re=h.transform.width/h.transform.height,de=!1,ie=0;ie<se.length;ie++){var le=se.get(ie);if(le.hidden||le.writingMode===v.WritingMode.vertical&&!de)Bo(le.numGlyphs,Z);else{de=!1;var _e=[le.anchorX,le.anchorY,0,1];if(v.transformMat4(_e,_e,p),wn(_e,W)){var we=Hd(h.transform.cameraToCenterDistance,_e[3]),Ae=v.evaluateSizeForFeature(R,F,le),De=T?Ae/we:Ae*we,Re=new v.Point(le.anchorX,le.anchorY),Ve=mn(Re,w).point,Qe={},We=kr(le,De,!1,I,p,w,D,d.glyphOffsetArray,$,Z,Ve,Re,Qe,re);de=We.useVertical,(We.notEnoughRoom||de||We.needsFlipping&&kr(le,De,!0,I,p,w,D,d.glyphOffsetArray,$,Z,Ve,Re,Qe,re).notEnoughRoom)&&Bo(le.numGlyphs,Z)}else Bo(le.numGlyphs,Z)}}g?d.text.dynamicLayoutVertexBuffer.updateData(Z):d.icon.dynamicLayoutVertexBuffer.updateData(Z)}function _n(d,p,h,g,w,D,T,I,R,F,W){var Z=I.glyphStartIndex+I.numGlyphs,$=I.lineStartIndex,se=I.lineStartIndex+I.lineLength,re=p.getoffsetX(I.glyphStartIndex),de=p.getoffsetX(Z-1),ie=$c(d*re,h,g,w,D,T,I.segment,$,se,R,F,W);if(!ie)return null;var le=$c(d*de,h,g,w,D,T,I.segment,$,se,R,F,W);return le?{first:ie,last:le}:null}function si(d,p,h,g){return d===v.WritingMode.horizontal&&Math.abs(h.y-p.y)>Math.abs(h.x-p.x)*g?{useVertical:!0}:(d===v.WritingMode.vertical?p.y<h.y:p.x>h.x)?{needsFlipping:!0}:null}function kr(d,p,h,g,w,D,T,I,R,F,W,Z,$,se){var re,de=p/24,ie=d.lineOffsetX*de,le=d.lineOffsetY*de;if(d.numGlyphs>1){var _e=d.glyphStartIndex+d.numGlyphs,we=d.lineStartIndex,Ae=d.lineStartIndex+d.lineLength,De=_n(de,I,ie,le,h,W,Z,d,R,D,$);if(!De)return{notEnoughRoom:!0};var Re=mn(De.first.point,T).point,Ve=mn(De.last.point,T).point;if(g&&!h){var Qe=si(d.writingMode,Re,Ve,se);if(Qe)return Qe}re=[De.first];for(var We=d.glyphStartIndex+1;We<_e-1;We++)re.push($c(de*I.getoffsetX(We),ie,le,h,W,Z,d.segment,we,Ae,R,D,$));re.push(De.last)}else{if(g&&!h){var ct=mn(Z,w).point,Ct=d.lineStartIndex+d.segment+1,kt=new v.Point(R.getx(Ct),R.gety(Ct)),It=mn(kt,w),gn=It.signedDistanceFromCamera>0?It.point:Og(Z,kt,ct,1,w),ft=si(d.writingMode,ct,gn,se);if(ft)return ft}var Xt=$c(de*I.getoffsetX(d.glyphStartIndex),ie,le,h,W,Z,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,R,D,$);if(!Xt)return{notEnoughRoom:!0};re=[Xt]}for(var hn=0,et=re;hn<et.length;hn+=1){var zt=et[hn];v.addDynamicAttributes(F,zt.point,zt.angle)}return{}}function Og(d,p,h,g,w){var D=mn(d.add(d.sub(p)._unit()),w).point,T=h.sub(D);return h.add(T._mult(g/T.mag()))}function $c(d,p,h,g,w,D,T,I,R,F,W,Z){var $=g?d-p:d+p,se=$>0?1:-1,re=0;g&&(se*=-1,re=Math.PI),se<0&&(re+=Math.PI);for(var de=se>0?I+T:I+T+1,ie=w,le=w,_e=0,we=0,Ae=Math.abs($),De=[];_e+we<=Ae;){if((de+=se)<I||de>=R)return null;if(le=ie,De.push(ie),void 0===(ie=Z[de])){var Re=new v.Point(F.getx(de),F.gety(de)),Ve=mn(Re,W);if(Ve.signedDistanceFromCamera>0)ie=Z[de]=Ve.point;else{var Qe=de-se;ie=Og(0===_e?D:new v.Point(F.getx(Qe),F.gety(Qe)),Re,le,Ae-_e+1,W)}}_e+=we,we=le.dist(ie)}var We=(Ae-_e)/we,ct=ie.sub(le),Ct=ct.mult(We)._add(le);Ct._add(ct._unit()._perp()._mult(h*se));var kt=re+Math.atan2(ie.y-le.y,ie.x-le.x);return De.push(Ct),{point:Ct,angle:kt,path:De}}_t.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_t.prototype.insert=function(d,p,h,g,w){this._forEachCell(p,h,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(w)},_t.prototype.insertCircle=function(d,p,h,g){this._forEachCell(p-g,h-g,p+g,h+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(p),this.circles.push(h),this.circles.push(g)},_t.prototype._insertBoxCell=function(d,p,h,g,w,D){this.boxCells[w].push(D)},_t.prototype._insertCircleCell=function(d,p,h,g,w,D){this.circleCells[w].push(D)},_t.prototype._query=function(d,p,h,g,w,D){if(h<0||d>this.width||g<0||p>this.height)return!w&&[];var T=[];if(d<=0&&p<=0&&this.width<=h&&this.height<=g){if(w)return!0;for(var I=0;I<this.boxKeys.length;I++)T.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(var R=0;R<this.circleKeys.length;R++){var F=this.circles[3*R],W=this.circles[3*R+1],Z=this.circles[3*R+2];T.push({key:this.circleKeys[R],x1:F-Z,y1:W-Z,x2:F+Z,y2:W+Z})}return D?T.filter(D):T}return this._forEachCell(d,p,h,g,this._queryCell,T,{hitTest:w,seenUids:{box:{},circle:{}}},D),w?T.length>0:T},_t.prototype._queryCircle=function(d,p,h,g,w){var D=d-h,T=d+h,I=p-h,R=p+h;if(T<0||D>this.width||R<0||I>this.height)return!g&&[];var F=[];return this._forEachCell(D,I,T,R,this._queryCellCircle,F,{hitTest:g,circle:{x:d,y:p,radius:h},seenUids:{box:{},circle:{}}},w),g?F.length>0:F},_t.prototype.query=function(d,p,h,g,w){return this._query(d,p,h,g,!1,w)},_t.prototype.hitTest=function(d,p,h,g,w){return this._query(d,p,h,g,!0,w)},_t.prototype.hitTestCircle=function(d,p,h,g){return this._queryCircle(d,p,h,!0,g)},_t.prototype._queryCell=function(d,p,h,g,w,D,T,I){var R=T.seenUids,F=this.boxCells[w];if(null!==F)for(var W=this.bboxes,Z=0,$=F;Z<$.length;Z+=1){var se=$[Z];if(!R.box[se]){R.box[se]=!0;var re=4*se;if(d<=W[re+2]&&p<=W[re+3]&&h>=W[re+0]&&g>=W[re+1]&&(!I||I(this.boxKeys[se]))){if(T.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[se],x1:W[re],y1:W[re+1],x2:W[re+2],y2:W[re+3]})}}}var de=this.circleCells[w];if(null!==de)for(var ie=this.circles,le=0,_e=de;le<_e.length;le+=1){var we=_e[le];if(!R.circle[we]){R.circle[we]=!0;var Ae=3*we;if(this._circleAndRectCollide(ie[Ae],ie[Ae+1],ie[Ae+2],d,p,h,g)&&(!I||I(this.circleKeys[we]))){if(T.hitTest)return D.push(!0),!0;var De=ie[Ae],Re=ie[Ae+1],Ve=ie[Ae+2];D.push({key:this.circleKeys[we],x1:De-Ve,y1:Re-Ve,x2:De+Ve,y2:Re+Ve})}}}},_t.prototype._queryCellCircle=function(d,p,h,g,w,D,T,I){var R=T.circle,F=T.seenUids,W=this.boxCells[w];if(null!==W)for(var Z=this.bboxes,$=0,se=W;$<se.length;$+=1){var re=se[$];if(!F.box[re]){F.box[re]=!0;var de=4*re;if(this._circleAndRectCollide(R.x,R.y,R.radius,Z[de+0],Z[de+1],Z[de+2],Z[de+3])&&(!I||I(this.boxKeys[re])))return D.push(!0),!0}}var ie=this.circleCells[w];if(null!==ie)for(var le=this.circles,_e=0,we=ie;_e<we.length;_e+=1){var Ae=we[_e];if(!F.circle[Ae]){F.circle[Ae]=!0;var De=3*Ae;if(this._circlesCollide(le[De],le[De+1],le[De+2],R.x,R.y,R.radius)&&(!I||I(this.circleKeys[Ae])))return D.push(!0),!0}}},_t.prototype._forEachCell=function(d,p,h,g,w,D,T,I){for(var R=this._convertToXCellCoord(d),F=this._convertToYCellCoord(p),W=this._convertToXCellCoord(h),Z=this._convertToYCellCoord(g),$=R;$<=W;$++)for(var se=F;se<=Z;se++)if(w.call(this,d,p,h,g,this.xCellCount*se+$,D,T,I))return},_t.prototype._convertToXCellCoord=function(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))},_t.prototype._convertToYCellCoord=function(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))},_t.prototype._circlesCollide=function(d,p,h,g,w,D){var T=g-d,I=w-p,R=h+D;return R*R>T*T+I*I},_t.prototype._circleAndRectCollide=function(d,p,h,g,w,D,T){var I=(D-g)/2,R=Math.abs(d-(g+I));if(R>I+h)return!1;var F=(T-w)/2,W=Math.abs(p-(w+F));if(W>F+h)return!1;if(R<=I||W<=F)return!0;var Z=R-I,$=W-F;return Z*Z+$*$<=h*h};var Hi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Bo(d,p){for(var h=0;h<d;h++){var g=p.length;p.resize(g+4),p.float32.set(Hi,3*g)}}function la(d,p,h){var g=p[0],w=p[1];return d[0]=h[0]*g+h[4]*w+h[12],d[1]=h[1]*g+h[5]*w+h[13],d[3]=h[3]*g+h[7]*w+h[15],d}var Rr=function(d,p,h){void 0===p&&(p=new _t(d.width+200,d.height+200,25)),void 0===h&&(h=new _t(d.width+200,d.height+200,25)),this.transform=d,this.grid=p,this.ignoredGrid=h,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+100,this.screenBottomBoundary=d.height+100,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200};function ls(d,p,h){return p*(v.EXTENT/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}Rr.prototype.placeCollisionBox=function(d,p,h,g,w){var D=this.projectAndGetPerspectiveRatio(g,d.anchorPointX,d.anchorPointY),T=h*D.perspectiveRatio,I=d.x1*T+D.point.x,R=d.y1*T+D.point.y,F=d.x2*T+D.point.x,W=d.y2*T+D.point.y;return!this.isInsideGrid(I,R,F,W)||!p&&this.grid.hitTest(I,R,F,W,w)?{box:[],offscreen:!1}:{box:[I,R,F,W],offscreen:this.isOffscreen(I,R,F,W)}},Rr.prototype.placeCollisionCircles=function(d,p,h,g,w,D,T,I,R,F,W,Z,$){var se=[],re=new v.Point(p.anchorX,p.anchorY),de=mn(re,D),ie=Hd(this.transform.cameraToCenterDistance,de.signedDistanceFromCamera),le=(F?w/ie:w*ie)/v.ONE_EM,_e=mn(re,T).point,we=_n(le,g,p.lineOffsetX*le,p.lineOffsetY*le,!1,_e,re,p,h,T,{}),Ae=!1,De=!1,Re=!0;if(we){for(var Ve=.5*Z*ie+$,Qe=new v.Point(-100,-100),We=new v.Point(this.screenRightBoundary,this.screenBottomBoundary),ct=new Un,Ct=we.first,kt=we.last,It=[],gn=Ct.path.length-1;gn>=1;gn--)It.push(Ct.path[gn]);for(var ft=1;ft<kt.path.length;ft++)It.push(kt.path[ft]);var Xt=2.5*Ve;if(I){var hn=It.map(function(Me){return mn(Me,I)});It=hn.some(function(Me){return Me.signedDistanceFromCamera<=0})?[]:hn.map(function(Me){return Me.point})}var et=[];if(It.length>0){for(var zt=It[0].clone(),qt=It[0].clone(),jt=1;jt<It.length;jt++)zt.x=Math.min(zt.x,It[jt].x),zt.y=Math.min(zt.y,It[jt].y),qt.x=Math.max(qt.x,It[jt].x),qt.y=Math.max(qt.y,It[jt].y);et=zt.x>=Qe.x&&qt.x<=We.x&&zt.y>=Qe.y&&qt.y<=We.y?[It]:qt.x<Qe.x||zt.x>We.x||qt.y<Qe.y||zt.y>We.y?[]:v.clipLine([It],Qe.x,Qe.y,We.x,We.y)}for(var Pt=0,lr=et;Pt<lr.length;Pt+=1){var qr;ct.reset(lr[Pt],.25*Ve),qr=ct.length<=.5*Ve?1:Math.ceil(ct.paddedLength/Xt)+1;for(var ho=0;ho<qr;ho++){var vi=ho/Math.max(qr-1,1),bi=ct.lerp(vi),ei=bi.x+100,Uo=bi.y+100;se.push(ei,Uo,Ve,0);var qa=ei-Ve,Co=Uo-Ve,Le=ei+Ve,$t=Uo+Ve;if(Re=Re&&this.isOffscreen(qa,Co,Le,$t),De=De||this.isInsideGrid(qa,Co,Le,$t),!d&&this.grid.hitTestCircle(ei,Uo,Ve,W)&&(Ae=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!R&&Ae||!De?[]:se,offscreen:Re,collisionDetected:Ae}},Rr.prototype.queryRenderedSymbols=function(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var p=[],h=1/0,g=1/0,w=-1/0,D=-1/0,T=0,I=d;T<I.length;T+=1){var R=I[T],F=new v.Point(R.x+100,R.y+100);h=Math.min(h,F.x),g=Math.min(g,F.y),w=Math.max(w,F.x),D=Math.max(D,F.y),p.push(F)}for(var W={},Z={},$=0,se=this.grid.query(h,g,w,D).concat(this.ignoredGrid.query(h,g,w,D));$<se.length;$+=1){var re=se[$],de=re.key;if(void 0===W[de.bucketInstanceId]&&(W[de.bucketInstanceId]={}),!W[de.bucketInstanceId][de.featureIndex]){var ie=[new v.Point(re.x1,re.y1),new v.Point(re.x2,re.y1),new v.Point(re.x2,re.y2),new v.Point(re.x1,re.y2)];v.polygonIntersectsPolygon(p,ie)&&(W[de.bucketInstanceId][de.featureIndex]=!0,void 0===Z[de.bucketInstanceId]&&(Z[de.bucketInstanceId]=[]),Z[de.bucketInstanceId].push(de.featureIndex))}}return Z},Rr.prototype.insertCollisionBox=function(d,p,h,g,w){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:w},d[0],d[1],d[2],d[3])},Rr.prototype.insertCollisionCircles=function(d,p,h,g,w){for(var D=p?this.ignoredGrid:this.grid,T={bucketInstanceId:h,featureIndex:g,collisionGroupID:w},I=0;I<d.length;I+=4)D.insertCircle(T,d[I],d[I+1],d[I+2])},Rr.prototype.projectAndGetPerspectiveRatio=function(d,p,h){var g=[p,h,0,1];return la(g,g,d),{point:new v.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},Rr.prototype.isOffscreen=function(d,p,h,g){return h<100||d>=this.screenRightBoundary||g<100||p>this.screenBottomBoundary},Rr.prototype.isInsideGrid=function(d,p,h,g){return h>=0&&d<this.gridRightBoundary&&g>=0&&p<this.gridBottomBoundary},Rr.prototype.getViewportMatrix=function(){var d=v.identity([]);return v.translate(d,d,[-100,-100,0]),d};var _o=function(d,p,h,g){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?p:-p))):g&&h?1:0,this.placed=h};_o.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var cs=function(d,p,h,g,w){this.text=new _o(d?d.text:null,p,h,w),this.icon=new _o(d?d.icon:null,p,g,w)};cs.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Xl=function(d,p,h){this.text=d,this.icon=p,this.skipFade=h},ev=function(){this.invProjMatrix=v.create(),this.viewportMatrix=v.create(),this.circles=[]},ca=function(d,p,h,g,w){this.bucketInstanceId=d,this.featureIndex=p,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=w},yo=function(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}};function Rt(d,p,h,g,w){var D=v.getAnchorAlignment(d),T=-(D.horizontalAlign-.5)*p,I=-(D.verticalAlign-.5)*h,R=v.evaluateVariableOffset(d,g);return new v.Point(T+R[0]*w,I+R[1]*w)}function so(d,p,h,g,w,D){var T=d.x1,I=d.x2,R=d.y1,F=d.y2,W=d.anchorPointX,Z=d.anchorPointY,$=new v.Point(p,h);return g&&$._rotate(w?D:-D),{x1:T+$.x,y1:R+$.y,x2:I+$.x,y2:F+$.y,anchorPointX:W,anchorPointY:Z}}yo.prototype.get=function(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){var p=++this.maxGroupID;this.collisionGroups[d]={ID:p,predicate:function(h){return h.collisionGroupID===p}}}return this.collisionGroups[d]};var Si=function(d,p,h,g){this.transform=d.clone(),this.collisionIndex=new Rr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new yo(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Bu(d,p,h,g,w){d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0)}Si.prototype.getBucketParts=function(d,p,h,g){var w=h.getBucket(p),D=h.latestFeatureIndex;if(w&&D&&p.id===w.layerIds[0]){var T=h.collisionBoxArray,I=w.layers[0].layout,R=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),F=h.tileSize/v.EXTENT,W=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),Z="map"===I.get("text-pitch-alignment"),$="map"===I.get("text-rotation-alignment"),se=ls(h,1,this.transform.zoom),re=Br(W,Z,$,this.transform,se),de=null;if(Z){var ie=En(W,Z,$,this.transform,se);de=v.multiply([],this.transform.labelPlaneMatrix,ie)}this.retainedQueryData[w.bucketInstanceId]=new ca(w.bucketInstanceId,D,w.sourceLayerIndex,w.index,h.tileID);var le={bucket:w,layout:I,posMatrix:W,textLabelPlaneMatrix:re,labelToScreenMatrix:de,scale:R,textPixelRatio:F,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(var _e=0,we=w.sortKeyRanges;_e<we.length;_e+=1){var Ae=we[_e];d.push({sortKey:Ae.sortKey,symbolInstanceStart:Ae.symbolInstanceStart,symbolInstanceEnd:Ae.symbolInstanceEnd,parameters:le})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:le})}},Si.prototype.attemptAnchorPlacement=function(d,p,h,g,w,D,T,I,R,F,W,Z,$,se,re){var de,ie=[Z.textOffset0,Z.textOffset1],le=Rt(d,h,g,ie,w),_e=this.collisionIndex.placeCollisionBox(so(p,le.x,le.y,D,T,this.transform.angle),W,I,R,F.predicate);if(!re||0!==this.collisionIndex.placeCollisionBox(so(re,le.x,le.y,D,T,this.transform.angle),W,I,R,F.predicate).box.length)return _e.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(de=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),this.variableOffsets[Z.crossTileID]={textOffset:ie,width:h,height:g,anchor:d,textBoxScale:w,prevAnchor:de},this.markUsedJustification($,d,Z,se),$.allowVerticalPlacement&&(this.markUsedOrientation($,se,Z),this.placedOrientations[Z.crossTileID]=se),{shift:le,placedGlyphBoxes:_e}):void 0},Si.prototype.placeLayerBucketPart=function(d,p,h){var g=this,w=d.parameters,D=w.bucket,T=w.layout,I=w.posMatrix,R=w.textLabelPlaneMatrix,F=w.labelToScreenMatrix,W=w.textPixelRatio,Z=w.holdingForFade,$=w.collisionBoxArray,se=w.partiallyEvaluatedTextSize,re=w.collisionGroup,de=T.get("text-optional"),ie=T.get("icon-optional"),le=T.get("text-allow-overlap"),_e=T.get("icon-allow-overlap"),we="map"===T.get("text-rotation-alignment"),Ae="map"===T.get("text-pitch-alignment"),De="none"!==T.get("icon-text-fit"),Re="viewport-y"===T.get("symbol-z-order"),Ve=le&&(_e||!D.hasIconData()||ie),Qe=_e&&(le||!D.hasTextData()||de);!D.collisionArrays&&$&&D.deserializeCollisionBoxes($);var We=function(ft,Xt){if(!p[ft.crossTileID])if(Z)g.placements[ft.crossTileID]=new Xl(!1,!1,!1);else{var hn,et=!1,zt=!1,qt=!0,jt=null,Pt={box:null,offscreen:null},lr={box:null,offscreen:null},qr=null,ho=null,vi=0,bi=0,ei=0;Xt.textFeatureIndex?vi=Xt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(vi=ft.featureIndex),Xt.verticalTextFeatureIndex&&(bi=Xt.verticalTextFeatureIndex);var Uo=Xt.textBox;if(Uo){var qa=function(Nr){var jn=v.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Nr&&g.prevPlacement){var Vr=g.prevPlacement.placedOrientations[ft.crossTileID];Vr&&(g.placedOrientations[ft.crossTileID]=Vr,g.markUsedOrientation(D,jn=Vr,ft))}return jn},Co=function(Nr,jn){if(D.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Xt.verticalTextBox)for(var Vr=0,Ju=D.writingModes;Vr<Ju.length&&(Ju[Vr]===v.WritingMode.vertical?(Pt=jn(),lr=Pt):Pt=Nr(),!(Pt&&Pt.box&&Pt.box.length));Vr+=1);else Pt=Nr()};if(T.get("text-variable-anchor")){var Le=T.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[ft.crossTileID]){var $t=g.prevPlacement.variableOffsets[ft.crossTileID];Le.indexOf($t.anchor)>0&&(Le=Le.filter(function(Nr){return Nr!==$t.anchor})).unshift($t.anchor)}var Me=function(Nr,jn,Vr){for(var Ju=Nr.x2-Nr.x1,Qi=Nr.y2-Nr.y1,El=ft.textBoxScale,Pf=De&&!_e?jn:null,nh={box:[],offscreen:!1},Hg=le?2*Le.length:Le.length,rh=0;rh<Hg;++rh){var tu=g.attemptAnchorPlacement(Le[rh%Le.length],Nr,Ju,Qi,El,we,Ae,W,I,re,rh>=Le.length,ft,D,Vr,Pf);if(tu&&(nh=tu.placedGlyphBoxes)&&nh.box&&nh.box.length){et=!0,jt=tu.shift;break}}return nh};Co(function(){return Me(Uo,Xt.iconBox,v.WritingMode.horizontal)},function(){var Nr=Xt.verticalTextBox;return D.allowVerticalPlacement&&!(Pt&&Pt.box&&Pt.box.length)&&ft.numVerticalGlyphVertices>0&&Nr?Me(Nr,Xt.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),Pt&&(et=Pt.box,qt=Pt.offscreen);var Oe=qa(Pt&&Pt.box);if(!et&&g.prevPlacement){var Qt=g.prevPlacement.variableOffsets[ft.crossTileID];Qt&&(g.variableOffsets[ft.crossTileID]=Qt,g.markUsedJustification(D,Qt.anchor,ft,Oe))}}else{var Qc=function(Nr,jn){var Vr=g.collisionIndex.placeCollisionBox(Nr,le,W,I,re.predicate);return Vr&&Vr.box&&Vr.box.length&&(g.markUsedOrientation(D,jn,ft),g.placedOrientations[ft.crossTileID]=jn),Vr};Co(function(){return Qc(Uo,v.WritingMode.horizontal)},function(){var Nr=Xt.verticalTextBox;return D.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Nr?Qc(Nr,v.WritingMode.vertical):{box:null,offscreen:null}}),qa(Pt&&Pt.box&&Pt.box.length)}}if(et=(hn=Pt)&&hn.box&&hn.box.length>0,qt=hn&&hn.offscreen,ft.useRuntimeCollisionCircles){var pa=D.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),Us=v.evaluateSizeForFeature(D.textSizeData,se,pa),Jc=T.get("text-padding");qr=g.collisionIndex.placeCollisionCircles(le,pa,D.lineVertexArray,D.glyphOffsetArray,Us,I,R,F,h,Ae,re.predicate,ft.collisionCircleDiameter,Jc),et=le||qr.circles.length>0&&!qr.collisionDetected,qt=qt&&qr.offscreen}if(Xt.iconFeatureIndex&&(ei=Xt.iconFeatureIndex),Xt.iconBox){var ma=function(Nr){var jn=De&&jt?so(Nr,jt.x,jt.y,we,Ae,g.transform.angle):Nr;return g.collisionIndex.placeCollisionBox(jn,_e,W,I,re.predicate)};zt=lr&&lr.box&&lr.box.length&&Xt.verticalIconBox?(ho=ma(Xt.verticalIconBox)).box.length>0:(ho=ma(Xt.iconBox)).box.length>0,qt=qt&&ho.offscreen}var eu=de||0===ft.numHorizontalGlyphVertices&&0===ft.numVerticalGlyphVertices,Mi=ie||0===ft.numIconVertices;if(eu||Mi?Mi?eu||(zt=zt&&et):et=zt&&et:zt=et=zt&&et,et&&hn&&hn.box&&g.collisionIndex.insertCollisionBox(hn.box,T.get("text-ignore-placement"),D.bucketInstanceId,lr&&lr.box&&bi?bi:vi,re.ID),zt&&ho&&g.collisionIndex.insertCollisionBox(ho.box,T.get("icon-ignore-placement"),D.bucketInstanceId,ei,re.ID),qr&&(et&&g.collisionIndex.insertCollisionCircles(qr.circles,T.get("text-ignore-placement"),D.bucketInstanceId,vi,re.ID),h)){var uc=D.bucketInstanceId,ea=g.collisionCircleArrays[uc];void 0===ea&&(ea=g.collisionCircleArrays[uc]=new ev);for(var dc=0;dc<qr.circles.length;dc+=4)ea.circles.push(qr.circles[dc+0]),ea.circles.push(qr.circles[dc+1]),ea.circles.push(qr.circles[dc+2]),ea.circles.push(qr.collisionDetected?1:0)}g.placements[ft.crossTileID]=new Xl(et||Ve,zt||Qe,qt||D.justReloaded),p[ft.crossTileID]=!0}};if(Re)for(var ct=D.getSortedSymbolIndexes(this.transform.angle),Ct=ct.length-1;Ct>=0;--Ct){var kt=ct[Ct];We(D.symbolInstances.get(kt),D.collisionArrays[kt])}else for(var It=d.symbolInstanceStart;It<d.symbolInstanceEnd;It++)We(D.symbolInstances.get(It),D.collisionArrays[It]);if(h&&D.bucketInstanceId in this.collisionCircleArrays){var gn=this.collisionCircleArrays[D.bucketInstanceId];v.invert(gn.invProjMatrix,I),gn.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1},Si.prototype.markUsedJustification=function(d,p,h,g){var w;w=g===v.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(p)];for(var D=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];D<T.length;D+=1){var I=T[D];I>=0&&(d.text.placedSymbolArray.get(I).crossTileID=w>=0&&I!==w?0:h.crossTileID)}},Si.prototype.markUsedOrientation=function(d,p,h){for(var g=p===v.WritingMode.horizontal||p===v.WritingMode.horizontalOnly?p:0,w=p===v.WritingMode.vertical?p:0,D=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];D<T.length;D+=1)d.text.placedSymbolArray.get(T[D]).placedOrientation=g;h.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=w)},Si.prototype.commit=function(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,h=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var g=p?p.symbolFadeChange(d):1,w=p?p.opacities:{},D=p?p.variableOffsets:{},T=p?p.placedOrientations:{};for(var I in this.placements){var R=this.placements[I],F=w[I];F?(this.opacities[I]=new cs(F,g,R.text,R.icon),h=h||R.text!==F.text.placed||R.icon!==F.icon.placed):(this.opacities[I]=new cs(null,g,R.text,R.icon,R.skipFade),h=h||R.text||R.icon)}for(var W in w){var Z=w[W];if(!this.opacities[W]){var $=new cs(Z,g,!1,!1);$.isHidden()||(this.opacities[W]=$,h=h||Z.text.placed||Z.icon.placed)}}for(var se in D)this.variableOffsets[se]||!this.opacities[se]||this.opacities[se].isHidden()||(this.variableOffsets[se]=D[se]);for(var re in T)this.placedOrientations[re]||!this.opacities[re]||this.opacities[re].isHidden()||(this.placedOrientations[re]=T[re]);h?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:d)},Si.prototype.updateLayerOpacities=function(d,p){for(var h={},g=0,w=p;g<w.length;g+=1){var D=w[g],T=D.getBucket(d);T&&D.latestFeatureIndex&&d.id===T.layerIds[0]&&this.updateBucketOpacities(T,h,D.collisionBoxArray)}},Si.prototype.updateBucketOpacities=function(d,p,h){var g=this;d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var w=d.layers[0].layout,D=new cs(null,0,!1,!1,!0),T=w.get("text-allow-overlap"),I=w.get("icon-allow-overlap"),R=w.get("text-variable-anchor"),F="map"===w.get("text-rotation-alignment"),W="map"===w.get("text-pitch-alignment"),Z="none"!==w.get("icon-text-fit"),$=new cs(null,0,T&&(I||!d.hasIconData()||w.get("icon-optional")),I&&(T||!d.hasTextData()||w.get("text-optional")),!0);!d.collisionArrays&&h&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(h);for(var se=function(le,_e,we){for(var Ae=0;Ae<_e/4;Ae++)le.opacityVertexArray.emplaceBack(we)},re=function(le){var _e=d.symbolInstances.get(le),we=_e.numHorizontalGlyphVertices,Ae=_e.numVerticalGlyphVertices,De=_e.crossTileID,Re=g.opacities[De];p[De]?Re=D:Re||(g.opacities[De]=Re=$),p[De]=!0;var Ve=_e.numIconVertices>0,Qe=g.placedOrientations[_e.crossTileID],We=Qe===v.WritingMode.vertical,ct=Qe===v.WritingMode.horizontal||Qe===v.WritingMode.horizontalOnly;if(we>0||Ae>0){var Ct=qp(Re.text);se(d.text,we,We?qc:Ct),se(d.text,Ae,ct?qc:Ct);var kt=Re.text.isHidden();[_e.rightJustifiedTextSymbolIndex,_e.centerJustifiedTextSymbolIndex,_e.leftJustifiedTextSymbolIndex].forEach(function(Pt){Pt>=0&&(d.text.placedSymbolArray.get(Pt).hidden=kt||We?1:0)}),_e.verticalPlacedTextSymbolIndex>=0&&(d.text.placedSymbolArray.get(_e.verticalPlacedTextSymbolIndex).hidden=kt||ct?1:0);var It=g.variableOffsets[_e.crossTileID];It&&g.markUsedJustification(d,It.anchor,_e,Qe);var gn=g.placedOrientations[_e.crossTileID];gn&&(g.markUsedJustification(d,"left",_e,gn),g.markUsedOrientation(d,gn,_e))}if(Ve){var ft=qp(Re.icon),Xt=!(Z&&_e.verticalPlacedIconSymbolIndex&&We);_e.placedIconSymbolIndex>=0&&(se(d.icon,_e.numIconVertices,Xt?ft:qc),d.icon.placedSymbolArray.get(_e.placedIconSymbolIndex).hidden=Re.icon.isHidden()),_e.verticalPlacedIconSymbolIndex>=0&&(se(d.icon,_e.numVerticalIconVertices,Xt?qc:ft),d.icon.placedSymbolArray.get(_e.verticalPlacedIconSymbolIndex).hidden=Re.icon.isHidden())}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){var hn=d.collisionArrays[le];if(hn){var et=new v.Point(0,0);if(hn.textBox||hn.verticalTextBox){var zt=!0;if(R){var qt=g.variableOffsets[De];qt?(et=Rt(qt.anchor,qt.width,qt.height,qt.textOffset,qt.textBoxScale),F&&et._rotate(W?g.transform.angle:-g.transform.angle)):zt=!1}hn.textBox&&Bu(d.textCollisionBox.collisionVertexArray,Re.text.placed,!zt||We,et.x,et.y),hn.verticalTextBox&&Bu(d.textCollisionBox.collisionVertexArray,Re.text.placed,!zt||ct,et.x,et.y)}var jt=!(ct||!hn.verticalIconBox);hn.iconBox&&Bu(d.iconCollisionBox.collisionVertexArray,Re.icon.placed,jt,Z?et.x:0,Z?et.y:0),hn.verticalIconBox&&Bu(d.iconCollisionBox.collisionVertexArray,Re.icon.placed,!jt,Z?et.x:0,Z?et.y:0)}}},de=0;de<d.symbolInstances.length;de++)re(de);if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){var ie=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=ie.invProjMatrix,d.placementViewportMatrix=ie.viewportMatrix,d.collisionCircleArray=ie.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}},Si.prototype.symbolFadeChange=function(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Si.prototype.zoomAdjustment=function(d){return Math.max(0,(this.transform.zoom-d)/1.5)},Si.prototype.hasTransitions=function(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration},Si.prototype.stillRecent=function(d,p){var h=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*h>d},Si.prototype.setStale=function(){this.stale=!0};var $p=Math.pow(2,25),Ow=Math.pow(2,24),$e=Math.pow(2,17),Hr=Math.pow(2,16),df=Math.pow(2,9),Lg=Math.pow(2,8),tv=Math.pow(2,1);function qp(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;var p=d.placed?1:0,h=Math.floor(127*d.opacity);return h*$p+p*Ow+h*$e+p*Hr+h*df+p*Lg+h*tv+p}var qc=0,Gc=function(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&!d.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Gc.prototype.continuePlacement=function(d,p,h,g,w){for(var D=this._bucketParts;this._currentTileIndex<d.length;)if(p.getBucketParts(D,g,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(function(T,I){return T.sortKey-I.sortKey}));this._currentPartIndex<D.length;)if(p.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,w())return!0;return!1};var Wc=function(d,p,h,g,w,D,T){this.placement=new Si(d,w,D,T),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1};Wc.prototype.isDone=function(){return this._done},Wc.prototype.continuePlacement=function(d,p,h){for(var g=this,w=v.browser.now(),D=function(){var R=v.browser.now()-w;return!g._forceFullPlacement&&R>2};this._currentPlacementIndex>=0;){var T=p[d[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=I)&&(!T.maxzoom||T.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Gc(T)),this._inProgressLayer.continuePlacement(h[T.source],this.placement,this._showCollisionBoxes,T,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Wc.prototype.commit=function(d){return this.placement.commit(d),this.placement};var Ue=512/v.EXTENT/2,Vu=function(d,p,h){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var g=0;g<p.length;g++){var w=p.get(g),D=w.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,d)})}};Vu.prototype.getScaledCoordinates=function(d,p){var h=Ue/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*v.EXTENT+d.anchorX)*h),y:Math.floor((p.canonical.y*v.EXTENT+d.anchorY)*h)}},Vu.prototype.findMatches=function(d,p,h){for(var g=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),w=0;w<d.length;w++){var D=d.get(w);if(!D.crossTileID){var T=this.indexedSymbolInstances[D.key];if(T)for(var I=this.getScaledCoordinates(D,p),R=0,F=T;R<F.length;R+=1){var W=F[R];if(Math.abs(W.coord.x-I.x)<=g&&Math.abs(W.coord.y-I.y)<=g&&!h[W.crossTileID]){h[W.crossTileID]=!0,D.crossTileID=W.crossTileID;break}}}}};var Ql=function(){this.maxCrossTileID=0};Ql.prototype.generate=function(){return++this.maxCrossTileID};var ao=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ao.prototype.handleWrapJump=function(d){var p=Math.round((d-this.lng)/360);if(0!==p)for(var h in this.indexes){var g=this.indexes[h],w={};for(var D in g){var T=g[D];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+p),w[T.tileID.key]=T}this.indexes[h]=w}this.lng=d},ao.prototype.addBucket=function(d,p,h){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var g=0;g<p.symbolInstances.length;g++)p.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var w=this.usedCrossTileIDs[d.overscaledZ];for(var D in this.indexes){var T=this.indexes[D];if(Number(D)>d.overscaledZ)for(var I in T){var R=T[I];R.tileID.isChildOf(d)&&R.findMatches(p.symbolInstances,d,w)}else{var F=T[d.scaledTo(Number(D)).key];F&&F.findMatches(p.symbolInstances,d,w)}}for(var W=0;W<p.symbolInstances.length;W++){var Z=p.symbolInstances.get(W);Z.crossTileID||(Z.crossTileID=h.generate(),w[Z.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Vu(d,p.symbolInstances,p.bucketInstanceId),!0},ao.prototype.removeBucketCrossTileIDs=function(d,p){for(var h in p.indexedSymbolInstances)for(var g=0,w=p.indexedSymbolInstances[h];g<w.length;g+=1)delete this.usedCrossTileIDs[d][w[g].crossTileID]},ao.prototype.removeStaleBuckets=function(d){var p=!1;for(var h in this.indexes){var g=this.indexes[h];for(var w in g)d[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,g[w]),delete g[w],p=!0)}return p};var Ns=function(){this.layerIndexes={},this.crossTileIDs=new Ql,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ns.prototype.addLayer=function(d,p,h){var g=this.layerIndexes[d.id];void 0===g&&(g=this.layerIndexes[d.id]=new ao);var w=!1,D={};g.handleWrapJump(h);for(var T=0,I=p;T<I.length;T+=1){var R=I[T],F=R.getBucket(d);F&&d.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(R.tileID,F,this.crossTileIDs)&&(w=!0),D[F.bucketInstanceId]=!0)}return g.removeStaleBuckets(D)&&(w=!0),w},Ns.prototype.pruneUnusedLayers=function(d){var p={};for(var h in d.forEach(function(g){p[g]=!0}),this.layerIndexes)p[h]||delete this.layerIndexes[h]};var Jl=function(d,p){return v.emitValidationErrors(d,p&&p.filter(function(h){return"source.canvas"!==h.identifier}))},hf=v.pick(je,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ec=v.pick(je,["setCenter","setZoom","setBearing","setPitch"]),Os=function(){var d={},p=v.styleSpec.$version;for(var h in v.styleSpec.$root){var g,w=v.styleSpec.$root[h];w.required&&null!=(g="version"===h?p:"array"===w.type?[]:{})&&(d[h]=g)}return d}(),tc=function(d){function p(h,g){var w=this;void 0===g&&(g={}),d.call(this),this.map=h,this.dispatcher=new Lo(Et(),this),this.imageManager=new Ui,this.imageManager.setEventedParent(this),this.glyphManager=new zi(h._requestManager,g.localIdeographFontFamily),this.lineAtlas=new yr(256,512),this.crossTileSymbolIndex=new Ns,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());var D=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(T){D.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(I,R){if(v.triggerPluginCompletionEvent(I),R&&R.every(function(W){return W}))for(var F in D.sourceCaches)D.sourceCaches[F].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var I=w.sourceCaches[T.sourceId];if(I){var R=I.getSource();if(R&&R.vectorLayerIds)for(var F in w._layers){var W=w._layers[F];W.source===R.id&&w._validateLayer(W)}}}})}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.loadURL=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"}));var D="boolean"==typeof g.validate?g.validate:!v.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,g.accessToken);var T=this.map._requestManager.transformRequest(h,v.ResourceType.Style);this._request=v.getJSON(T,function(I,R){w._request=null,I?w.fire(new v.ErrorEvent(I)):R&&w._load(R,D)})},p.prototype.loadJSON=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.browser.frame(function(){w._request=null,w._load(h,!1!==g.validate)})},p.prototype.loadEmpty=function(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(Os,!1)},p.prototype._load=function(h,g){if(!g||!Jl(this,v.validateStyle(h))){for(var w in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(w,h.sources[w],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var D=rt(this.stylesheet.layers);this._order=D.map(function(F){return F.id}),this._layers={},this._serializedLayers={};for(var T=0,I=D;T<I.length;T+=1){var R=I[T];(R=v.createStyleLayer(R)).setEventedParent(this,{layer:{id:R.id}}),this._layers[R.id]=R,this._serializedLayers[R.id]=R.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new $l(this.stylesheet.light),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}},p.prototype._loadSprite=function(h){var g=this;this._spriteRequest=function(w,D,T){var I,R,F,W=v.browser.devicePixelRatio>1?"@2x":"",Z=v.getJSON(D.transformRequest(D.normalizeSpriteURL(w,W,".json"),v.ResourceType.SpriteJSON),function(re,de){Z=null,F||(F=re,I=de,se())}),$=v.getImage(D.transformRequest(D.normalizeSpriteURL(w,W,".png"),v.ResourceType.SpriteImage),function(re,de){$=null,F||(F=re,R=de,se())});function se(){if(F)T(F);else if(I&&R){var re=v.browser.getImageData(R),de={};for(var ie in I){var le=I[ie],_e=le.width,we=le.height,Ae=le.x,De=le.y,Re=le.sdf,Ve=le.pixelRatio,Qe=le.stretchX,We=le.stretchY,ct=le.content,Ct=new v.RGBAImage({width:_e,height:we});v.RGBAImage.copy(re,Ct,{x:Ae,y:De},{x:0,y:0},{width:_e,height:we}),de[ie]={data:Ct,pixelRatio:Ve,sdf:Re,stretchX:Qe,stretchY:We,content:ct}}T(null,de)}}return{cancel:function(){Z&&(Z.cancel(),Z=null),$&&($.cancel(),$=null)}}}(h,this.map._requestManager,function(w,D){if(g._spriteRequest=null,w)g.fire(new v.ErrorEvent(w));else if(D)for(var T in D)g.imageManager.addImage(T,D[T]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new v.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(h){var g=this.sourceCaches[h.source];if(g){var w=h.sourceLayer;if(w){var D=g.getSource();("geojson"===D.type||D.vectorLayerIds&&-1===D.vectorLayerIds.indexOf(w))&&this.fire(new v.ErrorEvent(new Error('Source layer "'+w+'" does not exist on source "'+D.id+'" as specified by style layer "'+h.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(h){for(var g=[],w=0,D=h;w<D.length;w+=1){var T=this._layers[D[w]];"custom"!==T.type&&g.push(T.serialize())}return g},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(h){if(this._loaded){var g=this._changed;if(this._changed){var w=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);for(var T in(w.length||D.length)&&this._updateWorkerLayers(w,D),this._updatedSources){var I=this._updatedSources[T];"reload"===I?this._reloadSource(T):"clear"===I&&this._clearSource(T)}for(var R in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[R].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var F={};for(var W in this.sourceCaches){var Z=this.sourceCaches[W];F[W]=Z.used,Z.used=!1}for(var $=0,se=this._order;$<se.length;$+=1){var re=this._layers[se[$]];re.recalculate(h,this._availableImages),!re.isHidden(h.zoom)&&re.source&&(this.sourceCaches[re.source].used=!0)}for(var de in F){var ie=this.sourceCaches[de];F[de]!==ie.used&&ie.fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:de}))}this.light.recalculate(h),this.z=h.zoom,g&&this.fire(new v.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},p.prototype._updateWorkerLayers=function(h,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:g})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(h){var g=this;if(this._checkLoaded(),Jl(this,v.validateStyle(h)))return!1;(h=v.clone$1(h)).layers=rt(h.layers);var w=function(T,I){if(!T)return[{command:je.setStyle,args:[I]}];var R=[];try{if(!v.deepEqual(T.version,I.version))return[{command:je.setStyle,args:[I]}];v.deepEqual(T.center,I.center)||R.push({command:je.setCenter,args:[I.center]}),v.deepEqual(T.zoom,I.zoom)||R.push({command:je.setZoom,args:[I.zoom]}),v.deepEqual(T.bearing,I.bearing)||R.push({command:je.setBearing,args:[I.bearing]}),v.deepEqual(T.pitch,I.pitch)||R.push({command:je.setPitch,args:[I.pitch]}),v.deepEqual(T.sprite,I.sprite)||R.push({command:je.setSprite,args:[I.sprite]}),v.deepEqual(T.glyphs,I.glyphs)||R.push({command:je.setGlyphs,args:[I.glyphs]}),v.deepEqual(T.transition,I.transition)||R.push({command:je.setTransition,args:[I.transition]}),v.deepEqual(T.light,I.light)||R.push({command:je.setLight,args:[I.light]});var F={},W=[];!function($,se,re,de){var ie;for(ie in se=se||{},$=$||{})$.hasOwnProperty(ie)&&(se.hasOwnProperty(ie)||tn(ie,re,de));for(ie in se)se.hasOwnProperty(ie)&&($.hasOwnProperty(ie)?v.deepEqual($[ie],se[ie])||("geojson"===$[ie].type&&"geojson"===se[ie].type&&fr($,se,ie)?re.push({command:je.setGeoJSONSourceData,args:[ie,se[ie].data]}):ue(ie,se,re,de)):en(ie,se,re))}(T.sources,I.sources,W,F);var Z=[];T.layers&&T.layers.forEach(function($){F[$.source]?R.push({command:je.removeLayer,args:[$.id]}):Z.push($)}),R=R.concat(W),function($,se,re){se=se||[];var de,ie,le,_e,we,Ae,De,Re=($=$||[]).map(ln),Ve=se.map(ln),Qe=$.reduce(Ir,{}),We=se.reduce(Ir,{}),ct=Re.slice(),Ct=Object.create(null);for(de=0,ie=0;de<Re.length;de++)We.hasOwnProperty(le=Re[de])?ie++:(re.push({command:je.removeLayer,args:[le]}),ct.splice(ct.indexOf(le,ie),1));for(de=0,ie=0;de<Ve.length;de++)ct[ct.length-1-de]!==(le=Ve[Ve.length-1-de])&&(Qe.hasOwnProperty(le)?(re.push({command:je.removeLayer,args:[le]}),ct.splice(ct.lastIndexOf(le,ct.length-ie),1)):ie++,re.push({command:je.addLayer,args:[We[le],Ae=ct[ct.length-de]]}),ct.splice(ct.length-de,0,le),Ct[le]=!0);for(de=0;de<Ve.length;de++)if(_e=Qe[le=Ve[de]],we=We[le],!Ct[le]&&!v.deepEqual(_e,we))if(v.deepEqual(_e.source,we.source)&&v.deepEqual(_e["source-layer"],we["source-layer"])&&v.deepEqual(_e.type,we.type)){for(De in Ht(_e.layout,we.layout,re,le,null,je.setLayoutProperty),Ht(_e.paint,we.paint,re,le,null,je.setPaintProperty),v.deepEqual(_e.filter,we.filter)||re.push({command:je.setFilter,args:[le,we.filter]}),v.deepEqual(_e.minzoom,we.minzoom)&&v.deepEqual(_e.maxzoom,we.maxzoom)||re.push({command:je.setLayerZoomRange,args:[le,we.minzoom,we.maxzoom]}),_e)_e.hasOwnProperty(De)&&"layout"!==De&&"paint"!==De&&"filter"!==De&&"metadata"!==De&&"minzoom"!==De&&"maxzoom"!==De&&(0===De.indexOf("paint.")?Ht(_e[De],we[De],re,le,De.slice(6),je.setPaintProperty):v.deepEqual(_e[De],we[De])||re.push({command:je.setLayerProperty,args:[le,De,we[De]]}));for(De in we)we.hasOwnProperty(De)&&!_e.hasOwnProperty(De)&&"layout"!==De&&"paint"!==De&&"filter"!==De&&"metadata"!==De&&"minzoom"!==De&&"maxzoom"!==De&&(0===De.indexOf("paint.")?Ht(_e[De],we[De],re,le,De.slice(6),je.setPaintProperty):v.deepEqual(_e[De],we[De])||re.push({command:je.setLayerProperty,args:[le,De,we[De]]}))}else re.push({command:je.removeLayer,args:[le]}),Ae=ct[ct.lastIndexOf(le)+1],re.push({command:je.addLayer,args:[we,Ae]})}(Z,I.layers,R)}catch($){console.warn("Unable to compute style diff:",$),R=[{command:je.setStyle,args:[I]}]}return R}(this.serialize(),h).filter(function(T){return!(T.command in ec)});if(0===w.length)return!1;var D=w.filter(function(T){return!(T.command in hf)});if(D.length>0)throw new Error("Unimplemented: "+D.map(function(T){return T.command}).join(", ")+".");return w.forEach(function(T){"setTransition"!==T.command&&g[T.command].apply(g,T.args)}),this.stylesheet=h,!0},p.prototype.addImage=function(h,g){if(this.getImage(h))return this.fire(new v.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,g),this._afterImageUpdated(h)},p.prototype.updateImage=function(h,g){this.imageManager.updateImage(h,g)},p.prototype.getImage=function(h){return this.imageManager.getImage(h)},p.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new v.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},p.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(h,g,w){var D=this;if(void 0===w&&(w={}),this._checkLoaded(),void 0!==this.sourceCaches[h])throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(v.validateStyle.source,"sources."+h,g,null,w))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var T=this.sourceCaches[h]=new X(h,g,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:D.loaded(),source:T.serialize(),sourceId:h}}),T.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(h){if(this._checkLoaded(),void 0===this.sourceCaches[h])throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===h)return this.fire(new v.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+g+'" is using it.')));var w=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],w.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),w.setEventedParent(null),w.clearTiles(),w.onRemove&&w.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(h,g){this._checkLoaded(),this.sourceCaches[h].getSource().setData(g),this._changed=!0},p.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},p.prototype.addLayer=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var D=h.id;if(this.getLayer(D))this.fire(new v.ErrorEvent(new Error('Layer with id "'+D+'" already exists on this map')));else{var T;if("custom"===h.type){if(Jl(this,v.validateCustomStyleLayer(h)))return;T=v.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(D,h.source),h=v.clone$1(h),h=v.extend(h,{source:D})),this._validate(v.validateStyle.layer,"layers."+D,h,{arrayIndex:-1},w))return;T=v.createStyleLayer(h),this._validateLayer(T),T.setEventedParent(this,{layer:{id:D}}),this._serializedLayers[T.id]=T.serialize()}var I=g?this._order.indexOf(g):this._order.length;if(g&&-1===I)this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(I,0,D),this._layerOrderChanged=!0,this._layers[D]=T,this._removedLayers[D]&&T.source&&"custom"!==T.type){var R=this._removedLayers[D];delete this._removedLayers[D],R.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},p.prototype.moveLayer=function(h,g){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==g){var w=this._order.indexOf(h);this._order.splice(w,1);var D=g?this._order.indexOf(g):this._order.length;g&&-1===D?this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(D,0,h),this._layerOrderChanged=!0)}}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(h){this._checkLoaded();var g=this._layers[h];if(g){g.setEventedParent(null);var w=this._order.indexOf(h);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=g,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],g.onRemove&&g.onRemove(this.map)}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(h){return this._layers[h]},p.prototype.hasLayer=function(h){return h in this._layers},p.prototype.setLayerZoomRange=function(h,g,w){this._checkLoaded();var D=this.getLayer(h);D?D.minzoom===g&&D.maxzoom===w||(null!=g&&(D.minzoom=g),null!=w&&(D.maxzoom=w),this._updateLayer(D)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var D=this.getLayer(h);if(D){if(!v.deepEqual(D.filter,g))return null==g?(D.filter=void 0,void this._updateLayer(D)):void(this._validate(v.validateStyle.filter,"layers."+D.id+".filter",g,null,w)||(D.filter=v.clone$1(g),this._updateLayer(D)))}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(h){return v.clone$1(this.getLayer(h).filter)},p.prototype.setLayoutProperty=function(h,g,w,D){void 0===D&&(D={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getLayoutProperty(g),w)||(T.setLayoutProperty(g,w,D),this._updateLayer(T)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(h,g){var w=this.getLayer(h);if(w)return w.getLayoutProperty(g);this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(h,g,w,D){void 0===D&&(D={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getPaintProperty(g),w)||(T.setPaintProperty(g,w,D)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(h,g){return this.getLayer(h).getPaintProperty(g)},p.prototype.setFeatureState=function(h,g){this._checkLoaded();var w=h.source,D=h.sourceLayer,T=this.sourceCaches[w];if(void 0!==T){var I=T.getSource().type;"geojson"===I&&D?this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==I||D?(void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(D,h.id,g)):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(h,g){this._checkLoaded();var w=h.source,D=this.sourceCaches[w];if(void 0!==D){var T=D.getSource().type,I="vector"===T?h.sourceLayer:void 0;"vector"!==T||I?g&&"string"!=typeof h.id&&"number"!=typeof h.id?this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):D.removeFeatureState(I,h.id,g):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(h){this._checkLoaded();var g=h.source,w=h.sourceLayer,D=this.sourceCaches[g];if(void 0!==D){if("vector"!==D.getSource().type||w)return void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),D.getFeatureState(w,h.id);this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return v.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:v.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return void 0!==h})},p.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&"raster"!==this.sourceCaches[h.source].getSource().type&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(h){for(var g=this,w=function(Qe){return"fill-extrusion"===g._layers[Qe].type},D={},T=[],I=this._order.length-1;I>=0;I--){var R=this._order[I];if(w(R)){D[R]=I;for(var F=0,W=h;F<W.length;F+=1){var Z=W[F][R];if(Z)for(var $=0,se=Z;$<se.length;$+=1)T.push(se[$])}}}T.sort(function(Qe,We){return We.intersectionZ-Qe.intersectionZ});for(var re=[],de=this._order.length-1;de>=0;de--){var ie=this._order[de];if(w(ie))for(var le=T.length-1;le>=0;le--){var _e=T[le].feature;if(D[_e.layer.id]<de)break;re.push(_e),T.pop()}else for(var we=0,Ae=h;we<Ae.length;we+=1){var De=Ae[we][ie];if(De)for(var Re=0,Ve=De;Re<Ve.length;Re+=1)re.push(Ve[Re].feature)}}return re},p.prototype.queryRenderedFeatures=function(h,g,w){g&&g.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var D={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,I=g.layers;T<I.length;T+=1){var R=I[T],F=this._layers[R];if(!F)return this.fire(new v.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be queried for features."))),[];D[F.source]=!0}}var W=[];for(var Z in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!D[Z]||W.push(ji(this.sourceCaches[Z],this._layers,this._serializedLayers,h,g,w));return this.placement&&W.push(function($,se,re,de,ie,le,_e){for(var we={},Ae=le.queryRenderedSymbols(de),De=[],Re=0,Ve=Object.keys(Ae).map(Number);Re<Ve.length;Re+=1)De.push(_e[Ve[Re]]);De.sort(pl);for(var Qe=function(){var It=ct[We],gn=It.featureIndex.lookupSymbolFeatures(Ae[It.bucketInstanceId],se,It.bucketIndex,It.sourceLayerIndex,ie.filter,ie.layers,ie.availableImages,$);for(var ft in gn){var Xt=we[ft]=we[ft]||[],hn=gn[ft];hn.sort(function(qt,jt){var Pt=It.featureSortOrder;if(Pt){var lr=Pt.indexOf(qt.featureIndex);return Pt.indexOf(jt.featureIndex)-lr}return jt.featureIndex-qt.featureIndex});for(var et=0,zt=hn;et<zt.length;et+=1)Xt.push(zt[et])}},We=0,ct=De;We<ct.length;We+=1)Qe();var Ct=function(It){we[It].forEach(function(gn){var ft=gn.feature,Xt=re[$[It].source].getFeatureState(ft.layer["source-layer"],ft.id);ft.source=ft.layer.source,ft.layer["source-layer"]&&(ft.sourceLayer=ft.layer["source-layer"]),ft.state=Xt})};for(var kt in we)Ct(kt);return we}(this._layers,this._serializedLayers,this.sourceCaches,h,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(W)},p.prototype.querySourceFeatures=function(h,g){g&&g.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var w=this.sourceCaches[h];return w?function(D,T){for(var I=D.getRenderableIds().map(function(se){return D.getTileByID(se)}),R=[],F={},W=0;W<I.length;W++){var Z=I[W],$=Z.tileID.canonical.key;F[$]||(F[$]=!0,Z.querySourceFeatures(R,T))}return R}(w,g):[]},p.prototype.addSourceType=function(h,g,w){return p.getSourceType(h)?w(new Error('A source type called "'+h+'" already exists.')):(p.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},w):w(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(h,g){void 0===g&&(g={}),this._checkLoaded();var w=this.light.getLight(),D=!1;for(var T in h)if(!v.deepEqual(h[T],w[T])){D=!0;break}if(D){var I={now:v.browser.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,g),this.light.updateTransitions(I)}},p.prototype._validate=function(h,g,w,D,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&Jl(this,h.call(v.validateStyle,v.extend({key:g,style:this.serialize(),value:w,styleSpec:v.styleSpec},D)))},p.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},p.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},p.prototype._updateSources=function(h){for(var g in this.sourceCaches)this.sourceCaches[g].update(h)},p.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},p.prototype._updatePlacement=function(h,g,w,D,T){void 0===T&&(T=!1);for(var I=!1,R=!1,F={},W=0,Z=this._order;W<Z.length;W+=1){var $=this._layers[Z[W]];if("symbol"===$.type){if(!F[$.source]){var se=this.sourceCaches[$.source];F[$.source]=se.getRenderableIds(!0).map(function(_e){return se.getTileByID(_e)}).sort(function(_e,we){return we.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(we.tileID)?-1:1)})}var re=this.crossTileSymbolIndex.addLayer($,F[$.source],h.center.lng);I=I||re}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===w)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.browser.now(),h.zoom))&&(this.pauseablePlacement=new Wc(h,this._order,T,g,w,D,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.browser.now()),R=!0),I&&this.pauseablePlacement.placement.setStale()),R||I)for(var de=0,ie=this._order;de<ie.length;de+=1){var le=this._layers[ie[de]];"symbol"===le.type&&this.placement.updateLayerOpacities(le,F[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},p.prototype.getImages=function(h,g,w){this.imageManager.getImages(g.icons,w),this._updateTilesForChangedImages();var D=this.sourceCaches[g.source];D&&D.setDependencies(g.tileID.key,g.type,g.icons)},p.prototype.getGlyphs=function(h,g,w){this.glyphManager.getGlyphs(g.stacks,w)},p.prototype.getResource=function(h,g,w){return v.makeRequest(g,w)},p}(v.Evented);tc.getSourceType=function(d){return fl[d]},tc.setSourceType=function(d,p){fl[d]=p},tc.registerForPluginStateChange=v.registerForPluginStateChange;var La=v.createLayout([{name:"a_pos",type:"Int16",components:2}]),mi=xr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Gp=xr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),nv=xr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),rv=xr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Lw=xr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$d=xr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),ff=xr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Wp=xr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Zp=xr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Kp=xr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),nc=xr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),qd=xr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Uu=xr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),us=xr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),pf=xr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),cn=xr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Fg=xr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),ai=xr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),lo=xr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Fa=xr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Ys=xr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),nn=xr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),In=xr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),zu=xr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),rc=xr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),mf=xr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function xr(d,p){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=p.match(/attribute ([\w]+) ([\w]+)/g),w=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=D?D.concat(w):w,I={};return{fragmentSource:d=d.replace(h,function(R,F,W,Z,$){return I[$]=!0,"define"===F?"\n#ifndef HAS_UNIFORM_u_"+$+"\nvarying "+W+" "+Z+" "+$+";\n#else\nuniform "+W+" "+Z+" u_"+$+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+$+"\n    "+W+" "+Z+" "+$+" = u_"+$+";\n#endif\n"}),vertexSource:p=p.replace(h,function(R,F,W,Z,$){var se="float"===Z?"vec2":"vec4",re=$.match(/color/)?"color":se;return I[$]?"define"===F?"\n#ifndef HAS_UNIFORM_u_"+$+"\nuniform lowp float u_"+$+"_t;\nattribute "+W+" "+se+" a_"+$+";\nvarying "+W+" "+Z+" "+$+";\n#else\nuniform "+W+" "+Z+" u_"+$+";\n#endif\n":"vec4"===re?"\n#ifndef HAS_UNIFORM_u_"+$+"\n    "+$+" = a_"+$+";\n#else\n    "+W+" "+Z+" "+$+" = u_"+$+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+$+"\n    "+$+" = unpack_mix_"+re+"(a_"+$+", u_"+$+"_t);\n#else\n    "+W+" "+Z+" "+$+" = u_"+$+";\n#endif\n":"define"===F?"\n#ifndef HAS_UNIFORM_u_"+$+"\nuniform lowp float u_"+$+"_t;\nattribute "+W+" "+se+" a_"+$+";\n#else\nuniform "+W+" "+Z+" u_"+$+";\n#endif\n":"vec4"===re?"\n#ifndef HAS_UNIFORM_u_"+$+"\n    "+W+" "+Z+" "+$+" = a_"+$+";\n#else\n    "+W+" "+Z+" "+$+" = u_"+$+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+$+"\n    "+W+" "+Z+" "+$+" = unpack_mix_"+re+"(a_"+$+", u_"+$+"_t);\n#else\n    "+W+" "+Z+" "+$+" = u_"+$+";\n#endif\n"}),staticAttributes:g,staticUniforms:T}}var Ba=Object.freeze({__proto__:null,prelude:mi,background:Gp,backgroundPattern:nv,circle:rv,clippingMask:Lw,heatmap:$d,heatmapTexture:ff,collisionBox:Wp,collisionCircle:Zp,debug:Kp,fill:nc,fillOutline:qd,fillOutlinePattern:Uu,fillPattern:us,fillExtrusion:pf,fillExtrusionPattern:cn,hillshadePrepare:Fg,hillshade:ai,line:lo,lineGradient:Fa,linePattern:Ys,lineSDF:nn,raster:In,symbolIcon:zu,symbolSDF:rc,symbolTextAndIcon:mf}),ju=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function iv(d){for(var p=[],h=0;h<d.length;h++)if(null!==d[h]){var g=d[h].split(" ");p.push(g.pop())}return p}ju.prototype.bind=function(d,p,h,g,w,D,T,I){this.context=d;for(var R=this.boundPaintVertexBuffers.length!==g.length,F=0;!R&&F<g.length;F++)this.boundPaintVertexBuffers[F]!==g[F]&&(R=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===h&&!R&&this.boundIndexBuffer===w&&this.boundVertexOffset===D&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===I?(d.bindVertexArrayOES.set(this.vao),T&&T.bind(),w&&w.dynamicDraw&&w.bind(),I&&I.bind()):this.freshBind(p,h,g,w,D,T,I)},ju.prototype.freshBind=function(d,p,h,g,w,D,T){var I,R=d.numAttributes,F=this.context,W=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=d,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=T;else{I=F.currentNumAttributes||0;for(var Z=R;Z<I;Z++)W.disableVertexAttribArray(Z)}p.enableAttributes(W,d);for(var $=0,se=h;$<se.length;$+=1)se[$].enableAttributes(W,d);D&&D.enableAttributes(W,d),T&&T.enableAttributes(W,d),p.bind(),p.setVertexAttribPointers(W,d,w);for(var re=0,de=h;re<de.length;re+=1){var ie=de[re];ie.bind(),ie.setVertexAttribPointers(W,d,w)}D&&(D.bind(),D.setVertexAttribPointers(W,d,w)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(W,d,w)),F.currentNumAttributes=R},ju.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ov=function(d,p,h,g,w,D){var T=d.gl;this.program=T.createProgram();for(var I=iv(h.staticAttributes),R=g?g.getBinderAttributes():[],F=I.concat(R),W=h.staticUniforms?iv(h.staticUniforms):[],Z=g?g.getBinderUniforms():[],$=[],se=0,re=W.concat(Z);se<re.length;se+=1){var de=re[se];$.indexOf(de)<0&&$.push(de)}var ie=g?g.defines():[];D&&ie.push("#define OVERDRAW_INSPECTOR;");var le=ie.concat(mi.fragmentSource,h.fragmentSource).join("\n"),_e=ie.concat(mi.vertexSource,h.vertexSource).join("\n"),we=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(we,le),T.compileShader(we),T.attachShader(this.program,we);var Ae=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ae,_e),T.compileShader(Ae),T.attachShader(this.program,Ae),this.attributes={};var De={};this.numAttributes=F.length;for(var Re=0;Re<this.numAttributes;Re++)F[Re]&&(T.bindAttribLocation(this.program,Re,F[Re]),this.attributes[F[Re]]=Re);T.linkProgram(this.program),T.deleteShader(Ae),T.deleteShader(we);for(var Ve=0;Ve<$.length;Ve++){var Qe=$[Ve];if(Qe&&!De[Qe]){var We=T.getUniformLocation(this.program,Qe);We&&(De[Qe]=We)}}this.fixedUniforms=w(d,De),this.binderUniforms=g?g.getUniforms(d,De):[]}}};function Bg(d,p,h){var g=1/ls(h,1,p.transform.tileZoom),w=Math.pow(2,h.tileID.overscaledZ),D=h.tileSize*Math.pow(2,p.transform.tileZoom)/w,T=D*(h.tileID.canonical.x+h.tileID.wrap*w),I=D*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[T>>16,I>>16],u_pixel_coord_lower:[65535&T,65535&I]}}ov.prototype.draw=function(d,p,h,g,w,D,T,I,R,F,W,Z,$,se,re,de){var ie,le=d.gl;if(!this.failedToCreate){for(var _e in d.program.set(this.program),d.setDepthMode(h),d.setStencilMode(g),d.setColorMode(w),d.setCullFace(D),this.fixedUniforms)this.fixedUniforms[_e].set(T[_e]);se&&se.setUniforms(d,this.binderUniforms,Z,{zoom:$});for(var we=(ie={},ie[le.LINES]=2,ie[le.TRIANGLES]=3,ie[le.LINE_STRIP]=1,ie)[p],Ae=0,De=W.get();Ae<De.length;Ae+=1){var Re=De[Ae],Ve=Re.vaos||(Re.vaos={});(Ve[I]||(Ve[I]=new ju)).bind(d,this,R,se?se.getPaintVertexBuffers():[],F,Re.vertexOffset,re,de),le.drawElements(p,Re.primitiveLength*we,le.UNSIGNED_SHORT,Re.primitiveOffset*we*2)}}};var gf=function(d,p,h,g){var w=p.style.light,D=w.properties.get("position"),T=[D.x,D.y,D.z],I=v.create$1();"viewport"===w.properties.get("anchor")&&v.fromRotation(I,-p.transform.angle),v.transformMat3(T,T,I);var R=w.properties.get("color");return{u_matrix:d,u_lightpos:T,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+h,u_opacity:g}},Fw=function(d,p,h,g,w,D,T){return v.extend(gf(d,p,h,g),Bg(D,p,T),{u_height_factor:-Math.pow(2,w.overscaledZ)/T.tileSize/8})},ic=function(d){return{u_matrix:d}},vl=function(d,p,h,g){return v.extend(ic(d),Bg(h,p,g))},Hu=function(d,p){return{u_matrix:d,u_world:p}},Vg=function(d,p,h,g,w){return v.extend(vl(d,p,h,g),{u_world:w})},_f=function(d,p,h,g){var w,D,T=d.transform;if("map"===g.paint.get("circle-pitch-alignment")){var I=ls(h,1,T.zoom);w=!0,D=[I,I]}else w=!1,D=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===g.paint.get("circle-pitch-scale")),u_matrix:d.translatePosMatrix(p.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:v.browser.devicePixelRatio,u_extrude_scale:D}},yf=function(d,p,h){var g=ls(h,1,p.zoom),w=Math.pow(2,p.zoom-h.tileID.overscaledZ),D=h.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[p.pixelsToGLUnits[0]/(g*w),p.pixelsToGLUnits[1]/(g*w)],u_overscale_factor:D}},Ii=function(d,p,h){return{u_matrix:d,u_inv_matrix:p,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},vf=function(d,p,h){return void 0===h&&(h=1),{u_matrix:d,u_color:p,u_overlay:0,u_overlay_scale:h}},$u=function(d){return{u_matrix:d}},Gd=function(d,p,h,g){return{u_matrix:d,u_extrude_scale:ls(p,1,h),u_intensity:g}},Va=function(d,p,h){var g=d.transform;return{u_matrix:Zc(d,p,h),u_ratio:1/ls(p,1,g.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Wd=function(d,p,h,g){return v.extend(Va(d,p,h),{u_image:0,u_image_height:g})},br=function(d,p,h,g){var w=d.transform,D=Tt(p,w);return{u_matrix:Zc(d,p,h),u_texsize:p.imageAtlasTexture.size,u_ratio:1/ls(p,1,w.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_image:0,u_scale:[D,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},bf=function(d,p,h,g,w){var D=d.lineAtlas,T=Tt(p,d.transform),I="round"===h.layout.get("line-cap"),R=D.getDash(g.from,I),F=D.getDash(g.to,I),W=R.width*w.fromScale,Z=F.width*w.toScale;return v.extend(Va(d,p,h),{u_patternscale_a:[T/W,-R.height/2],u_patternscale_b:[T/Z,-F.height/2],u_sdfgamma:D.width/(256*Math.min(W,Z)*v.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:F.y,u_mix:w.t})};function Tt(d,p){return 1/ls(d,1,p.tileZoom)}function Zc(d,p,h){return d.translatePosMatrix(p.tileID.posMatrix,p,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var Q=function(d,p,h,g,w){return{u_matrix:d,u_tl_parent:p,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(T=w.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(D=w.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Zd(w.paint.get("raster-hue-rotate"))};var D,T};function Zd(d){d*=Math.PI/180;var p=Math.sin(d),h=Math.cos(d);return[(2*h+1)/3,(-Math.sqrt(3)*p-h+1)/3,(Math.sqrt(3)*p-h+1)/3]}var Kd,wf=function(d,p,h,g,w,D,T,I,R,F){var W=w.transform;return{u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:W.cameraToCenterDistance,u_pitch:W.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:W.width/W.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:T,u_coord_matrix:I,u_is_text:+R,u_pitch_with_map:+g,u_texsize:F,u_texture:0}},Ua=function(d,p,h,g,w,D,T,I,R,F,W){var Z=w.transform;return v.extend(wf(d,p,h,g,w,D,T,I,R,F),{u_gamma_scale:g?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:v.browser.devicePixelRatio,u_is_halo:+W})},xf=function(d,p,h,g,w,D,T,I,R,F){return v.extend(Ua(d,p,h,g,w,D,T,I,!0,R,!0),{u_texsize_icon:F,u_texture_icon:1})},za=function(d,p,h){return{u_matrix:d,u_opacity:p,u_color:h}},Yd=function(d,p,h,g,w,D){return v.extend((I=D,F=w,W=(R=h).imageManager.getPattern((T=g).from.toString()),Z=R.imageManager.getPattern(T.to.toString()),se=($=R.imageManager.getPixelSize()).width,re=$.height,de=Math.pow(2,F.tileID.overscaledZ),le=(ie=F.tileSize*Math.pow(2,R.transform.tileZoom)/de)*(F.tileID.canonical.x+F.tileID.wrap*de),_e=ie*F.tileID.canonical.y,{u_image:0,u_pattern_tl_a:W.tl,u_pattern_br_a:W.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[se,re],u_mix:I.t,u_pattern_size_a:W.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/ls(F,1,R.transform.tileZoom),u_pixel_coord_upper:[le>>16,_e>>16],u_pixel_coord_lower:[65535&le,65535&_e]}),{u_matrix:d,u_opacity:p});var T,I,R,F,W,Z,$,se,re,de,ie,le,_e},vo={fillExtrusion:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_lightpos:new v.Uniform3f(d,p.u_lightpos),u_lightintensity:new v.Uniform1f(d,p.u_lightintensity),u_lightcolor:new v.Uniform3f(d,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,p.u_vertical_gradient),u_opacity:new v.Uniform1f(d,p.u_opacity)}},fillExtrusionPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_lightpos:new v.Uniform3f(d,p.u_lightpos),u_lightintensity:new v.Uniform1f(d,p.u_lightintensity),u_lightcolor:new v.Uniform3f(d,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,p.u_vertical_gradient),u_height_factor:new v.Uniform1f(d,p.u_height_factor),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade),u_opacity:new v.Uniform1f(d,p.u_opacity)}},fill:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},fillPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},fillOutline:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world)}},fillOutlinePattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},circle:function(d,p){return{u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_scale_with_map:new v.Uniform1i(d,p.u_scale_with_map),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_extrude_scale:new v.Uniform2f(d,p.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},collisionBox:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pixels_to_tile_units:new v.Uniform1f(d,p.u_pixels_to_tile_units),u_extrude_scale:new v.Uniform2f(d,p.u_extrude_scale),u_overscale_factor:new v.Uniform1f(d,p.u_overscale_factor)}},collisionCircle:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_inv_matrix:new v.UniformMatrix4f(d,p.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(d,p.u_viewport_size)}},debug:function(d,p){return{u_color:new v.UniformColor(d,p.u_color),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_overlay:new v.Uniform1i(d,p.u_overlay),u_overlay_scale:new v.Uniform1f(d,p.u_overlay_scale)}},clippingMask:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},heatmap:function(d,p){return{u_extrude_scale:new v.Uniform1f(d,p.u_extrude_scale),u_intensity:new v.Uniform1f(d,p.u_intensity),u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},heatmapTexture:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world),u_image:new v.Uniform1i(d,p.u_image),u_color_ramp:new v.Uniform1i(d,p.u_color_ramp),u_opacity:new v.Uniform1f(d,p.u_opacity)}},hillshade:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_latrange:new v.Uniform2f(d,p.u_latrange),u_light:new v.Uniform2f(d,p.u_light),u_shadow:new v.UniformColor(d,p.u_shadow),u_highlight:new v.UniformColor(d,p.u_highlight),u_accent:new v.UniformColor(d,p.u_accent)}},hillshadePrepare:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_dimension:new v.Uniform2f(d,p.u_dimension),u_zoom:new v.Uniform1f(d,p.u_zoom),u_unpack:new v.Uniform4f(d,p.u_unpack)}},line:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels)}},lineGradient:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_image:new v.Uniform1i(d,p.u_image),u_image_height:new v.Uniform1f(d,p.u_image_height)}},linePattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_texsize:new v.Uniform2f(d,p.u_texsize),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_image:new v.Uniform1i(d,p.u_image),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},lineSDF:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_patternscale_a:new v.Uniform2f(d,p.u_patternscale_a),u_patternscale_b:new v.Uniform2f(d,p.u_patternscale_b),u_sdfgamma:new v.Uniform1f(d,p.u_sdfgamma),u_image:new v.Uniform1i(d,p.u_image),u_tex_y_a:new v.Uniform1f(d,p.u_tex_y_a),u_tex_y_b:new v.Uniform1f(d,p.u_tex_y_b),u_mix:new v.Uniform1f(d,p.u_mix)}},raster:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_tl_parent:new v.Uniform2f(d,p.u_tl_parent),u_scale_parent:new v.Uniform1f(d,p.u_scale_parent),u_buffer_scale:new v.Uniform1f(d,p.u_buffer_scale),u_fade_t:new v.Uniform1f(d,p.u_fade_t),u_opacity:new v.Uniform1f(d,p.u_opacity),u_image0:new v.Uniform1i(d,p.u_image0),u_image1:new v.Uniform1i(d,p.u_image1),u_brightness_low:new v.Uniform1f(d,p.u_brightness_low),u_brightness_high:new v.Uniform1f(d,p.u_brightness_high),u_saturation_factor:new v.Uniform1f(d,p.u_saturation_factor),u_contrast_factor:new v.Uniform1f(d,p.u_contrast_factor),u_spin_weights:new v.Uniform3f(d,p.u_spin_weights)}},symbolIcon:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texture:new v.Uniform1i(d,p.u_texture)}},symbolSDF:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texture:new v.Uniform1i(d,p.u_texture),u_gamma_scale:new v.Uniform1f(d,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,p.u_is_halo)}},symbolTextAndIcon:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texsize_icon:new v.Uniform2f(d,p.u_texsize_icon),u_texture:new v.Uniform1i(d,p.u_texture),u_texture_icon:new v.Uniform1i(d,p.u_texture_icon),u_gamma_scale:new v.Uniform1f(d,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,p.u_is_halo)}},background:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_opacity:new v.Uniform1f(d,p.u_opacity),u_color:new v.UniformColor(d,p.u_color)}},backgroundPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_opacity:new v.Uniform1f(d,p.u_opacity),u_image:new v.Uniform1i(d,p.u_image),u_pattern_tl_a:new v.Uniform2f(d,p.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(d,p.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(d,p.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(d,p.u_pattern_br_b),u_texsize:new v.Uniform2f(d,p.u_texsize),u_mix:new v.Uniform1f(d,p.u_mix),u_pattern_size_a:new v.Uniform2f(d,p.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(d,p.u_pattern_size_b),u_scale_a:new v.Uniform1f(d,p.u_scale_a),u_scale_b:new v.Uniform1f(d,p.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(d,p.u_tile_units_to_pixels)}}};function oc(d,p,h,g,w,D,T){for(var I=d.context,R=I.gl,F=d.useProgram("collisionBox"),W=[],Z=0,$=0,se=0;se<g.length;se++){var re=g[se],de=p.getTile(re),ie=de.getBucket(h);if(ie){var le=re.posMatrix;0===w[0]&&0===w[1]||(le=d.translatePosMatrix(re.posMatrix,de,w,D));var _e=T?ie.textCollisionBox:ie.iconCollisionBox,we=ie.collisionCircleArray;if(we.length>0){var Ae=v.create(),De=le;v.mul(Ae,ie.placementInvProjMatrix,d.transform.glCoordMatrix),v.mul(Ae,Ae,ie.placementViewportMatrix),W.push({circleArray:we,circleOffset:$,transform:De,invTransform:Ae}),$=Z+=we.length/4}_e&&F.draw(I,R.LINES,K.disabled,oe.disabled,d.colorModeForRenderPass(),ye.disabled,yf(le,d.transform,de),h.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,null,d.transform.zoom,null,null,_e.collisionVertexBuffer)}}if(T&&W.length){var Re=d.useProgram("collisionCircle"),Ve=new v.StructArrayLayout2f1f2i16;Ve.resize(4*Z),Ve._trim();for(var Qe=0,We=0,ct=W;We<ct.length;We+=1)for(var Ct=ct[We],kt=0;kt<Ct.circleArray.length/4;kt++){var It=4*kt,gn=Ct.circleArray[It+0],ft=Ct.circleArray[It+1],Xt=Ct.circleArray[It+2],hn=Ct.circleArray[It+3];Ve.emplace(Qe++,gn,ft,Xt,hn,0),Ve.emplace(Qe++,gn,ft,Xt,hn,1),Ve.emplace(Qe++,gn,ft,Xt,hn,2),Ve.emplace(Qe++,gn,ft,Xt,hn,3)}(!Kd||Kd.length<2*Z)&&(Kd=function(qr){var ho=2*qr,vi=new v.StructArrayLayout3ui6;vi.resize(ho),vi._trim();for(var bi=0;bi<ho;bi++){var ei=6*bi;vi.uint16[ei+0]=4*bi+0,vi.uint16[ei+1]=4*bi+1,vi.uint16[ei+2]=4*bi+2,vi.uint16[ei+3]=4*bi+2,vi.uint16[ei+4]=4*bi+3,vi.uint16[ei+5]=4*bi+0}return vi}(Z));for(var et=I.createIndexBuffer(Kd,!0),zt=I.createVertexBuffer(Ve,v.collisionCircleLayout.members,!0),qt=0,jt=W;qt<jt.length;qt+=1){var Pt=jt[qt],lr=Ii(Pt.transform,Pt.invTransform,d.transform);Re.draw(I,R.TRIANGLES,K.disabled,oe.disabled,d.colorModeForRenderPass(),ye.disabled,lr,h.id,zt,et,v.SegmentVector.simpleSegment(0,2*Pt.circleOffset,Pt.circleArray.length,Pt.circleArray.length/2),null,d.transform.zoom,null,null,null)}zt.destroy(),et.destroy()}}var qu=v.identity(new Float32Array(16));function ds(d,p,h,g,w,D){var T=v.getAnchorAlignment(d),I=-(T.horizontalAlign-.5)*p,R=-(T.verticalAlign-.5)*h,F=v.evaluateVariableOffset(d,g);return new v.Point((I/w+F[0])*D,(R/w+F[1])*D)}function Xd(d,p,h,g,w,D,T,I,R,F,W){var Z=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,se=d.icon.dynamicLayoutVertexArray,re={};$.clear();for(var de=0;de<Z.length;de++){var ie=Z.get(de),le=ie.hidden||!ie.crossTileID||d.allowVerticalPlacement&&!ie.placedOrientation?null:g[ie.crossTileID];if(le){var _e=new v.Point(ie.anchorX,ie.anchorY),we=mn(_e,h?I:T),Ae=Hd(D.cameraToCenterDistance,we.signedDistanceFromCamera),De=w.evaluateSizeForFeature(d.textSizeData,F,ie)*Ae/v.ONE_EM;h&&(De*=d.tilePixelRatio/R);for(var Re=ds(le.anchor,le.width,le.height,le.textOffset,le.textBoxScale,De),Ve=h?mn(_e.add(Re),T).point:we.point.add(p?Re.rotate(-D.angle):Re),Qe=d.allowVerticalPlacement&&ie.placedOrientation===v.WritingMode.vertical?Math.PI/2:0,We=0;We<ie.numGlyphs;We++)v.addDynamicAttributes($,Ve,Qe);W&&ie.associatedIconIndex>=0&&(re[ie.associatedIconIndex]={shiftedAnchor:Ve,angle:Qe})}else Bo(ie.numGlyphs,$)}if(W){se.clear();for(var ct=d.icon.placedSymbolArray,Ct=0;Ct<ct.length;Ct++){var kt=ct.get(Ct);if(kt.hidden)Bo(kt.numGlyphs,se);else{var It=re[Ct];if(It)for(var gn=0;gn<kt.numGlyphs;gn++)v.addDynamicAttributes(se,It.shiftedAnchor,It.angle);else Bo(kt.numGlyphs,se)}}d.icon.dynamicLayoutVertexBuffer.updateData(se)}d.text.dynamicLayoutVertexBuffer.updateData($)}function Yp(d,p,h){return h.iconsInText&&p?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function Ef(d,p,h,g,w,D,T,I,R,F,W,Z){for(var $=d.context,se=$.gl,re=d.transform,de="map"===I,ie="map"===R,le=de&&"point"!==h.layout.get("symbol-placement"),_e=de&&!ie&&!le,we=!h.layout.get("symbol-sort-key").isConstant(),Ae=!1,De=d.depthModeForSublayer(0,K.ReadOnly),Re=h.layout.get("text-variable-anchor"),Ve=[],Qe=0,We=g;Qe<We.length;Qe+=1){var ct=We[Qe],Ct=p.getTile(ct),kt=Ct.getBucket(h);if(kt){var It=w?kt.text:kt.icon;if(It&&It.segments.get().length){var gn=It.programConfigurations.get(h.id),ft=w||kt.sdfIcons,Xt=w?kt.textSizeData:kt.iconSizeData,hn=ie||0!==re.pitch,et=d.useProgram(Yp(ft,w,kt),gn),zt=v.evaluateSizeForZoom(Xt,re.zoom),qt=void 0,jt=[0,0],Pt=void 0,lr=void 0,qr=null,ho=void 0;if(w)Pt=Ct.glyphAtlasTexture,lr=se.LINEAR,qt=Ct.glyphAtlasTexture.size,kt.iconsInText&&(jt=Ct.imageAtlasTexture.size,qr=Ct.imageAtlasTexture,ho=hn||d.options.rotating||d.options.zooming||"composite"===Xt.kind||"camera"===Xt.kind?se.LINEAR:se.NEAREST);else{var vi=1!==h.layout.get("icon-size").constantOr(0)||kt.iconsNeedLinear;Pt=Ct.imageAtlasTexture,lr=ft||d.options.rotating||d.options.zooming||vi||hn?se.LINEAR:se.NEAREST,qt=Ct.imageAtlasTexture.size}var bi=ls(Ct,1,d.transform.zoom),ei=Br(ct.posMatrix,ie,de,d.transform,bi),Uo=En(ct.posMatrix,ie,de,d.transform,bi),qa=Re&&kt.hasTextData(),Co="none"!==h.layout.get("icon-text-fit")&&qa&&kt.hasIconData();le&&Jn(kt,ct.posMatrix,d,w,ei,Uo,ie,F);var Le=d.translatePosMatrix(ct.posMatrix,Ct,D,T),$t=le||w&&Re||Co?qu:ei,Me=d.translatePosMatrix(Uo,Ct,D,T,!0),Oe=ft&&0!==h.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1),Qt={program:et,buffers:It,uniformValues:ft?kt.iconsInText?xf(Xt.kind,zt,_e,ie,d,Le,$t,Me,qt,jt):Ua(Xt.kind,zt,_e,ie,d,Le,$t,Me,w,qt,!0):wf(Xt.kind,zt,_e,ie,d,Le,$t,Me,w,qt),atlasTexture:Pt,atlasTextureIcon:qr,atlasInterpolation:lr,atlasInterpolationIcon:ho,isSDF:ft,hasHalo:Oe};if(we&&kt.canOverlap){Ae=!0;for(var Qc=0,pa=It.segments.get();Qc<pa.length;Qc+=1){var Us=pa[Qc];Ve.push({segments:new v.SegmentVector([Us]),sortKey:Us.sortKey,state:Qt})}}else Ve.push({segments:It.segments,sortKey:0,state:Qt})}}}Ae&&Ve.sort(function(ea,dc){return ea.sortKey-dc.sortKey});for(var Jc=0,ma=Ve;Jc<ma.length;Jc+=1){var eu=ma[Jc],Mi=eu.state;if($.activeTexture.set(se.TEXTURE0),Mi.atlasTexture.bind(Mi.atlasInterpolation,se.CLAMP_TO_EDGE),Mi.atlasTextureIcon&&($.activeTexture.set(se.TEXTURE1),Mi.atlasTextureIcon&&Mi.atlasTextureIcon.bind(Mi.atlasInterpolationIcon,se.CLAMP_TO_EDGE)),Mi.isSDF){var uc=Mi.uniformValues;Mi.hasHalo&&(uc.u_is_halo=1,ja(Mi.buffers,eu.segments,h,d,Mi.program,De,W,Z,uc)),uc.u_is_halo=0}ja(Mi.buffers,eu.segments,h,d,Mi.program,De,W,Z,Mi.uniformValues)}}function ja(d,p,h,g,w,D,T,I,R){var F=g.context;w.draw(F,F.gl.TRIANGLES,D,T,I,ye.disabled,R,h.id,d.layoutVertexBuffer,d.indexBuffer,p,h.paint,g.transform.zoom,d.programConfigurations.get(h.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Kc(d,p,h,g,w,D,T){var I,R,F,W,Z,$=d.context.gl,se=h.paint.get("fill-pattern"),re=se&&se.constantOr(1),de=h.getCrossfadeParameters();T?(R=re&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=$.LINES):(R=re?"fillPattern":"fill",I=$.TRIANGLES);for(var ie=0,le=g;ie<le.length;ie+=1){var _e=le[ie],we=p.getTile(_e);if(!re||we.patternsLoaded()){var Ae=we.getBucket(h);if(Ae){var De=Ae.programConfigurations.get(h.id),Re=d.useProgram(R,De);re&&(d.context.activeTexture.set($.TEXTURE0),we.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),De.updatePaintBuffers(de));var Ve=se.constantOr(null);if(Ve&&we.imageAtlas){var Qe=we.imageAtlas,We=Qe.patternPositions[Ve.to.toString()],ct=Qe.patternPositions[Ve.from.toString()];We&&ct&&De.setConstantPatternPositions(We,ct)}var Ct=d.translatePosMatrix(_e.posMatrix,we,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(T){W=Ae.indexBuffer2,Z=Ae.segments2;var kt=[$.drawingBufferWidth,$.drawingBufferHeight];F="fillOutlinePattern"===R&&re?Vg(Ct,d,de,we,kt):Hu(Ct,kt)}else W=Ae.indexBuffer,Z=Ae.segments,F=re?vl(Ct,d,de,we):ic(Ct);Re.draw(d.context,I,w,d.stencilModeForClipping(_e),D,ye.disabled,F,h.id,Ae.layoutVertexBuffer,W,Z,h.paint,d.transform.zoom,De)}}}}function bl(d,p,h,g,w,D,T){for(var I=d.context,R=I.gl,F=h.paint.get("fill-extrusion-pattern"),W=F.constantOr(1),Z=h.getCrossfadeParameters(),$=h.paint.get("fill-extrusion-opacity"),se=0,re=g;se<re.length;se+=1){var de=re[se],ie=p.getTile(de),le=ie.getBucket(h);if(le){var _e=le.programConfigurations.get(h.id),we=d.useProgram(W?"fillExtrusionPattern":"fillExtrusion",_e);W&&(d.context.activeTexture.set(R.TEXTURE0),ie.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),_e.updatePaintBuffers(Z));var Ae=F.constantOr(null);if(Ae&&ie.imageAtlas){var De=ie.imageAtlas,Re=De.patternPositions[Ae.to.toString()],Ve=De.patternPositions[Ae.from.toString()];Re&&Ve&&_e.setConstantPatternPositions(Re,Ve)}var Qe=d.translatePosMatrix(de.posMatrix,ie,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),We=h.paint.get("fill-extrusion-vertical-gradient"),ct=W?Fw(Qe,d,We,$,de,Z,ie):gf(Qe,d,We,$);we.draw(I,I.gl.TRIANGLES,w,D,T,ye.backCCW,ct,h.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,h.paint,d.transform.zoom,_e)}}}function sv(d,p,h,g,w,D){var T=d.context,I=T.gl,R=p.fbo;if(R){var F=d.useProgram("hillshade");T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get());var W=function(Z,$,se){var re=se.paint.get("hillshade-shadow-color"),de=se.paint.get("hillshade-highlight-color"),ie=se.paint.get("hillshade-accent-color"),le=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===se.paint.get("hillshade-illumination-anchor")&&(le-=Z.transform.angle);var _e,we,Ae,De=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix($.tileID.toUnwrapped(),De),u_image:0,u_latrange:(_e=$.tileID,we=Math.pow(2,_e.canonical.z),Ae=_e.canonical.y,[new v.MercatorCoordinate(0,Ae/we).toLngLat().lat,new v.MercatorCoordinate(0,(Ae+1)/we).toLngLat().lat]),u_light:[se.paint.get("hillshade-exaggeration"),le],u_shadow:re,u_highlight:de,u_accent:ie}}(d,p,h);F.draw(T,I.TRIANGLES,g,w,D,ye.disabled,W,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function Ls(d,p,h,g,w,D){var de,ie,le,_e,T=d.context,I=T.gl,R=p.dem;if(R&&R.data){var F=R.dim,W=R.stride,Z=R.getPixels();if(T.activeTexture.set(I.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||d.getTileTexture(W),p.demTexture){var $=p.demTexture;$.update(Z,{premultiply:!1}),$.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else p.demTexture=new v.Texture(T,Z,I.RGBA,{premultiply:!1}),p.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);T.activeTexture.set(I.TEXTURE0);var se=p.fbo;if(!se){var re=new v.Texture(T,{width:F,height:F,data:null},I.RGBA);re.bind(I.LINEAR,I.CLAMP_TO_EDGE),(se=p.fbo=T.createFramebuffer(F,F,!0)).colorAttachment.set(re.texture)}T.bindFramebuffer.set(se.framebuffer),T.viewport.set([0,0,F,F]),d.useProgram("hillshadePrepare").draw(T,I.TRIANGLES,g,w,D,ye.disabled,(de=p.tileID,le=(ie=R).stride,_e=v.create(),v.ortho(_e,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(_e,_e,[0,-v.EXTENT,0]),{u_matrix:_e,u_image:1,u_dimension:[le,le],u_zoom:de.overscaledZ,u_unpack:ie.getUnpackVector()}),h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function Pr(d,p,h,g,w){var D=g.paint.get("raster-fade-duration");if(D>0){var T=v.browser.now(),I=(T-d.timeAdded)/D,R=p?(T-p.timeAdded)/D:-1,F=h.getSource(),W=w.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),Z=!p||Math.abs(p.tileID.overscaledZ-W)>Math.abs(d.tileID.overscaledZ-W),$=Z&&d.refreshedUponExpiration?1:v.clamp(Z?I:1-R,0,1);return d.refreshedUponExpiration&&I>=1&&(d.refreshedUponExpiration=!1),p?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}var Xs=new v.Color(1,0,0,1),Cf=new v.Color(0,1,0,1),Df=new v.Color(0,0,1,1),Qd=new v.Color(1,0,1,1),Ha=new v.Color(0,1,1,1);function Tf(d,p,h,g){Yc(d,0,p+h/2,d.transform.width,h,g)}function Sf(d,p,h,g){Yc(d,p-h/2,0,h,d.transform.height,g)}function Yc(d,p,h,g,w,D){var T=d.context,I=T.gl;I.enable(I.SCISSOR_TEST),I.scissor(p*v.browser.devicePixelRatio,h*v.browser.devicePixelRatio,g*v.browser.devicePixelRatio,w*v.browser.devicePixelRatio),T.clear({color:D}),I.disable(I.SCISSOR_TEST)}function Xp(d,p,h){var g=d.context,w=g.gl,D=h.posMatrix,T=d.useProgram("debug"),I=K.disabled,R=oe.disabled,F=d.colorModeForRenderPass();g.activeTexture.set(w.TEXTURE0),d.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T.draw(g,w.LINE_STRIP,I,R,F,ye.disabled,vf(D,v.Color.red),"$debug",d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments);var W=p.getTileByID(h.key).latestRawTileData,Z=Math.floor((W&&W.byteLength||0)/1024),$=p.getTile(h).tileSize,se=512/Math.min($,512)*(h.overscaledZ/d.transform.zoom)*.5,re=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(re+=" => "+h.overscaledZ),function(de,ie){de.initDebugOverlayCanvas();var le=de.debugOverlayCanvas,_e=de.context.gl,we=de.debugOverlayCanvas.getContext("2d");we.clearRect(0,0,le.width,le.height),we.shadowColor="white",we.shadowBlur=2,we.lineWidth=1.5,we.strokeStyle="white",we.textBaseline="top",we.font="bold 36px Open Sans, sans-serif",we.fillText(ie,5,5),we.strokeText(ie,5,5),de.debugOverlayTexture.update(le),de.debugOverlayTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE)}(d,re+" "+Z+"kb"),T.draw(g,w.TRIANGLES,I,R,me.alphaBlended,ye.disabled,vf(D,v.Color.transparent,se),"$debug",d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}var Gu={symbol:function(d,p,h,g,w){if("translucent"===d.renderPass){var D=oe.disabled,T=d.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,R,F,W,Z,$,se){for(var re=R.transform,de="map"===Z,ie="map"===$,le=0,_e=I;le<_e.length;le+=1){var we=_e[le],Ae=W.getTile(we),De=Ae.getBucket(F);if(De&&De.text&&De.text.segments.get().length){var Re=v.evaluateSizeForZoom(De.textSizeData,re.zoom),Ve=ls(Ae,1,R.transform.zoom),Qe=Br(we.posMatrix,ie,de,R.transform,Ve),We="none"!==F.layout.get("icon-text-fit")&&De.hasIconData();if(Re){var ct=Math.pow(2,re.zoom-Ae.tileID.overscaledZ);Xd(De,de,ie,se,v.symbolSize,re,Qe,we.posMatrix,ct,Re,We)}}}}(g,d,h,p,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w),0!==h.paint.get("icon-opacity").constantOr(1)&&Ef(d,p,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),D,T),0!==h.paint.get("text-opacity").constantOr(1)&&Ef(d,p,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),D,T),p.map.showCollisionBoxes&&(oc(d,p,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),oc(d,p,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(d,p,h,g){if("translucent"===d.renderPass){var w=h.paint.get("circle-opacity"),D=h.paint.get("circle-stroke-width"),T=h.paint.get("circle-stroke-opacity"),I=!h.layout.get("circle-sort-key").isConstant();if(0!==w.constantOr(1)||0!==D.constantOr(1)&&0!==T.constantOr(1)){for(var R=d.context,F=R.gl,W=d.depthModeForSublayer(0,K.ReadOnly),Z=oe.disabled,$=d.colorModeForRenderPass(),se=[],re=0;re<g.length;re++){var de=g[re],ie=p.getTile(de),le=ie.getBucket(h);if(le){var _e=le.programConfigurations.get(h.id),we={programConfiguration:_e,program:d.useProgram("circle",_e),layoutVertexBuffer:le.layoutVertexBuffer,indexBuffer:le.indexBuffer,uniformValues:_f(d,de,ie,h)};if(I)for(var Ae=0,De=le.segments.get();Ae<De.length;Ae+=1){var Re=De[Ae];se.push({segments:new v.SegmentVector([Re]),sortKey:Re.sortKey,state:we})}else se.push({segments:le.segments,sortKey:0,state:we})}}I&&se.sort(function(Ct,kt){return Ct.sortKey-kt.sortKey});for(var Ve=0,Qe=se;Ve<Qe.length;Ve+=1){var We=Qe[Ve],ct=We.state;ct.program.draw(R,F.TRIANGLES,W,Z,$,ye.disabled,ct.uniformValues,h.id,ct.layoutVertexBuffer,ct.indexBuffer,We.segments,h.paint,d.transform.zoom,ct.programConfiguration)}}}},heatmap:function(d,p,h,g){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){var w=d.context,D=w.gl,T=oe.disabled,I=new me([D.ONE,D.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(se,re,de){var ie=se.gl;se.activeTexture.set(ie.TEXTURE1),se.viewport.set([0,0,re.width/4,re.height/4]);var we,Ae,De,Re,Ve,le=de.heatmapFbo;if(le)ie.bindTexture(ie.TEXTURE_2D,le.colorAttachment.get()),se.bindFramebuffer.set(le.framebuffer);else{var _e=ie.createTexture();ie.bindTexture(ie.TEXTURE_2D,_e),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,ie.LINEAR),De=_e,Re=le=de.heatmapFbo=se.createFramebuffer(re.width/4,re.height/4,!1),(Ve=(we=se).gl).texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,(Ae=re).width/4,Ae.height/4,0,Ve.RGBA,we.extRenderToTextureHalfFloat?we.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),Re.colorAttachment.set(De)}})(w,d,h),w.clear({color:v.Color.transparent});for(var R=0;R<g.length;R++){var F=g[R];if(!p.hasRenderableParent(F)){var W=p.getTile(F),Z=W.getBucket(h);if(Z){var $=Z.programConfigurations.get(h.id);d.useProgram("heatmap",$).draw(w,D.TRIANGLES,K.disabled,T,I,ye.disabled,Gd(F.posMatrix,W,d.transform.zoom,h.paint.get("heatmap-intensity")),h.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,h.paint,d.transform.zoom,$)}}}w.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(se,re){var de=se.context,ie=de.gl,le=re.heatmapFbo;if(le){de.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,le.colorAttachment.get()),de.activeTexture.set(ie.TEXTURE1);var _e=re.colorRampTexture;_e||(_e=re.colorRampTexture=new v.Texture(de,re.colorRamp,ie.RGBA)),_e.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),se.useProgram("heatmapTexture").draw(de,ie.TRIANGLES,K.disabled,oe.disabled,se.colorModeForRenderPass(),ye.disabled,function(we,Ae){var Ve=v.create();v.ortho(Ve,0,we.width,we.height,0,0,1);var Qe=we.context.gl;return{u_matrix:Ve,u_world:[Qe.drawingBufferWidth,Qe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ae.paint.get("heatmap-opacity")}}(se,re),re.id,se.viewportBuffer,se.quadTriangleIndexBuffer,se.viewportSegments,re.paint,se.transform.zoom)}}(d,h))},line:function(d,p,h,g){if("translucent"===d.renderPass){var w=h.paint.get("line-opacity"),D=h.paint.get("line-width");if(0!==w.constantOr(1)&&0!==D.constantOr(1))for(var T=d.depthModeForSublayer(0,K.ReadOnly),I=d.colorModeForRenderPass(),R=h.paint.get("line-dasharray"),F=h.paint.get("line-pattern"),W=F.constantOr(1),Z=h.paint.get("line-gradient"),$=h.getCrossfadeParameters(),se=W?"linePattern":R?"lineSDF":Z?"lineGradient":"line",re=d.context,de=re.gl,ie=!0,le=0,_e=g;le<_e.length;le+=1){var we=_e[le],Ae=p.getTile(we);if(!W||Ae.patternsLoaded()){var De=Ae.getBucket(h);if(De){var Re=De.programConfigurations.get(h.id),Ve=d.context.program.get(),Qe=d.useProgram(se,Re),We=ie||Qe.program!==Ve,ct=F.constantOr(null);if(ct&&Ae.imageAtlas){var Ct=Ae.imageAtlas,kt=Ct.patternPositions[ct.to.toString()],It=Ct.patternPositions[ct.from.toString()];kt&&It&&Re.setConstantPatternPositions(kt,It)}var gn=W?br(d,Ae,h,$):R?bf(d,Ae,h,R,$):Z?Wd(d,Ae,h,De.lineClipsArray.length):Va(d,Ae,h);if(W)re.activeTexture.set(de.TEXTURE0),Ae.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Re.updatePaintBuffers($);else if(R&&(We||d.lineAtlas.dirty))re.activeTexture.set(de.TEXTURE0),d.lineAtlas.bind(re);else if(Z){var ft=De.gradients[h.id],Xt=ft.texture;if(h.gradientVersion!==ft.version){var hn=256;if(h.stepInterpolant){var et=p.getSource().maxzoom,zt=we.canonical.z===et?Math.ceil(1<<d.transform.maxZoom-we.canonical.z):1;hn=v.clamp(v.nextPowerOfTwo(De.maxLineLength/v.EXTENT*1024*zt),256,re.maxTextureSize)}ft.gradient=v.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:hn,image:ft.gradient||void 0,clips:De.lineClipsArray}),ft.texture?ft.texture.update(ft.gradient):ft.texture=new v.Texture(re,ft.gradient,de.RGBA),ft.version=h.gradientVersion,Xt=ft.texture}re.activeTexture.set(de.TEXTURE0),Xt.bind(h.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}Qe.draw(re,de.TRIANGLES,T,d.stencilModeForClipping(we),I,ye.disabled,gn,h.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,h.paint,d.transform.zoom,Re,De.layoutVertexBuffer2),ie=!1}}}}},fill:function(d,p,h,g){var w=h.paint.get("fill-color"),D=h.paint.get("fill-opacity");if(0!==D.constantOr(1)){var T=d.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),R=d.opaquePassEnabledForLayer()&&!I.constantOr(1)&&1===w.constantOr(v.Color.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(d.renderPass===R){var F=d.depthModeForSublayer(1,"opaque"===d.renderPass?K.ReadWrite:K.ReadOnly);Kc(d,p,h,g,F,T,!1)}if("translucent"===d.renderPass&&h.paint.get("fill-antialias")){var W=d.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);Kc(d,p,h,g,W,T,!0)}}},"fill-extrusion":function(d,p,h,g){var w=h.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===d.renderPass){var D=new K(d.context.gl.LEQUAL,K.ReadWrite,d.depthRangeFor3D);if(1!==w||h.paint.get("fill-extrusion-pattern").constantOr(1))bl(d,p,h,g,D,oe.disabled,me.disabled),bl(d,p,h,g,D,d.stencilModeFor3D(),d.colorModeForRenderPass());else{var T=d.colorModeForRenderPass();bl(d,p,h,g,D,oe.disabled,T)}}},hillshade:function(d,p,h,g){if("offscreen"===d.renderPass||"translucent"===d.renderPass){for(var w=d.context,D=d.depthModeForSublayer(0,K.ReadOnly),T=d.colorModeForRenderPass(),I="translucent"===d.renderPass?d.stencilConfigForOverlap(g):[{},g],R=I[0],F=0,W=I[1];F<W.length;F+=1){var Z=W[F],$=p.getTile(Z);$.needsHillshadePrepare&&"offscreen"===d.renderPass?Ls(d,$,h,D,oe.disabled,T):"translucent"===d.renderPass&&sv(d,$,h,D,R[Z.overscaledZ],T)}w.viewport.set([0,0,d.width,d.height])}},raster:function(d,p,h,g){if("translucent"===d.renderPass&&0!==h.paint.get("raster-opacity")&&g.length)for(var w=d.context,D=w.gl,T=p.getSource(),I=d.useProgram("raster"),R=d.colorModeForRenderPass(),F=T instanceof Aa?[{},g]:d.stencilConfigForOverlap(g),W=F[0],Z=F[1],$=Z[Z.length-1].overscaledZ,se=!d.options.moving,re=0,de=Z;re<de.length;re+=1){var ie=de[re],le=d.depthModeForSublayer(ie.overscaledZ-$,1===h.paint.get("raster-opacity")?K.ReadWrite:K.ReadOnly,D.LESS),_e=p.getTile(ie),we=d.transform.calculatePosMatrix(ie.toUnwrapped(),se);_e.registerFadeDuration(h.paint.get("raster-fade-duration"));var Ae=p.findLoadedParent(ie,0),De=Pr(_e,Ae,p,h,d.transform),Re=void 0,Ve=void 0,Qe="nearest"===h.paint.get("raster-resampling")?D.NEAREST:D.LINEAR;w.activeTexture.set(D.TEXTURE0),_e.texture.bind(Qe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(D.TEXTURE1),Ae?(Ae.texture.bind(Qe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),Re=Math.pow(2,Ae.tileID.overscaledZ-_e.tileID.overscaledZ),Ve=[_e.tileID.canonical.x*Re%1,_e.tileID.canonical.y*Re%1]):_e.texture.bind(Qe,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);var We=Q(we,Ve||[0,0],Re||1,De,h);T instanceof Aa?I.draw(w,D.TRIANGLES,le,oe.disabled,R,ye.disabled,We,h.id,T.boundsBuffer,d.quadTriangleIndexBuffer,T.boundsSegments):I.draw(w,D.TRIANGLES,le,W[ie.overscaledZ],R,ye.disabled,We,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,p,h){var g=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(0!==w){var D=d.context,T=D.gl,I=d.transform,R=I.tileSize,F=h.paint.get("background-pattern");if(!d.isPatternMissing(F)){var W=!F&&1===g.a&&1===w&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass===W){var Z=oe.disabled,$=d.depthModeForSublayer(0,"opaque"===W?K.ReadWrite:K.ReadOnly),se=d.colorModeForRenderPass(),re=d.useProgram(F?"backgroundPattern":"background"),de=I.coveringTiles({tileSize:R});F&&(D.activeTexture.set(T.TEXTURE0),d.imageManager.bind(d.context));for(var ie=h.getCrossfadeParameters(),le=0,_e=de;le<_e.length;le+=1){var we=_e[le],Ae=d.transform.calculatePosMatrix(we.toUnwrapped()),De=F?Yd(Ae,w,d,F,{tileID:we,tileSize:R},ie):za(Ae,w,g);re.draw(D,T.TRIANGLES,$,Z,se,ye.disabled,De,h.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}}}},debug:function(d,p,h){for(var g=0;g<h.length;g++)Xp(d,p,h[g])},custom:function(d,p,h){var g=d.context,w=h.implementation;if("offscreen"===d.renderPass){var D=w.prerender;D&&(d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),D.call(w,g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState())}else if("translucent"===d.renderPass){d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),g.setStencilMode(oe.disabled);var T="3d"===w.renderingMode?new K(d.context.gl.LEQUAL,K.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,K.ReadOnly);g.setDepthMode(T),w.render(g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState(),g.bindFramebuffer.set(null)}}},pr=function(d,p){this.context=new ee(d),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=X.maxUnderzooming+X.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ns,this.gpuTimers={}};pr.prototype.resize=function(d,p){if(this.width=d*v.browser.devicePixelRatio,this.height=p*v.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,g=this.style._order;h<g.length;h+=1)this.style._layers[g[h]].resize()},pr.prototype.setup=function(){var d=this.context,p=new v.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(v.EXTENT,0),p.emplaceBack(0,v.EXTENT),p.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(p,La.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);var h=new v.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(v.EXTENT,0),h.emplaceBack(0,v.EXTENT),h.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=d.createVertexBuffer(h,La.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);var g=new v.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(v.EXTENT,0,v.EXTENT,0),g.emplaceBack(0,v.EXTENT,0,v.EXTENT),g.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.rasterBoundsBuffer=d.createVertexBuffer(g,oo.members),this.rasterBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);var w=new v.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(w,La.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);var D=new v.StructArrayLayout1ui2;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=d.createIndexBuffer(D);var T=new v.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(T),this.emptyTexture=new v.Texture(d,{width:1,height:1,data:new Uint8Array([0,0,0,0])},d.gl.RGBA);var I=this.context.gl;this.stencilClearMode=new oe({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)},pr.prototype.clearStencil=function(){var d=this.context,p=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=v.create();v.ortho(h,0,this.width,this.height,0,0,1),v.scale(h,h,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,p.TRIANGLES,K.disabled,this.stencilClearMode,me.disabled,ye.disabled,$u(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},pr.prototype._renderTileClippingMasks=function(d,p){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&p&&p.length){this.currentStencilSource=d.source;var h=this.context,g=h.gl;this.nextStencilID+p.length>256&&this.clearStencil(),h.setColorMode(me.disabled),h.setDepthMode(K.disabled);var w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var D=0,T=p;D<T.length;D+=1){var I=T[D],R=this._tileClippingMaskIDs[I.key]=this.nextStencilID++;w.draw(h,g.TRIANGLES,K.disabled,new oe({func:g.ALWAYS,mask:0},R,255,g.KEEP,g.KEEP,g.REPLACE),me.disabled,ye.disabled,$u(I.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},pr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var d=this.nextStencilID++,p=this.context.gl;return new oe({func:p.NOTEQUAL,mask:255},d,255,p.KEEP,p.KEEP,p.REPLACE)},pr.prototype.stencilModeForClipping=function(d){var p=this.context.gl;return new oe({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,p.KEEP,p.KEEP,p.REPLACE)},pr.prototype.stencilConfigForOverlap=function(d){var p,h=this.context.gl,g=d.sort(function(R,F){return F.overscaledZ-R.overscaledZ}),w=g[g.length-1].overscaledZ,D=g[0].overscaledZ-w+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();for(var T={},I=0;I<D;I++)T[I+w]=new oe({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=D,[T,g]}return[(p={},p[w]=oe.disabled,p),g]},pr.prototype.colorModeForRenderPass=function(){var d=this.context.gl;return this._showOverdrawInspector?new me([d.CONSTANT_COLOR,d.ONE],new v.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?me.unblended:me.alphaBlended},pr.prototype.depthModeForSublayer=function(d,p,h){if(!this.opaquePassEnabledForLayer())return K.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new K(h||this.context.gl.LEQUAL,p,[g,g])},pr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},pr.prototype.render=function(d,p){var h=this;this.style=d,this.options=p,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(v.browser.now()),this.imageManager.beginFrame();var g=this.style._order,w=this.style.sourceCaches;for(var D in w){var T=w[D];T.used&&T.prepare(this.context)}var I,R,F={},W={},Z={};for(var $ in w){var se=w[$];F[$]=se.getVisibleCoordinates(),W[$]=F[$].slice().reverse(),Z[$]=se.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var re=0;re<g.length;re++)if(this.style._layers[g[re]].is3D()){this.opaquePassCutoff=re;break}this.renderPass="offscreen";for(var de=0,ie=g;de<ie.length;de+=1){var le=this.style._layers[ie[de]];if(le.hasOffscreenPass()&&!le.isHidden(this.transform.zoom)){var _e=W[le.source];("custom"===le.type||_e.length)&&this.renderLayer(this,w[le.source],le,_e)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?v.Color.black:v.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var we=this.style._layers[g[this.currentLayer]],Ae=w[we.source],De=F[we.source];this._renderTileClippingMasks(we,De),this.renderLayer(this,Ae,we,De)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var Re=this.style._layers[g[this.currentLayer]],Ve=w[Re.source],Qe=("symbol"===Re.type?Z:W)[Re.source];this._renderTileClippingMasks(Re,F[Re.source]),this.renderLayer(this,Ve,Re,Qe)}this.options.showTileBoundaries&&(v.values(this.style._layers).forEach(function(We){We.source&&!We.isHidden(h.transform.zoom)&&(We.source!==(R&&R.id)&&(R=h.style.sourceCaches[We.source]),(!I||I.getSource().maxzoom<R.getSource().maxzoom)&&(I=R))}),I&&Gu.debug(this,I,I.getVisibleCoordinates())),this.options.showPadding&&function(We){var ct=We.transform.padding;Tf(We,We.transform.height-(ct.top||0),3,Xs),Tf(We,ct.bottom||0,3,Cf),Sf(We,ct.left||0,3,Df),Sf(We,We.transform.width-(ct.right||0),3,Qd);var kt,It,gn,ft,Ct=We.transform.centerPoint;Yc(kt=We,(It=Ct.x)-1,(gn=We.transform.height-Ct.y)-10,2,20,ft=Ha),Yc(kt,It-10,gn-1,20,2,ft)}(this),this.context.setDefault()},pr.prototype.renderLayer=function(d,p,h,g){h.isHidden(this.transform.zoom)||("background"===h.type||"custom"===h.type||g.length)&&(this.id=h.id,this.gpuTimingStart(h),Gu[h.type](d,p,h,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},pr.prototype.gpuTimingStart=function(d){if(this.options.gpuTiming){var p=this.context.extTimerQuery,h=this.gpuTimers[d.id];h||(h=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),h.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,h.query)}},pr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}},pr.prototype.collectGpuTimers=function(){var d=this.gpuTimers;return this.gpuTimers={},d},pr.prototype.queryGpuTimers=function(d){var p={};for(var h in d){var g=d[h],w=this.context.extTimerQuery,D=w.getQueryObjectEXT(g.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(g.query),p[h]=D}return p},pr.prototype.translatePosMatrix=function(d,p,h,g,w){if(!h[0]&&!h[1])return d;var D=w?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(D){var T=Math.sin(D),I=Math.cos(D);h=[h[0]*I-h[1]*T,h[0]*T+h[1]*I]}var R=[w?h[0]:ls(p,h[0],this.transform.zoom),w?h[1]:ls(p,h[1],this.transform.zoom),0],F=new Float32Array(16);return v.translate(F,d,R),F},pr.prototype.saveTileTexture=function(d){var p=this._tileTextures[d.size[0]];p?p.push(d):this._tileTextures[d.size[0]]=[d]},pr.prototype.getTileTexture=function(d){var p=this._tileTextures[d];return p&&p.length>0?p.pop():null},pr.prototype.isPatternMissing=function(d){if(!d)return!1;if(!d.from||!d.to)return!0;var p=this.imageManager.getPattern(d.from.toString()),h=this.imageManager.getPattern(d.to.toString());return!p||!h},pr.prototype.useProgram=function(d,p){this.cache=this.cache||{};var h=""+d+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new ov(this.context,d,Ba[d],p,vo[d],this._showOverdrawInspector)),this.cache[h]},pr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},pr.prototype.setBaseState=function(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)},pr.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=v.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},pr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Wu=function(d,p){this.points=d,this.planes=p};Wu.fromInvProjectionMatrix=function(d,p,h){var g=Math.pow(2,h),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return v.transformMat4([],T,d)}).map(function(T){return v.scale$1([],T,1/T[3]/p*g)}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var I=v.sub([],w[T[0]],w[T[1]]),R=v.sub([],w[T[2]],w[T[1]]),F=v.normalize([],v.cross([],I,R)),W=-v.dot(F,w[T[1]]);return F.concat(W)});return new Wu(w,D)};var Xc=function(d,p){this.min=d,this.max=p,this.center=v.scale$2([],v.add([],this.min,this.max),.5)};Xc.prototype.quadrant=function(d){for(var p=[d%2==0,d<2],h=v.clone$2(this.min),g=v.clone$2(this.max),w=0;w<p.length;w++)h[w]=p[w]?this.min[w]:this.center[w],g[w]=p[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new Xc(h,g)},Xc.prototype.distanceX=function(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]},Xc.prototype.distanceY=function(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]},Xc.prototype.intersects=function(d){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,g=0;g<d.planes.length;g++){for(var w=d.planes[g],D=0,T=0;T<p.length;T++)D+=v.dot$1(w,p[T])>=0;if(0===D)return 0;D!==p.length&&(h=!1)}if(h)return 2;for(var I=0;I<3;I++){for(var R=Number.MAX_VALUE,F=-Number.MAX_VALUE,W=0;W<d.points.length;W++){var Z=d.points[W][I]-this.min[I];R=Math.min(R,Z),F=Math.max(F,Z)}if(F<0||R>this.max[I]-this.min[I])return 0}return 1};var $a=function(d,p,h,g){if(void 0===d&&(d=0),void 0===p&&(p=0),void 0===h&&(h=0),void 0===g&&(g=0),isNaN(d)||d<0||isNaN(p)||p<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=p,this.left=h,this.right=g};$a.prototype.interpolate=function(d,p,h){return null!=p.top&&null!=d.top&&(this.top=v.number(d.top,p.top,h)),null!=p.bottom&&null!=d.bottom&&(this.bottom=v.number(d.bottom,p.bottom,h)),null!=p.left&&null!=d.left&&(this.left=v.number(d.left,p.left,h)),null!=p.right&&null!=d.right&&(this.right=v.number(d.right,p.right,h)),this},$a.prototype.getCenter=function(d,p){var h=v.clamp((this.left+d-this.right)/2,0,d),g=v.clamp((this.top+p-this.bottom)/2,0,p);return new v.Point(h,g)},$a.prototype.equals=function(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right},$a.prototype.clone=function(){return new $a(this.top,this.bottom,this.left,this.right)},$a.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var er=function(d,p,h,g,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===w||w,this._minZoom=d||0,this._maxZoom=p||22,this._minPitch=h??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new $a,this._posMatrixCache={},this._alignedPosMatrixCache={}},kn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};er.prototype.clone=function(){var d=new er(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.tileSize=this.tileSize,d.latRange=this.latRange,d.width=this.width,d.height=this.height,d._center=this._center,d.zoom=this.zoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._calcMatrices(),d},kn.minZoom.get=function(){return this._minZoom},kn.minZoom.set=function(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))},kn.maxZoom.get=function(){return this._maxZoom},kn.maxZoom.set=function(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))},kn.minPitch.get=function(){return this._minPitch},kn.minPitch.set=function(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))},kn.maxPitch.get=function(){return this._maxPitch},kn.maxPitch.set=function(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))},kn.renderWorldCopies.get=function(){return this._renderWorldCopies},kn.renderWorldCopies.set=function(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d},kn.worldSize.get=function(){return this.tileSize*this.scale},kn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},kn.size.get=function(){return new v.Point(this.width,this.height)},kn.bearing.get=function(){return-this.angle/Math.PI*180},kn.bearing.set=function(d){var p=-v.wrap(d,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=v.create$2(),v.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},kn.pitch.get=function(){return this._pitch/Math.PI*180},kn.pitch.set=function(d){var p=v.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},kn.fov.get=function(){return this._fov/Math.PI*180},kn.fov.set=function(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())},kn.zoom.get=function(){return this._zoom},kn.zoom.set=function(d){var p=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},kn.center.get=function(){return this._center},kn.center.set=function(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())},kn.padding.get=function(){return this._edgeInsets.toJSON()},kn.padding.set=function(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())},kn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},er.prototype.isPaddingEqual=function(d){return this._edgeInsets.equals(d)},er.prototype.interpolatePadding=function(d,p,h){this._unmodified=!1,this._edgeInsets.interpolate(d,p,h),this._constrain(),this._calcMatrices()},er.prototype.coveringZoomLevel=function(d){var p=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,p)},er.prototype.getVisibleUnwrappedCoordinates=function(d){var p=[new v.UnwrappedTileID(0,d)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new v.Point(0,0)),g=this.pointCoordinate(new v.Point(this.width,0)),w=this.pointCoordinate(new v.Point(this.width,this.height)),D=this.pointCoordinate(new v.Point(0,this.height)),T=Math.floor(Math.min(h.x,g.x,w.x,D.x)),I=Math.floor(Math.max(h.x,g.x,w.x,D.x)),R=T-1;R<=I+1;R++)0!==R&&p.push(new v.UnwrappedTileID(R,d));return p},er.prototype.coveringTiles=function(d){var p=this.coveringZoomLevel(d),h=p;if(void 0!==d.minzoom&&p<d.minzoom)return[];void 0!==d.maxzoom&&p>d.maxzoom&&(p=d.maxzoom);var g=v.MercatorCoordinate.fromLngLat(this.center),w=Math.pow(2,p),D=[w*g.x,w*g.y,0],T=Wu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),I=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(I=p);var R=function(We){return{aabb:new Xc([We*w,0,0],[(We+1)*w,w,0]),zoom:0,x:0,y:0,wrap:We,fullyVisible:!1}},F=[],W=[],Z=p,$=d.reparseOverscaled?h:p;if(this._renderWorldCopies)for(var se=1;se<=3;se++)F.push(R(-se)),F.push(R(se));for(F.push(R(0));F.length>0;){var re=F.pop(),de=re.x,ie=re.y,le=re.fullyVisible;if(!le){var _e=re.aabb.intersects(T);if(0===_e)continue;le=2===_e}var we=re.aabb.distanceX(D),Ae=re.aabb.distanceY(D),De=Math.max(Math.abs(we),Math.abs(Ae));if(re.zoom===Z||De>3+(1<<Z-re.zoom)-2&&re.zoom>=I)W.push({tileID:new v.OverscaledTileID(re.zoom===Z?$:re.zoom,re.wrap,re.zoom,de,ie),distanceSq:v.sqrLen([D[0]-.5-de,D[1]-.5-ie])});else for(var Re=0;Re<4;Re++){var Ve=(de<<1)+Re%2,Qe=(ie<<1)+(Re>>1);F.push({aabb:re.aabb.quadrant(Re),zoom:re.zoom+1,x:Ve,y:Qe,wrap:re.wrap,fullyVisible:le})}}return W.sort(function(We,ct){return We.distanceSq-ct.distanceSq}).map(function(We){return We.tileID})},er.prototype.resize=function(d,p){this.width=d,this.height=p,this.pixelsToGLUnits=[2/d,-2/p],this._constrain(),this._calcMatrices()},kn.unmodified.get=function(){return this._unmodified},er.prototype.zoomScale=function(d){return Math.pow(2,d)},er.prototype.scaleZoom=function(d){return Math.log(d)/Math.LN2},er.prototype.project=function(d){var p=v.clamp(d.lat,-this.maxValidLatitude,this.maxValidLatitude);return new v.Point(v.mercatorXfromLng(d.lng)*this.worldSize,v.mercatorYfromLat(p)*this.worldSize)},er.prototype.unproject=function(d){return new v.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()},kn.point.get=function(){return this.project(this.center)},er.prototype.setLocationAtPoint=function(d,p){var h=this.pointCoordinate(p),g=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(d),D=new v.MercatorCoordinate(w.x-(h.x-g.x),w.y-(h.y-g.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())},er.prototype.locationPoint=function(d){return this.coordinatePoint(this.locationCoordinate(d))},er.prototype.pointLocation=function(d){return this.coordinateLocation(this.pointCoordinate(d))},er.prototype.locationCoordinate=function(d){return v.MercatorCoordinate.fromLngLat(d)},er.prototype.coordinateLocation=function(d){return d.toLngLat()},er.prototype.pointCoordinate=function(d){var p=[d.x,d.y,0,1],h=[d.x,d.y,1,1];v.transformMat4(p,p,this.pixelMatrixInverse),v.transformMat4(h,h,this.pixelMatrixInverse);var g=p[3],w=h[3],D=p[1]/g,T=h[1]/w,I=p[2]/g,R=h[2]/w,F=I===R?0:(0-I)/(R-I);return new v.MercatorCoordinate(v.number(p[0]/g,h[0]/w,F)/this.worldSize,v.number(D,T,F)/this.worldSize)},er.prototype.coordinatePoint=function(d){var p=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix),new v.Point(p[0]/p[3],p[1]/p[3])},er.prototype.getBounds=function(){return(new v.LngLatBounds).extend(this.pointLocation(new v.Point(0,0))).extend(this.pointLocation(new v.Point(this.width,0))).extend(this.pointLocation(new v.Point(this.width,this.height))).extend(this.pointLocation(new v.Point(0,this.height)))},er.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new v.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},er.prototype.setMaxBounds=function(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},er.prototype.calculatePosMatrix=function(d,p){void 0===p&&(p=!1);var h=d.key,g=p?this._alignedPosMatrixCache:this._posMatrixCache;if(g[h])return g[h];var w=d.canonical,D=this.worldSize/this.zoomScale(w.z),T=w.x+Math.pow(2,w.z)*d.wrap,I=v.identity(new Float64Array(16));return v.translate(I,I,[T*D,w.y*D,0]),v.scale(I,I,[D/v.EXTENT,D/v.EXTENT,1]),v.multiply(I,p?this.alignedProjMatrix:this.projMatrix,I),g[h]=new Float32Array(I),g[h]},er.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},er.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var d,p,h,g,w=-90,D=90,T=-180,I=180,R=this.size,F=this._unmodified;if(this.latRange){var W=this.latRange;w=v.mercatorYfromLat(W[1])*this.worldSize,d=(D=v.mercatorYfromLat(W[0])*this.worldSize)-w<R.y?R.y/(D-w):0}if(this.lngRange){var Z=this.lngRange;T=v.mercatorXfromLng(Z[0])*this.worldSize,p=(I=v.mercatorXfromLng(Z[1])*this.worldSize)-T<R.x?R.x/(I-T):0}var $=this.point,se=Math.max(p||0,d||0);if(se)return this.center=this.unproject(new v.Point(p?(I+T)/2:$.x,d?(D+w)/2:$.y)),this.zoom+=this.scaleZoom(se),this._unmodified=F,void(this._constraining=!1);if(this.latRange){var re=$.y,de=R.y/2;re-de<w&&(g=w+de),re+de>D&&(g=D-de)}if(this.lngRange){var ie=$.x,le=R.x/2;ie-le<T&&(h=T+le),ie+le>I&&(h=I-le)}void 0===h&&void 0===g||(this.center=this.unproject(new v.Point(void 0!==h?h:$.x,void 0!==g?g:$.y))),this._unmodified=F,this._constraining=!1}},er.prototype._calcMatrices=function(){if(this.height){var d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,h=this._fov*(.5+d.y/this.height),g=Math.sin(h)*this.cameraToCenterDistance/Math.sin(v.clamp(Math.PI-p-h,.01,Math.PI-.01)),w=this.point,D=w.x,T=w.y,I=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),R=this.height/50,F=new Float64Array(16);v.perspective(F,this._fov,this.width/this.height,R,I),F[8]=2*-d.x/this.width,F[9]=2*d.y/this.height,v.scale(F,F,[1,-1,1]),v.translate(F,F,[0,0,-this.cameraToCenterDistance]),v.rotateX(F,F,this._pitch),v.rotateZ(F,F,this.angle),v.translate(F,F,[-D,-T,0]),this.mercatorMatrix=v.scale([],F,[this.worldSize,this.worldSize,this.worldSize]),v.scale(F,F,[1,1,v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=F,this.invProjMatrix=v.invert([],this.projMatrix);var W=this.width%2/2,Z=this.height%2/2,$=Math.cos(this.angle),se=Math.sin(this.angle),re=D-Math.round(D)+$*W+se*Z,de=T-Math.round(T)+$*Z+se*W,ie=new Float64Array(F);if(v.translate(ie,ie,[re>.5?re-1:re,de>.5?de-1:de,0]),this.alignedProjMatrix=ie,F=v.create(),v.scale(F,F,[this.width/2,-this.height/2,1]),v.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=v.create(),v.scale(F,F,[1,-1,1]),v.translate(F,F,[-1,-1,0]),v.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(F=v.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=F,this._posMatrixCache={},this._alignedPosMatrixCache={}}},er.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var d=this.pointCoordinate(new v.Point(0,0)),p=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},er.prototype.getCameraPoint=function(){var d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.Point(0,d))},er.prototype.getCameraQueryGeometry=function(d){var p=this.getCameraPoint();if(1===d.length)return[d[0],p];for(var h=p.x,g=p.y,w=p.x,D=p.y,T=0,I=d;T<I.length;T+=1){var R=I[T];h=Math.min(h,R.x),g=Math.min(g,R.y),w=Math.max(w,R.x),D=Math.max(D,R.y)}return[new v.Point(h,g),new v.Point(w,g),new v.Point(w,D),new v.Point(h,D),new v.Point(h,g)]},Object.defineProperties(er.prototype,kn);var Jo=function(d){var p,h,g,w;this._hashName=d&&encodeURIComponent(d),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),h=!1,g=null,w=function(){g=null,h&&(p(),g=setTimeout(w,300),h=!1)},function(){return h=!0,g||w(),g})};Jo.prototype.addTo=function(d){return this._map=d,v.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jo.prototype.remove=function(){return v.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jo.prototype.getHashString=function(d){var p=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,g=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),D=Math.round(p.lng*w)/w,T=Math.round(p.lat*w)/w,I=this._map.getBearing(),R=this._map.getPitch(),F="";if(F+=d?"/"+D+"/"+T+"/"+h:h+"/"+T+"/"+D,(I||R)&&(F+="/"+Math.round(10*I)/10),R&&(F+="/"+Math.round(R)),this._hashName){var W=this._hashName,Z=!1,$=v.window.location.hash.slice(1).split("&").map(function(se){var re=se.split("=")[0];return re===W?(Z=!0,re+"="+F):se}).filter(function(se){return se});return Z||$.push(W+"="+F),"#"+$.join("&")}return"#"+F},Jo.prototype._getCurrentHash=function(){var d,p=this,h=v.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===p._hashName&&(d=g)}),(d&&d[1]||"").split("/")):h.split("/")},Jo.prototype._onHashChange=function(){var d=this._getCurrentHash();if(d.length>=3&&!d.some(function(h){return isNaN(h)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},Jo.prototype._updateHashUnthrottled=function(){var d=v.window.location.href.replace(/(#.+)?$/,this.getHashString());try{v.window.history.replaceState(v.window.history.state,null,d)}catch{}};var ua={linearity:.3,easing:v.bezier(0,0,.3,1)},If=v.extend({deceleration:2500,maxSpeed:1400},ua),wl=v.extend({deceleration:20,maxSpeed:1400},ua),Zu=v.extend({deceleration:1e3,maxSpeed:360},ua),Qp=v.extend({deceleration:1e3,maxSpeed:90},ua),sc=function(d){this._map=d,this.clear()};function $r(d,p){(!d.duration||d.duration<p.duration)&&(d.duration=p.duration,d.easing=p.easing)}function da(d,p,h){var g=h.maxSpeed,w=h.linearity,D=h.deceleration,T=v.clamp(d*w/(p/1e3),-g,g),I=Math.abs(T)/(D*w);return{easing:h.easing,duration:1e3*I,amount:T*(I/2)}}sc.prototype.clear=function(){this._inertiaBuffer=[]},sc.prototype.record=function(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.browser.now(),settings:d})},sc.prototype._drainInertiaBuffer=function(){for(var d=this._inertiaBuffer,p=v.browser.now();d.length>0&&p-d[0].time>160;)d.shift()},sc.prototype._onMoveEnd=function(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new v.Point(0,0),pinchAround:void 0,around:void 0},h=0,g=this._inertiaBuffer;h<g.length;h+=1){var w=g[h].settings;p.zoom+=w.zoomDelta||0,p.bearing+=w.bearingDelta||0,p.pitch+=w.pitchDelta||0,w.panDelta&&p.pan._add(w.panDelta),w.around&&(p.around=w.around),w.pinchAround&&(p.pinchAround=w.pinchAround)}var D=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(p.pan.mag()){var I=da(p.pan.mag(),D,v.extend({},If,d||{}));T.offset=p.pan.mult(I.amount/p.pan.mag()),T.center=this._map.transform.center,$r(T,I)}if(p.zoom){var R=da(p.zoom,D,wl);T.zoom=this._map.transform.zoom+R.amount,$r(T,R)}if(p.bearing){var F=da(p.bearing,D,Zu);T.bearing=this._map.transform.bearing+v.clamp(F.amount,-179,179),$r(T,F)}if(p.pitch){var W=da(p.pitch,D,Qp);T.pitch=this._map.transform.pitch+W.amount,$r(T,W)}if(T.zoom||T.bearing){var Z=void 0===p.pinchAround?p.around:p.pinchAround;T.around=Z?this._map.unproject(Z):this._map.getCenter()}return this.clear(),v.extend(T,{noMoveStart:!0})}};var $i=function(d){function p(g,w,D,T){void 0===T&&(T={});var I=He.mousePos(w.getCanvasContainer(),D),R=w.unproject(I);d.call(this,g,v.extend({point:I,lngLat:R,originalEvent:D},T)),this._defaultPrevented=!1,this.target=w}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),Fs=function(d){function p(g,w,D){var T="touchend"===g?D.changedTouches:D.touches,I=He.touchPos(w.getCanvasContainer(),T),R=I.map(function(Z){return w.unproject(Z)}),F=I.reduce(function(Z,$,se,re){return Z.add($.div(re.length))},new v.Point(0,0)),W=w.unproject(F);d.call(this,g,{points:I,point:F,lngLats:R,lngLat:W,originalEvent:D}),this._defaultPrevented=!1}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),Ug=function(d){function p(g,w,D){d.call(this,g,{originalEvent:D}),this._defaultPrevented=!1}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),ki=function(d,p){this._map=d,this._clickTolerance=p.clickTolerance};ki.prototype.reset=function(){delete this._mousedownPos},ki.prototype.wheel=function(d){return this._firePreventable(new Ug(d.type,this._map,d))},ki.prototype.mousedown=function(d,p){return this._mousedownPos=p,this._firePreventable(new $i(d.type,this._map,d))},ki.prototype.mouseup=function(d){this._map.fire(new $i(d.type,this._map,d))},ki.prototype.click=function(d,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new $i(d.type,this._map,d))},ki.prototype.dblclick=function(d){return this._firePreventable(new $i(d.type,this._map,d))},ki.prototype.mouseover=function(d){this._map.fire(new $i(d.type,this._map,d))},ki.prototype.mouseout=function(d){this._map.fire(new $i(d.type,this._map,d))},ki.prototype.touchstart=function(d){return this._firePreventable(new Fs(d.type,this._map,d))},ki.prototype.touchmove=function(d){this._map.fire(new Fs(d.type,this._map,d))},ki.prototype.touchend=function(d){this._map.fire(new Fs(d.type,this._map,d))},ki.prototype.touchcancel=function(d){this._map.fire(new Fs(d.type,this._map,d))},ki.prototype._firePreventable=function(d){if(this._map.fire(d),d.defaultPrevented)return{}},ki.prototype.isEnabled=function(){return!0},ki.prototype.isActive=function(){return!1},ki.prototype.enable=function(){},ki.prototype.disable=function(){};var co=function(d){this._map=d};co.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},co.prototype.mousemove=function(d){this._map.fire(new $i(d.type,this._map,d))},co.prototype.mousedown=function(){this._delayContextMenu=!0},co.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $i("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},co.prototype.contextmenu=function(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new $i(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()},co.prototype.isEnabled=function(){return!0},co.prototype.isActive=function(){return!1},co.prototype.enable=function(){},co.prototype.disable=function(){};var lt=function(d,p){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=p.clickTolerance||1};function Jd(d,p){for(var h={},g=0;g<d.length;g++)h[d[g].identifier]=p[g];return h}lt.prototype.isEnabled=function(){return!!this._enabled},lt.prototype.isActive=function(){return!!this._active},lt.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},lt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},lt.prototype.mousedown=function(d,p){this.isEnabled()&&d.shiftKey&&0===d.button&&(He.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},lt.prototype.mousemoveWindow=function(d,p){if(this._active){var h=p;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=h,this._box||(this._box=He.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));var w=Math.min(g.x,h.x),D=Math.max(g.x,h.x),T=Math.min(g.y,h.y),I=Math.max(g.y,h.y);He.setTransform(this._box,"translate("+w+"px,"+T+"px)"),this._box.style.width=D-w+"px",this._box.style.height=I-T+"px"}}},lt.prototype.mouseupWindow=function(d,p){var h=this;if(this._active&&0===d.button){var g=this._startPos,w=p;if(this.reset(),He.suppressClick(),g.x!==w.x||g.y!==w.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:function(D){return D.fitScreenCoordinates(g,w,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",d)}},lt.prototype.keydown=function(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))},lt.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(He.remove(this._box),this._box=null),He.enableDrag(),delete this._startPos,delete this._lastPos},lt.prototype._fireEvent=function(d,p){return this._map.fire(new v.Event(d,{originalEvent:p}))};var Ku=function(d){this.reset(),this.numTouches=d.numTouches};Ku.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ku.prototype.touchstart=function(d,p,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=d.timeStamp),h.length===this.numTouches&&(this.centroid=function(g){for(var w=new v.Point(0,0),D=0,T=g;D<T.length;D+=1)w._add(T[D]);return w.div(g.length)}(p),this.touches=Jd(h,p)))},Ku.prototype.touchmove=function(d,p,h){if(!this.aborted&&this.centroid){var g=Jd(h,p);for(var w in this.touches){var D=g[w];(!D||D.dist(this.touches[w])>30)&&(this.aborted=!0)}}},Ku.prototype.touchend=function(d,p,h){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===h.length){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var ac=function(d){this.singleTap=new Ku(d),this.numTaps=d.numTaps,this.reset()};ac.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ac.prototype.touchstart=function(d,p,h){this.singleTap.touchstart(d,p,h)},ac.prototype.touchmove=function(d,p,h){this.singleTap.touchmove(d,p,h)},ac.prototype.touchend=function(d,p,h){var g=this.singleTap.touchend(d,p,h);if(g){var w=d.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(g)<30;if(w&&D||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var Vo=function(){this._zoomIn=new ac({numTouches:1,numTaps:2}),this._zoomOut=new ac({numTouches:2,numTaps:1}),this.reset()};Vo.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Vo.prototype.touchstart=function(d,p,h){this._zoomIn.touchstart(d,p,h),this._zoomOut.touchstart(d,p,h)},Vo.prototype.touchmove=function(d,p,h){this._zoomIn.touchmove(d,p,h),this._zoomOut.touchmove(d,p,h)},Vo.prototype.touchend=function(d,p,h){var g=this,w=this._zoomIn.touchend(d,p,h),D=this._zoomOut.touchend(d,p,h);return w?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(w)},{originalEvent:d})}}):D?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(D)},{originalEvent:d})}}):void 0},Vo.prototype.touchcancel=function(){this.reset()},Vo.prototype.enable=function(){this._enabled=!0},Vo.prototype.disable=function(){this._enabled=!1,this.reset()},Vo.prototype.isEnabled=function(){return this._enabled},Vo.prototype.isActive=function(){return this._active};var qi={0:1,2:2},bo=function(d){this.reset(),this._clickTolerance=d.clickTolerance||1};bo.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},bo.prototype._correctButton=function(d,p){return!1},bo.prototype._move=function(d,p){return{}},bo.prototype.mousedown=function(d,p){if(!this._lastPoint){var h=He.mouseButton(d);this._correctButton(d,h)&&(this._lastPoint=p,this._eventButton=h)}},bo.prototype.mousemoveWindow=function(d,p){var g,D,h=this._lastPoint;if(h)if(d.preventDefault(),D=qi[this._eventButton],void 0===(g=d).buttons||(g.buttons&D)!==D)this.reset();else if(this._moved||!(p.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(h,p)},bo.prototype.mouseupWindow=function(d){this._lastPoint&&He.mouseButton(d)===this._eventButton&&(this._moved&&He.suppressClick(),this.reset())},bo.prototype.enable=function(){this._enabled=!0},bo.prototype.disable=function(){this._enabled=!1,this.reset()},bo.prototype.isEnabled=function(){return this._enabled},bo.prototype.isActive=function(){return this._active};var mt=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.mousedown=function(h,g){d.prototype.mousedown.call(this,h,g),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(h,g){return 0===g&&!h.ctrlKey},p.prototype._move=function(h,g){return{around:g,panDelta:g.sub(h)}},p}(bo),Jr=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},p.prototype._move=function(h,g){var w=.8*(g.x-h.x);if(w)return this._active=!0,{bearingDelta:w}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(bo),Ke=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},p.prototype._move=function(h,g){var w=-.5*(g.y-h.y);if(w)return this._active=!0,{pitchDelta:w}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(bo),Bt=function(d){this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset()};Bt.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new v.Point(0,0)},Bt.prototype.touchstart=function(d,p,h){return this._calculateTransform(d,p,h)},Bt.prototype.touchmove=function(d,p,h){if(this._active&&!(h.length<this._minTouches))return d.preventDefault(),this._calculateTransform(d,p,h)},Bt.prototype.touchend=function(d,p,h){this._calculateTransform(d,p,h),this._active&&h.length<this._minTouches&&this.reset()},Bt.prototype.touchcancel=function(){this.reset()},Bt.prototype._calculateTransform=function(d,p,h){h.length>0&&(this._active=!0);var g=Jd(h,p),w=new v.Point(0,0),D=new v.Point(0,0),T=0;for(var I in g){var R=g[I],F=this._touches[I];F&&(w._add(R),D._add(R.sub(F)),T++,g[I]=R)}if(this._touches=g,!(T<this._minTouches)&&D.mag()){var W=D.div(T);if(this._sum._add(W),!(this._sum.mag()<this._clickTolerance))return{around:w.div(T),panDelta:W}}},Bt.prototype.enable=function(){this._enabled=!0},Bt.prototype.disable=function(){this._enabled=!1,this.reset()},Bt.prototype.isEnabled=function(){return this._enabled},Bt.prototype.isActive=function(){return this._active};var Hn=function(){this.reset()};function Gi(d,p,h){for(var g=0;g<d.length;g++)if(d[g].identifier===h)return p[g]}function Wi(d,p){return Math.log(d/p)/Math.LN2}Hn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Hn.prototype._start=function(d){},Hn.prototype._move=function(d,p,h){return{}},Hn.prototype.touchstart=function(d,p,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([p[0],p[1]]))},Hn.prototype.touchmove=function(d,p,h){if(this._firstTwoTouches){d.preventDefault();var g=this._firstTwoTouches,w=g[1],D=Gi(h,p,g[0]),T=Gi(h,p,w);if(D&&T){var I=this._aroundCenter?null:D.add(T).div(2);return this._move([D,T],I,d)}}},Hn.prototype.touchend=function(d,p,h){if(this._firstTwoTouches){var g=this._firstTwoTouches,w=g[1],D=Gi(h,p,g[0]),T=Gi(h,p,w);D&&T||(this._active&&He.suppressClick(),this.reset())}},Hn.prototype.touchcancel=function(){this.reset()},Hn.prototype.enable=function(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around},Hn.prototype.disable=function(){this._enabled=!1,this.reset()},Hn.prototype.isEnabled=function(){return this._enabled},Hn.prototype.isActive=function(){return this._active};var xl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},p.prototype._move=function(h,g){var w=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Wi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wi(this._distance,w),pinchAround:g}},p}(Hn);function Zi(d,p){return 180*d.angleWith(p)/Math.PI}var Nn=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},p.prototype._move=function(h,g){var w=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Zi(this._vector,w),pinchAround:g}},p.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var g=25/(Math.PI*this._minDiameter)*360,w=Zi(h,this._startVector);return Math.abs(w)<g},p}(Hn);function zn(d){return Math.abs(d.y)>Math.abs(d.x)}var hs=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(h){this._lastPoints=h,zn(h[0].sub(h[1]))&&(this._valid=!1)},p.prototype._move=function(h,g,w){var D=h[0].sub(this._lastPoints[0]),T=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(D,T,w.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(D.y+T.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(h,g,w){if(void 0!==this._valid)return this._valid;var D=h.mag()>=2,T=g.mag()>=2;if(D||T){if(!D||!T)return void 0===this._firstMove&&(this._firstMove=w),w-this._firstMove<100&&void 0;var I=h.y>0==g.y>0;return zn(h)&&zn(g)&&I}},p}(Hn),rn={panStep:100,bearingStep:15,pitchStep:10},wo=function(){var d=rn;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1};function eh(d){return d*(2-d)}wo.prototype.reset=function(){this._active=!1},wo.prototype.keydown=function(d){var p=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var h=0,g=0,w=0,D=0,T=0;switch(d.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:d.shiftKey?g=-1:(d.preventDefault(),D=-1);break;case 39:d.shiftKey?g=1:(d.preventDefault(),D=1);break;case 38:d.shiftKey?w=1:(d.preventDefault(),T=-1);break;case 40:d.shiftKey?w=-1:(d.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:function(I){var R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:eh,zoom:h?Math.round(R)+h*(d.shiftKey?2:1):R,bearing:I.getBearing()+g*p._bearingStep,pitch:I.getPitch()+w*p._pitchStep,offset:[-D*p._panStep,-T*p._panStep],center:I.getCenter()},{originalEvent:d})}}}},wo.prototype.enable=function(){this._enabled=!0},wo.prototype.disable=function(){this._enabled=!1,this.reset()},wo.prototype.isEnabled=function(){return this._enabled},wo.prototype.isActive=function(){return this._active},wo.prototype.disableRotation=function(){this._rotationDisabled=!0},wo.prototype.enableRotation=function(){this._rotationDisabled=!1};var ar=function(d,p){this._map=d,this._el=d.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,v.bindAll(["_onTimeout"],this)};ar.prototype.setZoomRate=function(d){this._defaultZoomRate=d},ar.prototype.setWheelZoomRate=function(d){this._wheelZoomRate=d},ar.prototype.isEnabled=function(){return!!this._enabled},ar.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ar.prototype.isZooming=function(){return!!this._zooming},ar.prototype.enable=function(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=d&&"center"===d.around)},ar.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ar.prototype.wheel=function(d){if(this.isEnabled()){var p=d.deltaMode===v.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY,h=v.browser.now(),g=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,0!==p&&p%4.000244140625==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(g*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),d.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=d,this._delta-=p,this._active||this._start(d)),d.preventDefault()}},ar.prototype._onTimeout=function(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},ar.prototype._start=function(d){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=He.mousePos(this._el,d);this._around=v.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ar.prototype.renderFrame=function(){var d=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(0!==this._delta){var h="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&0!==g&&(g=1/g);var w="number"==typeof this._targetZoom?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(w*g))),"wheel"===this._type&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var D,T="number"==typeof this._targetZoom?this._targetZoom:p.zoom,I=this._startZoom,R=this._easing,F=!1;if("wheel"===this._type&&I&&R){var W=Math.min((v.browser.now()-this._lastWheelEventTime)/200,1),Z=R(W);D=v.number(I,T,Z),W<1?this._frameId||(this._frameId=!0):F=!0}else D=T,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(function(){d._zooming=!1,d._handler._triggerRenderFrame(),delete d._targetZoom,delete d._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:D-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ar.prototype._smoothOutEasing=function(d){var p=v.ease;if(this._prevEase){var h=this._prevEase,g=(v.browser.now()-h.start)/h.duration,w=h.easing(g+.01)-h.easing(g),D=.27/Math.sqrt(w*w+1e-4)*.01,T=Math.sqrt(.0729-D*D);p=v.bezier(D,T,.25,1)}return this._prevEase={start:v.browser.now(),duration:d,easing:p},p},ar.prototype.reset=function(){this._active=!1};var Kt=function(d,p){this._clickZoom=d,this._tapZoom=p};Kt.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Kt.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Kt.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Kt.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ki=function(){this.reset()};Ki.prototype.reset=function(){this._active=!1},Ki.prototype.dblclick=function(d,p){return d.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(d.shiftKey?-1:1),around:h.unproject(p)},{originalEvent:d})}}},Ki.prototype.enable=function(){this._enabled=!0},Ki.prototype.disable=function(){this._enabled=!1,this.reset()},Ki.prototype.isEnabled=function(){return this._enabled},Ki.prototype.isActive=function(){return this._active};var Yi=function(){this._tap=new ac({numTouches:1,numTaps:1}),this.reset()};Yi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Yi.prototype.touchstart=function(d,p,h){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=p[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(d,p,h))},Yi.prototype.touchmove=function(d,p,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var g=p[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,d.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(d,p,h)},Yi.prototype.touchend=function(d,p,h){this._tapTime?this._swipePoint&&0===h.length&&this.reset():this._tap.touchend(d,p,h)&&(this._tapTime=d.timeStamp)},Yi.prototype.touchcancel=function(){this.reset()},Yi.prototype.enable=function(){this._enabled=!0},Yi.prototype.disable=function(){this._enabled=!1,this.reset()},Yi.prototype.isEnabled=function(){return this._enabled},Yi.prototype.isActive=function(){return this._active};var gi=function(d,p,h){this._el=d,this._mousePan=p,this._touchPan=h};gi.prototype.enable=function(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},gi.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},gi.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},gi.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var xo=function(d,p,h){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=p,this._mousePitch=h};xo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},xo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},xo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},xo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ha=function(d,p,h,g){this._el=d,this._touchZoom=p,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};ha.prototype.enable=function(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},ha.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},ha.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ha.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ha.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ha.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var es=function(d){return d.zoom||d.drag||d.pitch||d.rotate},ts=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p}(v.Event);function Bs(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}var tt=function(d,p){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sc(d),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),v.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[v.window.document,"mousemove",{capture:!0}],[v.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[v.window,"blur",void 0]];for(var g=0,w=this._listeners;g<w.length;g+=1){var D=w[g],T=D[0];He.addEventListener(T,D[1],T===v.window.document?this.handleWindowEvent:this.handleEvent,D[2])}};tt.prototype.destroy=function(){for(var d=0,p=this._listeners;d<p.length;d+=1){var h=p[d],g=h[0];He.removeEventListener(g,h[1],g===v.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},tt.prototype._addDefaultHandlers=function(d){var p=this._map,h=p.getCanvasContainer();this._add("mapEvent",new ki(p,d));var g=p.boxZoom=new lt(p,d);this._add("boxZoom",g);var w=new Vo,D=new Ki;p.doubleClickZoom=new Kt(D,w),this._add("tapZoom",w),this._add("clickZoom",D);var T=new Yi;this._add("tapDragZoom",T);var I=p.touchPitch=new hs;this._add("touchPitch",I);var R=new Jr(d),F=new Ke(d);p.dragRotate=new xo(d,R,F),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);var W=new mt(d),Z=new Bt(d);p.dragPan=new gi(h,W,Z),this._add("mousePan",W),this._add("touchPan",Z,["touchZoom","touchRotate"]);var $=new Nn,se=new xl;p.touchZoomRotate=new ha(h,se,$,T),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]);var re=p.scrollZoom=new ar(p,this);this._add("scrollZoom",re,["mousePan"]);var de=p.keyboard=new wo;this._add("keyboard",de),this._add("blockableMapEvent",new co(p));for(var ie=0,le=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ie<le.length;ie+=1){var _e=le[ie];d.interactive&&d[_e]&&p[_e].enable(d[_e])}},tt.prototype._add=function(d,p,h){this._handlers.push({handlerName:d,handler:p,allowed:h}),this._handlersById[d]=p},tt.prototype.stop=function(d){if(!this._updatingCamera){for(var p=0,h=this._handlers;p<h.length;p+=1)h[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}},tt.prototype.isActive=function(){for(var d=0,p=this._handlers;d<p.length;d+=1)if(p[d].handler.isActive())return!0;return!1},tt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},tt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},tt.prototype.isMoving=function(){return!!es(this._eventsInProgress)||this.isZooming()},tt.prototype._blockedByActive=function(d,p,h){for(var g in d)if(g!==h&&(!p||p.indexOf(g)<0))return!0;return!1},tt.prototype.handleWindowEvent=function(d){this.handleEvent(d,d.type+"Window")},tt.prototype._getMapTouches=function(d){for(var p=[],h=0,g=d;h<g.length;h+=1){var w=g[h];this._el.contains(w.target)&&p.push(w)}return p},tt.prototype.handleEvent=function(d,p){if("blur"!==d.type){this._updatingCamera=!0;for(var h="renderFrame"===d.type?void 0:d,g={needsRenderFrame:!1},w={},D={},T=d.touches?this._getMapTouches(d.touches):void 0,I=T?He.touchPos(this._el,T):He.mousePos(this._el,d),R=0,F=this._handlers;R<F.length;R+=1){var W=F[R],Z=W.handlerName,$=W.handler,se=W.allowed;if($.isEnabled()){var re=void 0;this._blockedByActive(D,se,Z)?$.reset():$[p||d.type]&&(re=$[p||d.type](d,I,T),this.mergeHandlerResult(g,w,re,Z,h),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||$.isActive())&&(D[Z]=$)}}var de={};for(var ie in this._previousActiveHandlers)D[ie]||(de[ie]=h);this._previousActiveHandlers=D,(Object.keys(de).length||Bs(g))&&(this._changes.push([g,w,de]),this._triggerRenderFrame()),(Object.keys(D).length||Bs(g))&&this._map._stop(!0),this._updatingCamera=!1;var le=g.cameraAnimation;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))}else this.stop(!0)},tt.prototype.mergeHandlerResult=function(d,p,h,g,w){if(h){v.extend(d,h);var D={handlerName:g,originalEvent:h.originalEvent||w};void 0!==h.zoomDelta&&(p.zoom=D),void 0!==h.panDelta&&(p.drag=D),void 0!==h.pitchDelta&&(p.pitch=D),void 0!==h.bearingDelta&&(p.rotate=D)}},tt.prototype._applyChanges=function(){for(var d={},p={},h={},g=0,w=this._changes;g<w.length;g+=1){var D=w[g],T=D[0],I=D[1],R=D[2];T.panDelta&&(d.panDelta=(d.panDelta||new v.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(d.around=T.around),void 0!==T.pinchAround&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),v.extend(p,I),v.extend(h,R)}this._updateMapTransform(d,p,h),this._changes=[]},tt.prototype._updateMapTransform=function(d,p,h){var g=this._map,w=g.transform;if(!Bs(d))return this._fireEvents(p,h,!0);var D=d.panDelta,T=d.zoomDelta,I=d.bearingDelta,R=d.pitchDelta,F=d.around,W=d.pinchAround;void 0!==W&&(F=W),g._stop(!0),F=F||g.transform.centerPoint;var Z=w.pointLocation(D?F.sub(D):F);I&&(w.bearing+=I),R&&(w.pitch+=R),T&&(w.zoom+=T),w.setLocationAtPoint(Z,F),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(p,h,!0)},tt.prototype._fireEvents=function(d,p,h){var g=this,w=es(this._eventsInProgress),D=es(d),T={};for(var I in d)this._eventsInProgress[I]||(T[I+"start"]=d[I].originalEvent),this._eventsInProgress[I]=d[I];for(var R in!w&&D&&this._fireEvent("movestart",D.originalEvent),T)this._fireEvent(R,T[R]);for(var F in D&&this._fireEvent("move",D.originalEvent),d)this._fireEvent(F,d[F].originalEvent);var W,Z={};for(var $ in this._eventsInProgress){var se=this._eventsInProgress[$],re=se.handlerName,de=se.originalEvent;this._handlersById[re].isActive()||(delete this._eventsInProgress[$],Z[$+"end"]=W=p[re]||de)}for(var ie in Z)this._fireEvent(ie,Z[ie]);var le=es(this._eventsInProgress);if(h&&(w||D)&&!le){this._updatingCamera=!0;var _e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),we=function(Ae){return 0!==Ae&&-g._bearingSnap<Ae&&Ae<g._bearingSnap};_e?(we(_e.bearing||this._map.getBearing())&&(_e.bearing=0),this._map.easeTo(_e,{originalEvent:W})):(this._map.fire(new v.Event("moveend",{originalEvent:W})),we(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},tt.prototype._fireEvent=function(d,p){this._map.fire(new v.Event(d,p?{originalEvent:p}:{}))},tt.prototype._requestFrame=function(){var d=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete d._frameId,d.handleEvent(new ts("renderFrame",{timeStamp:p})),d._applyChanges()})},tt.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Ot=function(d){function p(h,g){d.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,v.bindAll(["_renderFrameCallback"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getCenter=function(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(h,g){return this.jumpTo({center:h},g)},p.prototype.panBy=function(h,g,w){return h=v.Point.convert(h).mult(-1),this.panTo(this.transform.center,v.extend({offset:h},g),w)},p.prototype.panTo=function(h,g,w){return this.easeTo(v.extend({center:h},g),w)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(h,g){return this.jumpTo({zoom:h},g),this},p.prototype.zoomTo=function(h,g,w){return this.easeTo(v.extend({zoom:h},g),w)},p.prototype.zoomIn=function(h,g){return this.zoomTo(this.getZoom()+1,h,g),this},p.prototype.zoomOut=function(h,g){return this.zoomTo(this.getZoom()-1,h,g),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(h,g){return this.jumpTo({bearing:h},g),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(h,g){return this.jumpTo({padding:h},g),this},p.prototype.rotateTo=function(h,g,w){return this.easeTo(v.extend({bearing:h},g),w)},p.prototype.resetNorth=function(h,g){return this.rotateTo(0,v.extend({duration:1e3},h),g),this},p.prototype.resetNorthPitch=function(h,g){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},h),g),this},p.prototype.snapToNorth=function(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(h,g){return this.jumpTo({pitch:h},g),this},p.prototype.cameraForBounds=function(h,g){h=v.LngLatBounds.convert(h);var w=g&&g.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),w,g)},p.prototype._cameraForBoxAndBearing=function(h,g,w,D){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(D=v.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},D)).padding){var I=D.padding;D.padding={top:I,bottom:I,right:I,left:I}}D.padding=v.extend(T,D.padding);var R=this.transform,F=R.padding,W=R.project(v.LngLat.convert(h)),Z=R.project(v.LngLat.convert(g)),$=W.rotate(-w*Math.PI/180),se=Z.rotate(-w*Math.PI/180),re=new v.Point(Math.max($.x,se.x),Math.max($.y,se.y)),de=new v.Point(Math.min($.x,se.x),Math.min($.y,se.y)),ie=re.sub(de),le=(R.width-(F.left+F.right+D.padding.left+D.padding.right))/ie.x,_e=(R.height-(F.top+F.bottom+D.padding.top+D.padding.bottom))/ie.y;if(!(_e<0||le<0)){var we=Math.min(R.scaleZoom(R.scale*Math.min(le,_e)),D.maxZoom),Ae="number"==typeof D.offset.x?new v.Point(D.offset.x,D.offset.y):v.Point.convert(D.offset),De=new v.Point((D.padding.left-D.padding.right)/2,(D.padding.top-D.padding.bottom)/2).rotate(w*Math.PI/180),Re=Ae.add(De).mult(R.scale/R.zoomScale(we));return{center:R.unproject(W.add(Z).div(2).sub(Re)),zoom:we,bearing:w}}v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(h,g,w){return this._fitInternal(this.cameraForBounds(h,g),g,w)},p.prototype.fitScreenCoordinates=function(h,g,w,D,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(v.Point.convert(h)),this.transform.pointLocation(v.Point.convert(g)),w,D),D,T)},p.prototype._fitInternal=function(h,g,w){return h?(delete(g=v.extend(h,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this},p.prototype.jumpTo=function(h,g){this.stop();var w=this.transform,D=!1,T=!1,I=!1;return"zoom"in h&&w.zoom!==+h.zoom&&(D=!0,w.zoom=+h.zoom),void 0!==h.center&&(w.center=v.LngLat.convert(h.center)),"bearing"in h&&w.bearing!==+h.bearing&&(T=!0,w.bearing=+h.bearing),"pitch"in h&&w.pitch!==+h.pitch&&(I=!0,w.pitch=+h.pitch),null==h.padding||w.isPaddingEqual(h.padding)||(w.padding=h.padding),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g)),D&&this.fire(new v.Event("zoomstart",g)).fire(new v.Event("zoom",g)).fire(new v.Event("zoomend",g)),T&&this.fire(new v.Event("rotatestart",g)).fire(new v.Event("rotate",g)).fire(new v.Event("rotateend",g)),I&&this.fire(new v.Event("pitchstart",g)).fire(new v.Event("pitch",g)).fire(new v.Event("pitchend",g)),this.fire(new v.Event("moveend",g))},p.prototype.easeTo=function(h,g){var w=this;this._stop(!1,h.easeId),(!1===(h=v.extend({offset:[0,0],duration:500,easing:v.ease},h)).animate||!h.essential&&v.browser.prefersReducedMotion)&&(h.duration=0);var D=this.transform,T=this.getZoom(),I=this.getBearing(),R=this.getPitch(),F=this.getPadding(),W="zoom"in h?+h.zoom:T,Z="bearing"in h?this._normalizeBearing(h.bearing,I):I,$="pitch"in h?+h.pitch:R,se="padding"in h?h.padding:D.padding,re=v.Point.convert(h.offset),de=D.centerPoint.add(re),ie=D.pointLocation(de),le=v.LngLat.convert(h.center||ie);this._normalizeCenter(le);var _e,we,Ae=D.project(ie),De=D.project(le).sub(Ae),Re=D.zoomScale(W-T);h.around&&(_e=v.LngLat.convert(h.around),we=D.locationPoint(_e));var Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||W!==T,this._rotating=this._rotating||I!==Z,this._pitching=this._pitching||$!==R,this._padding=!D.isPaddingEqual(se),this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,Ve),this._ease(function(Qe){if(w._zooming&&(D.zoom=v.number(T,W,Qe)),w._rotating&&(D.bearing=v.number(I,Z,Qe)),w._pitching&&(D.pitch=v.number(R,$,Qe)),w._padding&&(D.interpolatePadding(F,se,Qe),de=D.centerPoint.add(re)),_e)D.setLocationAtPoint(_e,we);else{var We=D.zoomScale(D.zoom-T),ct=W>T?Math.min(2,Re):Math.max(.5,Re),Ct=Math.pow(ct,1-Qe),kt=D.unproject(Ae.add(De.mult(Qe*Ct)).mult(We));D.setLocationAtPoint(D.renderWorldCopies?kt.wrap():kt,de)}w._fireMoveEvents(g)},function(Qe){w._afterEase(g,Qe)},h),this},p.prototype._prepareEase=function(h,g,w){void 0===w&&(w={}),this._moving=!0,g||w.moving||this.fire(new v.Event("movestart",h)),this._zooming&&!w.zooming&&this.fire(new v.Event("zoomstart",h)),this._rotating&&!w.rotating&&this.fire(new v.Event("rotatestart",h)),this._pitching&&!w.pitching&&this.fire(new v.Event("pitchstart",h))},p.prototype._fireMoveEvents=function(h){this.fire(new v.Event("move",h)),this._zooming&&this.fire(new v.Event("zoom",h)),this._rotating&&this.fire(new v.Event("rotate",h)),this._pitching&&this.fire(new v.Event("pitch",h))},p.prototype._afterEase=function(h,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var w=this._zooming,D=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new v.Event("zoomend",h)),D&&this.fire(new v.Event("rotateend",h)),T&&this.fire(new v.Event("pitchend",h)),this.fire(new v.Event("moveend",h))}},p.prototype.flyTo=function(h,g){var w=this;if(!h.essential&&v.browser.prefersReducedMotion){var D=v.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(D,g)}this.stop(),h=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},h);var T=this.transform,I=this.getZoom(),R=this.getBearing(),F=this.getPitch(),W=this.getPadding(),Z="zoom"in h?v.clamp(+h.zoom,T.minZoom,T.maxZoom):I,$="bearing"in h?this._normalizeBearing(h.bearing,R):R,se="pitch"in h?+h.pitch:F,re="padding"in h?h.padding:T.padding,de=T.zoomScale(Z-I),ie=v.Point.convert(h.offset),le=T.centerPoint.add(ie),_e=T.pointLocation(le),we=v.LngLat.convert(h.center||_e);this._normalizeCenter(we);var Ae=T.project(_e),De=T.project(we).sub(Ae),Re=h.curve,Ve=Math.max(T.width,T.height),Qe=Ve/de,We=De.mag();if("minZoom"in h){var ct=v.clamp(Math.min(h.minZoom,I,Z),T.minZoom,T.maxZoom),Ct=Ve/T.zoomScale(ct-I);Re=Math.sqrt(Ct/We*2)}var kt=Re*Re;function It(jt){var Pt=(Qe*Qe-Ve*Ve+(jt?-1:1)*kt*kt*We*We)/(2*(jt?Qe:Ve)*kt*We);return Math.log(Math.sqrt(Pt*Pt+1)-Pt)}function gn(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function ft(jt){return(Math.exp(jt)+Math.exp(-jt))/2}var Xt=It(0),hn=function(jt){return ft(Xt)/ft(Xt+Re*jt)},et=function(jt){return Ve*((ft(Xt)*(gn(Pt=Xt+Re*jt)/ft(Pt))-gn(Xt))/kt)/We;var Pt},zt=(It(1)-Xt)/Re;if(Math.abs(We)<1e-6||!isFinite(zt)){if(Math.abs(Ve-Qe)<1e-6)return this.easeTo(h,g);var qt=Qe<Ve?-1:1;zt=Math.abs(Math.log(Qe/Ve))/Re,et=function(){return 0},hn=function(jt){return Math.exp(qt*Re*jt)}}return h.duration="duration"in h?+h.duration:1e3*zt/("screenSpeed"in h?+h.screenSpeed/Re:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=R!==$,this._pitching=se!==F,this._padding=!T.isPaddingEqual(re),this._prepareEase(g,!1),this._ease(function(jt){var Pt=jt*zt,lr=1/hn(Pt);T.zoom=1===jt?Z:I+T.scaleZoom(lr),w._rotating&&(T.bearing=v.number(R,$,jt)),w._pitching&&(T.pitch=v.number(F,se,jt)),w._padding&&(T.interpolatePadding(W,re,jt),le=T.centerPoint.add(ie));var qr=1===jt?we:T.unproject(Ae.add(De.mult(et(Pt))).mult(lr));T.setLocationAtPoint(T.renderWorldCopies?qr.wrap():qr,le),w._fireMoveEvents(g)},function(){return w._afterEase(g)},h),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,g)}if(!h){var D=this.handlers;D&&D.stop(!1)}return this},p.prototype._ease=function(h,g,w){!1===w.animate||0===w.duration?(h(1),g()):(this._easeStart=v.browser.now(),this._easeOptions=w,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var h=Math.min((v.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(h,g){h=v.wrap(h,-180,180);var w=Math.abs(h-g);return Math.abs(h-360-g)<w&&(h-=360),Math.abs(h+360-g)<w&&(h+=360),h},p.prototype._normalizeCenter=function(h){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var w=h.lng-g.center.lng;h.lng+=w>180?-360:w<-180?360:0}},p}(v.Evented),_i=function(d){void 0===d&&(d={}),this.options=d,v.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_i.prototype.getDefaultPosition=function(){return"bottom-right"},_i.prototype.onAdd=function(d){var p=this.options&&this.options.compact;return this._map=d,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=He.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=He.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_i.prototype.onRemove=function(){He.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_i.prototype._setElementTitle=function(d,p){var h=this._map._getUIString("AttributionControl."+p);d.title=h,d.setAttribute("aria-label",h)},_i.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_i.prototype._updateEditLink=function(){var d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||v.config.ACCESS_TOKEN}];if(d){var h=p.reduce(function(g,w,D){return w.value&&(g+=w.key+"="+w.value+(D<p.length-1?"&":"")),g},"?");d.href=v.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}},_i.prototype._updateData=function(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())},_i.prototype._updateAttributions=function(){if(this._map.style){var d=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=d.concat(this.options.customAttribution.map(function(I){return"string"!=typeof I?"":I})):"string"==typeof this.options.customAttribution&&d.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var h=this._map.style.sourceCaches;for(var g in h){var w=h[g];if(w.used){var D=w.getSource();D.attribution&&d.indexOf(D.attribution)<0&&d.push(D.attribution)}}d.sort(function(I,R){return I.length-R.length});var T=(d=d.filter(function(I,R){for(var F=R+1;F<d.length;F++)if(d[F].indexOf(I)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,d.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},_i.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var Lt=function(){v.bindAll(["_updateLogo"],this),v.bindAll(["_updateCompact"],this)};Lt.prototype.onAdd=function(d){this._map=d,this._container=He.create("div","maplibregl-ctrl mapboxgl-ctrl");var p=He.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Lt.prototype.onRemove=function(){He.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Lt.prototype.getDefaultPosition=function(){return"bottom-left"},Lt.prototype._updateLogo=function(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Lt.prototype._logoRequired=function(){if(this._map.style){var d=this._map.style.sourceCaches;for(var p in d)if(d[p].getSource().mapbox_logo)return!0;return!1}},Lt.prototype._updateCompact=function(){var d=this._container.children;if(d.length){var p=d[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}};var fa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};fa.prototype.add=function(d){var p=++this._id;return this._queue.push({callback:d,id:p,cancelled:!1}),p},fa.prototype.remove=function(d){for(var p=this._currentlyRunning,h=0,g=p?this._queue.concat(p):this._queue;h<g.length;h+=1){var w=g[h];if(w.id===d)return void(w.cancelled=!0)}},fa.prototype.run=function(d){void 0===d&&(d=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,g=p;h<g.length;h+=1){var w=g[h];if(!w.cancelled&&(w.callback(d),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},fa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var yi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ai=v.window.HTMLImageElement,kf=v.window.HTMLElement,fs=v.window.ImageBitmap,Zt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Cn=function(d){function p(g){var w=this;if(null!=(g=v.extend({},Zt,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var D=new er(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(d.call(this,D,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new fa,this._controls=[],this._mapId=v.uniqueId(),this._locale=v.extend({},yi,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new v.RequestManager(g.transformRequest,g.accessToken),"string"==typeof g.container){if(this._container=v.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof kf))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),v.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return w._update(!1)}),this.on("moveend",function(){return w._update(!1)}),this.on("zoom",function(){return w._update(!0)}),void 0!==v.window&&(v.window.addEventListener("online",this._onWindowOnline,!1),v.window.addEventListener("resize",this._onWindowResize,!1),v.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new tt(this,g),this._hash=g.hash&&new Jo("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,v.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new _i({customAttribution:g.customAttribution})),this.addControl(new Lt,g.logoPosition),this.on("style.load",function(){w.transform.unmodified&&w.jumpTo(w.style.stylesheet)}),this.on("data",function(T){w._update("style"===T.dataType),w.fire(new v.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){w.fire(new v.Event(T.dataType+"dataloading",T))})}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(g,w){if(void 0===w&&(w=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var D=g.onAdd(this);this._controls.push(g);var T=this._controlPositions[w];return-1!==w.indexOf("bottom")?T.insertBefore(D,T.firstChild):T.appendChild(D),this},p.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var w=this._controls.indexOf(g);return w>-1&&this._controls.splice(w,1),g.onRemove(this),this},p.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},p.prototype.resize=function(g){var w=this._containerDimensions(),D=w[0],T=w[1];this._resizeCanvas(D,T),this.transform.resize(D,T),this.painter.resize(D,T);var I=!this._moving;return I&&(this.stop(),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g))),this.fire(new v.Event("resize",g)),I&&this.fire(new v.Event("moveend",g)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(v.LngLatBounds.convert(g)),this._update()},p.prototype.setMinZoom=function(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(g){if((g=g??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},p.prototype.project=function(g){return this.transform.locationPoint(v.LngLat.convert(g))},p.prototype.unproject=function(g){return this.transform.pointLocation(v.Point.convert(g))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(g,w,D){var T,I=this;if("mouseenter"===g||"mouseover"===g){var R=!1;return{layer:w,listener:D,delegates:{mousemove:function(W){var Z=I.getLayer(w)?I.queryRenderedFeatures(W.point,{layers:[w]}):[];Z.length?R||(R=!0,D.call(I,new $i(g,I,W.originalEvent,{features:Z}))):R=!1},mouseout:function(){R=!1}}}}if("mouseleave"===g||"mouseout"===g){var F=!1;return{layer:w,listener:D,delegates:{mousemove:function(W){(I.getLayer(w)?I.queryRenderedFeatures(W.point,{layers:[w]}):[]).length?F=!0:F&&(F=!1,D.call(I,new $i(g,I,W.originalEvent)))},mouseout:function(W){F&&(F=!1,D.call(I,new $i(g,I,W.originalEvent)))}}}}return{layer:w,listener:D,delegates:(T={},T[g]=function(W){var Z=I.getLayer(w)?I.queryRenderedFeatures(W.point,{layers:[w]}):[];Z.length&&(W.features=Z,D.call(I,W),delete W.features)},T)}},p.prototype.on=function(g,w,D){if(void 0===D)return d.prototype.on.call(this,g,w);var T=this._createDelegatedListener(g,w,D);for(var I in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(T),T.delegates)this.on(I,T.delegates[I]);return this},p.prototype.once=function(g,w,D){if(void 0===D)return d.prototype.once.call(this,g,w);var T=this._createDelegatedListener(g,w,D);for(var I in T.delegates)this.once(I,T.delegates[I]);return this},p.prototype.off=function(g,w,D){var T=this;return void 0===D?d.prototype.off.call(this,g,w):(this._delegatedListeners&&this._delegatedListeners[g]&&function(I){for(var R=I[g],F=0;F<R.length;F++){var W=R[F];if(W.layer===w&&W.listener===D){for(var Z in W.delegates)T.off(Z,W.delegates[Z]);return R.splice(F,1),T}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(g,w){if(!this.style)return[];var D;if(void 0!==w||void 0===g||g instanceof v.Point||Array.isArray(g)||(w=g,g=void 0),w=w||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof v.Point||"number"==typeof g[0])D=[v.Point.convert(g)];else{var T=v.Point.convert(g[0]),I=v.Point.convert(g[1]);D=[T,new v.Point(I.x,T.y),I,new v.Point(T.x,I.y),T]}return this.style.queryRenderedFeatures(D,w,this.transform)},p.prototype.querySourceFeatures=function(g,w){return this.style.querySourceFeatures(g,w)},p.prototype.setStyle=function(g,w){return!1!==(w=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},w)).diff&&w.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,w),this):(this._localIdeographFontFamily=w.localIdeographFontFamily,this._updateStyle(g,w))},p.prototype.setTransformRequest=function(g){return this._requestManager.setTransformRequest(g),this},p.prototype._getUIString=function(g){var w=this._locale[g];if(null==w)throw new Error("Missing UI string '"+g+"'");return w},p.prototype._updateStyle=function(g,w){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new tc(this,w||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new tc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(g,w){var D=this;if("string"==typeof g){var T=this._requestManager.normalizeStyleURL(g),I=this._requestManager.transformRequest(T,v.ResourceType.Style);v.getJSON(I,function(R,F){R?D.fire(new v.ErrorEvent(R)):F&&D._updateDiff(F,w)})}else"object"==typeof g&&this._updateDiff(g,w)},p.prototype._updateDiff=function(g,w){try{this.style.setState(g)&&this._update(!0)}catch(D){v.warnOnce("Unable to perform style diff: "+(D.message||D.error||D)+".  Rebuilding the style from scratch."),this._updateStyle(g,w)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(g,w){return this._lazyInitEmptyStyle(),this.style.addSource(g,w),this._update(!0)},p.prototype.isSourceLoaded=function(g){var w=this.style&&this.style.sourceCaches[g];if(void 0!==w)return w.loaded();this.fire(new v.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},p.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var w in g){var D=g[w]._tiles;for(var T in D){var I=D[T];if("loaded"!==I.state&&"errored"!==I.state)return!1}}return!0},p.prototype.addSourceType=function(g,w,D){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,w,D)},p.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},p.prototype.getSource=function(g){return this.style.getSource(g)},p.prototype.addImage=function(g,w,D){void 0===D&&(D={});var T=D.pixelRatio;void 0===T&&(T=1);var I=D.sdf;void 0===I&&(I=!1);var R=D.stretchX,F=D.stretchY,W=D.content;if(this._lazyInitEmptyStyle(),w instanceof Ai||fs&&w instanceof fs){var Z=v.browser.getImageData(w);this.style.addImage(g,{data:new v.RGBAImage({width:Z.width,height:Z.height},Z.data),pixelRatio:T,stretchX:R,stretchY:F,content:W,sdf:I,version:0})}else{if(void 0===w.width||void 0===w.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var $=w;this.style.addImage(g,{data:new v.RGBAImage({width:w.width,height:w.height},new Uint8Array(w.data)),pixelRatio:T,stretchX:R,stretchY:F,content:W,sdf:I,version:0,userImage:$}),$.onAdd&&$.onAdd(this,g)}},p.prototype.updateImage=function(g,w){var D=this.style.getImage(g);if(!D)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=w instanceof Ai||fs&&w instanceof fs?v.browser.getImageData(w):w,I=T.width,R=T.height,F=T.data;return void 0===I||void 0===R?this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):I!==D.data.width||R!==D.data.height?this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(D.data.replace(F,!(w instanceof Ai||fs&&w instanceof fs)),void this.style.updateImage(g,D))},p.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(g){this.style.removeImage(g)},p.prototype.loadImage=function(g,w){v.getImage(this._requestManager.transformRequest(g,v.ResourceType.Image),w)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(g,w){return this._lazyInitEmptyStyle(),this.style.addLayer(g,w),this._update(!0)},p.prototype.moveLayer=function(g,w){return this.style.moveLayer(g,w),this._update(!0)},p.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},p.prototype.getLayer=function(g){return this.style.getLayer(g)},p.prototype.setLayerZoomRange=function(g,w,D){return this.style.setLayerZoomRange(g,w,D),this._update(!0)},p.prototype.setFilter=function(g,w,D){return void 0===D&&(D={}),this.style.setFilter(g,w,D),this._update(!0)},p.prototype.getFilter=function(g){return this.style.getFilter(g)},p.prototype.setPaintProperty=function(g,w,D,T){return void 0===T&&(T={}),this.style.setPaintProperty(g,w,D,T),this._update(!0)},p.prototype.getPaintProperty=function(g,w){return this.style.getPaintProperty(g,w)},p.prototype.setLayoutProperty=function(g,w,D,T){return void 0===T&&(T={}),this.style.setLayoutProperty(g,w,D,T),this._update(!0)},p.prototype.getLayoutProperty=function(g,w){return this.style.getLayoutProperty(g,w)},p.prototype.setLight=function(g,w){return void 0===w&&(w={}),this._lazyInitEmptyStyle(),this.style.setLight(g,w),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(g,w){return this.style.setFeatureState(g,w),this._update()},p.prototype.removeFeatureState=function(g,w){return this.style.removeFeatureState(g,w),this._update()},p.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var g=0,w=0;return this._container&&(g=this._container.clientWidth||400,w=this._container.clientHeight||300),[g,w]},p.prototype._setupContainer=function(){var g=this._container;g.classList.add("maplibregl-map","mapboxgl-map");var w=this._canvasContainer=He.create("div","maplibregl-canvas-container mapboxgl-canvas-container",g);this._interactive&&w.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=He.create("canvas","maplibregl-canvas mapboxgl-canvas",w),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var D=this._containerDimensions();this._resizeCanvas(D[0],D[1]);var T=this._controlContainer=He.create("div","maplibregl-control-container mapboxgl-control-container",g),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(R){I[R]=He.create("div","maplibregl-ctrl-"+R+" mapboxgl-ctrl-"+R,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(g,w){var D=v.browser.devicePixelRatio||1;this._canvas.width=D*g,this._canvas.height=D*w,this._canvas.style.width=g+"px",this._canvas.style.height=w+"px"},p.prototype._setupPainter=function(){var g=v.extend({},Qo.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),w=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);w?(this.painter=new pr(w,this.transform),v.webpSupported.testSupport(w)):this.fire(new v.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:g}))},p.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:g}))},p.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},p.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},p.prototype._render=function(g){var w,D=this,T=0,I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(w=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,w),T=v.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var F=this.transform.zoom,W=v.browser.now();this.style.zoomHistory.update(F,W);var Z=new v.EvaluationParameters(F,{now:W,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=Z.crossFadingFactor();1===$&&$===this._crossFadingFactor||(R=!0,this._crossFadingFactor=$),this.style.update(Z)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var se=v.browser.now()-T;I.endQueryEXT(I.TIME_ELAPSED_EXT,w),setTimeout(function(){var ie=I.getQueryObjectEXT(w,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(w),D.fire(new v.Event("gpu-timing-frame",{cpuTime:se,gpuTime:ie}))},50)}if(this.listens("gpu-timing-layer")){var re=this.painter.collectGpuTimers();setTimeout(function(){var ie=D.painter.queryGpuTimers(re);D.fire(new v.Event("gpu-timing-layer",{layerTimes:ie}))},50)}var de=this._sourcesDirty||this._styleDirty||this._placementDirty;return de||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.Event("idle")),!this._loaded||this._fullyLoaded||de||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,w=this._controls;g<w.length;g+=1)w[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==v.window&&(v.window.removeEventListener("resize",this._onWindowResize,!1),v.window.removeEventListener("orientationchange",this._onWindowResize,!1),v.window.removeEventListener("online",this._onWindowOnline,!1));var D=this.painter.context.gl.getExtension("WEBGL_lose_context");D&&D.loseContext(),Eo(this._canvasContainer),Eo(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new v.Event("remove"))},p.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=v.browser.frame(function(w){g._frame=null,g._render(w)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(g){this._vertices=g,this._update()},p.prototype._setCacheLimits=function(g,w){v.setCacheLimits(g,w)},h.version.get=function(){return v.version},Object.defineProperties(p.prototype,h),p}(Ot);function Eo(d){d.parentNode&&d.parentNode.removeChild(d)}var Yu={showCompass:!0,showZoom:!0,visualizePitch:!1},uo=function(d){var p=this;this.options=v.extend({},Yu,d),this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(h){return p._map.zoomIn({},{originalEvent:h})}),He.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(h){return p._map.zoomOut({},{originalEvent:h})}),He.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(h){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:h}):p._map.resetNorth({},{originalEvent:h})}),this._compassIcon=He.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};uo.prototype._updateZoomButtons=function(){var d=this._map.getZoom(),p=d===this._map.getMaxZoom(),h=d===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},uo.prototype._rotateCompassArrow=function(){var d=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=d},uo.prototype.onAdd=function(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xi(this._map,this._compass,this.options.visualizePitch)),this._container},uo.prototype.onRemove=function(){He.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},uo.prototype._createButton=function(d,p){var h=He.create("button",d,this._container);return h.type="button",h.addEventListener("click",p),h},uo.prototype._setButtonTitle=function(d,p){var h=this._map._getUIString("NavigationControl."+p);d.title=h,d.setAttribute("aria-label",h)};var Xi=function(d,p,h){void 0===h&&(h=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new Jr({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,h&&(this.mousePitch=new Ke({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),He.addEventListener(p,"mousedown",this.mousedown),He.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),He.addEventListener(p,"touchmove",this.touchmove),He.addEventListener(p,"touchend",this.touchend),He.addEventListener(p,"touchcancel",this.reset)};function ps(d,p,h){if(d=new v.LngLat(d.lng,d.lat),p){var g=new v.LngLat(d.lng-360,d.lat),w=new v.LngLat(d.lng+360,d.lat),D=h.locationPoint(d).distSqr(p);h.locationPoint(g).distSqr(p)<D?d=g:h.locationPoint(w).distSqr(p)<D&&(d=w)}for(;Math.abs(d.lng-h.center.lng)>180;){var T=h.locationPoint(d);if(T.x>=0&&T.y>=0&&T.x<=h.width&&T.y<=h.height)break;d.lng>h.center.lng?d.lng-=360:d.lng+=360}return d}Xi.prototype.down=function(d,p){this.mouseRotate.mousedown(d,p),this.mousePitch&&this.mousePitch.mousedown(d,p),He.disableDrag()},Xi.prototype.move=function(d,p){var h=this.map,g=this.mouseRotate.mousemoveWindow(d,p);if(g&&g.bearingDelta&&h.setBearing(h.getBearing()+g.bearingDelta),this.mousePitch){var w=this.mousePitch.mousemoveWindow(d,p);w&&w.pitchDelta&&h.setPitch(h.getPitch()+w.pitchDelta)}},Xi.prototype.off=function(){var d=this.element;He.removeEventListener(d,"mousedown",this.mousedown),He.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),He.removeEventListener(d,"touchmove",this.touchmove),He.removeEventListener(d,"touchend",this.touchend),He.removeEventListener(d,"touchcancel",this.reset),this.offTemp()},Xi.prototype.offTemp=function(){He.enableDrag(),He.removeEventListener(v.window,"mousemove",this.mousemove),He.removeEventListener(v.window,"mouseup",this.mouseup)},Xi.prototype.mousedown=function(d){this.down(v.extend({},d,{ctrlKey:!0,preventDefault:function(){return d.preventDefault()}}),He.mousePos(this.element,d)),He.addEventListener(v.window,"mousemove",this.mousemove),He.addEventListener(v.window,"mouseup",this.mouseup)},Xi.prototype.mousemove=function(d){this.move(d,He.mousePos(this.element,d))},Xi.prototype.mouseup=function(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()},Xi.prototype.touchstart=function(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=He.touchPos(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return d.preventDefault()}},this._startPos))},Xi.prototype.touchmove=function(d){1!==d.targetTouches.length?this.reset():(this._lastPos=He.touchPos(this.element,d.targetTouches)[0],this.move({preventDefault:function(){return d.preventDefault()}},this._lastPos))},Xi.prototype.touchend=function(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Xi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ms={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lc(d,p,h){var g=d.classList;for(var w in ms)g.remove("maplibregl-"+h+"-anchor-"+w,"mapboxgl-"+h+"-anchor-"+w);g.add("maplibregl-"+h+"-anchor-"+p,"mapboxgl-"+h+"-anchor-"+p)}var th,Vs=function(d){function p(h,g){if(d.call(this),(h instanceof v.window.HTMLElement||g)&&(h=v.extend({element:h},g)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&"auto"!==h.pitchAlignment?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=v.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=He.create("div"),this._element.setAttribute("aria-label","Map marker");var w=He.createNS("http://www.w3.org/2000/svg","svg");w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height","41px"),w.setAttributeNS(null,"width","27px"),w.setAttributeNS(null,"viewBox","0 0 27 41");var D=He.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"stroke","none"),D.setAttributeNS(null,"stroke-width","1"),D.setAttributeNS(null,"fill","none"),D.setAttributeNS(null,"fill-rule","evenodd");var T=He.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var I=He.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");for(var R=0,F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];R<F.length;R+=1){var W=F[R],Z=He.createNS("http://www.w3.org/2000/svg","ellipse");Z.setAttributeNS(null,"opacity","0.04"),Z.setAttributeNS(null,"cx","10.5"),Z.setAttributeNS(null,"cy","5.80029008"),Z.setAttributeNS(null,"rx",W.rx),Z.setAttributeNS(null,"ry",W.ry),I.appendChild(Z)}var $=He.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill",this._color);var se=He.createNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),$.appendChild(se);var re=He.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"opacity","0.25"),re.setAttributeNS(null,"fill","#000000");var de=He.createNS("http://www.w3.org/2000/svg","path");de.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),re.appendChild(de);var ie=He.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ie.setAttributeNS(null,"fill","#FFFFFF");var le=He.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _e=He.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#000000"),_e.setAttributeNS(null,"opacity","0.25"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962");var we=He.createNS("http://www.w3.org/2000/svg","circle");we.setAttributeNS(null,"fill","#FFFFFF"),we.setAttributeNS(null,"cx","5.5"),we.setAttributeNS(null,"cy","5.5"),we.setAttributeNS(null,"r","5.4999962"),le.appendChild(_e),le.appendChild(we),T.appendChild(I),T.appendChild($),T.appendChild(re),T.appendChild(ie),T.appendChild(le),w.appendChild(T),w.setAttributeNS(null,"height",41*this._scale+"px"),w.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(w),this._offset=v.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ae){Ae.preventDefault()}),this._element.addEventListener("mousedown",function(Ae){Ae.preventDefault()}),lc(this._element,this._anchor,"marker"),this._popup=null}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),He.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(h){var g=h.code,w=h.charCode||h.keyCode;"Space"!==g&&"Enter"!==g&&32!==w&&13!==w||this.togglePopup()},p.prototype._onMapClick=function(h){var g=h.originalEvent.target,w=this._element;this._popup&&(g===w||w.contains(g))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},p.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ps(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var w="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?w="rotateX(0deg)":"map"===this._pitchAlignment&&(w="rotateX("+this._map.getPitch()+"deg)"),h&&"moveend"!==h.type||(this._pos=this._pos.round()),He.setTransform(this._element,ms[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+w+" "+g)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(h){return this._offset=v.Point.convert(h),this._update(),this},p.prototype._onMove=function(h){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&"auto"!==h?h:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(v.Evented),Af={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Mf=0,cc=!1,Xu=function(d){function p(h){d.call(this),this.options=v.extend({},Af,h),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.onAdd=function(h){var g;return this._map=h,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,void 0!==th?g(th):void 0!==v.window.navigator.permissions?v.window.navigator.permissions.query({name:"geolocation"}).then(function(w){g(th="denied"!==w.state)}):g(th=!!v.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),He.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Mf=0,cc=!1},p.prototype._isOutOfMapMaxBounds=function(h){var g=this._map.getMaxBounds(),w=h.coords;return g&&(w.longitude<g.getWest()||w.longitude>g.getEast()||w.latitude<g.getSouth()||w.latitude>g.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("geolocate",h)),this._finish()}},p.prototype._updateCamera=function(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude),w=h.coords.accuracy,D=this._map.getBearing(),T=v.extend({bearing:D},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(w),T,{geolocateSource:!0})},p.prototype._updateMarker=function(h){if(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,g=this._map.unproject([0,h]),w=this._map.unproject([1,h]),D=g.distanceTo(w),T=Math.ceil(2*this._accuracy/D);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&cc)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("error",h)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(h){var g=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=He.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),He.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===h){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var w=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}else{var D=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=D,this._geolocateButton.setAttribute("aria-label",D)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=He.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Vs(this._dotElement),this._circleElement=He.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==g._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),g.fire(new v.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Mf--,cc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Mf>1?(h={maximumAge:6e5,timeout:0},cc=!0):(h=this.options.positionOptions,cc=!1),this._geolocationWatchID=v.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else v.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(v.Evented),zg={maxWidth:100,unit:"metric"},Qs=function(d){this.options=v.extend({},zg,d),v.bindAll(["_onMove","setUnit"],this)};function Jp(d,p,h){var g=h&&h.maxWidth||100,w=d._container.clientHeight/2,D=d.unproject([0,w]),T=d.unproject([g,w]),I=D.distanceTo(T);if(h&&"imperial"===h.unit){var R=3.2808*I;R>5280?Qu(p,g,R/5280,d._getUIString("ScaleControl.Miles")):Qu(p,g,R,d._getUIString("ScaleControl.Feet"))}else h&&"nautical"===h.unit?Qu(p,g,I/1852,d._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Qu(p,g,I/1e3,d._getUIString("ScaleControl.Kilometers")):Qu(p,g,I,d._getUIString("ScaleControl.Meters"))}function Qu(d,p,h,g){var w,D,T,R,F,I=(w=h,(D=Math.pow(10,(""+Math.floor(w)).length-1))*(T=(T=w/D)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(R=T,F=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10)),Math.round(R*F)/F)));d.style.width=p*(I/h)+"px",d.innerHTML=I+"&nbsp;"+g}Qs.prototype.getDefaultPosition=function(){return"bottom-left"},Qs.prototype._onMove=function(){Jp(this._map,this._container,this.options)},Qs.prototype.onAdd=function(d){return this._map=d,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Qs.prototype.onRemove=function(){He.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Qs.prototype.setUnit=function(d){this.options.unit=d,Jp(this._map,this._container,this.options)};var Js=function(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof v.window.HTMLElement?this._container=d.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),v.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in v.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in v.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in v.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in v.window.document&&(this._fullscreenchange="MSFullscreenChange")};Js.prototype.onAdd=function(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=He.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",v.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Js.prototype.onRemove=function(){He.remove(this._controlContainer),this._map=null,v.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Js.prototype._checkFullscreenSupport=function(){return!!(v.window.document.fullscreenEnabled||v.window.document.mozFullScreenEnabled||v.window.document.msFullscreenEnabled||v.window.document.webkitFullscreenEnabled)},Js.prototype._setupUI=function(){var d=this._fullscreenButton=He.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);He.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),v.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Js.prototype._updateTitle=function(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d},Js.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Js.prototype._isFullscreen=function(){return this._fullscreen},Js.prototype._changeIcon=function(){(v.window.document.fullscreenElement||v.window.document.mozFullScreenElement||v.window.document.webkitFullscreenElement||v.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Js.prototype._onClickFullscreen=function(){this._isFullscreen()?v.window.document.exitFullscreen?v.window.document.exitFullscreen():v.window.document.mozCancelFullScreen?v.window.document.mozCancelFullScreen():v.window.document.msExitFullscreen?v.window.document.msExitFullscreen():v.window.document.webkitCancelFullScreen&&v.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var jg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},em=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Rf=function(d){function p(h){d.call(this),this.options=v.extend(Object.create(jg),h),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&He.remove(this._content),this._container&&(He.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(h){return this.setDOMContent(v.window.document.createTextNode(h))},p.prototype.setHTML=function(h){var g,w=v.window.document.createDocumentFragment(),D=v.window.document.createElement("body");for(D.innerHTML=h;g=D.firstChild;)w.appendChild(g);return this.setDOMContent(w)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},p.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=He.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},p.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},p.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},p.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=He.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(h){this._update(h.point)},p.prototype._onMouseMove=function(h){this._update(h.point)},p.prototype._onDrag=function(h){this._update(h.point)},p.prototype._update=function(h){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=He.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=He.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Z){return g._container.classList.add(Z)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ps(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var w=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),D=this.options.anchor,T=function Z($){if($){if("number"==typeof $){var se=Math.round(Math.sqrt(.5*Math.pow($,2)));return{center:new v.Point(0,0),top:new v.Point(0,$),"top-left":new v.Point(se,se),"top-right":new v.Point(-se,se),bottom:new v.Point(0,-$),"bottom-left":new v.Point(se,-se),"bottom-right":new v.Point(-se,-se),left:new v.Point($,0),right:new v.Point(-$,0)}}if($ instanceof v.Point||Array.isArray($)){var re=v.Point.convert($);return{center:re,top:re,"top-left":re,"top-right":re,bottom:re,"bottom-left":re,"bottom-right":re,left:re,right:re}}return{center:v.Point.convert($.center||[0,0]),top:v.Point.convert($.top||[0,0]),"top-left":v.Point.convert($["top-left"]||[0,0]),"top-right":v.Point.convert($["top-right"]||[0,0]),bottom:v.Point.convert($.bottom||[0,0]),"bottom-left":v.Point.convert($["bottom-left"]||[0,0]),"bottom-right":v.Point.convert($["bottom-right"]||[0,0]),left:v.Point.convert($.left||[0,0]),right:v.Point.convert($.right||[0,0])}}return Z(new v.Point(0,0))}(this.options.offset);if(!D){var I,R=this._container.offsetWidth,F=this._container.offsetHeight;I=w.y+T.bottom.y<F?["top"]:w.y>this._map.transform.height-F?["bottom"]:[],w.x<R/2?I.push("left"):w.x>this._map.transform.width-R/2&&I.push("right"),D=0===I.length?"bottom":I.join("-")}var W=w.add(T[D]).round();He.setTransform(this._container,ms[D]+" translate("+W.x+"px,"+W.y+"px)"),lc(this._container,D,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(em);h&&h.focus()}},p.prototype._onClose=function(){this.remove()},p}(v.Evented),tm={version:v.version,supported:Qo,setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:Cn,NavigationControl:uo,GeolocateControl:Xu,AttributionControl:_i,ScaleControl:Qs,FullscreenControl:Js,Popup:Rf,Marker:Vs,Style:tc,LngLat:v.LngLat,LngLatBounds:v.LngLatBounds,Point:v.Point,MercatorCoordinate:v.MercatorCoordinate,Evented:v.Evented,config:v.config,prewarm:function(){Et().acquire(Te)},clearPrewarmedResources:function(){var d=ht;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Te),ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return v.config.ACCESS_TOKEN},set accessToken(d){v.config.ACCESS_TOKEN=d},get baseApiUrl(){return v.config.API_URL},set baseApiUrl(d){v.config.API_URL=d},get workerCount(){return Ge.workerCount},set workerCount(d){Ge.workerCount=d},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){v.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage:function(d){v.clearTileCache(d)},workerUrl:"",addProtocol:function(d,p){v.config.REGISTERED_PROTOCOLS[d]=p},removeProtocol:function(d){delete v.config.REGISTERED_PROTOCOLS[d]}};return tm}),ro}()}},Jy=>{Jy(Jy.s=4)}]);