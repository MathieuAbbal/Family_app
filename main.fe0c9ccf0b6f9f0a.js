(self.webpackChunkfamilyapp=self.webpackChunkfamilyapp||[]).push([[792],{197(jy){jy.exports=function(){"use strict";var Hh,Dd,Gi;function Td(v,zo){if(Hh)if(Dd){var Ve="var sharedChunk = {}; ("+Hh+")(sharedChunk); ("+Dd+")(sharedChunk);",yt={};Hh(yt),Gi=zo(yt),typeof window<"u"&&(Gi.workerUrl=window.URL.createObjectURL(new Blob([Ve],{type:"text/javascript"})))}else Dd=zo;else Hh=zo}return Td(0,function(v){function zo(s,l){return s(l={exports:{}},l.exports),l.exports}var Ve=yt;function yt(s,l,u,m){this.cx=3*s,this.bx=3*(u-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=m,this.p2x=u,this.p2y=m}yt.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},yt.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},yt.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},yt.prototype.solveCurveX=function(s,l){var u,m,y,b,E;for(void 0===l&&(l=1e-6),y=s,E=0;E<8;E++){if(b=this.sampleCurveX(y)-s,Math.abs(b)<l)return y;var S=this.sampleCurveDerivativeX(y);if(Math.abs(S)<1e-6)break;y-=b/S}if((y=s)<(u=0))return u;if(y>(m=1))return m;for(;u<m;){if(b=this.sampleCurveX(y),Math.abs(b-s)<l)return y;s>b?u=y:m=y,y=.5*(m-u)+u}return y},yt.prototype.solve=function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))};var Vt=Qa;function Qa(s,l){this.x=s,this.y=l}Qa.prototype={clone:function(){return new Qa(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,l){return this.clone()._rotateAround(s,l)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var l=s.x-this.x,u=s.y-this.y;return l*l+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,l){return Math.atan2(this.x*l-this.y*s,this.x*s+this.y*l)},_matMult:function(s){var l=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=l,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var l=Math.cos(s),u=Math.sin(s),m=u*this.x+l*this.y;return this.x=l*this.x-u*this.y,this.y=m,this},_rotateAround:function(s,l){var u=Math.cos(s),m=Math.sin(s),y=l.y+m*(this.x-l.x)+u*(this.y-l.y);return this.x=l.x+u*(this.x-l.x)-m*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qa.convert=function(s){return s instanceof Qa?s:Array.isArray(s)?new Qa(s[0],s[1]):s};var ft=typeof self<"u"?self:{},Pl=Math.pow(2,53)-1;function wo(s,l,u,m){var y=new Ve(s,l,u,m);return function(b){return y.solve(b)}}var Ac=wo(.25,.1,.25,1);function Wi(s,l,u){return Math.min(u,Math.max(l,s))}function wu(s,l,u){var m=u-l,y=((s-l)%m+m)%m+l;return y===l?u:y}function ki(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}var $h=1;function Ja(){return $h++}function Yo(){return function s(l){return l?(l^16*Math.random()>>l/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function xu(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function ga(s,l){s.forEach(function(u){l[u]&&(l[u]=l[u].bind(l))})}function Rc(s,l){return-1!==s.indexOf(l,s.length-l.length)}function Ai(s,l,u){var m={};for(var y in s)m[y]=l.call(u||this,s[y],y,s);return m}function _s(s,l,u){var m={};for(var y in s)l.call(u||this,s[y],y,s)&&(m[y]=s[y]);return m}function Os(s){return Array.isArray(s)?s.map(Os):"object"==typeof s&&s?Ai(s,Os):s}var Ol={};function lr(s){Ol[s]||(typeof console<"u"&&console.warn(s),Ol[s]=!0)}function xo(s,l,u){return(u.y-s.y)*(l.x-s.x)>(l.y-s.y)*(u.x-s.x)}function Sp(s){for(var l=0,u=0,m=s.length,y=m-1,b=void 0,E=void 0;u<m;y=u++)l+=((E=s[y]).x-(b=s[u]).x)*(b.y+E.y);return l}function ys(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Nl(s){var l={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(m,y,b,E){var S=b||E;return l[y]=!S||S.toLowerCase(),""}),l["max-age"]){var u=parseInt(l["max-age"],10);isNaN(u)?delete l["max-age"]:l["max-age"]=u}return l}var Eu=null;function _a(s){if(null==Eu){var l=s.navigator?s.navigator.userAgent:null;Eu=!!s.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Eu}function vs(s){try{var l=ft[s];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}var Zi,ya,Mc,Ll,el=ft.performance&&ft.performance.now?ft.performance.now.bind(ft.performance):Date.now.bind(Date),Ip=ft.requestAnimationFrame||ft.mozRequestAnimationFrame||ft.webkitRequestAnimationFrame||ft.msRequestAnimationFrame,Ri=ft.cancelAnimationFrame||ft.mozCancelAnimationFrame||ft.webkitCancelAnimationFrame||ft.msCancelAnimationFrame,tl={now:el,frame:function(s){var l=Ip(s);return{cancel:function(){return Ri(l)}}},getImageData:function(s,l){void 0===l&&(l=0);var u=ft.document.createElement("canvas"),m=u.getContext("2d");if(!m)throw new Error("failed to create canvas 2d context");return u.width=s.width,u.height=s.height,m.drawImage(s,0,0,s.width,s.height),m.getImageData(-l,-l,s.width+2*l,s.height+2*l)},resolveURL:function(s){return Zi||(Zi=ft.document.createElement("a")),Zi.href=s,Zi.href},hardwareConcurrency:ft.navigator&&ft.navigator.hardwareConcurrency||4,get devicePixelRatio(){return ft.devicePixelRatio},get prefersReducedMotion(){return!!ft.matchMedia&&(null==ya&&(ya=ft.matchMedia("(prefers-reduced-motion: reduce)")),ya.matches)}},Yn={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},va={supported:!1,testSupport:function(s){!nl&&Ll&&(Ns?bn(s):Mc=s)}},nl=!1,Ns=!1;function bn(s){var l=s.createTexture();s.bindTexture(s.TEXTURE_2D,l);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,Ll),s.isContextLost())return;va.supported=!0}catch{}s.deleteTexture(l),nl=!0}ft.document&&((Ll=ft.document.createElement("img")).onload=function(){Mc&&bn(Mc),Mc=null,Ns=!0},Ll.onerror=function(){nl=!0,Mc=null},Ll.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ba="01",Eo=function(s,l){this._transformRequestFn=s,this._customAccessToken=l,this._createSkuToken()};function Ls(s){return 0===s.indexOf("mapbox:")}Eo.prototype._createSkuToken=function(){var s=function(){for(var l="",u=0;u<10;u++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ba,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt},Eo.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Eo.prototype.transformRequest=function(s,l){return this._transformRequestFn&&this._transformRequestFn(s,l)||{url:s}},Eo.prototype.normalizeStyleURL=function(s,l){if(!Ls(s))return s;var u=Xo(s);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},Eo.prototype.normalizeGlyphsURL=function(s,l){if(!Ls(s))return s;var u=Xo(s);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},Eo.prototype.normalizeSourceURL=function(s,l){if(!Ls(s))return s;var u=Xo(s);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||l)},Eo.prototype.normalizeSpriteURL=function(s,l,u,m){var y=Xo(s);return Ls(s)?(y.path="/styles/v1"+y.path+"/sprite"+l+u,this._makeAPIURL(y,this._customAccessToken||m)):(y.path+=""+l+u,rl(y))},Eo.prototype.normalizeTileURL=function(s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Ls(s))return s;var u=Xo(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(tl.devicePixelRatio>=2||512===l?"@2x":"")+(va.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var m=this._customAccessToken||function(y){for(var b=0,E=y;b<E.length;b+=1){var S=E[b].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(u.params)||Yn.ACCESS_TOKEN;return Yn.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,m)},Eo.prototype.canonicalizeTileURL=function(s,l){var u=Xo(s);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return s;var m="mapbox://tiles/";m+=u.path.replace("/v4/","");var y=u.params;return l&&(y=y.filter(function(b){return!b.match(/^access_token=/)})),y.length&&(m+="?"+y.join("&")),m},Eo.prototype.canonicalizeTileset=function(s,l){for(var u=!!l&&Ls(l),m=[],y=0,b=s.tiles||[];y<b.length;y+=1){var E=b[y];Ks(E)?m.push(this.canonicalizeTileURL(E,u)):m.push(E)}return m},Eo.prototype._makeAPIURL=function(s,l){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",m=Xo(Yn.API_URL);if(s.protocol=m.protocol,s.authority=m.authority,"http"===s.protocol){var y=s.params.indexOf("secure");y>=0&&s.params.splice(y,1)}if("/"!==m.path&&(s.path=""+m.path+s.path),!Yn.REQUIRE_ACCESS_TOKEN)return rl(s);if(!(l=l||Yn.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===l[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return s.params=s.params.filter(function(b){return-1===b.indexOf("access_token")}),s.params.push("access_token="+l),rl(s)},Eo.prototype.setTransformRequest=function(s){this._transformRequestFn=s};var kp=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ks(s){return kp.test(s)}var cr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xo(s){var l=s.match(cr);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function rl(s){var l=s.params.length?"?"+s.params.join("&"):"";return s.protocol+"://"+s.authority+s.path+l}function il(s){if(!s)return null;var l=s.split(".");if(!l||3!==l.length)return null;try{return JSON.parse(decodeURIComponent(ft.atob(l[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Hn=function(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Hn.prototype.getStorageKey=function(s){var l,u=il(Yn.ACCESS_TOKEN);return l=u&&u.u?ft.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(m,y){return String.fromCharCode(+("0x"+y))})):Yn.ACCESS_TOKEN||"",s?"mapbox.eventData."+s+":"+l:"mapbox.eventData:"+l},Hn.prototype.fetchEventData=function(){var s=vs("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{var m=ft.localStorage.getItem(l);m&&(this.eventData=JSON.parse(m));var y=ft.localStorage.getItem(u);y&&(this.anonId=y)}catch{lr("Unable to read from LocalStorage")}},Hn.prototype.saveEventData=function(){var s=vs("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{ft.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&ft.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{lr("Unable to write to LocalStorage")}},Hn.prototype.processRequests=function(s){},Hn.prototype.postEvent=function(s,l,u,m){var y=this;if(Yn.EVENTS_URL){var b=Xo(Yn.EVENTS_URL);b.params.push("access_token="+(m||Yn.ACCESS_TOKEN||""));var E={event:this.type,created:new Date(s).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:ba,userId:this.anonId},S=l?ki(E,l):E,k={url:rl(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=F(k,function(R){y.pendingRequest=null,u(R),y.saveEventData(),y.processRequests(m)})}},Hn.prototype.queueRequest=function(s,l){this.queue.push(s),this.processRequests(l)};var bs,Fl,Fs=function(s){function l(){s.call(this,"map.load"),this.success={},this.skuToken=""}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postMapLoadEvent=function(u,m,y,b){this.skuToken=y,(Yn.EVENTS_URL&&b||Yn.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(E){return Ls(E)||Ks(E)}))&&this.queueRequest({id:m,timestamp:Date.now()},b)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){var y=this.queue.shift(),b=y.id,E=y.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),xu(this.anonId)||(this.anonId=Yo()),this.postEvent(E,{skuToken:this.skuToken},function(S){S||b&&(m.success[b]=!0)},u))}},l}(Hn),wa=new(function(s){function l(u){s.call(this,"appUserTurnstile"),this._customAccessToken=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postTurnstileEvent=function(u,m){Yn.EVENTS_URL&&Yn.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return Ls(y)||Ks(y)})&&this.queueRequest(Date.now(),m)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=il(Yn.ACCESS_TOKEN),b=y?y.u:Yn.ACCESS_TOKEN,E=b!==this.eventData.tokenU;xu(this.anonId)||(this.anonId=Yo(),E=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var k=new Date(this.eventData.lastSuccess),R=new Date(S),P=(S-this.eventData.lastSuccess)/864e5;E=E||P>=1||P<-1||k.getDate()!==R.getDate()}else E=!0;if(!E)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(N){N||(m.eventData.lastSuccess=S,m.eventData.tokenU=b)},u)}},l}(Hn)),Pc=wa.postTurnstileEvent.bind(wa),Cu=new Fs,xa=Cu.postMapLoadEvent.bind(Cu),Du=500,qh=50;function Tu(){ft.caches&&!bs&&(bs=ft.caches.open("mapbox-tiles"))}function Oc(s){var l=s.indexOf("?");return l<0?s:s.slice(0,l)}var ws,Bl=1/0;function Sd(){return null==ws&&(ws=ft.OffscreenCanvas&&new ft.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof ft.createImageBitmap),ws}var Su={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Su);var Id=function(s){function l(u,m,y){401===m&&Ks(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),s.call(this,u),this.status=m,this.url=y,this.name=this.constructor.name,this.message=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},l}(Error),ol=ys()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===ft.location.protocol?ft.parent:ft).location.href};function Vl(s,l){var u,m=new ft.AbortController,y=new ft.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:ol(),signal:m.signal}),b=!1,E=!1,S=(u=y.url).indexOf("sku=")>0&&Ks(u);"json"===s.type&&y.headers.set("Accept","application/json");var k=function(P,N,V){if(!E){if(P&&"SecurityError"!==P.message&&lr(P),N&&V)return R(N);var H=Date.now();ft.fetch(y).then(function(X){if(X.ok){var Y=S?X.clone():null;return R(X,Y,H)}return l(new Id(X.statusText,X.status,s.url))}).catch(function(X){20!==X.code&&l(new Error(X.message))})}},R=function(P,N,V){("arrayBuffer"===s.type?P.arrayBuffer():"json"===s.type?P.json():P.text()).then(function(H){E||(N&&V&&function(X,Y,ce){if(Tu(),bs){var le={status:Y.status,statusText:Y.statusText,headers:new ft.Headers};Y.headers.forEach(function(fe,Te){return le.headers.set(Te,fe)});var pe=Nl(Y.headers.get("Cache-Control")||"");pe["no-store"]||(pe["max-age"]&&le.headers.set("Expires",new Date(ce+1e3*pe["max-age"]).toUTCString()),new Date(le.headers.get("Expires")).getTime()-ce<42e4||function(fe,Te){if(void 0===Fl)try{new Response(new ReadableStream),Fl=!0}catch{Fl=!1}Fl?Te(fe.body):fe.blob().then(Te)}(Y,function(fe){var Te=new ft.Response(fe,le);Tu(),bs&&bs.then(function(Se){return Se.put(Oc(X.url),Te)}).catch(function(Se){return lr(Se.message)})}))}}(y,N,V),b=!0,l(null,H,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(function(H){E||l(new Error(H.message))})};return S?function(P,N){if(Tu(),!bs)return N(null);var V=Oc(P.url);bs.then(function(H){H.match(V).then(function(X){var Y=function(ce){if(!ce)return!1;var le=new Date(ce.headers.get("Expires")||0),pe=Nl(ce.headers.get("Cache-Control")||"");return le>Date.now()&&!pe["no-cache"]}(X);H.delete(V),Y&&H.put(V,X.clone()),N(null,X,Y)}).catch(N)}).catch(N)}(y,k):k(null,null),{cancel:function(){E=!0,b||m.abort()}}}var Ea,Nc,zl=function(s,l){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(ys()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l);if(!ys()){var u=s.url.substring(0,s.url.indexOf("://"));return(Yn.REGISTERED_PROTOCOLS[u]||Vl)(s,l)}}if(!(/^file:/.test(m=s.url)||/^file:/.test(ol())&&!/^\w+:/.test(m))){if(ft.fetch&&ft.Request&&ft.AbortController&&ft.Request.prototype.hasOwnProperty("signal"))return Vl(s,l);if(ys()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l,void 0,!0)}var m;return function(y,b){var E=new ft.XMLHttpRequest;for(var S in E.open(y.method||"GET",y.url,!0),"arrayBuffer"===y.type&&(E.responseType="arraybuffer"),y.headers)E.setRequestHeader(S,y.headers[S]);return"json"===y.type&&(E.responseType="text",E.setRequestHeader("Accept","application/json")),E.withCredentials="include"===y.credentials,E.onerror=function(){b(new Error(E.statusText))},E.onload=function(){if((E.status>=200&&E.status<300||0===E.status)&&null!==E.response){var k=E.response;if("json"===y.type)try{k=JSON.parse(E.response)}catch(R){return b(R)}b(null,k,E.getResponseHeader("Cache-Control"),E.getResponseHeader("Expires"))}else b(new Id(E.statusText,E.status,y.url))},E.send(y.body),{cancel:function(){return E.abort()}}}(s,l)},Xn=function(s,l){return zl(ki(s,{type:"arrayBuffer"}),l)},F=function(s,l){return zl(ki(s,{method:"POST"}),l)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ea=[],Nc=0;var U=function(s,l){if(va.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Nc>=Yn.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:s,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ea.push(u),u}Nc++;var m=!1,y=function(){if(!m)for(m=!0,Nc--;Ea.length&&Nc<Yn.MAX_PARALLEL_IMAGE_REQUESTS;){var E=Ea.shift();E.cancelled||(E.cancel=U(E.requestParameters,E.callback).cancel)}},b=Xn(s,function(E,S,k,R){var N,V;y(),E?l(E):S&&(Sd()?(N=l,V=new ft.Blob([new Uint8Array(S)],{type:"image/png"}),ft.createImageBitmap(V).then(function(H){N(null,H)}).catch(function(H){N(new Error("Could not load image because of "+H.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(P,N,V,H){var X=new ft.Image,Y=ft.URL;X.onload=function(){N(null,X),Y.revokeObjectURL(X.src),X.onload=null,ft.requestAnimationFrame(function(){X.src=z})},X.onerror=function(){return N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var ce=new ft.Blob([new Uint8Array(P)],{type:"image/png"});X.cacheControl=V,X.expires=H,X.src=P.byteLength?Y.createObjectURL(ce):z}(S,l,k,R))});return{cancel:function(){b.cancel(),y()}}};function G(s,l,u){u[s]&&-1!==u[s].indexOf(l)||(u[s]=u[s]||[],u[s].push(l))}function te(s,l,u){if(u&&u[s]){var m=u[s].indexOf(l);-1!==m&&u[s].splice(m,1)}}var ue=function(s,l){void 0===l&&(l={}),ki(this,l),this.type=s},he=function(s){function l(u,m){void 0===m&&(m={}),s.call(this,"error",ki({error:u},m))}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(ue),K=function(){};K.prototype.on=function(s,l){return this._listeners=this._listeners||{},G(s,l,this._listeners),this},K.prototype.off=function(s,l){return te(s,l,this._listeners),te(s,l,this._oneTimeListeners),this},K.prototype.once=function(s,l){return this._oneTimeListeners=this._oneTimeListeners||{},G(s,l,this._oneTimeListeners),this},K.prototype.fire=function(s,l){"string"==typeof s&&(s=new ue(s,l||{}));var u=s.type;if(this.listens(u)){s.target=this;for(var m=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];m<y.length;m+=1)y[m].call(this,s);for(var b=0,E=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];b<E.length;b+=1){var S=E[b];te(u,S,this._oneTimeListeners),S.call(this,s)}var k=this._eventedParent;k&&(ki(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),k.fire(s))}else s instanceof he&&console.error(s.error);return this},K.prototype.listens=function(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)},K.prototype.setEventedParent=function(s,l){return this._eventedParent=s,this._eventedParentData=l,this};var W={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},re=function(s,l,u,m){this.message=(s?s+": ":"")+u,m&&(this.identifier=m),null!=l&&l.__line__&&(this.line=l.__line__)};function ze(s){var l=s.value;return l?[new re(s.key,l,"constants have been deprecated as of v8")]:[]}function Ke(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}function Ce(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function je(s){if(Array.isArray(s))return s.map(je);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){var l={};for(var u in s)l[u]=je(s[u]);return l}return Ce(s)}var ot=function(s){function l(u,m){s.call(this,m),this.message=m,this.key=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Error),at=function(s,l){void 0===l&&(l=[]),this.parent=s,this.bindings={};for(var u=0,m=l;u<m.length;u+=1){var y=m[u];this.bindings[y[0]]=y[1]}};at.prototype.concat=function(s){return new at(this,s)},at.prototype.get=function(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(s+" not found in scope.")},at.prototype.has=function(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)};var mt={kind:"null"},Pe={kind:"number"},Je={kind:"string"},Be={kind:"boolean"},Gt={kind:"color"},Wt={kind:"object"},se={kind:"value"},or={kind:"collator"},Nt={kind:"formatted"},Jt={kind:"resolvedImage"};function br(s,l){return{kind:"array",itemType:s,N:l}}function An(s){if("array"===s.kind){var l=An(s.itemType);return"number"==typeof s.N?"array<"+l+", "+s.N+">":"value"===s.itemType.kind?"array":"array<"+l+">"}return s.kind}var ut=[mt,Pe,Je,Be,Gt,Nt,Wt,br(se),Jt];function Rr(s,l){if("error"===l.kind)return null;if("array"===s.kind){if("array"===l.kind&&(0===l.N&&"value"===l.itemType.kind||!Rr(s.itemType,l.itemType))&&("number"!=typeof s.N||s.N===l.N))return null}else{if(s.kind===l.kind)return null;if("value"===s.kind)for(var u=0,m=ut;u<m.length;u+=1)if(!Rr(m[u],l))return null}return"Expected "+An(s)+" but found "+An(l)+" instead."}function gn(s,l){return l.some(function(u){return u.kind===s.kind})}function an(s,l){return l.some(function(u){return"null"===u?null===s:"array"===u?Array.isArray(s):"object"===u?s&&!Array.isArray(s)&&"object"==typeof s:u===typeof s})}var kd=zo(function(s,l){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function m(S){return(S=Math.round(S))<0?0:S>255?255:S}function y(S){return m("%"===S[S.length-1]?parseFloat(S)/100*255:parseInt(S))}function b(S){return(k="%"===S[S.length-1]?parseFloat(S)/100:parseFloat(S))<0?0:k>1?1:k;var k}function E(S,k,R){return R<0?R+=1:R>1&&(R-=1),6*R<1?S+(k-S)*R*6:2*R<1?k:3*R<2?S+(k-S)*(2/3-R)*6:S}try{l.parseCSSColor=function(S){var k,R=S.replace(/ /g,"").toLowerCase();if(R in u)return u[R].slice();if("#"===R[0])return 4===R.length?(k=parseInt(R.substr(1),16))>=0&&k<=4095?[(3840&k)>>4|(3840&k)>>8,240&k|(240&k)>>4,15&k|(15&k)<<4,1]:null:7===R.length&&(k=parseInt(R.substr(1),16))>=0&&k<=16777215?[(16711680&k)>>16,(65280&k)>>8,255&k,1]:null;var P=R.indexOf("("),N=R.indexOf(")");if(-1!==P&&N+1===R.length){var V=R.substr(0,P),H=R.substr(P+1,N-(P+1)).split(","),X=1;switch(V){case"rgba":if(4!==H.length)return null;X=b(H.pop());case"rgb":return 3!==H.length?null:[y(H[0]),y(H[1]),y(H[2]),X];case"hsla":if(4!==H.length)return null;X=b(H.pop());case"hsl":if(3!==H.length)return null;var Y=(parseFloat(H[0])%360+360)%360/360,ce=b(H[1]),le=b(H[2]),pe=le<=.5?le*(ce+1):le+ce-le*ce,fe=2*le-pe;return[m(255*E(fe,pe,Y+1/3)),m(255*E(fe,pe,Y)),m(255*E(fe,pe,Y-1/3)),X];default:return null}}return null}}catch{}}).parseCSSColor,mn=function(s,l,u,m){void 0===m&&(m=1),this.r=s,this.g=l,this.b=u,this.a=m};mn.parse=function(s){if(s){if(s instanceof mn)return s;if("string"==typeof s){var l=kd(s);if(l)return new mn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3])}}},mn.prototype.toString=function(){var s=this.toArray(),l=s[1],u=s[2],m=s[3];return"rgba("+Math.round(s[0])+","+Math.round(l)+","+Math.round(u)+","+m+")"},mn.prototype.toArray=function(){var s=this.a;return 0===s?[0,0,0,0]:[255*this.r/s,255*this.g/s,255*this.b/s,s]},mn.black=new mn(0,0,0,1),mn.white=new mn(1,1,1,1),mn.transparent=new mn(0,0,0,0),mn.red=new mn(1,0,0,1);var $n=function(s,l,u){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};$n.prototype.compare=function(s,l){return this.collator.compare(s,l)},$n.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var cn=function(s,l,u,m,y){this.text=s,this.image=l,this.scale=u,this.fontStack=m,this.textColor=y},Qr=function(s){this.sections=s};Qr.fromString=function(s){return new Qr([new cn(s,null,null,null,null)])},Qr.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(s){return 0!==s.text.length||s.image&&0!==s.image.name.length})},Qr.factory=function(s){return s instanceof Qr?s:Qr.fromString(s)},Qr.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(s){return s.text}).join("")},Qr.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];if(m.image)s.push(["image",m.image.name]);else{s.push(m.text);var y={};m.fontStack&&(y["text-font"]=["literal",m.fontStack.split(",")]),m.scale&&(y["font-scale"]=m.scale),m.textColor&&(y["text-color"]=["rgba"].concat(m.textColor.toArray())),s.push(y)}}return s};var wr=function(s){this.name=s.name,this.available=s.available};function Cg(s,l,u,m){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof l&&l>=0&&l<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===m||"number"==typeof m&&m>=0&&m<=1?null:"Invalid rgba value ["+[s,l,u,m].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof m?[s,l,u,m]:[s,l,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Lc(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof mn||s instanceof $n||s instanceof Qr||s instanceof wr)return!0;if(Array.isArray(s)){for(var l=0,u=s;l<u.length;l+=1)if(!Lc(u[l]))return!1;return!0}if("object"==typeof s){for(var m in s)if(!Lc(s[m]))return!1;return!0}return!1}function Mi(s){if(null===s)return mt;if("string"==typeof s)return Je;if("boolean"==typeof s)return Be;if("number"==typeof s)return Pe;if(s instanceof mn)return Gt;if(s instanceof $n)return or;if(s instanceof Qr)return Nt;if(s instanceof wr)return Jt;if(Array.isArray(s)){for(var l,u=s.length,m=0,y=s;m<y.length;m+=1){var b=Mi(y[m]);if(l){if(l===b)continue;l=se;break}l=b}return br(l||se,u)}return Wt}function Co(s){var l=typeof s;return null===s?"":"string"===l||"number"===l||"boolean"===l?String(s):s instanceof mn||s instanceof Qr||s instanceof wr?s.toString():JSON.stringify(s)}wr.prototype.toString=function(){return this.name},wr.fromString=function(s){return s?new wr({name:s,available:!1}):null},wr.prototype.serialize=function(){return["image",this.name]};var Ys=function(s,l){this.type=s,this.value=l};Ys.parse=function(s,l){if(2!==s.length)return l.error("'literal' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(!Lc(s[1]))return l.error("invalid value");var u=s[1],m=Mi(u),y=l.expectedType;return"array"!==m.kind||0!==m.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(m=y),new Ys(m,u)},Ys.prototype.evaluate=function(){return this.value},Ys.prototype.eachChild=function(){},Ys.prototype.outputDefined=function(){return!0},Ys.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof mn?["rgba"].concat(this.value.toArray()):this.value instanceof Qr?this.value.serialize():this.value};var Dr=function(s){this.name="ExpressionEvaluationError",this.message=s};Dr.prototype.toJSON=function(){return this.message};var Qo={string:Je,number:Pe,boolean:Be,object:Wt},io=function(s,l){this.type=s,this.args=l};io.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u,m=1,y=s[0];if("array"===y){var b,E;if(s.length>2){var S=s[1];if("string"!=typeof S||!(S in Qo)||"object"===S)return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=Qo[S],m++}else b=se;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=s[2],m++}u=br(b,E)}else u=Qo[y];for(var k=[];m<s.length;m++){var R=l.parse(s[m],m,se);if(!R)return null;k.push(R)}return new io(u,k)},io.prototype.evaluate=function(s){for(var l=0;l<this.args.length;l++){var u=this.args[l].evaluate(s);if(!Rr(this.type,Mi(u)))return u;if(l===this.args.length-1)throw new Dr("Expected value to be of type "+An(this.type)+", but found "+An(Mi(u))+" instead.")}return null},io.prototype.eachChild=function(s){this.args.forEach(s)},io.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},io.prototype.serialize=function(){var s=this.type,l=[s.kind];if("array"===s.kind){var u=s.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){l.push(u.kind);var m=s.N;("number"==typeof m||this.args.length>1)&&l.push(m)}}return l.concat(this.args.map(function(y){return y.serialize()}))};var Jo=function(s){this.type=Nt,this.sections=s};Jo.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[1];if(!Array.isArray(u)&&"object"==typeof u)return l.error("First argument must be an image or text section.");for(var m=[],y=!1,b=1;b<=s.length-1;++b){var E=s[b];if(y&&"object"==typeof E&&!Array.isArray(E)){y=!1;var S=null;if(E["font-scale"]&&!(S=l.parse(E["font-scale"],1,Pe)))return null;var k=null;if(E["text-font"]&&!(k=l.parse(E["text-font"],1,br(Je))))return null;var R=null;if(E["text-color"]&&!(R=l.parse(E["text-color"],1,Gt)))return null;var P=m[m.length-1];P.scale=S,P.font=k,P.textColor=R}else{var N=l.parse(s[b],1,se);if(!N)return null;var V=N.type.kind;if("string"!==V&&"value"!==V&&"null"!==V&&"resolvedImage"!==V)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:N,scale:null,font:null,textColor:null})}}return new Jo(m)},Jo.prototype.evaluate=function(s){return new Qr(this.sections.map(function(l){var u=l.content.evaluate(s);return Mi(u)===Jt?new cn("",u,null,null,null):new cn(Co(u),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))},Jo.prototype.eachChild=function(s){for(var l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s(m.content),m.scale&&s(m.scale),m.font&&s(m.font),m.textColor&&s(m.textColor)}},Jo.prototype.outputDefined=function(){return!1},Jo.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s.push(m.content.serialize());var y={};m.scale&&(y["font-scale"]=m.scale.serialize()),m.font&&(y["text-font"]=m.font.serialize()),m.textColor&&(y["text-color"]=m.textColor.serialize()),s.push(y)}return s};var Ul=function(s){this.type=Jt,this.input=s};Ul.parse=function(s,l){if(2!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,Je);return u?new Ul(u):l.error("No image name provided.")},Ul.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=wr.fromString(l);return u&&s.availableImages&&(u.available=s.availableImages.indexOf(l)>-1),u},Ul.prototype.eachChild=function(s){s(this.input)},Ul.prototype.outputDefined=function(){return!1},Ul.prototype.serialize=function(){return["image",this.input.serialize()]};var Hy={"to-boolean":Be,"to-color":Gt,"to-number":Pe,"to-string":Je},Xs=function(s,l){this.type=s,this.args=l};Xs.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[0];if(("to-boolean"===u||"to-string"===u)&&2!==s.length)return l.error("Expected one argument.");for(var m=Hy[u],y=[],b=1;b<s.length;b++){var E=l.parse(s[b],b,se);if(!E)return null;y.push(E)}return new Xs(m,y)},Xs.prototype.evaluate=function(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){for(var l,u,m=0,y=this.args;m<y.length;m+=1){if(u=null,(l=y[m].evaluate(s))instanceof mn)return l;if("string"==typeof l){var b=s.parseColor(l);if(b)return b}else if(Array.isArray(l)&&!(u=l.length<3||l.length>4?"Invalid rbga value "+JSON.stringify(l)+": expected an array containing either three or four numeric values.":Cg(l[0],l[1],l[2],l[3])))return new mn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Dr(u||"Could not parse color from value '"+("string"==typeof l?l:String(JSON.stringify(l)))+"'")}if("number"===this.type.kind){for(var E=null,S=0,k=this.args;S<k.length;S+=1){if(null===(E=k[S].evaluate(s)))return 0;var R=Number(E);if(!isNaN(R))return R}throw new Dr("Could not convert "+JSON.stringify(E)+" to number.")}return"formatted"===this.type.kind?Qr.fromString(Co(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?wr.fromString(Co(this.args[0].evaluate(s))):Co(this.args[0].evaluate(s))},Xs.prototype.eachChild=function(s){this.args.forEach(s)},Xs.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},Xs.prototype.serialize=function(){if("formatted"===this.type.kind)return new Jo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ul(this.args[0]).serialize();var s=["to-"+this.type.kind];return this.eachChild(function(l){s.push(l.serialize())}),s};var oo=["Unknown","Point","LineString","Polygon"],Dt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Dt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Dt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?oo[this.feature.type]:this.feature.type:null},Dt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Dt.prototype.canonicalID=function(){return this.canonical},Dt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Dt.prototype.parseColor=function(s){var l=this._parseColorCache[s];return l||(l=this._parseColorCache[s]=mn.parse(s)),l};var Ki=function(s,l,u,m){this.name=s,this.type=l,this._evaluate=u,this.args=m};Ki.prototype.evaluate=function(s){return this._evaluate(s,this.args)},Ki.prototype.eachChild=function(s){this.args.forEach(s)},Ki.prototype.outputDefined=function(){return!1},Ki.prototype.serialize=function(){return[this.name].concat(this.args.map(function(s){return s.serialize()}))},Ki.parse=function(s,l){var u,m=s[0],y=Ki.definitions[m];if(!y)return l.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,S=E.filter(function(wt){var tt=wt[0];return!Array.isArray(tt)||tt.length===s.length-1}),k=null,R=0,P=S;R<P.length;R+=1){var N=P[R],V=N[0],H=N[1];k=new Es(l.registry,l.path,null,l.scope);for(var X=[],Y=!1,ce=1;ce<s.length;ce++){var le=s[ce],pe=Array.isArray(V)?V[ce-1]:V.type,fe=k.parse(le,1+X.length,pe);if(!fe){Y=!0;break}X.push(fe)}if(!Y)if(Array.isArray(V)&&V.length!==X.length)k.error("Expected "+V.length+" arguments, but found "+X.length+" instead.");else{for(var Te=0;Te<X.length;Te++){var Se=Array.isArray(V)?V[Te]:V.type,Oe=X[Te];k.concat(Te+1).checkSubtype(Se,Oe.type)}if(0===k.errors.length)return new Ki(m,b,H,X)}}if(1===S.length)(u=l.errors).push.apply(u,k.errors);else{for(var Ge=(S.length?S:E).map(function(wt){var tt;return tt=wt[0],Array.isArray(tt)?"("+tt.map(An).join(", ")+")":"("+An(tt.type)+"...)"}).join(" | "),Qe=[],pt=1;pt<s.length;pt++){var et=l.parse(s[pt],1+Qe.length);if(!et)return null;Qe.push(An(et.type))}l.error("Expected arguments of type "+Ge+", but found ("+Qe.join(", ")+") instead.")}return null},Ki.register=function(s,l){for(var u in Ki.definitions=l,l)s[u]=Ki};var yi=function(s,l,u){this.type=or,this.locale=u,this.caseSensitive=s,this.diacriticSensitive=l};function Iu(s,l){s[0]=Math.min(s[0],l[0]),s[1]=Math.min(s[1],l[1]),s[2]=Math.max(s[2],l[0]),s[3]=Math.max(s[3],l[1])}function Ap(s,l){return!(s[0]<=l[0]||s[2]>=l[2]||s[1]<=l[1]||s[3]>=l[3])}function _0(s,l){var u=(180+s[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(u*y*8192),Math.round(m*y*8192)]}function Ue(s,l,u){return l[1]>s[1]!=u[1]>s[1]&&s[0]<(u[0]-l[0])*(s[1]-l[1])/(u[1]-l[1])+l[0]}function Lr(s,l){for(var u,m,y,b,E,S,k,R=!1,P=0,N=l.length;P<N;P++)for(var V=l[P],H=0,X=V.length;H<X-1;H++){if((b=(u=s)[0]-(m=V[H])[0])*(k=u[1]-(y=V[H+1])[1])-(S=u[0]-y[0])*(E=u[1]-m[1])==0&&b*S<=0&&E*k<=0)return!1;Ue(s,V[H],V[H+1])&&(R=!R)}return R}function Gh(s,l){for(var u=0;u<l.length;u++)if(Lr(s,l[u]))return!0;return!1}function Dg(s,l,u,m){var y=m[0]-u[0],b=m[1]-u[1],E=(s[0]-u[0])*b-y*(s[1]-u[1]),S=(l[0]-u[0])*b-y*(l[1]-u[1]);return E>0&&S<0||E<0&&S>0}function $y(s,l,u){for(var m=0,y=u;m<y.length;m+=1)for(var b=y[m],E=0;E<b.length-1;++E)if((N=[(P=b[E+1])[0]-(R=b[E])[0],P[1]-R[1]])[0]*(V=[(k=l)[0]-(S=s)[0],k[1]-S[1]])[1]-N[1]*V[0]!=0&&Dg(S,k,R,P)&&Dg(R,P,S,k))return!0;var S,k,R,P,N,V;return!1}function Rp(s,l){for(var u=0;u<s.length;++u)if(!Lr(s[u],l))return!1;for(var m=0;m<s.length-1;++m)if($y(s[m],s[m+1],l))return!1;return!0}function Fc(s,l){for(var u=0;u<l.length;u++)if(Rp(s,l[u]))return!0;return!1}function Bc(s,l,u){for(var m=[],y=0;y<s.length;y++){for(var b=[],E=0;E<s[y].length;E++){var S=_0(s[y][E],u);Iu(l,S),b.push(S)}m.push(b)}return m}function Vc(s,l,u){for(var m=[],y=0;y<s.length;y++){var b=Bc(s[y],l,u);m.push(b)}return m}function Le(s,l,u,m){if(s[0]<u[0]||s[0]>u[2]){var y=.5*m,b=s[0]-u[0]>y?-m:u[0]-s[0]>y?m:0;0===b&&(b=s[0]-u[2]>y?-m:u[2]-s[0]>y?m:0),s[0]+=b}Iu(l,s)}function ku(s,l,u,m){for(var y=8192*Math.pow(2,m.z),b=[8192*m.x,8192*m.y],E=[],S=0,k=s;S<k.length;S+=1)for(var R=0,P=k[S];R<P.length;R+=1){var N=P[R],V=[N.x+b[0],N.y+b[1]];Le(V,l,u,y),E.push(V)}return E}function jl(s,l,u,m){for(var y,b=8192*Math.pow(2,m.z),E=[8192*m.x,8192*m.y],S=[],k=0,R=s;k<R.length;k+=1){for(var P=[],N=0,V=R[k];N<V.length;N+=1){var H=V[N],X=[H.x+E[0],H.y+E[1]];Iu(l,X),P.push(X)}S.push(P)}if(l[2]-l[0]<=b/2){(y=l)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var Y=0,ce=S;Y<ce.length;Y+=1)for(var le=0,pe=ce[Y];le<pe.length;le+=1)Le(pe[le],l,u,b)}return S}yi.parse=function(s,l){if(2!==s.length)return l.error("Expected one argument.");var u=s[1];if("object"!=typeof u||Array.isArray(u))return l.error("Collator options argument must be an object.");var m=l.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Be);if(!m)return null;var y=l.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Be);if(!y)return null;var b=null;return u.locale&&!(b=l.parse(u.locale,1,Je))?null:new yi(m,y,b)},yi.prototype.evaluate=function(s){return new $n(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)},yi.prototype.eachChild=function(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)},yi.prototype.outputDefined=function(){return!1},yi.prototype.serialize=function(){var s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]};var Yi=function(s,l){this.type=Be,this.geojson=s,this.geometries=l};function xs(s){if(s instanceof Ki&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof Yi)return!1;var l=!0;return s.eachChild(function(u){l&&!xs(u)&&(l=!1)}),l}function Hl(s){if(s instanceof Ki&&"feature-state"===s.name)return!1;var l=!0;return s.eachChild(function(u){l&&!Hl(u)&&(l=!1)}),l}function Wh(s,l){if(s instanceof Ki&&l.indexOf(s.name)>=0)return!1;var u=!0;return s.eachChild(function(m){u&&!Wh(m,l)&&(u=!1)}),u}Yi.parse=function(s,l){if(2!==s.length)return l.error("'within' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(Lc(s[1])){var u=s[1];if("FeatureCollection"===u.type)for(var m=0;m<u.features.length;++m){var y=u.features[m].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new Yi(u,u.features[m].geometry)}else if("Feature"===u.type){var b=u.geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new Yi(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new Yi(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Yi.prototype.evaluate=function(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Bc(u.coordinates,y,b),S=ku(l.geometry(),m,y,b);if(!Ap(m,y))return!1;for(var k=0,R=S;k<R.length;k+=1)if(!Lr(R[k],E))return!1}if("MultiPolygon"===u.type){var P=Vc(u.coordinates,y,b),N=ku(l.geometry(),m,y,b);if(!Ap(m,y))return!1;for(var V=0,H=N;V<H.length;V+=1)if(!Gh(H[V],P))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Bc(u.coordinates,y,b),S=jl(l.geometry(),m,y,b);if(!Ap(m,y))return!1;for(var k=0,R=S;k<R.length;k+=1)if(!Rp(R[k],E))return!1}if("MultiPolygon"===u.type){var P=Vc(u.coordinates,y,b),N=jl(l.geometry(),m,y,b);if(!Ap(m,y))return!1;for(var V=0,H=N;V<H.length;V+=1)if(!Fc(H[V],P))return!1}return!0}(s,this.geometries)}return!1},Yi.prototype.eachChild=function(){},Yi.prototype.outputDefined=function(){return!0},Yi.prototype.serialize=function(){return["within",this.geojson]};var $l=function(s,l){this.type=l.type,this.name=s,this.boundExpression=l};$l.parse=function(s,l){if(2!==s.length||"string"!=typeof s[1])return l.error("'var' expression requires exactly one string literal argument.");var u=s[1];return l.scope.has(u)?new $l(u,l.scope.get(u)):l.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},$l.prototype.evaluate=function(s){return this.boundExpression.evaluate(s)},$l.prototype.eachChild=function(){},$l.prototype.outputDefined=function(){return!1},$l.prototype.serialize=function(){return["var",this.name]};var Es=function(s,l,u,m,y){void 0===l&&(l=[]),void 0===m&&(m=new at),void 0===y&&(y=[]),this.registry=s,this.path=l,this.key=l.map(function(b){return"["+b+"]"}).join(""),this.scope=m,this.errors=y,this.expectedType=u};function ql(s,l){for(var u,m=s.length-1,y=0,b=m,E=0;y<=b;)if((u=s[E=Math.floor((y+b)/2)])<=l){if(E===m||l<s[E+1])return E;y=E+1}else{if(!(u>l))throw new Dr("Input is not a number.");b=E-1}return 0}Es.prototype.parse=function(s,l,u,m,y){return void 0===y&&(y={}),l?this.concat(l,u,m)._parse(s,y):this._parse(s,y)},Es.prototype._parse=function(s,l){function u(R,P,N){return"assert"===N?new io(P,[R]):"coerce"===N?new Xs(P,[R]):R}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var m=s[0];if("string"!=typeof m)return this.error("Expression name must be a string, but found "+typeof m+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[m];if(y){var b=y.parse(s,this);if(!b)return null;if(this.expectedType){var E=this.expectedType,S=b.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==S.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==S.kind&&"string"!==S.kind){if(this.checkSubtype(E,S))return null}else b=u(b,E,l.typeAnnotation||"coerce");else b=u(b,E,l.typeAnnotation||"assert")}if(!(b instanceof Ys)&&"resolvedImage"!==b.type.kind&&function R(P){if(P instanceof $l)return R(P.boundExpression);if(P instanceof Ki&&"error"===P.name||P instanceof yi||P instanceof Yi)return!1;var N=P instanceof Xs||P instanceof io,V=!0;return P.eachChild(function(H){V=N?V&&R(H):V&&H instanceof Ys}),!!V&&xs(P)&&Wh(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var k=new Dt;try{b=new Ys(b.type,b.evaluate(k))}catch(R){return this.error(R.message),null}}return b}return this.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof s+" instead.")},Es.prototype.concat=function(s,l,u){var m="number"==typeof s?this.path.concat(s):this.path,y=u?this.scope.concat(u):this.scope;return new Es(this.registry,m,l||null,y,this.errors)},Es.prototype.error=function(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];var m=""+this.key+l.map(function(y){return"["+y+"]"}).join("");this.errors.push(new ot(m,s))},Es.prototype.checkSubtype=function(s,l){var u=Rr(s,l);return u&&this.error(u),u};var Ca=function(s,l,u){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(var m=0,y=u;m<y.length;m+=1){var b=y[m],E=b[1];this.labels.push(b[0]),this.outputs.push(E)}};function si(s,l,u){return s*(1-u)+l*u}Ca.parse=function(s,l){if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");var u=l.parse(s[1],1,Pe);if(!u)return null;var m=[],y=null;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);for(var b=1;b<s.length;b+=2){var E=1===b?-1/0:s[b],S=s[b+1],k=b,R=b+1;if("number"!=typeof E)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);var P=l.parse(S,R,y);if(!P)return null;y=y||P.type,m.push([E,P])}return new Ca(y,u,m)},Ca.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;return m>=l[y-1]?u[y-1].evaluate(s):u[ql(l,m)].evaluate(s)},Ca.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},Ca.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},Ca.prototype.serialize=function(){for(var s=["step",this.input.serialize()],l=0;l<this.labels.length;l++)l>0&&s.push(this.labels[l]),s.push(this.outputs[l].serialize());return s};var Mp=Object.freeze({__proto__:null,number:si,color:function(s,l,u){return new mn(si(s.r,l.r,u),si(s.g,l.g,u),si(s.b,l.b,u),si(s.a,l.a,u))},array:function(s,l,u){return s.map(function(m,y){return si(m,l[y],u)})}}),qy=6/29*3*(6/29),Gy=Math.PI/180,y0=180/Math.PI;function Ad(s){return s>.008856451679035631?Math.pow(s,1/3):s/qy+4/29}function Zh(s){return s>6/29?s*s*s:qy*(s-4/29)}function Pp(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Op(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Np(s){var l=Op(s.r),u=Op(s.g),m=Op(s.b),y=Ad((.4124564*l+.3575761*u+.1804375*m)/.95047),b=Ad((.2126729*l+.7151522*u+.072175*m)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-Ad((.0193339*l+.119192*u+.9503041*m)/1.08883)),alpha:s.a}}function Gl(s){var l=(s.l+16)/116,u=isNaN(s.a)?l:l+s.a/500,m=isNaN(s.b)?l:l-s.b/200;return l=1*Zh(l),u=.95047*Zh(u),m=1.08883*Zh(m),new mn(Pp(3.2404542*u-1.5371385*l-.4985314*m),Pp(-.969266*u+1.8760108*l+.041556*m),Pp(.0556434*u-.2040259*l+1.0572252*m),s.alpha)}function Rd(s,l,u){var m=l-s;return s+u*(m>180||m<-180?m-360*Math.round(m/360):m)}var Au={forward:Np,reverse:Gl,interpolate:function(s,l,u){return{l:si(s.l,l.l,u),a:si(s.a,l.a,u),b:si(s.b,l.b,u),alpha:si(s.alpha,l.alpha,u)}}},es={forward:function(s){var l=Np(s),u=l.l,m=l.a,y=l.b,b=Math.atan2(y,m)*y0;return{h:b<0?b+360:b,c:Math.sqrt(m*m+y*y),l:u,alpha:s.a}},reverse:function(s){var l=s.h*Gy,u=s.c;return Gl({l:s.l,a:Math.cos(l)*u,b:Math.sin(l)*u,alpha:s.alpha})},interpolate:function(s,l,u){return{h:Rd(s.h,l.h,u),c:si(s.c,l.c,u),l:si(s.l,l.l,u),alpha:si(s.alpha,l.alpha,u)}}},Kh=Object.freeze({__proto__:null,lab:Au,hcl:es}),en=function(s,l,u,m,y){this.type=s,this.operator=l,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(var b=0,E=y;b<E.length;b+=1){var S=E[b],k=S[1];this.labels.push(S[0]),this.outputs.push(k)}};function Tg(s,l,u,m){var y=m-u,b=s-u;return 0===y?0:1===l?b/y:(Math.pow(l,b)-1)/(Math.pow(l,y)-1)}en.interpolationFactor=function(s,l,u,m){var y=0;if("exponential"===s.name)y=Tg(l,s.base,u,m);else if("linear"===s.name)y=Tg(l,1,u,m);else if("cubic-bezier"===s.name){var b=s.controlPoints;y=new Ve(b[0],b[1],b[2],b[3]).solve(Tg(l,1,u,m))}return y},en.parse=function(s,l){var u=s[0],m=s[1],y=s[2],b=s.slice(3);if(!Array.isArray(m)||0===m.length)return l.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){var E=m[1];if("number"!=typeof E)return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:E}}else{if("cubic-bezier"!==m[0])return l.error("Unknown interpolation type "+String(m[0]),1,0);var S=m.slice(1);if(4!==S.length||S.some(function(ce){return"number"!=typeof ce||ce<0||ce>1}))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:S}}if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(!(y=l.parse(y,2,Pe)))return null;var k=[],R=null;"interpolate-hcl"===u||"interpolate-lab"===u?R=Gt:l.expectedType&&"value"!==l.expectedType.kind&&(R=l.expectedType);for(var P=0;P<b.length;P+=2){var N=b[P],V=b[P+1],H=P+3,X=P+4;if("number"!=typeof N)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(k.length&&k[k.length-1][0]>=N)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);var Y=l.parse(V,X,R);if(!Y)return null;R=R||Y.type,k.push([N,Y])}return"number"===R.kind||"color"===R.kind||"array"===R.kind&&"number"===R.itemType.kind&&"number"==typeof R.N?new en(R,u,m,y,k):l.error("Type "+An(R)+" is not interpolatable.")},en.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;if(m>=l[y-1])return u[y-1].evaluate(s);var b=ql(l,m),E=en.interpolationFactor(this.interpolation,m,l[b],l[b+1]),S=u[b].evaluate(s),k=u[b+1].evaluate(s);return"interpolate"===this.operator?Mp[this.type.kind.toLowerCase()](S,k,E):"interpolate-hcl"===this.operator?es.reverse(es.interpolate(es.forward(S),es.forward(k),E)):Au.reverse(Au.interpolate(Au.forward(S),Au.forward(k),E))},en.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},en.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},en.prototype.serialize=function(){var s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var l=[this.operator,s,this.input.serialize()],u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l};var Jr=function(s,l){this.type=s,this.args=l};Jr.parse=function(s,l){if(s.length<2)return l.error("Expectected at least one argument.");var u=null,m=l.expectedType;m&&"value"!==m.kind&&(u=m);for(var y=[],b=0,E=s.slice(1);b<E.length;b+=1){var S=l.parse(E[b],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,y.push(S)}var k=m&&y.some(function(R){return Rr(m,R.type)});return new Jr(k?se:u,y)},Jr.prototype.evaluate=function(s){for(var l,u=null,m=0,y=0,b=this.args;y<b.length&&(m++,(u=b[y].evaluate(s))&&u instanceof wr&&!u.available&&(l||(l=u.name),u=null,m===this.args.length&&(u=l)),null===u);y+=1);return u},Jr.prototype.eachChild=function(s){this.args.forEach(s)},Jr.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},Jr.prototype.serialize=function(){var s=["coalesce"];return this.eachChild(function(l){s.push(l.serialize())}),s};var Xi=function(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l};Xi.prototype.evaluate=function(s){return this.result.evaluate(s)},Xi.prototype.eachChild=function(s){for(var l=0,u=this.bindings;l<u.length;l+=1)s(u[l][1]);s(this.result)},Xi.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found "+(s.length-1)+" instead.");for(var u=[],m=1;m<s.length-1;m+=2){var y=s[m];if("string"!=typeof y)return l.error("Expected string, but found "+typeof y+" instead.",m);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",m);var b=l.parse(s[m+1],m+1);if(!b)return null;u.push([y,b])}var E=l.parse(s[s.length-1],s.length-1,l.expectedType,u);return E?new Xi(u,E):null},Xi.prototype.outputDefined=function(){return this.result.outputDefined()},Xi.prototype.serialize=function(){for(var s=["let"],l=0,u=this.bindings;l<u.length;l+=1){var m=u[l];s.push(m[0],m[1].serialize())}return s.push(this.result.serialize()),s};var Da=function(s,l,u){this.type=s,this.index=l,this.input=u};Da.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,Pe),m=l.parse(s[2],2,br(l.expectedType||se));return u&&m?new Da(m.type.itemType,u,m):null},Da.prototype.evaluate=function(s){var l=this.index.evaluate(s),u=this.input.evaluate(s);if(l<0)throw new Dr("Array index out of bounds: "+l+" < 0.");if(l>=u.length)throw new Dr("Array index out of bounds: "+l+" > "+(u.length-1)+".");if(l!==Math.floor(l))throw new Dr("Array index must be an integer, but found "+l+" instead.");return u[l]},Da.prototype.eachChild=function(s){s(this.index),s(this.input)},Da.prototype.outputDefined=function(){return!1},Da.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Bs=function(s,l){this.type=Be,this.needle=s,this.haystack=l};Bs.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,se),m=l.parse(s[2],2,se);return u&&m?gn(u.type,[Be,Je,Pe,mt,se])?new Bs(u,m):l.error("Expected first argument to be of type boolean, string, number or null, but found "+An(u.type)+" instead"):null},Bs.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!u)return!1;if(!an(l,["boolean","string","number","null"]))throw new Dr("Expected first argument to be of type boolean, string, number or null, but found "+An(Mi(l))+" instead.");if(!an(u,["string","array"]))throw new Dr("Expected second argument to be of type array or string, but found "+An(Mi(u))+" instead.");return u.indexOf(l)>=0},Bs.prototype.eachChild=function(s){s(this.needle),s(this.haystack)},Bs.prototype.outputDefined=function(){return!0},Bs.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Zt=function(s,l,u){this.type=Pe,this.needle=s,this.haystack=l,this.fromIndex=u};Zt.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,se),m=l.parse(s[2],2,se);if(!u||!m)return null;if(!gn(u.type,[Be,Je,Pe,mt,se]))return l.error("Expected first argument to be of type boolean, string, number or null, but found "+An(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Pe);return y?new Zt(u,m,y):null}return new Zt(u,m)},Zt.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!an(l,["boolean","string","number","null"]))throw new Dr("Expected first argument to be of type boolean, string, number or null, but found "+An(Mi(l))+" instead.");if(!an(u,["string","array"]))throw new Dr("Expected second argument to be of type array or string, but found "+An(Mi(u))+" instead.");if(this.fromIndex){var m=this.fromIndex.evaluate(s);return u.indexOf(l,m)}return u.indexOf(l)},Zt.prototype.eachChild=function(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)},Zt.prototype.outputDefined=function(){return!1},Zt.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var wn=function(s,l,u,m,y,b){this.inputType=s,this.type=l,this.input=u,this.cases=m,this.outputs=y,this.otherwise=b};wn.parse=function(s,l){if(s.length<5)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if(s.length%2!=1)return l.error("Expected an even number of arguments.");var u,m;l.expectedType&&"value"!==l.expectedType.kind&&(m=l.expectedType);for(var y={},b=[],E=2;E<s.length-1;E+=2){var S=s[E],k=s[E+1];Array.isArray(S)||(S=[S]);var R=l.concat(E);if(0===S.length)return R.error("Expected at least one branch label.");for(var P=0,N=S;P<N.length;P+=1){var V=N[P];if("number"!=typeof V&&"string"!=typeof V)return R.error("Branch labels must be numbers or strings.");if("number"==typeof V&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return R.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof V&&Math.floor(V)!==V)return R.error("Numeric branch labels must be integer values.");if(u){if(R.checkSubtype(u,Mi(V)))return null}else u=Mi(V);if(void 0!==y[String(V)])return R.error("Branch labels must be unique.");y[String(V)]=b.length}var H=l.parse(k,E,m);if(!H)return null;m=m||H.type,b.push(H)}var X=l.parse(s[1],1,se);if(!X)return null;var Y=l.parse(s[s.length-1],s.length-1,m);return Y?"value"!==X.type.kind&&l.concat(1).checkSubtype(u,X.type)?null:new wn(u,m,X,y,b,Y):null},wn.prototype.evaluate=function(s){var l=this.input.evaluate(s);return(Mi(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)},wn.prototype.eachChild=function(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)},wn.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})&&this.otherwise.outputDefined()},wn.prototype.serialize=function(){for(var s=this,l=["match",this.input.serialize()],u=[],m={},y=0,b=Object.keys(this.cases).sort();y<b.length;y+=1){var E=b[y];void 0===(N=m[this.cases[E]])?(m[this.cases[E]]=u.length,u.push([this.cases[E],[E]])):u[N][1].push(E)}for(var S=function(H){return"number"===s.inputType.kind?Number(H):H},k=0,R=u;k<R.length;k+=1){var P=R[k],N=P[0],V=P[1];l.push(1===V.length?S(V[0]):V.map(S)),l.push(this.outputs[outputIndex$1].serialize())}return l.push(this.otherwise.serialize()),l};var Ru=function(s,l,u){this.type=s,this.branches=l,this.otherwise=u};Ru.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found only "+(s.length-1)+".");if(s.length%2!=0)return l.error("Expected an odd number of arguments.");var u;l.expectedType&&"value"!==l.expectedType.kind&&(u=l.expectedType);for(var m=[],y=1;y<s.length-1;y+=2){var b=l.parse(s[y],y,Be);if(!b)return null;var E=l.parse(s[y+1],y+1,u);if(!E)return null;m.push([b,E]),u=u||E.type}var S=l.parse(s[s.length-1],s.length-1,u);return S?new Ru(u,m,S):null},Ru.prototype.evaluate=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];if(m[0].evaluate(s))return y.evaluate(s)}return this.otherwise.evaluate(s)},Ru.prototype.eachChild=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];s(m[0]),s(y)}s(this.otherwise)},Ru.prototype.outputDefined=function(){return this.branches.every(function(s){return s[1].outputDefined()})&&this.otherwise.outputDefined()},Ru.prototype.serialize=function(){var s=["case"];return this.eachChild(function(l){s.push(l.serialize())}),s};var Wl=function(s,l,u,m){this.type=s,this.input=l,this.beginIndex=u,this.endIndex=m};function Yh(s,l){return"=="===s||"!="===s?"boolean"===l.kind||"string"===l.kind||"number"===l.kind||"null"===l.kind||"value"===l.kind:"string"===l.kind||"number"===l.kind||"value"===l.kind}function pr(s,l,u,m){return 0===m.compare(l,u)}function Ta(s,l,u){var m="=="!==s&&"!="!==s;return function(){function y(b,E,S){this.type=Be,this.lhs=b,this.rhs=E,this.collator=S,this.hasUntypedArgument="value"===b.type.kind||"value"===E.type.kind}return y.parse=function(b,E){if(3!==b.length&&4!==b.length)return E.error("Expected two or three arguments.");var S=b[0],k=E.parse(b[1],1,se);if(!k)return null;if(!Yh(S,k.type))return E.concat(1).error('"'+S+"\" comparisons are not supported for type '"+An(k.type)+"'.");var R=E.parse(b[2],2,se);if(!R)return null;if(!Yh(S,R.type))return E.concat(2).error('"'+S+"\" comparisons are not supported for type '"+An(R.type)+"'.");if(k.type.kind!==R.type.kind&&"value"!==k.type.kind&&"value"!==R.type.kind)return E.error("Cannot compare types '"+An(k.type)+"' and '"+An(R.type)+"'.");m&&("value"===k.type.kind&&"value"!==R.type.kind?k=new io(R.type,[k]):"value"!==k.type.kind&&"value"===R.type.kind&&(R=new io(k.type,[R])));var P=null;if(4===b.length){if("string"!==k.type.kind&&"string"!==R.type.kind&&"value"!==k.type.kind&&"value"!==R.type.kind)return E.error("Cannot use collator to compare non-string types.");if(!(P=E.parse(b[3],3,or)))return null}return new y(k,R,P)},y.prototype.evaluate=function(b){var E=this.lhs.evaluate(b),S=this.rhs.evaluate(b);if(m&&this.hasUntypedArgument){var k=Mi(E),R=Mi(S);if(k.kind!==R.kind||"string"!==k.kind&&"number"!==k.kind)throw new Dr('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+k.kind+", "+R.kind+") instead.")}if(this.collator&&!m&&this.hasUntypedArgument){var P=Mi(E),N=Mi(S);if("string"!==P.kind||"string"!==N.kind)return l(b,E,S)}return this.collator?u(b,E,S,this.collator.evaluate(b)):l(b,E,S)},y.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var b=[s];return this.eachChild(function(E){b.push(E.serialize())}),b},y}()}Wl.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,se),m=l.parse(s[2],2,Pe);if(!u||!m)return null;if(!gn(u.type,[br(se),Je,se]))return l.error("Expected first argument to be of type array or string, but found "+An(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Pe);return y?new Wl(u.type,u,m,y):null}return new Wl(u.type,u,m)},Wl.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=this.beginIndex.evaluate(s);if(!an(l,["string","array"]))throw new Dr("Expected first argument to be of type array or string, but found "+An(Mi(l))+" instead.");if(this.endIndex){var m=this.endIndex.evaluate(s);return l.slice(u,m)}return l.slice(u)},Wl.prototype.eachChild=function(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)},Wl.prototype.outputDefined=function(){return!1},Wl.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Mu=Ta("==",function(s,l,u){return l===u},pr),Wy=Ta("!=",function(s,l,u){return l!==u},function(s,l,u,m){return!pr(0,l,u,m)}),Zy=Ta("<",function(s,l,u){return l<u},function(s,l,u,m){return m.compare(l,u)<0}),Sg=Ta(">",function(s,l,u){return l>u},function(s,l,u,m){return m.compare(l,u)>0}),Xh=Ta("<=",function(s,l,u){return l<=u},function(s,l,u,m){return m.compare(l,u)<=0}),v0=Ta(">=",function(s,l,u){return l>=u},function(s,l,u,m){return m.compare(l,u)>=0}),Zl=function(s,l,u,m,y){this.type=Je,this.number=s,this.locale=l,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=y};Zl.parse=function(s,l){if(3!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,Pe);if(!u)return null;var m=s[2];if("object"!=typeof m||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");var y=null;if(m.locale&&!(y=l.parse(m.locale,1,Je)))return null;var b=null;if(m.currency&&!(b=l.parse(m.currency,1,Je)))return null;var E=null;if(m["min-fraction-digits"]&&!(E=l.parse(m["min-fraction-digits"],1,Pe)))return null;var S=null;return m["max-fraction-digits"]&&!(S=l.parse(m["max-fraction-digits"],1,Pe))?null:new Zl(u,y,b,E,S)},Zl.prototype.evaluate=function(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))},Zl.prototype.eachChild=function(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)},Zl.prototype.outputDefined=function(){return!1},Zl.prototype.serialize=function(){var s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]};var sl=function(s){this.type=Pe,this.input=s};sl.parse=function(s,l){if(2!==s.length)return l.error("Expected 1 argument, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?l.error("Expected argument of type string or array, but found "+An(u.type)+" instead."):new sl(u):null},sl.prototype.evaluate=function(s){var l=this.input.evaluate(s);if("string"==typeof l||Array.isArray(l))return l.length;throw new Dr("Expected value to be of type string or array, but found "+An(Mi(l))+" instead.")},sl.prototype.eachChild=function(s){s(this.input)},sl.prototype.outputDefined=function(){return!1},sl.prototype.serialize=function(){var s=["length"];return this.eachChild(function(l){s.push(l.serialize())}),s};var Pu={"==":Mu,"!=":Wy,">":Sg,"<":Zy,">=":v0,"<=":Xh,array:io,at:Da,boolean:io,case:Ru,coalesce:Jr,collator:yi,format:Jo,image:Ul,in:Bs,"index-of":Zt,interpolate:en,"interpolate-hcl":en,"interpolate-lab":en,length:sl,let:Xi,literal:Ys,match:wn,number:io,"number-format":Zl,object:io,slice:Wl,step:Ca,string:io,"to-boolean":Xs,"to-color":Xs,"to-number":Xs,"to-string":Xs,var:$l,within:Yi};function Ig(s,l){var u=l[0],m=l[1],y=l[2],b=l[3];u=u.evaluate(s),m=m.evaluate(s),y=y.evaluate(s);var E=b?b.evaluate(s):1,S=Cg(u,m,y,E);if(S)throw new Dr(S);return new mn(u/255*E,m/255*E,y/255*E,E)}function Qh(s,l){return s in l}function Jh(s,l){var u=l[s];return void 0===u?null:u}function vi(s){return{type:s}}function ef(s){return{result:"success",value:s}}function Ou(s){return{result:"error",value:s}}function Md(s){return"data-driven"===s["property-type"]||"cross-faded-data-driven"===s["property-type"]}function Sa(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Pd(s){return!!s.expression&&s.expression.interpolated}function ur(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function tf(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function Ct(s){return s}function zc(s,l,u){return void 0!==s?s:void 0!==l?l:void 0!==u?u:void 0}function Z(s,l,u,m,y){return zc(typeof u===y?m[u]:void 0,s.default,l.default)}function Od(s,l,u){if("number"!==ur(u))return zc(s.default,l.default);var m=s.stops.length;if(1===m||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[m-1][0])return s.stops[m-1][1];var y=ql(s.stops.map(function(b){return b[0]}),u);return s.stops[y][1]}function Nd(s,l,u){var m=void 0!==s.base?s.base:1;if("number"!==ur(u))return zc(s.default,l.default);var y=s.stops.length;if(1===y||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[y-1][0])return s.stops[y-1][1];var V,H,Y,ce,b=ql(s.stops.map(function(N){return N[0]}),u),E=(V=m,ce=u-(H=s.stops[b][0]),0===(Y=s.stops[b+1][0]-H)?0:1===V?ce/Y:(Math.pow(V,ce)-1)/(Math.pow(V,Y)-1)),S=s.stops[b][1],k=s.stops[b+1][1],R=Mp[l.type]||Ct;if(s.colorSpace&&"rgb"!==s.colorSpace){var P=Kh[s.colorSpace];R=function(N,V){return P.reverse(P.interpolate(P.forward(N),P.forward(V),E))}}return"function"==typeof S.evaluate?{evaluate:function(){for(var N=[],V=arguments.length;V--;)N[V]=arguments[V];var H=S.evaluate.apply(void 0,N),X=k.evaluate.apply(void 0,N);if(void 0!==H&&void 0!==X)return R(H,X,E)}}:R(S,k,E)}function nf(s,l,u){return"color"===l.type?u=mn.parse(u):"formatted"===l.type?u=Qr.fromString(u.toString()):"resolvedImage"===l.type?u=wr.fromString(u.toString()):ur(u)===l.type||"enum"===l.type&&l.values[u]||(u=void 0),zc(u,s.default,l.default)}Ki.register(Pu,{error:[{kind:"error"},[Je],function(s,l){throw new Dr(l[0].evaluate(s))}],typeof:[Je,[se],function(s,l){return An(Mi(l[0].evaluate(s)))}],"to-rgba":[br(Pe,4),[Gt],function(s,l){return l[0].evaluate(s).toArray()}],rgb:[Gt,[Pe,Pe,Pe],Ig],rgba:[Gt,[Pe,Pe,Pe,Pe],Ig],has:{type:Be,overloads:[[[Je],function(s,l){return Qh(l[0].evaluate(s),s.properties())}],[[Je,Wt],function(s,l){var u=l[1];return Qh(l[0].evaluate(s),u.evaluate(s))}]]},get:{type:se,overloads:[[[Je],function(s,l){return Jh(l[0].evaluate(s),s.properties())}],[[Je,Wt],function(s,l){var u=l[1];return Jh(l[0].evaluate(s),u.evaluate(s))}]]},"feature-state":[se,[Je],function(s,l){return Jh(l[0].evaluate(s),s.featureState||{})}],properties:[Wt,[],function(s){return s.properties()}],"geometry-type":[Je,[],function(s){return s.geometryType()}],id:[se,[],function(s){return s.id()}],zoom:[Pe,[],function(s){return s.globals.zoom}],"heatmap-density":[Pe,[],function(s){return s.globals.heatmapDensity||0}],"line-progress":[Pe,[],function(s){return s.globals.lineProgress||0}],accumulated:[se,[],function(s){return void 0===s.globals.accumulated?null:s.globals.accumulated}],"+":[Pe,vi(Pe),function(s,l){for(var u=0,m=0,y=l;m<y.length;m+=1)u+=y[m].evaluate(s);return u}],"*":[Pe,vi(Pe),function(s,l){for(var u=1,m=0,y=l;m<y.length;m+=1)u*=y[m].evaluate(s);return u}],"-":{type:Pe,overloads:[[[Pe,Pe],function(s,l){var u=l[1];return l[0].evaluate(s)-u.evaluate(s)}],[[Pe],function(s,l){return-l[0].evaluate(s)}]]},"/":[Pe,[Pe,Pe],function(s,l){var u=l[1];return l[0].evaluate(s)/u.evaluate(s)}],"%":[Pe,[Pe,Pe],function(s,l){var u=l[1];return l[0].evaluate(s)%u.evaluate(s)}],ln2:[Pe,[],function(){return Math.LN2}],pi:[Pe,[],function(){return Math.PI}],e:[Pe,[],function(){return Math.E}],"^":[Pe,[Pe,Pe],function(s,l){var u=l[1];return Math.pow(l[0].evaluate(s),u.evaluate(s))}],sqrt:[Pe,[Pe],function(s,l){return Math.sqrt(l[0].evaluate(s))}],log10:[Pe,[Pe],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN10}],ln:[Pe,[Pe],function(s,l){return Math.log(l[0].evaluate(s))}],log2:[Pe,[Pe],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN2}],sin:[Pe,[Pe],function(s,l){return Math.sin(l[0].evaluate(s))}],cos:[Pe,[Pe],function(s,l){return Math.cos(l[0].evaluate(s))}],tan:[Pe,[Pe],function(s,l){return Math.tan(l[0].evaluate(s))}],asin:[Pe,[Pe],function(s,l){return Math.asin(l[0].evaluate(s))}],acos:[Pe,[Pe],function(s,l){return Math.acos(l[0].evaluate(s))}],atan:[Pe,[Pe],function(s,l){return Math.atan(l[0].evaluate(s))}],min:[Pe,vi(Pe),function(s,l){return Math.min.apply(Math,l.map(function(u){return u.evaluate(s)}))}],max:[Pe,vi(Pe),function(s,l){return Math.max.apply(Math,l.map(function(u){return u.evaluate(s)}))}],abs:[Pe,[Pe],function(s,l){return Math.abs(l[0].evaluate(s))}],round:[Pe,[Pe],function(s,l){var u=l[0].evaluate(s);return u<0?-Math.round(-u):Math.round(u)}],floor:[Pe,[Pe],function(s,l){return Math.floor(l[0].evaluate(s))}],ceil:[Pe,[Pe],function(s,l){return Math.ceil(l[0].evaluate(s))}],"filter-==":[Be,[Je,se],function(s,l){var u=l[0],m=l[1];return s.properties()[u.value]===m.value}],"filter-id-==":[Be,[se],function(s,l){var u=l[0];return s.id()===u.value}],"filter-type-==":[Be,[Je],function(s,l){var u=l[0];return s.geometryType()===u.value}],"filter-<":[Be,[Je,se],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<b}],"filter-id-<":[Be,[se],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<y}],"filter->":[Be,[Je,se],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>b}],"filter-id->":[Be,[se],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>y}],"filter-<=":[Be,[Je,se],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<=b}],"filter-id-<=":[Be,[se],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<=y}],"filter->=":[Be,[Je,se],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>=b}],"filter-id->=":[Be,[se],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>=y}],"filter-has":[Be,[se],function(s,l){return l[0].value in s.properties()}],"filter-has-id":[Be,[],function(s){return null!==s.id()&&void 0!==s.id()}],"filter-type-in":[Be,[br(Je)],function(s,l){return l[0].value.indexOf(s.geometryType())>=0}],"filter-id-in":[Be,[br(se)],function(s,l){return l[0].value.indexOf(s.id())>=0}],"filter-in-small":[Be,[Je,br(se)],function(s,l){var u=l[0];return l[1].value.indexOf(s.properties()[u.value])>=0}],"filter-in-large":[Be,[Je,br(se)],function(s,l){var u=l[0],m=l[1];return function(y,b,E,S){for(;E<=S;){var k=E+S>>1;if(b[k]===y)return!0;b[k]>y?S=k-1:E=k+1}return!1}(s.properties()[u.value],m.value,0,m.value.length-1)}],all:{type:Be,overloads:[[[Be,Be],function(s,l){var u=l[1];return l[0].evaluate(s)&&u.evaluate(s)}],[vi(Be),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(!m[u].evaluate(s))return!1;return!0}]]},any:{type:Be,overloads:[[[Be,Be],function(s,l){var u=l[1];return l[0].evaluate(s)||u.evaluate(s)}],[vi(Be),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(m[u].evaluate(s))return!0;return!1}]]},"!":[Be,[Be],function(s,l){return!l[0].evaluate(s)}],"is-supported-script":[Be,[Je],function(s,l){var u=s.globals&&s.globals.isSupportedScript;return!u||u(l[0].evaluate(s))}],upcase:[Je,[Je],function(s,l){return l[0].evaluate(s).toUpperCase()}],downcase:[Je,[Je],function(s,l){return l[0].evaluate(s).toLowerCase()}],concat:[Je,vi(se),function(s,l){return l.map(function(u){return Co(u.evaluate(s))}).join("")}],"resolved-locale":[Je,[or],function(s,l){return l[0].evaluate(s).resolvedLocale()}]});var Ia=function(s,l){var u;this.expression=s,this._warningHistory={},this._evaluator=new Dt,this._defaultValue=l?"color"===(u=l).type&&tf(u.default)?new mn(0,0,0,0):"color"===u.type?mn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=l&&"enum"===l.type?l.values:null};function rf(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in Pu}function ka(s,l){var y,b,u=new Es(Pu,[],l?(b={color:Gt,string:Je,number:Pe,enum:Je,boolean:Be,formatted:Nt,resolvedImage:Jt},"array"===(y=l).type?br(b[y.value]||se,y.length):b[y.type]):void 0),m=u.parse(s,void 0,void 0,void 0,l&&"string"===l.type?{typeAnnotation:"coerce"}:void 0);return m?ef(new Ia(m,l)):Ou(u.errors)}Ia.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},Ia.prototype.evaluate=function(s,l,u,m,y,b){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{var E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Dr("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(E)+" instead.");return E}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var Ld=function(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent="constant"!==s&&!Hl(l.expression)};Ld.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},Ld.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)};var so=function(s,l,u,m){this.kind=s,this.zoomStops=u,this._styleExpression=l,this.isStateDependent="camera"!==s&&!Hl(l.expression),this.interpolationType=m};function Kl(s,l){if("error"===(s=ka(s,l)).result)return s;var u=s.value.expression,m=xs(u);if(!m&&!Md(l))return Ou([new ot("","data expressions not supported")]);var y=Wh(u,["zoom"]);if(!y&&!Sa(l))return Ou([new ot("","zoom expressions not supported")]);var b=function E(S){var k=null;if(S instanceof Xi)k=E(S.result);else if(S instanceof Jr)for(var R=0,P=S.args;R<P.length&&!(k=E(P[R]));R+=1);else(S instanceof Ca||S instanceof en)&&S.input instanceof Ki&&"zoom"===S.input.name&&(k=S);return k instanceof ot||S.eachChild(function(N){var V=E(N);V instanceof ot?k=V:!k&&V?k=new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):k&&V&&k!==V&&(k=new ot("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),k}(u);return b||y?b instanceof ot?Ou([b]):b instanceof en&&!Pd(l)?Ou([new ot("",'"interpolate" expressions cannot be used with this property')]):ef(b?new so(m?"camera":"composite",s.value,b.labels,b instanceof en?b.interpolation:void 0):new Ld(m?"constant":"source",s.value)):Ou([new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}so.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},so.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)},so.prototype.interpolationFactor=function(s,l,u){return this.interpolationType?en.interpolationFactor(this.interpolationType,s,l,u):0};var Nu=function(s,l){this._parameters=s,this._specification=l,Ke(this,function u(m,y){var b,E,S,k="color"===y.type,R=m.stops&&"object"==typeof m.stops[0][0],P=R||!(R||void 0!==m.property),N=m.type||(Pd(y)?"exponential":"interval");if(k&&((m=Ke({},m)).stops&&(m.stops=m.stops.map(function(et){return[et[0],mn.parse(et[1])]})),m.default=mn.parse(m.default?m.default:y.default)),m.colorSpace&&"rgb"!==m.colorSpace&&!Kh[m.colorSpace])throw new Error("Unknown color space: "+m.colorSpace);if("exponential"===N)b=Nd;else if("interval"===N)b=Od;else if("categorical"===N){b=Z,E=Object.create(null);for(var V=0,H=m.stops;V<H.length;V+=1){var X=H[V];E[X[0]]=X[1]}S=typeof m.stops[0][0]}else{if("identity"!==N)throw new Error('Unknown function type "'+N+'"');b=nf}if(R){for(var Y={},ce=[],le=0;le<m.stops.length;le++){var pe=m.stops[le],fe=pe[0].zoom;void 0===Y[fe]&&(Y[fe]={zoom:fe,type:m.type,property:m.property,default:m.default,stops:[]},ce.push(fe)),Y[fe].stops.push([pe[0].value,pe[1]])}for(var Te=[],Se=0,Oe=ce;Se<Oe.length;Se+=1){var Ge=Oe[Se];Te.push([Y[Ge].zoom,u(Y[Ge],y)])}var Qe={name:"linear"};return{kind:"composite",interpolationType:Qe,interpolationFactor:en.interpolationFactor.bind(void 0,Qe),zoomStops:Te.map(function(et){return et[0]}),evaluate:function(et,wt){var tt=et.zoom;return Nd({stops:Te,base:m.base},y,tt).evaluate(tt,wt)}}}if(P){var pt="exponential"===N?{name:"exponential",base:void 0!==m.base?m.base:1}:null;return{kind:"camera",interpolationType:pt,interpolationFactor:en.interpolationFactor.bind(void 0,pt),zoomStops:m.stops.map(function(et){return et[0]}),evaluate:function(et){return b(m,y,et.zoom,E,S)}}}return{kind:"source",evaluate:function(et,wt){var tt=wt&&wt.properties?wt.properties[m.property]:void 0;return void 0===tt?zc(m.default,y.default):b(m,y,tt,E,S)}}}(this._parameters,this._specification))};function ts(s){var l=s.key,u=s.value,m=s.valueSpec||{},y=s.objectElementValidators||{},b=s.style,E=s.styleSpec,S=[],k=ur(u);if("object"!==k)return[new re(l,u,"object expected, "+k+" found")];for(var R in u){var P=R.split(".")[0],N=m[P]||m["*"],V=void 0;if(y[P])V=y[P];else if(m[P])V=xn;else if(y["*"])V=y["*"];else{if(!m["*"]){S.push(new re(l,u[R],'unknown property "'+R+'"'));continue}V=xn}S=S.concat(V({key:(l&&l+".")+R,value:u[R],valueSpec:N,style:b,styleSpec:E,object:u,objectKey:R},u))}for(var H in m)y[H]||m[H].required&&void 0===m[H].default&&void 0===u[H]&&S.push(new re(l,u,'missing required property "'+H+'"'));return S}function Fd(s){var l=s.value,u=s.valueSpec,m=s.style,y=s.styleSpec,b=s.key,E=s.arrayElementValidator||xn;if("array"!==ur(l))return[new re(b,l,"array expected, "+ur(l)+" found")];if(u.length&&l.length!==u.length)return[new re(b,l,"array length "+u.length+" expected, length "+l.length+" found")];if(u["min-length"]&&l.length<u["min-length"])return[new re(b,l,"array length at least "+u["min-length"]+" expected, length "+l.length+" found")];var S={type:u.value,values:u.values};y.$version<7&&(S.function=u.function),"object"===ur(u.value)&&(S=u.value);for(var k=[],R=0;R<l.length;R++)k=k.concat(E({array:l,arrayIndex:R,value:l[R],valueSpec:S,style:m,styleSpec:y,key:b+"["+R+"]"}));return k}function Lp(s){var l=s.key,u=s.value,m=s.valueSpec,y=ur(u);return"number"===y&&u!=u&&(y="NaN"),"number"!==y?[new re(l,u,"number expected, "+y+" found")]:"minimum"in m&&u<m.minimum?[new re(l,u,u+" is less than the minimum value "+m.minimum)]:"maximum"in m&&u>m.maximum?[new re(l,u,u+" is greater than the maximum value "+m.maximum)]:[]}function sf(s){var l,u,m,y=s.valueSpec,b=Ce(s.value.type),E={},S="categorical"!==b&&void 0===s.value.property,k=!S,R="array"===ur(s.value.stops)&&"array"===ur(s.value.stops[0])&&"object"===ur(s.value.stops[0][0]),P=ts({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(H){if("identity"===b)return[new re(H.key,H.value,'identity function may not have a "stops" property')];var X=[],Y=H.value;return X=X.concat(Fd({key:H.key,value:Y,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:N})),"array"===ur(Y)&&0===Y.length&&X.push(new re(H.key,Y,"array must have at least one stop")),X},default:function(H){return xn({key:H.key,value:H.value,valueSpec:y,style:H.style,styleSpec:H.styleSpec})}}});return"identity"===b&&S&&P.push(new re(s.key,s.value,'missing required property "property"')),"identity"===b||s.value.stops||P.push(new re(s.key,s.value,'missing required property "stops"')),"exponential"===b&&s.valueSpec.expression&&!Pd(s.valueSpec)&&P.push(new re(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(k&&!Md(s.valueSpec)?P.push(new re(s.key,s.value,"property functions not supported")):S&&!Sa(s.valueSpec)&&P.push(new re(s.key,s.value,"zoom functions not supported"))),"categorical"!==b&&!R||void 0!==s.value.property||P.push(new re(s.key,s.value,'"property" property is required')),P;function N(H){var X=[],Y=H.value,ce=H.key;if("array"!==ur(Y))return[new re(ce,Y,"array expected, "+ur(Y)+" found")];if(2!==Y.length)return[new re(ce,Y,"array length 2 expected, length "+Y.length+" found")];if(R){if("object"!==ur(Y[0]))return[new re(ce,Y,"object expected, "+ur(Y[0])+" found")];if(void 0===Y[0].zoom)return[new re(ce,Y,"object stop key must have zoom")];if(void 0===Y[0].value)return[new re(ce,Y,"object stop key must have value")];if(m&&m>Ce(Y[0].zoom))return[new re(ce,Y[0].zoom,"stop zoom values must appear in ascending order")];Ce(Y[0].zoom)!==m&&(m=Ce(Y[0].zoom),u=void 0,E={}),X=X.concat(ts({key:ce+"[0]",value:Y[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Lp,value:V}}))}else X=X.concat(V({key:ce+"[0]",value:Y[0],valueSpec:{},style:H.style,styleSpec:H.styleSpec},Y));return rf(je(Y[1]))?X.concat([new re(ce+"[1]",Y[1],"expressions are not allowed in function stops.")]):X.concat(xn({key:ce+"[1]",value:Y[1],valueSpec:y,style:H.style,styleSpec:H.styleSpec}))}function V(H,X){var Y=ur(H.value),ce=Ce(H.value),le=null!==H.value?H.value:X;if(l){if(Y!==l)return[new re(H.key,le,Y+" stop domain type must match previous stop domain type "+l)]}else l=Y;if("number"!==Y&&"string"!==Y&&"boolean"!==Y)return[new re(H.key,le,"stop domain value must be a number, string, or boolean")];if("number"!==Y&&"categorical"!==b){var pe="number expected, "+Y+" found";return Md(y)&&void 0===b&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new re(H.key,le,pe)]}return"categorical"!==b||"number"!==Y||isFinite(ce)&&Math.floor(ce)===ce?"categorical"!==b&&"number"===Y&&void 0!==u&&ce<u?[new re(H.key,le,"stop domain values must appear in ascending order")]:(u=ce,"categorical"===b&&ce in E?[new re(H.key,le,"stop domain values must be unique")]:(E[ce]=!0,[])):[new re(H.key,le,"integer expected, found "+ce)]}}function Aa(s){var l=("property"===s.expressionContext?Kl:ka)(je(s.value),s.valueSpec);if("error"===l.result)return l.value.map(function(m){return new re(""+s.key+m.key,s.value,m.message)});var u=l.value.expression||l.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!u.outputDefined())return[new re(s.key,s.value,'Invalid data expression for "'+s.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===s.expressionContext&&"layout"===s.propertyType&&!Hl(u))return[new re(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext&&!Hl(u))return[new re(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!Wh(u,["zoom","feature-state"]))return[new re(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!xs(u))return[new re(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uc(s){var l=s.key,u=s.value,m=s.valueSpec,y=[];return Array.isArray(m.values)?-1===m.values.indexOf(Ce(u))&&y.push(new re(l,u,"expected one of ["+m.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(m.values).indexOf(Ce(u))&&y.push(new re(l,u,"expected one of ["+Object.keys(m.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function al(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(var l=0,u=s.slice(1);l<u.length;l+=1){var m=u[l];if(!al(m)&&"boolean"!=typeof m)return!1}return!0;default:return!0}}Nu.deserialize=function(s){return new Nu(s._parameters,s._specification)},Nu.serialize=function(s){return{_parameters:s._parameters,_specification:s._specification}};var Ky={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Cs(s){if(null==s)return{filter:function(){return!0},needGeometry:!1};al(s)||(s=Vs(s));var l=ka(s,Ky);if("error"===l.result)throw new Error(l.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,m,y){return l.value.evaluate(u,m,{},y)},needGeometry:function u(m){if(!Array.isArray(m))return!1;if("within"===m[0])return!0;for(var y=1;y<m.length;y++)if(u(m[y]))return!0;return!1}(s)}}function Tr(s,l){return s<l?-1:s>l?1:0}function Vs(s){if(!s)return!0;var l,u=s[0];return s.length<=1?"any"!==u:"=="===u?af(s[1],s[2],"=="):"!="===u?Ra(af(s[1],s[2],"==")):"<"===u||">"===u||"<="===u||">="===u?af(s[1],s[2],u):"any"===u?(l=s.slice(1),["any"].concat(l.map(Vs))):"all"===u?["all"].concat(s.slice(1).map(Vs)):"none"===u?["all"].concat(s.slice(1).map(Vs).map(Ra)):"in"===u?lf(s[1],s.slice(2)):"!in"===u?Ra(lf(s[1],s.slice(2))):"has"===u?Bd(s[1]):"!has"===u?Ra(Bd(s[1])):"within"!==u||s}function af(s,l,u){switch(s){case"$type":return["filter-type-"+u,l];case"$id":return["filter-id-"+u,l];default:return["filter-"+u,s,l]}}function lf(s,l){if(0===l.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(function(u){return typeof u!=typeof l[0]})?["filter-in-large",s,["literal",l.sort(Tr)]]:["filter-in-small",s,["literal",l]]}}function Bd(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Ra(s){return["!",s]}function cf(s){return al(je(s.value))?Aa(Ke({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(u){var m=u.value,y=u.key;if("array"!==ur(m))return[new re(y,m,"array expected, "+ur(m)+" found")];var b,E=u.styleSpec,S=[];if(m.length<1)return[new re(y,m,"filter array must have at least 1 element")];switch(S=S.concat(Uc({key:y+"[0]",value:m[0],valueSpec:E.filter_operator,style:u.style,styleSpec:u.styleSpec})),Ce(m[0])){case"<":case"<=":case">":case">=":m.length>=2&&"$type"===Ce(m[1])&&S.push(new re(y,m,'"$type" cannot be use with operator "'+m[0]+'"'));case"==":case"!=":3!==m.length&&S.push(new re(y,m,'filter array for operator "'+m[0]+'" must have 3 elements'));case"in":case"!in":m.length>=2&&"string"!==(b=ur(m[1]))&&S.push(new re(y+"[1]",m[1],"string expected, "+b+" found"));for(var k=2;k<m.length;k++)b=ur(m[k]),"$type"===Ce(m[1])?S=S.concat(Uc({key:y+"["+k+"]",value:m[k],valueSpec:E.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==b&&"number"!==b&&"boolean"!==b&&S.push(new re(y+"["+k+"]",m[k],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var R=1;R<m.length;R++)S=S.concat(l({key:y+"["+R+"]",value:m[R],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=ur(m[1]),2!==m.length?S.push(new re(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"string"!==b&&S.push(new re(y+"[1]",m[1],"string expected, "+b+" found"));break;case"within":b=ur(m[1]),2!==m.length?S.push(new re(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"object"!==b&&S.push(new re(y+"[1]",m[1],"object expected, "+b+" found"))}return S}(s)}function uf(s,l){var u=s.key,m=s.style,y=s.styleSpec,b=s.value,E=s.objectKey,S=y[l+"_"+s.layerType];if(!S)return[];var k=E.match(/^(.*)-transition$/);if("paint"===l&&k&&S[k[1]]&&S[k[1]].transition)return xn({key:u,value:b,valueSpec:y.transition,style:m,styleSpec:y});var R,P=s.valueSpec||S[E];if(!P)return[new re(u,b,'unknown property "'+E+'"')];if("string"===ur(b)&&Md(P)&&!P.tokens&&(R=/^{([^}]+)}$/.exec(b)))return[new re(u,b,'"'+E+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(R[1])+" }`.")];var N=[];return"symbol"===s.layerType&&("text-field"===E&&m&&!m.glyphs&&N.push(new re(u,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&tf(je(b))&&"identity"===Ce(b.type)&&N.push(new re(u,b,'"text-font" does not support identity functions'))),N.concat(xn({key:s.key,value:b,valueSpec:P,style:m,styleSpec:y,expressionContext:"property",propertyType:l,propertyKey:E}))}function jc(s){return uf(s,"paint")}function Fp(s){return uf(s,"layout")}function Lu(s){var l=[],u=s.value,m=s.key,y=s.style,b=s.styleSpec;u.type||u.ref||l.push(new re(m,u,'either "type" or "ref" is required'));var E,S=Ce(u.type),k=Ce(u.ref);if(u.id)for(var R=Ce(u.id),P=0;P<s.arrayIndex;P++){var N=y.layers[P];Ce(N.id)===R&&l.push(new re(m,u.id,'duplicate layer id "'+u.id+'", previously used at line '+N.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(X){X in u&&l.push(new re(m,u[X],'"'+X+'" is prohibited for ref layers'))}),y.layers.forEach(function(X){Ce(X.id)===k&&(E=X)}),E?E.ref?l.push(new re(m,u.ref,"ref cannot reference another ref layer")):S=Ce(E.type):l.push(new re(m,u.ref,'ref layer "'+k+'" not found'));else if("background"!==S)if(u.source){var V=y.sources&&y.sources[u.source],H=V&&Ce(V.type);V?"vector"===H&&"raster"===S?l.push(new re(m,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===H&&"raster"!==S?l.push(new re(m,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==H||u["source-layer"]?"raster-dem"===H&&"hillshade"!==S?l.push(new re(m,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==S||!u.paint||!u.paint["line-gradient"]||"geojson"===H&&V.lineMetrics||l.push(new re(m,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):l.push(new re(m,u,'layer "'+u.id+'" must specify a "source-layer"')):l.push(new re(m,u.source,'source "'+u.source+'" not found'))}else l.push(new re(m,u,'missing required property "source"'));return l=l.concat(ts({key:m,value:u,valueSpec:b.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return xn({key:m+".type",value:u.type,valueSpec:b.layer.type,style:s.style,styleSpec:s.styleSpec,object:u,objectKey:"type"})},filter:cf,layout:function(X){return ts({layer:u,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{"*":function(Y){return Fp(Ke({layerType:S},Y))}}})},paint:function(X){return ts({layer:u,key:X.key,value:X.value,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{"*":function(Y){return jc(Ke({layerType:S},Y))}}})}}}))}function sr(s){var l=s.value,u=s.key,m=ur(l);return"string"!==m?[new re(u,l,"string expected, "+m+" found")]:[]}var Fu={promoteId:function(s){var l=s.key,u=s.value;if("string"===ur(u))return sr({key:l,value:u});var m=[];for(var y in u)m.push.apply(m,sr({key:l+"."+y,value:u[y]}));return m}};function Hc(s){var l=s.value,u=s.key,m=s.styleSpec,y=s.style;if(!l.type)return[new re(u,l,'"type" is required')];var b,E=Ce(l.type);switch(E){case"vector":case"raster":case"raster-dem":return ts({key:u,value:l,valueSpec:m["source_"+E.replace("-","_")],style:s.style,styleSpec:m,objectElementValidators:Fu});case"geojson":if(b=ts({key:u,value:l,valueSpec:m.source_geojson,style:y,styleSpec:m,objectElementValidators:Fu}),l.cluster)for(var S in l.clusterProperties){var k=l.clusterProperties[S],R=k[0],P="string"==typeof R?[R,["accumulated"],["get",S]]:R;b.push.apply(b,Aa({key:u+"."+S+".map",value:k[1],expressionContext:"cluster-map"})),b.push.apply(b,Aa({key:u+"."+S+".reduce",value:P,expressionContext:"cluster-reduce"}))}return b;case"video":return ts({key:u,value:l,valueSpec:m.source_video,style:y,styleSpec:m});case"image":return ts({key:u,value:l,valueSpec:m.source_image,style:y,styleSpec:m});case"canvas":return[new re(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Uc({key:u+".type",value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:m})}}function Ma(s){var l=s.value,u=s.styleSpec,m=u.light,y=s.style,b=[],E=ur(l);if(void 0===l)return b;if("object"!==E)return b.concat([new re("light",l,"object expected, "+E+" found")]);for(var S in l){var k=S.match(/^(.*)-transition$/);b=b.concat(k&&m[k[1]]&&m[k[1]].transition?xn({key:S,value:l[S],valueSpec:u.transition,style:y,styleSpec:u}):m[S]?xn({key:S,value:l[S],valueSpec:m[S],style:y,styleSpec:u}):[new re(S,l[S],'unknown property "'+S+'"')])}return b}var qn={"*":function(){return[]},array:Fd,boolean:function(s){var l=s.value,u=s.key,m=ur(l);return"boolean"!==m?[new re(u,l,"boolean expected, "+m+" found")]:[]},number:Lp,color:function(s){var l=s.key,u=s.value,m=ur(u);return"string"!==m?[new re(l,u,"color expected, "+m+" found")]:null===kd(u)?[new re(l,u,'color expected, "'+u+'" found')]:[]},constants:ze,enum:Uc,filter:cf,function:sf,layer:Lu,object:ts,source:Hc,light:Ma,string:sr,formatted:function(s){return 0===sr(s).length?[]:Aa(s)},resolvedImage:function(s){return 0===sr(s).length?[]:Aa(s)}};function xn(s){var l=s.value,u=s.valueSpec,m=s.styleSpec;return u.expression&&tf(Ce(l))?sf(s):u.expression&&rf(je(l))?Aa(s):u.type&&qn[u.type]?qn[u.type](s):ts(Ke({},s,{valueSpec:u.type?m[u.type]:u}))}function Uo(s){var l=s.value,u=s.key,m=sr(s);return m.length||(-1===l.indexOf("{fontstack}")&&m.push(new re(u,l,'"glyphs" url must include a "{fontstack}" token')),-1===l.indexOf("{range}")&&m.push(new re(u,l,'"glyphs" url must include a "{range}" token'))),m}function Qs(s,l){void 0===l&&(l=W);var u=[];return u=u.concat(xn({key:"",value:s,valueSpec:l.$root,styleSpec:l,style:s,objectElementValidators:{glyphs:Uo,"*":function(){return[]}}})),s.constants&&(u=u.concat(ze({key:"constants",value:s.constants,style:s,styleSpec:l}))),df(u)}function df(s){return[].concat(s).sort(function(l,u){return l.line-u.line})}function ll(s){return function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];return df(s.apply(this,l))}}Qs.source=ll(Hc),Qs.light=ll(Ma),Qs.layer=ll(Lu),Qs.filter=ll(cf),Qs.paintProperty=ll(jc),Qs.layoutProperty=ll(Fp);var Bu=Qs,Bp=Bu.light,Yl=Bu.paintProperty,Fr=Bu.layoutProperty;function Js(s,l){var u=!1;if(l&&l.length)for(var m=0,y=l;m<y.length;m+=1)s.fire(new he(new Error(y[m].message))),u=!0;return u}var Pi=Ds;function Ds(s,l,u){var m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var y=new Int32Array(this.arrayBuffer);s=y[0],this.d=(l=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var E=y[3+b],S=y[3+b+1];m.push(E===S?null:y.subarray(E,S))}var k=y[3+m.length+1];this.keys=y.subarray(y[3+m.length],k),this.bboxes=y.subarray(k),this.insert=this._insertReadonly}else{this.d=l+2*u;for(var R=0;R<this.d*this.d;R++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=u,this.scale=l/s,this.uid=0;var P=u/l*s;this.min=-P,this.max=s+P}Ds.prototype.insert=function(s,l,u,m,y){this._forEachCell(l,u,m,y,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(y)},Ds.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ds.prototype._insertCell=function(s,l,u,m,y,b){this.cells[y].push(b)},Ds.prototype.query=function(s,l,u,m,y){var b=this.min,E=this.max;if(s<=b&&l<=b&&E<=u&&E<=m&&!y)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(s,l,u,m,this._queryCell,S,{},y),S},Ds.prototype._queryCell=function(s,l,u,m,y,b,E,S){var k=this.cells[y];if(null!==k)for(var R=this.keys,P=this.bboxes,N=0;N<k.length;N++){var V=k[N];if(void 0===E[V]){var H=4*V;(S?S(P[H+0],P[H+1],P[H+2],P[H+3]):s<=P[H+2]&&l<=P[H+3]&&u>=P[H+0]&&m>=P[H+1])?(E[V]=!0,b.push(R[V])):E[V]=!1}}},Ds.prototype._forEachCell=function(s,l,u,m,y,b,E,S){for(var k=this._convertToCellCoord(s),R=this._convertToCellCoord(l),P=this._convertToCellCoord(u),N=this._convertToCellCoord(m),V=k;V<=P;V++)for(var H=R;H<=N;H++){var X=this.d*H+V;if((!S||S(this._convertFromCellCoord(V),this._convertFromCellCoord(H),this._convertFromCellCoord(V+1),this._convertFromCellCoord(H+1)))&&y.call(this,s,l,u,m,X,b,E,S))return}},Ds.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Ds.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Ds.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,l=3+this.cells.length+1+1,u=0,m=0;m<this.cells.length;m++)u+=this.cells[m].length;var y=new Int32Array(l+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=l,E=0;E<s.length;E++){var S=s[E];y[3+E]=b,y.set(S,b),b+=S.length}return y[3+s.length]=b,y.set(this.keys,b),y[3+s.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};var kg=ft.ImageData,bi=ft.ImageBitmap,Qi={};function nt(s,l,u){void 0===u&&(u={}),Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),Qi[s]={klass:l,omit:u.omit||[],shallow:u.shallow||[]}}for(var Vd in nt("Object",Object),Pi.serialize=function(s,l){var u=s.toArrayBuffer();return l&&l.push(u),{buffer:u}},Pi.deserialize=function(s){return new Pi(s.buffer)},nt("Grid",Pi),nt("Color",mn),nt("Error",Error),nt("ResolvedImage",wr),nt("StylePropertyFunction",Nu),nt("StyleExpression",Ia,{omit:["_evaluator"]}),nt("ZoomDependentExpression",so),nt("ZoomConstantExpression",Ld),nt("CompoundExpression",Ki,{omit:["_evaluate"]}),Pu)Pu[Vd]._classRegistryKey||nt("Expression_"+Vd,Pu[Vd]);function Vu(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function Xl(s){return bi&&s instanceof bi}function Do(s,l){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Vu(s)||Xl(s))return l&&l.push(s),s;if(ArrayBuffer.isView(s)){var u=s;return l&&l.push(u.buffer),u}if(s instanceof kg)return l&&l.push(s.data.buffer),s;if(Array.isArray(s)){for(var m=[],y=0,b=s;y<b.length;y+=1)m.push(Do(b[y],l));return m}if("object"==typeof s){var E=s.constructor,S=E._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var k=E.serialize?E.serialize(s,l):{};if(!E.serialize){for(var R in s)if(s.hasOwnProperty(R)&&!(Qi[S].omit.indexOf(R)>=0)){var P=s[R];k[R]=Qi[S].shallow.indexOf(R)>=0?P:Do(P,l)}s instanceof Error&&(k.message=s.message)}if(k.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==S&&(k.$name=S),k}throw new Error("can't serialize object of type "+typeof s)}function Oi(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Vu(s)||Xl(s)||ArrayBuffer.isView(s)||s instanceof kg)return s;if(Array.isArray(s))return s.map(Oi);if("object"==typeof s){var l=s.$name||"Object",u=Qi[l].klass;if(!u)throw new Error("can't deserialize unregistered class "+l);if(u.deserialize)return u.deserialize(s);for(var m=Object.create(u.prototype),y=0,b=Object.keys(s);y<b.length;y+=1){var E=b[y];if("$name"!==E){var S=s[E];m[E]=Qi[l].shallow.indexOf(E)>=0?S:Oi(S)}}return m}throw new Error("can't deserialize object of type "+typeof s)}var ao=function(){this.first=!0};ao.prototype.update=function(s,l){var u=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=u,!0))};var lt={"Latin-1 Supplement":function(s){return s>=128&&s<=255},Arabic:function(s){return s>=1536&&s<=1791},"Arabic Supplement":function(s){return s>=1872&&s<=1919},"Arabic Extended-A":function(s){return s>=2208&&s<=2303},"Hangul Jamo":function(s){return s>=4352&&s<=4607},"Unified Canadian Aboriginal Syllabics":function(s){return s>=5120&&s<=5759},Khmer:function(s){return s>=6016&&s<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(s){return s>=6320&&s<=6399},"General Punctuation":function(s){return s>=8192&&s<=8303},"Letterlike Symbols":function(s){return s>=8448&&s<=8527},"Number Forms":function(s){return s>=8528&&s<=8591},"Miscellaneous Technical":function(s){return s>=8960&&s<=9215},"Control Pictures":function(s){return s>=9216&&s<=9279},"Optical Character Recognition":function(s){return s>=9280&&s<=9311},"Enclosed Alphanumerics":function(s){return s>=9312&&s<=9471},"Geometric Shapes":function(s){return s>=9632&&s<=9727},"Miscellaneous Symbols":function(s){return s>=9728&&s<=9983},"Miscellaneous Symbols and Arrows":function(s){return s>=11008&&s<=11263},"CJK Radicals Supplement":function(s){return s>=11904&&s<=12031},"Kangxi Radicals":function(s){return s>=12032&&s<=12255},"Ideographic Description Characters":function(s){return s>=12272&&s<=12287},"CJK Symbols and Punctuation":function(s){return s>=12288&&s<=12351},Hiragana:function(s){return s>=12352&&s<=12447},Katakana:function(s){return s>=12448&&s<=12543},Bopomofo:function(s){return s>=12544&&s<=12591},"Hangul Compatibility Jamo":function(s){return s>=12592&&s<=12687},Kanbun:function(s){return s>=12688&&s<=12703},"Bopomofo Extended":function(s){return s>=12704&&s<=12735},"CJK Strokes":function(s){return s>=12736&&s<=12783},"Katakana Phonetic Extensions":function(s){return s>=12784&&s<=12799},"Enclosed CJK Letters and Months":function(s){return s>=12800&&s<=13055},"CJK Compatibility":function(s){return s>=13056&&s<=13311},"CJK Unified Ideographs Extension A":function(s){return s>=13312&&s<=19903},"Yijing Hexagram Symbols":function(s){return s>=19904&&s<=19967},"CJK Unified Ideographs":function(s){return s>=19968&&s<=40959},"Yi Syllables":function(s){return s>=40960&&s<=42127},"Yi Radicals":function(s){return s>=42128&&s<=42191},"Hangul Jamo Extended-A":function(s){return s>=43360&&s<=43391},"Hangul Syllables":function(s){return s>=44032&&s<=55215},"Hangul Jamo Extended-B":function(s){return s>=55216&&s<=55295},"Private Use Area":function(s){return s>=57344&&s<=63743},"CJK Compatibility Ideographs":function(s){return s>=63744&&s<=64255},"Arabic Presentation Forms-A":function(s){return s>=64336&&s<=65023},"Vertical Forms":function(s){return s>=65040&&s<=65055},"CJK Compatibility Forms":function(s){return s>=65072&&s<=65103},"Small Form Variants":function(s){return s>=65104&&s<=65135},"Arabic Presentation Forms-B":function(s){return s>=65136&&s<=65279},"Halfwidth and Fullwidth Forms":function(s){return s>=65280&&s<=65519}};function Gr(s){for(var l=0,u=s;l<u.length;l+=1)if(qe(u[l].charCodeAt(0)))return!0;return!1}function qe(s){return!(746!==s&&747!==s&&(s<4352||!(lt["Bopomofo Extended"](s)||lt.Bopomofo(s)||lt["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||lt["CJK Compatibility Ideographs"](s)||lt["CJK Compatibility"](s)||lt["CJK Radicals Supplement"](s)||lt["CJK Strokes"](s)||!(!lt["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||lt["CJK Unified Ideographs Extension A"](s)||lt["CJK Unified Ideographs"](s)||lt["Enclosed CJK Letters and Months"](s)||lt["Hangul Compatibility Jamo"](s)||lt["Hangul Jamo Extended-A"](s)||lt["Hangul Jamo Extended-B"](s)||lt["Hangul Jamo"](s)||lt["Hangul Syllables"](s)||lt.Hiragana(s)||lt["Ideographic Description Characters"](s)||lt.Kanbun(s)||lt["Kangxi Radicals"](s)||lt["Katakana Phonetic Extensions"](s)||lt.Katakana(s)&&12540!==s||!(!lt["Halfwidth and Fullwidth Forms"](s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!lt["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||lt["Unified Canadian Aboriginal Syllabics"](s)||lt["Unified Canadian Aboriginal Syllabics Extended"](s)||lt["Vertical Forms"](s)||lt["Yijing Hexagram Symbols"](s)||lt["Yi Syllables"](s)||lt["Yi Radicals"](s))))}function Rt(s){return!(qe(s)||(l=s,lt["Latin-1 Supplement"](l)&&(167===l||169===l||174===l||177===l||188===l||189===l||190===l||215===l||247===l)||lt["General Punctuation"](l)&&(8214===l||8224===l||8225===l||8240===l||8241===l||8251===l||8252===l||8258===l||8263===l||8264===l||8265===l||8273===l)||lt["Letterlike Symbols"](l)||lt["Number Forms"](l)||lt["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||9003===l||l>=9085&&l<=9114||l>=9150&&l<=9165||9167===l||l>=9169&&l<=9179||l>=9186&&l<=9215)||lt["Control Pictures"](l)&&9251!==l||lt["Optical Character Recognition"](l)||lt["Enclosed Alphanumerics"](l)||lt["Geometric Shapes"](l)||lt["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||lt["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||lt["CJK Symbols and Punctuation"](l)||lt.Katakana(l)||lt["Private Use Area"](l)||lt["CJK Compatibility Forms"](l)||lt["Small Form Variants"](l)||lt["Halfwidth and Fullwidth Forms"](l)||8734===l||8756===l||8757===l||l>=9984&&l<=10087||l>=10102&&l<=10131||65532===l||65533===l));var l}function Pn(s){return s>=1424&&s<=2303||lt["Arabic Presentation Forms-A"](s)||lt["Arabic Presentation Forms-B"](s)}function Ni(s,l){return!(!l&&Pn(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||lt.Khmer(s))}function Li(s){for(var l=0,u=s;l<u.length;l+=1)if(Pn(u[l].charCodeAt(0)))return!0;return!1}var cl=null,Fi="unavailable",Tn=null,Rn=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(Fi="error"),cl&&cl(s)};function ns(){Kt.fire(new ue("pluginStateChange",{pluginStatus:Fi,pluginURL:Tn}))}var Kt=new K,lo=function(){return Fi},zd=function(){if("deferred"!==Fi||!Tn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Fi="loading",ns(),Tn&&Xn({url:Tn},function(s){s?Rn(s):(Fi="loaded",ns())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Fi||null!=Qn.applyArabicShaping},isLoading:function(){return"loading"===Fi},setState:function(s){Fi=s.pluginStatus,Tn=s.pluginURL},isParsed:function(){return null!=Qn.applyArabicShaping&&null!=Qn.processBidirectionalText&&null!=Qn.processStyledBidirectionalText},getPluginURL:function(){return Tn}},Ut=function(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ao,this.transition={})};Ut.prototype.isSupportedScript=function(s){return function(l,u){for(var m=0,y=l;m<y.length;m+=1)if(!Ni(y[m].charCodeAt(0),u))return!1;return!0}(s,Qn.isLoaded())},Ut.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ut.prototype.getCrossfadeParameters=function(){var s=this.zoom,l=s-Math.floor(s),u=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}};var Bi=function(s,l){this.property=s,this.value=l,this.expression=function(u,m){if(tf(u))return new Nu(u,m);if(rf(u)){var y=Kl(u,m);if("error"===y.result)throw new Error(y.value.map(function(E){return E.key+": "+E.message}).join(", "));return y.value}var b=u;return"string"==typeof u&&"color"===m.type&&(b=mn.parse(u)),{kind:"constant",evaluate:function(){return b}}}(void 0===l?s.specification.default:l,s.specification)};Bi.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Bi.prototype.possiblyEvaluate=function(s,l,u){return this.property.possiblyEvaluate(this,s,l,u)};var Vi=function(s){this.property=s,this.value=new Bi(s,void 0)};Vi.prototype.transitioned=function(s,l){return new co(this.property,this.value,l,ki({},s.transition,this.transition),s.now)},Vi.prototype.untransitioned=function(){return new co(this.property,this.value,null,{},0)};var ai=function(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)};ai.prototype.getValue=function(s){return Os(this._values[s].value.value)},ai.prototype.setValue=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Vi(this._values[s].property)),this._values[s].value=new Bi(this._values[s].property,null===l?void 0:Os(l))},ai.prototype.getTransition=function(s){return Os(this._values[s].transition)},ai.prototype.setTransition=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Vi(this._values[s].property)),this._values[s].transition=Os(l)||void 0},ai.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y);var b=this.getTransition(m);void 0!==b&&(s[m+"-transition"]=b)}return s},ai.prototype.transitioned=function(s,l){for(var u=new ea(this._properties),m=0,y=Object.keys(this._values);m<y.length;m+=1){var b=y[m];u._values[b]=this._values[b].transitioned(s,l._values[b])}return u},ai.prototype.untransitioned=function(){for(var s=new ea(this._properties),l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l];s._values[m]=this._values[m].untransitioned()}return s};var co=function(s,l,u,m,y){this.property=s,this.value=l,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=u)};co.prototype.possiblyEvaluate=function(s,l,u){var m=s.now||0,y=this.value.possiblyEvaluate(s,l,u),b=this.prior;if(b){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return b.possiblyEvaluate(s,l,u);var E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(s,l,u),y,function(S){if(S<=0)return 0;if(S>=1)return 1;var k=S*S,R=k*S;return 4*(S<.5?R:3*(S-k)+R-.75)}(E))}return y};var ea=function(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)};ea.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Ts(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m},ea.prototype.hasTransition=function(){for(var s=0,l=Object.keys(this._values);s<l.length;s+=1)if(this._values[l[s]].prior)return!0;return!1};var jo=function(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)};jo.prototype.getValue=function(s){return Os(this._values[s].value)},jo.prototype.setValue=function(s,l){this._values[s]=new Bi(this._values[s].property,null===l?void 0:Os(l))},jo.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y)}return s},jo.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Ts(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m};var Ho=function(s,l,u){this.property=s,this.value=l,this.parameters=u};Ho.prototype.isConstant=function(){return"constant"===this.value.kind},Ho.prototype.constantOr=function(s){return"constant"===this.value.kind?this.value.value:s},Ho.prototype.evaluate=function(s,l,u,m){return this.property.evaluate(this.value,this.parameters,s,l,u,m)};var Ts=function(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)};Ts.prototype.get=function(s){return this._values[s]};var Xe=function(s){this.specification=s};Xe.prototype.possiblyEvaluate=function(s,l){return s.expression.evaluate(l)},Xe.prototype.interpolate=function(s,l,u){var m=Mp[this.specification.type];return m?m(s,l,u):s};var It=function(s,l){this.specification=s,this.overrides=l};It.prototype.possiblyEvaluate=function(s,l,u,m){return new Ho(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(l,null,{},u,m)}:s.expression,l)},It.prototype.interpolate=function(s,l,u){if("constant"!==s.value.kind||"constant"!==l.value.kind)return s;if(void 0===s.value.value||void 0===l.value.value)return new Ho(this,{kind:"constant",value:void 0},s.parameters);var m=Mp[this.specification.type];return m?new Ho(this,{kind:"constant",value:m(s.value.value,l.value.value,u)},s.parameters):s},It.prototype.evaluate=function(s,l,u,m,y,b){return"constant"===s.kind?s.value:s.evaluate(l,u,m,y,b)};var li=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m,y,b){if(void 0===u.value)return new Ho(this,{kind:"constant",value:void 0},m);if("constant"===u.expression.kind){var E=u.expression.evaluate(m,null,{},y,b),S="resolvedImage"===u.property.specification.type&&"string"!=typeof E?E.name:E,k=this._calculate(S,S,S,m);return new Ho(this,{kind:"constant",value:k},m)}if("camera"===u.expression.kind){var R=this._calculate(u.expression.evaluate({zoom:m.zoom-1}),u.expression.evaluate({zoom:m.zoom}),u.expression.evaluate({zoom:m.zoom+1}),m);return new Ho(this,{kind:"constant",value:R},m)}return new Ho(this,u.expression,m)},l.prototype.evaluate=function(u,m,y,b,E,S){if("source"===u.kind){var k=u.evaluate(m,y,b,E,S);return this._calculate(k,k,k,m)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(m.zoom)-1},y,b),u.evaluate({zoom:Math.floor(m.zoom)},y,b),u.evaluate({zoom:Math.floor(m.zoom)+1},y,b),m):u.value},l.prototype._calculate=function(u,m,y,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:u,to:m}:{from:y,to:m}},l.prototype.interpolate=function(u){return u},l}(It),kt=function(s){this.specification=s};kt.prototype.possiblyEvaluate=function(s,l,u,m){if(void 0!==s.value){if("constant"===s.expression.kind){var y=s.expression.evaluate(l,null,{},u,m);return this._calculate(y,y,y,l)}return this._calculate(s.expression.evaluate(new Ut(Math.floor(l.zoom-1),l)),s.expression.evaluate(new Ut(Math.floor(l.zoom),l)),s.expression.evaluate(new Ut(Math.floor(l.zoom+1),l)),l)}},kt.prototype._calculate=function(s,l,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:u,to:l}},kt.prototype.interpolate=function(s){return s};var ta=function(s){this.specification=s};ta.prototype.possiblyEvaluate=function(s,l,u,m){return!!s.expression.evaluate(l,null,{},u,m)},ta.prototype.interpolate=function(){return!1};var ci=function(s){for(var l in this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],s){var u=s[l];u.specification.overridable&&this.overridableProperties.push(l);var m=this.defaultPropertyValues[l]=new Bi(u,void 0),y=this.defaultTransitionablePropertyValues[l]=new Vi(u);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}};nt("DataDrivenProperty",It),nt("DataConstantProperty",Xe),nt("CrossFadedDataDrivenProperty",li),nt("CrossFadedProperty",kt),nt("ColorRampProperty",ta);var wi=function(s){function l(u,m){if(s.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),m.layout&&(this._unevaluatedLayout=new jo(m.layout)),m.paint)){for(var y in this._transitionablePaint=new ai(m.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var b in u.layout)this.setLayoutProperty(b,u.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ts(m.paint)}}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},l.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},l.prototype.setLayoutProperty=function(u,m,y){void 0===y&&(y={}),null!=m&&this._validate(Fr,"layers."+this.id+".layout."+u,u,m,y)||("visibility"!==u?this._unevaluatedLayout.setValue(u,m):this.visibility=m)},l.prototype.getPaintProperty=function(u){return Rc(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},l.prototype.setPaintProperty=function(u,m,y){if(void 0===y&&(y={}),null!=m&&this._validate(Yl,"layers."+this.id+".paint."+u,u,m,y))return!1;if(Rc(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),m||void 0),!1;var b=this._transitionablePaint._values[u],E="cross-faded-data-driven"===b.property.specification["property-type"],S=b.value.isDataDriven(),k=b.value;this._transitionablePaint.setValue(u,m),this._handleSpecialPaintPropertyUpdate(u);var R=this._transitionablePaint._values[u].value;return R.isDataDriven()||S||E||this._handleOverridablePaintPropertyUpdate(u,k,R)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!1},l.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},l.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},l.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},l.prototype.recalculate=function(u,m){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,m)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,m)},l.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),_s(u,function(m,y){return!(void 0===m||"layout"===y&&!Object.keys(m).length||"paint"===y&&!Object.keys(m).length)})},l.prototype._validate=function(u,m,y,b,E){return void 0===E&&(E={}),(!E||!1!==E.validate)&&Js(this,u.call(Bu,{key:m,layerType:this.type,objectKey:y,value:b,styleSpec:W,style:{glyphs:!0,sprite:!0}}))},l.prototype.is3D=function(){return!1},l.prototype.isTileClipped=function(){return!1},l.prototype.hasOffscreenPass=function(){return!1},l.prototype.resize=function(){},l.prototype.isStateDependent=function(){for(var u in this.paint._values){var m=this.paint.get(u);if(m instanceof Ho&&Md(m.property.specification)&&("source"===m.value.kind||"composite"===m.value.kind)&&m.value.isStateDependent)return!0}return!1},l}(K),hf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},rs=function(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},zt=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function _n(s,l){void 0===l&&(l=1);var u=0,m=0;return{members:s.map(function(y){var b=hf[y.type].BYTES_PER_ELEMENT,E=u=uo(u,Math.max(l,b)),S=y.components||1;return m=Math.max(m,b),u+=b*S,{name:y.name,type:y.type,components:S,offset:E}}),size:uo(u,Math.max(m,l)),alignment:l}}function uo(s,l){return Math.ceil(s/l)*l}zt.serialize=function(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}},zt.deserialize=function(s){var l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l},zt.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},zt.prototype.clear=function(){this.length=0},zt.prototype.resize=function(s){this.reserve(s),this.length=s},zt.prototype.reserve=function(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}},zt.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var zu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.int16[b+0]=m,this.int16[b+1]=y,u},l}(zt);zu.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",zu);var Ji=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.int16[S+0]=m,this.int16[S+1]=y,this.int16[S+2]=b,this.int16[S+3]=E,u},l}(zt);Ji.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",Ji);var zi=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var R=6*u;return this.int16[R+0]=m,this.int16[R+1]=y,this.int16[R+2]=b,this.int16[R+3]=E,this.int16[R+4]=S,this.int16[R+5]=k,u},l}(zt);zi.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",zi);var is=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var R=4*u,P=8*u;return this.int16[R+0]=m,this.int16[R+1]=y,this.uint8[P+4]=b,this.uint8[P+5]=E,this.uint8[P+6]=S,this.uint8[P+7]=k,u},l}(zt);is.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",is);var os=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.float32[b+0]=m,this.float32[b+1]=y,u},l}(zt);os.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",os);var Ql=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,R,P,N){var V=this.length;return this.resize(V+1),this.emplace(V,u,m,y,b,E,S,k,R,P,N)},l.prototype.emplace=function(u,m,y,b,E,S,k,R,P,N,V){var H=10*u;return this.uint16[H+0]=m,this.uint16[H+1]=y,this.uint16[H+2]=b,this.uint16[H+3]=E,this.uint16[H+4]=S,this.uint16[H+5]=k,this.uint16[H+6]=R,this.uint16[H+7]=P,this.uint16[H+8]=N,this.uint16[H+9]=V,u},l}(zt);Ql.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",Ql);var Ud=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,R,P,N,V,H){var X=this.length;return this.resize(X+1),this.emplace(X,u,m,y,b,E,S,k,R,P,N,V,H)},l.prototype.emplace=function(u,m,y,b,E,S,k,R,P,N,V,H,X){var Y=12*u;return this.int16[Y+0]=m,this.int16[Y+1]=y,this.int16[Y+2]=b,this.int16[Y+3]=E,this.uint16[Y+4]=S,this.uint16[Y+5]=k,this.uint16[Y+6]=R,this.uint16[Y+7]=P,this.int16[Y+8]=N,this.int16[Y+9]=V,this.int16[Y+10]=H,this.int16[Y+11]=X,u},l}(zt);Ud.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",Ud);var Ss=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.float32[E+0]=m,this.float32[E+1]=y,this.float32[E+2]=b,u},l}(zt);Ss.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",Ss);var ff=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint32[1*u+0]=m,u},l}(zt);ff.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",ff);var pf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,R,P){var N=this.length;return this.resize(N+1),this.emplace(N,u,m,y,b,E,S,k,R,P)},l.prototype.emplace=function(u,m,y,b,E,S,k,R,P,N){var V=10*u,H=5*u;return this.int16[V+0]=m,this.int16[V+1]=y,this.int16[V+2]=b,this.int16[V+3]=E,this.int16[V+4]=S,this.int16[V+5]=k,this.uint32[H+3]=R,this.uint16[V+8]=P,this.uint16[V+9]=N,u},l}(zt);pf.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",pf);var Jl=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var R=6*u;return this.int16[R+0]=m,this.int16[R+1]=y,this.int16[R+2]=b,this.int16[R+3]=E,this.int16[R+4]=S,this.int16[R+5]=k,u},l}(zt);Jl.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",Jl);var Uu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E){var S=this.length;return this.resize(S+1),this.emplace(S,u,m,y,b,E)},l.prototype.emplace=function(u,m,y,b,E,S){var k=4*u,R=8*u;return this.float32[k+0]=m,this.float32[k+1]=y,this.float32[k+2]=b,this.int16[R+6]=E,this.int16[R+7]=S,u},l}(zt);Uu.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",Uu);var Ag=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=12*u,k=3*u;return this.uint8[S+0]=m,this.uint8[S+1]=y,this.float32[k+1]=b,this.float32[k+2]=E,u},l}(zt);Ag.prototype.bytesPerElement=12,nt("StructArrayLayout2ub2f12",Ag);var zs=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.uint16[E+0]=m,this.uint16[E+1]=y,this.uint16[E+2]=b,u},l}(zt);zs.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",zs);var Vp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe){var fe=this.length;return this.resize(fe+1),this.emplace(fe,u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe)},l.prototype.emplace=function(u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe,fe){var Te=24*u,Se=12*u,Oe=48*u;return this.int16[Te+0]=m,this.int16[Te+1]=y,this.uint16[Te+2]=b,this.uint16[Te+3]=E,this.uint32[Se+2]=S,this.uint32[Se+3]=k,this.uint32[Se+4]=R,this.uint16[Te+10]=P,this.uint16[Te+11]=N,this.uint16[Te+12]=V,this.float32[Se+7]=H,this.float32[Se+8]=X,this.uint8[Oe+36]=Y,this.uint8[Oe+37]=ce,this.uint8[Oe+38]=le,this.uint32[Se+10]=pe,this.int16[Te+22]=fe,u},l}(zt);Vp.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vp);var ju=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe,fe,Te,Se,Oe,Ge,Qe,pt,et,wt,tt,sn){var Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe,fe,Te,Se,Oe,Ge,Qe,pt,et,wt,tt,sn)},l.prototype.emplace=function(u,m,y,b,E,S,k,R,P,N,V,H,X,Y,ce,le,pe,fe,Te,Se,Oe,Ge,Qe,pt,et,wt,tt,sn,Mt){var ht=34*u,un=17*u;return this.int16[ht+0]=m,this.int16[ht+1]=y,this.int16[ht+2]=b,this.int16[ht+3]=E,this.int16[ht+4]=S,this.int16[ht+5]=k,this.int16[ht+6]=R,this.int16[ht+7]=P,this.uint16[ht+8]=N,this.uint16[ht+9]=V,this.uint16[ht+10]=H,this.uint16[ht+11]=X,this.uint16[ht+12]=Y,this.uint16[ht+13]=ce,this.uint16[ht+14]=le,this.uint16[ht+15]=pe,this.uint16[ht+16]=fe,this.uint16[ht+17]=Te,this.uint16[ht+18]=Se,this.uint16[ht+19]=Oe,this.uint16[ht+20]=Ge,this.uint16[ht+21]=Qe,this.uint16[ht+22]=pt,this.uint32[un+12]=et,this.float32[un+13]=wt,this.float32[un+14]=tt,this.float32[un+15]=sn,this.float32[un+16]=Mt,u},l}(zt);ju.prototype.bytesPerElement=68,nt("StructArrayLayout8i15ui1ul4f68",ju);var Us=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.float32[1*u+0]=m,u},l}(zt);Us.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",Us);var Rg=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.int16[E+0]=m,this.int16[E+1]=y,this.int16[E+2]=b,u},l}(zt);Rg.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",Rg);var zp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=4*u;return this.uint32[2*u+0]=m,this.uint16[E+2]=y,this.uint16[E+3]=b,u},l}(zt);zp.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",zp);var mf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.uint16[b+0]=m,this.uint16[b+1]=y,u},l}(zt);mf.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",mf);var Up=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint16[1*u+0]=m,u},l}(zt);Up.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",Up);var d=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.float32[S+0]=m,this.float32[S+1]=y,this.float32[S+2]=b,this.float32[S+3]=E,u},l}(zt);d.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",d);var f=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Vt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(l.prototype,u),l}(rs);f.prototype.size=20;var h=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new f(this,u)},l}(pf);nt("CollisionBoxArray",h);var g=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(m){this._structArray.uint8[this._pos1+37]=m},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(m){this._structArray.uint8[this._pos1+38]=m},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+10]=m},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(l.prototype,u),l}(rs);g.prototype.size=48;var w=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new g(this,u)},l}(Vp);nt("PlacedSymbolArray",w);var C=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+12]=m},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(l.prototype,u),l}(rs);C.prototype.size=68;var T=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new C(this,u)},l}(ju);nt("SymbolInstanceArray",T);var I=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getoffsetX=function(u){return this.float32[1*u+0]},l}(Us);nt("GlyphOffsetArray",I);var M=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getx=function(u){return this.int16[3*u+0]},l.prototype.gety=function(u){return this.int16[3*u+1]},l.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},l}(Rg);nt("SymbolLineVertexArray",M);var L=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(l.prototype,u),l}(rs);L.prototype.size=8;var $=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new L(this,u)},l}(zp);nt("FeatureIndexArray",$);var q=_n([{name:"a_pos",components:2,type:"Int16"}],4).members,j=function(s){void 0===s&&(s=[]),this.segments=s};function ne(s,l){return 256*(s=Wi(Math.floor(s),0,255))+Wi(Math.floor(l),0,255)}j.prototype.prepareSegment=function(s,l,u,m){var y=this.segments[this.segments.length-1];return s>j.MAX_VERTEX_ARRAY_LENGTH&&lr("Max vertices per segment is "+j.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+s),(!y||y.vertexLength+s>j.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==m&&(y.sortKey=m),this.segments.push(y)),y},j.prototype.get=function(){return this.segments},j.prototype.destroy=function(){for(var s=0,l=this.segments;s<l.length;s+=1){var u=l[s];for(var m in u.vaos)u.vaos[m].destroy()}},j.simpleSegment=function(s,l,u,m){return new j([{vertexOffset:s,primitiveOffset:l,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])},j.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",j);var J=_n([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ae=zo(function(s){s.exports=function(l,u){var m,y,b,E,S,k,R,P;for(y=l.length-(m=3&l.length),b=u,S=3432918353,k=461845907,P=0;P<y;)R=255&l.charCodeAt(P)|(255&l.charCodeAt(++P))<<8|(255&l.charCodeAt(++P))<<16|(255&l.charCodeAt(++P))<<24,++P,b=27492+(65535&(E=5*(65535&(b=(b^=R=(65535&(R=(R=(65535&R)*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(R=0,m){case 3:R^=(255&l.charCodeAt(P+2))<<16;case 2:R^=(255&l.charCodeAt(P+1))<<8;case 1:b^=R=(65535&(R=(R=(65535&(R^=255&l.charCodeAt(P)))*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),ee=zo(function(s){s.exports=function(l,u){for(var m,y=l.length,b=u^y,E=0;y>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:b^=(255&l.charCodeAt(E+2))<<16;case 2:b^=(255&l.charCodeAt(E+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(E)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),ie=ae,de=ee;ie.murmur3=ae,ie.murmur2=de;var me=function(){this.ids=[],this.positions=[],this.indexed=!1};me.prototype.add=function(s,l,u,m){this.ids.push(Ee(s)),this.positions.push(l,u,m)},me.prototype.getPositions=function(s){for(var l=Ee(s),u=0,m=this.ids.length-1;u<m;){var y=u+m>>1;this.ids[y]>=l?m=y:u=y+1}for(var b=[];this.ids[u]===l;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b},me.serialize=function(s,l){var u=new Float64Array(s.ids),m=new Uint32Array(s.positions);return function y(b,E,S,k){for(;S<k;){for(var R=b[S+k>>1],P=S-1,N=k+1;;){do{P++}while(b[P]<R);do{N--}while(b[N]>R);if(P>=N)break;ke(b,P,N),ke(E,3*P,3*N),ke(E,3*P+1,3*N+1),ke(E,3*P+2,3*N+2)}N-S<k-N?(y(b,E,S,N),S=N+1):(y(b,E,N+1,k),k=N)}}(u,m,0,u.length-1),l&&l.push(u.buffer,m.buffer),{ids:u,positions:m}},me.deserialize=function(s){var l=new me;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l};var Ie=Math.pow(2,53)-1;function Ee(s){var l=+s;return!isNaN(l)&&l<=Ie?l:ie(String(s))}function ke(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}nt("FeaturePositionMap",me);var Ne=function(s,l){this.gl=s.gl,this.location=l},Ze=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},l}(Ne),He=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},l}(Ne),rt=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},l}(Ne),gt=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},l}(Ne),bt=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},l}(Ne),vt=function(s){function l(u,m){s.call(this,u,m),this.current=mn.transparent}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},l}(Ne),ln=new Float32Array(16),st=function(s){function l(u,m){s.call(this,u,m),this.current=ln}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},l}(Ne);function Ht(s){return[ne(255*s.r,255*s.g),ne(255*s.b,255*s.a)]}var on=function(s,l,u){this.value=s,this.uniformNames=l.map(function(m){return"u_"+m}),this.type=u};on.prototype.setUniform=function(s,l,u){s.set(u.constantOr(this.value))},on.prototype.getBinding=function(s,l,u){return"color"===this.type?new vt(s,l):new He(s,l)};var Ye=function(s,l){this.uniformNames=l.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ye.prototype.setConstantPatternPositions=function(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr},Ye.prototype.setUniform=function(s,l,u,m){var y="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;y&&s.set(y)},Ye.prototype.getBinding=function(s,l,u){return"u_pattern"===u.substr(0,9)?new bt(s,l):new He(s,l)};var Pt=function(s,l,u,m){this.expression=s,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(function(y){return{name:"a_"+y,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new m};Pt.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.paintVertexArray.length,E=this.expression.evaluate(new Ut(0),l,{},m,[],y);this.paintVertexArray.resize(s),this._setPaintValue(b,s,E)},Pt.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(s,l,y)},Pt.prototype._setPaintValue=function(s,l,u){if("color"===this.type)for(var m=Ht(u),y=s;y<l;y++)this.paintVertexArray.emplace(y,m[0],m[1]);else{for(var b=s;b<l;b++)this.paintVertexArray.emplace(b,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},Pt.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ft=function(s,l,u,m,y,b){this.expression=s,this.uniformNames=l.map(function(E){return"u_"+E+"_t"}),this.type=u,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(function(E){return{name:"a_"+E,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new b};Ft.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.expression.evaluate(new Ut(this.zoom),l,{},m,[],y),E=this.expression.evaluate(new Ut(this.zoom+1),l,{},m,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(S,s,b,E)},Ft.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:this.zoom},u,m),b=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(s,l,y,b)},Ft.prototype._setPaintValue=function(s,l,u,m){if("color"===this.type)for(var y=Ht(u),b=Ht(m),E=s;E<l;E++)this.paintVertexArray.emplace(E,y[0],y[1],b[0],b[1]);else{for(var S=s;S<l;S++)this.paintVertexArray.emplace(S,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}},Ft.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ft.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ft.prototype.setUniform=function(s,l){var u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=Wi(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);s.set(m)},Ft.prototype.getBinding=function(s,l,u){return new He(s,l)};var Ot=function(s,l,u,m,y,b){this.expression=s,this.type=l,this.useIntegerZoom=u,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y};Ot.prototype.populatePaintArray=function(s,l,u){var m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,l.patterns&&l.patterns[this.layerId],u)},Ot.prototype.updatePaintArray=function(s,l,u,m,y){this._setPaintValues(s,l,u.patterns&&u.patterns[this.layerId],y)},Ot.prototype._setPaintValues=function(s,l,u,m){if(m&&u){var y=m[u.min],b=m[u.mid],E=m[u.max];if(y&&b&&E)for(var S=s;S<l;S++)this.zoomInPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],b.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],b.pixelRatio,E.pixelRatio)}},Ot.prototype.upload=function(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,J.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,J.members,this.expression.isStateDependent))},Ot.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Tt=function(s,l,u){this.binders={},this._buffers=[];var m=[];for(var y in s.paint._values)if(u(y)){var b=s.paint.get(y);if(b instanceof Ho&&Md(b.property.specification)){var E=Br(y,s.type),S=b.value,k=b.property.specification.type,R=b.property.useIntegerZoom,P=b.property.specification["property-type"],N="cross-faded"===P||"cross-faded-data-driven"===P;if("constant"===S.kind)this.binders[y]=N?new Ye(S.value,E):new on(S.value,E,k),m.push("/u_"+y);else if("source"===S.kind||N){var V=eo(y,k,"source");this.binders[y]=N?new Ot(S,k,R,l,V,s.id):new Pt(S,E,k,V),m.push("/a_"+y)}else{var H=eo(y,k,"composite");this.binders[y]=new Ft(S,E,k,R,l,H),m.push("/z_"+y)}}}this.cacheKey=m.sort().join("")};Tt.prototype.getMaxValue=function(s){var l=this.binders[s];return l instanceof Pt||l instanceof Ft?l.maxValue:0},Tt.prototype.populatePaintArrays=function(s,l,u,m,y){for(var b in this.binders){var E=this.binders[b];(E instanceof Pt||E instanceof Ft||E instanceof Ot)&&E.populatePaintArray(s,l,u,m,y)}},Tt.prototype.setConstantPatternPositions=function(s,l){for(var u in this.binders){var m=this.binders[u];m instanceof Ye&&m.setConstantPatternPositions(s,l)}},Tt.prototype.updatePaintArrays=function(s,l,u,m,y){var b=!1;for(var E in s)for(var S=0,k=l.getPositions(E);S<k.length;S+=1){var R=k[S],P=u.feature(R.index);for(var N in this.binders){var V=this.binders[N];if((V instanceof Pt||V instanceof Ft||V instanceof Ot)&&!0===V.expression.isStateDependent){var H=m.paint.get(N);V.expression=H.value,V.updatePaintArray(R.start,R.end,P,s[E],y),b=!0}}}return b},Tt.prototype.defines=function(){var s=[];for(var l in this.binders){var u=this.binders[l];(u instanceof on||u instanceof Ye)&&s.push.apply(s,u.uniformNames.map(function(m){return"#define HAS_UNIFORM_"+m}))}return s},Tt.prototype.getBinderAttributes=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof Pt||u instanceof Ft)for(var m=0;m<u.paintVertexAttributes.length;m++)s.push(u.paintVertexAttributes[m].name);else if(u instanceof Ot)for(var y=0;y<J.members.length;y++)s.push(J.members[y].name)}return s},Tt.prototype.getBinderUniforms=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof on||u instanceof Ye||u instanceof Ft)for(var m=0,y=u.uniformNames;m<y.length;m+=1)s.push(y[m])}return s},Tt.prototype.getPaintVertexBuffers=function(){return this._buffers},Tt.prototype.getUniforms=function(s,l){var u=[];for(var m in this.binders){var y=this.binders[m];if(y instanceof on||y instanceof Ye||y instanceof Ft)for(var b=0,E=y.uniformNames;b<E.length;b+=1){var S=E[b];if(l[S]){var k=y.getBinding(s,l[S],S);u.push({name:S,property:m,binding:k})}}}return u},Tt.prototype.setUniforms=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1){var E=b[y],S=E.name,k=E.property;this.binders[k].setUniform(E.binding,m,u.get(k),S)}},Tt.prototype.updatePaintBuffers=function(s){for(var l in this._buffers=[],this.binders){var u=this.binders[l];if(s&&u instanceof Ot){var m=2===s.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof Pt||u instanceof Ft)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},Tt.prototype.upload=function(s){for(var l in this.binders){var u=this.binders[l];(u instanceof Pt||u instanceof Ft||u instanceof Ot)&&u.upload(s)}this.updatePaintBuffers()},Tt.prototype.destroy=function(){for(var s in this.binders){var l=this.binders[s];(l instanceof Pt||l instanceof Ft||l instanceof Ot)&&l.destroy()}};var Jn=function(s,l,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var m=0,y=s;m<y.length;m+=1){var b=y[m];this.programConfigurations[b.id]=new Tt(b,l,u)}this.needsUpload=!1,this._featureMap=new me,this._bufferOffset=0};function Br(s,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(l+"-","").replace(/-/g,"_")]}function eo(s,l,u){var y={"line-pattern":{source:Ql,composite:Ql},"fill-pattern":{source:Ql,composite:Ql},"fill-extrusion-pattern":{source:Ql,composite:Ql}}[s];return y&&y[u]||{color:{source:os,composite:d},number:{source:Us,composite:os}}[l][u]}Jn.prototype.populatePaintArrays=function(s,l,u,m,y,b){for(var E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(s,l,m,y,b);void 0!==l.id&&this._featureMap.add(l.id,u,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0},Jn.prototype.updatePaintArrays=function(s,l,u,m){for(var y=0,b=u;y<b.length;y+=1){var E=b[y];this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(s,this._featureMap,l,E,m)||this.needsUpload}},Jn.prototype.get=function(s){return this.programConfigurations[s]},Jn.prototype.upload=function(s){if(this.needsUpload){for(var l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}},Jn.prototype.destroy=function(){for(var s in this.programConfigurations)this.programConfigurations[s].destroy()},nt("ConstantBinder",on),nt("CrossFadedConstantBinder",Ye),nt("SourceExpressionBinder",Pt),nt("CrossFadedCompositeBinder",Ot),nt("CompositeExpressionBinder",Ft),nt("ProgramConfiguration",Tt,{omit:["_buffers"]}),nt("ProgramConfigurationSet",Jn);var ui=Math.pow(2,14)-1,di=-ui-1;function Wr(s){for(var l=8192/s.extent,u=s.loadGeometry(),m=0;m<u.length;m++)for(var y=u[m],b=0;b<y.length;b++){var E=y[b],S=Math.round(E.x*l),k=Math.round(E.y*l);E.x=Wi(S,di,ui),E.y=Wi(k,di,ui),(S<E.x||S>E.x+1||k<E.y||k>E.y+1)&&lr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function To(s,l){return{type:s.type,id:s.id,properties:s.properties,geometry:l?Wr(s):[]}}function Pa(s,l,u,m,y){s.emplaceBack(2*l+(m+1)/2,2*u+(y+1)/2)}var ho=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new zu,this.indexArray=new zs,this.segments=new j,this.programConfigurations=new Jn(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function Ae(s,l){for(var u=0;u<s.length;u++)if(ra(l,s[u]))return!0;for(var m=0;m<l.length;m++)if(ra(s,l[m]))return!0;return!!$t(s,l)}function Lt(s,l,u){return!!ra(s,l)||!!na(l,s,u)}function yn(s,l){if(1===s.length)return qc(l,s[0]);for(var u=0;u<l.length;u++)for(var m=l[u],y=0;y<m.length;y++)if(ra(s,m[y]))return!0;for(var b=0;b<s.length;b++)if(qc(l,s[b]))return!0;for(var E=0;E<l.length;E++)if($t(s,l[E]))return!0;return!1}function er(s,l,u){if(s.length>1){if($t(s,l))return!0;for(var m=0;m<l.length;m++)if(na(l[m],s,u))return!0}for(var y=0;y<s.length;y++)if(na(s[y],l,u))return!0;return!1}function $t(s,l){if(0===s.length||0===l.length)return!1;for(var u=0;u<s.length-1;u++)for(var m=s[u],y=s[u+1],b=0;b<l.length-1;b++)if($c(m,y,l[b],l[b+1]))return!0;return!1}function $c(s,l,u,m){return xo(s,u,m)!==xo(l,u,m)&&xo(s,l,u)!==xo(s,l,m)}function na(s,l,u){var m=u*u;if(1===l.length)return s.distSqr(l[0])<m;for(var y=1;y<l.length;y++)if(Is(s,l[y-1],l[y])<m)return!0;return!1}function Is(s,l,u){var m=l.distSqr(u);if(0===m)return s.distSqr(l);var y=((s.x-l.x)*(u.x-l.x)+(s.y-l.y)*(u.y-l.y))/m;return s.distSqr(y<0?l:y>1?u:u.sub(l)._mult(y)._add(l))}function qc(s,l){for(var u,m,y,b=!1,E=0;E<s.length;E++)for(var S=0,k=(u=s[E]).length-1;S<u.length;k=S++)(m=u[S]).y>l.y!=(y=u[k]).y>l.y&&l.x<(y.x-m.x)*(l.y-m.y)/(y.y-m.y)+m.x&&(b=!b);return b}function ra(s,l){for(var u=!1,m=0,y=s.length-1;m<s.length;y=m++){var b=s[m],E=s[y];b.y>l.y!=E.y>l.y&&l.x<(E.x-b.x)*(l.y-b.y)/(E.y-b.y)+b.x&&(u=!u)}return u}function Gc(s,l,u){var m=u[0],y=u[2];if(s.x<m.x&&l.x<m.x||s.x>y.x&&l.x>y.x||s.y<m.y&&l.y<m.y||s.y>y.y&&l.y>y.y)return!1;var b=xo(s,l,u[0]);return b!==xo(s,l,u[1])||b!==xo(s,l,u[2])||b!==xo(s,l,u[3])}function xi(s,l,u){var m=l.paint.get(s).value;return"constant"===m.kind?m.value:u.programConfigurations.get(l.id).getMaxValue(s)}function ec(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function js(s,l,u,m,y){if(!l[0]&&!l[1])return s;var b=Vt.convert(l)._mult(y);"viewport"===u&&b._rotate(-m);for(var E=[],S=0;S<s.length;S++)E.push(s[S].sub(b));return E}ho.prototype.populate=function(s,l,u){var m=this.layers[0],y=[],b=null,E=!1;"circle"===m.type&&(E=!(b=m.layout.get("circle-sort-key")).isConstant());for(var S=0,k=s;S<k.length;S+=1){var R=k[S],P=R.feature,N=R.id,V=R.index,H=R.sourceLayerIndex,X=this.layers[0]._featureFilter.needGeometry,Y=To(P,X);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),Y,u)){var ce=E?b.evaluate(Y,{},u):void 0,le={id:N,properties:P.properties,type:P.type,sourceLayerIndex:H,index:V,geometry:X?Y.geometry:Wr(P),patterns:{},sortKey:ce};y.push(le)}}E&&y.sort(function(pt,et){return pt.sortKey-et.sortKey});for(var pe=0,fe=y;pe<fe.length;pe+=1){var Te=fe[pe],Se=Te.geometry,Oe=Te.index,Ge=Te.sourceLayerIndex,Qe=s[Oe].feature;this.addFeature(Te,Se,Oe,u),l.featureIndex.insert(Qe,Se,Oe,Ge,this.index)}},ho.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},ho.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ho.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ho.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,q),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},ho.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ho.prototype.addFeature=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1)for(var E=0,S=b[y];E<S.length;E+=1){var k=S[E],R=k.x,P=k.y;if(!(R<0||R>=8192||P<0||P>=8192)){var N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),V=N.vertexLength;Pa(this.layoutVertexArray,R,P,-1,-1),Pa(this.layoutVertexArray,R,P,1,-1),Pa(this.layoutVertexArray,R,P,1,1),Pa(this.layoutVertexArray,R,P,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),N.vertexLength+=4,N.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,{},m)},nt("CircleBucket",ho,{omit:["layers"]});var tc=new ci({"circle-sort-key":new It(W.layout_circle["circle-sort-key"])}),Sr={paint:new ci({"circle-radius":new It(W.paint_circle["circle-radius"]),"circle-color":new It(W.paint_circle["circle-color"]),"circle-blur":new It(W.paint_circle["circle-blur"]),"circle-opacity":new It(W.paint_circle["circle-opacity"]),"circle-translate":new Xe(W.paint_circle["circle-translate"]),"circle-translate-anchor":new Xe(W.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xe(W.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xe(W.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new It(W.paint_circle["circle-stroke-width"]),"circle-stroke-color":new It(W.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new It(W.paint_circle["circle-stroke-opacity"])}),layout:tc},Mn=typeof Float32Array<"u"?Float32Array:Array;function Mr(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Hu(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],R=l[6],P=l[7],N=l[8],V=l[9],H=l[10],X=l[11],Y=l[12],ce=l[13],le=l[14],pe=l[15],fe=u[0],Te=u[1],Se=u[2],Oe=u[3];return s[0]=fe*m+Te*S+Se*N+Oe*Y,s[1]=fe*y+Te*k+Se*V+Oe*ce,s[2]=fe*b+Te*R+Se*H+Oe*le,s[3]=fe*E+Te*P+Se*X+Oe*pe,s[4]=(fe=u[4])*m+(Te=u[5])*S+(Se=u[6])*N+(Oe=u[7])*Y,s[5]=fe*y+Te*k+Se*V+Oe*ce,s[6]=fe*b+Te*R+Se*H+Oe*le,s[7]=fe*E+Te*P+Se*X+Oe*pe,s[8]=(fe=u[8])*m+(Te=u[9])*S+(Se=u[10])*N+(Oe=u[11])*Y,s[9]=fe*y+Te*k+Se*V+Oe*ce,s[10]=fe*b+Te*R+Se*H+Oe*le,s[11]=fe*E+Te*P+Se*X+Oe*pe,s[12]=(fe=u[12])*m+(Te=u[13])*S+(Se=u[14])*N+(Oe=u[15])*Y,s[13]=fe*y+Te*k+Se*V+Oe*ce,s[14]=fe*b+Te*R+Se*H+Oe*le,s[15]=fe*E+Te*P+Se*X+Oe*pe,s}Math.hypot||(Math.hypot=function(){for(var s=arguments,l=0,u=arguments.length;u--;)l+=s[u]*s[u];return Math.sqrt(l)});var Ui,s,ul=Hu;function gf(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3];return s[0]=u[0]*m+u[4]*y+u[8]*b+u[12]*E,s[1]=u[1]*m+u[5]*y+u[9]*b+u[13]*E,s[2]=u[2]*m+u[6]*y+u[10]*b+u[14]*E,s[3]=u[3]*m+u[7]*y+u[11]*b+u[15]*E,s}Ui=new Mn(3),Mn!=Float32Array&&(Ui[0]=0,Ui[1]=0,Ui[2]=0),s=new Mn(4),Mn!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0);var jd=(function(){var s=new Mn(2);Mn!=Float32Array&&(s[0]=0,s[1]=0)}(),function(s){function l(u){s.call(this,u,Sr)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new ho(u)},l.prototype.queryRadius=function(u){var m=u;return xi("circle-radius",this,m)+xi("circle-stroke-width",this,m)+ec(this.paint.get("circle-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,R){for(var P=js(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,k),N=this.paint.get("circle-radius").evaluate(m,y)+this.paint.get("circle-stroke-width").evaluate(m,y),V="map"===this.paint.get("circle-pitch-alignment"),H=V?P:function(Ge,Qe){return Ge.map(function(pt){return Mg(pt,Qe)})}(P,R),X=V?N*k:N,Y=0,ce=b;Y<ce.length;Y+=1)for(var le=0,pe=ce[Y];le<pe.length;le+=1){var fe=pe[le],Te=V?fe:Mg(fe,R),Se=X,Oe=gf([],[fe.x,fe.y,0,1],R);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Se*=Oe[3]/S.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Se*=S.cameraToCenterDistance/Oe[3]),Lt(H,Te,Se))return!0}return!1},l}(wi));function Mg(s,l){var u=gf([],[s.x,s.y,0,1],l);return new Vt(u[0]/u[3],u[1]/u[3])}var Hd=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(ho);function Wc(s,l,u,m){var y=l.width,b=l.height;if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==y*b*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(y*b*u);return s.width=y,s.height=b,s.data=m,s}function Pg(s,l,u){var m=l.width,y=l.height;if(m!==s.width||y!==s.height){var b=Wc({},{width:m,height:y},u);jp(s,b,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,m),height:Math.min(s.height,y)},u),s.width=m,s.height=y,s.data=b.data}}function jp(s,l,u,m,y,b){if(0===y.width||0===y.height)return l;if(y.width>s.width||y.height>s.height||u.x>s.width-y.width||u.y>s.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||m.x>l.width-y.width||m.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var E=s.data,S=l.data,k=0;k<y.height;k++)for(var R=((u.y+k)*s.width+u.x)*b,P=((m.y+k)*l.width+m.x)*b,N=0;N<y.width*b;N++)S[P+N]=E[R+N];return l}nt("HeatmapBucket",Hd,{omit:["layers"]});var nc=function(s,l){Wc(this,s,1,l)};nc.prototype.resize=function(s){Pg(this,s,1)},nc.prototype.clone=function(){return new nc({width:this.width,height:this.height},new Uint8Array(this.data))},nc.copy=function(s,l,u,m,y){jp(s,l,u,m,y,1)};var ss=function(s,l){Wc(this,s,4,l)};ss.prototype.resize=function(s){Pg(this,s,4)},ss.prototype.replace=function(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s},ss.prototype.clone=function(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))},ss.copy=function(s,l,u,m,y){jp(s,l,u,m,y,4)},nt("AlphaImage",nc),nt("RGBAImage",ss);var b0={paint:new ci({"heatmap-radius":new It(W.paint_heatmap["heatmap-radius"]),"heatmap-weight":new It(W.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xe(W.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ta(W.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xe(W.paint_heatmap["heatmap-opacity"])})};function Og(s){var l={},u=s.resolution||256,m=s.clips?s.clips.length:1,y=s.image||new ss({width:u,height:m}),b=function(X,Y,ce){l[s.evaluationKey]=ce;var le=s.expression.evaluate(l);y.data[X+Y+0]=Math.floor(255*le.r/le.a),y.data[X+Y+1]=Math.floor(255*le.g/le.a),y.data[X+Y+2]=Math.floor(255*le.b/le.a),y.data[X+Y+3]=Math.floor(255*le.a)};if(s.clips)for(var E=0,S=0;E<m;++E,S+=4*u)for(var k=0,R=0;k<u;k++,R+=4){var P=k/(u-1),N=s.clips[E];b(S,R,N.start*(1-P)+N.end*P)}else for(var V=0,H=0;V<u;V++,H+=4)b(0,H,V/(u-1));return y}var w0=function(s){function l(u){s.call(this,u,b0),this._updateColorRamp()}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new Hd(u)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},l.prototype._updateColorRamp=function(){this.colorRamp=Og({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},l.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},l}(wi),x0={paint:new ci({"hillshade-illumination-direction":new Xe(W.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xe(W.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xe(W.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xe(W.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xe(W.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xe(W.paint_hillshade["hillshade-accent-color"])})},E0=function(s){function l(u){s.call(this,u,x0)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},l}(wi),C0=_n([{name:"a_pos",components:2,type:"Int16"}],4).members,Hp=to,tT=to;function to(s,l,u){u=u||2;var m,y,b,E,S,k,R,P=l&&l.length,N=P?l[0]*u:s.length,V=$u(s,0,N,u,!0),H=[];if(!V||V.next===V.prev)return H;if(P&&(V=function(Y,ce,le,pe){var fe,Te,Se,Oe=[];for(fe=0,Te=ce.length;fe<Te;fe++)(Se=$u(Y,ce[fe]*pe,fe<Te-1?ce[fe+1]*pe:Y.length,pe,!1))===Se.next&&(Se.steiner=!0),Oe.push(S0(Se));for(Oe.sort(T0),fe=0;fe<Oe.length;fe++)Ng(Oe[fe],le),le=So(le,le.next);return le}(s,l,V,u)),s.length>80*u){m=b=s[0],y=E=s[1];for(var X=u;X<N;X+=u)(S=s[X])<m&&(m=S),(k=s[X+1])<y&&(y=k),S>b&&(b=S),k>E&&(E=k);R=0!==(R=Math.max(b-m,E-y))?1/R:0}return Oa(V,H,u,m,y,R),H}function $u(s,l,u,m,y){var b,E;if(y===Yy(s,l,u,m)>0)for(b=l;b<u;b+=m)E=Bn(b,s[b],s[b+1],E);else for(b=u-m;b>=l;b-=m)E=Bn(b,s[b],s[b+1],E);return E&&qp(E,E.next)&&(qu(E),E=E.next),E}function So(s,l){if(!s)return s;l||(l=s);var u,m=s;do{if(u=!1,m.steiner||!qp(m,m.next)&&0!==tr(m.prev,m,m.next))m=m.next;else{if(qu(m),(m=l=m.prev)===m.next)break;u=!0}}while(u||m!==l);return l}function Oa(s,l,u,m,y,b,E){if(s){!E&&b&&function(P,N,V,H){var X=P;do{null===X.z&&(X.z=Lg(X.x,X.y,N,V,H)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next}while(X!==P);X.prevZ.nextZ=null,X.prevZ=null,function(Y){var ce,le,pe,fe,Te,Se,Oe,Ge,Qe=1;do{for(le=Y,Y=null,Te=null,Se=0;le;){for(Se++,pe=le,Oe=0,ce=0;ce<Qe&&(Oe++,pe=pe.nextZ);ce++);for(Ge=Qe;Oe>0||Ge>0&&pe;)0!==Oe&&(0===Ge||!pe||le.z<=pe.z)?(fe=le,le=le.nextZ,Oe--):(fe=pe,pe=pe.nextZ,Ge--),Te?Te.nextZ=fe:Y=fe,fe.prevZ=Te,Te=fe;le=pe}Te.nextZ=null,Qe*=2}while(Se>1)}(X)}(s,m,y,b);for(var S,k,R=s;s.prev!==s.next;)if(S=s.prev,k=s.next,b?D0(s,m,y,b):nT(s))l.push(S.i/u),l.push(s.i/u),l.push(k.i/u),qu(s),s=k.next,R=k.next;else if((s=k)===R){E?1===E?Oa(s=rT(So(s),l,u),l,u,m,y,b,2):2===E&&iT(s,l,u,m,y,b):Oa(So(s),l,u,m,y,b,1);break}}}function nT(s){var l=s.prev,u=s,m=s.next;if(tr(l,u,m)>=0)return!1;for(var y=s.next.next;y!==s.prev;){if(En(l.x,l.y,u.x,u.y,m.x,m.y,y.x,y.y)&&tr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function D0(s,l,u,m){var y=s.prev,b=s,E=s.next;if(tr(y,b,E)>=0)return!1;for(var S=y.x>b.x?y.x>E.x?y.x:E.x:b.x>E.x?b.x:E.x,k=y.y>b.y?y.y>E.y?y.y:E.y:b.y>E.y?b.y:E.y,R=Lg(y.x<b.x?y.x<E.x?y.x:E.x:b.x<E.x?b.x:E.x,y.y<b.y?y.y<E.y?y.y:E.y:b.y<E.y?b.y:E.y,l,u,m),P=Lg(S,k,l,u,m),N=s.prevZ,V=s.nextZ;N&&N.z>=R&&V&&V.z<=P;){if(N!==s.prev&&N!==s.next&&En(y.x,y.y,b.x,b.y,E.x,E.y,N.x,N.y)&&tr(N.prev,N,N.next)>=0||(N=N.prevZ,V!==s.prev&&V!==s.next&&En(y.x,y.y,b.x,b.y,E.x,E.y,V.x,V.y)&&tr(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;N&&N.z>=R;){if(N!==s.prev&&N!==s.next&&En(y.x,y.y,b.x,b.y,E.x,E.y,N.x,N.y)&&tr(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;V&&V.z<=P;){if(V!==s.prev&&V!==s.next&&En(y.x,y.y,b.x,b.y,E.x,E.y,V.x,V.y)&&tr(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function rT(s,l,u){var m=s;do{var y=m.prev,b=m.next.next;!qp(y,b)&&I0(y,m,m.next,b)&&Na(y,b)&&Na(b,y)&&(l.push(y.i/u),l.push(m.i/u),l.push(b.i/u),qu(m),qu(m.next),m=s=b),m=m.next}while(m!==s);return So(m)}function iT(s,l,u,m,y,b){var E=s;do{for(var S=E.next.next;S!==E.prev;){if(E.i!==S.i&&Fn(E,S)){var k=k0(E,S);return E=So(E,E.next),k=So(k,k.next),Oa(E,l,u,m,y,b),void Oa(k,l,u,m,y,b)}S=S.next}E=E.next}while(E!==s)}function T0(s,l){return s.x-l.x}function Ng(s,l){if(l=function(m,y){var b,E=y,S=m.x,k=m.y,R=-1/0;do{if(k<=E.y&&k>=E.next.y&&E.next.y!==E.y){var P=E.x+(k-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(P<=S&&P>R){if(R=P,P===S){if(k===E.y)return E;if(k===E.next.y)return E.next}b=E.x<E.next.x?E:E.next}}E=E.next}while(E!==y);if(!b)return null;if(S===R)return b;var N,V=b,H=b.x,X=b.y,Y=1/0;E=b;do{S>=E.x&&E.x>=H&&S!==E.x&&En(k<X?S:R,k,H,X,k<X?R:S,k,E.x,E.y)&&(N=Math.abs(k-E.y)/(S-E.x),Na(E,m)&&(N<Y||N===Y&&(E.x>b.x||E.x===b.x&&$p(b,E)))&&(b=E,Y=N)),E=E.next}while(E!==V);return b}(s,l)){var u=k0(l,s);So(l,l.next),So(u,u.next)}}function $p(s,l){return tr(s.prev,s,l.prev)<0&&tr(l.next,s,s.next)<0}function Lg(s,l,u,m,y){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-u)*y)|s<<8))|s<<4))|s<<2))|s<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-m)*y)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function S0(s){var l=s,u=s;do{(l.x<u.x||l.x===u.x&&l.y<u.y)&&(u=l),l=l.next}while(l!==s);return u}function En(s,l,u,m,y,b,E,S){return(y-E)*(l-S)-(s-E)*(b-S)>=0&&(s-E)*(m-S)-(u-E)*(l-S)>=0&&(u-E)*(b-S)-(y-E)*(m-S)>=0}function Fn(s,l){return s.next.i!==l.i&&s.prev.i!==l.i&&!function(u,m){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==m.i&&y.next.i!==m.i&&I0(y,y.next,u,m))return!0;y=y.next}while(y!==u);return!1}(s,l)&&(Na(s,l)&&Na(l,s)&&function(u,m){var y=u,b=!1,E=(u.x+m.x)/2,S=(u.y+m.y)/2;do{y.y>S!=y.next.y>S&&y.next.y!==y.y&&E<(y.next.x-y.x)*(S-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next}while(y!==u);return b}(s,l)&&(tr(s.prev,s,l.prev)||tr(s,l.prev,l))||qp(s,l)&&tr(s.prev,s,s.next)>0&&tr(l.prev,l,l.next)>0)}function tr(s,l,u){return(l.y-s.y)*(u.x-l.x)-(l.x-s.x)*(u.y-l.y)}function qp(s,l){return s.x===l.x&&s.y===l.y}function I0(s,l,u,m){var y=Fg(tr(s,l,u)),b=Fg(tr(s,l,m)),E=Fg(tr(u,m,s)),S=Fg(tr(u,m,l));return y!==b&&E!==S||!(0!==y||!Gp(s,u,l))||!(0!==b||!Gp(s,m,l))||!(0!==E||!Gp(u,s,m))||!(0!==S||!Gp(u,l,m))}function Gp(s,l,u){return l.x<=Math.max(s.x,u.x)&&l.x>=Math.min(s.x,u.x)&&l.y<=Math.max(s.y,u.y)&&l.y>=Math.min(s.y,u.y)}function Fg(s){return s>0?1:s<0?-1:0}function Na(s,l){return tr(s.prev,s,s.next)<0?tr(s,l,s.next)>=0&&tr(s,s.prev,l)>=0:tr(s,l,s.prev)<0||tr(s,s.next,l)<0}function k0(s,l){var u=new Bg(s.i,s.x,s.y),m=new Bg(l.i,l.x,l.y),y=s.next,b=l.prev;return s.next=l,l.prev=s,u.next=y,y.prev=u,m.next=u,u.prev=m,b.next=m,m.prev=b,m}function Bn(s,l,u,m){var y=new Bg(s,l,u);return m?(y.next=m.next,y.prev=m,m.next.prev=y,m.next=y):(y.prev=y,y.next=y),y}function qu(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Bg(s,l,u){this.i=s,this.x=l,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yy(s,l,u,m){for(var y=0,b=l,E=u-m;b<u;b+=m)y+=(s[E]-s[b])*(s[b+1]+s[E+1]),E=b;return y}function r2(s,l,u,m,y){!function b(E,S,k,R,P){for(;R>k;){if(R-k>600){var N=R-k+1,V=S-k+1,H=Math.log(N),X=.5*Math.exp(2*H/3),Y=.5*Math.sqrt(H*X*(N-X)/N)*(V-N/2<0?-1:1);b(E,S,Math.max(k,Math.floor(S-V*X/N+Y)),Math.min(R,Math.floor(S+(N-V)*X/N+Y)),P)}var ce=E[S],le=k,pe=R;for($d(E,k,S),P(E[R],ce)>0&&$d(E,k,R);le<pe;){for($d(E,le,pe),le++,pe--;P(E[le],ce)<0;)le++;for(;P(E[pe],ce)>0;)pe--}0===P(E[k],ce)?$d(E,k,pe):$d(E,++pe,R),pe<=S&&(k=pe+1),S<=pe&&(R=pe-1)}}(s,l,u||0,m||s.length-1,y||Vg)}function $d(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}function Vg(s,l){return s<l?-1:s>l?1:0}function Xy(s,l){var u=s.length;if(u<=1)return[s];for(var m,y,b=[],E=0;E<u;E++){var S=Sp(s[E]);0!==S&&(s[E].area=Math.abs(S),void 0===y&&(y=S<0),y===S<0?(m&&b.push(m),m=[s[E]]):m.push(s[E]))}if(m&&b.push(m),l>1)for(var k=0;k<b.length;k++)b[k].length<=l||(r2(b[k],l,1,b[k].length-1,Xt),b[k]=b[k].slice(0,l));return b}function Xt(s,l){return l.area-s.area}function Qy(s,l,u){for(var m=u.patternDependencies,y=!1,b=0,E=l;b<E.length;b+=1){var S=E[b].paint.get(s+"-pattern");S.isConstant()||(y=!0);var k=S.constantOr(null);k&&(y=!0,m[k.to]=!0,m[k.from]=!0)}return y}function Wp(s,l,u,m,y){for(var b=y.patternDependencies,E=0,S=l;E<S.length;E+=1){var k=S[E],R=k.paint.get(s+"-pattern").value;if("constant"!==R.kind){var P=R.evaluate({zoom:m-1},u,{},y.availableImages),N=R.evaluate({zoom:m},u,{},y.availableImages),V=R.evaluate({zoom:m+1},u,{},y.availableImages);N=N&&N.name?N.name:N,V=V&&V.name?V.name:V,b[P=P&&P.name?P.name:P]=!0,b[N]=!0,b[V]=!0,u.patterns[k.id]={min:P,mid:N,max:V}}}return u}to.deviation=function(s,l,u,m){var y=l&&l.length,b=Math.abs(Yy(s,0,y?l[0]*u:s.length,u));if(y)for(var E=0,S=l.length;E<S;E++)b-=Math.abs(Yy(s,l[E]*u,E<S-1?l[E+1]*u:s.length,u));var k=0;for(E=0;E<m.length;E+=3){var R=m[E]*u,P=m[E+1]*u,N=m[E+2]*u;k+=Math.abs((s[R]-s[N])*(s[P+1]-s[R+1])-(s[R]-s[P])*(s[N+1]-s[R+1]))}return 0===b&&0===k?0:Math.abs((k-b)/b)},to.flatten=function(s){for(var l=s[0][0].length,u={vertices:[],holes:[],dimensions:l},m=0,y=0;y<s.length;y++){for(var b=0;b<s[y].length;b++)for(var E=0;E<l;E++)u.vertices.push(s[y][b][E]);y>0&&u.holes.push(m+=s[y-1].length)}return u},Hp.default=tT;var dl=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zu,this.indexArray=new zs,this.indexArray2=new mf,this.programConfigurations=new Jn(s.layers,s.zoom),this.segments=new j,this.segments2=new j,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};dl.prototype.populate=function(s,l,u){this.hasPattern=Qy("fill",this.layers,l);for(var m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],R=k.feature,P=k.id,N=k.index,V=k.sourceLayerIndex,H=this.layers[0]._featureFilter.needGeometry,X=To(R,H);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),X,u)){var Y=y?m.evaluate(X,{},u,l.availableImages):void 0,ce={id:P,properties:R.properties,type:R.type,sourceLayerIndex:V,index:N,geometry:H?X.geometry:Wr(R),patterns:{},sortKey:Y};b.push(ce)}}y&&b.sort(function(Qe,pt){return Qe.sortKey-pt.sortKey});for(var le=0,pe=b;le<pe.length;le+=1){var fe=pe[le],Te=fe.geometry,Se=fe.index,Oe=fe.sourceLayerIndex;if(this.hasPattern){var Ge=Wp("fill",this.layers,fe,this.zoom,l);this.patternFeatures.push(Ge)}else this.addFeature(fe,Te,Se,u,{});l.featureIndex.insert(s[Se].feature,Te,Se,Oe,this.index)}},dl.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},dl.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},dl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},dl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},dl.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,C0),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0},dl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},dl.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=Xy(l,500);b<E.length;b+=1){for(var S=E[b],k=0,R=0,P=S;R<P.length;R+=1)k+=P[R].length;for(var N=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),V=N.vertexLength,H=[],X=[],Y=0,ce=S;Y<ce.length;Y+=1){var le=ce[Y];if(0!==le.length){le!==S[0]&&X.push(H.length/2);var pe=this.segments2.prepareSegment(le.length,this.layoutVertexArray,this.indexArray2),fe=pe.vertexLength;this.layoutVertexArray.emplaceBack(le[0].x,le[0].y),this.indexArray2.emplaceBack(fe+le.length-1,fe),H.push(le[0].x),H.push(le[0].y);for(var Te=1;Te<le.length;Te++)this.layoutVertexArray.emplaceBack(le[Te].x,le[Te].y),this.indexArray2.emplaceBack(fe+Te-1,fe+Te),H.push(le[Te].x),H.push(le[Te].y);pe.vertexLength+=le.length,pe.primitiveLength+=le.length}}for(var Se=Hp(H,X),Oe=0;Oe<Se.length;Oe+=3)this.indexArray.emplaceBack(V+Se[Oe],V+Se[Oe+1],V+Se[Oe+2]);N.vertexLength+=k,N.primitiveLength+=Se.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},nt("FillBucket",dl,{omit:["layers","patternFeatures"]});var oT=new ci({"fill-sort-key":new It(W.layout_fill["fill-sort-key"])}),Jy={paint:new ci({"fill-antialias":new Xe(W.paint_fill["fill-antialias"]),"fill-opacity":new It(W.paint_fill["fill-opacity"]),"fill-color":new It(W.paint_fill["fill-color"]),"fill-outline-color":new It(W.paint_fill["fill-outline-color"]),"fill-translate":new Xe(W.paint_fill["fill-translate"]),"fill-translate-anchor":new Xe(W.paint_fill["fill-translate-anchor"]),"fill-pattern":new li(W.paint_fill["fill-pattern"])}),layout:oT},A0=function(s){function l(u){s.call(this,u,Jy)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m);var y=this.paint._values["fill-outline-color"];"constant"===y.value.kind&&void 0===y.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},l.prototype.createBucket=function(u){return new dl(u)},l.prototype.queryRadius=function(){return ec(this.paint.get("fill-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){return yn(js(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,k),b)},l.prototype.isTileClipped=function(){return!0},l}(wi),R0=_n([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,M0=_f;function _f(s,l,u,m,y){this.properties={},this.extent=u,this.type=0,this._pbf=s,this._geometry=-1,this._keys=m,this._values=y,s.readFields(sT,this,l)}function sT(s,l,u){1==s?l.id=u.readVarint():2==s?function(m,y){for(var b=m.readVarint()+m.pos;m.pos<b;){var E=y._keys[m.readVarint()],S=y._values[m.readVarint()];y.properties[E]=S}}(u,l):3==s?l.type=u.readVarint():4==s&&(l._geometry=u.pos)}function P0(s){for(var l,u,m=0,y=0,b=s.length,E=b-1;y<b;E=y++)m+=((u=s[E]).x-(l=s[y]).x)*(l.y+u.y);return m}_f.types=["Unknown","Point","LineString","Polygon"],_f.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var l,u=s.readVarint()+s.pos,m=1,y=0,b=0,E=0,S=[];s.pos<u;){if(y<=0){var k=s.readVarint();m=7&k,y=k>>3}if(y--,1===m||2===m)b+=s.readSVarint(),E+=s.readSVarint(),1===m&&(l&&S.push(l),l=[]),l.push(new Vt(b,E));else{if(7!==m)throw new Error("unknown command "+m);l&&l.push(l[0].clone())}}return l&&S.push(l),S},_f.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var l=s.readVarint()+s.pos,u=1,m=0,y=0,b=0,E=1/0,S=-1/0,k=1/0,R=-1/0;s.pos<l;){if(m<=0){var P=s.readVarint();u=7&P,m=P>>3}if(m--,1===u||2===u)(y+=s.readSVarint())<E&&(E=y),y>S&&(S=y),(b+=s.readSVarint())<k&&(k=b),b>R&&(R=b);else if(7!==u)throw new Error("unknown command "+u)}return[E,k,S,R]},_f.prototype.toGeoJSON=function(s,l,u){var m,y,b=this.extent*Math.pow(2,u),E=this.extent*s,S=this.extent*l,k=this.loadGeometry(),R=_f.types[this.type];function P(H){for(var X=0;X<H.length;X++){var Y=H[X];H[X]=[360*(Y.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Y.y+S)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(m=0;m<k.length;m++)N[m]=k[m][0];P(k=N);break;case 2:for(m=0;m<k.length;m++)P(k[m]);break;case 3:for(k=function(H){var X=H.length;if(X<=1)return[H];for(var Y,ce,le=[],pe=0;pe<X;pe++){var fe=P0(H[pe]);0!==fe&&(void 0===ce&&(ce=fe<0),ce===fe<0?(Y&&le.push(Y),Y=[H[pe]]):Y.push(H[pe]))}return Y&&le.push(Y),le}(k),m=0;m<k.length;m++)for(y=0;y<k[m].length;y++)P(k[m][y])}1===k.length?k=k[0]:R="Multi"+R;var V={type:"Feature",geometry:{type:R,coordinates:k},properties:this.properties};return"id"in this&&(V.id=this.id),V};var yf=hl;function hl(s,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(O0,this,l),this.length=this._features.length}function O0(s,l,u){15===s?l.version=u.readVarint():1===s?l.name=u.readString():5===s?l.extent=u.readVarint():2===s?l._features.push(u.pos):3===s?l._keys.push(u.readString()):4===s&&l._values.push(function(m){for(var y=null,b=m.readVarint()+m.pos;m.pos<b;){var E=m.readVarint()>>3;y=1===E?m.readString():2===E?m.readFloat():3===E?m.readDouble():4===E?m.readVarint64():5===E?m.readVarint():6===E?m.readSVarint():7===E?m.readBoolean():null}return y}(u))}function aT(s,l,u){if(3===s){var m=new yf(u,u.readVarint()+u.pos);m.length&&(l[m.name]=m)}}hl.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var l=this._pbf.readVarint()+this._pbf.pos;return new M0(this._pbf,l,this.extent,this._keys,this._values)};var Zp={VectorTile:function(s,l){this.layers=s.readFields(aT,{},l)},VectorTileFeature:M0,VectorTileLayer:yf},i2=Zp.VectorTileFeature.types,as=Math.pow(2,13);function qd(s,l,u,m,y,b,E,S){s.emplaceBack(l,u,2*Math.floor(m*as)+E,y*as*2,b*as*2,Math.round(S))}var rc=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new zi,this.indexArray=new zs,this.programConfigurations=new Jn(s.layers,s.zoom),this.segments=new j,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function ev(s,l){return s.x===l.x&&(s.x<0||s.x>8192)||s.y===l.y&&(s.y<0||s.y>8192)}rc.prototype.populate=function(s,l,u){this.features=[],this.hasPattern=Qy("fill-extrusion",this.layers,l);for(var m=0,y=s;m<y.length;m+=1){var b=y[m],E=b.feature,S=b.id,k=b.index,R=b.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,N=To(E,P);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),N,u)){var V={id:S,sourceLayerIndex:R,index:k,geometry:P?N.geometry:Wr(E),properties:E.properties,type:E.type,patterns:{}};this.hasPattern?this.features.push(Wp("fill-extrusion",this.layers,V,this.zoom,l)):this.addFeature(V,V.geometry,k,u,{}),l.featureIndex.insert(E,V.geometry,k,R,this.index,!0)}}},rc.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.features;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},rc.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},rc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rc.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,R0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},rc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rc.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=Xy(l,500);b<E.length;b+=1){for(var S=E[b],k=0,R=0,P=S;R<P.length;R+=1)k+=P[R].length;for(var N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),V=0,H=S;V<H.length;V+=1){var X=H[V];if(0!==X.length&&!((un=X).every(function(Yt){return Yt.x<0})||un.every(function(Yt){return Yt.x>8192})||un.every(function(Yt){return Yt.y<0})||un.every(function(Yt){return Yt.y>8192})))for(var Y=0,ce=0;ce<X.length;ce++){var le=X[ce];if(ce>=1){var pe=X[ce-1];if(!ev(le,pe)){N.vertexLength+4>j.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var fe=le.sub(pe)._perp()._unit(),Te=pe.dist(le);Y+Te>32768&&(Y=0),qd(this.layoutVertexArray,le.x,le.y,fe.x,fe.y,0,0,Y),qd(this.layoutVertexArray,le.x,le.y,fe.x,fe.y,0,1,Y),qd(this.layoutVertexArray,pe.x,pe.y,fe.x,fe.y,0,0,Y+=Te),qd(this.layoutVertexArray,pe.x,pe.y,fe.x,fe.y,0,1,Y);var Se=N.vertexLength;this.indexArray.emplaceBack(Se,Se+2,Se+1),this.indexArray.emplaceBack(Se+1,Se+2,Se+3),N.vertexLength+=4,N.primitiveLength+=2}}}}if(N.vertexLength+k>j.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),"Polygon"===i2[s.type]){for(var Oe=[],Ge=[],Qe=N.vertexLength,pt=0,et=S;pt<et.length;pt+=1){var wt=et[pt];if(0!==wt.length){wt!==S[0]&&Ge.push(Oe.length/2);for(var tt=0;tt<wt.length;tt++){var sn=wt[tt];qd(this.layoutVertexArray,sn.x,sn.y,0,0,1,1,0),Oe.push(sn.x),Oe.push(sn.y)}}}for(var Mt=Hp(Oe,Ge),ht=0;ht<Mt.length;ht+=3)this.indexArray.emplaceBack(Qe+Mt[ht],Qe+Mt[ht+2],Qe+Mt[ht+1]);N.primitiveLength+=Mt.length/3,N.vertexLength+=k}}var un;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},nt("FillExtrusionBucket",rc,{omit:["layers","features"]});var lT={paint:new ci({"fill-extrusion-opacity":new Xe(W["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new It(W["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xe(W["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xe(W["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new li(W["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new It(W["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new It(W["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xe(W["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},vf=function(s){function l(u){s.call(this,u,lT)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new rc(u)},l.prototype.queryRadius=function(){return ec(this.paint.get("fill-extrusion-translate"))},l.prototype.is3D=function(){return!0},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,R){var P=js(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,k),N=this.paint.get("fill-extrusion-height").evaluate(m,y),V=this.paint.get("fill-extrusion-base").evaluate(m,y),H=function(Y,ce){for(var fe=[],Te=0,Se=Y;Te<Se.length;Te+=1){var Oe=Se[Te],Ge=[Oe.x,Oe.y,0,1];gf(Ge,Ge,ce),fe.push(new Vt(Ge[0]/Ge[3],Ge[1]/Ge[3]))}return fe}(P,R),X=function(Y,ce,le,pe){for(var fe=[],Te=[],Se=pe[8]*ce,Oe=pe[9]*ce,Ge=pe[10]*ce,Qe=pe[11]*ce,pt=pe[8]*le,et=pe[9]*le,wt=pe[10]*le,tt=pe[11]*le,sn=0,Mt=Y;sn<Mt.length;sn+=1){for(var ht=[],un=[],Yt=0,vn=Mt[sn];Yt<vn.length;Yt+=1){var xt=vn[Yt],Cn=xt.x,gr=xt.y,Or=pe[0]*Cn+pe[4]*gr+pe[12],Ir=pe[1]*Cn+pe[5]*gr+pe[13],_r=pe[2]*Cn+pe[6]*gr+pe[14],zr=pe[3]*Cn+pe[7]*gr+pe[15],Ei=_r+Ge,Ci=zr+Qe,Ao=Or+pt,Hi=Ir+et,Ro=_r+wt,Kr=zr+tt,Di=new Vt((Or+Se)/Ci,(Ir+Oe)/Ci);Di.z=Ei/Ci,ht.push(Di);var fn=new Vt(Ao/Kr,Hi/Kr);fn.z=Ro/Kr,un.push(fn)}fe.push(ht),Te.push(un)}return[fe,Te]}(b,V,N,R);return function(Y,ce,le){var pe=1/0;yn(le,ce)&&(pe=cT(le,ce[0]));for(var fe=0;fe<ce.length;fe++)for(var Te=ce[fe],Se=Y[fe],Oe=0;Oe<Te.length-1;Oe++){var Ge=Te[Oe],Qe=[Ge,Te[Oe+1],Se[Oe+1],Se[Oe],Ge];Ae(le,Qe)&&(pe=Math.min(pe,cT(le,Qe)))}return pe!==1/0&&pe}(X[0],X[1],H)},l}(wi);function Gu(s,l){return s.x*l.x+s.y*l.y}function cT(s,l){if(1===s.length){for(var u,m=0,y=l[m++];!u||y.equals(u);)if(!(u=l[m++]))return 1/0;for(;m<l.length;m++){var b=l[m],E=s[0],S=u.sub(y),k=b.sub(y),R=E.sub(y),P=Gu(S,S),N=Gu(S,k),V=Gu(k,k),H=Gu(R,S),X=Gu(R,k),Y=P*V-N*N,ce=(V*H-N*X)/Y,le=(P*X-N*H)/Y,pe=y.z*(1-ce-le)+u.z*ce+b.z*le;if(isFinite(pe))return pe}return 1/0}for(var fe=1/0,Te=0,Se=l;Te<Se.length;Te+=1)fe=Math.min(fe,Se[Te].z);return fe}var N0=_n([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,tv=_n([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,L0=Zp.VectorTileFeature.types,uT=Math.cos(Math.PI/180*37.5),zg=Math.pow(2,14)/.5,$o=function(s){var l=this;this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){l.gradients[u.id]={}}),this.layoutVertexArray=new is,this.layoutVertexArray2=new os,this.indexArray=new zs,this.programConfigurations=new Jn(s.layers,s.zoom),this.segments=new j,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};$o.prototype.populate=function(s,l,u){this.hasPattern=Qy("line",this.layers,l);for(var m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],R=k.feature,P=k.id,N=k.index,V=k.sourceLayerIndex,H=this.layers[0]._featureFilter.needGeometry,X=To(R,H);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),X,u)){var Y=y?m.evaluate(X,{},u):void 0,ce={id:P,properties:R.properties,type:R.type,sourceLayerIndex:V,index:N,geometry:H?X.geometry:Wr(R),patterns:{},sortKey:Y};b.push(ce)}}y&&b.sort(function(Qe,pt){return Qe.sortKey-pt.sortKey});for(var le=0,pe=b;le<pe.length;le+=1){var fe=pe[le],Te=fe.geometry,Se=fe.index,Oe=fe.sourceLayerIndex;if(this.hasPattern){var Ge=Wp("line",this.layers,fe,this.zoom,l);this.patternFeatures.push(Ge)}else this.addFeature(fe,Te,Se,u,{});l.featureIndex.insert(s[Se].feature,Te,Se,Oe,this.index)}},$o.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},$o.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},$o.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},$o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$o.prototype.upload=function(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,tv)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,N0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},$o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},$o.prototype.lineFeatureClips=function(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}},$o.prototype.addFeature=function(s,l,u,m,y){var b=this.layers[0].layout,E=b.get("line-join").evaluate(s,{}),S=b.get("line-cap"),k=b.get("line-miter-limit"),R=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(var P=0,N=l;P<N.length;P+=1)this.addLine(N[P],s,E,S,k,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},$o.prototype.addLine=function(s,l,u,m,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var E=0;E<s.length-1;E++)this.totalDistance+=s[E].dist(s[E+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S="Polygon"===L0[l.type],k=s.length;k>=2&&s[k-1].equals(s[k-2]);)k--;for(var R=0;R<k-1&&s[R].equals(s[R+1]);)R++;if(!(k<(S?3:2))){"bevel"===u&&(y=1.05);var P,N=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray),H=void 0,X=void 0,Y=void 0,ce=void 0;this.e1=this.e2=-1,S&&(ce=s[R].sub(P=s[k-2])._unit()._perp());for(var le=R;le<k;le++)if(!(X=le===k-1?S?s[R+1]:void 0:s[le+1])||!s[le].equals(X)){ce&&(Y=ce),P&&(H=P),P=s[le],ce=X?X.sub(P)._unit()._perp():Y;var pe=(Y=Y||ce).add(ce);0===pe.x&&0===pe.y||pe._unit();var fe=Y.x*ce.x+Y.y*ce.y,Te=pe.x*ce.x+pe.y*ce.y,Se=0!==Te?1/Te:1/0,Oe=2*Math.sqrt(2-2*Te),Ge=Te<uT&&H&&X,Qe=Y.x*ce.y-Y.y*ce.x>0;if(Ge&&le>R){var pt=P.dist(H);if(pt>2*N){var et=P.sub(P.sub(H)._mult(N/pt)._round());this.updateDistance(H,et),this.addCurrentVertex(et,Y,0,0,V),H=et}}var wt=H&&X,tt=wt?u:S?"butt":m;if(wt&&"round"===tt&&(Se<b?tt="miter":Se<=2&&(tt="fakeround")),"miter"===tt&&Se>y&&(tt="bevel"),"bevel"===tt&&(Se>2&&(tt="flipbevel"),Se<y&&(tt="miter")),H&&this.updateDistance(H,P),"miter"===tt)pe._mult(Se),this.addCurrentVertex(P,pe,0,0,V);else if("flipbevel"===tt){if(Se>100)pe=ce.mult(-1);else{var sn=Se*Y.add(ce).mag()/Y.sub(ce).mag();pe._perp()._mult(sn*(Qe?-1:1))}this.addCurrentVertex(P,pe,0,0,V),this.addCurrentVertex(P,pe.mult(-1),0,0,V)}else if("bevel"===tt||"fakeround"===tt){var Mt=-Math.sqrt(Se*Se-1),ht=Qe?Mt:0,un=Qe?0:Mt;if(H&&this.addCurrentVertex(P,Y,ht,un,V),"fakeround"===tt)for(var Yt=Math.round(180*Oe/Math.PI/20),vn=1;vn<Yt;vn++){var xt=vn/Yt;if(.5!==xt){var Cn=xt-.5;xt+=xt*Cn*(xt-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*Cn*Cn+(.848013+fe*(.215638*fe-1.06021)))}var gr=ce.sub(Y)._mult(xt)._add(Y)._unit()._mult(Qe?-1:1);this.addHalfVertex(P,gr.x,gr.y,!1,Qe,0,V)}X&&this.addCurrentVertex(P,ce,-ht,-un,V)}else if("butt"===tt)this.addCurrentVertex(P,pe,0,0,V);else if("square"===tt){var Or=H?1:-1;this.addCurrentVertex(P,pe,Or,Or,V)}else"round"===tt&&(H&&(this.addCurrentVertex(P,Y,0,0,V),this.addCurrentVertex(P,Y,1,1,V,!0)),X&&(this.addCurrentVertex(P,ce,-1,-1,V,!0),this.addCurrentVertex(P,ce,0,0,V)));if(Ge&&le<k-1){var Ir=P.dist(X);if(Ir>2*N){var _r=P.add(X.sub(P)._mult(N/Ir)._round());this.updateDistance(P,_r),this.addCurrentVertex(_r,ce,0,0,V),P=_r}}}}},$o.prototype.addCurrentVertex=function(s,l,u,m,y,b){void 0===b&&(b=!1);var E=l.y*m-l.x,S=-l.y-l.x*m;this.addHalfVertex(s,l.x+l.y*u,l.y-l.x*u,b,!1,u,y),this.addHalfVertex(s,E,S,b,!0,-m,y),this.distance>zg/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(s,l,u,m,y,b))},$o.prototype.addHalfVertex=function(s,l,u,m,y,b,E){var S=.5*(this.lineClips?this.scaledDistance*(zg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s.x<<1)+(m?1:0),(s.y<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(0===b?0:b<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var k=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),E.primitiveLength++),y?this.e2=k:this.e1=k},$o.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},$o.prototype.updateDistance=function(s,l){this.distance+=s.dist(l),this.updateScaledDistance()},nt("LineBucket",$o,{omit:["layers","patternFeatures"]});var F0=new ci({"line-cap":new Xe(W.layout_line["line-cap"]),"line-join":new It(W.layout_line["line-join"]),"line-miter-limit":new Xe(W.layout_line["line-miter-limit"]),"line-round-limit":new Xe(W.layout_line["line-round-limit"]),"line-sort-key":new It(W.layout_line["line-sort-key"])}),B0={paint:new ci({"line-opacity":new It(W.paint_line["line-opacity"]),"line-color":new It(W.paint_line["line-color"]),"line-translate":new Xe(W.paint_line["line-translate"]),"line-translate-anchor":new Xe(W.paint_line["line-translate-anchor"]),"line-width":new It(W.paint_line["line-width"]),"line-gap-width":new It(W.paint_line["line-gap-width"]),"line-offset":new It(W.paint_line["line-offset"]),"line-blur":new It(W.paint_line["line-blur"]),"line-dasharray":new kt(W.paint_line["line-dasharray"]),"line-pattern":new li(W.paint_line["line-pattern"]),"line-gradient":new ta(W.paint_line["line-gradient"])}),layout:F0},V0=new(function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m){return m=new Ut(Math.floor(m.zoom),{now:m.now,fadeDuration:m.fadeDuration,zoomHistory:m.zoomHistory,transition:m.transition}),s.prototype.possiblyEvaluate.call(this,u,m)},l.prototype.evaluate=function(u,m,y,b){return m=ki({},m,{zoom:Math.floor(m.zoom)}),s.prototype.evaluate.call(this,u,m,y,b)},l}(It))(B0.paint.properties["line-width"].specification);V0.useIntegerZoom=!0;var dT=function(s){function l(u){s.call(this,u,B0),this.gradientVersion=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ca,this.gradientVersion=(this.gradientVersion+1)%Pl)},l.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m),this.paint._values["line-floorwidth"]=V0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},l.prototype.createBucket=function(u){return new $o(u)},l.prototype.queryRadius=function(u){var m=u,y=z0(xi("line-width",this,m),xi("line-gap-width",this,m)),b=xi("line-offset",this,m);return y/2+Math.abs(b)+ec(this.paint.get("line-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){var R=js(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,k),P=k/2*z0(this.paint.get("line-width").evaluate(m,y),this.paint.get("line-gap-width").evaluate(m,y)),N=this.paint.get("line-offset").evaluate(m,y);return N&&(b=function(V,H){for(var X=[],Y=new Vt(0,0),ce=0;ce<V.length;ce++){for(var le=V[ce],pe=[],fe=0;fe<le.length;fe++){var Te=le[fe],Se=le[fe+1],Oe=0===fe?Y:Te.sub(le[fe-1])._unit()._perp(),Ge=fe===le.length-1?Y:Se.sub(Te)._unit()._perp(),Qe=Oe._add(Ge)._unit();Qe._mult(1/(Qe.x*Ge.x+Qe.y*Ge.y)),pe.push(Qe._mult(H)._add(Te))}X.push(pe)}return X}(b,N*k)),function(V,H,X){for(var Y=0;Y<H.length;Y++){var ce=H[Y];if(V.length>=3)for(var le=0;le<ce.length;le++)if(ra(V,ce[le]))return!0;if(er(V,ce,X))return!0}return!1}(R,b,P)},l.prototype.isTileClipped=function(){return!0},l}(wi);function z0(s,l){return l>0?l+2*s:s}var U0=_n([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mr=_n([{name:"a_projected_pos",components:3,type:"Float32"}],4),j0=(_n([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),_n([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),_e=(_n([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),_n([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),hT=_n([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Io(s,l,u){return s.sections.forEach(function(m){var y,E,S;m.text=(y=m.text,E=u,"uppercase"===(S=l.layout.get("text-transform").evaluate(E,{}))?y=y.toLocaleUpperCase():"lowercase"===S&&(y=y.toLocaleLowerCase()),Qn.applyArabicShaping&&(y=Qn.applyArabicShaping(y)),y)}),s}_n([{name:"triangle",components:3,type:"Uint16"}]),_n([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),_n([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_n([{type:"Float32",name:"offsetX"}]),_n([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ei={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},ar=function(s,l,u,m,y){var b,E,S=8*y-m-1,k=(1<<S)-1,R=k>>1,P=-7,N=u?y-1:0,V=u?-1:1,H=s[l+N];for(N+=V,b=H&(1<<-P)-1,H>>=-P,P+=S;P>0;b=256*b+s[l+N],N+=V,P-=8);for(E=b&(1<<-P)-1,b>>=-P,P+=m;P>0;E=256*E+s[l+N],N+=V,P-=8);if(0===b)b=1-R;else{if(b===k)return E?NaN:1/0*(H?-1:1);E+=Math.pow(2,m),b-=R}return(H?-1:1)*E*Math.pow(2,b-m)},ic=function(s,l,u,m,y,b){var E,S,k,R=8*b-y-1,P=(1<<R)-1,N=P>>1,V=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,H=m?0:b-1,X=m?1:-1,Y=l<0||0===l&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(S=isNaN(l)?1:0,E=P):(E=Math.floor(Math.log(l)/Math.LN2),l*(k=Math.pow(2,-E))<1&&(E--,k*=2),(l+=E+N>=1?V/k:V*Math.pow(2,1-N))*k>=2&&(E++,k/=2),E+N>=P?(S=0,E=P):E+N>=1?(S=(l*k-1)*Math.pow(2,y),E+=N):(S=l*Math.pow(2,N-1)*Math.pow(2,y),E=0));y>=8;s[u+H]=255&S,H+=X,S/=256,y-=8);for(E=E<<y|S,R+=y;R>0;s[u+H]=255&E,H+=X,E/=256,R-=8);s[u+H-X]|=128*Y},Zc=Vn;function Vn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Vn.Varint=0,Vn.Fixed64=1,Vn.Bytes=2,Vn.Fixed32=5;var Gd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oc(s){return s.type===Vn.Bytes?s.readVarint()+s.pos:s.pos+1}function Wd(s,l,u){var m=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));u.realloc(m);for(var y=u.pos-1;y>=s;y--)u.buf[y+m]=u.buf[y]}function o2(s,l){for(var u=0;u<s.length;u++)l.writeVarint(s[u])}function fT(s,l){for(var u=0;u<s.length;u++)l.writeSVarint(s[u])}function pT(s,l){for(var u=0;u<s.length;u++)l.writeFloat(s[u])}function mT(s,l){for(var u=0;u<s.length;u++)l.writeDouble(s[u])}function gT(s,l){for(var u=0;u<s.length;u++)l.writeBoolean(s[u])}function _T(s,l){for(var u=0;u<s.length;u++)l.writeFixed32(s[u])}function La(s,l){for(var u=0;u<s.length;u++)l.writeSFixed32(s[u])}function H0(s,l){for(var u=0;u<s.length;u++)l.writeFixed64(s[u])}function yT(s,l){for(var u=0;u<s.length;u++)l.writeSFixed64(s[u])}function Zu(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+16777216*s[l+3]}function bf(s,l,u){s[u]=l,s[u+1]=l>>>8,s[u+2]=l>>>16,s[u+3]=l>>>24}function $0(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+(s[l+3]<<24)}function vT(s,l,u){1===s&&u.readMessage(bT,l)}function bT(s,l,u){if(3===s){var m=u.readMessage(wT,{}),y=m.width,b=m.height,E=m.left,S=m.top,k=m.advance;l.push({id:m.id,bitmap:new nc({width:y+6,height:b+6},m.bitmap),metrics:{width:y,height:b,left:E,top:S,advance:k}})}}function wT(s,l,u){1===s?l.id=u.readVarint():2===s?l.bitmap=u.readBytes():3===s?l.width=u.readVarint():4===s?l.height=u.readVarint():5===s?l.left=u.readSVarint():6===s?l.top=u.readSVarint():7===s&&(l.advance=u.readVarint())}function q0(s){for(var l=0,u=0,m=0,y=s;m<y.length;m+=1){var b=y[m];l+=b.w*b.h,u=Math.max(u,b.w)}s.sort(function(Y,ce){return ce.h-Y.h});for(var E=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),u),h:1/0}],S=0,k=0,R=0,P=s;R<P.length;R+=1)for(var N=P[R],V=E.length-1;V>=0;V--){var H=E[V];if(!(N.w>H.w||N.h>H.h)){if(N.x=H.x,N.y=H.y,k=Math.max(k,N.y+N.h),S=Math.max(S,N.x+N.w),N.w===H.w&&N.h===H.h){var X=E.pop();V<E.length&&(E[V]=X)}else N.h===H.h?(H.x+=N.w,H.w-=N.w):N.w===H.w?(H.y+=N.h,H.h-=N.h):(E.push({x:H.x+N.w,y:H.y,w:H.w-N.w,h:N.h}),H.y+=N.h,H.h-=N.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}Vn.prototype={destroy:function(){this.buf=null},readFields:function(s,l,u){for(u=u||this.length;this.pos<u;){var m=this.readVarint(),y=m>>3,b=this.pos;this.type=7&m,s(y,l,this),this.pos===b&&this.skip(m)}return l},readMessage:function(s,l){return this.readFields(s,l,this.readVarint()+this.pos)},readFixed32:function(){var s=Zu(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=$0(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Zu(this.buf,this.pos)+4294967296*Zu(this.buf,this.pos+4);return this.pos+=8,s},readSFixed64:function(){var s=Zu(this.buf,this.pos)+4294967296*$0(this.buf,this.pos+4);return this.pos+=8,s},readFloat:function(){var s=ar(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=ar(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var l,u,m=this.buf;return l=127&(u=m[this.pos++]),u<128?l:(l|=(127&(u=m[this.pos++]))<<7,u<128?l:(l|=(127&(u=m[this.pos++]))<<14,u<128?l:(l|=(127&(u=m[this.pos++]))<<21,u<128?l:function(y,b,E){var S,k,R=E.buf;if(S=(112&(k=R[E.pos++]))>>4,k<128||(S|=(127&(k=R[E.pos++]))<<3,k<128)||(S|=(127&(k=R[E.pos++]))<<10,k<128)||(S|=(127&(k=R[E.pos++]))<<17,k<128)||(S|=(127&(k=R[E.pos++]))<<24,k<128)||(S|=(1&(k=R[E.pos++]))<<31,k<128))return function Wu(s,l,u){return u?4294967296*l+(s>>>0):4294967296*(l>>>0)+(s>>>0)}(y,S,b);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(u=m[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,l=this.pos;return this.pos=s,s-l>=12&&Gd?Gd.decode(this.buf.subarray(l,s)):function(u,m,y){for(var b="",E=m;E<y;){var S,k,R,P=u[E],N=null,V=P>239?4:P>223?3:P>191?2:1;if(E+V>y)break;1===V?P<128&&(N=P):2===V?128==(192&(S=u[E+1]))&&(N=(31&P)<<6|63&S)<=127&&(N=null):3===V?(k=u[E+2],128==(192&(S=u[E+1]))&&128==(192&k)&&((N=(15&P)<<12|(63&S)<<6|63&k)<=2047||N>=55296&&N<=57343)&&(N=null)):4===V&&(k=u[E+2],R=u[E+3],128==(192&(S=u[E+1]))&&128==(192&k)&&128==(192&R)&&((N=(15&P)<<18|(63&S)<<12|(63&k)<<6|63&R)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,V=1):N>65535&&(N-=65536,b+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),b+=String.fromCharCode(N),E+=V}return b}(this.buf,l,s)},readBytes:function(){var s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l},readPackedVarint:function(s,l){if(this.type!==Vn.Bytes)return s.push(this.readVarint(l));var u=oc(this);for(s=s||[];this.pos<u;)s.push(this.readVarint(l));return s},readPackedSVarint:function(s){if(this.type!==Vn.Bytes)return s.push(this.readSVarint());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Vn.Bytes)return s.push(this.readBoolean());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Vn.Bytes)return s.push(this.readFloat());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Vn.Bytes)return s.push(this.readDouble());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Vn.Bytes)return s.push(this.readFixed32());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Vn.Bytes)return s.push(this.readSFixed32());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Vn.Bytes)return s.push(this.readFixed64());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Vn.Bytes)return s.push(this.readSFixed64());var l=oc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed64());return s},skip:function(s){var l=7&s;if(l===Vn.Varint)for(;this.buf[this.pos++]>127;);else if(l===Vn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Vn.Fixed32)this.pos+=4;else{if(l!==Vn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(s,l){this.writeVarint(s<<3|l)},realloc:function(s){for(var l=this.length||16;l<this.pos+s;)l*=2;if(l!==this.length){var u=new Uint8Array(l);u.set(this.buf),this.buf=u,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),bf(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),bf(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),bf(this.buf,-1&s,this.pos),bf(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),bf(this.buf,-1&s,this.pos),bf(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(l,u){var m,y,b,S;if(l>=0?(m=l%4294967296|0,y=l/4294967296|0):(y=~(-l/4294967296),4294967295^(m=~(-l%4294967296))?m=m+1|0:(m=0,y=y+1|0)),l>=0x10000000000000000||l<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),b=m,(S=u).buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,S.buf[S.pos]=127&(b>>>=7),function(b,E){var S=(7&b)<<4;E.buf[E.pos++]|=S|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(y,u)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var l=this.pos;this.pos=function(m,y,b){for(var E,S,k=0;k<y.length;k++){if((E=y.charCodeAt(k))>55295&&E<57344){if(!S){E>56319||k+1===y.length?(m[b++]=239,m[b++]=191,m[b++]=189):S=E;continue}if(E<56320){m[b++]=239,m[b++]=191,m[b++]=189,S=E;continue}E=S-55296<<10|E-56320|65536,S=null}else S&&(m[b++]=239,m[b++]=191,m[b++]=189,S=null);E<128?m[b++]=E:(E<2048?m[b++]=E>>6|192:(E<65536?m[b++]=E>>12|224:(m[b++]=E>>18|240,m[b++]=E>>12&63|128),m[b++]=E>>6&63|128),m[b++]=63&E|128)}return b}(this.buf,s,this.pos);var u=this.pos-l;u>=128&&Wd(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeFloat:function(s){this.realloc(4),ic(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),ic(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var l=s.length;this.writeVarint(l),this.realloc(l);for(var u=0;u<l;u++)this.buf[this.pos++]=s[u]},writeRawMessage:function(s,l){this.pos++;var u=this.pos;s(l,this);var m=this.pos-u;m>=128&&Wd(u,m,this),this.pos=u-1,this.writeVarint(m),this.pos+=m},writeMessage:function(s,l,u){this.writeTag(s,Vn.Bytes),this.writeRawMessage(l,u)},writePackedVarint:function(s,l){l.length&&this.writeMessage(s,o2,l)},writePackedSVarint:function(s,l){l.length&&this.writeMessage(s,fT,l)},writePackedBoolean:function(s,l){l.length&&this.writeMessage(s,gT,l)},writePackedFloat:function(s,l){l.length&&this.writeMessage(s,pT,l)},writePackedDouble:function(s,l){l.length&&this.writeMessage(s,mT,l)},writePackedFixed32:function(s,l){l.length&&this.writeMessage(s,_T,l)},writePackedSFixed32:function(s,l){l.length&&this.writeMessage(s,La,l)},writePackedFixed64:function(s,l){l.length&&this.writeMessage(s,H0,l)},writePackedSFixed64:function(s,l){l.length&&this.writeMessage(s,yT,l)},writeBytesField:function(s,l){this.writeTag(s,Vn.Bytes),this.writeBytes(l)},writeFixed32Field:function(s,l){this.writeTag(s,Vn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(s,l){this.writeTag(s,Vn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(s,l){this.writeTag(s,Vn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(s,l){this.writeTag(s,Vn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(s,l){this.writeTag(s,Vn.Varint),this.writeVarint(l)},writeSVarintField:function(s,l){this.writeTag(s,Vn.Varint),this.writeSVarint(l)},writeStringField:function(s,l){this.writeTag(s,Vn.Bytes),this.writeString(l)},writeFloatField:function(s,l){this.writeTag(s,Vn.Fixed32),this.writeFloat(l)},writeDoubleField:function(s,l){this.writeTag(s,Vn.Fixed64),this.writeDouble(l)},writeBooleanField:function(s,l){this.writeVarintField(s,!!l)}};var wf=function(s,l){var u=l.pixelRatio,m=l.version,y=l.stretchX,b=l.stretchY,E=l.content;this.paddedRect=s,this.pixelRatio=u,this.stretchX=y,this.stretchY=b,this.content=E,this.version=m},Ku={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Ku.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Ku.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Ku.tlbr.get=function(){return this.tl.concat(this.br)},Ku.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(wf.prototype,Ku);var xf=function(s,l){var u={},m={};this.haveRenderCallbacks=[];var y=[];this.addImages(s,u,y),this.addImages(l,m,y);var b=q0(y),E=new ss({width:b.w||1,height:b.h||1});for(var S in s){var k=s[S],R=u[S].paddedRect;ss.copy(k.data,E,{x:0,y:0},{x:R.x+1,y:R.y+1},k.data)}for(var P in l){var N=l[P],V=m[P].paddedRect,H=V.x+1,X=V.y+1,Y=N.data.width,ce=N.data.height;ss.copy(N.data,E,{x:0,y:0},{x:H,y:X},N.data),ss.copy(N.data,E,{x:0,y:ce-1},{x:H,y:X-1},{width:Y,height:1}),ss.copy(N.data,E,{x:0,y:0},{x:H,y:X+ce},{width:Y,height:1}),ss.copy(N.data,E,{x:Y-1,y:0},{x:H-1,y:X},{width:1,height:ce}),ss.copy(N.data,E,{x:0,y:0},{x:H+Y,y:X},{width:1,height:ce})}this.image=E,this.iconPositions=u,this.patternPositions=m};xf.prototype.addImages=function(s,l,u){for(var m in s){var y=s[m],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(b),l[m]=new wf(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}},xf.prototype.patchUpdatedImages=function(s,l){for(var u in s.dispatchRenderCallbacks(this.haveRenderCallbacks),s.updatedImages)this.patchUpdatedImage(this.iconPositions[u],s.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],s.getImage(u),l)},xf.prototype.patchUpdatedImage=function(s,l,u){if(s&&l&&s.version!==l.version){s.version=l.version;var m=s.tl;u.update(l.data,void 0,{x:m[0],y:m[1]})}},nt("ImagePosition",wf),nt("ImageAtlas",xf);var Hs={horizontal:1,vertical:2,horizontalOnly:3},ko=function(){this.scale=1,this.fontStack="",this.imageName=null};ko.forText=function(s,l){var u=new ko;return u.scale=s||1,u.fontStack=l,u},ko.forImage=function(s){var l=new ko;return l.imageName=s,l};var fo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ug(s,l,u,m,y,b,E,S,k,R,P,N,V,H,X,Y){var ce,le=fo.fromFeature(s,y);N===Hs.vertical&&le.verticalizePunctuation();var pe=Qn.processBidirectionalText,fe=Qn.processStyledBidirectionalText;if(pe&&1===le.sections.length){ce=[];for(var Te=0,Se=pe(le.toString(),rv(le,R,b,l,m,H,X));Te<Se.length;Te+=1){var Oe=Se[Te],Ge=new fo;Ge.text=Oe,Ge.sections=le.sections;for(var Qe=0;Qe<Oe.length;Qe++)Ge.sectionIndex.push(0);ce.push(Ge)}}else if(fe){ce=[];for(var pt=0,et=fe(le.text,le.sectionIndex,rv(le,R,b,l,m,H,X));pt<et.length;pt+=1){var wt=et[pt],tt=new fo;tt.text=wt[0],tt.sectionIndex=wt[1],tt.sections=le.sections,ce.push(tt)}}else ce=function(ht,un){for(var Yt=[],vn=ht.text,xt=0,Cn=0,gr=un;Cn<gr.length;Cn+=1){var Or=gr[Cn];Yt.push(ht.substring(xt,Or)),xt=Or}return xt<vn.length&&Yt.push(ht.substring(xt,vn.length)),Yt}(le,rv(le,R,b,l,m,H,X));var sn=[],Mt={positionedLines:sn,text:le.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:N,iconsInText:!1,verticalizable:!1};return function(ht,un,Yt,vn,xt,Cn,gr,Or,Ir,_r,zr,Ei){for(var Ci=0,Ao=-17,Hi=0,Ro=0,Kr="right"===Or?1:"left"===Or?0:.5,Di=0,fn=0,nr=xt;fn<nr.length;fn+=1){var Wn=nr[fn];Wn.trim();var Dn=Wn.getMaxScale(),po=24*(Dn-1),mo={positionedGlyphs:[],lineOffset:0};ht.positionedLines[Di]=mo;var Zn=mo.positionedGlyphs,yr=0;if(Wn.length()){for(var go=0;go<Wn.length();go++){var On=Wn.getSection(go),pl=Wn.getSectionIndex(go),cs=Wn.getCharCode(go),oa=0,Nr=null,sc=null,Ba=null,nm=24,ml=!(Ir===Hs.horizontal||!zr&&!qe(cs)||zr&&(jg[cs]||(lc=cs,lt.Arabic(lc)||lt["Arabic Supplement"](lc)||lt["Arabic Extended-A"](lc)||lt["Arabic Presentation Forms-A"](lc)||lt["Arabic Presentation Forms-B"](lc))));if(On.imageName){var th=vn[On.imageName];if(!th)continue;Ba=On.imageName,ht.iconsInText=ht.iconsInText||!0,sc=th.paddedRect;var ac=th.displaySize;On.scale=24*On.scale/Ei,oa=po+(24-ac[1]*On.scale),nm=(Nr={width:ac[0],height:ac[1],left:1,top:-3,advance:ml?ac[1]:ac[0]}).advance;var nh=ml?ac[0]*On.scale-24*Dn:ac[1]*On.scale-24*Dn;nh>0&&nh>yr&&(yr=nh)}else{var Rf=Yt[On.fontStack],rh=Rf&&Rf[cs];if(rh&&rh.rect)sc=rh.rect,Nr=rh.metrics;else{var Mf=un[On.fontStack],Qg=Mf&&Mf[cs];if(!Qg)continue;Nr=Qg.metrics}oa=24*(Dn-On.scale)}ml?(ht.verticalizable=!0,Zn.push({glyph:cs,imageName:Ba,x:Ci,y:Ao+oa,vertical:ml,scale:On.scale,fontStack:On.fontStack,sectionIndex:pl,metrics:Nr,rect:sc}),Ci+=nm*On.scale+_r):(Zn.push({glyph:cs,imageName:Ba,x:Ci,y:Ao+oa,vertical:ml,scale:On.scale,fontStack:On.fontStack,sectionIndex:pl,metrics:Nr,rect:sc}),Ci+=Nr.advance*On.scale+_r)}0!==Zn.length&&(Hi=Math.max(Ci-_r,Hi),dr(Zn,0,Zn.length-1,Kr,yr)),Ci=0;var Pf=Cn*Dn+yr;mo.lineOffset=Math.max(yr,po),Ao+=Pf,Ro=Math.max(Pf,Ro),++Di}else Ao+=Cn,++Di}var lc,cc=Ao- -17,Of=iv(gr),Qc=Of.horizontalAlign,ih=Of.verticalAlign;(function(Jg,rm,Nf,im,Lf,e_,Ff,om,t_){var sm,_v=(rm-Nf)*Lf;sm=e_!==Ff?-om*im- -17:(-im*t_+.5)*Ff;for(var am=0,lm=Jg;am<lm.length;am+=1)for(var oh=0,cm=lm[am].positionedGlyphs;oh<cm.length;oh+=1){var Jc=cm[oh];Jc.x+=_v,Jc.y+=sm}})(ht.positionedLines,Kr,Qc,ih,Hi,Ro,Cn,cc,xt.length),ht.top+=-ih*cc,ht.bottom=ht.top+cc,ht.left+=-Qc*Hi,ht.right=ht.left+Hi}(Mt,l,u,m,ce,E,S,k,N,R,V,Y),!function(ht){for(var un=0,Yt=ht;un<Yt.length;un+=1)if(0!==Yt[un].positionedGlyphs.length)return!1;return!0}(sn)&&Mt}fo.fromFeature=function(s,l){for(var u=new fo,m=0;m<s.sections.length;m++){var y=s.sections[m];y.image?u.addImageSection(y):u.addTextSection(y,l)}return u},fo.prototype.length=function(){return this.text.length},fo.prototype.getSection=function(s){return this.sections[this.sectionIndex[s]]},fo.prototype.getSectionIndex=function(s){return this.sectionIndex[s]},fo.prototype.getCharCode=function(s){return this.text.charCodeAt(s)},fo.prototype.verticalizePunctuation=function(){this.text=function(s){for(var l="",u=0;u<s.length;u++){var m=s.charCodeAt(u+1)||null,y=s.charCodeAt(u-1)||null;l+=m&&Rt(m)&&!ei[s[u+1]]||y&&Rt(y)&&!ei[s[u-1]]||!ei[s[u]]?s[u]:ei[s[u]]}return l}(this.text)},fo.prototype.trim=function(){for(var s=0,l=0;l<this.text.length&&jg[this.text.charCodeAt(l)];l++)s++;for(var u=this.text.length,m=this.text.length-1;m>=0&&m>=s&&jg[this.text.charCodeAt(m)];m--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)},fo.prototype.substring=function(s,l){var u=new fo;return u.text=this.text.substring(s,l),u.sectionIndex=this.sectionIndex.slice(s,l),u.sections=this.sections,u},fo.prototype.toString=function(){return this.text},fo.prototype.getMaxScale=function(){var s=this;return this.sectionIndex.reduce(function(l,u){return Math.max(l,s.sections[u].scale)},0)},fo.prototype.addTextSection=function(s,l){this.text+=s.text,this.sections.push(ko.forText(s.scale,s.fontStack||l));for(var u=this.sections.length-1,m=0;m<s.text.length;++m)this.sectionIndex.push(u)},fo.prototype.addImageSection=function(s){var l=s.image?s.image.name:"";if(0!==l.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(ko.forImage(l)),this.sectionIndex.push(this.sections.length-1)):lr("Reached maximum number of images 6401")}else lr("Can't add FormattedSection with an empty image.")},fo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var jg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ls={};function nv(s,l,u,m,y,b){if(l.imageName){var E=m[l.imageName];return E?E.displaySize[0]*l.scale*24/b+y:0}var S=u[l.fontStack],k=S&&S[s];return k?k.metrics.advance*l.scale+y:0}function G0(s,l,u,m){var y=Math.pow(s-l,2);return m?s<l?y/2:2*y:y+Math.abs(u)*u}function Zd(s,l,u){var m=0;return 10===s&&(m-=1e4),u&&(m+=150),40!==s&&65288!==s||(m+=50),41!==l&&65289!==l||(m+=50),m}function W0(s,l,u,m,y,b){for(var E=null,S=G0(l,u,y,b),k=0,R=m;k<R.length;k+=1){var P=R[k],N=G0(l-P.x,u,y,b)+P.badness;N<=S&&(E=P,S=N)}return{index:s,x:l,priorBreak:E,badness:S}}function rv(s,l,u,m,y,b,E){if("point"!==b)return[];if(!s)return[];for(var S,k=[],R=function(ce,le,pe,fe,Te,Se){for(var Oe=0,Ge=0;Ge<ce.length();Ge++){var Qe=ce.getSection(Ge);Oe+=nv(ce.getCharCode(Ge),Qe,fe,Te,le,Se)}return Oe/Math.max(1,Math.ceil(Oe/pe))}(s,l,u,m,y,E),P=s.text.indexOf("\u200b")>=0,N=0,V=0;V<s.length();V++){var H=s.getSection(V),X=s.getCharCode(V);if(jg[X]||(N+=nv(X,H,m,y,l,E)),V<s.length()-1){var Y=!((S=X)<11904||!(lt["Bopomofo Extended"](S)||lt.Bopomofo(S)||lt["CJK Compatibility Forms"](S)||lt["CJK Compatibility Ideographs"](S)||lt["CJK Compatibility"](S)||lt["CJK Radicals Supplement"](S)||lt["CJK Strokes"](S)||lt["CJK Symbols and Punctuation"](S)||lt["CJK Unified Ideographs Extension A"](S)||lt["CJK Unified Ideographs"](S)||lt["Enclosed CJK Letters and Months"](S)||lt["Halfwidth and Fullwidth Forms"](S)||lt.Hiragana(S)||lt["Ideographic Description Characters"](S)||lt["Kangxi Radicals"](S)||lt["Katakana Phonetic Extensions"](S)||lt.Katakana(S)||lt["Vertical Forms"](S)||lt["Yi Radicals"](S)||lt["Yi Syllables"](S)));(ls[X]||Y||H.imageName)&&k.push(W0(V+1,N,R,k,Zd(X,s.getCharCode(V+1),Y&&P),!1))}}return function ce(le){return le?ce(le.priorBreak).concat(le.index):[]}(W0(s.length(),N,R,k,0,!0))}function iv(s){var l=.5,u=.5;switch(s){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:l,verticalAlign:u}}function dr(s,l,u,m,y){if(m||y)for(var b=s[u],E=(s[u].x+b.metrics.advance*b.scale)*m,S=l;S<=u;S++)s[S].x-=E,s[S].y+=y}function _t(s,l,u,m,y,b){var E,S=s.image;if(S.content){var k=S.content,R=S.pixelRatio||1;E=[k[0]/R,k[1]/R,S.displaySize[0]-k[2]/R,S.displaySize[1]-k[3]/R]}var P,N,V,H,X=l.left*b,Y=l.right*b;"width"===u||"both"===u?(H=y[0]+X-m[3],N=y[0]+Y+m[1]):N=(H=y[0]+(X+Y-S.displaySize[0])/2)+S.displaySize[0];var ce=l.top*b,le=l.bottom*b;return"height"===u||"both"===u?(P=y[1]+ce-m[0],V=y[1]+le+m[2]):V=(P=y[1]+(ce+le-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:P,right:N,bottom:V,left:H,collisionPadding:E}}ls[10]=!0,ls[32]=!0,ls[38]=!0,ls[40]=!0,ls[41]=!0,ls[43]=!0,ls[45]=!0,ls[47]=!0,ls[173]=!0,ls[183]=!0,ls[8203]=!0,ls[8208]=!0,ls[8211]=!0,ls[8231]=!0;var Ef=function(s){function l(u,m,y,b){s.call(this,u,m),this.angle=y,void 0!==b&&(this.segment=b)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.clone=function(){return new l(this.x,this.y,this.angle,this.segment)},l}(Vt);function Hg(s,l){var u=l.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new Ut(s+1))};if("source"===u.kind)return{kind:"source"};for(var m=u.zoomStops,y=u.interpolationType,b=0;b<m.length&&m[b]<=s;)b++;for(var E=b=Math.max(0,b-1);E<m.length&&m[E]<s+1;)E++;E=Math.min(m.length-1,E);var S=m[b],k=m[E];return"composite"===u.kind?{kind:"composite",minZoom:S,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:S,maxZoom:k,minSize:u.evaluate(new Ut(S)),maxSize:u.evaluate(new Ut(k)),interpolationType:y}}function Kp(s,l,u){var m=l.uSize,y=u.lowerSize;return"source"===s.kind?y/128:"composite"===s.kind?si(y/128,u.upperSize/128,l.uSizeT):m}function Yp(s,l){var u=0,m=0;if("constant"===s.kind)m=s.layoutSize;else if("source"!==s.kind){var y=s.interpolationType,b=y?Wi(en.interpolationFactor(y,l,s.minZoom,s.maxZoom),0,1):0;"camera"===s.kind?m=si(s.minSize,s.maxSize,b):u=b}return{uSizeT:u,uSize:m}}nt("Anchor",Ef);var ov=Object.freeze({__proto__:null,getSizeData:Hg,evaluateSizeForFeature:Kp,evaluateSizeForZoom:Yp,SIZE_PACK_FACTOR:128});function sv(s,l,u,m,y){if(void 0===l.segment)return!0;for(var b=l,E=l.segment+1,S=0;S>-u/2;){if(--E<0)return!1;S-=s[E].dist(b),b=s[E]}S+=s[E].dist(s[E+1]),E++;for(var k=[],R=0;S<u/2;){var P=s[E],N=s[E+1];if(!N)return!1;var V=s[E-1].angleTo(P)-P.angleTo(N);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:S,angleDelta:V}),R+=V;S-k[0].distance>m;)R-=k.shift().angleDelta;if(R>y)return!1;E++,S+=P.dist(N)}return!0}function av(s){for(var l=0,u=0;u<s.length-1;u++)l+=s[u].dist(s[u+1]);return l}function Z0(s,l,u){return s?.6*l*u:0}function Kd(s,l){return Math.max(s?s.right-s.left:0,l?l.right-l.left:0)}function Xp(s,l,u,m,y,b){for(var E=Z0(u,y,b),S=Kd(u,m)*b,k=0,R=av(s)/2,P=0;P<s.length-1;P++){var N=s[P],V=s[P+1],H=N.dist(V);if(k+H>R){var X=(R-k)/H,Y=si(N.x,V.x,X),ce=si(N.y,V.y,X),le=new Ef(Y,ce,V.angleTo(N),P);return le._round(),!E||sv(s,le,S,E,l)?le:void 0}k+=H}}function lv(s,l,u,m,y,b,E,S,k){var R=Z0(m,b,E),P=Kd(m,y),N=P*E,V=0===s[0].x||s[0].x===k||0===s[0].y||s[0].y===k;return l-N<l/4&&(l=N+l/4),function H(X,Y,ce,le,pe,fe,Te,Se,Oe){for(var Ge=fe/2,Qe=av(X),pt=0,et=Y-ce,wt=[],tt=0;tt<X.length-1;tt++){for(var sn=X[tt],Mt=X[tt+1],ht=sn.dist(Mt),un=Mt.angleTo(sn);et+ce<pt+ht;){var Yt=((et+=ce)-pt)/ht,vn=si(sn.x,Mt.x,Yt),xt=si(sn.y,Mt.y,Yt);if(vn>=0&&vn<Oe&&xt>=0&&xt<Oe&&et-Ge>=0&&et+Ge<=Qe){var Cn=new Ef(vn,xt,un,tt);Cn._round(),le&&!sv(X,Cn,fe,le,pe)||wt.push(Cn)}}pt+=ht}return Se||wt.length||Te||(wt=H(X,pt/2,ce,le,pe,fe,Te,!0,Oe)),wt}(s,V?l/2*S%l:(P/2+2*b)*E*S%l,l,R,u,N,V,!1,k)}function cv(s,l,u,m,y){for(var b=[],E=0;E<s.length;E++)for(var S=s[E],k=void 0,R=0;R<S.length-1;R++){var P=S[R],N=S[R+1];P.x<l&&N.x<l||(P.x<l?P=new Vt(l,P.y+(l-P.x)/(N.x-P.x)*(N.y-P.y))._round():N.x<l&&(N=new Vt(l,P.y+(l-P.x)/(N.x-P.x)*(N.y-P.y))._round()),P.y<u&&N.y<u||(P.y<u?P=new Vt(P.x+(u-P.y)/(N.y-P.y)*(N.x-P.x),u)._round():N.y<u&&(N=new Vt(P.x+(u-P.y)/(N.y-P.y)*(N.x-P.x),u)._round()),P.x>=m&&N.x>=m||(P.x>=m?P=new Vt(m,P.y+(m-P.x)/(N.x-P.x)*(N.y-P.y))._round():N.x>=m&&(N=new Vt(m,P.y+(m-P.x)/(N.x-P.x)*(N.y-P.y))._round()),P.y>=y&&N.y>=y||(P.y>=y?P=new Vt(P.x+(y-P.y)/(N.y-P.y)*(N.x-P.x),y)._round():N.y>=y&&(N=new Vt(P.x+(y-P.y)/(N.y-P.y)*(N.x-P.x),y)._round()),k&&P.equals(k[k.length-1])||b.push(k=[P]),k.push(N)))))}return b}function xT(s,l,u,m){var y=[],b=s.image,E=b.pixelRatio,S=b.paddedRect.w-2,k=b.paddedRect.h-2,R=s.right-s.left,P=s.bottom-s.top,N=b.stretchX||[[0,S]],V=b.stretchY||[[0,k]],H=function(vn,xt){return vn+xt[1]-xt[0]},X=N.reduce(H,0),Y=V.reduce(H,0),ce=S-X,le=k-Y,pe=0,fe=X,Te=0,Se=Y,Oe=0,Ge=ce,Qe=0,pt=le;if(b.content&&m){var et=b.content;pe=$g(N,0,et[0]),Te=$g(V,0,et[1]),fe=$g(N,et[0],et[2]),Se=$g(V,et[1],et[3]),Oe=et[0]-pe,Qe=et[1]-Te,Ge=et[2]-et[0]-fe,pt=et[3]-et[1]-Se}var wt=function(vn,xt,Cn,gr){var Or=uv(vn.stretch-pe,fe,R,s.left),Ir=dv(vn.fixed-Oe,Ge,vn.stretch,X),_r=uv(xt.stretch-Te,Se,P,s.top),zr=dv(xt.fixed-Qe,pt,xt.stretch,Y),Ei=uv(Cn.stretch-pe,fe,R,s.left),Ci=dv(Cn.fixed-Oe,Ge,Cn.stretch,X),Ao=uv(gr.stretch-Te,Se,P,s.top),Hi=dv(gr.fixed-Qe,pt,gr.stretch,Y),Ro=new Vt(Or,_r),Kr=new Vt(Ei,_r),Di=new Vt(Ei,Ao),fn=new Vt(Or,Ao),nr=new Vt(Ir/E,zr/E),Wn=new Vt(Ci/E,Hi/E),Dn=l*Math.PI/180;if(Dn){var po=Math.sin(Dn),mo=Math.cos(Dn),Zn=[mo,-po,po,mo];Ro._matMult(Zn),Kr._matMult(Zn),fn._matMult(Zn),Di._matMult(Zn)}var yr=vn.stretch+vn.fixed,go=xt.stretch+xt.fixed;return{tl:Ro,tr:Kr,bl:fn,br:Di,tex:{x:b.paddedRect.x+1+yr,y:b.paddedRect.y+1+go,w:Cn.stretch+Cn.fixed-yr,h:gr.stretch+gr.fixed-go},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nr,pixelOffsetBR:Wn,minFontScaleX:Ge/E/R,minFontScaleY:pt/E/P,isSDF:u}};if(m&&(b.stretchX||b.stretchY))for(var tt=K0(N,ce,X),sn=K0(V,le,Y),Mt=0;Mt<tt.length-1;Mt++)for(var ht=tt[Mt],un=tt[Mt+1],Yt=0;Yt<sn.length-1;Yt++)y.push(wt(ht,sn[Yt],un,sn[Yt+1]));else y.push(wt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:k+1}));return y}function $g(s,l,u){for(var m=0,y=0,b=s;y<b.length;y+=1){var E=b[y];m+=Math.max(l,Math.min(u,E[1]))-Math.max(l,Math.min(u,E[0]))}return m}function K0(s,l,u){for(var m=[{fixed:-1,stretch:0}],y=0,b=s;y<b.length;y+=1){var E=b[y],S=E[0],k=E[1],R=m[m.length-1];m.push({fixed:S-R.stretch,stretch:R.stretch}),m.push({fixed:S-R.stretch,stretch:R.stretch+(k-S)})}return m.push({fixed:l+1,stretch:u}),m}function uv(s,l,u,m){return s/l*u+m}function dv(s,l,u,m){return s-l*u/m}var qg=function(s,l,u,m,y,b,E,S,k,R){if(this.boxStartIndex=s.length,k){var P=b.top,N=b.bottom,V=b.collisionPadding;V&&(P-=V[1],N+=V[3]);var H=N-P;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{var X=b.top*E-S,Y=b.bottom*E+S,ce=b.left*E-S,le=b.right*E+S,pe=b.collisionPadding;if(pe&&(ce-=pe[0]*E,X-=pe[1]*E,le+=pe[2]*E,Y+=pe[3]*E),R){var fe=new Vt(ce,X),Te=new Vt(le,X),Se=new Vt(ce,Y),Oe=new Vt(le,Y),Ge=R*Math.PI/180;fe._rotate(Ge),Te._rotate(Ge),Se._rotate(Ge),Oe._rotate(Ge),ce=Math.min(fe.x,Te.x,Se.x,Oe.x),le=Math.max(fe.x,Te.x,Se.x,Oe.x),X=Math.min(fe.y,Te.y,Se.y,Oe.y),Y=Math.max(fe.y,Te.y,Se.y,Oe.y)}s.emplaceBack(l.x,l.y,ce,X,le,Y,u,m,y)}this.boxEndIndex=s.length},Yu=function(s,l){if(void 0===s&&(s=[]),void 0===l&&(l=Y0),this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function Y0(s,l){return s<l?-1:s>l?1:0}function Cf(s,l,u){void 0===l&&(l=1),void 0===u&&(u=!1);for(var m=1/0,y=1/0,b=-1/0,E=-1/0,S=s[0],k=0;k<S.length;k++){var R=S[k];(!k||R.x<m)&&(m=R.x),(!k||R.y<y)&&(y=R.y),(!k||R.x>b)&&(b=R.x),(!k||R.y>E)&&(E=R.y)}var P=Math.min(b-m,E-y),N=P/2,V=new Yu([],X0);if(0===P)return new Vt(m,y);for(var H=m;H<b;H+=P)for(var X=y;X<E;X+=P)V.push(new Xu(H+N,X+N,N,s));for(var Y=function(pe){for(var fe=0,Te=0,Se=0,Oe=pe[0],Ge=0,Qe=Oe.length,pt=Qe-1;Ge<Qe;pt=Ge++){var et=Oe[Ge],wt=Oe[pt],tt=et.x*wt.y-wt.x*et.y;Te+=(et.x+wt.x)*tt,Se+=(et.y+wt.y)*tt,fe+=3*tt}return new Xu(Te/fe,Se/fe,0,pe)}(s),ce=V.length;V.length;){var le=V.pop();(le.d>Y.d||!Y.d)&&(Y=le,u&&console.log("found best %d after %d probes",Math.round(1e4*le.d)/1e4,ce)),le.max-Y.d<=l||(V.push(new Xu(le.p.x-(N=le.h/2),le.p.y-N,N,s)),V.push(new Xu(le.p.x+N,le.p.y-N,N,s)),V.push(new Xu(le.p.x-N,le.p.y+N,N,s)),V.push(new Xu(le.p.x+N,le.p.y+N,N,s)),ce+=4)}return u&&(console.log("num probes: "+ce),console.log("best distance: "+Y.d)),Y.p}function X0(s,l){return l.max-s.max}function Xu(s,l,u,m){this.p=new Vt(s,l),this.h=u,this.d=function(y,b){for(var E=!1,S=1/0,k=0;k<b.length;k++)for(var R=b[k],P=0,N=R.length,V=N-1;P<N;V=P++){var H=R[P],X=R[V];H.y>y.y!=X.y>y.y&&y.x<(X.x-H.x)*(y.y-H.y)/(X.y-H.y)+H.x&&(E=!E),S=Math.min(S,Is(y,H,X))}return(E?1:-1)*Math.sqrt(S)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}Yu.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},Yu.prototype.pop=function(){if(0!==this.length){var s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}},Yu.prototype.peek=function(){return this.data[0]},Yu.prototype._up=function(s){for(var l=this.data,u=this.compare,m=l[s];s>0;){var y=s-1>>1,b=l[y];if(u(m,b)>=0)break;l[s]=b,s=y}l[s]=m},Yu.prototype._down=function(s){for(var l=this.data,u=this.compare,m=this.length>>1,y=l[s];s<m;){var b=1+(s<<1),E=l[b],S=b+1;if(S<this.length&&u(l[S],E)<0&&(b=S,E=l[S]),u(E,y)>=0)break;l[s]=E,s=b}l[s]=y};var Yd=Number.POSITIVE_INFINITY;function Q0(s,l){return l[1]!==Yd?function(u,m,y){var b=0,E=0;switch(m=Math.abs(m),y=Math.abs(y),u){case"top-right":case"top-left":case"top":E=y-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-m;break;case"top-left":case"bottom-left":case"left":b=m}return[b,E]}(s,l[0],l[1]):function(u,m){var y=0,b=0;m<0&&(m=0);var E=m/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-m;break;case"top":b=m-7}switch(u){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=m;break;case"right":y=-m}return[y,b]}(s,l[0])}function Xd(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Gg(s,l,u,m,y,b,E,S,k,R,P,N,V,H,X){var Y=function(Te,Se,Oe,Ge,Qe,pt,et,wt){for(var tt=Ge.layout.get("text-rotate").evaluate(pt,{})*Math.PI/180,sn=[],Mt=0,ht=Se.positionedLines;Mt<ht.length;Mt+=1)for(var un=ht[Mt],Yt=0,vn=un.positionedGlyphs;Yt<vn.length;Yt+=1){var xt=vn[Yt];if(xt.rect){var Cn=xt.rect||{},gr=4,Or=!0,Ir=1,_r=0,zr=(Qe||wt)&&xt.vertical,Ei=xt.metrics.advance*xt.scale/2;if(wt&&Se.verticalizable&&(_r=un.lineOffset/2-(xt.imageName?-(24-xt.metrics.width*xt.scale)/2:24*(xt.scale-1))),xt.imageName){var Ci=et[xt.imageName];Or=Ci.sdf,gr=1/(Ir=Ci.pixelRatio)}var Ao=Qe?[xt.x+Ei,xt.y]:[0,0],Hi=Qe?[0,0]:[xt.x+Ei+Oe[0],xt.y+Oe[1]-_r],Ro=[0,0];zr&&(Ro=Hi,Hi=[0,0]);var Kr=(xt.metrics.left-gr)*xt.scale-Ei+Hi[0],Di=(-xt.metrics.top-gr)*xt.scale+Hi[1],fn=Kr+Cn.w*xt.scale/Ir,nr=Di+Cn.h*xt.scale/Ir,Wn=new Vt(Kr,Di),Dn=new Vt(fn,Di),po=new Vt(Kr,nr),mo=new Vt(fn,nr);if(zr){var Zn=new Vt(-Ei,Ei- -17),yr=-Math.PI/2,go=12-Ei,On=new Vt(22-go,-(xt.imageName?go:0)),pl=new(Function.prototype.bind.apply(Vt,[null].concat(Ro)));Wn._rotateAround(yr,Zn)._add(On)._add(pl),Dn._rotateAround(yr,Zn)._add(On)._add(pl),po._rotateAround(yr,Zn)._add(On)._add(pl),mo._rotateAround(yr,Zn)._add(On)._add(pl)}if(tt){var cs=Math.sin(tt),oa=Math.cos(tt),Nr=[oa,-cs,cs,oa];Wn._matMult(Nr),Dn._matMult(Nr),po._matMult(Nr),mo._matMult(Nr)}var sc=new Vt(0,0),Ba=new Vt(0,0);sn.push({tl:Wn,tr:Dn,bl:po,br:mo,tex:Cn,writingMode:Se.writingMode,glyphOffset:Ao,sectionIndex:xt.sectionIndex,isSDF:Or,pixelOffsetTL:sc,pixelOffsetBR:Ba,minFontScaleX:0,minFontScaleY:0})}}return sn}(0,u,S,y,b,E,m,s.allowVerticalPlacement),ce=s.textSizeData,le=null;"source"===ce.kind?(le=[128*y.layout.get("text-size").evaluate(E,{})])[0]>32640&&lr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===ce.kind&&((le=[128*H.compositeTextSizes[0].evaluate(E,{},X),128*H.compositeTextSizes[1].evaluate(E,{},X)])[0]>32640||le[1]>32640)&&lr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),s.addSymbols(s.text,Y,le,S,b,E,R,l,k.lineStartIndex,k.lineLength,V,X);for(var pe=0,fe=P;pe<fe.length;pe+=1)N[fe[pe]]=s.text.placedSymbolArray.length-1;return 4*Y.length}function Qp(s){for(var l in s)return s[l];return null}function s2(s,l,u,m){var y=s.compareText;if(l in y){for(var b=y[l],E=b.length-1;E>=0;E--)if(m.dist(b[E])<u)return!0}else y[l]=[];return y[l].push(m),!1}var J0=Zp.VectorTileFeature.types,ex=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wg(s,l,u,m,y,b,E,S,k,R,P,N,V){var H=S?Math.min(32640,Math.round(S[0])):0,X=S?Math.min(32640,Math.round(S[1])):0;s.emplaceBack(l,u,Math.round(32*m),Math.round(32*y),b,E,(H<<1)+(k?1:0),X,16*R,16*P,256*N,256*V)}function Fa(s,l,u){s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u)}function ET(s){for(var l=0,u=s.sections;l<u.length;l+=1)if(Li(u[l].text))return!0;return!1}var Kc=function(s){this.layoutVertexArray=new Ud,this.indexArray=new zs,this.programConfigurations=s,this.segments=new j,this.dynamicLayoutVertexArray=new Ss,this.opacityVertexArray=new ff,this.placedSymbolArray=new w};Kc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Kc.prototype.upload=function(s,l,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,U0.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,mr.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,ex,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(s))},Kc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},nt("SymbolBuffers",Kc);var Qd=function(s,l,u){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new u,this.segments=new j,this.collisionVertexArray=new Ag};Qd.prototype.upload=function(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,j0.members,!0)},Qd.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},nt("CollisionBuffers",Qd);var Gn=function(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(b){return b.id}),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Mr([]),this.placementViewportMatrix=Mr([]);var l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Hg(this.zoom,l["text-size"]),this.iconSizeData=Hg(this.zoom,l["icon-size"]);var u=this.layers[0].layout,m=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(b){return Hs[b]})),this.stateDependentLayerIds=this.layers.filter(function(b){return b.isStateDependent()}).map(function(b){return b.id}),this.sourceID=s.sourceID};Gn.prototype.createArrays=function(){this.text=new Kc(new Jn(this.layers,this.zoom,function(s){return/^text/.test(s)})),this.icon=new Kc(new Jn(this.layers,this.zoom,function(s){return/^icon/.test(s)})),this.glyphOffsetArray=new I,this.lineVertexArray=new M,this.symbolInstances=new T},Gn.prototype.calculateGlyphDependencies=function(s,l,u,m,y){for(var b=0;b<s.length;b++)if(l[s.charCodeAt(b)]=!0,(u||m)&&y){var E=ei[s.charAt(b)];E&&(l[E.charCodeAt(0)]=!0)}},Gn.prototype.populate=function(s,l,u){var m=this.layers[0],y=m.layout,b=y.get("text-font"),E=y.get("text-field"),S=y.get("icon-image"),k=("constant"!==E.value.kind||E.value.value instanceof Qr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),R="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,P=y.get("symbol-sort-key");if(this.features=[],k||R){for(var N=l.iconDependencies,V=l.glyphDependencies,H=l.availableImages,X=new Ut(this.zoom),Y=0,ce=s;Y<ce.length;Y+=1){var le=ce[Y],pe=le.feature,fe=le.id,Te=le.index,Se=le.sourceLayerIndex,Oe=m._featureFilter.needGeometry,Ge=To(pe,Oe);if(m._featureFilter.filter(X,Ge,u)){Oe||(Ge.geometry=Wr(pe));var Qe=void 0;if(k){var pt=m.getValueAndResolveTokens("text-field",Ge,u,H),et=Qr.factory(pt);ET(et)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===lo()||this.hasRTLText&&Qn.isParsed())&&(Qe=Io(et,m,Ge))}var wt=void 0;if(R){var tt=m.getValueAndResolveTokens("icon-image",Ge,u,H);wt=tt instanceof wr?tt:wr.fromString(tt)}if(Qe||wt){var sn=this.sortFeaturesByKey?P.evaluate(Ge,{},u):void 0;if(this.features.push({id:fe,text:Qe,icon:wt,index:Te,sourceLayerIndex:Se,geometry:Ge.geometry,properties:pe.properties,type:J0[pe.type],sortKey:sn}),wt&&(N[wt.name]=!0),Qe){var Mt=b.evaluate(Ge,{},u).join(","),ht="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Hs.vertical)>=0;for(var un=0,Yt=Qe.sections;un<Yt.length;un+=1){var vn=Yt[un];if(vn.image)N[vn.image.name]=!0;else{var xt=Gr(Qe.toString()),Cn=vn.fontStack||Mt,gr=V[Cn]=V[Cn]||{};this.calculateGlyphDependencies(vn.text,gr,ht,this.allowVerticalPlacement,xt)}}}}}}"line"===y.get("symbol-placement")&&(this.features=function(Or){var Ir={},_r={},zr=[],Ei=0;function Ci(Zn){zr.push(Or[Zn]),Ei++}function Ao(Zn,yr,go){var On=_r[Zn];return delete _r[Zn],_r[yr]=On,zr[On].geometry[0].pop(),zr[On].geometry[0]=zr[On].geometry[0].concat(go[0]),On}function Hi(Zn,yr,go){var On=Ir[yr];return delete Ir[yr],Ir[Zn]=On,zr[On].geometry[0].shift(),zr[On].geometry[0]=go[0].concat(zr[On].geometry[0]),On}function Ro(Zn,yr,go){var On=go?yr[0][yr[0].length-1]:yr[0][0];return Zn+":"+On.x+":"+On.y}for(var Kr=0;Kr<Or.length;Kr++){var Di=Or[Kr],fn=Di.geometry,nr=Di.text?Di.text.toString():null;if(nr){var Wn=Ro(nr,fn),Dn=Ro(nr,fn,!0);if(Wn in _r&&Dn in Ir&&_r[Wn]!==Ir[Dn]){var po=Hi(Wn,Dn,fn),mo=Ao(Wn,Dn,zr[po].geometry);delete Ir[Wn],delete _r[Dn],_r[Ro(nr,zr[mo].geometry,!0)]=mo,zr[po].geometry=null}else Wn in _r?Ao(Wn,Dn,fn):Dn in Ir?Hi(Wn,Dn,fn):(Ci(Kr),Ir[Wn]=Ei-1,_r[Dn]=Ei-1)}else Ci(Kr)}return zr.filter(function(Zn){return Zn.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Or,Ir){return Or.sortKey-Ir.sortKey})}},Gn.prototype.update=function(s,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,u),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,u))},Gn.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Gn.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Gn.prototype.upload=function(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Gn.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Gn.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Gn.prototype.addToLineVertexArray=function(s,l){var u=this.lineVertexArray.length;if(void 0!==s.segment){for(var m=s.dist(l[s.segment+1]),y=s.dist(l[s.segment]),b={},E=s.segment+1;E<l.length;E++)b[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:m},E<l.length-1&&(m+=l[E+1].dist(l[E]));for(var S=s.segment||0;S>=0;S--)b[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=l[S-1].dist(l[S]));for(var k=0;k<l.length;k++){var R=b[k];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Gn.prototype.addSymbols=function(s,l,u,m,y,b,E,S,k,R,P,N){for(var V=s.indexArray,H=s.layoutVertexArray,X=s.segments.prepareSegment(4*l.length,H,V,this.canOverlap?b.sortKey:void 0),Y=this.glyphOffsetArray.length,ce=X.vertexLength,le=this.allowVerticalPlacement&&E===Hs.vertical?Math.PI/2:0,pe=b.text&&b.text.sections,fe=0;fe<l.length;fe++){var Te=l[fe],Se=Te.tl,Oe=Te.tr,Ge=Te.bl,Qe=Te.br,pt=Te.tex,et=Te.pixelOffsetTL,wt=Te.pixelOffsetBR,tt=Te.minFontScaleX,sn=Te.minFontScaleY,Mt=Te.glyphOffset,ht=Te.isSDF,un=Te.sectionIndex,Yt=X.vertexLength,vn=Mt[1];Wg(H,S.x,S.y,Se.x,vn+Se.y,pt.x,pt.y,u,ht,et.x,et.y,tt,sn),Wg(H,S.x,S.y,Oe.x,vn+Oe.y,pt.x+pt.w,pt.y,u,ht,wt.x,et.y,tt,sn),Wg(H,S.x,S.y,Ge.x,vn+Ge.y,pt.x,pt.y+pt.h,u,ht,et.x,wt.y,tt,sn),Wg(H,S.x,S.y,Qe.x,vn+Qe.y,pt.x+pt.w,pt.y+pt.h,u,ht,wt.x,wt.y,tt,sn),Fa(s.dynamicLayoutVertexArray,S,le),V.emplaceBack(Yt,Yt+1,Yt+2),V.emplaceBack(Yt+1,Yt+2,Yt+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Mt[0]),fe!==l.length-1&&un===l[fe+1].sectionIndex||s.programConfigurations.populatePaintArrays(H.length,b,b.index,{},N,pe&&pe[un])}s.placedSymbolArray.emplaceBack(S.x,S.y,Y,this.glyphOffsetArray.length-Y,ce,k,R,S.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],E,0,!1,0,P)},Gn.prototype._addCollisionDebugVertex=function(s,l,u,m,y,b){return l.emplaceBack(0,0),s.emplaceBack(u.x,u.y,m,y,Math.round(b.x),Math.round(b.y))},Gn.prototype.addCollisionDebugVertices=function(s,l,u,m,y,b,E){var S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=S.vertexLength,R=y.layoutVertexArray,P=y.collisionVertexArray,N=E.anchorX,V=E.anchorY;this._addCollisionDebugVertex(R,P,b,N,V,new Vt(s,l)),this._addCollisionDebugVertex(R,P,b,N,V,new Vt(u,l)),this._addCollisionDebugVertex(R,P,b,N,V,new Vt(u,m)),this._addCollisionDebugVertex(R,P,b,N,V,new Vt(s,m)),S.vertexLength+=4;var H=y.indexArray;H.emplaceBack(k,k+1),H.emplaceBack(k+1,k+2),H.emplaceBack(k+2,k+3),H.emplaceBack(k+3,k),S.primitiveLength+=4},Gn.prototype.addDebugCollisionBoxes=function(s,l,u,m){for(var y=s;y<l;y++){var b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}},Gn.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qd(Jl,_e.members,mf),this.iconCollisionBox=new Qd(Jl,_e.members,mf);for(var s=0;s<this.symbolInstances.length;s++){var l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}},Gn.prototype._deserializeCollisionBoxesForSymbol=function(s,l,u,m,y,b,E,S,k){for(var R={},P=l;P<u;P++){var N=s.get(P);R.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},R.textFeatureIndex=N.featureIndex;break}for(var V=m;V<y;V++){var H=s.get(V);R.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},R.verticalTextFeatureIndex=H.featureIndex;break}for(var X=b;X<E;X++){var Y=s.get(X);R.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},R.iconFeatureIndex=Y.featureIndex;break}for(var ce=S;ce<k;ce++){var le=s.get(ce);R.verticalIconBox={x1:le.x1,y1:le.y1,x2:le.x2,y2:le.y2,anchorPointX:le.anchorPointX,anchorPointY:le.anchorPointY},R.verticalIconFeatureIndex=le.featureIndex;break}return R},Gn.prototype.deserializeCollisionBoxes=function(s){this.collisionArrays=[];for(var l=0;l<this.symbolInstances.length;l++){var u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Gn.prototype.hasTextData=function(){return this.text.segments.get().length>0},Gn.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Gn.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Gn.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Gn.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Gn.prototype.addIndicesForPlacedSymbol=function(s,l){for(var u=s.placedSymbolArray.get(l),m=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<m;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)},Gn.prototype.getSortedSymbolIndexes=function(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var l=Math.sin(s),u=Math.cos(s),m=[],y=[],b=[],E=0;E<this.symbolInstances.length;++E){b.push(E);var S=this.symbolInstances.get(E);m.push(0|Math.round(l*S.anchorX+u*S.anchorY)),y.push(S.featureIndex)}return b.sort(function(k,R){return m[k]-m[R]||y[R]-y[k]}),b},Gn.prototype.addToSortKeyRanges=function(s,l){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})},Gn.prototype.sortFeatures=function(s){var l=this;if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,m=this.symbolInstanceIndexes;u<m.length;u+=1){var y=this.symbolInstances.get(m[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(b,E,S){b>=0&&S.indexOf(b)===E&&l.addIndicesForPlacedSymbol(l.text,b)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},nt("SymbolBucket",Gn,{omit:["layers","collisionBoxArray","features","compareText"]}),Gn.MAX_GLYPHS=65535,Gn.addDynamicAttributes=Fa;var Zg=new ci({"symbol-placement":new Xe(W.layout_symbol["symbol-placement"]),"symbol-spacing":new Xe(W.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xe(W.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new It(W.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xe(W.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xe(W.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xe(W.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xe(W.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xe(W.layout_symbol["icon-rotation-alignment"]),"icon-size":new It(W.layout_symbol["icon-size"]),"icon-text-fit":new Xe(W.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xe(W.layout_symbol["icon-text-fit-padding"]),"icon-image":new It(W.layout_symbol["icon-image"]),"icon-rotate":new It(W.layout_symbol["icon-rotate"]),"icon-padding":new Xe(W.layout_symbol["icon-padding"]),"icon-keep-upright":new Xe(W.layout_symbol["icon-keep-upright"]),"icon-offset":new It(W.layout_symbol["icon-offset"]),"icon-anchor":new It(W.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xe(W.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xe(W.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xe(W.layout_symbol["text-rotation-alignment"]),"text-field":new It(W.layout_symbol["text-field"]),"text-font":new It(W.layout_symbol["text-font"]),"text-size":new It(W.layout_symbol["text-size"]),"text-max-width":new It(W.layout_symbol["text-max-width"]),"text-line-height":new Xe(W.layout_symbol["text-line-height"]),"text-letter-spacing":new It(W.layout_symbol["text-letter-spacing"]),"text-justify":new It(W.layout_symbol["text-justify"]),"text-radial-offset":new It(W.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xe(W.layout_symbol["text-variable-anchor"]),"text-anchor":new It(W.layout_symbol["text-anchor"]),"text-max-angle":new Xe(W.layout_symbol["text-max-angle"]),"text-writing-mode":new Xe(W.layout_symbol["text-writing-mode"]),"text-rotate":new It(W.layout_symbol["text-rotate"]),"text-padding":new Xe(W.layout_symbol["text-padding"]),"text-keep-upright":new Xe(W.layout_symbol["text-keep-upright"]),"text-transform":new It(W.layout_symbol["text-transform"]),"text-offset":new It(W.layout_symbol["text-offset"]),"text-allow-overlap":new Xe(W.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xe(W.layout_symbol["text-ignore-placement"]),"text-optional":new Xe(W.layout_symbol["text-optional"])}),Jp={paint:new ci({"icon-opacity":new It(W.paint_symbol["icon-opacity"]),"icon-color":new It(W.paint_symbol["icon-color"]),"icon-halo-color":new It(W.paint_symbol["icon-halo-color"]),"icon-halo-width":new It(W.paint_symbol["icon-halo-width"]),"icon-halo-blur":new It(W.paint_symbol["icon-halo-blur"]),"icon-translate":new Xe(W.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xe(W.paint_symbol["icon-translate-anchor"]),"text-opacity":new It(W.paint_symbol["text-opacity"]),"text-color":new It(W.paint_symbol["text-color"],{runtimeType:Gt,getOverride:function(s){return s.textColor},hasOverride:function(s){return!!s.textColor}}),"text-halo-color":new It(W.paint_symbol["text-halo-color"]),"text-halo-width":new It(W.paint_symbol["text-halo-width"]),"text-halo-blur":new It(W.paint_symbol["text-halo-blur"]),"text-translate":new Xe(W.paint_symbol["text-translate"]),"text-translate-anchor":new Xe(W.paint_symbol["text-translate-anchor"])}),layout:Zg},Df=function(s){this.type=s.property.overrides?s.property.overrides.runtimeType:mt,this.defaultValue=s};Df.prototype.evaluate=function(s){if(s.formattedSection){var l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default},Df.prototype.eachChild=function(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)},Df.prototype.outputDefined=function(){return!1},Df.prototype.serialize=function(){return null},nt("FormatSectionOverride",Df,{omit:["defaultValue"]});var tx=function(s){function l(u){s.call(this,u,Jp)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){if(s.prototype.recalculate.call(this,u,m),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var y=this.layout.get("text-writing-mode");if(y){for(var b=[],E=0,S=y;E<S.length;E+=1){var k=S[E];b.indexOf(k)<0&&b.push(k)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},l.prototype.getValueAndResolveTokens=function(u,m,y,b){var k,E=this.layout.get(u).evaluate(m,{},y,b),S=this._unevaluatedLayout._values[u];return S.isDataDriven()||rf(S.value)||!E?E:(k=m.properties,E.replace(/{([^{}]+)}/g,function(P,N){return N in k?String(k[N]):""}))},l.prototype.createBucket=function(u){return new Gn(u)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype._setPaintOverrides=function(){for(var u=0,m=Jp.paint.overridableProperties;u<m.length;u+=1){var y=m[u];if(l.hasPaintOverride(this.layout,y)){var b,E=this.paint.get(y),S=new Df(E),k=new Ia(S,E.property.specification);b="constant"===E.value.kind||"source"===E.value.kind?new Ld("source",k):new so("composite",k,E.value.zoomStops,E.value._interpolationType),this.paint._values[y]=new Ho(E.property,b,E.parameters)}}},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!(!this.layout||m.isDataDriven()||y.isDataDriven())&&l.hasPaintOverride(this.layout,u)},l.hasPaintOverride=function(u,m){var y=u.get("text-field"),b=Jp.paint.properties[m],E=!1,S=function(P){for(var N=0,V=P;N<V.length;N+=1)if(b.overrides&&b.overrides.hasOverride(V[N]))return void(E=!0)};if("constant"===y.value.kind&&y.value.value instanceof Qr)S(y.value.value.sections);else if("source"===y.value.kind){var k=function(P){E||(P instanceof Ys&&Mi(P.value)===Nt?S(P.value.sections):P instanceof Jo?S(P.sections):P.eachChild(k))},R=y.value;R._styleExpression&&k(R._styleExpression.expression)}return E},l}(wi),nx={paint:new ci({"background-color":new Xe(W.paint_background["background-color"]),"background-pattern":new kt(W.paint_background["background-pattern"]),"background-opacity":new Xe(W.paint_background["background-opacity"])})},rx=function(s){function l(u){s.call(this,u,nx)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(wi),ix={paint:new ci({"raster-opacity":new Xe(W.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xe(W.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xe(W.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xe(W.paint_raster["raster-brightness-max"]),"raster-saturation":new Xe(W.paint_raster["raster-saturation"]),"raster-contrast":new Xe(W.paint_raster["raster-contrast"]),"raster-resampling":new Xe(W.paint_raster["raster-resampling"]),"raster-fade-duration":new Xe(W.paint_raster["raster-fade-duration"])})},CT=function(s){function l(u){s.call(this,u,ix)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(wi),Kg=function(s){function l(u){s.call(this,u,{}),this.implementation=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},l.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},l.prototype.recalculate=function(){},l.prototype.updateTransitions=function(){},l.prototype.hasTransition=function(){},l.prototype.serialize=function(){},l.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},l.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},l}(wi),a2={circle:jd,heatmap:w0,hillshade:E0,fill:A0,"fill-extrusion":vf,line:dT,symbol:tx,background:rx,raster:CT},Tf=ft.HTMLImageElement,ox=ft.HTMLCanvasElement,hv=ft.HTMLVideoElement,fv=ft.ImageData,fl=ft.ImageBitmap,ia=function(s,l,u,m){this.context=s,this.format=u,this.texture=s.gl.createTexture(),this.update(l,m)};ia.prototype.update=function(s,l,u){var m=s.width,y=s.height,b=!(this.size&&this.size[0]===m&&this.size[1]===y||u),E=this.context,S=E.gl;if(this.useMipmap=!(!l||!l.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!l||!1!==l.premultiply)),b)this.size=[m,y],s instanceof Tf||s instanceof ox||s instanceof hv||s instanceof fv||fl&&s instanceof fl?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,s):S.texImage2D(S.TEXTURE_2D,0,this.format,m,y,0,this.format,S.UNSIGNED_BYTE,s.data);else{var k=u||{x:0,y:0},R=k.x,P=k.y;s instanceof Tf||s instanceof ox||s instanceof hv||s instanceof fv||fl&&s instanceof fl?S.texSubImage2D(S.TEXTURE_2D,0,R,P,S.RGBA,S.UNSIGNED_BYTE,s):S.texSubImage2D(S.TEXTURE_2D,0,R,P,m,y,S.RGBA,S.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},ia.prototype.bind=function(s,l,u){var m=this.context.gl;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||s),this.filter=s),l!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,l),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,l),this.wrap=l)},ia.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ia.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ti=function(s){var l=this;this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){l._triggered=!1,l._callback()})};ti.prototype.trigger=function(){var s=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){s._triggered=!1,s._callback()},0))},ti.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Sf=function(s,l,u){this.target=s,this.parent=l,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ga(["receive","process"],this),this.invoker=new ti(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ys()?s:ft};function Vr(s,l,u){var m=2*Math.PI*6378137/256/Math.pow(2,u);return[s*m-2*Math.PI*6378137/2,l*m-2*Math.PI*6378137/2]}Sf.prototype.send=function(s,l,u,m,y){var b=this;void 0===y&&(y=!1);var E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[E]=u);var S=_a(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:s,hasCallback:!!u,targetMapId:m,mustQueue:y,sourceMapId:this.mapId,data:Do(l,S)},S),{cancel:function(){u&&delete b.callbacks[E],b.target.postMessage({id:E,type:"<cancel>",targetMapId:m,sourceMapId:b.mapId})}}},Sf.prototype.receive=function(s){var l=s.data,u=l.id;if(u&&(!l.targetMapId||this.mapId===l.targetMapId))if("<cancel>"===l.type){delete this.tasks[u];var m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m()}else ys()||l.mustQueue?(this.tasks[u]=l,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,l)},Sf.prototype.process=function(){if(this.taskQueue.length){var s=this.taskQueue.shift(),l=this.tasks[s];delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),l&&this.processTask(s,l)}},Sf.prototype.processTask=function(s,l){var u=this;if("<response>"===l.type){var m=this.callbacks[s];delete this.callbacks[s],m&&(l.error?m(Oi(l.error)):m(null,Oi(l.data)))}else{var y=!1,b=_a(this.globalScope)?void 0:[],E=l.hasCallback?function(P,N){y=!0,delete u.cancelCallbacks[s],u.target.postMessage({id:s,type:"<response>",sourceMapId:u.mapId,error:P?Do(P):null,data:Do(N,b)},b)}:function(P){y=!0},S=null,k=Oi(l.data);if(this.parent[l.type])S=this.parent[l.type](l.sourceMapId,k,E);else if(this.parent.getWorkerSource){var R=l.type.split(".");S=this.parent.getWorkerSource(l.sourceMapId,R[0],k.source)[R[1]](k,E)}else E(new Error("Could not find function "+l.type));!y&&S&&S.cancel&&(this.cancelCallbacks[s]=S.cancel)}},Sf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Zr=function(s,l){s&&(l?this.setSouthWest(s).setNorthEast(l):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))};Zr.prototype.setNorthEast=function(s){return this._ne=s instanceof xr?new xr(s.lng,s.lat):xr.convert(s),this},Zr.prototype.setSouthWest=function(s){return this._sw=s instanceof xr?new xr(s.lng,s.lat):xr.convert(s),this},Zr.prototype.extend=function(s){var l,u,m=this._sw,y=this._ne;if(s instanceof xr)l=s,u=s;else{if(!(s instanceof Zr))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(Zr.convert(s)):this.extend(xr.convert(s)):this;if(u=s._ne,!(l=s._sw)||!u)return this}return m||y?(m.lng=Math.min(l.lng,m.lng),m.lat=Math.min(l.lat,m.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new xr(l.lng,l.lat),this._ne=new xr(u.lng,u.lat)),this},Zr.prototype.getCenter=function(){return new xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Zr.prototype.getSouthWest=function(){return this._sw},Zr.prototype.getNorthEast=function(){return this._ne},Zr.prototype.getNorthWest=function(){return new xr(this.getWest(),this.getNorth())},Zr.prototype.getSouthEast=function(){return new xr(this.getEast(),this.getSouth())},Zr.prototype.getWest=function(){return this._sw.lng},Zr.prototype.getSouth=function(){return this._sw.lat},Zr.prototype.getEast=function(){return this._ne.lng},Zr.prototype.getNorth=function(){return this._ne.lat},Zr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Zr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Zr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Zr.prototype.contains=function(s){var l=xr.convert(s),u=l.lng,m=l.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&y},Zr.convert=function(s){return!s||s instanceof Zr?s:new Zr(s)};var xr=function(s,l){if(isNaN(s)||isNaN(l))throw new Error("Invalid LngLat object: ("+s+", "+l+")");if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};xr.prototype.wrap=function(){return new xr(wu(this.lng,-180,180),this.lat)},xr.prototype.toArray=function(){return[this.lng,this.lat]},xr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},xr.prototype.distanceTo=function(s){var l=Math.PI/180,u=this.lat*l,m=s.lat*l,y=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((s.lng-this.lng)*l);return 6371008.8*Math.acos(Math.min(y,1))},xr.prototype.toBounds=function(s){void 0===s&&(s=0);var l=360*s/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new Zr(new xr(this.lng-u,this.lat-l),new xr(this.lng+u,this.lat+l))},xr.convert=function(s){if(s instanceof xr)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new xr(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new xr(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var pv=2*Math.PI*6371008.8;function If(s){return pv*Math.cos(s*Math.PI/180)}function sx(s){return(180+s)/360}function mv(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Yg(s,l){return s/If(l)}function kf(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}var Qu=function(s,l,u){void 0===u&&(u=0),this.x=+s,this.y=+l,this.z=+u};Qu.fromLngLat=function(s,l){void 0===l&&(l=0);var u=xr.convert(s);return new Qu(sx(u.lng),mv(u.lat),Yg(l,u.lat))},Qu.prototype.toLngLat=function(){return new xr(360*this.x-180,kf(this.y))},Qu.prototype.toAltitude=function(){return this.z*If(kf(this.y))},Qu.prototype.meterInMercatorCoordinateUnits=function(){return 1/pv*(s=kf(this.y),1/Math.cos(s*Math.PI/180));var s};var Jd=function(s,l,u){this.z=s,this.x=l,this.y=u,this.key=Af(0,s,s,l,u)};Jd.prototype.equals=function(s){return this.z===s.z&&this.x===s.x&&this.y===s.y},Jd.prototype.url=function(s,l){var u,m,y,b,E,S=(m=this.y,y=this.z,b=Vr(256*(u=this.x),256*(m=Math.pow(2,y)-m-1),y),E=Vr(256*(u+1),256*(m+1),y),b[0]+","+b[1]+","+E[0]+","+E[1]),k=function(R,P,N){for(var V,H="",X=R;X>0;X--)H+=(P&(V=1<<X-1)?1:0)+(N&V?2:0);return H}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",k).replace("{bbox-epsg-3857}",S)},Jd.prototype.getTilePoint=function(s){var l=Math.pow(2,this.z);return new Vt(8192*(s.x*l-this.x),8192*(s.y*l-this.y))},Jd.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var ax=function(s,l){this.wrap=s,this.canonical=l,this.key=Af(s,l.z,l.z,l.x,l.y)},hi=function(s,l,u,m,y){this.overscaledZ=s,this.wrap=l,this.canonical=new Jd(u,+m,+y),this.key=Af(l,s,u,m,y)};function Af(s,l,u,m,y){(s*=2)<0&&(s=-1*s-1);var b=1<<u;return(b*b*s+b*y+m).toString(36)+u.toString(36)+l.toString(36)}hi.prototype.equals=function(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)},hi.prototype.scaledTo=function(s){var l=this.canonical.z-s;return s>this.canonical.z?new hi(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new hi(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)},hi.prototype.calculateScaledKey=function(s,l){var u=this.canonical.z-s;return s>this.canonical.z?Af(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):Af(this.wrap*+l,s,s,this.canonical.x>>u,this.canonical.y>>u)},hi.prototype.isChildOf=function(s){if(s.wrap!==this.wrap)return!1;var l=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l},hi.prototype.children=function(s){if(this.overscaledZ>=s)return[new hi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var l=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new hi(l,this.wrap,l,u,m),new hi(l,this.wrap,l,u+1,m),new hi(l,this.wrap,l,u,m+1),new hi(l,this.wrap,l,u+1,m+1)]},hi.prototype.isLessThan=function(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))},hi.prototype.wrapped=function(){return new hi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},hi.prototype.unwrapTo=function(s){return new hi(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)},hi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},hi.prototype.toUnwrapped=function(){return new ax(this.wrap,this.canonical)},hi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},hi.prototype.getTilePoint=function(s){return this.canonical.getTilePoint(new Qu(s.x-this.wrap,s.y))},nt("CanonicalTileID",Jd),nt("OverscaledTileID",hi,{omit:["posMatrix"]});var Yc=function(s,l,u){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return lr('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=l.height;var m=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=u||"mapbox";for(var y=0;y<m;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(m,y)]=this.data[this._idx(m-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,m)]=this.data[this._idx(y,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)]};Yc.prototype.get=function(s,l){var u=new Uint8Array(this.data.buffer),m=4*this._idx(s,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[m],u[m+1],u[m+2])},Yc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Yc.prototype._idx=function(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)},Yc.prototype._unpackMapbox=function(s,l,u){return(256*s*256+256*l+u)/10-1e4},Yc.prototype._unpackTerrarium=function(s,l,u){return 256*s+l+u/256-32768},Yc.prototype.getPixels=function(){return new ss({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Yc.prototype.backfillBorder=function(s,l,u){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");var m=l*this.dim,y=l*this.dim+this.dim,b=u*this.dim,E=u*this.dim+this.dim;switch(l){case-1:m=y-1;break;case 1:y=m+1}switch(u){case-1:b=E-1;break;case 1:E=b+1}for(var S=-l*this.dim,k=-u*this.dim,R=b;R<E;R++)for(var P=m;P<y;P++)this.data[this._idx(P,R)]=s.data[this._idx(P+S,R+k)]},nt("DEMData",Yc);var em=function(s){this._stringToNumber={},this._numberToString=[];for(var l=0;l<s.length;l++){var u=s[l];this._stringToNumber[u]=l,this._numberToString[l]=u}};em.prototype.encode=function(s){return this._stringToNumber[s]},em.prototype.decode=function(s){return this._numberToString[s]};var Xg=function(s,l,u,m,y){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=u,s._y=m,this.properties=s.properties,this.id=y},gv={geometry:{configurable:!0}};gv.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},gv.geometry.set=function(s){this._geometry=s},Xg.prototype.toJSON=function(){var s={geometry:this.geometry};for(var l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(s[l]=this[l]);return s},Object.defineProperties(Xg.prototype,gv);var tm=function(){this.state={},this.stateChanges={},this.deletedStates={}};tm.prototype.updateState=function(s,l,u){var m=String(l);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},ki(this.stateChanges[s][m],u),null===this.deletedStates[s])for(var y in this.deletedStates[s]={},this.state[s])y!==m&&(this.deletedStates[s][y]=null);else if(this.deletedStates[s]&&null===this.deletedStates[s][m])for(var b in this.deletedStates[s][m]={},this.state[s][m])u[b]||(this.deletedStates[s][m][b]=null);else for(var E in u)this.deletedStates[s]&&this.deletedStates[s][m]&&null===this.deletedStates[s][m][E]&&delete this.deletedStates[s][m][E]},tm.prototype.removeFeatureState=function(s,l,u){if(null!==this.deletedStates[s]){var m=String(l);if(this.deletedStates[s]=this.deletedStates[s]||{},u&&void 0!==l)null!==this.deletedStates[s][m]&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][u]=null);else if(void 0!==l)if(this.stateChanges[s]&&this.stateChanges[s][m])for(u in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][u]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}},tm.prototype.getState=function(s,l){var u=String(l),m=ki({},(this.state[s]||{})[u],(this.stateChanges[s]||{})[u]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){var y=this.deletedStates[s][l];if(null===y)return{};for(var b in y)delete m[b]}return m},tm.prototype.initializeTileState=function(s,l){s.setFeatureState(this.state,l)},tm.prototype.coalesceChanges=function(s,l){var u={};for(var m in this.stateChanges){this.state[m]=this.state[m]||{};var y={};for(var b in this.stateChanges[m])this.state[m][b]||(this.state[m][b]={}),ki(this.state[m][b],this.stateChanges[m][b]),y[b]=this.state[m][b];u[m]=y}for(var E in this.deletedStates){this.state[E]=this.state[E]||{};var S={};if(null===this.deletedStates[E])for(var k in this.state[E])S[k]={},this.state[E][k]={};else for(var R in this.deletedStates[E]){if(null===this.deletedStates[E][R])this.state[E][R]={};else for(var P=0,N=Object.keys(this.deletedStates[E][R]);P<N.length;P+=1)delete this.state[E][R][N[P]];S[R]=this.state[E][R]}u[E]=u[E]||{},ki(u[E],S)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var V in s)s[V].setFeatureState(u,l)};var Xc=function(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Pi(8192,16,0),this.grid3D=new Pi(8192,16,0),this.featureIndexArray=new $,this.promoteId=l};function eh(s,l,u,m,y){return Ai(s,function(b,E){var S=l instanceof Ts?l.get(E):null;return S&&S.evaluate?S.evaluate(u,m,y):S})}function Pr(s){for(var l=1/0,u=1/0,m=-1/0,y=-1/0,b=0,E=s;b<E.length;b+=1){var S=E[b];l=Math.min(l,S.x),u=Math.min(u,S.y),m=Math.max(m,S.x),y=Math.max(y,S.y)}return{minX:l,minY:u,maxX:m,maxY:y}}function lx(s,l){return l-s}Xc.prototype.insert=function(s,l,u,m,y,b){var E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,y);for(var S=b?this.grid3D:this.grid,k=0;k<l.length;k++){for(var R=l[k],P=[1/0,1/0,-1/0,-1/0],N=0;N<R.length;N++){var V=R[N];P[0]=Math.min(P[0],V.x),P[1]=Math.min(P[1],V.y),P[2]=Math.max(P[2],V.x),P[3]=Math.max(P[3],V.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&S.insert(E,P[0],P[1],P[2],P[3])}},Xc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Zp.VectorTile(new Zc(this.rawTileData)).layers,this.sourceLayerCoder=new em(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Xc.prototype.query=function(s,l,u,m){var y=this;this.loadVTLayers();for(var b=s.params||{},E=8192/s.tileSize/s.scale,S=Cs(b.filter),k=s.queryGeometry,R=s.queryPadding*E,P=Pr(k),N=this.grid.query(P.minX-R,P.minY-R,P.maxX+R,P.maxY+R),V=Pr(s.cameraQueryGeometry),X=0,Y=this.grid3D.query(V.minX-R,V.minY-R,V.maxX+R,V.maxY+R,function(Te,Se,Oe,Ge){return function(Qe,pt,et,wt,tt){for(var sn=0,Mt=Qe;sn<Mt.length;sn+=1){var ht=Mt[sn];if(pt<=ht.x&&et<=ht.y&&wt>=ht.x&&tt>=ht.y)return!0}var un=[new Vt(pt,et),new Vt(pt,tt),new Vt(wt,tt),new Vt(wt,et)];if(Qe.length>2)for(var Yt=0,vn=un;Yt<vn.length;Yt+=1)if(ra(Qe,vn[Yt]))return!0;for(var xt=0;xt<Qe.length-1;xt++)if(Gc(Qe[xt],Qe[xt+1],un))return!0;return!1}(s.cameraQueryGeometry,Te-R,Se-R,Oe+R,Ge+R)});X<Y.length;X+=1)N.push(Y[X]);N.sort(lx);for(var ce,le={},pe=function(Te){var Se=N[Te];if(Se!==ce){ce=Se;var Oe=y.featureIndexArray.get(Se),Ge=null;y.loadMatchingFeature(le,Oe.bucketIndex,Oe.sourceLayerIndex,Oe.featureIndex,S,b.layers,b.availableImages,l,u,m,function(Qe,pt,et){return Ge||(Ge=Wr(Qe)),pt.queryIntersectsFeature(k,Qe,et,Ge,y.z,s.transform,E,s.pixelPosMatrix)})}},fe=0;fe<N.length;fe++)pe(fe);return le},Xc.prototype.loadMatchingFeature=function(s,l,u,m,y,b,E,S,k,R,P){var N=this.bucketLayerIDs[l];if(!b||function(Qe,pt){for(var et=0;et<Qe.length;et++)if(pt.indexOf(Qe[et])>=0)return!0;return!1}(b,N)){var V=this.sourceLayerCoder.decode(u),H=this.vtLayers[V].feature(m);if(y.needGeometry){var X=To(H,!0);if(!y.filter(new Ut(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!y.filter(new Ut(this.tileID.overscaledZ),H))return;for(var Y=this.getId(H,V),ce=0;ce<N.length;ce++){var le=N[ce];if(!(b&&b.indexOf(le)<0)){var pe=S[le];if(pe){var fe={};void 0!==Y&&R&&(fe=R.getState(pe.sourceLayer||"_geojsonTileLayer",Y));var Te=ki({},k[le]);Te.paint=eh(Te.paint,pe.paint,H,fe,E),Te.layout=eh(Te.layout,pe.layout,H,fe,E);var Se=!P||P(H,pe,fe);if(Se){var Oe=new Xg(H,this.z,this.x,this.y,Y);Oe.layer=Te;var Ge=s[le];void 0===Ge&&(Ge=s[le]=[]),Ge.push({featureIndex:m,feature:Oe,intersectionZ:Se})}}}}}},Xc.prototype.lookupSymbolFeatures=function(s,l,u,m,y,b,E,S){var k={};this.loadVTLayers();for(var R=Cs(y),P=0,N=s;P<N.length;P+=1)this.loadMatchingFeature(k,u,m,N[P],R,b,E,S,l);return k},Xc.prototype.hasLayer=function(s){for(var l=0,u=this.bucketLayerIDs;l<u.length;l+=1)for(var m=0,y=u[l];m<y.length;m+=1)if(s===y[m])return!0;return!1},Xc.prototype.getId=function(s,l){var u=s.id;return this.promoteId&&"boolean"==typeof(u=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]])&&(u=Number(u)),u},nt("FeatureIndex",Xc,{omit:["rawTileData","sourceLayerCoder"]});var ji=function(s,l){this.tileID=s,this.uid=Ja(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ji.prototype.registerFadeDuration=function(s){var l=s+this.timeAdded;l<tl.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)},ji.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ji.prototype.loadVectorData=function(s,l,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){for(var m in s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(R,P){var N={};if(!P)return N;for(var V=function(){var Y=X[H],ce=Y.layerIds.map(function(fe){return P.getLayer(fe)}).filter(Boolean);if(0!==ce.length){Y.layers=ce,Y.stateDependentLayerIds&&(Y.stateDependentLayers=Y.stateDependentLayerIds.map(function(fe){return ce.filter(function(Te){return Te.id===fe})[0]}));for(var le=0,pe=ce;le<pe.length;le+=1)N[pe[le].id]=Y}},H=0,X=R;H<X.length;H+=1)V();return N}(s.buckets,l.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[m];if(y instanceof Gn){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var E=this.buckets[b];if(E instanceof Gn&&E.hasRTLText){this.hasRTLText=!0,Qn.isLoading()||Qn.isLoaded()||"deferred"!==lo()||zd();break}}for(var S in this.queryPadding=0,this.buckets){var k=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(S).queryRadius(k))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new h},ji.prototype.unloadVectorData=function(){for(var s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ji.prototype.getBucket=function(s){return this.buckets[s.id]},ji.prototype.upload=function(s){for(var l in this.buckets){var u=this.buckets[l];u.uploadPending()&&u.upload(s)}var m=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ia(s,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ia(s,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)},ji.prototype.prepare=function(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)},ji.prototype.queryRenderedFeatures=function(s,l,u,m,y,b,E,S,k,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:R,transform:S,params:E,queryPadding:this.queryPadding*k},s,l,u):{}},ji.prototype.querySourceFeatures=function(s,l){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var m=u.loadVTLayers(),y=l?l.sourceLayer:"",b=m._geojsonTileLayer||m[y];if(b)for(var E=Cs(l&&l.filter),S=this.tileID.canonical,k=S.z,R=S.x,P=S.y,N={z:k,x:R,y:P},V=0;V<b.length;V++){var H=b.feature(V);if(E.needGeometry){var X=To(H,!0);if(!E.filter(new Ut(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!E.filter(new Ut(this.tileID.overscaledZ),H))continue;var Y=u.getId(H,y),ce=new Xg(H,k,R,P,Y);ce.tile=N,s.push(ce)}}},ji.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ji.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ji.prototype.setExpiryData=function(s){var l=this.expirationTime;if(s.cacheControl){var u=Nl(s.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){var m=Date.now(),y=!1;if(this.expirationTime>m)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{var b=this.expirationTime-l;b?this.expirationTime=m+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ji.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ji.prototype.setFeatureState=function(s,l){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(s).length){var u=this.latestFeatureIndex.loadVTLayers();for(var m in this.buckets)if(l.style.hasLayer(m)){var y=this.buckets[m],b=y.layers[0].sourceLayer||"_geojsonTileLayer",E=u[b],S=s[b];if(E&&S&&0!==Object.keys(S).length){y.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});var k=l&&l.style&&l.style.getLayer(m);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}}},ji.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ji.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<tl.now()},ji.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ji.prototype.setHoldDuration=function(s){this.symbolFadeHoldUntil=tl.now()+s},ji.prototype.setDependencies=function(s,l){for(var u={},m=0,y=l;m<y.length;m+=1)u[y[m]]=!0;this.dependencies[s]=u},ji.prototype.hasDependency=function(s,l){for(var u=0,m=s;u<m.length;u+=1){var y=this.dependencies[m[u]];if(y)for(var b=0,E=l;b<E.length;b+=1)if(y[E[b]])return!0}return!1};var Ju=ft.performance,cx=function(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},Ju.mark(this._marks.start)};cx.prototype.finish=function(){Ju.mark(this._marks.end);var s=Ju.getEntriesByName(this._marks.measure);return 0===s.length&&(Ju.measure(this._marks.measure,this._marks.start,this._marks.end),s=Ju.getEntriesByName(this._marks.measure),Ju.clearMarks(this._marks.start),Ju.clearMarks(this._marks.end),Ju.clearMeasures(this._marks.measure)),s},v.Actor=Sf,v.AlphaImage=nc,v.CanonicalTileID=Jd,v.CollisionBoxArray=h,v.Color=mn,v.DEMData=Yc,v.DataConstantProperty=Xe,v.DictionaryCoder=em,v.EXTENT=8192,v.ErrorEvent=he,v.EvaluationParameters=Ut,v.Event=ue,v.Evented=K,v.FeatureIndex=Xc,v.FillBucket=dl,v.FillExtrusionBucket=rc,v.ImageAtlas=xf,v.ImagePosition=wf,v.LineBucket=$o,v.LngLat=xr,v.LngLatBounds=Zr,v.MercatorCoordinate=Qu,v.ONE_EM=24,v.OverscaledTileID=hi,v.Point=Vt,v.Point$1=Vt,v.Properties=ci,v.Protobuf=Zc,v.RGBAImage=ss,v.RequestManager=Eo,v.RequestPerformance=cx,v.ResourceType=Su,v.SegmentVector=j,v.SourceFeatureState=tm,v.StructArrayLayout1ui2=Up,v.StructArrayLayout2f1f2i16=Uu,v.StructArrayLayout2i4=zu,v.StructArrayLayout3ui6=zs,v.StructArrayLayout4i8=Ji,v.SymbolBucket=Gn,v.Texture=ia,v.Tile=ji,v.Transitionable=ai,v.Uniform1f=He,v.Uniform1i=Ze,v.Uniform2f=rt,v.Uniform3f=gt,v.Uniform4f=bt,v.UniformColor=vt,v.UniformMatrix4f=st,v.UnwrappedTileID=ax,v.ValidationError=re,v.WritingMode=Hs,v.ZoomHistory=ao,v.add=function(s,l,u){return s[0]=l[0]+u[0],s[1]=l[1]+u[1],s[2]=l[2]+u[2],s},v.addDynamicAttributes=Fa,v.asyncAll=function(s,l,u){if(!s.length)return u(null,[]);var m=s.length,y=new Array(s.length),b=null;s.forEach(function(E,S){l(E,function(k,R){k&&(b=k),y[S]=R,0==--m&&u(b,y)})})},v.bezier=wo,v.bindAll=ga,v.browser=tl,v.cacheEntryPossiblyAdded=function(s){++Bl>qh&&(s.getActor().send("enforceCacheSizeLimit",Du),Bl=0)},v.clamp=Wi,v.clearTileCache=function(s){var l=ft.caches.delete("mapbox-tiles");s&&l.catch(s).then(function(){return s()})},v.clipLine=cv,v.clone=function(s){var l=new Mn(16);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l},v.clone$1=Os,v.clone$2=function(s){var l=new Mn(3);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l},v.collisionCircleLayout=hT,v.config=Yn,v.create=function(){var s=new Mn(16);return Mn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},v.create$1=function(){var s=new Mn(9);return Mn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s},v.create$2=function(){var s=new Mn(4);return Mn!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},v.createCommonjsModule=zo,v.createExpression=ka,v.createLayout=_n,v.createStyleLayer=function(s){return"custom"===s.type?new Kg(s):new a2[s.type](s)},v.cross=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=u[0],S=u[1],k=u[2];return s[0]=y*k-b*S,s[1]=b*E-m*k,s[2]=m*S-y*E,s},v.deepEqual=function s(l,u){if(Array.isArray(l)){if(!Array.isArray(u)||l.length!==u.length)return!1;for(var m=0;m<l.length;m++)if(!s(l[m],u[m]))return!1;return!0}if("object"==typeof l&&null!==l&&null!==u){if("object"!=typeof u||Object.keys(l).length!==Object.keys(u).length)return!1;for(var y in l)if(!s(l[y],u[y]))return!1;return!0}return l===u},v.dot=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]},v.dot$1=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]+s[3]*l[3]},v.ease=Ac,v.emitValidationErrors=Js,v.endsWith=Rc,v.enforceCacheSizeLimit=function(s){Tu(),bs&&bs.then(function(l){l.keys().then(function(u){for(var m=0;m<u.length-s;m++)l.delete(u[m])})})},v.evaluateSizeForFeature=Kp,v.evaluateSizeForZoom=Yp,v.evaluateVariableOffset=Q0,v.evented=Kt,v.extend=ki,v.featureFilter=Cs,v.filterObject=_s,v.fromRotation=function(s,l){var u=Math.sin(l),m=Math.cos(l);return s[0]=m,s[1]=u,s[2]=0,s[3]=-u,s[4]=m,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},v.getAnchorAlignment=iv,v.getAnchorJustification=Xd,v.getArrayBuffer=Xn,v.getImage=U,v.getJSON=function(s,l){return zl(ki(s,{type:"json"}),l)},v.getRTLTextPluginStatus=lo,v.getReferrer=ol,v.getVideo=function(s,l){var u,m,y=ft.document.createElement("video");y.muted=!0,y.onloadstart=function(){l(null,y)};for(var b=0;b<s.length;b++){var E=ft.document.createElement("source");u=s[b],m=void 0,(m=ft.document.createElement("a")).href=u,(m.protocol!==ft.document.location.protocol||m.host!==ft.document.location.host)&&(y.crossOrigin="Anonymous"),E.src=s[b],y.appendChild(E)}return{cancel:function(){}}},v.identity=Mr,v.invert=function(s,l){var u=l[0],m=l[1],y=l[2],b=l[3],E=l[4],S=l[5],k=l[6],R=l[7],P=l[8],N=l[9],V=l[10],H=l[11],X=l[12],Y=l[13],ce=l[14],le=l[15],pe=u*S-m*E,fe=u*k-y*E,Te=u*R-b*E,Se=m*k-y*S,Oe=m*R-b*S,Ge=y*R-b*k,Qe=P*Y-N*X,pt=P*ce-V*X,et=P*le-H*X,wt=N*ce-V*Y,tt=N*le-H*Y,sn=V*le-H*ce,Mt=pe*sn-fe*tt+Te*wt+Se*et-Oe*pt+Ge*Qe;return Mt?(s[0]=(S*sn-k*tt+R*wt)*(Mt=1/Mt),s[1]=(y*tt-m*sn-b*wt)*Mt,s[2]=(Y*Ge-ce*Oe+le*Se)*Mt,s[3]=(V*Oe-N*Ge-H*Se)*Mt,s[4]=(k*et-E*sn-R*pt)*Mt,s[5]=(u*sn-y*et+b*pt)*Mt,s[6]=(ce*Te-X*Ge-le*fe)*Mt,s[7]=(P*Ge-V*Te+H*fe)*Mt,s[8]=(E*tt-S*et+R*Qe)*Mt,s[9]=(m*et-u*tt-b*Qe)*Mt,s[10]=(X*Oe-Y*Te+le*pe)*Mt,s[11]=(N*Te-P*Oe-H*pe)*Mt,s[12]=(S*pt-E*wt-k*Qe)*Mt,s[13]=(u*wt-m*pt+y*Qe)*Mt,s[14]=(Y*fe-X*Se-ce*pe)*Mt,s[15]=(P*Se-N*fe+V*pe)*Mt,s):null},v.isChar=lt,v.isMapboxURL=Ls,v.keysDifference=function(s,l){var u=[];for(var m in s)m in l||u.push(m);return u},v.makeRequest=zl,v.mapObject=Ai,v.mercatorXfromLng=sx,v.mercatorYfromLat=mv,v.mercatorZfromAltitude=Yg,v.mul=ul,v.multiply=Hu,v.mvt=Zp,v.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},v.normalize=function(s,l){var u=l[0],m=l[1],y=l[2],b=u*u+m*m+y*y;return b>0&&(b=1/Math.sqrt(b)),s[0]=l[0]*b,s[1]=l[1]*b,s[2]=l[2]*b,s},v.number=si,v.offscreenCanvasSupported=Sd,v.ortho=function(s,l,u,m,y,b,E){var S=1/(l-u),k=1/(m-y),R=1/(b-E);return s[0]=-2*S,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*k,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*R,s[11]=0,s[12]=(l+u)*S,s[13]=(y+m)*k,s[14]=(E+b)*R,s[15]=1,s},v.parseGlyphPBF=function(s){return new Zc(s).readFields(vT,[])},v.pbf=Zc,v.performSymbolLayout=function(s,l,u,m,y,b,E){s.createArrays(),s.tilePixelRatio=8192/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;var S=s.layers[0].layout,k=s.layers[0]._unevaluatedLayout._values,R={};if("composite"===s.textSizeData.kind){var P=s.textSizeData,N=P.maxZoom;R.compositeTextSizes=[k["text-size"].possiblyEvaluate(new Ut(P.minZoom),E),k["text-size"].possiblyEvaluate(new Ut(N),E)]}if("composite"===s.iconSizeData.kind){var V=s.iconSizeData,H=V.maxZoom;R.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new Ut(V.minZoom),E),k["icon-size"].possiblyEvaluate(new Ut(H),E)]}R.layoutTextSize=k["text-size"].possiblyEvaluate(new Ut(s.zoom+1),E),R.layoutIconSize=k["icon-size"].possiblyEvaluate(new Ut(s.zoom+1),E),R.textMaxSize=k["text-size"].possiblyEvaluate(new Ut(18));for(var X=24*S.get("text-line-height"),Y="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),ce=S.get("text-keep-upright"),le=S.get("text-size"),pe=function(){var Se=Te[fe],Oe=S.get("text-font").evaluate(Se,{},E).join(","),Ge=le.evaluate(Se,{},E),Qe=R.layoutTextSize.evaluate(Se,{},E),pt=R.layoutIconSize.evaluate(Se,{},E),et={horizontal:{},vertical:void 0},wt=Se.text,tt=[0,0];if(wt){var sn=wt.toString(),Mt=24*S.get("text-letter-spacing").evaluate(Se,{},E),ht=function(fn){for(var nr=0,Wn=fn;nr<Wn.length;nr+=1)if(Dn=Wn[nr].charCodeAt(0),lt.Arabic(Dn)||lt["Arabic Supplement"](Dn)||lt["Arabic Extended-A"](Dn)||lt["Arabic Presentation Forms-A"](Dn)||lt["Arabic Presentation Forms-B"](Dn))return!1;var Dn;return!0}(sn)?Mt:0,un=S.get("text-anchor").evaluate(Se,{},E),Yt=S.get("text-variable-anchor");if(!Yt){var vn=S.get("text-radial-offset").evaluate(Se,{},E);tt=vn?Q0(un,[24*vn,Yd]):S.get("text-offset").evaluate(Se,{},E).map(function(fn){return 24*fn})}var xt=Y?"center":S.get("text-justify").evaluate(Se,{},E),Cn=S.get("symbol-placement"),gr="point"===Cn?24*S.get("text-max-width").evaluate(Se,{},E):0,Or=function(){s.allowVerticalPlacement&&Gr(sn)&&(et.vertical=Ug(wt,l,u,y,Oe,gr,X,un,"left",ht,tt,Hs.vertical,!0,Cn,Qe,Ge))};if(!Y&&Yt){for(var Ir="auto"===xt?Yt.map(function(fn){return Xd(fn)}):[xt],_r=!1,zr=0;zr<Ir.length;zr++){var Ei=Ir[zr];if(!et.horizontal[Ei])if(_r)et.horizontal[Ei]=et.horizontal[0];else{var Ci=Ug(wt,l,u,y,Oe,gr,X,"center",Ei,ht,tt,Hs.horizontal,!1,Cn,Qe,Ge);Ci&&(et.horizontal[Ei]=Ci,_r=1===Ci.positionedLines.length)}}Or()}else{"auto"===xt&&(xt=Xd(un));var Ao=Ug(wt,l,u,y,Oe,gr,X,un,xt,ht,tt,Hs.horizontal,!1,Cn,Qe,Ge);Ao&&(et.horizontal[xt]=Ao),Or(),Gr(sn)&&Y&&ce&&(et.vertical=Ug(wt,l,u,y,Oe,gr,X,un,xt,ht,tt,Hs.vertical,!1,Cn,Qe,Ge))}}var fn,nr,Dn,po,mo,Hi=void 0,Ro=!1;if(Se.icon&&Se.icon.name){var Kr=m[Se.icon.name];Kr&&(fn=y[Se.icon.name],nr=S.get("icon-offset").evaluate(Se,{},E),Dn=iv(S.get("icon-anchor").evaluate(Se,{},E)),Hi={image:fn,top:mo=nr[1]-fn.displaySize[1]*Dn.verticalAlign,bottom:mo+fn.displaySize[1],left:po=nr[0]-fn.displaySize[0]*Dn.horizontalAlign,right:po+fn.displaySize[0]},Ro=Kr.sdf,void 0===s.sdfIcons?s.sdfIcons=Kr.sdf:s.sdfIcons!==Kr.sdf&&lr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Kr.pixelRatio!==s.pixelRatio||0!==S.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}var Di=Qp(et.horizontal)||et.vertical;s.iconsInText=!!Di&&Di.iconsInText,(Di||Hi)&&function(fn,nr,Wn,Dn,po,mo,Zn,yr,go,On,pl){var cs=mo.textMaxSize.evaluate(nr,{});void 0===cs&&(cs=Zn);var oa,Nr=fn.layers[0].layout,sc=Nr.get("icon-offset").evaluate(nr,{},pl),Ba=Qp(Wn.horizontal),nm=Zn/24,ml=fn.tilePixelRatio*nm,th=fn.tilePixelRatio*cs/24,ac=fn.tilePixelRatio*yr,nh=fn.tilePixelRatio*Nr.get("symbol-spacing"),Rf=Nr.get("text-padding")*fn.tilePixelRatio,rh=Nr.get("icon-padding")*fn.tilePixelRatio,Mf=Nr.get("text-max-angle")/180*Math.PI,Qg="map"===Nr.get("text-rotation-alignment")&&"point"!==Nr.get("symbol-placement"),Pf="map"===Nr.get("icon-rotation-alignment")&&"point"!==Nr.get("symbol-placement"),lc=Nr.get("symbol-placement"),cc=nh/2,Of=Nr.get("icon-text-fit");Dn&&"none"!==Of&&(fn.allowVerticalPlacement&&Wn.vertical&&(oa=_t(Dn,Wn.vertical,Of,Nr.get("icon-text-fit-padding"),sc,nm)),Ba&&(Dn=_t(Dn,Ba,Of,Nr.get("icon-text-fit-padding"),sc,nm)));var Qc=function(r_,sh){sh.x<0||sh.x>=8192||sh.y<0||sh.y>=8192||function(Ur,Va,DT,ed,i_,o_,yv,eu,s_,a_,l_,vv,ux,c_,u_,bv,wv,dx,TT,tu,sa,ah,hx,dc,fx){var hm,lh,td,Vf,ch,zf=Ur.addToLineVertexArray(Va,DT),ST=0,xv=0,px=0,mx=0,Ev=-1,uh=-1,hc={},d_=ie(""),Cv=0,gx=0;if(void 0===eu._unevaluatedLayout.getValue("text-radial-offset")?(Cv=(hm=eu.layout.get("text-offset").evaluate(sa,{},dc).map(function(__){return 24*__}))[0],gx=hm[1]):(Cv=24*eu.layout.get("text-radial-offset").evaluate(sa,{},dc),gx=Yd),Ur.allowVerticalPlacement&&ed.vertical){var IT=eu.layout.get("text-rotate").evaluate(sa,{},dc)+90;Vf=new qg(s_,Va,a_,l_,vv,ed.vertical,ux,c_,u_,IT),yv&&(ch=new qg(s_,Va,a_,l_,vv,yv,wv,dx,u_,IT))}if(i_){var _x=eu.layout.get("icon-rotate").evaluate(sa,{}),Uf="none"!==eu.layout.get("icon-text-fit"),yx=xT(i_,_x,hx,Uf),jf=yv?xT(yv,_x,hx,Uf):void 0;td=new qg(s_,Va,a_,l_,vv,i_,wv,dx,!1,_x),ST=4*yx.length;var h_=Ur.iconSizeData,Hf=null;"source"===h_.kind?(Hf=[128*eu.layout.get("icon-size").evaluate(sa,{})])[0]>32640&&lr(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===h_.kind&&((Hf=[128*ah.compositeIconSizes[0].evaluate(sa,{},dc),128*ah.compositeIconSizes[1].evaluate(sa,{},dc)])[0]>32640||Hf[1]>32640)&&lr(Ur.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ur.addSymbols(Ur.icon,yx,Hf,tu,TT,sa,!1,Va,zf.lineStartIndex,zf.lineLength,-1,dc),Ev=Ur.icon.placedSymbolArray.length-1,jf&&(xv=4*jf.length,Ur.addSymbols(Ur.icon,jf,Hf,tu,TT,sa,Hs.vertical,Va,zf.lineStartIndex,zf.lineLength,-1,dc),uh=Ur.icon.placedSymbolArray.length-1)}for(var f_ in ed.horizontal){var Dv=ed.horizontal[f_];if(!lh){d_=ie(Dv.text);var l2=eu.layout.get("text-rotate").evaluate(sa,{},dc);lh=new qg(s_,Va,a_,l_,vv,Dv,ux,c_,u_,l2)}var kT=1===Dv.positionedLines.length;if(px+=Gg(Ur,Va,Dv,o_,eu,u_,sa,bv,zf,ed.vertical?Hs.horizontal:Hs.horizontalOnly,kT?Object.keys(ed.horizontal):[f_],hc,Ev,ah,dc),kT)break}ed.vertical&&(mx+=Gg(Ur,Va,ed.vertical,o_,eu,u_,sa,bv,zf,Hs.vertical,["vertical"],hc,uh,ah,dc));var vx=lh?lh.boxStartIndex:Ur.collisionBoxArray.length,AT=lh?lh.boxEndIndex:Ur.collisionBoxArray.length,bx=Vf?Vf.boxStartIndex:Ur.collisionBoxArray.length,Tv=Vf?Vf.boxEndIndex:Ur.collisionBoxArray.length,wx=td?td.boxStartIndex:Ur.collisionBoxArray.length,p_=td?td.boxEndIndex:Ur.collisionBoxArray.length,m_=ch?ch.boxStartIndex:Ur.collisionBoxArray.length,RT=ch?ch.boxEndIndex:Ur.collisionBoxArray.length,nu=-1,g_=function(__,Sv){return __&&__.circleDiameter?Math.max(__.circleDiameter,Sv):Sv};nu=g_(lh,nu),nu=g_(Vf,nu),nu=g_(td,nu);var xx=(nu=g_(ch,nu))>-1?1:0;xx&&(nu*=fx/24),Ur.glyphOffsetArray.length>=Gn.MAX_GLYPHS&&lr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==sa.sortKey&&Ur.addToSortKeyRanges(Ur.symbolInstances.length,sa.sortKey),Ur.symbolInstances.emplaceBack(Va.x,Va.y,hc.right>=0?hc.right:-1,hc.center>=0?hc.center:-1,hc.left>=0?hc.left:-1,hc.vertical||-1,Ev,uh,d_,vx,AT,bx,Tv,wx,p_,m_,RT,a_,px,mx,ST,xv,xx,0,ux,Cv,gx,nu)}(fn,sh,r_,Wn,Dn,po,oa,fn.layers[0],fn.collisionBoxArray,nr.index,nr.sourceLayerIndex,fn.index,ml,Rf,Qg,go,ac,rh,Pf,sc,nr,mo,On,pl,Zn)};if("line"===lc)for(var ih=0,Jg=cv(nr.geometry,0,0,8192,8192);ih<Jg.length;ih+=1)for(var rm=Jg[ih],Nf=0,im=lv(rm,nh,Mf,Wn.vertical||Ba,Dn,24,th,fn.overscaling,8192);Nf<im.length;Nf+=1){var Lf=im[Nf];Ba&&s2(fn,Ba.text,cc,Lf)||Qc(rm,Lf)}else if("line-center"===lc)for(var e_=0,Ff=nr.geometry;e_<Ff.length;e_+=1){var om=Ff[e_];if(om.length>1){var t_=Xp(om,Mf,Wn.vertical||Ba,Dn,24,th);t_&&Qc(om,t_)}}else if("Polygon"===nr.type)for(var sm=0,_v=Xy(nr.geometry,0);sm<_v.length;sm+=1){var am=_v[sm],lm=Cf(am,16);Qc(am[0],new Ef(lm.x,lm.y,0))}else if("LineString"===nr.type)for(var oh=0,cm=nr.geometry;oh<cm.length;oh+=1){var Jc=cm[oh];Qc(Jc,new Ef(Jc[0].x,Jc[0].y,0))}else if("Point"===nr.type)for(var um=0,n_=nr.geometry;um<n_.length;um+=1)for(var uc=0,dm=n_[um];uc<dm.length;uc+=1){var Bf=dm[uc];Qc([Bf],new Ef(Bf.x,Bf.y,0))}}(s,Se,et,Hi,m,R,Qe,pt,tt,Ro,E)},fe=0,Te=s.features;fe<Te.length;fe+=1)pe();b&&s.generateCollisionDebugBuffers()},v.perspective=function(s,l,u,m,y){var b,E=1/Math.tan(l/2);return s[0]=E/u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=y&&y!==1/0?(s[10]=(y+m)*(b=1/(m-y)),s[14]=2*y*m*b):(s[10]=-1,s[14]=-2*m),s},v.pick=function(s,l){for(var u={},m=0;m<l.length;m++){var y=l[m];y in s&&(u[y]=s[y])}return u},v.plugin=Qn,v.polygonIntersectsPolygon=Ae,v.postMapLoadEvent=xa,v.postTurnstileEvent=Pc,v.potpack=q0,v.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],v.register=nt,v.registerForPluginStateChange=function(s){return s({pluginStatus:Fi,pluginURL:Tn}),Kt.on("pluginStateChange",s),s},v.renderColorRamp=Og,v.rotate=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=Math.sin(u),k=Math.cos(u);return s[0]=m*k+b*S,s[1]=y*k+E*S,s[2]=m*-S+b*k,s[3]=y*-S+E*k,s},v.rotateX=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[4],E=l[5],S=l[6],k=l[7],R=l[8],P=l[9],N=l[10],V=l[11];return l!==s&&(s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[4]=b*y+R*m,s[5]=E*y+P*m,s[6]=S*y+N*m,s[7]=k*y+V*m,s[8]=R*y-b*m,s[9]=P*y-E*m,s[10]=N*y-S*m,s[11]=V*y-k*m,s},v.rotateZ=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[0],E=l[1],S=l[2],k=l[3],R=l[4],P=l[5],N=l[6],V=l[7];return l!==s&&(s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[0]=b*y+R*m,s[1]=E*y+P*m,s[2]=S*y+N*m,s[3]=k*y+V*m,s[4]=R*y-b*m,s[5]=P*y-E*m,s[6]=N*y-S*m,s[7]=V*y-k*m,s},v.scale=function(s,l,u){var m=u[0],y=u[1],b=u[2];return s[0]=l[0]*m,s[1]=l[1]*m,s[2]=l[2]*m,s[3]=l[3]*m,s[4]=l[4]*y,s[5]=l[5]*y,s[6]=l[6]*y,s[7]=l[7]*y,s[8]=l[8]*b,s[9]=l[9]*b,s[10]=l[10]*b,s[11]=l[11]*b,s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},v.scale$1=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s[3]=l[3]*u,s},v.scale$2=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s},v.setCacheLimits=function(s,l){Du=s,qh=l},v.setRTLTextPlugin=function(s,l,u){if(void 0===u&&(u=!1),"deferred"===Fi||"loading"===Fi||"loaded"===Fi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Tn=tl.resolveURL(s),Fi="deferred",cl=l,ns(),u||zd()},v.sphericalToCartesian=function(s){var l=s[0],u=s[1],m=s[2];return u+=90,u*=Math.PI/180,m*=Math.PI/180,{x:l*Math.cos(u)*Math.sin(m),y:l*Math.sin(u)*Math.sin(m),z:l*Math.cos(m)}},v.sqrLen=function(s){var l=s[0],u=s[1];return l*l+u*u},v.styleSpec=W,v.sub=function(s,l,u){return s[0]=l[0]-u[0],s[1]=l[1]-u[1],s[2]=l[2]-u[2],s},v.symbolSize=ov,v.transformMat3=function(s,l,u){var m=l[0],y=l[1],b=l[2];return s[0]=m*u[0]+y*u[3]+b*u[6],s[1]=m*u[1]+y*u[4]+b*u[7],s[2]=m*u[2]+y*u[5]+b*u[8],s},v.transformMat4=gf,v.translate=function(s,l,u){var m,y,b,E,S,k,R,P,N,V,H,X,Y=u[0],ce=u[1],le=u[2];return l===s?(s[12]=l[0]*Y+l[4]*ce+l[8]*le+l[12],s[13]=l[1]*Y+l[5]*ce+l[9]*le+l[13],s[14]=l[2]*Y+l[6]*ce+l[10]*le+l[14],s[15]=l[3]*Y+l[7]*ce+l[11]*le+l[15]):(y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],R=l[6],P=l[7],N=l[8],V=l[9],H=l[10],X=l[11],s[0]=m=l[0],s[1]=y,s[2]=b,s[3]=E,s[4]=S,s[5]=k,s[6]=R,s[7]=P,s[8]=N,s[9]=V,s[10]=H,s[11]=X,s[12]=m*Y+S*ce+N*le+l[12],s[13]=y*Y+k*ce+V*le+l[13],s[14]=b*Y+R*ce+H*le+l[14],s[15]=E*Y+P*ce+X*le+l[15]),s},v.triggerPluginCompletionEvent=Rn,v.uniqueId=Ja,v.validateCustomStyleLayer=function(s){var l=[],u=s.id;return void 0===u&&l.push({message:"layers."+u+': missing required property "id"'}),void 0===s.render&&l.push({message:"layers."+u+': missing required method "render"'}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&l.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),l},v.validateLight=Bp,v.validateStyle=Bu,v.values=function(s){var l=[];for(var u in s)l.push(s[u]);return l},v.vectorTile=Zp,v.version="1.15.3",v.warnOnce=lr,v.webpSupported=va,v.window=ft,v.wrap=wu}),Td(0,function(v){function zo(F){var z=typeof F;if("number"===z||"boolean"===z||"string"===z||null==F)return JSON.stringify(F);if(Array.isArray(F)){for(var U="[",G=0,te=F;G<te.length;G+=1)U+=zo(te[G])+",";return U+"]"}for(var ue=Object.keys(F).sort(),he="{",K=0;K<ue.length;K++)he+=JSON.stringify(ue[K])+":"+zo(F[ue[K]])+",";return he+"}"}function Ve(F){for(var z="",U=0,G=v.refProperties;U<G.length;U+=1)z+="/"+zo(F[G[U]]);return z}var yt=function(F){this.keyCache={},F&&this.replace(F)};yt.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},yt.prototype.update=function(F,z){for(var U=this,G=0,te=F;G<te.length;G+=1){var ue=te[G];this._layerConfigs[ue.id]=ue;var he=this._layers[ue.id]=v.createStyleLayer(ue);he._featureFilter=v.featureFilter(he.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(var K=0,W=z;K<W.length;K+=1){var re=W[K];delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re]}this.familiesBySource={};for(var ze=0,Ke=function(Je,Be){for(var Gt={},Wt=0;Wt<Je.length;Wt++){var se=Be&&Be[Je[Wt].id]||Ve(Je[Wt]);Be&&(Be[Je[Wt].id]=se);var or=Gt[se];or||(or=Gt[se]=[]),or.push(Je[Wt])}var Nt=[];for(var Jt in Gt)Nt.push(Gt[Jt]);return Nt}(v.values(this._layerConfigs),this.keyCache);ze<Ke.length;ze+=1){var Ce=Ke[ze].map(function(Je){return U._layers[Je.id]}),je=Ce[0];if("none"!==je.visibility){var ot=je.source||"",at=this.familiesBySource[ot];at||(at=this.familiesBySource[ot]={});var mt=je.sourceLayer||"_geojsonTileLayer",Pe=at[mt];Pe||(Pe=at[mt]=[]),Pe.push(Ce)}}};var Vt=function(F){var z={},U=[];for(var G in F){var te=F[G],ue=z[G]={};for(var he in te){var K=te[+he];if(K&&0!==K.bitmap.width&&0!==K.bitmap.height){var W={x:0,y:0,w:K.bitmap.width+2,h:K.bitmap.height+2};U.push(W),ue[he]={rect:W,metrics:K.metrics}}}}var re=v.potpack(U),ze=new v.AlphaImage({width:re.w||1,height:re.h||1});for(var Ke in F){var Ce=F[Ke];for(var je in Ce){var ot=Ce[+je];if(ot&&0!==ot.bitmap.width&&0!==ot.bitmap.height){var at=z[Ke][je].rect;v.AlphaImage.copy(ot.bitmap,ze,{x:0,y:0},{x:at.x+1,y:at.y+1},ot.bitmap)}}}this.image=ze,this.positions=z};v.register("GlyphAtlas",Vt);var Qa=function(F){this.tileID=new v.OverscaledTileID(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId};function ft(F,z,U){for(var G=new v.EvaluationParameters(z),te=0,ue=F;te<ue.length;te+=1)ue[te].recalculate(G,U)}function Pl(F,z){var U=v.getArrayBuffer(F.request,function(G,te,ue,he){G?z(G):te&&z(null,{vectorTile:new v.vectorTile.VectorTile(new v.pbf(te)),rawData:te,cacheControl:ue,expires:he})});return function(){U.cancel(),z()}}Qa.prototype.parse=function(F,z,U,G,te){var ue=this;this.status="parsing",this.data=F,this.collisionBoxArray=new v.CollisionBoxArray;var he=new v.DictionaryCoder(Object.keys(F.layers).sort()),K=new v.FeatureIndex(this.tileID,this.promoteId);K.bucketLayerIDs=[];var W,re,ze,Ke,Ce={},je={featureIndex:K,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:U},ot=z.familiesBySource[this.source];for(var at in ot){var mt=F.layers[at];if(mt){1===mt.version&&v.warnOnce('Vector tile source "'+this.source+'" layer "'+at+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Pe=he.encode(at),Je=[],Be=0;Be<mt.length;Be++){var Gt=mt.feature(Be),Wt=K.getId(Gt,at);Je.push({feature:Gt,id:Wt,index:Be,sourceLayerIndex:Pe})}for(var se=0,or=ot[at];se<or.length;se+=1){var Nt=or[se],Jt=Nt[0];Jt.minzoom&&this.zoom<Math.floor(Jt.minzoom)||Jt.maxzoom&&this.zoom>=Jt.maxzoom||"none"!==Jt.visibility&&(ft(Nt,this.zoom,U),(Ce[Jt.id]=Jt.createBucket({index:K.bucketLayerIDs.length,layers:Nt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pe,sourceID:this.source})).populate(Je,je,this.tileID.canonical),K.bucketLayerIDs.push(Nt.map(function(gn){return gn.id})))}}}var br=v.mapObject(je.glyphDependencies,function(gn){return Object.keys(gn).map(Number)});Object.keys(br).length?G.send("getGlyphs",{uid:this.uid,stacks:br},function(gn,an){W||(W=gn,re=an,Rr.call(ue))}):re={};var An=Object.keys(je.iconDependencies);An.length?G.send("getImages",{icons:An,source:this.source,tileID:this.tileID,type:"icons"},function(gn,an){W||(W=gn,ze=an,Rr.call(ue))}):ze={};var ut=Object.keys(je.patternDependencies);function Rr(){if(W)return te(W);if(re&&ze&&Ke){var gn=new Vt(re),an=new v.ImageAtlas(ze,Ke);for(var kd in Ce){var mn=Ce[kd];mn instanceof v.SymbolBucket?(ft(mn.layers,this.zoom,U),v.performSymbolLayout(mn,re,gn.positions,ze,an.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):mn.hasPattern&&(mn instanceof v.LineBucket||mn instanceof v.FillBucket||mn instanceof v.FillExtrusionBucket)&&(ft(mn.layers,this.zoom,U),mn.addFeatures(je,this.tileID.canonical,an.patternPositions))}this.status="done",te(null,{buckets:v.values(Ce).filter(function($n){return!$n.isEmpty()}),featureIndex:K,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gn.image,imageAtlas:an,glyphMap:this.returnDependencies?re:null,iconMap:this.returnDependencies?ze:null,glyphPositions:this.returnDependencies?gn.positions:null})}}ut.length?G.send("getImages",{icons:ut,source:this.source,tileID:this.tileID,type:"patterns"},function(gn,an){W||(W=gn,Ke=an,Rr.call(ue))}):Ke={},Rr.call(this)};var wo=function(F,z,U,G){this.actor=F,this.layerIndex=z,this.availableImages=U,this.loadVectorData=G||Pl,this.loading={},this.loaded={}};wo.prototype.loadTile=function(F,z){var U=this,G=F.uid;this.loading||(this.loading={});var te=!!(F&&F.request&&F.request.collectResourceTiming)&&new v.RequestPerformance(F.request),ue=this.loading[G]=new Qa(F);ue.abort=this.loadVectorData(F,function(he,K){if(delete U.loading[G],he||!K)return ue.status="done",U.loaded[G]=ue,z(he);var W=K.rawData,re={};K.expires&&(re.expires=K.expires),K.cacheControl&&(re.cacheControl=K.cacheControl);var ze={};if(te){var Ke=te.finish();Ke&&(ze.resourceTiming=JSON.parse(JSON.stringify(Ke)))}ue.vectorTile=K.vectorTile,ue.parse(K.vectorTile,U.layerIndex,U.availableImages,U.actor,function(Ce,je){if(Ce||!je)return z(Ce);z(null,v.extend({rawTileData:W.slice(0)},je,re,ze))}),U.loaded=U.loaded||{},U.loaded[G]=ue})},wo.prototype.reloadTile=function(F,z){var U=this,G=this.loaded,te=F.uid,ue=this;if(G&&G[te]){var he=G[te];he.showCollisionBoxes=F.showCollisionBoxes;var K=function(W,re){var ze=he.reloadCallback;ze&&(delete he.reloadCallback,he.parse(he.vectorTile,ue.layerIndex,U.availableImages,ue.actor,ze)),z(W,re)};"parsing"===he.status?he.reloadCallback=K:"done"===he.status&&(he.vectorTile?he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,K):K())}},wo.prototype.abortTile=function(F,z){var U=this.loading,G=F.uid;U&&U[G]&&U[G].abort&&(U[G].abort(),delete U[G]),z()},wo.prototype.removeTile=function(F,z){var U=this.loaded,G=F.uid;U&&U[G]&&delete U[G],z()};var Ac=v.window.ImageBitmap,Wi=function(){this.loaded={}};function wu(F,z){if(0!==F.length){ki(F[0],z);for(var U=1;U<F.length;U++)ki(F[U],!z)}}function ki(F,z){for(var U=0,G=0,te=F.length,ue=te-1;G<te;ue=G++)U+=(F[G][0]-F[ue][0])*(F[ue][1]+F[G][1]);U>=0!=!!z&&F.reverse()}Wi.prototype.loadTile=function(F,z){var U=F.uid,G=F.encoding,te=F.rawImageData,ue=Ac&&te instanceof Ac?this.getImageData(te):te,he=new v.DEMData(U,ue,G);this.loaded=this.loaded||{},this.loaded[U]=he,z(null,he)},Wi.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var z=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:z.width,height:z.height},z.data)},Wi.prototype.removeTile=function(F){var z=this.loaded,U=F.uid;z&&z[U]&&delete z[U]};var $h=v.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ja=function(F){this._feature=F,this.extent=v.EXTENT,this.type=F.type,this.properties=F.tags,"id"in F&&!isNaN(F.id)&&(this.id=parseInt(F.id,10))};Ja.prototype.loadGeometry=function(){if(1===this._feature.type){for(var F=[],z=0,U=this._feature.geometry;z<U.length;z+=1){var G=U[z];F.push([new v.Point$1(G[0],G[1])])}return F}for(var te=[],ue=0,he=this._feature.geometry;ue<he.length;ue+=1){for(var K=[],W=0,re=he[ue];W<re.length;W+=1){var ze=re[W];K.push(new v.Point$1(ze[0],ze[1]))}te.push(K)}return te},Ja.prototype.toGeoJSON=function(F,z,U){return $h.call(this,F,z,U)};var Yo=function(F){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=F.length,this._features=F};Yo.prototype.feature=function(F){return new Ja(this._features[F])};var xu=v.vectorTile.VectorTileFeature,ga=Rc;function Rc(F,z){this.options=z||{},this.features=F,this.length=F.length}function Ai(F,z){this.id="number"==typeof F.id?F.id:void 0,this.type=F.type,this.rawGeometry=1===F.type?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=z||4096}Rc.prototype.feature=function(F){return new Ai(this.features[F],this.options.extent)},Ai.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var z=0;z<F.length;z++){for(var U=F[z],G=[],te=0;te<U.length;te++)G.push(new v.Point$1(U[te][0],U[te][1]));this.geometry.push(G)}return this.geometry},Ai.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,z=1/0,U=-1/0,G=1/0,te=-1/0,ue=0;ue<F.length;ue++)for(var he=F[ue],K=0;K<he.length;K++){var W=he[K];z=Math.min(z,W.x),U=Math.max(U,W.x),G=Math.min(G,W.y),te=Math.max(te,W.y)}return[z,G,U,te]},Ai.prototype.toGeoJSON=xu.prototype.toGeoJSON;var _s=Ol,Os=ga;function Ol(F){var z=new v.pbf;return function(U,G){for(var te in U.layers)G.writeMessage(3,lr,U.layers[te])}(F,z),z.finish()}function lr(F,z){var U;z.writeVarintField(15,F.version||1),z.writeStringField(1,F.name||""),z.writeVarintField(5,F.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<F.length;U++)G.feature=F.feature(U),z.writeMessage(2,xo,G);var te=G.keys;for(U=0;U<te.length;U++)z.writeStringField(3,te[U]);var ue=G.values;for(U=0;U<ue.length;U++)z.writeMessage(4,_a,ue[U])}function xo(F,z){var U=F.feature;void 0!==U.id&&z.writeVarintField(1,U.id),z.writeMessage(2,Sp,F),z.writeVarintField(3,U.type),z.writeMessage(4,Eu,U)}function Sp(F,z){var U=F.feature,G=F.keys,te=F.values,ue=F.keycache,he=F.valuecache;for(var K in U.properties){var W=ue[K];void 0===W&&(G.push(K),ue[K]=W=G.length-1),z.writeVarint(W);var re=U.properties[K],ze=typeof re;"string"!==ze&&"boolean"!==ze&&"number"!==ze&&(re=JSON.stringify(re));var Ke=ze+":"+re,Ce=he[Ke];void 0===Ce&&(te.push(re),he[Ke]=Ce=te.length-1),z.writeVarint(Ce)}}function ys(F,z){return(z<<3)+(7&F)}function Nl(F){return F<<1^F>>31}function Eu(F,z){for(var U=F.loadGeometry(),G=F.type,te=0,ue=0,he=U.length,K=0;K<he;K++){var W=U[K],re=1;1===G&&(re=W.length),z.writeVarint(ys(1,re));for(var ze=3===G?W.length-1:W.length,Ke=0;Ke<ze;Ke++){1===Ke&&1!==G&&z.writeVarint(ys(2,ze-1));var Ce=W[Ke].x-te,je=W[Ke].y-ue;z.writeVarint(Nl(Ce)),z.writeVarint(Nl(je)),te+=Ce,ue+=je}3===G&&z.writeVarint(ys(7,1))}}function _a(F,z){var U=typeof F;"string"===U?z.writeStringField(1,F):"boolean"===U?z.writeBooleanField(7,F):"number"===U&&(F%1!=0?z.writeDoubleField(3,F):F<0?z.writeSVarintField(6,F):z.writeVarintField(5,F))}function vs(F,z,U,G){Zi(F,U,G),Zi(z,2*U,2*G),Zi(z,2*U+1,2*G+1)}function Zi(F,z,U){var G=F[z];F[z]=F[U],F[U]=G}function ya(F,z,U,G){var te=F-U,ue=z-G;return te*te+ue*ue}_s.fromVectorTileJs=Ol,_s.fromGeojsonVt=function(F,z){z=z||{};var U={};for(var G in F)U[G]=new ga(F[G].features,z),U[G].name=G,U[G].version=z.version,U[G].extent=z.extent;return Ol({layers:U})},_s.GeoJSONWrapper=Os;var Mc=function(F){return F[0]},Ll=function(F){return F[1]},el=function(F,z,U,G,te){void 0===z&&(z=Mc),void 0===U&&(U=Ll),void 0===G&&(G=64),void 0===te&&(te=Float64Array),this.nodeSize=G,this.points=F;for(var ue=F.length<65536?Uint16Array:Uint32Array,he=this.ids=new ue(F.length),K=this.coords=new te(2*F.length),W=0;W<F.length;W++)he[W]=W,K[2*W]=z(F[W]),K[2*W+1]=U(F[W]);!function re(ze,Ke,Ce,je,ot,at){if(!(ot-je<=Ce)){var mt=je+ot>>1;(function Pe(Je,Be,Gt,Wt,se,or){for(;se>Wt;){if(se-Wt>600){var Nt=se-Wt+1,Jt=Gt-Wt+1,br=Math.log(Nt),An=.5*Math.exp(2*br/3),ut=.5*Math.sqrt(br*An*(Nt-An)/Nt)*(Jt-Nt/2<0?-1:1);Pe(Je,Be,Gt,Math.max(Wt,Math.floor(Gt-Jt*An/Nt+ut)),Math.min(se,Math.floor(Gt+(Nt-Jt)*An/Nt+ut)),or)}var Rr=Be[2*Gt+or],gn=Wt,an=se;for(vs(Je,Be,Wt,Gt),Be[2*se+or]>Rr&&vs(Je,Be,Wt,se);gn<an;){for(vs(Je,Be,gn,an),gn++,an--;Be[2*gn+or]<Rr;)gn++;for(;Be[2*an+or]>Rr;)an--}Be[2*Wt+or]===Rr?vs(Je,Be,Wt,an):vs(Je,Be,++an,se),an<=Gt&&(Wt=an+1),Gt<=an&&(se=an-1)}})(ze,Ke,mt,je,ot,at%2),re(ze,Ke,Ce,je,mt-1,at+1),re(ze,Ke,Ce,mt+1,ot,at+1)}}(he,K,G,0,he.length-1,0)};el.prototype.range=function(F,z,U,G){return function(te,ue,he,K,W,re,ze){for(var Ke,Ce,je=[0,te.length-1,0],ot=[];je.length;){var at=je.pop(),mt=je.pop(),Pe=je.pop();if(mt-Pe<=ze)for(var Je=Pe;Je<=mt;Je++)Ce=ue[2*Je+1],(Ke=ue[2*Je])>=he&&Ke<=W&&Ce>=K&&Ce<=re&&ot.push(te[Je]);else{var Be=Math.floor((Pe+mt)/2);Ce=ue[2*Be+1],(Ke=ue[2*Be])>=he&&Ke<=W&&Ce>=K&&Ce<=re&&ot.push(te[Be]);var Gt=(at+1)%2;(0===at?he<=Ke:K<=Ce)&&(je.push(Pe),je.push(Be-1),je.push(Gt)),(0===at?W>=Ke:re>=Ce)&&(je.push(Be+1),je.push(mt),je.push(Gt))}}return ot}(this.ids,this.coords,F,z,U,G,this.nodeSize)},el.prototype.within=function(F,z,U){return function(G,te,ue,he,K,W){for(var re=[0,G.length-1,0],ze=[],Ke=K*K;re.length;){var Ce=re.pop(),je=re.pop(),ot=re.pop();if(je-ot<=W)for(var at=ot;at<=je;at++)ya(te[2*at],te[2*at+1],ue,he)<=Ke&&ze.push(G[at]);else{var mt=Math.floor((ot+je)/2),Pe=te[2*mt],Je=te[2*mt+1];ya(Pe,Je,ue,he)<=Ke&&ze.push(G[mt]);var Be=(Ce+1)%2;(0===Ce?ue-K<=Pe:he-K<=Je)&&(re.push(ot),re.push(mt-1),re.push(Be)),(0===Ce?ue+K>=Pe:he+K>=Je)&&(re.push(mt+1),re.push(je),re.push(Be))}}return ze}(this.ids,this.coords,F,z,U,this.nodeSize)};var Ip={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(F){return F}},Ri=function(F){this.options=ba(Object.create(Ip),F),this.trees=new Array(this.options.maxZoom+1)};function tl(F,z,U,G,te){return{x:F,y:z,zoom:1/0,id:U,parentId:-1,numPoints:G,properties:te}}function Yn(F,z){var U=F.geometry.coordinates,G=U[1];return{x:Ns(U[0]),y:bn(G),zoom:1/0,index:z,parentId:-1}}function va(F){return{type:"Feature",id:F.id,properties:nl(F),geometry:{type:"Point",coordinates:[(G=F.x,360*(G-.5)),(z=F.y,U=(180-360*z)*Math.PI/180,360*Math.atan(Math.exp(U))/Math.PI-90)]}};var z,U,G}function nl(F){var z=F.numPoints,U=z>=1e4?Math.round(z/1e3)+"k":z>=1e3?Math.round(z/100)/10+"k":z;return ba(ba({},F.properties),{cluster:!0,cluster_id:F.id,point_count:z,point_count_abbreviated:U})}function Ns(F){return F/360+.5}function bn(F){var z=Math.sin(F*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function ba(F,z){for(var U in z)F[U]=z[U];return F}function Eo(F){return F.x}function Ls(F){return F.y}function kp(F,z,U,G,te,ue){var he=te-U,K=ue-G;if(0!==he||0!==K){var W=((F-U)*he+(z-G)*K)/(he*he+K*K);W>1?(U=te,G=ue):W>0&&(U+=he*W,G+=K*W)}return(he=F-U)*he+(K=z-G)*K}function Ks(F,z,U,G){var te={id:void 0===F?null:F,type:z,geometry:U,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ue){var he=ue.geometry,K=ue.type;if("Point"===K||"MultiPoint"===K||"LineString"===K)cr(ue,he);else if("Polygon"===K||"MultiLineString"===K)for(var W=0;W<he.length;W++)cr(ue,he[W]);else if("MultiPolygon"===K)for(W=0;W<he.length;W++)for(var re=0;re<he[W].length;re++)cr(ue,he[W][re])}(te),te}function cr(F,z){for(var U=0;U<z.length;U+=3)F.minX=Math.min(F.minX,z[U]),F.minY=Math.min(F.minY,z[U+1]),F.maxX=Math.max(F.maxX,z[U]),F.maxY=Math.max(F.maxY,z[U+1])}function Xo(F,z,U,G){if(z.geometry){var te=z.geometry.coordinates,ue=z.geometry.type,he=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),K=[],W=z.id;if(U.promoteId?W=z.properties[U.promoteId]:U.generateId&&(W=G||0),"Point"===ue)rl(te,K);else if("MultiPoint"===ue)for(var re=0;re<te.length;re++)rl(te[re],K);else if("LineString"===ue)il(te,K,he,!1);else if("MultiLineString"===ue){if(U.lineMetrics){for(re=0;re<te.length;re++)il(te[re],K=[],he,!1),F.push(Ks(W,"LineString",K,z.properties));return}Hn(te,K,he,!1)}else if("Polygon"===ue)Hn(te,K,he,!0);else{if("MultiPolygon"!==ue){if("GeometryCollection"===ue){for(re=0;re<z.geometry.geometries.length;re++)Xo(F,{id:W,geometry:z.geometry.geometries[re],properties:z.properties},U,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(re=0;re<te.length;re++){var ze=[];Hn(te[re],ze,he,!0),K.push(ze)}}F.push(Ks(W,ue,K,z.properties))}}function rl(F,z){z.push(bs(F[0])),z.push(Fl(F[1])),z.push(0)}function il(F,z,U,G){for(var te,ue,he=0,K=0;K<F.length;K++){var W=bs(F[K][0]),re=Fl(F[K][1]);z.push(W),z.push(re),z.push(0),K>0&&(he+=G?(te*re-W*ue)/2:Math.sqrt(Math.pow(W-te,2)+Math.pow(re-ue,2))),te=W,ue=re}var ze=z.length-3;z[2]=1,function Ke(Ce,je,ot,at){for(var mt,Pe=at,Je=ot-je>>1,Be=ot-je,Gt=Ce[je],Wt=Ce[je+1],se=Ce[ot],or=Ce[ot+1],Nt=je+3;Nt<ot;Nt+=3){var Jt=kp(Ce[Nt],Ce[Nt+1],Gt,Wt,se,or);if(Jt>Pe)mt=Nt,Pe=Jt;else if(Jt===Pe){var br=Math.abs(Nt-Je);br<Be&&(mt=Nt,Be=br)}}Pe>at&&(mt-je>3&&Ke(Ce,je,mt,at),Ce[mt+2]=Pe,ot-mt>3&&Ke(Ce,mt,ot,at))}(z,0,ze,U),z[ze+2]=1,z.size=Math.abs(he),z.start=0,z.end=z.size}function Hn(F,z,U,G){for(var te=0;te<F.length;te++){var ue=[];il(F[te],ue,U,G),z.push(ue)}}function bs(F){return F/360+.5}function Fl(F){var z=Math.sin(F*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Fs(F,z,U,G,te,ue,he,K){if(G/=z,ue>=(U/=z)&&he<G)return F;if(he<U||ue>=G)return null;for(var W=[],re=0;re<F.length;re++){var ze=F[re],Ke=ze.geometry,Ce=ze.type,je=0===te?ze.minX:ze.minY,ot=0===te?ze.maxX:ze.maxY;if(je>=U&&ot<G)W.push(ze);else if(!(ot<U||je>=G)){var at=[];if("Point"===Ce||"MultiPoint"===Ce)wa(Ke,at,U,G,te);else if("LineString"===Ce)Pc(Ke,at,U,G,te,!1,K.lineMetrics);else if("MultiLineString"===Ce)xa(Ke,at,U,G,te,!1);else if("Polygon"===Ce)xa(Ke,at,U,G,te,!0);else if("MultiPolygon"===Ce)for(var mt=0;mt<Ke.length;mt++){var Pe=[];xa(Ke[mt],Pe,U,G,te,!0),Pe.length&&at.push(Pe)}if(at.length){if(K.lineMetrics&&"LineString"===Ce){for(mt=0;mt<at.length;mt++)W.push(Ks(ze.id,Ce,at[mt],ze.tags));continue}"LineString"!==Ce&&"MultiLineString"!==Ce||(1===at.length?(Ce="LineString",at=at[0]):Ce="MultiLineString"),"Point"!==Ce&&"MultiPoint"!==Ce||(Ce=3===at.length?"Point":"MultiPoint"),W.push(Ks(ze.id,Ce,at,ze.tags))}}}return W.length?W:null}function wa(F,z,U,G,te){for(var ue=0;ue<F.length;ue+=3){var he=F[ue+te];he>=U&&he<=G&&(z.push(F[ue]),z.push(F[ue+1]),z.push(F[ue+2]))}}function Pc(F,z,U,G,te,ue,he){for(var K,W,re=Cu(F),ze=0===te?qh:Tu,Ke=F.start,Ce=0;Ce<F.length-3;Ce+=3){var je=F[Ce],ot=F[Ce+1],at=F[Ce+2],mt=F[Ce+3],Pe=F[Ce+4],Je=0===te?je:ot,Be=0===te?mt:Pe,Gt=!1;he&&(K=Math.sqrt(Math.pow(je-mt,2)+Math.pow(ot-Pe,2))),Je<U?Be>U&&(W=ze(re,je,ot,mt,Pe,U),he&&(re.start=Ke+K*W)):Je>G?Be<G&&(W=ze(re,je,ot,mt,Pe,G),he&&(re.start=Ke+K*W)):Du(re,je,ot,at),Be<U&&Je>=U&&(W=ze(re,je,ot,mt,Pe,U),Gt=!0),Be>G&&Je<=G&&(W=ze(re,je,ot,mt,Pe,G),Gt=!0),!ue&&Gt&&(he&&(re.end=Ke+K*W),z.push(re),re=Cu(F)),he&&(Ke+=K)}var Wt=F.length-3;je=F[Wt],ot=F[Wt+1],at=F[Wt+2],(Je=0===te?je:ot)>=U&&Je<=G&&Du(re,je,ot,at),Wt=re.length-3,ue&&Wt>=3&&(re[Wt]!==re[0]||re[Wt+1]!==re[1])&&Du(re,re[0],re[1],re[2]),re.length&&z.push(re)}function Cu(F){var z=[];return z.size=F.size,z.start=F.start,z.end=F.end,z}function xa(F,z,U,G,te,ue){for(var he=0;he<F.length;he++)Pc(F[he],z,U,G,te,ue,!1)}function Du(F,z,U,G){F.push(z),F.push(U),F.push(G)}function qh(F,z,U,G,te,ue){var he=(ue-z)/(G-z);return F.push(ue),F.push(U+(te-U)*he),F.push(1),he}function Tu(F,z,U,G,te,ue){var he=(ue-U)/(te-U);return F.push(z+(G-z)*he),F.push(ue),F.push(1),he}function Oc(F,z){for(var U=[],G=0;G<F.length;G++){var te,ue=F[G],he=ue.type;if("Point"===he||"MultiPoint"===he||"LineString"===he)te=ws(ue.geometry,z);else if("MultiLineString"===he||"Polygon"===he){te=[];for(var K=0;K<ue.geometry.length;K++)te.push(ws(ue.geometry[K],z))}else if("MultiPolygon"===he)for(te=[],K=0;K<ue.geometry.length;K++){for(var W=[],re=0;re<ue.geometry[K].length;re++)W.push(ws(ue.geometry[K][re],z));te.push(W)}U.push(Ks(ue.id,he,te,ue.tags))}return U}function ws(F,z){var U=[];U.size=F.size,void 0!==F.start&&(U.start=F.start,U.end=F.end);for(var G=0;G<F.length;G+=3)U.push(F[G]+z,F[G+1],F[G+2]);return U}function Bl(F,z){if(F.transformed)return F;var U,G,te,ue=1<<F.z,he=F.x,K=F.y;for(U=0;U<F.features.length;U++){var W=F.features[U],re=W.geometry,ze=W.type;if(W.geometry=[],1===ze)for(G=0;G<re.length;G+=2)W.geometry.push(Sd(re[G],re[G+1],z,ue,he,K));else for(G=0;G<re.length;G++){var Ke=[];for(te=0;te<re[G].length;te+=2)Ke.push(Sd(re[G][te],re[G][te+1],z,ue,he,K));W.geometry.push(Ke)}}return F.transformed=!0,F}function Sd(F,z,U,G,te,ue){return[Math.round(U*(F*G-te)),Math.round(U*(z*G-ue))]}function Su(F,z,U,G,te){for(var ue=z===te.maxZoom?0:te.tolerance/((1<<z)*te.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:G,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},K=0;K<F.length;K++){he.numFeatures++,Id(he,F[K],ue,te);var W=F[K].minX,re=F[K].minY,ze=F[K].maxX,Ke=F[K].maxY;W<he.minX&&(he.minX=W),re<he.minY&&(he.minY=re),ze>he.maxX&&(he.maxX=ze),Ke>he.maxY&&(he.maxY=Ke)}return he}function Id(F,z,U,G){var te=z.geometry,ue=z.type,he=[];if("Point"===ue||"MultiPoint"===ue)for(var K=0;K<te.length;K+=3)he.push(te[K]),he.push(te[K+1]),F.numPoints++,F.numSimplified++;else if("LineString"===ue)ol(he,te,F,U,!1,!1);else if("MultiLineString"===ue||"Polygon"===ue)for(K=0;K<te.length;K++)ol(he,te[K],F,U,"Polygon"===ue,0===K);else if("MultiPolygon"===ue)for(var W=0;W<te.length;W++){var re=te[W];for(K=0;K<re.length;K++)ol(he,re[K],F,U,!0,0===K)}if(he.length){var ze=z.tags||null;if("LineString"===ue&&G.lineMetrics){for(var Ke in ze={},z.tags)ze[Ke]=z.tags[Ke];ze.mapbox_clip_start=te.start/te.size,ze.mapbox_clip_end=te.end/te.size}var Ce={geometry:he,type:"Polygon"===ue||"MultiPolygon"===ue?3:"LineString"===ue||"MultiLineString"===ue?2:1,tags:ze};null!==z.id&&(Ce.id=z.id),F.features.push(Ce)}}function ol(F,z,U,G,te,ue){var he=G*G;if(G>0&&z.size<(te?he:G))U.numPoints+=z.length/3;else{for(var K=[],W=0;W<z.length;W+=3)(0===G||z[W+2]>he)&&(U.numSimplified++,K.push(z[W]),K.push(z[W+1])),U.numPoints++;te&&function(re,ze){for(var Ke=0,Ce=0,je=re.length,ot=je-2;Ce<je;ot=Ce,Ce+=2)Ke+=(re[Ce]-re[ot])*(re[Ce+1]+re[ot+1]);if(Ke>0===ze)for(Ce=0,je=re.length;Ce<je/2;Ce+=2){var at=re[Ce],mt=re[Ce+1];re[Ce]=re[je-2-Ce],re[Ce+1]=re[je-1-Ce],re[je-2-Ce]=at,re[je-1-Ce]=mt}}(K,ue),F.push(K)}}function Vl(F,z){var U=(z=this.options=function(te,ue){for(var he in ue)te[he]=ue[he];return te}(Object.create(this.options),z)).debug;if(U&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var te,ue,he,K,W,re,G=function(te,ue){var he=[];if("FeatureCollection"===te.type)for(var K=0;K<te.features.length;K++)Xo(he,te.features[K],ue,K);else Xo(he,"Feature"===te.type?te:{geometry:te},ue);return he}(F,z);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(te=G,ue=z,he=ue.buffer/ue.extent,K=te,W=Fs(te,1,-1-he,he,0,-1,2,ue),re=Fs(te,1,1-he,2+he,0,-1,2,ue),(W||re)&&(K=Fs(te,1,-he,1+he,0,-1,2,ue)||[],W&&(K=Oc(W,1).concat(K)),re&&(K=K.concat(Oc(re,-1)))),G=K).length&&this.splitTile(G,0,0,0),U&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ea(F,z,U){return 32*((1<<F)*U+z)+F}function Nc(F,z){var U=F.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);var G=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!G)return z(null,null);var te=new Yo(G.features),ue=_s(te);0===ue.byteOffset&&ue.byteLength===ue.buffer.byteLength||(ue=new Uint8Array(ue)),z(null,{vectorTile:te,rawData:ue.buffer})}Ri.prototype.load=function(F){var z=this.options,U=z.log,G=z.minZoom,te=z.maxZoom,ue=z.nodeSize;U&&console.time("total time");var he="prepare "+F.length+" points";U&&console.time(he),this.points=F;for(var K=[],W=0;W<F.length;W++)F[W].geometry&&K.push(Yn(F[W],W));this.trees[te+1]=new el(K,Eo,Ls,ue,Float32Array),U&&console.timeEnd(he);for(var re=te;re>=G;re--){var ze=+Date.now();K=this._cluster(K,re),this.trees[re]=new el(K,Eo,Ls,ue,Float32Array),U&&console.log("z%d: %d clusters in %dms",re,K.length,+Date.now()-ze)}return U&&console.timeEnd("total time"),this},Ri.prototype.getClusters=function(F,z){var U=((F[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,F[1])),te=180===F[2]?180:((F[2]+180)%360+360)%360-180,ue=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)U=-180,te=180;else if(U>te){var he=this.getClusters([U,G,180,ue],z),K=this.getClusters([-180,G,te,ue],z);return he.concat(K)}for(var W=this.trees[this._limitZoom(z)],re=[],ze=0,Ke=W.range(Ns(U),bn(ue),Ns(te),bn(G));ze<Ke.length;ze+=1){var Ce=W.points[Ke[ze]];re.push(Ce.numPoints?va(Ce):this.points[Ce.index])}return re},Ri.prototype.getChildren=function(F){var z=this._getOriginId(F),U=this._getOriginZoom(F),G="No cluster with the specified id.",te=this.trees[U];if(!te)throw new Error(G);var ue=te.points[z];if(!ue)throw new Error(G);for(var he=this.options.radius/(this.options.extent*Math.pow(2,U-1)),K=[],W=0,re=te.within(ue.x,ue.y,he);W<re.length;W+=1){var ze=te.points[re[W]];ze.parentId===F&&K.push(ze.numPoints?va(ze):this.points[ze.index])}if(0===K.length)throw new Error(G);return K},Ri.prototype.getLeaves=function(F,z,U){var G=[];return this._appendLeaves(G,F,z=z||10,U=U||0,0),G},Ri.prototype.getTile=function(F,z,U){var G=this.trees[this._limitZoom(F)],te=Math.pow(2,F),ue=this.options,he=ue.radius/ue.extent,K=(U-he)/te,W=(U+1+he)/te,re={features:[]};return this._addTileFeatures(G.range((z-he)/te,K,(z+1+he)/te,W),G.points,z,U,te,re),0===z&&this._addTileFeatures(G.range(1-he/te,K,1,W),G.points,te,U,te,re),z===te-1&&this._addTileFeatures(G.range(0,K,he/te,W),G.points,-1,U,te,re),re.features.length?re:null},Ri.prototype.getClusterExpansionZoom=function(F){for(var z=this._getOriginZoom(F)-1;z<=this.options.maxZoom;){var U=this.getChildren(F);if(z++,1!==U.length)break;F=U[0].properties.cluster_id}return z},Ri.prototype._appendLeaves=function(F,z,U,G,te){for(var ue=0,he=this.getChildren(z);ue<he.length;ue+=1){var K=he[ue],W=K.properties;if(W&&W.cluster?te+W.point_count<=G?te+=W.point_count:te=this._appendLeaves(F,W.cluster_id,U,G,te):te<G?te++:F.push(K),F.length===U)break}return te},Ri.prototype._addTileFeatures=function(F,z,U,G,te,ue){for(var he=0,K=F;he<K.length;he+=1){var W=z[K[he]],re=W.numPoints,ze={type:1,geometry:[[Math.round(this.options.extent*(W.x*te-U)),Math.round(this.options.extent*(W.y*te-G))]],tags:re?nl(W):this.points[W.index].properties},Ke=void 0;re?Ke=W.id:this.options.generateId?Ke=W.index:this.points[W.index].id&&(Ke=this.points[W.index].id),void 0!==Ke&&(ze.id=Ke),ue.features.push(ze)}},Ri.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},Ri.prototype._cluster=function(F,z){for(var U=[],G=this.options,te=G.reduce,ue=G.minPoints,he=G.radius/(G.extent*Math.pow(2,z)),K=0;K<F.length;K++){var W=F[K];if(!(W.zoom<=z)){W.zoom=z;for(var re=this.trees[z+1],ze=re.within(W.x,W.y,he),Ke=W.numPoints||1,Ce=Ke,je=0,ot=ze;je<ot.length;je+=1){var at=re.points[ot[je]];at.zoom>z&&(Ce+=at.numPoints||1)}if(Ce>=ue){for(var mt=W.x*Ke,Pe=W.y*Ke,Je=te&&Ke>1?this._map(W,!0):null,Be=(K<<5)+(z+1)+this.points.length,Gt=0,Wt=ze;Gt<Wt.length;Gt+=1){var se=re.points[Wt[Gt]];if(!(se.zoom<=z)){se.zoom=z;var or=se.numPoints||1;mt+=se.x*or,Pe+=se.y*or,se.parentId=Be,te&&(Je||(Je=this._map(W,!0)),te(Je,this._map(se)))}}W.parentId=Be,U.push(tl(mt/Ce,Pe/Ce,Be,Ce,Je))}else if(U.push(W),Ce>1)for(var Nt=0,Jt=ze;Nt<Jt.length;Nt+=1){var br=re.points[Jt[Nt]];br.zoom<=z||(br.zoom=z,U.push(br))}}}return U},Ri.prototype._getOriginId=function(F){return F-this.points.length>>5},Ri.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},Ri.prototype._map=function(F,z){if(F.numPoints)return z?ba({},F.properties):F.properties;var U=this.points[F.index].properties,G=this.options.map(U);return z&&G===U?ba({},G):G},Vl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Vl.prototype.splitTile=function(F,z,U,G,te,ue,he){for(var K=[F,z,U,G],W=this.options,re=W.debug;K.length;){G=K.pop(),U=K.pop(),z=K.pop(),F=K.pop();var ze=1<<z,Ke=Ea(z,U,G),Ce=this.tiles[Ke];if(!Ce&&(re>1&&console.time("creation"),Ce=this.tiles[Ke]=Su(F,z,U,G,W),this.tileCoords.push({z,x:U,y:G}),re)){re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,U,G,Ce.numFeatures,Ce.numPoints,Ce.numSimplified),console.timeEnd("creation"));var je="z"+z;this.stats[je]=(this.stats[je]||0)+1,this.total++}if(Ce.source=F,te){if(z===W.maxZoom||z===te)continue;var ot=1<<te-z;if(U!==Math.floor(ue/ot)||G!==Math.floor(he/ot))continue}else if(z===W.indexMaxZoom||Ce.numPoints<=W.indexMaxPoints)continue;if(Ce.source=null,0!==F.length){re>1&&console.time("clipping");var at,mt,Pe,Je,Be,Gt,Wt=.5*W.buffer/W.extent,se=.5-Wt,or=.5+Wt,Nt=1+Wt;at=mt=Pe=Je=null,Be=Fs(F,ze,U-Wt,U+or,0,Ce.minX,Ce.maxX,W),Gt=Fs(F,ze,U+se,U+Nt,0,Ce.minX,Ce.maxX,W),F=null,Be&&(at=Fs(Be,ze,G-Wt,G+or,1,Ce.minY,Ce.maxY,W),mt=Fs(Be,ze,G+se,G+Nt,1,Ce.minY,Ce.maxY,W),Be=null),Gt&&(Pe=Fs(Gt,ze,G-Wt,G+or,1,Ce.minY,Ce.maxY,W),Je=Fs(Gt,ze,G+se,G+Nt,1,Ce.minY,Ce.maxY,W),Gt=null),re>1&&console.timeEnd("clipping"),K.push(at||[],z+1,2*U,2*G),K.push(mt||[],z+1,2*U,2*G+1),K.push(Pe||[],z+1,2*U+1,2*G),K.push(Je||[],z+1,2*U+1,2*G+1)}}},Vl.prototype.getTile=function(F,z,U){var G=this.options,te=G.extent,ue=G.debug;if(F<0||F>24)return null;var he=1<<F,K=Ea(F,z=(z%he+he)%he,U);if(this.tiles[K])return Bl(this.tiles[K],te);ue>1&&console.log("drilling down to z%d-%d-%d",F,z,U);for(var W,re=F,ze=z,Ke=U;!W&&re>0;)re--,ze=Math.floor(ze/2),Ke=Math.floor(Ke/2),W=this.tiles[Ea(re,ze,Ke)];return W&&W.source?(ue>1&&console.log("found parent tile z%d-%d-%d",re,ze,Ke),ue>1&&console.time("drilling down"),this.splitTile(W.source,re,ze,Ke,F,z,U),ue>1&&console.timeEnd("drilling down"),this.tiles[K]?Bl(this.tiles[K],te):null):null};var zl=function(F){function z(U,G,te,ue){F.call(this,U,G,te,Nc),ue&&(this.loadGeoJSON=ue)}return F&&(z.__proto__=F),(z.prototype=Object.create(F&&F.prototype)).constructor=z,z.prototype.loadData=function(U,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=U,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},z.prototype._loadData=function(){var U=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,te=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ue=!!(te&&te.request&&te.request.collectResourceTiming)&&new v.RequestPerformance(te.request);this.loadGeoJSON(te,function(he,K){if(he||!K)return G(he);if("object"!=typeof K)return G(new Error("Input data given to '"+te.source+"' is not a valid GeoJSON object."));!function Ce(je,ot){var at,mt=je&&je.type;if("FeatureCollection"===mt)for(at=0;at<je.features.length;at++)Ce(je.features[at],ot);else if("GeometryCollection"===mt)for(at=0;at<je.geometries.length;at++)Ce(je.geometries[at],ot);else if("Feature"===mt)Ce(je.geometry,ot);else if("Polygon"===mt)wu(je.coordinates,ot);else if("MultiPolygon"===mt)for(at=0;at<je.coordinates.length;at++)wu(je.coordinates[at],ot);return je}(K,!0);try{if(te.filter){var W=v.createExpression(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===W.result)throw new Error(W.value.map(function(Ce){return Ce.key+": "+Ce.message}).join(", "));var re=K.features.filter(function(Ce){return W.value.evaluate({zoom:0},Ce)});K={type:"FeatureCollection",features:re}}U._geoJSONIndex=te.cluster?new Ri(function(Ce){var je=Ce.superclusterOptions,ot=Ce.clusterProperties;if(!ot||!je)return je;for(var at={},mt={},Pe={accumulated:null,zoom:0},Je={properties:null},Be=Object.keys(ot),Gt=0,Wt=Be;Gt<Wt.length;Gt+=1){var se=Wt[Gt],or=ot[se],Nt=or[0],Jt=v.createExpression(or[1]),br=v.createExpression("string"==typeof Nt?[Nt,["accumulated"],["get",se]]:Nt);at[se]=Jt.value,mt[se]=br.value}return je.map=function(An){Je.properties=An;for(var ut={},Rr=0,gn=Be;Rr<gn.length;Rr+=1){var an=gn[Rr];ut[an]=at[an].evaluate(Pe,Je)}return ut},je.reduce=function(An,ut){Je.properties=ut;for(var Rr=0,gn=Be;Rr<gn.length;Rr+=1){var an=gn[Rr];Pe.accumulated=An[an],An[an]=mt[an].evaluate(Pe,Je)}},je}(te)).load(K.features):new Vl(Ce=K,te.geojsonVtOptions)}catch(Ce){return G(Ce)}var Ce;U.loaded={};var ze={};if(ue){var Ke=ue.finish();Ke&&(ze.resourceTiming={},ze.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ke)))}G(null,ze)})}},z.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},z.prototype.reloadTile=function(U,G){var te=this.loaded;return te&&te[U.uid]?F.prototype.reloadTile.call(this,U,G):this.loadTile(U,G)},z.prototype.loadGeoJSON=function(U,G){if(U.request)v.getJSON(U.request,G);else{if("string"!=typeof U.data)return G(new Error("Input data given to '"+U.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(U.data))}catch{return G(new Error("Input data given to '"+U.source+"' is not a valid GeoJSON object."))}}},z.prototype.removeSource=function(U,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},z.prototype.getClusterExpansionZoom=function(U,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(te){G(te)}},z.prototype.getClusterChildren=function(U,G){try{G(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(te){G(te)}},z.prototype.getClusterLeaves=function(U,G){try{G(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(te){G(te)}},z}(wo),Xn=function(F){var z=this;this.self=F,this.actor=new v.Actor(F,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:wo,geojson:zl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(U,G){if(z.workerSourceTypes[U])throw new Error('Worker source with name "'+U+'" already registered.');z.workerSourceTypes[U]=G},this.self.registerRTLTextPlugin=function(U){if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=U.applyArabicShaping,v.plugin.processBidirectionalText=U.processBidirectionalText,v.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}};return Xn.prototype.setReferrer=function(F,z){this.referrer=z},Xn.prototype.setImages=function(F,z,U){for(var G in this.availableImages[F]=z,this.workerSources[F]){var te=this.workerSources[F][G];for(var ue in te)te[ue].availableImages=z}U()},Xn.prototype.setLayers=function(F,z,U){this.getLayerIndex(F).replace(z),U()},Xn.prototype.updateLayers=function(F,z,U){this.getLayerIndex(F).update(z.layers,z.removedIds),U()},Xn.prototype.loadTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).loadTile(z,U)},Xn.prototype.loadDEMTile=function(F,z,U){this.getDEMWorkerSource(F,z.source).loadTile(z,U)},Xn.prototype.reloadTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).reloadTile(z,U)},Xn.prototype.abortTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).abortTile(z,U)},Xn.prototype.removeTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).removeTile(z,U)},Xn.prototype.removeDEMTile=function(F,z){this.getDEMWorkerSource(F,z.source).removeTile(z)},Xn.prototype.removeSource=function(F,z,U){if(this.workerSources[F]&&this.workerSources[F][z.type]&&this.workerSources[F][z.type][z.source]){var G=this.workerSources[F][z.type][z.source];delete this.workerSources[F][z.type][z.source],void 0!==G.removeSource?G.removeSource(z,U):U()}},Xn.prototype.loadWorkerSource=function(F,z,U){try{this.self.importScripts(z.url),U()}catch(G){U(G.toString())}},Xn.prototype.syncRTLPluginState=function(F,z,U){try{v.plugin.setState(z);var G=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=G){this.self.importScripts(G);var te=v.plugin.isParsed();U(te?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),te)}}catch(ue){U(ue.toString())}},Xn.prototype.getAvailableImages=function(F){var z=this.availableImages[F];return z||(z=[]),z},Xn.prototype.getLayerIndex=function(F){var z=this.layerIndexes[F];return z||(z=this.layerIndexes[F]=new yt),z},Xn.prototype.getWorkerSource=function(F,z,U){var G=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][z]||(this.workerSources[F][z]={}),this.workerSources[F][z][U]||(this.workerSources[F][z][U]=new this.workerSourceTypes[z]({send:function(te,ue,he){G.actor.send(te,ue,he,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][z][U]},Xn.prototype.getDEMWorkerSource=function(F,z){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][z]||(this.demWorkerSources[F][z]=new Wi),this.demWorkerSources[F][z]},Xn.prototype.enforceCacheSizeLimit=function(F,z){v.enforceCacheSizeLimit(z)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Xn(self)),Xn}),Td(0,function(v){var zo=v.createCommonjsModule(function(d){function f(w){return!h(w)}function h(w){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,I,M=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(M);try{I=new Worker(L),T=!0}catch{T=!1}return I&&I.terminate(),URL.revokeObjectURL(L),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var I=T.getContext("2d");if(!I)return!1;var M=I.getImageData(0,0,1,1);return M&&M.width===T.width}()?(void 0===g[C=w&&w.failIfMajorPerformanceCaveat]&&(g[C]=function(T){var L,$,q,I=(L=T,$=document.createElement("canvas"),(q=Object.create(f.webGLContextAttributes)).failIfMajorPerformanceCaveat=L,$.probablySupportsContext?$.probablySupportsContext("webgl",q)||$.probablySupportsContext("experimental-webgl",q):$.supportsContext?$.supportsContext("webgl",q)||$.supportsContext("experimental-webgl",q):$.getContext("webgl",q)||$.getContext("experimental-webgl",q));if(!I)return!1;var M=I.createShader(I.VERTEX_SHADER);return!(!M||I.isContextLost())&&(I.shaderSource(M,"void main() {}"),I.compileShader(M),!0===I.getShaderParameter(M,I.COMPILE_STATUS))}(C)),g[C]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var C}d.exports?d.exports=f:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=f,window.mapboxgl.notSupportedReason=h);var g={};f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),Ve={create:function(d,f,h){var g=v.window.document.createElement(d);return void 0!==f&&(g.className=f),h&&h.appendChild(g),g},createNS:function(d,f){return v.window.document.createElementNS(d,f)}},yt=v.window.document&&v.window.document.documentElement.style;function Vt(d){if(!yt)return d[0];for(var f=0;f<d.length;f++)if(d[f]in yt)return d[f];return d[0]}var Qa,ft=Vt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);Ve.disableDrag=function(){yt&&ft&&(Qa=yt[ft],yt[ft]="none")},Ve.enableDrag=function(){yt&&ft&&(yt[ft]=Qa)};var Pl=Vt(["transform","WebkitTransform"]);Ve.setTransform=function(d,f){d.style[Pl]=f};var wo=!1;try{var Ac=Object.defineProperty({},"passive",{get:function(){wo=!0}});v.window.addEventListener("test",Ac,Ac),v.window.removeEventListener("test",Ac,Ac)}catch{wo=!1}Ve.addEventListener=function(d,f,h,g){void 0===g&&(g={}),d.addEventListener(f,h,"passive"in g&&wo?g:g.capture)},Ve.removeEventListener=function(d,f,h,g){void 0===g&&(g={}),d.removeEventListener(f,h,"passive"in g&&wo?g:g.capture)};var Wi=function(d){d.preventDefault(),d.stopPropagation(),v.window.removeEventListener("click",Wi,!0)};function wu(d){var f=d.userImage;return!!(f&&f.render&&f.render())&&(d.data.replace(new Uint8Array(f.data.buffer)),!0)}Ve.suppressClick=function(){v.window.addEventListener("click",Wi,!0),v.window.setTimeout(function(){v.window.removeEventListener("click",Wi,!0)},0)},Ve.mousePos=function(d,f){var h=d.getBoundingClientRect();return new v.Point(f.clientX-h.left-d.clientLeft,f.clientY-h.top-d.clientTop)},Ve.touchPos=function(d,f){for(var h=d.getBoundingClientRect(),g=[],w=0;w<f.length;w++)g.push(new v.Point(f[w].clientX-h.left-d.clientLeft,f[w].clientY-h.top-d.clientTop));return g},Ve.mouseButton=function(d){return void 0!==v.window.InstallTrigger&&2===d.button&&d.ctrlKey&&v.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},Ve.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};var ki=function(d){function f(){d.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var g=0,w=this.requestors;g<w.length;g+=1){var C=w[g];this._notify(C.ids,C.callback)}this.requestors=[]}},f.prototype.getImage=function(h){return this.images[h]},f.prototype.addImage=function(h,g){this._validate(h,g)&&(this.images[h]=g)},f.prototype._validate=function(h,g){var w=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),w=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),w=!1),this._validateContent(g.content,g)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),w=!1),w},f.prototype._validateStretch=function(h,g){if(!h)return!0;for(var w=0,C=0,T=h;C<T.length;C+=1){var I=T[C];if(I[0]<w||I[1]<I[0]||g<I[1])return!1;w=I[1]}return!0},f.prototype._validateContent=function(h,g){return!(h&&(4!==h.length||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},f.prototype.updateImage=function(h,g){g.version=this.images[h].version+1,this.images[h]=g,this.updatedImages[h]=!0},f.prototype.removeImage=function(h){var g=this.images[h];delete this.images[h],delete this.patterns[h],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(h,g){var w=!0;if(!this.isLoaded())for(var C=0,T=h;C<T.length;C+=1)this.images[T[C]]||(w=!1);this.isLoaded()||w?this._notify(h,g):this.requestors.push({ids:h,callback:g})},f.prototype._notify=function(h,g){for(var w={},C=0,T=h;C<T.length;C+=1){var I=T[C];this.images[I]||this.fire(new v.Event("styleimagemissing",{id:I}));var M=this.images[I];M?w[I]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!(!M.userImage||!M.userImage.render)}:v.warnOnce('Image "'+I+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,w)},f.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},f.prototype.getPattern=function(h){var g=this.patterns[h],w=this.getImage(h);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{var C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},T=new v.ImagePosition(C,w);this.patterns[h]={bin:C,position:T}}return this._updatePatternAtlas(),this.patterns[h].position},f.prototype.bind=function(h){var g=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.Texture(h,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var h=[];for(var g in this.patterns)h.push(this.patterns[g].bin);var w=v.potpack(h),C=w.w,T=w.h,I=this.atlasImage;for(var M in I.resize({width:C||1,height:T||1}),this.patterns){var L=this.patterns[M].bin,$=L.x+1,q=L.y+1,j=this.images[M].data,ne=j.width,J=j.height;v.RGBAImage.copy(j,I,{x:0,y:0},{x:$,y:q},{width:ne,height:J}),v.RGBAImage.copy(j,I,{x:0,y:J-1},{x:$,y:q-1},{width:ne,height:1}),v.RGBAImage.copy(j,I,{x:0,y:0},{x:$,y:q+J},{width:ne,height:1}),v.RGBAImage.copy(j,I,{x:ne-1,y:0},{x:$-1,y:q},{width:1,height:J}),v.RGBAImage.copy(j,I,{x:0,y:0},{x:$+ne,y:q},{width:1,height:J})}this.dirty=!0},f.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},f.prototype.dispatchRenderCallbacks=function(h){for(var g=0,w=h;g<w.length;g+=1){var C=w[g];if(!this.callbackDispatchedThisFrame[C]){this.callbackDispatchedThisFrame[C]=!0;var T=this.images[C];wu(T)&&this.updateImage(C,T)}}},f}(v.Evented),$h=xu,Ja=xu,Yo=1e20;function xu(d,f,h,g,w,C){this.fontSize=d||24,this.buffer=void 0===f?3:f,this.cutoff=g||.25,this.fontFamily=w||"sans-serif",this.fontWeight=C||"normal",this.radius=h||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ga(d,f,h,g,w,C,T){for(var I=0;I<f;I++){for(var M=0;M<h;M++)g[M]=d[M*f+I];for(Rc(g,w,C,T,h),M=0;M<h;M++)d[M*f+I]=w[M]}for(M=0;M<h;M++){for(I=0;I<f;I++)g[I]=d[M*f+I];for(Rc(g,w,C,T,f),I=0;I<f;I++)d[M*f+I]=Math.sqrt(w[I])}}function Rc(d,f,h,g,w){h[0]=0,g[0]=-Yo,g[1]=+Yo;for(var C=1,T=0;C<w;C++){for(var I=(d[C]+C*C-(d[h[T]]+h[T]*h[T]))/(2*C-2*h[T]);I<=g[T];)T--,I=(d[C]+C*C-(d[h[T]]+h[T]*h[T]))/(2*C-2*h[T]);h[++T]=C,g[T]=I,g[T+1]=+Yo}for(C=0,T=0;C<w;C++){for(;g[T+1]<C;)T++;f[C]=(C-h[T])*(C-h[T])+d[h[T]]}}xu.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var f=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var w=f.data[4*g+3]/255;this.gridOuter[g]=1===w?0:0===w?Yo:Math.pow(Math.max(0,.5-w),2),this.gridInner[g]=1===w?Yo:0===w?0:Math.pow(Math.max(0,w-.5),2)}for(ga(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ga(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)h[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return h},$h.default=Ja;var Ai=function(d,f){this.requestManager=d,this.localIdeographFontFamily=f,this.entries={}};Ai.prototype.setURL=function(d){this.url=d},Ai.prototype.getGlyphs=function(d,f){var h=this,g=[];for(var w in d)for(var C=0,T=d[w];C<T.length;C+=1)g.push({stack:w,id:T[C]});v.asyncAll(g,function(I,M){var L=I.stack,$=I.id,q=h.entries[L];q||(q=h.entries[L]={glyphs:{},requests:{},ranges:{}});var j=q.glyphs[$];if(void 0===j){if(j=h._tinySDF(q,L,$))return q.glyphs[$]=j,void M(null,{stack:L,id:$,glyph:j});var ne=Math.floor($/256);if(256*ne>65535)M(new Error("glyphs > 65535 not supported"));else if(q.ranges[ne])M(null,{stack:L,id:$,glyph:j});else{var J=q.requests[ne];J||(J=q.requests[ne]=[],Ai.loadGlyphRange(L,ne,h.url,h.requestManager,function(ae,ee){if(ee){for(var ie in ee)h._doesCharSupportLocalGlyph(+ie)||(q.glyphs[+ie]=ee[+ie]);q.ranges[ne]=!0}for(var de=0,me=J;de<me.length;de+=1)(0,me[de])(ae,ee);delete q.requests[ne]})),J.push(function(ae,ee){ae?M(ae):ee&&M(null,{stack:L,id:$,glyph:ee[$]||null})})}}else M(null,{stack:L,id:$,glyph:j})},function(I,M){if(I)f(I);else if(M){for(var L={},$=0,q=M;$<q.length;$+=1){var j=q[$],ne=j.stack,J=j.id,ae=j.glyph;(L[ne]||(L[ne]={}))[J]=ae&&{id:ae.id,bitmap:ae.bitmap.clone(),metrics:ae.metrics}}f(null,L)}})},Ai.prototype._doesCharSupportLocalGlyph=function(d){return!!this.localIdeographFontFamily&&(v.isChar["CJK Unified Ideographs"](d)||v.isChar["Hangul Syllables"](d)||v.isChar.Hiragana(d)||v.isChar.Katakana(d))},Ai.prototype._tinySDF=function(d,f,h){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(h)){var w=d.tinySDF;if(!w){var C="400";/bold/i.test(f)?C="900":/medium/i.test(f)?C="500":/light/i.test(f)&&(C="200"),w=d.tinySDF=new Ai.TinySDF(24,3,8,.25,g,C)}return{id:h,bitmap:new v.AlphaImage({width:30,height:30},w.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ai.loadGlyphRange=function(d,f,h,g,w){var C=256*f,T=C+255,I=g.transformRequest(g.normalizeGlyphsURL(h).replace("{fontstack}",d).replace("{range}",C+"-"+T),v.ResourceType.Glyphs);v.getArrayBuffer(I,function(M,L){if(M)w(M);else if(L){for(var $={},q=0,j=v.parseGlyphPBF(L);q<j.length;q+=1){var ne=j[q];$[ne.id]=ne}w(null,$)}})},Ai.TinySDF=$h;var _s=function(){this.specification=v.styleSpec.light.position};_s.prototype.possiblyEvaluate=function(d,f){return v.sphericalToCartesian(d.expression.evaluate(f))},_s.prototype.interpolate=function(d,f,h){return{x:v.number(d.x,f.x,h),y:v.number(d.y,f.y,h),z:v.number(d.z,f.z,h)}};var Os=new v.Properties({anchor:new v.DataConstantProperty(v.styleSpec.light.anchor),position:new _s,color:new v.DataConstantProperty(v.styleSpec.light.color),intensity:new v.DataConstantProperty(v.styleSpec.light.intensity)}),Ol=function(d){function f(h){d.call(this),this._transitionable=new v.Transitionable(Os),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getLight=function(){return this._transitionable.serialize()},f.prototype.setLight=function(h,g){if(void 0===g&&(g={}),!this._validate(v.validateLight,h,g))for(var w in h){var C=h[w];v.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),C):this._transitionable.setValue(w,C)}},f.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},f.prototype.hasTransition=function(){return this._transitioning.hasTransition()},f.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},f.prototype._validate=function(h,g,w){return(!w||!1!==w.validate)&&v.emitValidationErrors(this,h.call(v.validateStyle,v.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:v.styleSpec})))},f}(v.Evented),lr=function(d,f){this.width=d,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};lr.prototype.getDash=function(d,f){var h=d.join(",")+String(f);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(d,f)),this.dashEntry[h]},lr.prototype.getDashRanges=function(d,f,h){var g=[],w=d.length%2==1?-d[d.length-1]*h:0,C=d[0]*h,T=!0;g.push({left:w,right:C,isDash:T,zeroLength:0===d[0]});for(var I=d[0],M=1;M<d.length;M++){var L=d[M];g.push({left:w=I*h,right:C=(I+=L)*h,isDash:T=!T,zeroLength:0===L})}return g},lr.prototype.addRoundDash=function(d,f,h){for(var g=f/2,w=-h;w<=h;w++)for(var C=this.width*(this.nextRow+h+w),T=0,I=d[T],M=0;M<this.width;M++){M/I.right>1&&(I=d[++T]);var L=Math.abs(M-I.left),$=Math.abs(M-I.right),q=Math.min(L,$),j=void 0,ne=w/h*(g+1);if(I.isDash){var J=g-Math.abs(ne);j=Math.sqrt(q*q+J*J)}else j=g-Math.sqrt(q*q+ne*ne);this.data[C+M]=Math.max(0,Math.min(255,j+128))}},lr.prototype.addRegularDash=function(d){for(var f=d.length-1;f>=0;--f){var h=d[f],g=d[f+1];h.zeroLength?d.splice(f,1):g&&g.isDash===h.isDash&&(g.left=h.left,d.splice(f,1))}var w=d[0],C=d[d.length-1];w.isDash===C.isDash&&(w.left=C.left-this.width,C.right=w.right+this.width);for(var T=this.width*this.nextRow,I=0,M=d[I],L=0;L<this.width;L++){L/M.right>1&&(M=d[++I]);var $=Math.abs(L-M.left),q=Math.abs(L-M.right),j=Math.min($,q);this.data[T+L]=Math.max(0,Math.min(255,(M.isDash?j:-j)+128))}},lr.prototype.addDash=function(d,f){var h=f?7:0,g=2*h+1;if(this.nextRow+g>this.height)return v.warnOnce("LineAtlas out of space"),null;for(var w=0,C=0;C<d.length;C++)w+=d[C];if(0!==w){var T=this.width/w,I=this.getDashRanges(d,this.width,T);f?this.addRoundDash(I,T,h):this.addRegularDash(I)}var M={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:w};return this.nextRow+=g,this.dirty=!0,M},lr.prototype.bind=function(d){var f=d.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))};var xo=function d(f,h){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=v.uniqueId();for(var g=this.workerPool.acquire(this.id),w=0;w<g.length;w++){var C=new d.Actor(g[w],h,this.id);C.name="Worker "+w,this.actors.push(C)}};function Sp(d,f,h){var g=function(w,C){if(w)return h(w);if(C){var T=v.pick(v.extend(C,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(T.vectorLayers=C.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(I){return I.id})),T.tiles=f.canonicalizeTileset(T,d.url),h(null,T)}};return d.url?v.getJSON(f.transformRequest(f.normalizeSourceURL(d.url),v.ResourceType.Source),g):v.browser.frame(function(){return g(null,d)})}xo.prototype.broadcast=function(d,f,h){v.asyncAll(this.actors,function(g,w){g.send(d,f,w)},h=h||function(){})},xo.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},xo.prototype.remove=function(){this.actors.forEach(function(d){d.remove()}),this.actors=[],this.workerPool.release(this.id)},xo.Actor=v.Actor;var ys=function(d,f,h){this.bounds=v.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=f||0,this.maxzoom=h||24};ys.prototype.validateBounds=function(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]},ys.prototype.contains=function(d){var f=Math.pow(2,d.z),h=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*f),g=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*f),w=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*f),C=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*f);return d.x>=h&&d.x<w&&d.y>=g&&d.y<C};var Nl=function(d){function f(h,g,w,C){if(d.call(this),this.id=h,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(g,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Sp(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new ys(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles,h.map._requestManager._customAccessToken),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},f.prototype.setTiles=function(h){var g=this;return this.setSourceProperty(function(){g._options.tiles=h}),this},f.prototype.setUrl=function(h){var g=this;return this.setSourceProperty(function(){g.url=h,g._options.url=h}),this},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return v.extend({},this._options)},f.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(w,v.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(I,M){return delete h.request,h.aborted?g(null):I&&404!==I.status?g(I):(M&&M.resourceTiming&&(h.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&h.setExpiryData(M),h.loadVectorData(M,this.map.painter),v.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state?"loading"===h.state?h.reloadCallback=g:h.request=h.actor.send("reloadTile",C,T.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",C,T.bind(this)))},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},f.prototype.hasTransition=function(){return!1},f}(v.Evented),Eu=function(d){function f(h,g,w,C){d.call(this),this.id=h,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},g),v.extend(this,v.pick(g,["url","scheme","tileSize"]))}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Sp(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new ys(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},f.prototype.loaded=function(){return this._loaded},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},f.prototype.serialize=function(){return v.extend({},this._options)},f.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},f.prototype.loadTile=function(h,g){var w=this,C=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=v.getImage(this.map._requestManager.transformRequest(C,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){w.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var M=w.map.painter.context,L=M.gl;h.texture=w.map.painter.getTileTexture(I.width),h.texture?h.texture.update(I,{useMipmap:!0}):(h.texture=new v.Texture(M,I,L.RGBA,{useMipmap:!0}),h.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),M.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax)),h.state="loaded",v.cacheEntryPossiblyAdded(w.dispatcher),g(null)}})},f.prototype.abortTile=function(h,g){h.request&&(h.request.cancel(),delete h.request),g()},f.prototype.unloadTile=function(h,g){h.texture&&this.map.painter.saveTileTexture(h.texture),g()},f.prototype.hasTransition=function(){return!1},f}(v.Evented),_a=function(d){function f(h,g,w,C){d.call(this,h,g,w,C),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},f.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function C(T,I){T&&(h.state="errored",g(T)),I&&(h.dem=I,h.needsHillshadePrepare=!0,h.state="loaded",g(null))}h.request=v.getImage(this.map._requestManager.transformRequest(w,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){this.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var M=v.window.ImageBitmap&&I instanceof v.window.ImageBitmap&&v.offscreenCanvasSupported()?I:v.browser.getImageData(I,1),L={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:M,encoding:this.encoding};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",L,C.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},f.prototype._getNeighboringTiles=function(h){var g=h.canonical,w=Math.pow(2,g.z),C=(g.x-1+w)%w,T=0===g.x?h.wrap-1:h.wrap,I=(g.x+1+w)%w,M=g.x+1===w?h.wrap+1:h.wrap,L={};return L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,M,g.z,I,g.y).key]={backfilled:!1},g.y>0&&(L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y-1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,M,g.z,I,g.y-1).key]={backfilled:!1}),g.y+1<w&&(L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y+1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,M,g.z,I,g.y+1).key]={backfilled:!1}),L},f.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},f}(Eu),vs=function(d){function f(h,g,w,C){d.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=w.getActor(),this.setEventedParent(C),this._data=g.data,this._options=v.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var T=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(void 0!==g.buffer?g.buffer:128)*T,tolerance:(void 0!==g.tolerance?g.tolerance:.375)*T,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:void 0!==g.clusterMaxZoom?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:v.EXTENT,radius:(g.clusterRadius||50)*T,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var h=this;this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)h.fire(new v.ErrorEvent(g));else{var w={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(w.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new v.Event("data",w))}})},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setData=function(h){var g=this;return this._data=h,this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(w){if(w)g.fire(new v.ErrorEvent(w));else{var C={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(C.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new v.Event("data",C))}}),this},f.prototype.getClusterExpansionZoom=function(h,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},g),this},f.prototype.getClusterChildren=function(h,g){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},g),this},f.prototype.getClusterLeaves=function(h,g,w,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:g,offset:w},C),this},f.prototype._updateWorkerData=function(h){var g=this;this._loaded=!1;var w=v.extend({},this.workerOptions),C=this._data;"string"==typeof C?(w.request=this.map._requestManager.transformRequest(v.browser.resolveURL(C),v.ResourceType.Source),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(C),this.actor.send(this.type+".loadData",w,function(T,I){g._removed||I&&I.abandoned||(g._loaded=!0,I&&I.resourceTiming&&I.resourceTiming[g.id]&&(g._resourceTiming=I.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:w.source},null),h(T))})},f.prototype.loaded=function(){return this._loaded},f.prototype.loadTile=function(h,g){var w=this,C=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(C,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,I){return delete h.request,h.unloadVectorData(),h.aborted?g(null):T?g(T):(h.loadVectorData(I,w.map.painter,"reloadTile"===C),g(null))})},f.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},f.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},f.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},f.prototype.serialize=function(){return v.extend({},this._options,{type:this.type,data:this._data})},f.prototype.hasTransition=function(){return!1},f}(v.Evented),Zi=v.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ya=function(d){function f(h,g,w,C){d.call(this),this.id=h,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=g}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(h,g){var w=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,v.getImage(this.map._requestManager.transformRequest(this.url,v.ResourceType.Image),function(C,T){w._loaded=!0,C?w.fire(new v.ErrorEvent(C)):T&&(w.image=T,h&&(w.coordinates=h),g&&g(),w._finishLoading())})},f.prototype.loaded=function(){return this._loaded},f.prototype.updateImage=function(h){var g=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){g.texture=null}),this):this},f.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))},f.prototype.onAdd=function(h){this.map=h,this.load()},f.prototype.setCoordinates=function(h){var g=this;this.coordinates=h;var w=h.map(v.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var I=1/0,M=1/0,L=-1/0,$=-1/0,q=0,j=T;q<j.length;q+=1){var ne=j[q];I=Math.min(I,ne.x),M=Math.min(M,ne.y),L=Math.max(L,ne.x),$=Math.max($,ne.y)}var J=Math.max(L-I,$-M),ae=Math.max(0,Math.floor(-Math.log(J)/Math.LN2)),ee=Math.pow(2,ae);return new v.CanonicalTileID(ae,Math.floor((I+L)/2*ee),Math.floor((M+$)/2*ee))}(w),this.minzoom=this.maxzoom=this.tileID.z;var C=w.map(function(T){return g.tileID.getTilePoint(T)._round()});return this._boundsArray=new v.StructArrayLayout4i8,this._boundsArray.emplaceBack(C[0].x,C[0].y,0,0),this._boundsArray.emplaceBack(C[1].x,C[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(C[3].x,C[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(C[2].x,C[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this},f.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Zi.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v.Texture(h,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var C=this.tiles[w];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture)}}},f.prototype.loadTile=function(h,g){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},g(null)):(h.state="errored",g(null))},f.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return!1},f}(v.Evented),Mc=function(d){function f(h,g,w,C){d.call(this,h,g,w,C),this.roundZoom=!0,this.type="video",this.options=g}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){var h=this;this._loaded=!1;var g=this.options;this.urls=[];for(var w=0,C=g.urls;w<C.length;w+=1)this.urls.push(this.map._requestManager.transformRequest(C[w],v.ResourceType.Source).url);v.getVideo(this.urls,function(T,I){h._loaded=!0,T?h.fire(new v.ErrorEvent(T)):I&&(h.video=I,h.video.loop=!0,h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},f.prototype.pause=function(){this.video&&this.video.pause()},f.prototype.play=function(){this.video&&this.video.play()},f.prototype.seek=function(h){if(this.video){var g=this.video.seekable;h<g.start(0)||h>g.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=h}},f.prototype.getVideo=function(){return this.video},f.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},f.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,Zi.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new v.Texture(h,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var C=this.tiles[w];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this.video&&!this.video.paused},f}(ya),Ll=function(d){function f(h,g,w,C){d.call(this,h,g,w,C),g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(I){return"number"!=typeof I})})||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "coordinates"'))),g.animate&&"boolean"!=typeof g.animate&&this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),g.canvas?"string"==typeof g.canvas||g.canvas instanceof v.window.HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=g,this.animate=void 0===g.animate||g.animate}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof v.window.HTMLCanvasElement?this.options.canvas:v.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},f.prototype.getCanvas=function(){return this.canvas},f.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},f.prototype.onRemove=function(){this.pause()},f.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,w=g.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,Zi.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.Texture(g,this.canvas,w.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[C];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},f.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},f.prototype.hasTransition=function(){return this._playing},f.prototype._hasInvalidDimensions=function(){for(var h=0,g=[this.canvas.width,this.canvas.height];h<g.length;h+=1){var w=g[h];if(isNaN(w)||w<=0)return!0}return!1},f}(ya),el={vector:Nl,raster:Eu,"raster-dem":_a,geojson:vs,video:Mc,image:ya,canvas:Ll};function Ip(d,f){var h=v.identity([]);return v.translate(h,h,[1,1,0]),v.scale(h,h,[.5*d.width,.5*d.height,1]),v.multiply(h,h,d.calculatePosMatrix(f.toUnwrapped()))}function Ri(d,f,h,g,w,C){var T=function(ae,ee,ie){if(ae)for(var de=0,me=ae;de<me.length;de+=1){var Ie=ee[me[de]];if(Ie&&Ie.source===ie&&"fill-extrusion"===Ie.type)return!0}else for(var Ee in ee){var ke=ee[Ee];if(ke.source===ie&&"fill-extrusion"===ke.type)return!0}return!1}(w&&w.layers,f,d.id),I=C.maxPitchScaleFactor(),M=d.tilesIn(g,I,T);M.sort(tl);for(var L=[],$=0,q=M;$<q.length;$+=1){var j=q[$];L.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(f,h,d._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,w,C,I,Ip(d.transform,j.tileID))})}var ne=function(ae){for(var ee={},ie={},de=0,me=ae;de<me.length;de+=1){var Ie=me[de],Ee=Ie.queryResults,ke=Ie.wrappedTileID,Ne=ie[ke]=ie[ke]||{};for(var Ze in Ee)for(var He=Ee[Ze],rt=Ne[Ze]=Ne[Ze]||{},gt=ee[Ze]=ee[Ze]||[],bt=0,vt=He;bt<vt.length;bt+=1){var ln=vt[bt];rt[ln.featureIndex]||(rt[ln.featureIndex]=!0,gt.push(ln))}}return ee}(L);for(var J in ne)ne[J].forEach(function(ae){var ee=ae.feature,ie=d.getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=ie});return ne}function tl(d,f){var h=d.tileID,g=f.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}var Yn=function(d,f){this.max=d,this.onRemove=f,this.reset()};Yn.prototype.reset=function(){for(var d in this.data)for(var f=0,h=this.data[d];f<h.length;f+=1){var g=h[f];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},Yn.prototype.add=function(d,f,h){var g=this,w=d.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);var C={value:f,timeout:void 0};if(void 0!==h&&(C.timeout=setTimeout(function(){g.remove(d,C)},h)),this.data[w].push(C),this.order.push(w),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},Yn.prototype.has=function(d){return d.wrapped().key in this.data},Yn.prototype.getAndRemove=function(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null},Yn.prototype._getAndRemoveByKey=function(d){var f=this.data[d].shift();return f.timeout&&clearTimeout(f.timeout),0===this.data[d].length&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),f.value},Yn.prototype.getByKey=function(d){var f=this.data[d];return f?f[0].value:null},Yn.prototype.get=function(d){return this.has(d)?this.data[d.wrapped().key][0].value:null},Yn.prototype.remove=function(d,f){if(!this.has(d))return this;var h=d.wrapped().key,g=void 0===f?0:this.data[h].indexOf(f),w=this.data[h][g];return this.data[h].splice(g,1),w.timeout&&clearTimeout(w.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(w.value),this.order.splice(this.order.indexOf(h),1),this},Yn.prototype.setMaxSize=function(d){for(this.max=d;this.order.length>this.max;){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},Yn.prototype.filter=function(d){var f=[];for(var h in this.data)for(var g=0,w=this.data[h];g<w.length;g+=1){var C=w[g];d(C.value)||f.push(C)}for(var T=0,I=f;T<I.length;T+=1){var M=I[T];this.remove(M.value.tileID,M)}};var va=function(d,f,h){this.context=d;var g=d.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};va.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},va.prototype.updateData=function(d){var f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)},va.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var nl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ns=function(d,f,h,g){this.length=f.length,this.attributes=h,this.itemSize=f.bytesPerElement,this.dynamicDraw=g,this.context=d;var w=d.gl;this.buffer=w.createBuffer(),d.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer};Ns.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ns.prototype.updateData=function(d){var f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,d.arrayBuffer)},Ns.prototype.enableAttributes=function(d,f){for(var h=0;h<this.attributes.length;h++){var g=f.attributes[this.attributes[h].name];void 0!==g&&d.enableVertexAttribArray(g)}},Ns.prototype.setVertexAttribPointers=function(d,f,h){for(var g=0;g<this.attributes.length;g++){var w=this.attributes[g],C=f.attributes[w.name];void 0!==C&&d.vertexAttribPointer(C,w.components,d[nl[w.type]],!1,this.itemSize,w.offset+this.itemSize*(h||0))}},Ns.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var bn=function(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};bn.prototype.get=function(){return this.current},bn.prototype.set=function(d){},bn.prototype.getDefault=function(){return this.default},bn.prototype.setDefault=function(){this.set(this.default)};var ba=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return v.Color.transparent},f.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(bn),Eo=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 1},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},f}(bn),Ls=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},f}(bn),kp=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return[!0,!0,!0,!0]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(bn),Ks=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},f}(bn),cr=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 255},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},f}(bn),Xo=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},f.prototype.set=function(h){var g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},f}(bn),rl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},f}(bn),il=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}},f}(bn),Hn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return[0,1]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},f}(bn),bs=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}},f}(bn),Fl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.LESS},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},f}(bn),Fs=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}},f}(bn),wa=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},f}(bn),Pc=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return v.Color.transparent},f.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},f}(bn),Cu=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.FUNC_ADD},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},f}(bn),xa=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}},f}(bn),Du=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.BACK},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},f}(bn),qh=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.CCW},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},f}(bn),Tu=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},f}(bn),Oc=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return this.gl.TEXTURE0},f.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},f}(bn),ws=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},f.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},f}(bn),Bl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},f}(bn),Sd=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(bn),Su=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}},f}(bn),Id=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},f}(bn),ol=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},f}(bn),Vl=function(d){function f(h){d.call(this,h),this.vao=h.extVertexArrayObject}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},f}(bn),Ea=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return 4},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},f}(bn),Nc=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},f}(bn),zl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return!1},f.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},f}(bn),Xn=function(d){function f(h,g){d.call(this,h),this.context=h,this.parent=g}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getDefault=function(){return null},f}(bn),F=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.setDirty=function(){this.dirty=!0},f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},f}(Xn),z=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},f}(Xn),U=function(d,f,h,g){this.context=d,this.width=f,this.height=h;var w=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new F(d,w),g&&(this.depthAttachment=new z(d,w))};U.prototype.destroy=function(){var d=this.context.gl,f=this.colorAttachment.get();if(f&&d.deleteTexture(f),this.depthAttachment){var h=this.depthAttachment.get();h&&d.deleteRenderbuffer(h)}d.deleteFramebuffer(this.framebuffer)};var G=function(d,f,h){this.func=d,this.mask=f,this.range=h};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var te=function(d,f,h,g,w,C){this.test=d,this.ref=f,this.mask=h,this.fail=g,this.depthFail=w,this.pass=C};te.disabled=new te({func:519,mask:0},0,0,7680,7680,7680);var ue=function(d,f,h){this.blendFunction=d,this.blendColor=f,this.mask=h};ue.disabled=new ue(ue.Replace=[1,0],v.Color.transparent,[!1,!1,!1,!1]),ue.unblended=new ue(ue.Replace,v.Color.transparent,[!0,!0,!0,!0]),ue.alphaBlended=new ue([1,771],v.Color.transparent,[!0,!0,!0,!0]);var he=function(d,f,h){this.enable=d,this.mode=f,this.frontFace=h};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var K=function(d){this.gl=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ba(this),this.clearDepth=new Eo(this),this.clearStencil=new Ls(this),this.colorMask=new kp(this),this.depthMask=new Ks(this),this.stencilMask=new cr(this),this.stencilFunc=new Xo(this),this.stencilOp=new rl(this),this.stencilTest=new il(this),this.depthRange=new Hn(this),this.depthTest=new bs(this),this.depthFunc=new Fl(this),this.blend=new Fs(this),this.blendFunc=new wa(this),this.blendColor=new Pc(this),this.blendEquation=new Cu(this),this.cullFace=new xa(this),this.cullFaceSide=new Du(this),this.frontFace=new qh(this),this.program=new Tu(this),this.activeTexture=new Oc(this),this.viewport=new ws(this),this.bindFramebuffer=new Bl(this),this.bindRenderbuffer=new Sd(this),this.bindTexture=new Su(this),this.bindVertexBuffer=new Id(this),this.bindElementBuffer=new ol(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Vl(this),this.pixelStoreUnpack=new Ea(this),this.pixelStoreUnpackPremultiplyAlpha=new Nc(this),this.pixelStoreUnpackFlipY=new zl(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=d.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(d.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)};K.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},K.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},K.prototype.createIndexBuffer=function(d,f){return new va(this,d,f)},K.prototype.createVertexBuffer=function(d,f,h){return new Ns(this,d,f,h)},K.prototype.createRenderbuffer=function(d,f,h){var g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,d,f,h),this.bindRenderbuffer.set(null),w},K.prototype.createFramebuffer=function(d,f,h){return new U(this,d,f,h)},K.prototype.clear=function(d){var f=d.color,h=d.depth,g=this.gl,w=0;f&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(f),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g.clear(w)},K.prototype.setCullFace=function(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))},K.prototype.setDepthMode=function(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)},K.prototype.setStencilMode=function(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)},K.prototype.setColorMode=function(d){v.deepEqual(d.blendFunction,ue.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)},K.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var W=function(d){function f(h,g,w){var C=this;d.call(this),this.id=h,this.dispatcher=w,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(C._sourceLoaded=!0),C._sourceLoaded&&!C._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(C.reload(),C.transform&&C.update(C.transform))}),this.on("error",function(){C._sourceErrored=!0}),this._source=function(T,I,M,L){var $=new el[I.type](T,I,M,L);if($.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+$.id);return v.bindAll(["load","abort","unload","serialize","prepare"],$),$}(h,g,w,this),this._tiles={},this._cache=new Yn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new v.SourceFeatureState}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},f.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},f.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var g=this._tiles[h];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0},f.prototype.getSource=function(){return this._source},f.prototype.pause=function(){this._paused=!0},f.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},f.prototype._loadTile=function(h,g){return this._source.loadTile(h,g)},f.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},f.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},f.prototype.serialize=function(){return this._source.serialize()},f.prototype.prepare=function(h){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var w=this._tiles[g];w.upload(h),w.prepare(this.map.style.imageManager)}},f.prototype.getIds=function(){return v.values(this._tiles).map(function(h){return h.tileID}).sort(re).map(function(h){return h.key})},f.prototype.getRenderableIds=function(h){var g=this,w=[];for(var C in this._tiles)this._isIdRenderable(C,h)&&w.push(this._tiles[C]);return h?w.sort(function(T,I){var M=T.tileID,L=I.tileID,$=new v.Point(M.canonical.x,M.canonical.y)._rotate(g.transform.angle),q=new v.Point(L.canonical.x,L.canonical.y)._rotate(g.transform.angle);return M.overscaledZ-L.overscaledZ||q.y-$.y||q.x-$.x}).map(function(T){return T.tileID.key}):w.map(function(T){return T.tileID}).sort(re).map(function(T){return T.key})},f.prototype.hasRenderableParent=function(h){var g=this.findLoadedParent(h,0);return!!g&&this._isIdRenderable(g.tileID.key)},f.prototype._isIdRenderable=function(h,g){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(g||!this._tiles[h].holdingForFade())},f.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)"errored"!==this._tiles[h].state&&this._reloadTile(h,"reloading")},f.prototype._reloadTile=function(h,g){var w=this._tiles[h];w&&("loading"!==w.state&&(w.state=g),this._loadTile(w,this._tileLoaded.bind(this,w,h,g)))},f.prototype._tileLoaded=function(h,g,w,C){if(C)return h.state="errored",void(404!==C.status?this._source.fire(new v.ErrorEvent(C,{tile:h})):this.update(this.transform));h.timeAdded=v.browser.now(),"expired"===w&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(g,h),"raster-dem"===this.getSource().type&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new v.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},f.prototype._backfillDEM=function(h){for(var g=this.getRenderableIds(),w=0;w<g.length;w++){var C=g[w];if(h.neighboringTiles&&h.neighboringTiles[C]){var T=this.getTileByID(C);I(h,T),I(T,h)}}function I(M,L){M.needsHillshadePrepare=!0;var $=L.tileID.canonical.x-M.tileID.canonical.x,q=L.tileID.canonical.y-M.tileID.canonical.y,j=Math.pow(2,M.tileID.canonical.z),ne=L.tileID.key;0===$&&0===q||Math.abs(q)>1||(Math.abs($)>1&&(1===Math.abs($+j)?$+=j:1===Math.abs($-j)&&($-=j)),L.dem&&M.dem&&(M.dem.backfillBorder(L.dem,$,q),M.neighboringTiles&&M.neighboringTiles[ne]&&(M.neighboringTiles[ne].backfilled=!0)))}},f.prototype.getTile=function(h){return this.getTileByID(h.key)},f.prototype.getTileByID=function(h){return this._tiles[h]},f.prototype._retainLoadedChildren=function(h,g,w,C){for(var T in this._tiles){var I=this._tiles[T];if(!(C[T]||!I.hasData()||I.tileID.overscaledZ<=g||I.tileID.overscaledZ>w)){for(var M=I.tileID;I&&I.tileID.overscaledZ>g+1;){var L=I.tileID.scaledTo(I.tileID.overscaledZ-1);(I=this._tiles[L.key])&&I.hasData()&&(M=L)}for(var $=M;$.overscaledZ>g;)if(h[($=$.scaledTo($.overscaledZ-1)).key]){C[M.key]=M;break}}}},f.prototype.findLoadedParent=function(h,g){if(h.key in this._loadedParentTiles){var w=this._loadedParentTiles[h.key];return w&&w.tileID.overscaledZ>=g?w:null}for(var C=h.overscaledZ-1;C>=g;C--){var T=h.scaledTo(C),I=this._getLoadedTile(T);if(I)return I}},f.prototype._getLoadedTile=function(h){var g=this._tiles[h.key];return g&&g.hasData()?g:this._cache.getByKey(h.wrapped().key)},f.prototype.updateCacheSize=function(h){var g=Math.ceil(h.width/this._source.tileSize)+1,w=Math.ceil(h.height/this._source.tileSize)+1,C=Math.floor(g*w*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(T)},f.prototype.handleWrapJump=function(h){var g=Math.round((h-(void 0===this._prevLng?h:this._prevLng))/360);if(this._prevLng=h,g){var w={};for(var C in this._tiles){var T=this._tiles[C];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+g),w[T.tileID.key]=T}for(var I in this._tiles=w,this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(var M in this._tiles)this._setTileReloadTimer(M,this._tiles[M])}},f.prototype.update=function(h){var g=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var w;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?w=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ne){return new v.OverscaledTileID(Ne.canonical.z,Ne.wrap,Ne.canonical.z,Ne.canonical.x,Ne.canonical.y)}):(w=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(w=w.filter(function(Ne){return g._source.hasTile(Ne)}))):w=[];var C=h.coveringZoomLevel(this._source),T=Math.max(C-f.maxOverzooming,this._source.minzoom),I=Math.max(C+f.maxUnderzooming,this._source.minzoom),M=this._updateRetainedTiles(w,C);if(ze(this._source.type)){for(var L={},$={},q=0,j=Object.keys(M);q<j.length;q+=1){var ne=j[q],J=M[ne],ae=this._tiles[ne];if(ae&&!(ae.fadeEndTime&&ae.fadeEndTime<=v.browser.now())){var ee=this.findLoadedParent(J,T);ee&&(this._addTile(ee.tileID),L[ee.tileID.key]=ee.tileID),$[ne]=J}}for(var ie in this._retainLoadedChildren($,C,I,M),L)M[ie]||(this._coveredTiles[ie]=!0,M[ie]=L[ie])}for(var de in M)this._tiles[de].clearFadeHold();for(var me=0,Ie=v.keysDifference(this._tiles,M);me<Ie.length;me+=1){var Ee=Ie[me],ke=this._tiles[Ee];ke.hasSymbolBuckets&&!ke.holdingForFade()?ke.setHoldDuration(this.map._fadeDuration):ke.hasSymbolBuckets&&!ke.symbolFadeFinished()||this._removeTile(Ee)}this._updateLoadedParentTileCache()}},f.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},f.prototype._updateRetainedTiles=function(h,g){for(var w={},C={},T=Math.max(g-f.maxOverzooming,this._source.minzoom),I=Math.max(g+f.maxUnderzooming,this._source.minzoom),M={},L=0,$=h;L<$.length;L+=1){var q=$[L],j=this._addTile(q);w[q.key]=q,j.hasData()||g<this._source.maxzoom&&(M[q.key]=q)}this._retainLoadedChildren(M,g,I,w);for(var ne=0,J=h;ne<J.length;ne+=1){var ae=J[ne],ee=this._tiles[ae.key];if(!ee.hasData()){if(g+1>this._source.maxzoom){var ie=ae.children(this._source.maxzoom)[0],de=this.getTile(ie);if(de&&de.hasData()){w[ie.key]=ie;continue}}else{var me=ae.children(this._source.maxzoom);if(w[me[0].key]&&w[me[1].key]&&w[me[2].key]&&w[me[3].key])continue}for(var Ie=ee.wasRequested(),Ee=ae.overscaledZ-1;Ee>=T;--Ee){var ke=ae.scaledTo(Ee);if(C[ke.key]||(C[ke.key]=!0,!(ee=this.getTile(ke))&&Ie&&(ee=this._addTile(ke)),ee&&(w[ke.key]=ke,Ie=ee.wasRequested(),ee.hasData())))break}}}return w},f.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var g=[],w=void 0,C=this._tiles[h].tileID;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){w=this._loadedParentTiles[C.key];break}g.push(C.key);var T=C.scaledTo(C.overscaledZ-1);if(w=this._getLoadedTile(T))break;C=T}for(var I=0,M=g;I<M.length;I+=1)this._loadedParentTiles[M[I]]=w}},f.prototype._addTile=function(h){var g=this._tiles[h.key];if(g)return g;(g=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,g),g.tileID=h,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,g)));var w=!!g;return w||(g=new v.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,h.key,g.state))),g?(g.uses++,this._tiles[h.key]=g,w||this._source.fire(new v.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},f.prototype._setTileReloadTimer=function(h,g){var w=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var C=g.getExpiryTimeout();C&&(this._timers[h]=setTimeout(function(){w._reloadTile(h,"expired"),delete w._timers[h]},C))},f.prototype._removeTile=function(h){var g=this._tiles[h];g&&(g.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),g.uses>0||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},f.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},f.prototype.tilesIn=function(h,g,w){var C=this,T=[],I=this.transform;if(!I)return T;for(var M=w?I.getCameraQueryGeometry(h):h,L=h.map(function(Ee){return I.pointCoordinate(Ee)}),$=M.map(function(Ee){return I.pointCoordinate(Ee)}),q=this.getIds(),j=1/0,ne=1/0,J=-1/0,ae=-1/0,ee=0,ie=$;ee<ie.length;ee+=1){var de=ie[ee];j=Math.min(j,de.x),ne=Math.min(ne,de.y),J=Math.max(J,de.x),ae=Math.max(ae,de.y)}for(var me=function(Ee){var ke=C._tiles[q[Ee]];if(!ke.holdingForFade()){var Ne=ke.tileID,Ze=Math.pow(2,I.zoom-ke.tileID.overscaledZ),He=g*ke.queryPadding*v.EXTENT/ke.tileSize/Ze,rt=[Ne.getTilePoint(new v.MercatorCoordinate(j,ne)),Ne.getTilePoint(new v.MercatorCoordinate(J,ae))];if(rt[0].x-He<v.EXTENT&&rt[0].y-He<v.EXTENT&&rt[1].x+He>=0&&rt[1].y+He>=0){var gt=L.map(function(vt){return Ne.getTilePoint(vt)}),bt=$.map(function(vt){return Ne.getTilePoint(vt)});T.push({tile:ke,tileID:Ne,queryGeometry:gt,cameraQueryGeometry:bt,scale:Ze})}}},Ie=0;Ie<q.length;Ie++)me(Ie);return T},f.prototype.getVisibleCoordinates=function(h){for(var g=this,w=this.getRenderableIds(h).map(function(M){return g._tiles[M].tileID}),C=0,T=w;C<T.length;C+=1){var I=T[C];I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped())}return w},f.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ze(this._source.type))for(var h in this._tiles){var g=this._tiles[h];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=v.browser.now())return!0}return!1},f.prototype.setFeatureState=function(h,g,w){this._state.updateState(h=h||"_geojsonTileLayer",g,w)},f.prototype.removeFeatureState=function(h,g,w){this._state.removeFeatureState(h=h||"_geojsonTileLayer",g,w)},f.prototype.getFeatureState=function(h,g){return this._state.getState(h=h||"_geojsonTileLayer",g)},f.prototype.setDependencies=function(h,g,w){var C=this._tiles[h];C&&C.setDependencies(g,w)},f.prototype.reloadTilesForDependencies=function(h,g){for(var w in this._tiles)this._tiles[w].hasDependency(h,g)&&this._reloadTile(w,"reloading");this._cache.filter(function(C){return!C.hasDependency(h,g)})},f}(v.Evented);function re(d,f){var h=Math.abs(2*d.wrap)-+(d.wrap<0),g=Math.abs(2*f.wrap)-+(f.wrap<0);return d.overscaledZ-f.overscaledZ||g-h||f.canonical.y-d.canonical.y||f.canonical.x-d.canonical.x}function ze(d){return"raster"===d||"image"===d||"video"===d}function Ke(){return new v.window.Worker(Up.workerUrl)}W.maxOverzooming=10,W.maxUnderzooming=3;var Ce="mapboxgl_preloaded_worker_pool",je=function(){this.active={}};je.prototype.acquire=function(d){if(!this.workers)for(this.workers=[];this.workers.length<je.workerCount;)this.workers.push(new Ke);return this.active[d]=!0,this.workers.slice()},je.prototype.release=function(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(function(f){f.terminate()}),this.workers=null)},je.prototype.isPreloaded=function(){return!!this.active[Ce]},je.prototype.numActive=function(){return Object.keys(this.active).length};var ot,at=Math.floor(v.browser.hardwareConcurrency/2);function mt(){return ot||(ot=new je),ot}function Pe(d,f){var h={};for(var g in d)"ref"!==g&&(h[g]=d[g]);return v.refProperties.forEach(function(w){w in f&&(h[w]=f[w])}),h}function Je(d){d=d.slice();for(var f=Object.create(null),h=0;h<d.length;h++)f[d[h].id]=d[h];for(var g=0;g<d.length;g++)"ref"in d[g]&&(d[g]=Pe(d[g],f[d[g].ref]));return d}je.workerCount=Math.max(Math.min(at,6),1);var Be={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Gt(d,f,h){h.push({command:Be.addSource,args:[d,f[d]]})}function Wt(d,f,h){f.push({command:Be.removeSource,args:[d]}),h[d]=!0}function se(d,f,h,g){Wt(d,h,g),Gt(d,f,h)}function or(d,f,h){var g;for(g in d[h])if(d[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],f[h][g]))return!1;for(g in f[h])if(f[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],f[h][g]))return!1;return!0}function Nt(d,f,h,g,w,C){var T;for(T in f=f||{},d=d||{})d.hasOwnProperty(T)&&(v.deepEqual(d[T],f[T])||h.push({command:C,args:[g,T,f[T],w]}));for(T in f)f.hasOwnProperty(T)&&!d.hasOwnProperty(T)&&(v.deepEqual(d[T],f[T])||h.push({command:C,args:[g,T,f[T],w]}))}function Jt(d){return d.id}function br(d,f){return d[f.id]=f,d}var An=function(d,f){this.reset(d,f)};An.prototype.reset=function(d,f){this.points=d||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding},An.prototype.lerp=function(d){if(1===this.points.length)return this.points[0];d=v.clamp(d,0,1);for(var f=1,h=this._distances[f],g=d*this.paddedLength+this.padding;h<g&&f<this._distances.length;)h=this._distances[++f];var w=f-1,C=this._distances[w],T=h-C,I=T>0?(g-C)/T:0;return this.points[w].mult(1-I).add(this.points[f].mult(I))};var ut=function(d,f,h){var g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(d/h),this.yCellCount=Math.ceil(f/h);for(var C=0;C<this.xCellCount*this.yCellCount;C++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=f,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0};function Rr(d,f,h,g,w){var C=v.create();return f?(v.scale(C,C,[1/w,1/w,1]),h||v.rotateZ(C,C,g.angle)):v.multiply(C,g.labelPlaneMatrix,d),C}function gn(d,f,h,g,w){if(f){var C=v.clone(d);return v.scale(C,C,[w,w,1]),h||v.rotateZ(C,C,-g.angle),C}return g.glCoordMatrix}function an(d,f){var h=[d.x,d.y,0,1];Ys(h,h,f);var g=h[3];return{point:new v.Point(h[0]/g,h[1]/g),signedDistanceFromCamera:g}}function kd(d,f){return.5+d/f*.5}function mn(d,f){var h=d[0]/d[3],g=d[1]/d[3];return h>=-f[0]&&h<=f[0]&&g>=-f[1]&&g<=f[1]}function $n(d,f,h,g,w,C,T,I){var M=g?d.textSizeData:d.iconSizeData,L=v.evaluateSizeForZoom(M,h.transform.zoom),$=[256/h.width*2+1,256/h.height*2+1],q=g?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;q.clear();for(var j=d.lineVertexArray,ne=g?d.text.placedSymbolArray:d.icon.placedSymbolArray,J=h.transform.width/h.transform.height,ae=!1,ee=0;ee<ne.length;ee++){var ie=ne.get(ee);if(ie.hidden||ie.writingMode===v.WritingMode.vertical&&!ae)Co(ie.numGlyphs,q);else{ae=!1;var de=[ie.anchorX,ie.anchorY,0,1];if(v.transformMat4(de,de,f),mn(de,$)){var me=kd(h.transform.cameraToCenterDistance,de[3]),Ie=v.evaluateSizeForFeature(M,L,ie),Ee=T?Ie/me:Ie*me,ke=new v.Point(ie.anchorX,ie.anchorY),Ne=an(ke,w).point,Ze={},He=wr(ie,Ee,!1,I,f,w,C,d.glyphOffsetArray,j,q,Ne,ke,Ze,J);ae=He.useVertical,(He.notEnoughRoom||ae||He.needsFlipping&&wr(ie,Ee,!0,I,f,w,C,d.glyphOffsetArray,j,q,Ne,ke,Ze,J).notEnoughRoom)&&Co(ie.numGlyphs,q)}else Co(ie.numGlyphs,q)}}g?d.text.dynamicLayoutVertexBuffer.updateData(q):d.icon.dynamicLayoutVertexBuffer.updateData(q)}function cn(d,f,h,g,w,C,T,I,M,L,$){var q=I.glyphStartIndex+I.numGlyphs,j=I.lineStartIndex,ne=I.lineStartIndex+I.lineLength,J=f.getoffsetX(I.glyphStartIndex),ae=f.getoffsetX(q-1),ee=Lc(d*J,h,g,w,C,T,I.segment,j,ne,M,L,$);if(!ee)return null;var ie=Lc(d*ae,h,g,w,C,T,I.segment,j,ne,M,L,$);return ie?{first:ee,last:ie}:null}function Qr(d,f,h,g){return d===v.WritingMode.horizontal&&Math.abs(h.y-f.y)>Math.abs(h.x-f.x)*g?{useVertical:!0}:(d===v.WritingMode.vertical?f.y<h.y:f.x>h.x)?{needsFlipping:!0}:null}function wr(d,f,h,g,w,C,T,I,M,L,$,q,j,ne){var J,ae=f/24,ee=d.lineOffsetX*ae,ie=d.lineOffsetY*ae;if(d.numGlyphs>1){var de=d.glyphStartIndex+d.numGlyphs,me=d.lineStartIndex,Ie=d.lineStartIndex+d.lineLength,Ee=cn(ae,I,ee,ie,h,$,q,d,M,C,j);if(!Ee)return{notEnoughRoom:!0};var ke=an(Ee.first.point,T).point,Ne=an(Ee.last.point,T).point;if(g&&!h){var Ze=Qr(d.writingMode,ke,Ne,ne);if(Ze)return Ze}J=[Ee.first];for(var He=d.glyphStartIndex+1;He<de-1;He++)J.push(Lc(ae*I.getoffsetX(He),ee,ie,h,$,q,d.segment,me,Ie,M,C,j));J.push(Ee.last)}else{if(g&&!h){var rt=an(q,w).point,gt=d.lineStartIndex+d.segment+1,bt=new v.Point(M.getx(gt),M.gety(gt)),vt=an(bt,w),ln=vt.signedDistanceFromCamera>0?vt.point:Cg(q,bt,rt,1,w),st=Qr(d.writingMode,rt,ln,ne);if(st)return st}var Ht=Lc(ae*I.getoffsetX(d.glyphStartIndex),ee,ie,h,$,q,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,M,C,j);if(!Ht)return{notEnoughRoom:!0};J=[Ht]}for(var on=0,Ye=J;on<Ye.length;on+=1){var Pt=Ye[on];v.addDynamicAttributes(L,Pt.point,Pt.angle)}return{}}function Cg(d,f,h,g,w){var C=an(d.add(d.sub(f)._unit()),w).point,T=h.sub(C);return h.add(T._mult(g/T.mag()))}function Lc(d,f,h,g,w,C,T,I,M,L,$,q){var j=g?d-f:d+f,ne=j>0?1:-1,J=0;g&&(ne*=-1,J=Math.PI),ne<0&&(J+=Math.PI);for(var ae=ne>0?I+T:I+T+1,ee=w,ie=w,de=0,me=0,Ie=Math.abs(j),Ee=[];de+me<=Ie;){if((ae+=ne)<I||ae>=M)return null;if(ie=ee,Ee.push(ee),void 0===(ee=q[ae])){var ke=new v.Point(L.getx(ae),L.gety(ae)),Ne=an(ke,$);if(Ne.signedDistanceFromCamera>0)ee=q[ae]=Ne.point;else{var Ze=ae-ne;ee=Cg(0===de?C:new v.Point(L.getx(Ze),L.gety(Ze)),ke,ie,Ie-de+1,$)}}de+=me,me=ie.dist(ee)}var He=(Ie-de)/me,rt=ee.sub(ie),gt=rt.mult(He)._add(ie);gt._add(rt._unit()._perp()._mult(h*ne));var bt=J+Math.atan2(ee.y-ie.y,ee.x-ie.x);return Ee.push(gt),{point:gt,angle:bt,path:Ee}}ut.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ut.prototype.insert=function(d,f,h,g,w){this._forEachCell(f,h,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(f),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(w)},ut.prototype.insertCircle=function(d,f,h,g){this._forEachCell(f-g,h-g,f+g,h+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(f),this.circles.push(h),this.circles.push(g)},ut.prototype._insertBoxCell=function(d,f,h,g,w,C){this.boxCells[w].push(C)},ut.prototype._insertCircleCell=function(d,f,h,g,w,C){this.circleCells[w].push(C)},ut.prototype._query=function(d,f,h,g,w,C){if(h<0||d>this.width||g<0||f>this.height)return!w&&[];var T=[];if(d<=0&&f<=0&&this.width<=h&&this.height<=g){if(w)return!0;for(var I=0;I<this.boxKeys.length;I++)T.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(var M=0;M<this.circleKeys.length;M++){var L=this.circles[3*M],$=this.circles[3*M+1],q=this.circles[3*M+2];T.push({key:this.circleKeys[M],x1:L-q,y1:$-q,x2:L+q,y2:$+q})}return C?T.filter(C):T}return this._forEachCell(d,f,h,g,this._queryCell,T,{hitTest:w,seenUids:{box:{},circle:{}}},C),w?T.length>0:T},ut.prototype._queryCircle=function(d,f,h,g,w){var C=d-h,T=d+h,I=f-h,M=f+h;if(T<0||C>this.width||M<0||I>this.height)return!g&&[];var L=[];return this._forEachCell(C,I,T,M,this._queryCellCircle,L,{hitTest:g,circle:{x:d,y:f,radius:h},seenUids:{box:{},circle:{}}},w),g?L.length>0:L},ut.prototype.query=function(d,f,h,g,w){return this._query(d,f,h,g,!1,w)},ut.prototype.hitTest=function(d,f,h,g,w){return this._query(d,f,h,g,!0,w)},ut.prototype.hitTestCircle=function(d,f,h,g){return this._queryCircle(d,f,h,!0,g)},ut.prototype._queryCell=function(d,f,h,g,w,C,T,I){var M=T.seenUids,L=this.boxCells[w];if(null!==L)for(var $=this.bboxes,q=0,j=L;q<j.length;q+=1){var ne=j[q];if(!M.box[ne]){M.box[ne]=!0;var J=4*ne;if(d<=$[J+2]&&f<=$[J+3]&&h>=$[J+0]&&g>=$[J+1]&&(!I||I(this.boxKeys[ne]))){if(T.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[ne],x1:$[J],y1:$[J+1],x2:$[J+2],y2:$[J+3]})}}}var ae=this.circleCells[w];if(null!==ae)for(var ee=this.circles,ie=0,de=ae;ie<de.length;ie+=1){var me=de[ie];if(!M.circle[me]){M.circle[me]=!0;var Ie=3*me;if(this._circleAndRectCollide(ee[Ie],ee[Ie+1],ee[Ie+2],d,f,h,g)&&(!I||I(this.circleKeys[me]))){if(T.hitTest)return C.push(!0),!0;var Ee=ee[Ie],ke=ee[Ie+1],Ne=ee[Ie+2];C.push({key:this.circleKeys[me],x1:Ee-Ne,y1:ke-Ne,x2:Ee+Ne,y2:ke+Ne})}}}},ut.prototype._queryCellCircle=function(d,f,h,g,w,C,T,I){var M=T.circle,L=T.seenUids,$=this.boxCells[w];if(null!==$)for(var q=this.bboxes,j=0,ne=$;j<ne.length;j+=1){var J=ne[j];if(!L.box[J]){L.box[J]=!0;var ae=4*J;if(this._circleAndRectCollide(M.x,M.y,M.radius,q[ae+0],q[ae+1],q[ae+2],q[ae+3])&&(!I||I(this.boxKeys[J])))return C.push(!0),!0}}var ee=this.circleCells[w];if(null!==ee)for(var ie=this.circles,de=0,me=ee;de<me.length;de+=1){var Ie=me[de];if(!L.circle[Ie]){L.circle[Ie]=!0;var Ee=3*Ie;if(this._circlesCollide(ie[Ee],ie[Ee+1],ie[Ee+2],M.x,M.y,M.radius)&&(!I||I(this.circleKeys[Ie])))return C.push(!0),!0}}},ut.prototype._forEachCell=function(d,f,h,g,w,C,T,I){for(var M=this._convertToXCellCoord(d),L=this._convertToYCellCoord(f),$=this._convertToXCellCoord(h),q=this._convertToYCellCoord(g),j=M;j<=$;j++)for(var ne=L;ne<=q;ne++)if(w.call(this,d,f,h,g,this.xCellCount*ne+j,C,T,I))return},ut.prototype._convertToXCellCoord=function(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))},ut.prototype._convertToYCellCoord=function(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))},ut.prototype._circlesCollide=function(d,f,h,g,w,C){var T=g-d,I=w-f,M=h+C;return M*M>T*T+I*I},ut.prototype._circleAndRectCollide=function(d,f,h,g,w,C,T){var I=(C-g)/2,M=Math.abs(d-(g+I));if(M>I+h)return!1;var L=(T-w)/2,$=Math.abs(f-(w+L));if($>L+h)return!1;if(M<=I||$<=L)return!0;var q=M-I,j=$-L;return q*q+j*j<=h*h};var Mi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Co(d,f){for(var h=0;h<d;h++){var g=f.length;f.resize(g+4),f.float32.set(Mi,3*g)}}function Ys(d,f,h){var g=f[0],w=f[1];return d[0]=h[0]*g+h[4]*w+h[12],d[1]=h[1]*g+h[5]*w+h[13],d[3]=h[3]*g+h[7]*w+h[15],d}var Dr=function(d,f,h){void 0===f&&(f=new ut(d.width+200,d.height+200,25)),void 0===h&&(h=new ut(d.width+200,d.height+200,25)),this.transform=d,this.grid=f,this.ignoredGrid=h,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+100,this.screenBottomBoundary=d.height+100,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200};function Qo(d,f,h){return f*(v.EXTENT/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}Dr.prototype.placeCollisionBox=function(d,f,h,g,w){var C=this.projectAndGetPerspectiveRatio(g,d.anchorPointX,d.anchorPointY),T=h*C.perspectiveRatio,I=d.x1*T+C.point.x,M=d.y1*T+C.point.y,L=d.x2*T+C.point.x,$=d.y2*T+C.point.y;return!this.isInsideGrid(I,M,L,$)||!f&&this.grid.hitTest(I,M,L,$,w)?{box:[],offscreen:!1}:{box:[I,M,L,$],offscreen:this.isOffscreen(I,M,L,$)}},Dr.prototype.placeCollisionCircles=function(d,f,h,g,w,C,T,I,M,L,$,q,j){var ne=[],J=new v.Point(f.anchorX,f.anchorY),ae=an(J,C),ee=kd(this.transform.cameraToCenterDistance,ae.signedDistanceFromCamera),ie=(L?w/ee:w*ee)/v.ONE_EM,de=an(J,T).point,me=cn(ie,g,f.lineOffsetX*ie,f.lineOffsetY*ie,!1,de,J,f,h,T,{}),Ie=!1,Ee=!1,ke=!0;if(me){for(var Ne=.5*q*ee+j,Ze=new v.Point(-100,-100),He=new v.Point(this.screenRightBoundary,this.screenBottomBoundary),rt=new An,gt=me.first,bt=me.last,vt=[],ln=gt.path.length-1;ln>=1;ln--)vt.push(gt.path[ln]);for(var st=1;st<bt.path.length;st++)vt.push(bt.path[st]);var Ht=2.5*Ne;if(I){var on=vt.map(function(yn){return an(yn,I)});vt=on.some(function(yn){return yn.signedDistanceFromCamera<=0})?[]:on.map(function(yn){return yn.point})}var Ye=[];if(vt.length>0){for(var Pt=vt[0].clone(),Ft=vt[0].clone(),Ot=1;Ot<vt.length;Ot++)Pt.x=Math.min(Pt.x,vt[Ot].x),Pt.y=Math.min(Pt.y,vt[Ot].y),Ft.x=Math.max(Ft.x,vt[Ot].x),Ft.y=Math.max(Ft.y,vt[Ot].y);Ye=Pt.x>=Ze.x&&Ft.x<=He.x&&Pt.y>=Ze.y&&Ft.y<=He.y?[vt]:Ft.x<Ze.x||Pt.x>He.x||Ft.y<Ze.y||Pt.y>He.y?[]:v.clipLine([vt],Ze.x,Ze.y,He.x,He.y)}for(var Tt=0,Jn=Ye;Tt<Jn.length;Tt+=1){var Br;rt.reset(Jn[Tt],.25*Ne),Br=rt.length<=.5*Ne?1:Math.ceil(rt.paddedLength/Ht)+1;for(var eo=0;eo<Br;eo++){var ui=eo/Math.max(Br-1,1),di=rt.lerp(ui),Wr=di.x+100,To=di.y+100;ne.push(Wr,To,Ne,0);var Pa=Wr-Ne,ho=To-Ne,Ae=Wr+Ne,Lt=To+Ne;if(ke=ke&&this.isOffscreen(Pa,ho,Ae,Lt),Ee=Ee||this.isInsideGrid(Pa,ho,Ae,Lt),!d&&this.grid.hitTestCircle(Wr,To,Ne,$)&&(Ie=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!M&&Ie||!Ee?[]:ne,offscreen:ke,collisionDetected:Ie}},Dr.prototype.queryRenderedSymbols=function(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var f=[],h=1/0,g=1/0,w=-1/0,C=-1/0,T=0,I=d;T<I.length;T+=1){var M=I[T],L=new v.Point(M.x+100,M.y+100);h=Math.min(h,L.x),g=Math.min(g,L.y),w=Math.max(w,L.x),C=Math.max(C,L.y),f.push(L)}for(var $={},q={},j=0,ne=this.grid.query(h,g,w,C).concat(this.ignoredGrid.query(h,g,w,C));j<ne.length;j+=1){var J=ne[j],ae=J.key;if(void 0===$[ae.bucketInstanceId]&&($[ae.bucketInstanceId]={}),!$[ae.bucketInstanceId][ae.featureIndex]){var ee=[new v.Point(J.x1,J.y1),new v.Point(J.x2,J.y1),new v.Point(J.x2,J.y2),new v.Point(J.x1,J.y2)];v.polygonIntersectsPolygon(f,ee)&&($[ae.bucketInstanceId][ae.featureIndex]=!0,void 0===q[ae.bucketInstanceId]&&(q[ae.bucketInstanceId]=[]),q[ae.bucketInstanceId].push(ae.featureIndex))}}return q},Dr.prototype.insertCollisionBox=function(d,f,h,g,w){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:w},d[0],d[1],d[2],d[3])},Dr.prototype.insertCollisionCircles=function(d,f,h,g,w){for(var C=f?this.ignoredGrid:this.grid,T={bucketInstanceId:h,featureIndex:g,collisionGroupID:w},I=0;I<d.length;I+=4)C.insertCircle(T,d[I],d[I+1],d[I+2])},Dr.prototype.projectAndGetPerspectiveRatio=function(d,f,h){var g=[f,h,0,1];return Ys(g,g,d),{point:new v.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},Dr.prototype.isOffscreen=function(d,f,h,g){return h<100||d>=this.screenRightBoundary||g<100||f>this.screenBottomBoundary},Dr.prototype.isInsideGrid=function(d,f,h,g){return h>=0&&d<this.gridRightBoundary&&g>=0&&f<this.gridBottomBoundary},Dr.prototype.getViewportMatrix=function(){var d=v.identity([]);return v.translate(d,d,[-100,-100,0]),d};var io=function(d,f,h,g){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?f:-f))):g&&h?1:0,this.placed=h};io.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Jo=function(d,f,h,g,w){this.text=new io(d?d.text:null,f,h,w),this.icon=new io(d?d.icon:null,f,g,w)};Jo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ul=function(d,f,h){this.text=d,this.icon=f,this.skipFade=h},Hy=function(){this.invProjMatrix=v.create(),this.viewportMatrix=v.create(),this.circles=[]},Xs=function(d,f,h,g,w){this.bucketInstanceId=d,this.featureIndex=f,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=w},oo=function(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}};function Dt(d,f,h,g,w){var C=v.getAnchorAlignment(d),T=-(C.horizontalAlign-.5)*f,I=-(C.verticalAlign-.5)*h,M=v.evaluateVariableOffset(d,g);return new v.Point(T+M[0]*w,I+M[1]*w)}function Ki(d,f,h,g,w,C){var T=d.x1,I=d.x2,M=d.y1,L=d.y2,$=d.anchorPointX,q=d.anchorPointY,j=new v.Point(f,h);return g&&j._rotate(w?C:-C),{x1:T+j.x,y1:M+j.y,x2:I+j.x,y2:L+j.y,anchorPointX:$,anchorPointY:q}}oo.prototype.get=function(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){var f=++this.maxGroupID;this.collisionGroups[d]={ID:f,predicate:function(h){return h.collisionGroupID===f}}}return this.collisionGroups[d]};var yi=function(d,f,h,g){this.transform=d.clone(),this.collisionIndex=new Dr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new oo(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Iu(d,f,h,g,w){d.emplaceBack(f?1:0,h?1:0,g||0,w||0),d.emplaceBack(f?1:0,h?1:0,g||0,w||0),d.emplaceBack(f?1:0,h?1:0,g||0,w||0),d.emplaceBack(f?1:0,h?1:0,g||0,w||0)}yi.prototype.getBucketParts=function(d,f,h,g){var w=h.getBucket(f),C=h.latestFeatureIndex;if(w&&C&&f.id===w.layerIds[0]){var T=h.collisionBoxArray,I=w.layers[0].layout,M=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),L=h.tileSize/v.EXTENT,$=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),q="map"===I.get("text-pitch-alignment"),j="map"===I.get("text-rotation-alignment"),ne=Qo(h,1,this.transform.zoom),J=Rr($,q,j,this.transform,ne),ae=null;if(q){var ee=gn($,q,j,this.transform,ne);ae=v.multiply([],this.transform.labelPlaneMatrix,ee)}this.retainedQueryData[w.bucketInstanceId]=new Xs(w.bucketInstanceId,C,w.sourceLayerIndex,w.index,h.tileID);var ie={bucket:w,layout:I,posMatrix:$,textLabelPlaneMatrix:J,labelToScreenMatrix:ae,scale:M,textPixelRatio:L,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(var de=0,me=w.sortKeyRanges;de<me.length;de+=1){var Ie=me[de];d.push({sortKey:Ie.sortKey,symbolInstanceStart:Ie.symbolInstanceStart,symbolInstanceEnd:Ie.symbolInstanceEnd,parameters:ie})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:ie})}},yi.prototype.attemptAnchorPlacement=function(d,f,h,g,w,C,T,I,M,L,$,q,j,ne,J){var ae,ee=[q.textOffset0,q.textOffset1],ie=Dt(d,h,g,ee,w),de=this.collisionIndex.placeCollisionBox(Ki(f,ie.x,ie.y,C,T,this.transform.angle),$,I,M,L.predicate);if(!J||0!==this.collisionIndex.placeCollisionBox(Ki(J,ie.x,ie.y,C,T,this.transform.angle),$,I,M,L.predicate).box.length)return de.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID]&&this.prevPlacement.placements[q.crossTileID].text&&(ae=this.prevPlacement.variableOffsets[q.crossTileID].anchor),this.variableOffsets[q.crossTileID]={textOffset:ee,width:h,height:g,anchor:d,textBoxScale:w,prevAnchor:ae},this.markUsedJustification(j,d,q,ne),j.allowVerticalPlacement&&(this.markUsedOrientation(j,ne,q),this.placedOrientations[q.crossTileID]=ne),{shift:ie,placedGlyphBoxes:de}):void 0},yi.prototype.placeLayerBucketPart=function(d,f,h){var g=this,w=d.parameters,C=w.bucket,T=w.layout,I=w.posMatrix,M=w.textLabelPlaneMatrix,L=w.labelToScreenMatrix,$=w.textPixelRatio,q=w.holdingForFade,j=w.collisionBoxArray,ne=w.partiallyEvaluatedTextSize,J=w.collisionGroup,ae=T.get("text-optional"),ee=T.get("icon-optional"),ie=T.get("text-allow-overlap"),de=T.get("icon-allow-overlap"),me="map"===T.get("text-rotation-alignment"),Ie="map"===T.get("text-pitch-alignment"),Ee="none"!==T.get("icon-text-fit"),ke="viewport-y"===T.get("symbol-z-order"),Ne=ie&&(de||!C.hasIconData()||ee),Ze=de&&(ie||!C.hasTextData()||ae);!C.collisionArrays&&j&&C.deserializeCollisionBoxes(j);var He=function(st,Ht){if(!f[st.crossTileID])if(q)g.placements[st.crossTileID]=new Ul(!1,!1,!1);else{var on,Ye=!1,Pt=!1,Ft=!0,Ot=null,Tt={box:null,offscreen:null},Jn={box:null,offscreen:null},Br=null,eo=null,ui=0,di=0,Wr=0;Ht.textFeatureIndex?ui=Ht.textFeatureIndex:st.useRuntimeCollisionCircles&&(ui=st.featureIndex),Ht.verticalTextFeatureIndex&&(di=Ht.verticalTextFeatureIndex);var To=Ht.textBox;if(To){var Pa=function(Sr){var Mn=v.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Sr&&g.prevPlacement){var Mr=g.prevPlacement.placedOrientations[st.crossTileID];Mr&&(g.placedOrientations[st.crossTileID]=Mr,g.markUsedOrientation(C,Mn=Mr,st))}return Mn},ho=function(Sr,Mn){if(C.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Ht.verticalTextBox)for(var Mr=0,Hu=C.writingModes;Mr<Hu.length&&(Hu[Mr]===v.WritingMode.vertical?(Tt=Mn(),Jn=Tt):Tt=Sr(),!(Tt&&Tt.box&&Tt.box.length));Mr+=1);else Tt=Sr()};if(T.get("text-variable-anchor")){var Ae=T.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[st.crossTileID]){var Lt=g.prevPlacement.variableOffsets[st.crossTileID];Ae.indexOf(Lt.anchor)>0&&(Ae=Ae.filter(function(Sr){return Sr!==Lt.anchor})).unshift(Lt.anchor)}var yn=function(Sr,Mn,Mr){for(var Hu=Sr.x2-Sr.x1,Ui=Sr.y2-Sr.y1,ul=st.textBoxScale,gf=Ee&&!de?Mn:null,jd={box:[],offscreen:!1},Mg=ie?2*Ae.length:Ae.length,Hd=0;Hd<Mg;++Hd){var Wc=g.attemptAnchorPlacement(Ae[Hd%Ae.length],Sr,Hu,Ui,ul,me,Ie,$,I,J,Hd>=Ae.length,st,C,Mr,gf);if(Wc&&(jd=Wc.placedGlyphBoxes)&&jd.box&&jd.box.length){Ye=!0,Ot=Wc.shift;break}}return jd};ho(function(){return yn(To,Ht.iconBox,v.WritingMode.horizontal)},function(){var Sr=Ht.verticalTextBox;return C.allowVerticalPlacement&&!(Tt&&Tt.box&&Tt.box.length)&&st.numVerticalGlyphVertices>0&&Sr?yn(Sr,Ht.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),Tt&&(Ye=Tt.box,Ft=Tt.offscreen);var er=Pa(Tt&&Tt.box);if(!Ye&&g.prevPlacement){var $t=g.prevPlacement.variableOffsets[st.crossTileID];$t&&(g.variableOffsets[st.crossTileID]=$t,g.markUsedJustification(C,$t.anchor,st,er))}}else{var $c=function(Sr,Mn){var Mr=g.collisionIndex.placeCollisionBox(Sr,ie,$,I,J.predicate);return Mr&&Mr.box&&Mr.box.length&&(g.markUsedOrientation(C,Mn,st),g.placedOrientations[st.crossTileID]=Mn),Mr};ho(function(){return $c(To,v.WritingMode.horizontal)},function(){var Sr=Ht.verticalTextBox;return C.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Sr?$c(Sr,v.WritingMode.vertical):{box:null,offscreen:null}}),Pa(Tt&&Tt.box&&Tt.box.length)}}if(Ye=(on=Tt)&&on.box&&on.box.length>0,Ft=on&&on.offscreen,st.useRuntimeCollisionCircles){var na=C.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex),Is=v.evaluateSizeForFeature(C.textSizeData,ne,na),qc=T.get("text-padding");Br=g.collisionIndex.placeCollisionCircles(ie,na,C.lineVertexArray,C.glyphOffsetArray,Is,I,M,L,h,Ie,J.predicate,st.collisionCircleDiameter,qc),Ye=ie||Br.circles.length>0&&!Br.collisionDetected,Ft=Ft&&Br.offscreen}if(Ht.iconFeatureIndex&&(Wr=Ht.iconFeatureIndex),Ht.iconBox){var ra=function(Sr){var Mn=Ee&&Ot?Ki(Sr,Ot.x,Ot.y,me,Ie,g.transform.angle):Sr;return g.collisionIndex.placeCollisionBox(Mn,de,$,I,J.predicate)};Pt=Jn&&Jn.box&&Jn.box.length&&Ht.verticalIconBox?(eo=ra(Ht.verticalIconBox)).box.length>0:(eo=ra(Ht.iconBox)).box.length>0,Ft=Ft&&eo.offscreen}var Gc=ae||0===st.numHorizontalGlyphVertices&&0===st.numVerticalGlyphVertices,xi=ee||0===st.numIconVertices;if(Gc||xi?xi?Gc||(Pt=Pt&&Ye):Ye=Pt&&Ye:Pt=Ye=Pt&&Ye,Ye&&on&&on.box&&g.collisionIndex.insertCollisionBox(on.box,T.get("text-ignore-placement"),C.bucketInstanceId,Jn&&Jn.box&&di?di:ui,J.ID),Pt&&eo&&g.collisionIndex.insertCollisionBox(eo.box,T.get("icon-ignore-placement"),C.bucketInstanceId,Wr,J.ID),Br&&(Ye&&g.collisionIndex.insertCollisionCircles(Br.circles,T.get("text-ignore-placement"),C.bucketInstanceId,ui,J.ID),h)){var ec=C.bucketInstanceId,js=g.collisionCircleArrays[ec];void 0===js&&(js=g.collisionCircleArrays[ec]=new Hy);for(var tc=0;tc<Br.circles.length;tc+=4)js.circles.push(Br.circles[tc+0]),js.circles.push(Br.circles[tc+1]),js.circles.push(Br.circles[tc+2]),js.circles.push(Br.collisionDetected?1:0)}g.placements[st.crossTileID]=new Ul(Ye||Ne,Pt||Ze,Ft||C.justReloaded),f[st.crossTileID]=!0}};if(ke)for(var rt=C.getSortedSymbolIndexes(this.transform.angle),gt=rt.length-1;gt>=0;--gt){var bt=rt[gt];He(C.symbolInstances.get(bt),C.collisionArrays[bt])}else for(var vt=d.symbolInstanceStart;vt<d.symbolInstanceEnd;vt++)He(C.symbolInstances.get(vt),C.collisionArrays[vt]);if(h&&C.bucketInstanceId in this.collisionCircleArrays){var ln=this.collisionCircleArrays[C.bucketInstanceId];v.invert(ln.invProjMatrix,I),ln.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1},yi.prototype.markUsedJustification=function(d,f,h,g){var w;w=g===v.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(f)];for(var C=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];C<T.length;C+=1){var I=T[C];I>=0&&(d.text.placedSymbolArray.get(I).crossTileID=w>=0&&I!==w?0:h.crossTileID)}},yi.prototype.markUsedOrientation=function(d,f,h){for(var g=f===v.WritingMode.horizontal||f===v.WritingMode.horizontalOnly?f:0,w=f===v.WritingMode.vertical?f:0,C=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];C<T.length;C+=1)d.text.placedSymbolArray.get(T[C]).placedOrientation=g;h.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=w)},yi.prototype.commit=function(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var f=this.prevPlacement,h=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;var g=f?f.symbolFadeChange(d):1,w=f?f.opacities:{},C=f?f.variableOffsets:{},T=f?f.placedOrientations:{};for(var I in this.placements){var M=this.placements[I],L=w[I];L?(this.opacities[I]=new Jo(L,g,M.text,M.icon),h=h||M.text!==L.text.placed||M.icon!==L.icon.placed):(this.opacities[I]=new Jo(null,g,M.text,M.icon,M.skipFade),h=h||M.text||M.icon)}for(var $ in w){var q=w[$];if(!this.opacities[$]){var j=new Jo(q,g,!1,!1);j.isHidden()||(this.opacities[$]=j,h=h||q.text.placed||q.icon.placed)}}for(var ne in C)this.variableOffsets[ne]||!this.opacities[ne]||this.opacities[ne].isHidden()||(this.variableOffsets[ne]=C[ne]);for(var J in T)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=T[J]);h?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:d)},yi.prototype.updateLayerOpacities=function(d,f){for(var h={},g=0,w=f;g<w.length;g+=1){var C=w[g],T=C.getBucket(d);T&&C.latestFeatureIndex&&d.id===T.layerIds[0]&&this.updateBucketOpacities(T,h,C.collisionBoxArray)}},yi.prototype.updateBucketOpacities=function(d,f,h){var g=this;d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var w=d.layers[0].layout,C=new Jo(null,0,!1,!1,!0),T=w.get("text-allow-overlap"),I=w.get("icon-allow-overlap"),M=w.get("text-variable-anchor"),L="map"===w.get("text-rotation-alignment"),$="map"===w.get("text-pitch-alignment"),q="none"!==w.get("icon-text-fit"),j=new Jo(null,0,T&&(I||!d.hasIconData()||w.get("icon-optional")),I&&(T||!d.hasTextData()||w.get("text-optional")),!0);!d.collisionArrays&&h&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(h);for(var ne=function(ie,de,me){for(var Ie=0;Ie<de/4;Ie++)ie.opacityVertexArray.emplaceBack(me)},J=function(ie){var de=d.symbolInstances.get(ie),me=de.numHorizontalGlyphVertices,Ie=de.numVerticalGlyphVertices,Ee=de.crossTileID,ke=g.opacities[Ee];f[Ee]?ke=C:ke||(g.opacities[Ee]=ke=j),f[Ee]=!0;var Ne=de.numIconVertices>0,Ze=g.placedOrientations[de.crossTileID],He=Ze===v.WritingMode.vertical,rt=Ze===v.WritingMode.horizontal||Ze===v.WritingMode.horizontalOnly;if(me>0||Ie>0){var gt=Rp(ke.text);ne(d.text,me,He?Fc:gt),ne(d.text,Ie,rt?Fc:gt);var bt=ke.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(function(Tt){Tt>=0&&(d.text.placedSymbolArray.get(Tt).hidden=bt||He?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(d.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=bt||rt?1:0);var vt=g.variableOffsets[de.crossTileID];vt&&g.markUsedJustification(d,vt.anchor,de,Ze);var ln=g.placedOrientations[de.crossTileID];ln&&(g.markUsedJustification(d,"left",de,ln),g.markUsedOrientation(d,ln,de))}if(Ne){var st=Rp(ke.icon),Ht=!(q&&de.verticalPlacedIconSymbolIndex&&He);de.placedIconSymbolIndex>=0&&(ne(d.icon,de.numIconVertices,Ht?st:Fc),d.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=ke.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(ne(d.icon,de.numVerticalIconVertices,Ht?Fc:st),d.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=ke.icon.isHidden())}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){var on=d.collisionArrays[ie];if(on){var Ye=new v.Point(0,0);if(on.textBox||on.verticalTextBox){var Pt=!0;if(M){var Ft=g.variableOffsets[Ee];Ft?(Ye=Dt(Ft.anchor,Ft.width,Ft.height,Ft.textOffset,Ft.textBoxScale),L&&Ye._rotate($?g.transform.angle:-g.transform.angle)):Pt=!1}on.textBox&&Iu(d.textCollisionBox.collisionVertexArray,ke.text.placed,!Pt||He,Ye.x,Ye.y),on.verticalTextBox&&Iu(d.textCollisionBox.collisionVertexArray,ke.text.placed,!Pt||rt,Ye.x,Ye.y)}var Ot=!(rt||!on.verticalIconBox);on.iconBox&&Iu(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,Ot,q?Ye.x:0,q?Ye.y:0),on.verticalIconBox&&Iu(d.iconCollisionBox.collisionVertexArray,ke.icon.placed,!Ot,q?Ye.x:0,q?Ye.y:0)}}},ae=0;ae<d.symbolInstances.length;ae++)J(ae);if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){var ee=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=ee.invProjMatrix,d.placementViewportMatrix=ee.viewportMatrix,d.collisionCircleArray=ee.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}},yi.prototype.symbolFadeChange=function(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},yi.prototype.zoomAdjustment=function(d){return Math.max(0,(this.transform.zoom-d)/1.5)},yi.prototype.hasTransitions=function(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration},yi.prototype.stillRecent=function(d,f){var h=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*h>d},yi.prototype.setStale=function(){this.stale=!0};var Ap=Math.pow(2,25),_0=Math.pow(2,24),Ue=Math.pow(2,17),Lr=Math.pow(2,16),Gh=Math.pow(2,9),Dg=Math.pow(2,8),$y=Math.pow(2,1);function Rp(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;var f=d.placed?1:0,h=Math.floor(127*d.opacity);return h*Ap+f*_0+h*Ue+f*Lr+h*Gh+f*Dg+h*$y+f}var Fc=0,Bc=function(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&!d.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Bc.prototype.continuePlacement=function(d,f,h,g,w){for(var C=this._bucketParts;this._currentTileIndex<d.length;)if(f.getBucketParts(C,g,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort(function(T,I){return T.sortKey-I.sortKey}));this._currentPartIndex<C.length;)if(f.placeLayerBucketPart(C[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,w())return!0;return!1};var Vc=function(d,f,h,g,w,C,T){this.placement=new yi(d,w,C,T),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1};Vc.prototype.isDone=function(){return this._done},Vc.prototype.continuePlacement=function(d,f,h){for(var g=this,w=v.browser.now(),C=function(){var M=v.browser.now()-w;return!g._forceFullPlacement&&M>2};this._currentPlacementIndex>=0;){var T=f[d[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=I)&&(!T.maxzoom||T.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Bc(T)),this._inProgressLayer.continuePlacement(h[T.source],this.placement,this._showCollisionBoxes,T,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Vc.prototype.commit=function(d){return this.placement.commit(d),this.placement};var Le=512/v.EXTENT/2,ku=function(d,f,h){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var g=0;g<f.length;g++){var w=f.get(g),C=w.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,d)})}};ku.prototype.getScaledCoordinates=function(d,f){var h=Le/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*v.EXTENT+d.anchorX)*h),y:Math.floor((f.canonical.y*v.EXTENT+d.anchorY)*h)}},ku.prototype.findMatches=function(d,f,h){for(var g=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),w=0;w<d.length;w++){var C=d.get(w);if(!C.crossTileID){var T=this.indexedSymbolInstances[C.key];if(T)for(var I=this.getScaledCoordinates(C,f),M=0,L=T;M<L.length;M+=1){var $=L[M];if(Math.abs($.coord.x-I.x)<=g&&Math.abs($.coord.y-I.y)<=g&&!h[$.crossTileID]){h[$.crossTileID]=!0,C.crossTileID=$.crossTileID;break}}}}};var jl=function(){this.maxCrossTileID=0};jl.prototype.generate=function(){return++this.maxCrossTileID};var Yi=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Yi.prototype.handleWrapJump=function(d){var f=Math.round((d-this.lng)/360);if(0!==f)for(var h in this.indexes){var g=this.indexes[h],w={};for(var C in g){var T=g[C];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+f),w[T.tileID.key]=T}this.indexes[h]=w}this.lng=d},Yi.prototype.addBucket=function(d,f,h){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var g=0;g<f.symbolInstances.length;g++)f.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var w=this.usedCrossTileIDs[d.overscaledZ];for(var C in this.indexes){var T=this.indexes[C];if(Number(C)>d.overscaledZ)for(var I in T){var M=T[I];M.tileID.isChildOf(d)&&M.findMatches(f.symbolInstances,d,w)}else{var L=T[d.scaledTo(Number(C)).key];L&&L.findMatches(f.symbolInstances,d,w)}}for(var $=0;$<f.symbolInstances.length;$++){var q=f.symbolInstances.get($);q.crossTileID||(q.crossTileID=h.generate(),w[q.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new ku(d,f.symbolInstances,f.bucketInstanceId),!0},Yi.prototype.removeBucketCrossTileIDs=function(d,f){for(var h in f.indexedSymbolInstances)for(var g=0,w=f.indexedSymbolInstances[h];g<w.length;g+=1)delete this.usedCrossTileIDs[d][w[g].crossTileID]},Yi.prototype.removeStaleBuckets=function(d){var f=!1;for(var h in this.indexes){var g=this.indexes[h];for(var w in g)d[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,g[w]),delete g[w],f=!0)}return f};var xs=function(){this.layerIndexes={},this.crossTileIDs=new jl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};xs.prototype.addLayer=function(d,f,h){var g=this.layerIndexes[d.id];void 0===g&&(g=this.layerIndexes[d.id]=new Yi);var w=!1,C={};g.handleWrapJump(h);for(var T=0,I=f;T<I.length;T+=1){var M=I[T],L=M.getBucket(d);L&&d.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(M.tileID,L,this.crossTileIDs)&&(w=!0),C[L.bucketInstanceId]=!0)}return g.removeStaleBuckets(C)&&(w=!0),w},xs.prototype.pruneUnusedLayers=function(d){var f={};for(var h in d.forEach(function(g){f[g]=!0}),this.layerIndexes)f[h]||delete this.layerIndexes[h]};var Hl=function(d,f){return v.emitValidationErrors(d,f&&f.filter(function(h){return"source.canvas"!==h.identifier}))},Wh=v.pick(Be,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),$l=v.pick(Be,["setCenter","setZoom","setBearing","setPitch"]),Es=function(){var d={},f=v.styleSpec.$version;for(var h in v.styleSpec.$root){var g,w=v.styleSpec.$root[h];w.required&&null!=(g="version"===h?f:"array"===w.type?[]:{})&&(d[h]=g)}return d}(),ql=function(d){function f(h,g){var w=this;void 0===g&&(g={}),d.call(this),this.map=h,this.dispatcher=new xo(mt(),this),this.imageManager=new ki,this.imageManager.setEventedParent(this),this.glyphManager=new Ai(h._requestManager,g.localIdeographFontFamily),this.lineAtlas=new lr(256,512),this.crossTileSymbolIndex=new xs,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());var C=this;this._rtlTextPluginCallback=f.registerForPluginStateChange(function(T){C.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(I,M){if(v.triggerPluginCompletionEvent(I),M&&M.every(function($){return $}))for(var L in C.sourceCaches)C.sourceCaches[L].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var I=w.sourceCaches[T.sourceId];if(I){var M=I.getSource();if(M&&M.vectorLayerIds)for(var L in w._layers){var $=w._layers[L];$.source===M.id&&w._validateLayer($)}}}})}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.loadURL=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"}));var C="boolean"==typeof g.validate?g.validate:!v.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,g.accessToken);var T=this.map._requestManager.transformRequest(h,v.ResourceType.Style);this._request=v.getJSON(T,function(I,M){w._request=null,I?w.fire(new v.ErrorEvent(I)):M&&w._load(M,C)})},f.prototype.loadJSON=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.browser.frame(function(){w._request=null,w._load(h,!1!==g.validate)})},f.prototype.loadEmpty=function(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(Es,!1)},f.prototype._load=function(h,g){if(!g||!Hl(this,v.validateStyle(h))){for(var w in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(w,h.sources[w],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var C=Je(this.stylesheet.layers);this._order=C.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var T=0,I=C;T<I.length;T+=1){var M=I[T];(M=v.createStyleLayer(M)).setEventedParent(this,{layer:{id:M.id}}),this._layers[M.id]=M,this._serializedLayers[M.id]=M.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ol(this.stylesheet.light),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}},f.prototype._loadSprite=function(h){var g=this;this._spriteRequest=function(w,C,T){var I,M,L,$=v.browser.devicePixelRatio>1?"@2x":"",q=v.getJSON(C.transformRequest(C.normalizeSpriteURL(w,$,".json"),v.ResourceType.SpriteJSON),function(J,ae){q=null,L||(L=J,I=ae,ne())}),j=v.getImage(C.transformRequest(C.normalizeSpriteURL(w,$,".png"),v.ResourceType.SpriteImage),function(J,ae){j=null,L||(L=J,M=ae,ne())});function ne(){if(L)T(L);else if(I&&M){var J=v.browser.getImageData(M),ae={};for(var ee in I){var ie=I[ee],de=ie.width,me=ie.height,Ie=ie.x,Ee=ie.y,ke=ie.sdf,Ne=ie.pixelRatio,Ze=ie.stretchX,He=ie.stretchY,rt=ie.content,gt=new v.RGBAImage({width:de,height:me});v.RGBAImage.copy(J,gt,{x:Ie,y:Ee},{x:0,y:0},{width:de,height:me}),ae[ee]={data:gt,pixelRatio:Ne,sdf:ke,stretchX:Ze,stretchY:He,content:rt}}T(null,ae)}}return{cancel:function(){q&&(q.cancel(),q=null),j&&(j.cancel(),j=null)}}}(h,this.map._requestManager,function(w,C){if(g._spriteRequest=null,w)g.fire(new v.ErrorEvent(w));else if(C)for(var T in C)g.imageManager.addImage(T,C[T]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new v.Event("data",{dataType:"style"}))})},f.prototype._validateLayer=function(h){var g=this.sourceCaches[h.source];if(g){var w=h.sourceLayer;if(w){var C=g.getSource();("geojson"===C.type||C.vectorLayerIds&&-1===C.vectorLayerIds.indexOf(w))&&this.fire(new v.ErrorEvent(new Error('Source layer "'+w+'" does not exist on source "'+C.id+'" as specified by style layer "'+h.id+'"')))}}},f.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},f.prototype._serializeLayers=function(h){for(var g=[],w=0,C=h;w<C.length;w+=1){var T=this._layers[C[w]];"custom"!==T.type&&g.push(T.serialize())}return g},f.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},f.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},f.prototype.update=function(h){if(this._loaded){var g=this._changed;if(this._changed){var w=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);for(var T in(w.length||C.length)&&this._updateWorkerLayers(w,C),this._updatedSources){var I=this._updatedSources[T];"reload"===I?this._reloadSource(T):"clear"===I&&this._clearSource(T)}for(var M in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[M].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var L={};for(var $ in this.sourceCaches){var q=this.sourceCaches[$];L[$]=q.used,q.used=!1}for(var j=0,ne=this._order;j<ne.length;j+=1){var J=this._layers[ne[j]];J.recalculate(h,this._availableImages),!J.isHidden(h.zoom)&&J.source&&(this.sourceCaches[J.source].used=!0)}for(var ae in L){var ee=this.sourceCaches[ae];L[ae]!==ee.used&&ee.fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ae}))}this.light.recalculate(h),this.z=h.zoom,g&&this.fire(new v.Event("data",{dataType:"style"}))}},f.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},f.prototype._updateWorkerLayers=function(h,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:g})},f.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},f.prototype.setState=function(h){var g=this;if(this._checkLoaded(),Hl(this,v.validateStyle(h)))return!1;(h=v.clone$1(h)).layers=Je(h.layers);var w=function(T,I){if(!T)return[{command:Be.setStyle,args:[I]}];var M=[];try{if(!v.deepEqual(T.version,I.version))return[{command:Be.setStyle,args:[I]}];v.deepEqual(T.center,I.center)||M.push({command:Be.setCenter,args:[I.center]}),v.deepEqual(T.zoom,I.zoom)||M.push({command:Be.setZoom,args:[I.zoom]}),v.deepEqual(T.bearing,I.bearing)||M.push({command:Be.setBearing,args:[I.bearing]}),v.deepEqual(T.pitch,I.pitch)||M.push({command:Be.setPitch,args:[I.pitch]}),v.deepEqual(T.sprite,I.sprite)||M.push({command:Be.setSprite,args:[I.sprite]}),v.deepEqual(T.glyphs,I.glyphs)||M.push({command:Be.setGlyphs,args:[I.glyphs]}),v.deepEqual(T.transition,I.transition)||M.push({command:Be.setTransition,args:[I.transition]}),v.deepEqual(T.light,I.light)||M.push({command:Be.setLight,args:[I.light]});var L={},$=[];!function(j,ne,J,ae){var ee;for(ee in ne=ne||{},j=j||{})j.hasOwnProperty(ee)&&(ne.hasOwnProperty(ee)||Wt(ee,J,ae));for(ee in ne)ne.hasOwnProperty(ee)&&(j.hasOwnProperty(ee)?v.deepEqual(j[ee],ne[ee])||("geojson"===j[ee].type&&"geojson"===ne[ee].type&&or(j,ne,ee)?J.push({command:Be.setGeoJSONSourceData,args:[ee,ne[ee].data]}):se(ee,ne,J,ae)):Gt(ee,ne,J))}(T.sources,I.sources,$,L);var q=[];T.layers&&T.layers.forEach(function(j){L[j.source]?M.push({command:Be.removeLayer,args:[j.id]}):q.push(j)}),M=M.concat($),function(j,ne,J){ne=ne||[];var ae,ee,ie,de,me,Ie,Ee,ke=(j=j||[]).map(Jt),Ne=ne.map(Jt),Ze=j.reduce(br,{}),He=ne.reduce(br,{}),rt=ke.slice(),gt=Object.create(null);for(ae=0,ee=0;ae<ke.length;ae++)He.hasOwnProperty(ie=ke[ae])?ee++:(J.push({command:Be.removeLayer,args:[ie]}),rt.splice(rt.indexOf(ie,ee),1));for(ae=0,ee=0;ae<Ne.length;ae++)rt[rt.length-1-ae]!==(ie=Ne[Ne.length-1-ae])&&(Ze.hasOwnProperty(ie)?(J.push({command:Be.removeLayer,args:[ie]}),rt.splice(rt.lastIndexOf(ie,rt.length-ee),1)):ee++,J.push({command:Be.addLayer,args:[He[ie],Ie=rt[rt.length-ae]]}),rt.splice(rt.length-ae,0,ie),gt[ie]=!0);for(ae=0;ae<Ne.length;ae++)if(de=Ze[ie=Ne[ae]],me=He[ie],!gt[ie]&&!v.deepEqual(de,me))if(v.deepEqual(de.source,me.source)&&v.deepEqual(de["source-layer"],me["source-layer"])&&v.deepEqual(de.type,me.type)){for(Ee in Nt(de.layout,me.layout,J,ie,null,Be.setLayoutProperty),Nt(de.paint,me.paint,J,ie,null,Be.setPaintProperty),v.deepEqual(de.filter,me.filter)||J.push({command:Be.setFilter,args:[ie,me.filter]}),v.deepEqual(de.minzoom,me.minzoom)&&v.deepEqual(de.maxzoom,me.maxzoom)||J.push({command:Be.setLayerZoomRange,args:[ie,me.minzoom,me.maxzoom]}),de)de.hasOwnProperty(Ee)&&"layout"!==Ee&&"paint"!==Ee&&"filter"!==Ee&&"metadata"!==Ee&&"minzoom"!==Ee&&"maxzoom"!==Ee&&(0===Ee.indexOf("paint.")?Nt(de[Ee],me[Ee],J,ie,Ee.slice(6),Be.setPaintProperty):v.deepEqual(de[Ee],me[Ee])||J.push({command:Be.setLayerProperty,args:[ie,Ee,me[Ee]]}));for(Ee in me)me.hasOwnProperty(Ee)&&!de.hasOwnProperty(Ee)&&"layout"!==Ee&&"paint"!==Ee&&"filter"!==Ee&&"metadata"!==Ee&&"minzoom"!==Ee&&"maxzoom"!==Ee&&(0===Ee.indexOf("paint.")?Nt(de[Ee],me[Ee],J,ie,Ee.slice(6),Be.setPaintProperty):v.deepEqual(de[Ee],me[Ee])||J.push({command:Be.setLayerProperty,args:[ie,Ee,me[Ee]]}))}else J.push({command:Be.removeLayer,args:[ie]}),Ie=rt[rt.lastIndexOf(ie)+1],J.push({command:Be.addLayer,args:[me,Ie]})}(q,I.layers,M)}catch(j){console.warn("Unable to compute style diff:",j),M=[{command:Be.setStyle,args:[I]}]}return M}(this.serialize(),h).filter(function(T){return!(T.command in $l)});if(0===w.length)return!1;var C=w.filter(function(T){return!(T.command in Wh)});if(C.length>0)throw new Error("Unimplemented: "+C.map(function(T){return T.command}).join(", ")+".");return w.forEach(function(T){"setTransition"!==T.command&&g[T.command].apply(g,T.args)}),this.stylesheet=h,!0},f.prototype.addImage=function(h,g){if(this.getImage(h))return this.fire(new v.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,g),this._afterImageUpdated(h)},f.prototype.updateImage=function(h,g){this.imageManager.updateImage(h,g)},f.prototype.getImage=function(h){return this.imageManager.getImage(h)},f.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new v.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},f.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))},f.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},f.prototype.addSource=function(h,g,w){var C=this;if(void 0===w&&(w={}),this._checkLoaded(),void 0!==this.sourceCaches[h])throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(v.validateStyle.source,"sources."+h,g,null,w))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var T=this.sourceCaches[h]=new W(h,g,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:C.loaded(),source:T.serialize(),sourceId:h}}),T.onAdd(this.map),this._changed=!0}},f.prototype.removeSource=function(h){if(this._checkLoaded(),void 0===this.sourceCaches[h])throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===h)return this.fire(new v.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+g+'" is using it.')));var w=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],w.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),w.setEventedParent(null),w.clearTiles(),w.onRemove&&w.onRemove(this.map),this._changed=!0},f.prototype.setGeoJSONSourceData=function(h,g){this._checkLoaded(),this.sourceCaches[h].getSource().setData(g),this._changed=!0},f.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},f.prototype.addLayer=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var C=h.id;if(this.getLayer(C))this.fire(new v.ErrorEvent(new Error('Layer with id "'+C+'" already exists on this map')));else{var T;if("custom"===h.type){if(Hl(this,v.validateCustomStyleLayer(h)))return;T=v.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(C,h.source),h=v.clone$1(h),h=v.extend(h,{source:C})),this._validate(v.validateStyle.layer,"layers."+C,h,{arrayIndex:-1},w))return;T=v.createStyleLayer(h),this._validateLayer(T),T.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[T.id]=T.serialize()}var I=g?this._order.indexOf(g):this._order.length;if(g&&-1===I)this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(I,0,C),this._layerOrderChanged=!0,this._layers[C]=T,this._removedLayers[C]&&T.source&&"custom"!==T.type){var M=this._removedLayers[C];delete this._removedLayers[C],M.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},f.prototype.moveLayer=function(h,g){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==g){var w=this._order.indexOf(h);this._order.splice(w,1);var C=g?this._order.indexOf(g):this._order.length;g&&-1===C?this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(C,0,h),this._layerOrderChanged=!0)}}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},f.prototype.removeLayer=function(h){this._checkLoaded();var g=this._layers[h];if(g){g.setEventedParent(null);var w=this._order.indexOf(h);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=g,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],g.onRemove&&g.onRemove(this.map)}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},f.prototype.getLayer=function(h){return this._layers[h]},f.prototype.hasLayer=function(h){return h in this._layers},f.prototype.setLayerZoomRange=function(h,g,w){this._checkLoaded();var C=this.getLayer(h);C?C.minzoom===g&&C.maxzoom===w||(null!=g&&(C.minzoom=g),null!=w&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},f.prototype.setFilter=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var C=this.getLayer(h);if(C){if(!v.deepEqual(C.filter,g))return null==g?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(v.validateStyle.filter,"layers."+C.id+".filter",g,null,w)||(C.filter=v.clone$1(g),this._updateLayer(C)))}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},f.prototype.getFilter=function(h){return v.clone$1(this.getLayer(h).filter)},f.prototype.setLayoutProperty=function(h,g,w,C){void 0===C&&(C={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getLayoutProperty(g),w)||(T.setLayoutProperty(g,w,C),this._updateLayer(T)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getLayoutProperty=function(h,g){var w=this.getLayer(h);if(w)return w.getLayoutProperty(g);this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},f.prototype.setPaintProperty=function(h,g,w,C){void 0===C&&(C={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getPaintProperty(g),w)||(T.setPaintProperty(g,w,C)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},f.prototype.getPaintProperty=function(h,g){return this.getLayer(h).getPaintProperty(g)},f.prototype.setFeatureState=function(h,g){this._checkLoaded();var w=h.source,C=h.sourceLayer,T=this.sourceCaches[w];if(void 0!==T){var I=T.getSource().type;"geojson"===I&&C?this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==I||C?(void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(C,h.id,g)):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},f.prototype.removeFeatureState=function(h,g){this._checkLoaded();var w=h.source,C=this.sourceCaches[w];if(void 0!==C){var T=C.getSource().type,I="vector"===T?h.sourceLayer:void 0;"vector"!==T||I?g&&"string"!=typeof h.id&&"number"!=typeof h.id?this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(I,h.id,g):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},f.prototype.getFeatureState=function(h){this._checkLoaded();var g=h.source,w=h.sourceLayer,C=this.sourceCaches[g];if(void 0!==C){if("vector"!==C.getSource().type||w)return void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,h.id);this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},f.prototype.getTransition=function(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},f.prototype.serialize=function(){return v.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:v.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return void 0!==h})},f.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&"raster"!==this.sourceCaches[h.source].getSource().type&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},f.prototype._flattenAndSortRenderedFeatures=function(h){for(var g=this,w=function(Ze){return"fill-extrusion"===g._layers[Ze].type},C={},T=[],I=this._order.length-1;I>=0;I--){var M=this._order[I];if(w(M)){C[M]=I;for(var L=0,$=h;L<$.length;L+=1){var q=$[L][M];if(q)for(var j=0,ne=q;j<ne.length;j+=1)T.push(ne[j])}}}T.sort(function(Ze,He){return He.intersectionZ-Ze.intersectionZ});for(var J=[],ae=this._order.length-1;ae>=0;ae--){var ee=this._order[ae];if(w(ee))for(var ie=T.length-1;ie>=0;ie--){var de=T[ie].feature;if(C[de.layer.id]<ae)break;J.push(de),T.pop()}else for(var me=0,Ie=h;me<Ie.length;me+=1){var Ee=Ie[me][ee];if(Ee)for(var ke=0,Ne=Ee;ke<Ne.length;ke+=1)J.push(Ne[ke].feature)}}return J},f.prototype.queryRenderedFeatures=function(h,g,w){g&&g.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var C={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,I=g.layers;T<I.length;T+=1){var M=I[T],L=this._layers[M];if(!L)return this.fire(new v.ErrorEvent(new Error("The layer '"+M+"' does not exist in the map's style and cannot be queried for features."))),[];C[L.source]=!0}}var $=[];for(var q in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!C[q]||$.push(Ri(this.sourceCaches[q],this._layers,this._serializedLayers,h,g,w));return this.placement&&$.push(function(j,ne,J,ae,ee,ie,de){for(var me={},Ie=ie.queryRenderedSymbols(ae),Ee=[],ke=0,Ne=Object.keys(Ie).map(Number);ke<Ne.length;ke+=1)Ee.push(de[Ne[ke]]);Ee.sort(tl);for(var Ze=function(){var vt=rt[He],ln=vt.featureIndex.lookupSymbolFeatures(Ie[vt.bucketInstanceId],ne,vt.bucketIndex,vt.sourceLayerIndex,ee.filter,ee.layers,ee.availableImages,j);for(var st in ln){var Ht=me[st]=me[st]||[],on=ln[st];on.sort(function(Ft,Ot){var Tt=vt.featureSortOrder;if(Tt){var Jn=Tt.indexOf(Ft.featureIndex);return Tt.indexOf(Ot.featureIndex)-Jn}return Ot.featureIndex-Ft.featureIndex});for(var Ye=0,Pt=on;Ye<Pt.length;Ye+=1)Ht.push(Pt[Ye])}},He=0,rt=Ee;He<rt.length;He+=1)Ze();var gt=function(vt){me[vt].forEach(function(ln){var st=ln.feature,Ht=J[j[vt].source].getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=Ht})};for(var bt in me)gt(bt);return me}(this._layers,this._serializedLayers,this.sourceCaches,h,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($)},f.prototype.querySourceFeatures=function(h,g){g&&g.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var w=this.sourceCaches[h];return w?function(C,T){for(var I=C.getRenderableIds().map(function(ne){return C.getTileByID(ne)}),M=[],L={},$=0;$<I.length;$++){var q=I[$],j=q.tileID.canonical.key;L[j]||(L[j]=!0,q.querySourceFeatures(M,T))}return M}(w,g):[]},f.prototype.addSourceType=function(h,g,w){return f.getSourceType(h)?w(new Error('A source type called "'+h+'" already exists.')):(f.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},w):w(null,null))},f.prototype.getLight=function(){return this.light.getLight()},f.prototype.setLight=function(h,g){void 0===g&&(g={}),this._checkLoaded();var w=this.light.getLight(),C=!1;for(var T in h)if(!v.deepEqual(h[T],w[T])){C=!0;break}if(C){var I={now:v.browser.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,g),this.light.updateTransitions(I)}},f.prototype._validate=function(h,g,w,C,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&Hl(this,h.call(v.validateStyle,v.extend({key:g,style:this.serialize(),value:w,styleSpec:v.styleSpec},C)))},f.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},f.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},f.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},f.prototype._updateSources=function(h){for(var g in this.sourceCaches)this.sourceCaches[g].update(h)},f.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},f.prototype._updatePlacement=function(h,g,w,C,T){void 0===T&&(T=!1);for(var I=!1,M=!1,L={},$=0,q=this._order;$<q.length;$+=1){var j=this._layers[q[$]];if("symbol"===j.type){if(!L[j.source]){var ne=this.sourceCaches[j.source];L[j.source]=ne.getRenderableIds(!0).map(function(de){return ne.getTileByID(de)}).sort(function(de,me){return me.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(me.tileID)?-1:1)})}var J=this.crossTileSymbolIndex.addLayer(j,L[j.source],h.center.lng);I=I||J}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===w)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.browser.now(),h.zoom))&&(this.pauseablePlacement=new Vc(h,this._order,T,g,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.browser.now()),M=!0),I&&this.pauseablePlacement.placement.setStale()),M||I)for(var ae=0,ee=this._order;ae<ee.length;ae+=1){var ie=this._layers[ee[ae]];"symbol"===ie.type&&this.placement.updateLayerOpacities(ie,L[ie.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.browser.now())},f.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},f.prototype.getImages=function(h,g,w){this.imageManager.getImages(g.icons,w),this._updateTilesForChangedImages();var C=this.sourceCaches[g.source];C&&C.setDependencies(g.tileID.key,g.type,g.icons)},f.prototype.getGlyphs=function(h,g,w){this.glyphManager.getGlyphs(g.stacks,w)},f.prototype.getResource=function(h,g,w){return v.makeRequest(g,w)},f}(v.Evented);ql.getSourceType=function(d){return el[d]},ql.setSourceType=function(d,f){el[d]=f},ql.registerForPluginStateChange=v.registerForPluginStateChange;var Ca=v.createLayout([{name:"a_pos",type:"Int16",components:2}]),si=pr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Mp=pr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),qy=pr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Gy=pr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),y0=pr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ad=pr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Zh=pr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Pp=pr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Op=pr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Np=pr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Gl=pr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Rd=pr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Au=pr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),es=pr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Kh=pr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),en=pr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Tg=pr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Jr=pr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Xi=pr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Da=pr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Bs=pr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Zt=pr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),wn=pr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ru=pr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Wl=pr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Yh=pr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function pr(d,f){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=f.match(/attribute ([\w]+) ([\w]+)/g),w=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=C?C.concat(w):w,I={};return{fragmentSource:d=d.replace(h,function(M,L,$,q,j){return I[j]=!0,"define"===L?"\n#ifndef HAS_UNIFORM_u_"+j+"\nvarying "+$+" "+q+" "+j+";\n#else\nuniform "+$+" "+q+" u_"+j+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+j+"\n    "+$+" "+q+" "+j+" = u_"+j+";\n#endif\n"}),vertexSource:f=f.replace(h,function(M,L,$,q,j){var ne="float"===q?"vec2":"vec4",J=j.match(/color/)?"color":ne;return I[j]?"define"===L?"\n#ifndef HAS_UNIFORM_u_"+j+"\nuniform lowp float u_"+j+"_t;\nattribute "+$+" "+ne+" a_"+j+";\nvarying "+$+" "+q+" "+j+";\n#else\nuniform "+$+" "+q+" u_"+j+";\n#endif\n":"vec4"===J?"\n#ifndef HAS_UNIFORM_u_"+j+"\n    "+j+" = a_"+j+";\n#else\n    "+$+" "+q+" "+j+" = u_"+j+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+j+"\n    "+j+" = unpack_mix_"+J+"(a_"+j+", u_"+j+"_t);\n#else\n    "+$+" "+q+" "+j+" = u_"+j+";\n#endif\n":"define"===L?"\n#ifndef HAS_UNIFORM_u_"+j+"\nuniform lowp float u_"+j+"_t;\nattribute "+$+" "+ne+" a_"+j+";\n#else\nuniform "+$+" "+q+" u_"+j+";\n#endif\n":"vec4"===J?"\n#ifndef HAS_UNIFORM_u_"+j+"\n    "+$+" "+q+" "+j+" = a_"+j+";\n#else\n    "+$+" "+q+" "+j+" = u_"+j+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+j+"\n    "+$+" "+q+" "+j+" = unpack_mix_"+J+"(a_"+j+", u_"+j+"_t);\n#else\n    "+$+" "+q+" "+j+" = u_"+j+";\n#endif\n"}),staticAttributes:g,staticUniforms:T}}var Ta=Object.freeze({__proto__:null,prelude:si,background:Mp,backgroundPattern:qy,circle:Gy,clippingMask:y0,heatmap:Ad,heatmapTexture:Zh,collisionBox:Pp,collisionCircle:Op,debug:Np,fill:Gl,fillOutline:Rd,fillOutlinePattern:Au,fillPattern:es,fillExtrusion:Kh,fillExtrusionPattern:en,hillshadePrepare:Tg,hillshade:Jr,line:Xi,lineGradient:Da,linePattern:Bs,lineSDF:Zt,raster:wn,symbolIcon:Ru,symbolSDF:Wl,symbolTextAndIcon:Yh}),Mu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Wy(d){for(var f=[],h=0;h<d.length;h++)if(null!==d[h]){var g=d[h].split(" ");f.push(g.pop())}return f}Mu.prototype.bind=function(d,f,h,g,w,C,T,I){this.context=d;for(var M=this.boundPaintVertexBuffers.length!==g.length,L=0;!M&&L<g.length;L++)this.boundPaintVertexBuffers[L]!==g[L]&&(M=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===h&&!M&&this.boundIndexBuffer===w&&this.boundVertexOffset===C&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===I?(d.bindVertexArrayOES.set(this.vao),T&&T.bind(),w&&w.dynamicDraw&&w.bind(),I&&I.bind()):this.freshBind(f,h,g,w,C,T,I)},Mu.prototype.freshBind=function(d,f,h,g,w,C,T){var I,M=d.numAttributes,L=this.context,$=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=d,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=C,this.boundDynamicVertexBuffer2=T;else{I=L.currentNumAttributes||0;for(var q=M;q<I;q++)$.disableVertexAttribArray(q)}f.enableAttributes($,d);for(var j=0,ne=h;j<ne.length;j+=1)ne[j].enableAttributes($,d);C&&C.enableAttributes($,d),T&&T.enableAttributes($,d),f.bind(),f.setVertexAttribPointers($,d,w);for(var J=0,ae=h;J<ae.length;J+=1){var ee=ae[J];ee.bind(),ee.setVertexAttribPointers($,d,w)}C&&(C.bind(),C.setVertexAttribPointers($,d,w)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers($,d,w)),L.currentNumAttributes=M},Mu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Zy=function(d,f,h,g,w,C){var T=d.gl;this.program=T.createProgram();for(var I=Wy(h.staticAttributes),M=g?g.getBinderAttributes():[],L=I.concat(M),$=h.staticUniforms?Wy(h.staticUniforms):[],q=g?g.getBinderUniforms():[],j=[],ne=0,J=$.concat(q);ne<J.length;ne+=1){var ae=J[ne];j.indexOf(ae)<0&&j.push(ae)}var ee=g?g.defines():[];C&&ee.push("#define OVERDRAW_INSPECTOR;");var ie=ee.concat(si.fragmentSource,h.fragmentSource).join("\n"),de=ee.concat(si.vertexSource,h.vertexSource).join("\n"),me=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(me,ie),T.compileShader(me),T.attachShader(this.program,me);var Ie=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ie,de),T.compileShader(Ie),T.attachShader(this.program,Ie),this.attributes={};var Ee={};this.numAttributes=L.length;for(var ke=0;ke<this.numAttributes;ke++)L[ke]&&(T.bindAttribLocation(this.program,ke,L[ke]),this.attributes[L[ke]]=ke);T.linkProgram(this.program),T.deleteShader(Ie),T.deleteShader(me);for(var Ne=0;Ne<j.length;Ne++){var Ze=j[Ne];if(Ze&&!Ee[Ze]){var He=T.getUniformLocation(this.program,Ze);He&&(Ee[Ze]=He)}}this.fixedUniforms=w(d,Ee),this.binderUniforms=g?g.getUniforms(d,Ee):[]}}};function Sg(d,f,h){var g=1/Qo(h,1,f.transform.tileZoom),w=Math.pow(2,h.tileID.overscaledZ),C=h.tileSize*Math.pow(2,f.transform.tileZoom)/w,T=C*(h.tileID.canonical.x+h.tileID.wrap*w),I=C*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[T>>16,I>>16],u_pixel_coord_lower:[65535&T,65535&I]}}Zy.prototype.draw=function(d,f,h,g,w,C,T,I,M,L,$,q,j,ne,J,ae){var ee,ie=d.gl;if(!this.failedToCreate){for(var de in d.program.set(this.program),d.setDepthMode(h),d.setStencilMode(g),d.setColorMode(w),d.setCullFace(C),this.fixedUniforms)this.fixedUniforms[de].set(T[de]);ne&&ne.setUniforms(d,this.binderUniforms,q,{zoom:j});for(var me=(ee={},ee[ie.LINES]=2,ee[ie.TRIANGLES]=3,ee[ie.LINE_STRIP]=1,ee)[f],Ie=0,Ee=$.get();Ie<Ee.length;Ie+=1){var ke=Ee[Ie],Ne=ke.vaos||(ke.vaos={});(Ne[I]||(Ne[I]=new Mu)).bind(d,this,M,ne?ne.getPaintVertexBuffers():[],L,ke.vertexOffset,J,ae),ie.drawElements(f,ke.primitiveLength*me,ie.UNSIGNED_SHORT,ke.primitiveOffset*me*2)}}};var Xh=function(d,f,h,g){var w=f.style.light,C=w.properties.get("position"),T=[C.x,C.y,C.z],I=v.create$1();"viewport"===w.properties.get("anchor")&&v.fromRotation(I,-f.transform.angle),v.transformMat3(T,T,I);var M=w.properties.get("color");return{u_matrix:d,u_lightpos:T,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+h,u_opacity:g}},v0=function(d,f,h,g,w,C,T){return v.extend(Xh(d,f,h,g),Sg(C,f,T),{u_height_factor:-Math.pow(2,w.overscaledZ)/T.tileSize/8})},Zl=function(d){return{u_matrix:d}},sl=function(d,f,h,g){return v.extend(Zl(d),Sg(h,f,g))},Pu=function(d,f){return{u_matrix:d,u_world:f}},Ig=function(d,f,h,g,w){return v.extend(sl(d,f,h,g),{u_world:w})},Qh=function(d,f,h,g){var w,C,T=d.transform;if("map"===g.paint.get("circle-pitch-alignment")){var I=Qo(h,1,T.zoom);w=!0,C=[I,I]}else w=!1,C=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===g.paint.get("circle-pitch-scale")),u_matrix:d.translatePosMatrix(f.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:v.browser.devicePixelRatio,u_extrude_scale:C}},Jh=function(d,f,h){var g=Qo(h,1,f.zoom),w=Math.pow(2,f.zoom-h.tileID.overscaledZ),C=h.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:f.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[f.pixelsToGLUnits[0]/(g*w),f.pixelsToGLUnits[1]/(g*w)],u_overscale_factor:C}},vi=function(d,f,h){return{u_matrix:d,u_inv_matrix:f,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},ef=function(d,f,h){return void 0===h&&(h=1),{u_matrix:d,u_color:f,u_overlay:0,u_overlay_scale:h}},Ou=function(d){return{u_matrix:d}},Md=function(d,f,h,g){return{u_matrix:d,u_extrude_scale:Qo(f,1,h),u_intensity:g}},Sa=function(d,f,h){var g=d.transform;return{u_matrix:zc(d,f,h),u_ratio:1/Qo(f,1,g.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Pd=function(d,f,h,g){return v.extend(Sa(d,f,h),{u_image:0,u_image_height:g})},ur=function(d,f,h,g){var w=d.transform,C=Ct(f,w);return{u_matrix:zc(d,f,h),u_texsize:f.imageAtlasTexture.size,u_ratio:1/Qo(f,1,w.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_image:0,u_scale:[C,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},tf=function(d,f,h,g,w){var C=d.lineAtlas,T=Ct(f,d.transform),I="round"===h.layout.get("line-cap"),M=C.getDash(g.from,I),L=C.getDash(g.to,I),$=M.width*w.fromScale,q=L.width*w.toScale;return v.extend(Sa(d,f,h),{u_patternscale_a:[T/$,-M.height/2],u_patternscale_b:[T/q,-L.height/2],u_sdfgamma:C.width/(256*Math.min($,q)*v.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:L.y,u_mix:w.t})};function Ct(d,f){return 1/Qo(d,1,f.tileZoom)}function zc(d,f,h){return d.translatePosMatrix(f.tileID.posMatrix,f,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var Z=function(d,f,h,g,w){return{u_matrix:d,u_tl_parent:f,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(T=w.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(C=w.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Od(w.paint.get("raster-hue-rotate"))};var C,T};function Od(d){d*=Math.PI/180;var f=Math.sin(d),h=Math.cos(d);return[(2*h+1)/3,(-Math.sqrt(3)*f-h+1)/3,(Math.sqrt(3)*f-h+1)/3]}var Nd,nf=function(d,f,h,g,w,C,T,I,M,L){var $=w.transform;return{u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:f?f.uSizeT:0,u_size:f?f.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:$.width/$.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:T,u_coord_matrix:I,u_is_text:+M,u_pitch_with_map:+g,u_texsize:L,u_texture:0}},Ia=function(d,f,h,g,w,C,T,I,M,L,$){var q=w.transform;return v.extend(nf(d,f,h,g,w,C,T,I,M,L),{u_gamma_scale:g?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:v.browser.devicePixelRatio,u_is_halo:+$})},rf=function(d,f,h,g,w,C,T,I,M,L){return v.extend(Ia(d,f,h,g,w,C,T,I,!0,M,!0),{u_texsize_icon:L,u_texture_icon:1})},ka=function(d,f,h){return{u_matrix:d,u_opacity:f,u_color:h}},Ld=function(d,f,h,g,w,C){return v.extend((I=C,L=w,$=(M=h).imageManager.getPattern((T=g).from.toString()),q=M.imageManager.getPattern(T.to.toString()),ne=(j=M.imageManager.getPixelSize()).width,J=j.height,ae=Math.pow(2,L.tileID.overscaledZ),ie=(ee=L.tileSize*Math.pow(2,M.transform.tileZoom)/ae)*(L.tileID.canonical.x+L.tileID.wrap*ae),de=ee*L.tileID.canonical.y,{u_image:0,u_pattern_tl_a:$.tl,u_pattern_br_a:$.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[ne,J],u_mix:I.t,u_pattern_size_a:$.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Qo(L,1,M.transform.tileZoom),u_pixel_coord_upper:[ie>>16,de>>16],u_pixel_coord_lower:[65535&ie,65535&de]}),{u_matrix:d,u_opacity:f});var T,I,M,L,$,q,j,ne,J,ae,ee,ie,de},so={fillExtrusion:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_lightpos:new v.Uniform3f(d,f.u_lightpos),u_lightintensity:new v.Uniform1f(d,f.u_lightintensity),u_lightcolor:new v.Uniform3f(d,f.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,f.u_vertical_gradient),u_opacity:new v.Uniform1f(d,f.u_opacity)}},fillExtrusionPattern:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_lightpos:new v.Uniform3f(d,f.u_lightpos),u_lightintensity:new v.Uniform1f(d,f.u_lightintensity),u_lightcolor:new v.Uniform3f(d,f.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,f.u_vertical_gradient),u_height_factor:new v.Uniform1f(d,f.u_height_factor),u_image:new v.Uniform1i(d,f.u_image),u_texsize:new v.Uniform2f(d,f.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,f.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,f.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,f.u_scale),u_fade:new v.Uniform1f(d,f.u_fade),u_opacity:new v.Uniform1f(d,f.u_opacity)}},fill:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix)}},fillPattern:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_image:new v.Uniform1i(d,f.u_image),u_texsize:new v.Uniform2f(d,f.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,f.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,f.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,f.u_scale),u_fade:new v.Uniform1f(d,f.u_fade)}},fillOutline:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_world:new v.Uniform2f(d,f.u_world)}},fillOutlinePattern:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_world:new v.Uniform2f(d,f.u_world),u_image:new v.Uniform1i(d,f.u_image),u_texsize:new v.Uniform2f(d,f.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,f.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,f.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,f.u_scale),u_fade:new v.Uniform1f(d,f.u_fade)}},circle:function(d,f){return{u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_scale_with_map:new v.Uniform1i(d,f.u_scale_with_map),u_pitch_with_map:new v.Uniform1i(d,f.u_pitch_with_map),u_extrude_scale:new v.Uniform2f(d,f.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(d,f.u_matrix)}},collisionBox:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_pixels_to_tile_units:new v.Uniform1f(d,f.u_pixels_to_tile_units),u_extrude_scale:new v.Uniform2f(d,f.u_extrude_scale),u_overscale_factor:new v.Uniform1f(d,f.u_overscale_factor)}},collisionCircle:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_inv_matrix:new v.UniformMatrix4f(d,f.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(d,f.u_viewport_size)}},debug:function(d,f){return{u_color:new v.UniformColor(d,f.u_color),u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_overlay:new v.Uniform1i(d,f.u_overlay),u_overlay_scale:new v.Uniform1f(d,f.u_overlay_scale)}},clippingMask:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix)}},heatmap:function(d,f){return{u_extrude_scale:new v.Uniform1f(d,f.u_extrude_scale),u_intensity:new v.Uniform1f(d,f.u_intensity),u_matrix:new v.UniformMatrix4f(d,f.u_matrix)}},heatmapTexture:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_world:new v.Uniform2f(d,f.u_world),u_image:new v.Uniform1i(d,f.u_image),u_color_ramp:new v.Uniform1i(d,f.u_color_ramp),u_opacity:new v.Uniform1f(d,f.u_opacity)}},hillshade:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_image:new v.Uniform1i(d,f.u_image),u_latrange:new v.Uniform2f(d,f.u_latrange),u_light:new v.Uniform2f(d,f.u_light),u_shadow:new v.UniformColor(d,f.u_shadow),u_highlight:new v.UniformColor(d,f.u_highlight),u_accent:new v.UniformColor(d,f.u_accent)}},hillshadePrepare:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_image:new v.Uniform1i(d,f.u_image),u_dimension:new v.Uniform2f(d,f.u_dimension),u_zoom:new v.Uniform1f(d,f.u_zoom),u_unpack:new v.Uniform4f(d,f.u_unpack)}},line:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_ratio:new v.Uniform1f(d,f.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,f.u_units_to_pixels)}},lineGradient:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_ratio:new v.Uniform1f(d,f.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,f.u_units_to_pixels),u_image:new v.Uniform1i(d,f.u_image),u_image_height:new v.Uniform1f(d,f.u_image_height)}},linePattern:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_texsize:new v.Uniform2f(d,f.u_texsize),u_ratio:new v.Uniform1f(d,f.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_image:new v.Uniform1i(d,f.u_image),u_units_to_pixels:new v.Uniform2f(d,f.u_units_to_pixels),u_scale:new v.Uniform3f(d,f.u_scale),u_fade:new v.Uniform1f(d,f.u_fade)}},lineSDF:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_ratio:new v.Uniform1f(d,f.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,f.u_units_to_pixels),u_patternscale_a:new v.Uniform2f(d,f.u_patternscale_a),u_patternscale_b:new v.Uniform2f(d,f.u_patternscale_b),u_sdfgamma:new v.Uniform1f(d,f.u_sdfgamma),u_image:new v.Uniform1i(d,f.u_image),u_tex_y_a:new v.Uniform1f(d,f.u_tex_y_a),u_tex_y_b:new v.Uniform1f(d,f.u_tex_y_b),u_mix:new v.Uniform1f(d,f.u_mix)}},raster:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_tl_parent:new v.Uniform2f(d,f.u_tl_parent),u_scale_parent:new v.Uniform1f(d,f.u_scale_parent),u_buffer_scale:new v.Uniform1f(d,f.u_buffer_scale),u_fade_t:new v.Uniform1f(d,f.u_fade_t),u_opacity:new v.Uniform1f(d,f.u_opacity),u_image0:new v.Uniform1i(d,f.u_image0),u_image1:new v.Uniform1i(d,f.u_image1),u_brightness_low:new v.Uniform1f(d,f.u_brightness_low),u_brightness_high:new v.Uniform1f(d,f.u_brightness_high),u_saturation_factor:new v.Uniform1f(d,f.u_saturation_factor),u_contrast_factor:new v.Uniform1f(d,f.u_contrast_factor),u_spin_weights:new v.Uniform3f(d,f.u_spin_weights)}},symbolIcon:function(d,f){return{u_is_size_zoom_constant:new v.Uniform1i(d,f.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,f.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,f.u_size_t),u_size:new v.Uniform1f(d,f.u_size),u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,f.u_pitch),u_rotate_symbol:new v.Uniform1i(d,f.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,f.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,f.u_fade_change),u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,f.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,f.u_coord_matrix),u_is_text:new v.Uniform1i(d,f.u_is_text),u_pitch_with_map:new v.Uniform1i(d,f.u_pitch_with_map),u_texsize:new v.Uniform2f(d,f.u_texsize),u_texture:new v.Uniform1i(d,f.u_texture)}},symbolSDF:function(d,f){return{u_is_size_zoom_constant:new v.Uniform1i(d,f.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,f.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,f.u_size_t),u_size:new v.Uniform1f(d,f.u_size),u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,f.u_pitch),u_rotate_symbol:new v.Uniform1i(d,f.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,f.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,f.u_fade_change),u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,f.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,f.u_coord_matrix),u_is_text:new v.Uniform1i(d,f.u_is_text),u_pitch_with_map:new v.Uniform1i(d,f.u_pitch_with_map),u_texsize:new v.Uniform2f(d,f.u_texsize),u_texture:new v.Uniform1i(d,f.u_texture),u_gamma_scale:new v.Uniform1f(d,f.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,f.u_is_halo)}},symbolTextAndIcon:function(d,f){return{u_is_size_zoom_constant:new v.Uniform1i(d,f.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,f.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,f.u_size_t),u_size:new v.Uniform1f(d,f.u_size),u_camera_to_center_distance:new v.Uniform1f(d,f.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,f.u_pitch),u_rotate_symbol:new v.Uniform1i(d,f.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,f.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,f.u_fade_change),u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,f.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,f.u_coord_matrix),u_is_text:new v.Uniform1i(d,f.u_is_text),u_pitch_with_map:new v.Uniform1i(d,f.u_pitch_with_map),u_texsize:new v.Uniform2f(d,f.u_texsize),u_texsize_icon:new v.Uniform2f(d,f.u_texsize_icon),u_texture:new v.Uniform1i(d,f.u_texture),u_texture_icon:new v.Uniform1i(d,f.u_texture_icon),u_gamma_scale:new v.Uniform1f(d,f.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,f.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,f.u_is_halo)}},background:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_opacity:new v.Uniform1f(d,f.u_opacity),u_color:new v.UniformColor(d,f.u_color)}},backgroundPattern:function(d,f){return{u_matrix:new v.UniformMatrix4f(d,f.u_matrix),u_opacity:new v.Uniform1f(d,f.u_opacity),u_image:new v.Uniform1i(d,f.u_image),u_pattern_tl_a:new v.Uniform2f(d,f.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(d,f.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(d,f.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(d,f.u_pattern_br_b),u_texsize:new v.Uniform2f(d,f.u_texsize),u_mix:new v.Uniform1f(d,f.u_mix),u_pattern_size_a:new v.Uniform2f(d,f.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(d,f.u_pattern_size_b),u_scale_a:new v.Uniform1f(d,f.u_scale_a),u_scale_b:new v.Uniform1f(d,f.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(d,f.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,f.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(d,f.u_tile_units_to_pixels)}}};function Kl(d,f,h,g,w,C,T){for(var I=d.context,M=I.gl,L=d.useProgram("collisionBox"),$=[],q=0,j=0,ne=0;ne<g.length;ne++){var J=g[ne],ae=f.getTile(J),ee=ae.getBucket(h);if(ee){var ie=J.posMatrix;0===w[0]&&0===w[1]||(ie=d.translatePosMatrix(J.posMatrix,ae,w,C));var de=T?ee.textCollisionBox:ee.iconCollisionBox,me=ee.collisionCircleArray;if(me.length>0){var Ie=v.create(),Ee=ie;v.mul(Ie,ee.placementInvProjMatrix,d.transform.glCoordMatrix),v.mul(Ie,Ie,ee.placementViewportMatrix),$.push({circleArray:me,circleOffset:j,transform:Ee,invTransform:Ie}),j=q+=me.length/4}de&&L.draw(I,M.LINES,G.disabled,te.disabled,d.colorModeForRenderPass(),he.disabled,Jh(ie,d.transform,ae),h.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,d.transform.zoom,null,null,de.collisionVertexBuffer)}}if(T&&$.length){var ke=d.useProgram("collisionCircle"),Ne=new v.StructArrayLayout2f1f2i16;Ne.resize(4*q),Ne._trim();for(var Ze=0,He=0,rt=$;He<rt.length;He+=1)for(var gt=rt[He],bt=0;bt<gt.circleArray.length/4;bt++){var vt=4*bt,ln=gt.circleArray[vt+0],st=gt.circleArray[vt+1],Ht=gt.circleArray[vt+2],on=gt.circleArray[vt+3];Ne.emplace(Ze++,ln,st,Ht,on,0),Ne.emplace(Ze++,ln,st,Ht,on,1),Ne.emplace(Ze++,ln,st,Ht,on,2),Ne.emplace(Ze++,ln,st,Ht,on,3)}(!Nd||Nd.length<2*q)&&(Nd=function(Br){var eo=2*Br,ui=new v.StructArrayLayout3ui6;ui.resize(eo),ui._trim();for(var di=0;di<eo;di++){var Wr=6*di;ui.uint16[Wr+0]=4*di+0,ui.uint16[Wr+1]=4*di+1,ui.uint16[Wr+2]=4*di+2,ui.uint16[Wr+3]=4*di+2,ui.uint16[Wr+4]=4*di+3,ui.uint16[Wr+5]=4*di+0}return ui}(q));for(var Ye=I.createIndexBuffer(Nd,!0),Pt=I.createVertexBuffer(Ne,v.collisionCircleLayout.members,!0),Ft=0,Ot=$;Ft<Ot.length;Ft+=1){var Tt=Ot[Ft],Jn=vi(Tt.transform,Tt.invTransform,d.transform);ke.draw(I,M.TRIANGLES,G.disabled,te.disabled,d.colorModeForRenderPass(),he.disabled,Jn,h.id,Pt,Ye,v.SegmentVector.simpleSegment(0,2*Tt.circleOffset,Tt.circleArray.length,Tt.circleArray.length/2),null,d.transform.zoom,null,null,null)}Pt.destroy(),Ye.destroy()}}var Nu=v.identity(new Float32Array(16));function ts(d,f,h,g,w,C){var T=v.getAnchorAlignment(d),I=-(T.horizontalAlign-.5)*f,M=-(T.verticalAlign-.5)*h,L=v.evaluateVariableOffset(d,g);return new v.Point((I/w+L[0])*C,(M/w+L[1])*C)}function Fd(d,f,h,g,w,C,T,I,M,L,$){var q=d.text.placedSymbolArray,j=d.text.dynamicLayoutVertexArray,ne=d.icon.dynamicLayoutVertexArray,J={};j.clear();for(var ae=0;ae<q.length;ae++){var ee=q.get(ae),ie=ee.hidden||!ee.crossTileID||d.allowVerticalPlacement&&!ee.placedOrientation?null:g[ee.crossTileID];if(ie){var de=new v.Point(ee.anchorX,ee.anchorY),me=an(de,h?I:T),Ie=kd(C.cameraToCenterDistance,me.signedDistanceFromCamera),Ee=w.evaluateSizeForFeature(d.textSizeData,L,ee)*Ie/v.ONE_EM;h&&(Ee*=d.tilePixelRatio/M);for(var ke=ts(ie.anchor,ie.width,ie.height,ie.textOffset,ie.textBoxScale,Ee),Ne=h?an(de.add(ke),T).point:me.point.add(f?ke.rotate(-C.angle):ke),Ze=d.allowVerticalPlacement&&ee.placedOrientation===v.WritingMode.vertical?Math.PI/2:0,He=0;He<ee.numGlyphs;He++)v.addDynamicAttributes(j,Ne,Ze);$&&ee.associatedIconIndex>=0&&(J[ee.associatedIconIndex]={shiftedAnchor:Ne,angle:Ze})}else Co(ee.numGlyphs,j)}if($){ne.clear();for(var rt=d.icon.placedSymbolArray,gt=0;gt<rt.length;gt++){var bt=rt.get(gt);if(bt.hidden)Co(bt.numGlyphs,ne);else{var vt=J[gt];if(vt)for(var ln=0;ln<bt.numGlyphs;ln++)v.addDynamicAttributes(ne,vt.shiftedAnchor,vt.angle);else Co(bt.numGlyphs,ne)}}d.icon.dynamicLayoutVertexBuffer.updateData(ne)}d.text.dynamicLayoutVertexBuffer.updateData(j)}function Lp(d,f,h){return h.iconsInText&&f?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function sf(d,f,h,g,w,C,T,I,M,L,$,q){for(var j=d.context,ne=j.gl,J=d.transform,ae="map"===I,ee="map"===M,ie=ae&&"point"!==h.layout.get("symbol-placement"),de=ae&&!ee&&!ie,me=!h.layout.get("symbol-sort-key").isConstant(),Ie=!1,Ee=d.depthModeForSublayer(0,G.ReadOnly),ke=h.layout.get("text-variable-anchor"),Ne=[],Ze=0,He=g;Ze<He.length;Ze+=1){var rt=He[Ze],gt=f.getTile(rt),bt=gt.getBucket(h);if(bt){var vt=w?bt.text:bt.icon;if(vt&&vt.segments.get().length){var ln=vt.programConfigurations.get(h.id),st=w||bt.sdfIcons,Ht=w?bt.textSizeData:bt.iconSizeData,on=ee||0!==J.pitch,Ye=d.useProgram(Lp(st,w,bt),ln),Pt=v.evaluateSizeForZoom(Ht,J.zoom),Ft=void 0,Ot=[0,0],Tt=void 0,Jn=void 0,Br=null,eo=void 0;if(w)Tt=gt.glyphAtlasTexture,Jn=ne.LINEAR,Ft=gt.glyphAtlasTexture.size,bt.iconsInText&&(Ot=gt.imageAtlasTexture.size,Br=gt.imageAtlasTexture,eo=on||d.options.rotating||d.options.zooming||"composite"===Ht.kind||"camera"===Ht.kind?ne.LINEAR:ne.NEAREST);else{var ui=1!==h.layout.get("icon-size").constantOr(0)||bt.iconsNeedLinear;Tt=gt.imageAtlasTexture,Jn=st||d.options.rotating||d.options.zooming||ui||on?ne.LINEAR:ne.NEAREST,Ft=gt.imageAtlasTexture.size}var di=Qo(gt,1,d.transform.zoom),Wr=Rr(rt.posMatrix,ee,ae,d.transform,di),To=gn(rt.posMatrix,ee,ae,d.transform,di),Pa=ke&&bt.hasTextData(),ho="none"!==h.layout.get("icon-text-fit")&&Pa&&bt.hasIconData();ie&&$n(bt,rt.posMatrix,d,w,Wr,To,ee,L);var Ae=d.translatePosMatrix(rt.posMatrix,gt,C,T),Lt=ie||w&&ke||ho?Nu:Wr,yn=d.translatePosMatrix(To,gt,C,T,!0),er=st&&0!==h.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1),$t={program:Ye,buffers:vt,uniformValues:st?bt.iconsInText?rf(Ht.kind,Pt,de,ee,d,Ae,Lt,yn,Ft,Ot):Ia(Ht.kind,Pt,de,ee,d,Ae,Lt,yn,w,Ft,!0):nf(Ht.kind,Pt,de,ee,d,Ae,Lt,yn,w,Ft),atlasTexture:Tt,atlasTextureIcon:Br,atlasInterpolation:Jn,atlasInterpolationIcon:eo,isSDF:st,hasHalo:er};if(me&&bt.canOverlap){Ie=!0;for(var $c=0,na=vt.segments.get();$c<na.length;$c+=1){var Is=na[$c];Ne.push({segments:new v.SegmentVector([Is]),sortKey:Is.sortKey,state:$t})}}else Ne.push({segments:vt.segments,sortKey:0,state:$t})}}}Ie&&Ne.sort(function(js,tc){return js.sortKey-tc.sortKey});for(var qc=0,ra=Ne;qc<ra.length;qc+=1){var Gc=ra[qc],xi=Gc.state;if(j.activeTexture.set(ne.TEXTURE0),xi.atlasTexture.bind(xi.atlasInterpolation,ne.CLAMP_TO_EDGE),xi.atlasTextureIcon&&(j.activeTexture.set(ne.TEXTURE1),xi.atlasTextureIcon&&xi.atlasTextureIcon.bind(xi.atlasInterpolationIcon,ne.CLAMP_TO_EDGE)),xi.isSDF){var ec=xi.uniformValues;xi.hasHalo&&(ec.u_is_halo=1,Aa(xi.buffers,Gc.segments,h,d,xi.program,Ee,$,q,ec)),ec.u_is_halo=0}Aa(xi.buffers,Gc.segments,h,d,xi.program,Ee,$,q,xi.uniformValues)}}function Aa(d,f,h,g,w,C,T,I,M){var L=g.context;w.draw(L,L.gl.TRIANGLES,C,T,I,he.disabled,M,h.id,d.layoutVertexBuffer,d.indexBuffer,f,h.paint,g.transform.zoom,d.programConfigurations.get(h.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Uc(d,f,h,g,w,C,T){var I,M,L,$,q,j=d.context.gl,ne=h.paint.get("fill-pattern"),J=ne&&ne.constantOr(1),ae=h.getCrossfadeParameters();T?(M=J&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=j.LINES):(M=J?"fillPattern":"fill",I=j.TRIANGLES);for(var ee=0,ie=g;ee<ie.length;ee+=1){var de=ie[ee],me=f.getTile(de);if(!J||me.patternsLoaded()){var Ie=me.getBucket(h);if(Ie){var Ee=Ie.programConfigurations.get(h.id),ke=d.useProgram(M,Ee);J&&(d.context.activeTexture.set(j.TEXTURE0),me.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Ee.updatePaintBuffers(ae));var Ne=ne.constantOr(null);if(Ne&&me.imageAtlas){var Ze=me.imageAtlas,He=Ze.patternPositions[Ne.to.toString()],rt=Ze.patternPositions[Ne.from.toString()];He&&rt&&Ee.setConstantPatternPositions(He,rt)}var gt=d.translatePosMatrix(de.posMatrix,me,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(T){$=Ie.indexBuffer2,q=Ie.segments2;var bt=[j.drawingBufferWidth,j.drawingBufferHeight];L="fillOutlinePattern"===M&&J?Ig(gt,d,ae,me,bt):Pu(gt,bt)}else $=Ie.indexBuffer,q=Ie.segments,L=J?sl(gt,d,ae,me):Zl(gt);ke.draw(d.context,I,w,d.stencilModeForClipping(de),C,he.disabled,L,h.id,Ie.layoutVertexBuffer,$,q,h.paint,d.transform.zoom,Ee)}}}}function al(d,f,h,g,w,C,T){for(var I=d.context,M=I.gl,L=h.paint.get("fill-extrusion-pattern"),$=L.constantOr(1),q=h.getCrossfadeParameters(),j=h.paint.get("fill-extrusion-opacity"),ne=0,J=g;ne<J.length;ne+=1){var ae=J[ne],ee=f.getTile(ae),ie=ee.getBucket(h);if(ie){var de=ie.programConfigurations.get(h.id),me=d.useProgram($?"fillExtrusionPattern":"fillExtrusion",de);$&&(d.context.activeTexture.set(M.TEXTURE0),ee.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),de.updatePaintBuffers(q));var Ie=L.constantOr(null);if(Ie&&ee.imageAtlas){var Ee=ee.imageAtlas,ke=Ee.patternPositions[Ie.to.toString()],Ne=Ee.patternPositions[Ie.from.toString()];ke&&Ne&&de.setConstantPatternPositions(ke,Ne)}var Ze=d.translatePosMatrix(ae.posMatrix,ee,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),He=h.paint.get("fill-extrusion-vertical-gradient"),rt=$?v0(Ze,d,He,j,ae,q,ee):Xh(Ze,d,He,j);me.draw(I,I.gl.TRIANGLES,w,C,T,he.backCCW,rt,h.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,h.paint,d.transform.zoom,de)}}}function Ky(d,f,h,g,w,C){var T=d.context,I=T.gl,M=f.fbo;if(M){var L=d.useProgram("hillshade");T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,M.colorAttachment.get());var $=function(q,j,ne){var J=ne.paint.get("hillshade-shadow-color"),ae=ne.paint.get("hillshade-highlight-color"),ee=ne.paint.get("hillshade-accent-color"),ie=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ne.paint.get("hillshade-illumination-anchor")&&(ie-=q.transform.angle);var de,me,Ie,Ee=!q.options.moving;return{u_matrix:q.transform.calculatePosMatrix(j.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:(de=j.tileID,me=Math.pow(2,de.canonical.z),Ie=de.canonical.y,[new v.MercatorCoordinate(0,Ie/me).toLngLat().lat,new v.MercatorCoordinate(0,(Ie+1)/me).toLngLat().lat]),u_light:[ne.paint.get("hillshade-exaggeration"),ie],u_shadow:J,u_highlight:ae,u_accent:ee}}(d,f,h);L.draw(T,I.TRIANGLES,g,w,C,he.disabled,$,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function Cs(d,f,h,g,w,C){var ae,ee,ie,de,T=d.context,I=T.gl,M=f.dem;if(M&&M.data){var L=M.dim,$=M.stride,q=M.getPixels();if(T.activeTexture.set(I.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),f.demTexture=f.demTexture||d.getTileTexture($),f.demTexture){var j=f.demTexture;j.update(q,{premultiply:!1}),j.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else f.demTexture=new v.Texture(T,q,I.RGBA,{premultiply:!1}),f.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);T.activeTexture.set(I.TEXTURE0);var ne=f.fbo;if(!ne){var J=new v.Texture(T,{width:L,height:L,data:null},I.RGBA);J.bind(I.LINEAR,I.CLAMP_TO_EDGE),(ne=f.fbo=T.createFramebuffer(L,L,!0)).colorAttachment.set(J.texture)}T.bindFramebuffer.set(ne.framebuffer),T.viewport.set([0,0,L,L]),d.useProgram("hillshadePrepare").draw(T,I.TRIANGLES,g,w,C,he.disabled,(ae=f.tileID,ie=(ee=M).stride,de=v.create(),v.ortho(de,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(de,de,[0,-v.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[ie,ie],u_zoom:ae.overscaledZ,u_unpack:ee.getUnpackVector()}),h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),f.needsHillshadePrepare=!1}}function Tr(d,f,h,g,w){var C=g.paint.get("raster-fade-duration");if(C>0){var T=v.browser.now(),I=(T-d.timeAdded)/C,M=f?(T-f.timeAdded)/C:-1,L=h.getSource(),$=w.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),q=!f||Math.abs(f.tileID.overscaledZ-$)>Math.abs(d.tileID.overscaledZ-$),j=q&&d.refreshedUponExpiration?1:v.clamp(q?I:1-M,0,1);return d.refreshedUponExpiration&&I>=1&&(d.refreshedUponExpiration=!1),f?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}var Vs=new v.Color(1,0,0,1),af=new v.Color(0,1,0,1),lf=new v.Color(0,0,1,1),Bd=new v.Color(1,0,1,1),Ra=new v.Color(0,1,1,1);function cf(d,f,h,g){jc(d,0,f+h/2,d.transform.width,h,g)}function uf(d,f,h,g){jc(d,f-h/2,0,h,d.transform.height,g)}function jc(d,f,h,g,w,C){var T=d.context,I=T.gl;I.enable(I.SCISSOR_TEST),I.scissor(f*v.browser.devicePixelRatio,h*v.browser.devicePixelRatio,g*v.browser.devicePixelRatio,w*v.browser.devicePixelRatio),T.clear({color:C}),I.disable(I.SCISSOR_TEST)}function Fp(d,f,h){var g=d.context,w=g.gl,C=h.posMatrix,T=d.useProgram("debug"),I=G.disabled,M=te.disabled,L=d.colorModeForRenderPass();g.activeTexture.set(w.TEXTURE0),d.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T.draw(g,w.LINE_STRIP,I,M,L,he.disabled,ef(C,v.Color.red),"$debug",d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments);var $=f.getTileByID(h.key).latestRawTileData,q=Math.floor(($&&$.byteLength||0)/1024),j=f.getTile(h).tileSize,ne=512/Math.min(j,512)*(h.overscaledZ/d.transform.zoom)*.5,J=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(J+=" => "+h.overscaledZ),function(ae,ee){ae.initDebugOverlayCanvas();var ie=ae.debugOverlayCanvas,de=ae.context.gl,me=ae.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,ie.width,ie.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(ee,5,5),me.strokeText(ee,5,5),ae.debugOverlayTexture.update(ie),ae.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(d,J+" "+q+"kb"),T.draw(g,w.TRIANGLES,I,M,ue.alphaBlended,he.disabled,ef(C,v.Color.transparent,ne),"$debug",d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}var Lu={symbol:function(d,f,h,g,w){if("translucent"===d.renderPass){var C=te.disabled,T=d.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,M,L,$,q,j,ne){for(var J=M.transform,ae="map"===q,ee="map"===j,ie=0,de=I;ie<de.length;ie+=1){var me=de[ie],Ie=$.getTile(me),Ee=Ie.getBucket(L);if(Ee&&Ee.text&&Ee.text.segments.get().length){var ke=v.evaluateSizeForZoom(Ee.textSizeData,J.zoom),Ne=Qo(Ie,1,M.transform.zoom),Ze=Rr(me.posMatrix,ee,ae,M.transform,Ne),He="none"!==L.layout.get("icon-text-fit")&&Ee.hasIconData();if(ke){var rt=Math.pow(2,J.zoom-Ie.tileID.overscaledZ);Fd(Ee,ae,ee,ne,v.symbolSize,J,Ze,me.posMatrix,rt,ke,He)}}}}(g,d,h,f,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w),0!==h.paint.get("icon-opacity").constantOr(1)&&sf(d,f,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,T),0!==h.paint.get("text-opacity").constantOr(1)&&sf(d,f,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,T),f.map.showCollisionBoxes&&(Kl(d,f,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Kl(d,f,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(d,f,h,g){if("translucent"===d.renderPass){var w=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),T=h.paint.get("circle-stroke-opacity"),I=!h.layout.get("circle-sort-key").isConstant();if(0!==w.constantOr(1)||0!==C.constantOr(1)&&0!==T.constantOr(1)){for(var M=d.context,L=M.gl,$=d.depthModeForSublayer(0,G.ReadOnly),q=te.disabled,j=d.colorModeForRenderPass(),ne=[],J=0;J<g.length;J++){var ae=g[J],ee=f.getTile(ae),ie=ee.getBucket(h);if(ie){var de=ie.programConfigurations.get(h.id),me={programConfiguration:de,program:d.useProgram("circle",de),layoutVertexBuffer:ie.layoutVertexBuffer,indexBuffer:ie.indexBuffer,uniformValues:Qh(d,ae,ee,h)};if(I)for(var Ie=0,Ee=ie.segments.get();Ie<Ee.length;Ie+=1){var ke=Ee[Ie];ne.push({segments:new v.SegmentVector([ke]),sortKey:ke.sortKey,state:me})}else ne.push({segments:ie.segments,sortKey:0,state:me})}}I&&ne.sort(function(gt,bt){return gt.sortKey-bt.sortKey});for(var Ne=0,Ze=ne;Ne<Ze.length;Ne+=1){var He=Ze[Ne],rt=He.state;rt.program.draw(M,L.TRIANGLES,$,q,j,he.disabled,rt.uniformValues,h.id,rt.layoutVertexBuffer,rt.indexBuffer,He.segments,h.paint,d.transform.zoom,rt.programConfiguration)}}}},heatmap:function(d,f,h,g){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){var w=d.context,C=w.gl,T=te.disabled,I=new ue([C.ONE,C.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(ne,J,ae){var ee=ne.gl;ne.activeTexture.set(ee.TEXTURE1),ne.viewport.set([0,0,J.width/4,J.height/4]);var me,Ie,Ee,ke,Ne,ie=ae.heatmapFbo;if(ie)ee.bindTexture(ee.TEXTURE_2D,ie.colorAttachment.get()),ne.bindFramebuffer.set(ie.framebuffer);else{var de=ee.createTexture();ee.bindTexture(ee.TEXTURE_2D,de),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),Ee=de,ke=ie=ae.heatmapFbo=ne.createFramebuffer(J.width/4,J.height/4,!1),(Ne=(me=ne).gl).texImage2D(Ne.TEXTURE_2D,0,Ne.RGBA,(Ie=J).width/4,Ie.height/4,0,Ne.RGBA,me.extRenderToTextureHalfFloat?me.extTextureHalfFloat.HALF_FLOAT_OES:Ne.UNSIGNED_BYTE,null),ke.colorAttachment.set(Ee)}})(w,d,h),w.clear({color:v.Color.transparent});for(var M=0;M<g.length;M++){var L=g[M];if(!f.hasRenderableParent(L)){var $=f.getTile(L),q=$.getBucket(h);if(q){var j=q.programConfigurations.get(h.id);d.useProgram("heatmap",j).draw(w,C.TRIANGLES,G.disabled,T,I,he.disabled,Md(L.posMatrix,$,d.transform.zoom,h.paint.get("heatmap-intensity")),h.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,h.paint,d.transform.zoom,j)}}}w.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(ne,J){var ae=ne.context,ee=ae.gl,ie=J.heatmapFbo;if(ie){ae.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,ie.colorAttachment.get()),ae.activeTexture.set(ee.TEXTURE1);var de=J.colorRampTexture;de||(de=J.colorRampTexture=new v.Texture(ae,J.colorRamp,ee.RGBA)),de.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ne.useProgram("heatmapTexture").draw(ae,ee.TRIANGLES,G.disabled,te.disabled,ne.colorModeForRenderPass(),he.disabled,function(me,Ie){var Ne=v.create();v.ortho(Ne,0,me.width,me.height,0,0,1);var Ze=me.context.gl;return{u_matrix:Ne,u_world:[Ze.drawingBufferWidth,Ze.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ie.paint.get("heatmap-opacity")}}(ne,J),J.id,ne.viewportBuffer,ne.quadTriangleIndexBuffer,ne.viewportSegments,J.paint,ne.transform.zoom)}}(d,h))},line:function(d,f,h,g){if("translucent"===d.renderPass){var w=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(0!==w.constantOr(1)&&0!==C.constantOr(1))for(var T=d.depthModeForSublayer(0,G.ReadOnly),I=d.colorModeForRenderPass(),M=h.paint.get("line-dasharray"),L=h.paint.get("line-pattern"),$=L.constantOr(1),q=h.paint.get("line-gradient"),j=h.getCrossfadeParameters(),ne=$?"linePattern":M?"lineSDF":q?"lineGradient":"line",J=d.context,ae=J.gl,ee=!0,ie=0,de=g;ie<de.length;ie+=1){var me=de[ie],Ie=f.getTile(me);if(!$||Ie.patternsLoaded()){var Ee=Ie.getBucket(h);if(Ee){var ke=Ee.programConfigurations.get(h.id),Ne=d.context.program.get(),Ze=d.useProgram(ne,ke),He=ee||Ze.program!==Ne,rt=L.constantOr(null);if(rt&&Ie.imageAtlas){var gt=Ie.imageAtlas,bt=gt.patternPositions[rt.to.toString()],vt=gt.patternPositions[rt.from.toString()];bt&&vt&&ke.setConstantPatternPositions(bt,vt)}var ln=$?ur(d,Ie,h,j):M?tf(d,Ie,h,M,j):q?Pd(d,Ie,h,Ee.lineClipsArray.length):Sa(d,Ie,h);if($)J.activeTexture.set(ae.TEXTURE0),Ie.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),ke.updatePaintBuffers(j);else if(M&&(He||d.lineAtlas.dirty))J.activeTexture.set(ae.TEXTURE0),d.lineAtlas.bind(J);else if(q){var st=Ee.gradients[h.id],Ht=st.texture;if(h.gradientVersion!==st.version){var on=256;if(h.stepInterpolant){var Ye=f.getSource().maxzoom,Pt=me.canonical.z===Ye?Math.ceil(1<<d.transform.maxZoom-me.canonical.z):1;on=v.clamp(v.nextPowerOfTwo(Ee.maxLineLength/v.EXTENT*1024*Pt),256,J.maxTextureSize)}st.gradient=v.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:on,image:st.gradient||void 0,clips:Ee.lineClipsArray}),st.texture?st.texture.update(st.gradient):st.texture=new v.Texture(J,st.gradient,ae.RGBA),st.version=h.gradientVersion,Ht=st.texture}J.activeTexture.set(ae.TEXTURE0),Ht.bind(h.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}Ze.draw(J,ae.TRIANGLES,T,d.stencilModeForClipping(me),I,he.disabled,ln,h.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,h.paint,d.transform.zoom,ke,Ee.layoutVertexBuffer2),ee=!1}}}}},fill:function(d,f,h,g){var w=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(0!==C.constantOr(1)){var T=d.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),M=d.opaquePassEnabledForLayer()&&!I.constantOr(1)&&1===w.constantOr(v.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(d.renderPass===M){var L=d.depthModeForSublayer(1,"opaque"===d.renderPass?G.ReadWrite:G.ReadOnly);Uc(d,f,h,g,L,T,!1)}if("translucent"===d.renderPass&&h.paint.get("fill-antialias")){var $=d.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);Uc(d,f,h,g,$,T,!0)}}},"fill-extrusion":function(d,f,h,g){var w=h.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===d.renderPass){var C=new G(d.context.gl.LEQUAL,G.ReadWrite,d.depthRangeFor3D);if(1!==w||h.paint.get("fill-extrusion-pattern").constantOr(1))al(d,f,h,g,C,te.disabled,ue.disabled),al(d,f,h,g,C,d.stencilModeFor3D(),d.colorModeForRenderPass());else{var T=d.colorModeForRenderPass();al(d,f,h,g,C,te.disabled,T)}}},hillshade:function(d,f,h,g){if("offscreen"===d.renderPass||"translucent"===d.renderPass){for(var w=d.context,C=d.depthModeForSublayer(0,G.ReadOnly),T=d.colorModeForRenderPass(),I="translucent"===d.renderPass?d.stencilConfigForOverlap(g):[{},g],M=I[0],L=0,$=I[1];L<$.length;L+=1){var q=$[L],j=f.getTile(q);j.needsHillshadePrepare&&"offscreen"===d.renderPass?Cs(d,j,h,C,te.disabled,T):"translucent"===d.renderPass&&Ky(d,j,h,C,M[q.overscaledZ],T)}w.viewport.set([0,0,d.width,d.height])}},raster:function(d,f,h,g){if("translucent"===d.renderPass&&0!==h.paint.get("raster-opacity")&&g.length)for(var w=d.context,C=w.gl,T=f.getSource(),I=d.useProgram("raster"),M=d.colorModeForRenderPass(),L=T instanceof ya?[{},g]:d.stencilConfigForOverlap(g),$=L[0],q=L[1],j=q[q.length-1].overscaledZ,ne=!d.options.moving,J=0,ae=q;J<ae.length;J+=1){var ee=ae[J],ie=d.depthModeForSublayer(ee.overscaledZ-j,1===h.paint.get("raster-opacity")?G.ReadWrite:G.ReadOnly,C.LESS),de=f.getTile(ee),me=d.transform.calculatePosMatrix(ee.toUnwrapped(),ne);de.registerFadeDuration(h.paint.get("raster-fade-duration"));var Ie=f.findLoadedParent(ee,0),Ee=Tr(de,Ie,f,h,d.transform),ke=void 0,Ne=void 0,Ze="nearest"===h.paint.get("raster-resampling")?C.NEAREST:C.LINEAR;w.activeTexture.set(C.TEXTURE0),de.texture.bind(Ze,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(C.TEXTURE1),Ie?(Ie.texture.bind(Ze,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),ke=Math.pow(2,Ie.tileID.overscaledZ-de.tileID.overscaledZ),Ne=[de.tileID.canonical.x*ke%1,de.tileID.canonical.y*ke%1]):de.texture.bind(Ze,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST);var He=Z(me,Ne||[0,0],ke||1,Ee,h);T instanceof ya?I.draw(w,C.TRIANGLES,ie,te.disabled,M,he.disabled,He,h.id,T.boundsBuffer,d.quadTriangleIndexBuffer,T.boundsSegments):I.draw(w,C.TRIANGLES,ie,$[ee.overscaledZ],M,he.disabled,He,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,f,h){var g=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(0!==w){var C=d.context,T=C.gl,I=d.transform,M=I.tileSize,L=h.paint.get("background-pattern");if(!d.isPatternMissing(L)){var $=!L&&1===g.a&&1===w&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass===$){var q=te.disabled,j=d.depthModeForSublayer(0,"opaque"===$?G.ReadWrite:G.ReadOnly),ne=d.colorModeForRenderPass(),J=d.useProgram(L?"backgroundPattern":"background"),ae=I.coveringTiles({tileSize:M});L&&(C.activeTexture.set(T.TEXTURE0),d.imageManager.bind(d.context));for(var ee=h.getCrossfadeParameters(),ie=0,de=ae;ie<de.length;ie+=1){var me=de[ie],Ie=d.transform.calculatePosMatrix(me.toUnwrapped()),Ee=L?Ld(Ie,w,d,L,{tileID:me,tileSize:M},ee):ka(Ie,w,g);J.draw(C,T.TRIANGLES,j,q,ne,he.disabled,Ee,h.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}}}},debug:function(d,f,h){for(var g=0;g<h.length;g++)Fp(d,f,h[g])},custom:function(d,f,h){var g=d.context,w=h.implementation;if("offscreen"===d.renderPass){var C=w.prerender;C&&(d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),C.call(w,g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState())}else if("translucent"===d.renderPass){d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),g.setStencilMode(te.disabled);var T="3d"===w.renderingMode?new G(d.context.gl.LEQUAL,G.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,G.ReadOnly);g.setDepthMode(T),w.render(g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState(),g.bindFramebuffer.set(null)}}},sr=function(d,f){this.context=new K(d),this.transform=f,this._tileTextures={},this.setup(),this.numSublayers=W.maxUnderzooming+W.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new xs,this.gpuTimers={}};sr.prototype.resize=function(d,f){if(this.width=d*v.browser.devicePixelRatio,this.height=f*v.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,g=this.style._order;h<g.length;h+=1)this.style._layers[g[h]].resize()},sr.prototype.setup=function(){var d=this.context,f=new v.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(v.EXTENT,0),f.emplaceBack(0,v.EXTENT),f.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(f,Ca.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);var h=new v.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(v.EXTENT,0),h.emplaceBack(0,v.EXTENT),h.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=d.createVertexBuffer(h,Ca.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);var g=new v.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(v.EXTENT,0,v.EXTENT,0),g.emplaceBack(0,v.EXTENT,0,v.EXTENT),g.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.rasterBoundsBuffer=d.createVertexBuffer(g,Zi.members),this.rasterBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);var w=new v.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(w,Ca.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);var C=new v.StructArrayLayout1ui2;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=d.createIndexBuffer(C);var T=new v.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(T),this.emptyTexture=new v.Texture(d,{width:1,height:1,data:new Uint8Array([0,0,0,0])},d.gl.RGBA);var I=this.context.gl;this.stencilClearMode=new te({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)},sr.prototype.clearStencil=function(){var d=this.context,f=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=v.create();v.ortho(h,0,this.width,this.height,0,0,1),v.scale(h,h,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,f.TRIANGLES,G.disabled,this.stencilClearMode,ue.disabled,he.disabled,Ou(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},sr.prototype._renderTileClippingMasks=function(d,f){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&f&&f.length){this.currentStencilSource=d.source;var h=this.context,g=h.gl;this.nextStencilID+f.length>256&&this.clearStencil(),h.setColorMode(ue.disabled),h.setDepthMode(G.disabled);var w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var C=0,T=f;C<T.length;C+=1){var I=T[C],M=this._tileClippingMaskIDs[I.key]=this.nextStencilID++;w.draw(h,g.TRIANGLES,G.disabled,new te({func:g.ALWAYS,mask:0},M,255,g.KEEP,g.KEEP,g.REPLACE),ue.disabled,he.disabled,Ou(I.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},sr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var d=this.nextStencilID++,f=this.context.gl;return new te({func:f.NOTEQUAL,mask:255},d,255,f.KEEP,f.KEEP,f.REPLACE)},sr.prototype.stencilModeForClipping=function(d){var f=this.context.gl;return new te({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,f.KEEP,f.KEEP,f.REPLACE)},sr.prototype.stencilConfigForOverlap=function(d){var f,h=this.context.gl,g=d.sort(function(M,L){return L.overscaledZ-M.overscaledZ}),w=g[g.length-1].overscaledZ,C=g[0].overscaledZ-w+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();for(var T={},I=0;I<C;I++)T[I+w]=new te({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=C,[T,g]}return[(f={},f[w]=te.disabled,f),g]},sr.prototype.colorModeForRenderPass=function(){var d=this.context.gl;return this._showOverdrawInspector?new ue([d.CONSTANT_COLOR,d.ONE],new v.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ue.unblended:ue.alphaBlended},sr.prototype.depthModeForSublayer=function(d,f,h){if(!this.opaquePassEnabledForLayer())return G.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new G(h||this.context.gl.LEQUAL,f,[g,g])},sr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},sr.prototype.render=function(d,f){var h=this;this.style=d,this.options=f,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(v.browser.now()),this.imageManager.beginFrame();var g=this.style._order,w=this.style.sourceCaches;for(var C in w){var T=w[C];T.used&&T.prepare(this.context)}var I,M,L={},$={},q={};for(var j in w){var ne=w[j];L[j]=ne.getVisibleCoordinates(),$[j]=L[j].slice().reverse(),q[j]=ne.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var J=0;J<g.length;J++)if(this.style._layers[g[J]].is3D()){this.opaquePassCutoff=J;break}this.renderPass="offscreen";for(var ae=0,ee=g;ae<ee.length;ae+=1){var ie=this.style._layers[ee[ae]];if(ie.hasOffscreenPass()&&!ie.isHidden(this.transform.zoom)){var de=$[ie.source];("custom"===ie.type||de.length)&&this.renderLayer(this,w[ie.source],ie,de)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?v.Color.black:v.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var me=this.style._layers[g[this.currentLayer]],Ie=w[me.source],Ee=L[me.source];this._renderTileClippingMasks(me,Ee),this.renderLayer(this,Ie,me,Ee)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var ke=this.style._layers[g[this.currentLayer]],Ne=w[ke.source],Ze=("symbol"===ke.type?q:$)[ke.source];this._renderTileClippingMasks(ke,L[ke.source]),this.renderLayer(this,Ne,ke,Ze)}this.options.showTileBoundaries&&(v.values(this.style._layers).forEach(function(He){He.source&&!He.isHidden(h.transform.zoom)&&(He.source!==(M&&M.id)&&(M=h.style.sourceCaches[He.source]),(!I||I.getSource().maxzoom<M.getSource().maxzoom)&&(I=M))}),I&&Lu.debug(this,I,I.getVisibleCoordinates())),this.options.showPadding&&function(He){var rt=He.transform.padding;cf(He,He.transform.height-(rt.top||0),3,Vs),cf(He,rt.bottom||0,3,af),uf(He,rt.left||0,3,lf),uf(He,He.transform.width-(rt.right||0),3,Bd);var bt,vt,ln,st,gt=He.transform.centerPoint;jc(bt=He,(vt=gt.x)-1,(ln=He.transform.height-gt.y)-10,2,20,st=Ra),jc(bt,vt-10,ln-1,20,2,st)}(this),this.context.setDefault()},sr.prototype.renderLayer=function(d,f,h,g){h.isHidden(this.transform.zoom)||("background"===h.type||"custom"===h.type||g.length)&&(this.id=h.id,this.gpuTimingStart(h),Lu[h.type](d,f,h,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},sr.prototype.gpuTimingStart=function(d){if(this.options.gpuTiming){var f=this.context.extTimerQuery,h=this.gpuTimers[d.id];h||(h=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),h.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,h.query)}},sr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}},sr.prototype.collectGpuTimers=function(){var d=this.gpuTimers;return this.gpuTimers={},d},sr.prototype.queryGpuTimers=function(d){var f={};for(var h in d){var g=d[h],w=this.context.extTimerQuery,C=w.getQueryObjectEXT(g.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(g.query),f[h]=C}return f},sr.prototype.translatePosMatrix=function(d,f,h,g,w){if(!h[0]&&!h[1])return d;var C=w?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(C){var T=Math.sin(C),I=Math.cos(C);h=[h[0]*I-h[1]*T,h[0]*T+h[1]*I]}var M=[w?h[0]:Qo(f,h[0],this.transform.zoom),w?h[1]:Qo(f,h[1],this.transform.zoom),0],L=new Float32Array(16);return v.translate(L,d,M),L},sr.prototype.saveTileTexture=function(d){var f=this._tileTextures[d.size[0]];f?f.push(d):this._tileTextures[d.size[0]]=[d]},sr.prototype.getTileTexture=function(d){var f=this._tileTextures[d];return f&&f.length>0?f.pop():null},sr.prototype.isPatternMissing=function(d){if(!d)return!1;if(!d.from||!d.to)return!0;var f=this.imageManager.getPattern(d.from.toString()),h=this.imageManager.getPattern(d.to.toString());return!f||!h},sr.prototype.useProgram=function(d,f){this.cache=this.cache||{};var h=""+d+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new Zy(this.context,d,Ta[d],f,so[d],this._showOverdrawInspector)),this.cache[h]},sr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},sr.prototype.setBaseState=function(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)},sr.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=v.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},sr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Fu=function(d,f){this.points=d,this.planes=f};Fu.fromInvProjectionMatrix=function(d,f,h){var g=Math.pow(2,h),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return v.transformMat4([],T,d)}).map(function(T){return v.scale$1([],T,1/T[3]/f*g)}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var I=v.sub([],w[T[0]],w[T[1]]),M=v.sub([],w[T[2]],w[T[1]]),L=v.normalize([],v.cross([],I,M)),$=-v.dot(L,w[T[1]]);return L.concat($)});return new Fu(w,C)};var Hc=function(d,f){this.min=d,this.max=f,this.center=v.scale$2([],v.add([],this.min,this.max),.5)};Hc.prototype.quadrant=function(d){for(var f=[d%2==0,d<2],h=v.clone$2(this.min),g=v.clone$2(this.max),w=0;w<f.length;w++)h[w]=f[w]?this.min[w]:this.center[w],g[w]=f[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new Hc(h,g)},Hc.prototype.distanceX=function(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]},Hc.prototype.distanceY=function(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]},Hc.prototype.intersects=function(d){for(var f=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,g=0;g<d.planes.length;g++){for(var w=d.planes[g],C=0,T=0;T<f.length;T++)C+=v.dot$1(w,f[T])>=0;if(0===C)return 0;C!==f.length&&(h=!1)}if(h)return 2;for(var I=0;I<3;I++){for(var M=Number.MAX_VALUE,L=-Number.MAX_VALUE,$=0;$<d.points.length;$++){var q=d.points[$][I]-this.min[I];M=Math.min(M,q),L=Math.max(L,q)}if(L<0||M>this.max[I]-this.min[I])return 0}return 1};var Ma=function(d,f,h,g){if(void 0===d&&(d=0),void 0===f&&(f=0),void 0===h&&(h=0),void 0===g&&(g=0),isNaN(d)||d<0||isNaN(f)||f<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=f,this.left=h,this.right=g};Ma.prototype.interpolate=function(d,f,h){return null!=f.top&&null!=d.top&&(this.top=v.number(d.top,f.top,h)),null!=f.bottom&&null!=d.bottom&&(this.bottom=v.number(d.bottom,f.bottom,h)),null!=f.left&&null!=d.left&&(this.left=v.number(d.left,f.left,h)),null!=f.right&&null!=d.right&&(this.right=v.number(d.right,f.right,h)),this},Ma.prototype.getCenter=function(d,f){var h=v.clamp((this.left+d-this.right)/2,0,d),g=v.clamp((this.top+f-this.bottom)/2,0,f);return new v.Point(h,g)},Ma.prototype.equals=function(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right},Ma.prototype.clone=function(){return new Ma(this.top,this.bottom,this.left,this.right)},Ma.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var qn=function(d,f,h,g,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===w||w,this._minZoom=d||0,this._maxZoom=f||22,this._minPitch=h??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ma,this._posMatrixCache={},this._alignedPosMatrixCache={}},xn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};qn.prototype.clone=function(){var d=new qn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.tileSize=this.tileSize,d.latRange=this.latRange,d.width=this.width,d.height=this.height,d._center=this._center,d.zoom=this.zoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._calcMatrices(),d},xn.minZoom.get=function(){return this._minZoom},xn.minZoom.set=function(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))},xn.maxZoom.get=function(){return this._maxZoom},xn.maxZoom.set=function(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))},xn.minPitch.get=function(){return this._minPitch},xn.minPitch.set=function(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))},xn.maxPitch.get=function(){return this._maxPitch},xn.maxPitch.set=function(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))},xn.renderWorldCopies.get=function(){return this._renderWorldCopies},xn.renderWorldCopies.set=function(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d},xn.worldSize.get=function(){return this.tileSize*this.scale},xn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},xn.size.get=function(){return new v.Point(this.width,this.height)},xn.bearing.get=function(){return-this.angle/Math.PI*180},xn.bearing.set=function(d){var f=-v.wrap(d,-180,180)*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=v.create$2(),v.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},xn.pitch.get=function(){return this._pitch/Math.PI*180},xn.pitch.set=function(d){var f=v.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())},xn.fov.get=function(){return this._fov/Math.PI*180},xn.fov.set=function(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())},xn.zoom.get=function(){return this._zoom},xn.zoom.set=function(d){var f=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())},xn.center.get=function(){return this._center},xn.center.set=function(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())},xn.padding.get=function(){return this._edgeInsets.toJSON()},xn.padding.set=function(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())},xn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},qn.prototype.isPaddingEqual=function(d){return this._edgeInsets.equals(d)},qn.prototype.interpolatePadding=function(d,f,h){this._unmodified=!1,this._edgeInsets.interpolate(d,f,h),this._constrain(),this._calcMatrices()},qn.prototype.coveringZoomLevel=function(d){var f=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,f)},qn.prototype.getVisibleUnwrappedCoordinates=function(d){var f=[new v.UnwrappedTileID(0,d)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new v.Point(0,0)),g=this.pointCoordinate(new v.Point(this.width,0)),w=this.pointCoordinate(new v.Point(this.width,this.height)),C=this.pointCoordinate(new v.Point(0,this.height)),T=Math.floor(Math.min(h.x,g.x,w.x,C.x)),I=Math.floor(Math.max(h.x,g.x,w.x,C.x)),M=T-1;M<=I+1;M++)0!==M&&f.push(new v.UnwrappedTileID(M,d));return f},qn.prototype.coveringTiles=function(d){var f=this.coveringZoomLevel(d),h=f;if(void 0!==d.minzoom&&f<d.minzoom)return[];void 0!==d.maxzoom&&f>d.maxzoom&&(f=d.maxzoom);var g=v.MercatorCoordinate.fromLngLat(this.center),w=Math.pow(2,f),C=[w*g.x,w*g.y,0],T=Fu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),I=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(I=f);var M=function(He){return{aabb:new Hc([He*w,0,0],[(He+1)*w,w,0]),zoom:0,x:0,y:0,wrap:He,fullyVisible:!1}},L=[],$=[],q=f,j=d.reparseOverscaled?h:f;if(this._renderWorldCopies)for(var ne=1;ne<=3;ne++)L.push(M(-ne)),L.push(M(ne));for(L.push(M(0));L.length>0;){var J=L.pop(),ae=J.x,ee=J.y,ie=J.fullyVisible;if(!ie){var de=J.aabb.intersects(T);if(0===de)continue;ie=2===de}var me=J.aabb.distanceX(C),Ie=J.aabb.distanceY(C),Ee=Math.max(Math.abs(me),Math.abs(Ie));if(J.zoom===q||Ee>3+(1<<q-J.zoom)-2&&J.zoom>=I)$.push({tileID:new v.OverscaledTileID(J.zoom===q?j:J.zoom,J.wrap,J.zoom,ae,ee),distanceSq:v.sqrLen([C[0]-.5-ae,C[1]-.5-ee])});else for(var ke=0;ke<4;ke++){var Ne=(ae<<1)+ke%2,Ze=(ee<<1)+(ke>>1);L.push({aabb:J.aabb.quadrant(ke),zoom:J.zoom+1,x:Ne,y:Ze,wrap:J.wrap,fullyVisible:ie})}}return $.sort(function(He,rt){return He.distanceSq-rt.distanceSq}).map(function(He){return He.tileID})},qn.prototype.resize=function(d,f){this.width=d,this.height=f,this.pixelsToGLUnits=[2/d,-2/f],this._constrain(),this._calcMatrices()},xn.unmodified.get=function(){return this._unmodified},qn.prototype.zoomScale=function(d){return Math.pow(2,d)},qn.prototype.scaleZoom=function(d){return Math.log(d)/Math.LN2},qn.prototype.project=function(d){var f=v.clamp(d.lat,-this.maxValidLatitude,this.maxValidLatitude);return new v.Point(v.mercatorXfromLng(d.lng)*this.worldSize,v.mercatorYfromLat(f)*this.worldSize)},qn.prototype.unproject=function(d){return new v.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()},xn.point.get=function(){return this.project(this.center)},qn.prototype.setLocationAtPoint=function(d,f){var h=this.pointCoordinate(f),g=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(d),C=new v.MercatorCoordinate(w.x-(h.x-g.x),w.y-(h.y-g.y));this.center=this.coordinateLocation(C),this._renderWorldCopies&&(this.center=this.center.wrap())},qn.prototype.locationPoint=function(d){return this.coordinatePoint(this.locationCoordinate(d))},qn.prototype.pointLocation=function(d){return this.coordinateLocation(this.pointCoordinate(d))},qn.prototype.locationCoordinate=function(d){return v.MercatorCoordinate.fromLngLat(d)},qn.prototype.coordinateLocation=function(d){return d.toLngLat()},qn.prototype.pointCoordinate=function(d){var f=[d.x,d.y,0,1],h=[d.x,d.y,1,1];v.transformMat4(f,f,this.pixelMatrixInverse),v.transformMat4(h,h,this.pixelMatrixInverse);var g=f[3],w=h[3],C=f[1]/g,T=h[1]/w,I=f[2]/g,M=h[2]/w,L=I===M?0:(0-I)/(M-I);return new v.MercatorCoordinate(v.number(f[0]/g,h[0]/w,L)/this.worldSize,v.number(C,T,L)/this.worldSize)},qn.prototype.coordinatePoint=function(d){var f=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(f,f,this.pixelMatrix),new v.Point(f[0]/f[3],f[1]/f[3])},qn.prototype.getBounds=function(){return(new v.LngLatBounds).extend(this.pointLocation(new v.Point(0,0))).extend(this.pointLocation(new v.Point(this.width,0))).extend(this.pointLocation(new v.Point(this.width,this.height))).extend(this.pointLocation(new v.Point(0,this.height)))},qn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new v.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},qn.prototype.setMaxBounds=function(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},qn.prototype.calculatePosMatrix=function(d,f){void 0===f&&(f=!1);var h=d.key,g=f?this._alignedPosMatrixCache:this._posMatrixCache;if(g[h])return g[h];var w=d.canonical,C=this.worldSize/this.zoomScale(w.z),T=w.x+Math.pow(2,w.z)*d.wrap,I=v.identity(new Float64Array(16));return v.translate(I,I,[T*C,w.y*C,0]),v.scale(I,I,[C/v.EXTENT,C/v.EXTENT,1]),v.multiply(I,f?this.alignedProjMatrix:this.projMatrix,I),g[h]=new Float32Array(I),g[h]},qn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},qn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var d,f,h,g,w=-90,C=90,T=-180,I=180,M=this.size,L=this._unmodified;if(this.latRange){var $=this.latRange;w=v.mercatorYfromLat($[1])*this.worldSize,d=(C=v.mercatorYfromLat($[0])*this.worldSize)-w<M.y?M.y/(C-w):0}if(this.lngRange){var q=this.lngRange;T=v.mercatorXfromLng(q[0])*this.worldSize,f=(I=v.mercatorXfromLng(q[1])*this.worldSize)-T<M.x?M.x/(I-T):0}var j=this.point,ne=Math.max(f||0,d||0);if(ne)return this.center=this.unproject(new v.Point(f?(I+T)/2:j.x,d?(C+w)/2:j.y)),this.zoom+=this.scaleZoom(ne),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var J=j.y,ae=M.y/2;J-ae<w&&(g=w+ae),J+ae>C&&(g=C-ae)}if(this.lngRange){var ee=j.x,ie=M.x/2;ee-ie<T&&(h=T+ie),ee+ie>I&&(h=I-ie)}void 0===h&&void 0===g||(this.center=this.unproject(new v.Point(void 0!==h?h:j.x,void 0!==g?g:j.y))),this._unmodified=L,this._constraining=!1}},qn.prototype._calcMatrices=function(){if(this.height){var d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var f=Math.PI/2+this._pitch,h=this._fov*(.5+d.y/this.height),g=Math.sin(h)*this.cameraToCenterDistance/Math.sin(v.clamp(Math.PI-f-h,.01,Math.PI-.01)),w=this.point,C=w.x,T=w.y,I=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),M=this.height/50,L=new Float64Array(16);v.perspective(L,this._fov,this.width/this.height,M,I),L[8]=2*-d.x/this.width,L[9]=2*d.y/this.height,v.scale(L,L,[1,-1,1]),v.translate(L,L,[0,0,-this.cameraToCenterDistance]),v.rotateX(L,L,this._pitch),v.rotateZ(L,L,this.angle),v.translate(L,L,[-C,-T,0]),this.mercatorMatrix=v.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),v.scale(L,L,[1,1,v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=v.invert([],this.projMatrix);var $=this.width%2/2,q=this.height%2/2,j=Math.cos(this.angle),ne=Math.sin(this.angle),J=C-Math.round(C)+j*$+ne*q,ae=T-Math.round(T)+j*q+ne*$,ee=new Float64Array(L);if(v.translate(ee,ee,[J>.5?J-1:J,ae>.5?ae-1:ae,0]),this.alignedProjMatrix=ee,L=v.create(),v.scale(L,L,[this.width/2,-this.height/2,1]),v.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=v.create(),v.scale(L,L,[1,-1,1]),v.translate(L,L,[-1,-1,0]),v.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=v.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},qn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var d=this.pointCoordinate(new v.Point(0,0)),f=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance},qn.prototype.getCameraPoint=function(){var d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.Point(0,d))},qn.prototype.getCameraQueryGeometry=function(d){var f=this.getCameraPoint();if(1===d.length)return[d[0],f];for(var h=f.x,g=f.y,w=f.x,C=f.y,T=0,I=d;T<I.length;T+=1){var M=I[T];h=Math.min(h,M.x),g=Math.min(g,M.y),w=Math.max(w,M.x),C=Math.max(C,M.y)}return[new v.Point(h,g),new v.Point(w,g),new v.Point(w,C),new v.Point(h,C),new v.Point(h,g)]},Object.defineProperties(qn.prototype,xn);var Uo=function(d){var f,h,g,w;this._hashName=d&&encodeURIComponent(d),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(f=this._updateHashUnthrottled.bind(this),h=!1,g=null,w=function(){g=null,h&&(f(),g=setTimeout(w,300),h=!1)},function(){return h=!0,g||w(),g})};Uo.prototype.addTo=function(d){return this._map=d,v.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Uo.prototype.remove=function(){return v.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Uo.prototype.getHashString=function(d){var f=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,g=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),C=Math.round(f.lng*w)/w,T=Math.round(f.lat*w)/w,I=this._map.getBearing(),M=this._map.getPitch(),L="";if(L+=d?"/"+C+"/"+T+"/"+h:h+"/"+T+"/"+C,(I||M)&&(L+="/"+Math.round(10*I)/10),M&&(L+="/"+Math.round(M)),this._hashName){var $=this._hashName,q=!1,j=v.window.location.hash.slice(1).split("&").map(function(ne){var J=ne.split("=")[0];return J===$?(q=!0,J+"="+L):ne}).filter(function(ne){return ne});return q||j.push($+"="+L),"#"+j.join("&")}return"#"+L},Uo.prototype._getCurrentHash=function(){var d,f=this,h=v.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===f._hashName&&(d=g)}),(d&&d[1]||"").split("/")):h.split("/")},Uo.prototype._onHashChange=function(){var d=this._getCurrentHash();if(d.length>=3&&!d.some(function(h){return isNaN(h)})){var f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:f,pitch:+(d[4]||0)}),!0}return!1},Uo.prototype._updateHashUnthrottled=function(){var d=v.window.location.href.replace(/(#.+)?$/,this.getHashString());try{v.window.history.replaceState(v.window.history.state,null,d)}catch{}};var Qs={linearity:.3,easing:v.bezier(0,0,.3,1)},df=v.extend({deceleration:2500,maxSpeed:1400},Qs),ll=v.extend({deceleration:20,maxSpeed:1400},Qs),Bu=v.extend({deceleration:1e3,maxSpeed:360},Qs),Bp=v.extend({deceleration:1e3,maxSpeed:90},Qs),Yl=function(d){this._map=d,this.clear()};function Fr(d,f){(!d.duration||d.duration<f.duration)&&(d.duration=f.duration,d.easing=f.easing)}function Js(d,f,h){var g=h.maxSpeed,w=h.linearity,C=h.deceleration,T=v.clamp(d*w/(f/1e3),-g,g),I=Math.abs(T)/(C*w);return{easing:h.easing,duration:1e3*I,amount:T*(I/2)}}Yl.prototype.clear=function(){this._inertiaBuffer=[]},Yl.prototype.record=function(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.browser.now(),settings:d})},Yl.prototype._drainInertiaBuffer=function(){for(var d=this._inertiaBuffer,f=v.browser.now();d.length>0&&f-d[0].time>160;)d.shift()},Yl.prototype._onMoveEnd=function(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var f={zoom:0,bearing:0,pitch:0,pan:new v.Point(0,0),pinchAround:void 0,around:void 0},h=0,g=this._inertiaBuffer;h<g.length;h+=1){var w=g[h].settings;f.zoom+=w.zoomDelta||0,f.bearing+=w.bearingDelta||0,f.pitch+=w.pitchDelta||0,w.panDelta&&f.pan._add(w.panDelta),w.around&&(f.around=w.around),w.pinchAround&&(f.pinchAround=w.pinchAround)}var C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(f.pan.mag()){var I=Js(f.pan.mag(),C,v.extend({},df,d||{}));T.offset=f.pan.mult(I.amount/f.pan.mag()),T.center=this._map.transform.center,Fr(T,I)}if(f.zoom){var M=Js(f.zoom,C,ll);T.zoom=this._map.transform.zoom+M.amount,Fr(T,M)}if(f.bearing){var L=Js(f.bearing,C,Bu);T.bearing=this._map.transform.bearing+v.clamp(L.amount,-179,179),Fr(T,L)}if(f.pitch){var $=Js(f.pitch,C,Bp);T.pitch=this._map.transform.pitch+$.amount,Fr(T,$)}if(T.zoom||T.bearing){var q=void 0===f.pinchAround?f.around:f.pinchAround;T.around=q?this._map.unproject(q):this._map.getCenter()}return this.clear(),v.extend(T,{noMoveStart:!0})}};var Pi=function(d){function f(g,w,C,T){void 0===T&&(T={});var I=Ve.mousePos(w.getCanvasContainer(),C),M=w.unproject(I);d.call(this,g,v.extend({point:I,lngLat:M,originalEvent:C},T)),this._defaultPrevented=!1,this.target=w}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(v.Event),Ds=function(d){function f(g,w,C){var T="touchend"===g?C.changedTouches:C.touches,I=Ve.touchPos(w.getCanvasContainer(),T),M=I.map(function(q){return w.unproject(q)}),L=I.reduce(function(q,j,ne,J){return q.add(j.div(J.length))},new v.Point(0,0)),$=w.unproject(L);d.call(this,g,{points:I,point:L,lngLats:M,lngLat:$,originalEvent:C}),this._defaultPrevented=!1}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(v.Event),kg=function(d){function f(g,w,C){d.call(this,g,{originalEvent:C}),this._defaultPrevented=!1}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var h={defaultPrevented:{configurable:!0}};return f.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(f.prototype,h),f}(v.Event),bi=function(d,f){this._map=d,this._clickTolerance=f.clickTolerance};bi.prototype.reset=function(){delete this._mousedownPos},bi.prototype.wheel=function(d){return this._firePreventable(new kg(d.type,this._map,d))},bi.prototype.mousedown=function(d,f){return this._mousedownPos=f,this._firePreventable(new Pi(d.type,this._map,d))},bi.prototype.mouseup=function(d){this._map.fire(new Pi(d.type,this._map,d))},bi.prototype.click=function(d,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new Pi(d.type,this._map,d))},bi.prototype.dblclick=function(d){return this._firePreventable(new Pi(d.type,this._map,d))},bi.prototype.mouseover=function(d){this._map.fire(new Pi(d.type,this._map,d))},bi.prototype.mouseout=function(d){this._map.fire(new Pi(d.type,this._map,d))},bi.prototype.touchstart=function(d){return this._firePreventable(new Ds(d.type,this._map,d))},bi.prototype.touchmove=function(d){this._map.fire(new Ds(d.type,this._map,d))},bi.prototype.touchend=function(d){this._map.fire(new Ds(d.type,this._map,d))},bi.prototype.touchcancel=function(d){this._map.fire(new Ds(d.type,this._map,d))},bi.prototype._firePreventable=function(d){if(this._map.fire(d),d.defaultPrevented)return{}},bi.prototype.isEnabled=function(){return!0},bi.prototype.isActive=function(){return!1},bi.prototype.enable=function(){},bi.prototype.disable=function(){};var Qi=function(d){this._map=d};Qi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Qi.prototype.mousemove=function(d){this._map.fire(new Pi(d.type,this._map,d))},Qi.prototype.mousedown=function(){this._delayContextMenu=!0},Qi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Qi.prototype.contextmenu=function(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new Pi(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()},Qi.prototype.isEnabled=function(){return!0},Qi.prototype.isActive=function(){return!1},Qi.prototype.enable=function(){},Qi.prototype.disable=function(){};var nt=function(d,f){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=f.clickTolerance||1};function Vd(d,f){for(var h={},g=0;g<d.length;g++)h[d[g].identifier]=f[g];return h}nt.prototype.isEnabled=function(){return!!this._enabled},nt.prototype.isActive=function(){return!!this._active},nt.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},nt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},nt.prototype.mousedown=function(d,f){this.isEnabled()&&d.shiftKey&&0===d.button&&(Ve.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)},nt.prototype.mousemoveWindow=function(d,f){if(this._active){var h=f;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=h,this._box||(this._box=Ve.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));var w=Math.min(g.x,h.x),C=Math.max(g.x,h.x),T=Math.min(g.y,h.y),I=Math.max(g.y,h.y);Ve.setTransform(this._box,"translate("+w+"px,"+T+"px)"),this._box.style.width=C-w+"px",this._box.style.height=I-T+"px"}}},nt.prototype.mouseupWindow=function(d,f){var h=this;if(this._active&&0===d.button){var g=this._startPos,w=f;if(this.reset(),Ve.suppressClick(),g.x!==w.x||g.y!==w.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:function(C){return C.fitScreenCoordinates(g,w,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",d)}},nt.prototype.keydown=function(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))},nt.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(Ve.remove(this._box),this._box=null),Ve.enableDrag(),delete this._startPos,delete this._lastPos},nt.prototype._fireEvent=function(d,f){return this._map.fire(new v.Event(d,{originalEvent:f}))};var Vu=function(d){this.reset(),this.numTouches=d.numTouches};Vu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Vu.prototype.touchstart=function(d,f,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=d.timeStamp),h.length===this.numTouches&&(this.centroid=function(g){for(var w=new v.Point(0,0),C=0,T=g;C<T.length;C+=1)w._add(T[C]);return w.div(g.length)}(f),this.touches=Vd(h,f)))},Vu.prototype.touchmove=function(d,f,h){if(!this.aborted&&this.centroid){var g=Vd(h,f);for(var w in this.touches){var C=g[w];(!C||C.dist(this.touches[w])>30)&&(this.aborted=!0)}}},Vu.prototype.touchend=function(d,f,h){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===h.length){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var Xl=function(d){this.singleTap=new Vu(d),this.numTaps=d.numTaps,this.reset()};Xl.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Xl.prototype.touchstart=function(d,f,h){this.singleTap.touchstart(d,f,h)},Xl.prototype.touchmove=function(d,f,h){this.singleTap.touchmove(d,f,h)},Xl.prototype.touchend=function(d,f,h){var g=this.singleTap.touchend(d,f,h);if(g){var w=d.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(g)<30;if(w&&C||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var Do=function(){this._zoomIn=new Xl({numTouches:1,numTaps:2}),this._zoomOut=new Xl({numTouches:2,numTaps:1}),this.reset()};Do.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Do.prototype.touchstart=function(d,f,h){this._zoomIn.touchstart(d,f,h),this._zoomOut.touchstart(d,f,h)},Do.prototype.touchmove=function(d,f,h){this._zoomIn.touchmove(d,f,h),this._zoomOut.touchmove(d,f,h)},Do.prototype.touchend=function(d,f,h){var g=this,w=this._zoomIn.touchend(d,f,h),C=this._zoomOut.touchend(d,f,h);return w?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(w)},{originalEvent:d})}}):C?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(C)},{originalEvent:d})}}):void 0},Do.prototype.touchcancel=function(){this.reset()},Do.prototype.enable=function(){this._enabled=!0},Do.prototype.disable=function(){this._enabled=!1,this.reset()},Do.prototype.isEnabled=function(){return this._enabled},Do.prototype.isActive=function(){return this._active};var Oi={0:1,2:2},ao=function(d){this.reset(),this._clickTolerance=d.clickTolerance||1};ao.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ao.prototype._correctButton=function(d,f){return!1},ao.prototype._move=function(d,f){return{}},ao.prototype.mousedown=function(d,f){if(!this._lastPoint){var h=Ve.mouseButton(d);this._correctButton(d,h)&&(this._lastPoint=f,this._eventButton=h)}},ao.prototype.mousemoveWindow=function(d,f){var g,C,h=this._lastPoint;if(h)if(d.preventDefault(),C=Oi[this._eventButton],void 0===(g=d).buttons||(g.buttons&C)!==C)this.reset();else if(this._moved||!(f.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(h,f)},ao.prototype.mouseupWindow=function(d){this._lastPoint&&Ve.mouseButton(d)===this._eventButton&&(this._moved&&Ve.suppressClick(),this.reset())},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var lt=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.mousedown=function(h,g){d.prototype.mousedown.call(this,h,g),this._lastPoint&&(this._active=!0)},f.prototype._correctButton=function(h,g){return 0===g&&!h.ctrlKey},f.prototype._move=function(h,g){return{around:g,panDelta:g.sub(h)}},f}(ao),Gr=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},f.prototype._move=function(h,g){var w=.8*(g.x-h.x);if(w)return this._active=!0,{bearingDelta:w}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(ao),qe=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},f.prototype._move=function(h,g){var w=-.5*(g.y-h.y);if(w)return this._active=!0,{pitchDelta:w}},f.prototype.contextmenu=function(h){h.preventDefault()},f}(ao),Rt=function(d){this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset()};Rt.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new v.Point(0,0)},Rt.prototype.touchstart=function(d,f,h){return this._calculateTransform(d,f,h)},Rt.prototype.touchmove=function(d,f,h){if(this._active&&!(h.length<this._minTouches))return d.preventDefault(),this._calculateTransform(d,f,h)},Rt.prototype.touchend=function(d,f,h){this._calculateTransform(d,f,h),this._active&&h.length<this._minTouches&&this.reset()},Rt.prototype.touchcancel=function(){this.reset()},Rt.prototype._calculateTransform=function(d,f,h){h.length>0&&(this._active=!0);var g=Vd(h,f),w=new v.Point(0,0),C=new v.Point(0,0),T=0;for(var I in g){var M=g[I],L=this._touches[I];L&&(w._add(M),C._add(M.sub(L)),T++,g[I]=M)}if(this._touches=g,!(T<this._minTouches)&&C.mag()){var $=C.div(T);if(this._sum._add($),!(this._sum.mag()<this._clickTolerance))return{around:w.div(T),panDelta:$}}},Rt.prototype.enable=function(){this._enabled=!0},Rt.prototype.disable=function(){this._enabled=!1,this.reset()},Rt.prototype.isEnabled=function(){return this._enabled},Rt.prototype.isActive=function(){return this._active};var Pn=function(){this.reset()};function Ni(d,f,h){for(var g=0;g<d.length;g++)if(d[g].identifier===h)return f[g]}function Li(d,f){return Math.log(d/f)/Math.LN2}Pn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Pn.prototype._start=function(d){},Pn.prototype._move=function(d,f,h){return{}},Pn.prototype.touchstart=function(d,f,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([f[0],f[1]]))},Pn.prototype.touchmove=function(d,f,h){if(this._firstTwoTouches){d.preventDefault();var g=this._firstTwoTouches,w=g[1],C=Ni(h,f,g[0]),T=Ni(h,f,w);if(C&&T){var I=this._aroundCenter?null:C.add(T).div(2);return this._move([C,T],I,d)}}},Pn.prototype.touchend=function(d,f,h){if(this._firstTwoTouches){var g=this._firstTwoTouches,w=g[1],C=Ni(h,f,g[0]),T=Ni(h,f,w);C&&T||(this._active&&Ve.suppressClick(),this.reset())}},Pn.prototype.touchcancel=function(){this.reset()},Pn.prototype.enable=function(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around},Pn.prototype.disable=function(){this._enabled=!1,this.reset()},Pn.prototype.isEnabled=function(){return this._enabled},Pn.prototype.isActive=function(){return this._active};var cl=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),delete this._distance,delete this._startDistance},f.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},f.prototype._move=function(h,g){var w=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Li(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Li(this._distance,w),pinchAround:g}},f}(Pn);function Fi(d,f){return 180*d.angleWith(f)/Math.PI}var Tn=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},f.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},f.prototype._move=function(h,g){var w=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fi(this._vector,w),pinchAround:g}},f.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var g=25/(Math.PI*this._minDiameter)*360,w=Fi(h,this._startVector);return Math.abs(w)<g},f}(Pn);function Rn(d){return Math.abs(d.y)>Math.abs(d.x)}var ns=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.reset=function(){d.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},f.prototype._start=function(h){this._lastPoints=h,Rn(h[0].sub(h[1]))&&(this._valid=!1)},f.prototype._move=function(h,g,w){var C=h[0].sub(this._lastPoints[0]),T=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(C,T,w.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(C.y+T.y)/2*-.5}},f.prototype.gestureBeginsVertically=function(h,g,w){if(void 0!==this._valid)return this._valid;var C=h.mag()>=2,T=g.mag()>=2;if(C||T){if(!C||!T)return void 0===this._firstMove&&(this._firstMove=w),w-this._firstMove<100&&void 0;var I=h.y>0==g.y>0;return Rn(h)&&Rn(g)&&I}},f}(Pn),Kt={panStep:100,bearingStep:15,pitchStep:10},lo=function(){var d=Kt;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1};function zd(d){return d*(2-d)}lo.prototype.reset=function(){this._active=!1},lo.prototype.keydown=function(d){var f=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var h=0,g=0,w=0,C=0,T=0;switch(d.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:d.shiftKey?g=-1:(d.preventDefault(),C=-1);break;case 39:d.shiftKey?g=1:(d.preventDefault(),C=1);break;case 38:d.shiftKey?w=1:(d.preventDefault(),T=-1);break;case 40:d.shiftKey?w=-1:(d.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:function(I){var M=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:zd,zoom:h?Math.round(M)+h*(d.shiftKey?2:1):M,bearing:I.getBearing()+g*f._bearingStep,pitch:I.getPitch()+w*f._pitchStep,offset:[-C*f._panStep,-T*f._panStep],center:I.getCenter()},{originalEvent:d})}}}},lo.prototype.enable=function(){this._enabled=!0},lo.prototype.disable=function(){this._enabled=!1,this.reset()},lo.prototype.isEnabled=function(){return this._enabled},lo.prototype.isActive=function(){return this._active},lo.prototype.disableRotation=function(){this._rotationDisabled=!0},lo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Qn=function(d,f){this._map=d,this._el=d.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,v.bindAll(["_onTimeout"],this)};Qn.prototype.setZoomRate=function(d){this._defaultZoomRate=d},Qn.prototype.setWheelZoomRate=function(d){this._wheelZoomRate=d},Qn.prototype.isEnabled=function(){return!!this._enabled},Qn.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},Qn.prototype.isZooming=function(){return!!this._zooming},Qn.prototype.enable=function(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=d&&"center"===d.around)},Qn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Qn.prototype.wheel=function(d){if(this.isEnabled()){var f=d.deltaMode===v.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY,h=v.browser.now(),g=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,0!==f&&f%4.000244140625==0?this._type="wheel":0!==f&&Math.abs(f)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(g*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),d.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=d,this._delta-=f,this._active||this._start(d)),d.preventDefault()}},Qn.prototype._onTimeout=function(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},Qn.prototype._start=function(d){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var f=Ve.mousePos(this._el,d);this._around=v.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Qn.prototype.renderFrame=function(){var d=this;if(this._frameId&&(this._frameId=null,this.isActive())){var f=this._map.transform;if(0!==this._delta){var h="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&0!==g&&(g=1/g);var w="number"==typeof this._targetZoom?f.zoomScale(this._targetZoom):f.scale;this._targetZoom=Math.min(f.maxZoom,Math.max(f.minZoom,f.scaleZoom(w*g))),"wheel"===this._type&&(this._startZoom=f.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var C,T="number"==typeof this._targetZoom?this._targetZoom:f.zoom,I=this._startZoom,M=this._easing,L=!1;if("wheel"===this._type&&I&&M){var $=Math.min((v.browser.now()-this._lastWheelEventTime)/200,1),q=M($);C=v.number(I,T,q),$<1?this._frameId||(this._frameId=!0):L=!0}else C=T,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){d._zooming=!1,d._handler._triggerRenderFrame(),delete d._targetZoom,delete d._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:C-f.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Qn.prototype._smoothOutEasing=function(d){var f=v.ease;if(this._prevEase){var h=this._prevEase,g=(v.browser.now()-h.start)/h.duration,w=h.easing(g+.01)-h.easing(g),C=.27/Math.sqrt(w*w+1e-4)*.01,T=Math.sqrt(.0729-C*C);f=v.bezier(C,T,.25,1)}return this._prevEase={start:v.browser.now(),duration:d,easing:f},f},Qn.prototype.reset=function(){this._active=!1};var Ut=function(d,f){this._clickZoom=d,this._tapZoom=f};Ut.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ut.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ut.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ut.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Bi=function(){this.reset()};Bi.prototype.reset=function(){this._active=!1},Bi.prototype.dblclick=function(d,f){return d.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(d.shiftKey?-1:1),around:h.unproject(f)},{originalEvent:d})}}},Bi.prototype.enable=function(){this._enabled=!0},Bi.prototype.disable=function(){this._enabled=!1,this.reset()},Bi.prototype.isEnabled=function(){return this._enabled},Bi.prototype.isActive=function(){return this._active};var Vi=function(){this._tap=new Xl({numTouches:1,numTaps:1}),this.reset()};Vi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Vi.prototype.touchstart=function(d,f,h){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=f[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(d,f,h))},Vi.prototype.touchmove=function(d,f,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var g=f[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,d.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(d,f,h)},Vi.prototype.touchend=function(d,f,h){this._tapTime?this._swipePoint&&0===h.length&&this.reset():this._tap.touchend(d,f,h)&&(this._tapTime=d.timeStamp)},Vi.prototype.touchcancel=function(){this.reset()},Vi.prototype.enable=function(){this._enabled=!0},Vi.prototype.disable=function(){this._enabled=!1,this.reset()},Vi.prototype.isEnabled=function(){return this._enabled},Vi.prototype.isActive=function(){return this._active};var ai=function(d,f,h){this._el=d,this._mousePan=f,this._touchPan=h};ai.prototype.enable=function(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},ai.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},ai.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ai.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var co=function(d,f,h){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=f,this._mousePitch=h};co.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},co.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},co.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},co.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ea=function(d,f,h,g){this._el=d,this._touchZoom=f,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};ea.prototype.enable=function(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},ea.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},ea.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ea.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ea.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ea.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var jo=function(d){return d.zoom||d.drag||d.pitch||d.rotate},Ho=function(d){function f(){d.apply(this,arguments)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f}(v.Event);function Ts(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}var Xe=function(d,f){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Yl(d),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),v.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[v.window.document,"mousemove",{capture:!0}],[v.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[v.window,"blur",void 0]];for(var g=0,w=this._listeners;g<w.length;g+=1){var C=w[g],T=C[0];Ve.addEventListener(T,C[1],T===v.window.document?this.handleWindowEvent:this.handleEvent,C[2])}};Xe.prototype.destroy=function(){for(var d=0,f=this._listeners;d<f.length;d+=1){var h=f[d],g=h[0];Ve.removeEventListener(g,h[1],g===v.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},Xe.prototype._addDefaultHandlers=function(d){var f=this._map,h=f.getCanvasContainer();this._add("mapEvent",new bi(f,d));var g=f.boxZoom=new nt(f,d);this._add("boxZoom",g);var w=new Do,C=new Bi;f.doubleClickZoom=new Ut(C,w),this._add("tapZoom",w),this._add("clickZoom",C);var T=new Vi;this._add("tapDragZoom",T);var I=f.touchPitch=new ns;this._add("touchPitch",I);var M=new Gr(d),L=new qe(d);f.dragRotate=new co(d,M,L),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var $=new lt(d),q=new Rt(d);f.dragPan=new ai(h,$,q),this._add("mousePan",$),this._add("touchPan",q,["touchZoom","touchRotate"]);var j=new Tn,ne=new cl;f.touchZoomRotate=new ea(h,ne,j,T),this._add("touchRotate",j,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]);var J=f.scrollZoom=new Qn(f,this);this._add("scrollZoom",J,["mousePan"]);var ae=f.keyboard=new lo;this._add("keyboard",ae),this._add("blockableMapEvent",new Qi(f));for(var ee=0,ie=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ee<ie.length;ee+=1){var de=ie[ee];d.interactive&&d[de]&&f[de].enable(d[de])}},Xe.prototype._add=function(d,f,h){this._handlers.push({handlerName:d,handler:f,allowed:h}),this._handlersById[d]=f},Xe.prototype.stop=function(d){if(!this._updatingCamera){for(var f=0,h=this._handlers;f<h.length;f+=1)h[f].handler.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}},Xe.prototype.isActive=function(){for(var d=0,f=this._handlers;d<f.length;d+=1)if(f[d].handler.isActive())return!0;return!1},Xe.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xe.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xe.prototype.isMoving=function(){return!!jo(this._eventsInProgress)||this.isZooming()},Xe.prototype._blockedByActive=function(d,f,h){for(var g in d)if(g!==h&&(!f||f.indexOf(g)<0))return!0;return!1},Xe.prototype.handleWindowEvent=function(d){this.handleEvent(d,d.type+"Window")},Xe.prototype._getMapTouches=function(d){for(var f=[],h=0,g=d;h<g.length;h+=1){var w=g[h];this._el.contains(w.target)&&f.push(w)}return f},Xe.prototype.handleEvent=function(d,f){if("blur"!==d.type){this._updatingCamera=!0;for(var h="renderFrame"===d.type?void 0:d,g={needsRenderFrame:!1},w={},C={},T=d.touches?this._getMapTouches(d.touches):void 0,I=T?Ve.touchPos(this._el,T):Ve.mousePos(this._el,d),M=0,L=this._handlers;M<L.length;M+=1){var $=L[M],q=$.handlerName,j=$.handler,ne=$.allowed;if(j.isEnabled()){var J=void 0;this._blockedByActive(C,ne,q)?j.reset():j[f||d.type]&&(J=j[f||d.type](d,I,T),this.mergeHandlerResult(g,w,J,q,h),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||j.isActive())&&(C[q]=j)}}var ae={};for(var ee in this._previousActiveHandlers)C[ee]||(ae[ee]=h);this._previousActiveHandlers=C,(Object.keys(ae).length||Ts(g))&&(this._changes.push([g,w,ae]),this._triggerRenderFrame()),(Object.keys(C).length||Ts(g))&&this._map._stop(!0),this._updatingCamera=!1;var ie=g.cameraAnimation;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))}else this.stop(!0)},Xe.prototype.mergeHandlerResult=function(d,f,h,g,w){if(h){v.extend(d,h);var C={handlerName:g,originalEvent:h.originalEvent||w};void 0!==h.zoomDelta&&(f.zoom=C),void 0!==h.panDelta&&(f.drag=C),void 0!==h.pitchDelta&&(f.pitch=C),void 0!==h.bearingDelta&&(f.rotate=C)}},Xe.prototype._applyChanges=function(){for(var d={},f={},h={},g=0,w=this._changes;g<w.length;g+=1){var C=w[g],T=C[0],I=C[1],M=C[2];T.panDelta&&(d.panDelta=(d.panDelta||new v.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(d.around=T.around),void 0!==T.pinchAround&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),v.extend(f,I),v.extend(h,M)}this._updateMapTransform(d,f,h),this._changes=[]},Xe.prototype._updateMapTransform=function(d,f,h){var g=this._map,w=g.transform;if(!Ts(d))return this._fireEvents(f,h,!0);var C=d.panDelta,T=d.zoomDelta,I=d.bearingDelta,M=d.pitchDelta,L=d.around,$=d.pinchAround;void 0!==$&&(L=$),g._stop(!0),L=L||g.transform.centerPoint;var q=w.pointLocation(C?L.sub(C):L);I&&(w.bearing+=I),M&&(w.pitch+=M),T&&(w.zoom+=T),w.setLocationAtPoint(q,L),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(f,h,!0)},Xe.prototype._fireEvents=function(d,f,h){var g=this,w=jo(this._eventsInProgress),C=jo(d),T={};for(var I in d)this._eventsInProgress[I]||(T[I+"start"]=d[I].originalEvent),this._eventsInProgress[I]=d[I];for(var M in!w&&C&&this._fireEvent("movestart",C.originalEvent),T)this._fireEvent(M,T[M]);for(var L in C&&this._fireEvent("move",C.originalEvent),d)this._fireEvent(L,d[L].originalEvent);var $,q={};for(var j in this._eventsInProgress){var ne=this._eventsInProgress[j],J=ne.handlerName,ae=ne.originalEvent;this._handlersById[J].isActive()||(delete this._eventsInProgress[j],q[j+"end"]=$=f[J]||ae)}for(var ee in q)this._fireEvent(ee,q[ee]);var ie=jo(this._eventsInProgress);if(h&&(w||C)&&!ie){this._updatingCamera=!0;var de=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),me=function(Ie){return 0!==Ie&&-g._bearingSnap<Ie&&Ie<g._bearingSnap};de?(me(de.bearing||this._map.getBearing())&&(de.bearing=0),this._map.easeTo(de,{originalEvent:$})):(this._map.fire(new v.Event("moveend",{originalEvent:$})),me(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Xe.prototype._fireEvent=function(d,f){this._map.fire(new v.Event(d,f?{originalEvent:f}:{}))},Xe.prototype._requestFrame=function(){var d=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(f){delete d._frameId,d.handleEvent(new Ho("renderFrame",{timeStamp:f})),d._applyChanges()})},Xe.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var It=function(d){function f(h,g){d.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,v.bindAll(["_renderFrameCallback"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.getCenter=function(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)},f.prototype.setCenter=function(h,g){return this.jumpTo({center:h},g)},f.prototype.panBy=function(h,g,w){return h=v.Point.convert(h).mult(-1),this.panTo(this.transform.center,v.extend({offset:h},g),w)},f.prototype.panTo=function(h,g,w){return this.easeTo(v.extend({center:h},g),w)},f.prototype.getZoom=function(){return this.transform.zoom},f.prototype.setZoom=function(h,g){return this.jumpTo({zoom:h},g),this},f.prototype.zoomTo=function(h,g,w){return this.easeTo(v.extend({zoom:h},g),w)},f.prototype.zoomIn=function(h,g){return this.zoomTo(this.getZoom()+1,h,g),this},f.prototype.zoomOut=function(h,g){return this.zoomTo(this.getZoom()-1,h,g),this},f.prototype.getBearing=function(){return this.transform.bearing},f.prototype.setBearing=function(h,g){return this.jumpTo({bearing:h},g),this},f.prototype.getPadding=function(){return this.transform.padding},f.prototype.setPadding=function(h,g){return this.jumpTo({padding:h},g),this},f.prototype.rotateTo=function(h,g,w){return this.easeTo(v.extend({bearing:h},g),w)},f.prototype.resetNorth=function(h,g){return this.rotateTo(0,v.extend({duration:1e3},h),g),this},f.prototype.resetNorthPitch=function(h,g){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},h),g),this},f.prototype.snapToNorth=function(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this},f.prototype.getPitch=function(){return this.transform.pitch},f.prototype.setPitch=function(h,g){return this.jumpTo({pitch:h},g),this},f.prototype.cameraForBounds=function(h,g){h=v.LngLatBounds.convert(h);var w=g&&g.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),w,g)},f.prototype._cameraForBoxAndBearing=function(h,g,w,C){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(C=v.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding){var I=C.padding;C.padding={top:I,bottom:I,right:I,left:I}}C.padding=v.extend(T,C.padding);var M=this.transform,L=M.padding,$=M.project(v.LngLat.convert(h)),q=M.project(v.LngLat.convert(g)),j=$.rotate(-w*Math.PI/180),ne=q.rotate(-w*Math.PI/180),J=new v.Point(Math.max(j.x,ne.x),Math.max(j.y,ne.y)),ae=new v.Point(Math.min(j.x,ne.x),Math.min(j.y,ne.y)),ee=J.sub(ae),ie=(M.width-(L.left+L.right+C.padding.left+C.padding.right))/ee.x,de=(M.height-(L.top+L.bottom+C.padding.top+C.padding.bottom))/ee.y;if(!(de<0||ie<0)){var me=Math.min(M.scaleZoom(M.scale*Math.min(ie,de)),C.maxZoom),Ie="number"==typeof C.offset.x?new v.Point(C.offset.x,C.offset.y):v.Point.convert(C.offset),Ee=new v.Point((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(w*Math.PI/180),ke=Ie.add(Ee).mult(M.scale/M.zoomScale(me));return{center:M.unproject($.add(q).div(2).sub(ke)),zoom:me,bearing:w}}v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},f.prototype.fitBounds=function(h,g,w){return this._fitInternal(this.cameraForBounds(h,g),g,w)},f.prototype.fitScreenCoordinates=function(h,g,w,C,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(v.Point.convert(h)),this.transform.pointLocation(v.Point.convert(g)),w,C),C,T)},f.prototype._fitInternal=function(h,g,w){return h?(delete(g=v.extend(h,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this},f.prototype.jumpTo=function(h,g){this.stop();var w=this.transform,C=!1,T=!1,I=!1;return"zoom"in h&&w.zoom!==+h.zoom&&(C=!0,w.zoom=+h.zoom),void 0!==h.center&&(w.center=v.LngLat.convert(h.center)),"bearing"in h&&w.bearing!==+h.bearing&&(T=!0,w.bearing=+h.bearing),"pitch"in h&&w.pitch!==+h.pitch&&(I=!0,w.pitch=+h.pitch),null==h.padding||w.isPaddingEqual(h.padding)||(w.padding=h.padding),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g)),C&&this.fire(new v.Event("zoomstart",g)).fire(new v.Event("zoom",g)).fire(new v.Event("zoomend",g)),T&&this.fire(new v.Event("rotatestart",g)).fire(new v.Event("rotate",g)).fire(new v.Event("rotateend",g)),I&&this.fire(new v.Event("pitchstart",g)).fire(new v.Event("pitch",g)).fire(new v.Event("pitchend",g)),this.fire(new v.Event("moveend",g))},f.prototype.easeTo=function(h,g){var w=this;this._stop(!1,h.easeId),(!1===(h=v.extend({offset:[0,0],duration:500,easing:v.ease},h)).animate||!h.essential&&v.browser.prefersReducedMotion)&&(h.duration=0);var C=this.transform,T=this.getZoom(),I=this.getBearing(),M=this.getPitch(),L=this.getPadding(),$="zoom"in h?+h.zoom:T,q="bearing"in h?this._normalizeBearing(h.bearing,I):I,j="pitch"in h?+h.pitch:M,ne="padding"in h?h.padding:C.padding,J=v.Point.convert(h.offset),ae=C.centerPoint.add(J),ee=C.pointLocation(ae),ie=v.LngLat.convert(h.center||ee);this._normalizeCenter(ie);var de,me,Ie=C.project(ee),Ee=C.project(ie).sub(Ie),ke=C.zoomScale($-T);h.around&&(de=v.LngLat.convert(h.around),me=C.locationPoint(de));var Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$!==T,this._rotating=this._rotating||I!==q,this._pitching=this._pitching||j!==M,this._padding=!C.isPaddingEqual(ne),this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,Ne),this._ease(function(Ze){if(w._zooming&&(C.zoom=v.number(T,$,Ze)),w._rotating&&(C.bearing=v.number(I,q,Ze)),w._pitching&&(C.pitch=v.number(M,j,Ze)),w._padding&&(C.interpolatePadding(L,ne,Ze),ae=C.centerPoint.add(J)),de)C.setLocationAtPoint(de,me);else{var He=C.zoomScale(C.zoom-T),rt=$>T?Math.min(2,ke):Math.max(.5,ke),gt=Math.pow(rt,1-Ze),bt=C.unproject(Ie.add(Ee.mult(Ze*gt)).mult(He));C.setLocationAtPoint(C.renderWorldCopies?bt.wrap():bt,ae)}w._fireMoveEvents(g)},function(Ze){w._afterEase(g,Ze)},h),this},f.prototype._prepareEase=function(h,g,w){void 0===w&&(w={}),this._moving=!0,g||w.moving||this.fire(new v.Event("movestart",h)),this._zooming&&!w.zooming&&this.fire(new v.Event("zoomstart",h)),this._rotating&&!w.rotating&&this.fire(new v.Event("rotatestart",h)),this._pitching&&!w.pitching&&this.fire(new v.Event("pitchstart",h))},f.prototype._fireMoveEvents=function(h){this.fire(new v.Event("move",h)),this._zooming&&this.fire(new v.Event("zoom",h)),this._rotating&&this.fire(new v.Event("rotate",h)),this._pitching&&this.fire(new v.Event("pitch",h))},f.prototype._afterEase=function(h,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var w=this._zooming,C=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new v.Event("zoomend",h)),C&&this.fire(new v.Event("rotateend",h)),T&&this.fire(new v.Event("pitchend",h)),this.fire(new v.Event("moveend",h))}},f.prototype.flyTo=function(h,g){var w=this;if(!h.essential&&v.browser.prefersReducedMotion){var C=v.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(C,g)}this.stop(),h=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},h);var T=this.transform,I=this.getZoom(),M=this.getBearing(),L=this.getPitch(),$=this.getPadding(),q="zoom"in h?v.clamp(+h.zoom,T.minZoom,T.maxZoom):I,j="bearing"in h?this._normalizeBearing(h.bearing,M):M,ne="pitch"in h?+h.pitch:L,J="padding"in h?h.padding:T.padding,ae=T.zoomScale(q-I),ee=v.Point.convert(h.offset),ie=T.centerPoint.add(ee),de=T.pointLocation(ie),me=v.LngLat.convert(h.center||de);this._normalizeCenter(me);var Ie=T.project(de),Ee=T.project(me).sub(Ie),ke=h.curve,Ne=Math.max(T.width,T.height),Ze=Ne/ae,He=Ee.mag();if("minZoom"in h){var rt=v.clamp(Math.min(h.minZoom,I,q),T.minZoom,T.maxZoom),gt=Ne/T.zoomScale(rt-I);ke=Math.sqrt(gt/He*2)}var bt=ke*ke;function vt(Ot){var Tt=(Ze*Ze-Ne*Ne+(Ot?-1:1)*bt*bt*He*He)/(2*(Ot?Ze:Ne)*bt*He);return Math.log(Math.sqrt(Tt*Tt+1)-Tt)}function ln(Ot){return(Math.exp(Ot)-Math.exp(-Ot))/2}function st(Ot){return(Math.exp(Ot)+Math.exp(-Ot))/2}var Ht=vt(0),on=function(Ot){return st(Ht)/st(Ht+ke*Ot)},Ye=function(Ot){return Ne*((st(Ht)*(ln(Tt=Ht+ke*Ot)/st(Tt))-ln(Ht))/bt)/He;var Tt},Pt=(vt(1)-Ht)/ke;if(Math.abs(He)<1e-6||!isFinite(Pt)){if(Math.abs(Ne-Ze)<1e-6)return this.easeTo(h,g);var Ft=Ze<Ne?-1:1;Pt=Math.abs(Math.log(Ze/Ne))/ke,Ye=function(){return 0},on=function(Ot){return Math.exp(Ft*ke*Ot)}}return h.duration="duration"in h?+h.duration:1e3*Pt/("screenSpeed"in h?+h.screenSpeed/ke:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=M!==j,this._pitching=ne!==L,this._padding=!T.isPaddingEqual(J),this._prepareEase(g,!1),this._ease(function(Ot){var Tt=Ot*Pt,Jn=1/on(Tt);T.zoom=1===Ot?q:I+T.scaleZoom(Jn),w._rotating&&(T.bearing=v.number(M,j,Ot)),w._pitching&&(T.pitch=v.number(L,ne,Ot)),w._padding&&(T.interpolatePadding($,J,Ot),ie=T.centerPoint.add(ee));var Br=1===Ot?me:T.unproject(Ie.add(Ee.mult(Ye(Tt))).mult(Jn));T.setLocationAtPoint(T.renderWorldCopies?Br.wrap():Br,ie),w._fireMoveEvents(g)},function(){return w._afterEase(g)},h),this},f.prototype.isEasing=function(){return!!this._easeFrameId},f.prototype.stop=function(){return this._stop()},f.prototype._stop=function(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,g)}if(!h){var C=this.handlers;C&&C.stop(!1)}return this},f.prototype._ease=function(h,g,w){!1===w.animate||0===w.duration?(h(1),g()):(this._easeStart=v.browser.now(),this._easeOptions=w,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},f.prototype._renderFrameCallback=function(){var h=Math.min((v.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},f.prototype._normalizeBearing=function(h,g){h=v.wrap(h,-180,180);var w=Math.abs(h-g);return Math.abs(h-360-g)<w&&(h-=360),Math.abs(h+360-g)<w&&(h+=360),h},f.prototype._normalizeCenter=function(h){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var w=h.lng-g.center.lng;h.lng+=w>180?-360:w<-180?360:0}},f}(v.Evented),li=function(d){void 0===d&&(d={}),this.options=d,v.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};li.prototype.getDefaultPosition=function(){return"bottom-right"},li.prototype.onAdd=function(d){var f=this.options&&this.options.compact;return this._map=d,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ve.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ve.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===f&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},li.prototype.onRemove=function(){Ve.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},li.prototype._setElementTitle=function(d,f){var h=this._map._getUIString("AttributionControl."+f);d.title=h,d.setAttribute("aria-label",h)},li.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},li.prototype._updateEditLink=function(){var d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));var f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||v.config.ACCESS_TOKEN}];if(d){var h=f.reduce(function(g,w,C){return w.value&&(g+=w.key+"="+w.value+(C<f.length-1?"&":"")),g},"?");d.href=v.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}},li.prototype._updateData=function(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())},li.prototype._updateAttributions=function(){if(this._map.style){var d=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=d.concat(this.options.customAttribution.map(function(I){return"string"!=typeof I?"":I})):"string"==typeof this.options.customAttribution&&d.push(this.options.customAttribution)),this._map.style.stylesheet){var f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}var h=this._map.style.sourceCaches;for(var g in h){var w=h[g];if(w.used){var C=w.getSource();C.attribution&&d.indexOf(C.attribution)<0&&d.push(C.attribution)}}d.sort(function(I,M){return I.length-M.length});var T=(d=d.filter(function(I,M){for(var L=M+1;L<d.length;L++)if(d[L].indexOf(I)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,d.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},li.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var kt=function(){v.bindAll(["_updateLogo"],this),v.bindAll(["_updateCompact"],this)};kt.prototype.onAdd=function(d){this._map=d,this._container=Ve.create("div","maplibregl-ctrl mapboxgl-ctrl");var f=Ve.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},kt.prototype.onRemove=function(){Ve.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},kt.prototype.getDefaultPosition=function(){return"bottom-left"},kt.prototype._updateLogo=function(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},kt.prototype._logoRequired=function(){if(this._map.style){var d=this._map.style.sourceCaches;for(var f in d)if(d[f].getSource().mapbox_logo)return!0;return!1}},kt.prototype._updateCompact=function(){var d=this._container.children;if(d.length){var f=d[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("maplibregl-compact","mapboxgl-compact"):f.classList.remove("maplibregl-compact","mapboxgl-compact")}};var ta=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ta.prototype.add=function(d){var f=++this._id;return this._queue.push({callback:d,id:f,cancelled:!1}),f},ta.prototype.remove=function(d){for(var f=this._currentlyRunning,h=0,g=f?this._queue.concat(f):this._queue;h<g.length;h+=1){var w=g[h];if(w.id===d)return void(w.cancelled=!0)}},ta.prototype.run=function(d){void 0===d&&(d=0);var f=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,g=f;h<g.length;h+=1){var w=g[h];if(!w.cancelled&&(w.callback(d),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ta.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ci={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},wi=v.window.HTMLImageElement,hf=v.window.HTMLElement,rs=v.window.ImageBitmap,zt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},_n=function(d){function f(g){var w=this;if(null!=(g=v.extend({},zt,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var C=new qn(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(d.call(this,C,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new ta,this._controls=[],this._mapId=v.uniqueId(),this._locale=v.extend({},ci,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new v.RequestManager(g.transformRequest,g.accessToken),"string"==typeof g.container){if(this._container=v.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof hf))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),v.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return w._update(!1)}),this.on("moveend",function(){return w._update(!1)}),this.on("zoom",function(){return w._update(!0)}),void 0!==v.window&&(v.window.addEventListener("online",this._onWindowOnline,!1),v.window.addEventListener("resize",this._onWindowResize,!1),v.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Xe(this,g),this._hash=g.hash&&new Uo("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,v.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new li({customAttribution:g.customAttribution})),this.addControl(new kt,g.logoPosition),this.on("style.load",function(){w.transform.unmodified&&w.jumpTo(w.style.stylesheet)}),this.on("data",function(T){w._update("style"===T.dataType),w.fire(new v.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){w.fire(new v.Event(T.dataType+"dataloading",T))})}d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return f.prototype._getMapId=function(){return this._mapId},f.prototype.addControl=function(g,w){if(void 0===w&&(w=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var C=g.onAdd(this);this._controls.push(g);var T=this._controlPositions[w];return-1!==w.indexOf("bottom")?T.insertBefore(C,T.firstChild):T.appendChild(C),this},f.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var w=this._controls.indexOf(g);return w>-1&&this._controls.splice(w,1),g.onRemove(this),this},f.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},f.prototype.resize=function(g){var w=this._containerDimensions(),C=w[0],T=w[1];this._resizeCanvas(C,T),this.transform.resize(C,T),this.painter.resize(C,T);var I=!this._moving;return I&&(this.stop(),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g))),this.fire(new v.Event("resize",g)),I&&this.fire(new v.Event("moveend",g)),this},f.prototype.getBounds=function(){return this.transform.getBounds()},f.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},f.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(v.LngLatBounds.convert(g)),this._update()},f.prototype.setMinZoom=function(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},f.prototype.getMinZoom=function(){return this.transform.minZoom},f.prototype.setMaxZoom=function(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},f.prototype.getMaxZoom=function(){return this.transform.maxZoom},f.prototype.setMinPitch=function(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},f.prototype.getMinPitch=function(){return this.transform.minPitch},f.prototype.setMaxPitch=function(g){if((g=g??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},f.prototype.getMaxPitch=function(){return this.transform.maxPitch},f.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},f.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},f.prototype.project=function(g){return this.transform.locationPoint(v.LngLat.convert(g))},f.prototype.unproject=function(g){return this.transform.pointLocation(v.Point.convert(g))},f.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},f.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},f.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},f.prototype._createDelegatedListener=function(g,w,C){var T,I=this;if("mouseenter"===g||"mouseover"===g){var M=!1;return{layer:w,listener:C,delegates:{mousemove:function($){var q=I.getLayer(w)?I.queryRenderedFeatures($.point,{layers:[w]}):[];q.length?M||(M=!0,C.call(I,new Pi(g,I,$.originalEvent,{features:q}))):M=!1},mouseout:function(){M=!1}}}}if("mouseleave"===g||"mouseout"===g){var L=!1;return{layer:w,listener:C,delegates:{mousemove:function($){(I.getLayer(w)?I.queryRenderedFeatures($.point,{layers:[w]}):[]).length?L=!0:L&&(L=!1,C.call(I,new Pi(g,I,$.originalEvent)))},mouseout:function($){L&&(L=!1,C.call(I,new Pi(g,I,$.originalEvent)))}}}}return{layer:w,listener:C,delegates:(T={},T[g]=function($){var q=I.getLayer(w)?I.queryRenderedFeatures($.point,{layers:[w]}):[];q.length&&($.features=q,C.call(I,$),delete $.features)},T)}},f.prototype.on=function(g,w,C){if(void 0===C)return d.prototype.on.call(this,g,w);var T=this._createDelegatedListener(g,w,C);for(var I in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(T),T.delegates)this.on(I,T.delegates[I]);return this},f.prototype.once=function(g,w,C){if(void 0===C)return d.prototype.once.call(this,g,w);var T=this._createDelegatedListener(g,w,C);for(var I in T.delegates)this.once(I,T.delegates[I]);return this},f.prototype.off=function(g,w,C){var T=this;return void 0===C?d.prototype.off.call(this,g,w):(this._delegatedListeners&&this._delegatedListeners[g]&&function(I){for(var M=I[g],L=0;L<M.length;L++){var $=M[L];if($.layer===w&&$.listener===C){for(var q in $.delegates)T.off(q,$.delegates[q]);return M.splice(L,1),T}}}(this._delegatedListeners),this)},f.prototype.queryRenderedFeatures=function(g,w){if(!this.style)return[];var C;if(void 0!==w||void 0===g||g instanceof v.Point||Array.isArray(g)||(w=g,g=void 0),w=w||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof v.Point||"number"==typeof g[0])C=[v.Point.convert(g)];else{var T=v.Point.convert(g[0]),I=v.Point.convert(g[1]);C=[T,new v.Point(I.x,T.y),I,new v.Point(T.x,I.y),T]}return this.style.queryRenderedFeatures(C,w,this.transform)},f.prototype.querySourceFeatures=function(g,w){return this.style.querySourceFeatures(g,w)},f.prototype.setStyle=function(g,w){return!1!==(w=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},w)).diff&&w.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,w),this):(this._localIdeographFontFamily=w.localIdeographFontFamily,this._updateStyle(g,w))},f.prototype.setTransformRequest=function(g){return this._requestManager.setTransformRequest(g),this},f.prototype._getUIString=function(g){var w=this._locale[g];if(null==w)throw new Error("Missing UI string '"+g+"'");return w},f.prototype._updateStyle=function(g,w){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new ql(this,w||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},f.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ql(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},f.prototype._diffStyle=function(g,w){var C=this;if("string"==typeof g){var T=this._requestManager.normalizeStyleURL(g),I=this._requestManager.transformRequest(T,v.ResourceType.Style);v.getJSON(I,function(M,L){M?C.fire(new v.ErrorEvent(M)):L&&C._updateDiff(L,w)})}else"object"==typeof g&&this._updateDiff(g,w)},f.prototype._updateDiff=function(g,w){try{this.style.setState(g)&&this._update(!0)}catch(C){v.warnOnce("Unable to perform style diff: "+(C.message||C.error||C)+".  Rebuilding the style from scratch."),this._updateStyle(g,w)}},f.prototype.getStyle=function(){if(this.style)return this.style.serialize()},f.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")},f.prototype.addSource=function(g,w){return this._lazyInitEmptyStyle(),this.style.addSource(g,w),this._update(!0)},f.prototype.isSourceLoaded=function(g){var w=this.style&&this.style.sourceCaches[g];if(void 0!==w)return w.loaded();this.fire(new v.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},f.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var w in g){var C=g[w]._tiles;for(var T in C){var I=C[T];if("loaded"!==I.state&&"errored"!==I.state)return!1}}return!0},f.prototype.addSourceType=function(g,w,C){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,w,C)},f.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},f.prototype.getSource=function(g){return this.style.getSource(g)},f.prototype.addImage=function(g,w,C){void 0===C&&(C={});var T=C.pixelRatio;void 0===T&&(T=1);var I=C.sdf;void 0===I&&(I=!1);var M=C.stretchX,L=C.stretchY,$=C.content;if(this._lazyInitEmptyStyle(),w instanceof wi||rs&&w instanceof rs){var q=v.browser.getImageData(w);this.style.addImage(g,{data:new v.RGBAImage({width:q.width,height:q.height},q.data),pixelRatio:T,stretchX:M,stretchY:L,content:$,sdf:I,version:0})}else{if(void 0===w.width||void 0===w.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var j=w;this.style.addImage(g,{data:new v.RGBAImage({width:w.width,height:w.height},new Uint8Array(w.data)),pixelRatio:T,stretchX:M,stretchY:L,content:$,sdf:I,version:0,userImage:j}),j.onAdd&&j.onAdd(this,g)}},f.prototype.updateImage=function(g,w){var C=this.style.getImage(g);if(!C)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=w instanceof wi||rs&&w instanceof rs?v.browser.getImageData(w):w,I=T.width,M=T.height,L=T.data;return void 0===I||void 0===M?this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):I!==C.data.width||M!==C.data.height?this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(C.data.replace(L,!(w instanceof wi||rs&&w instanceof rs)),void this.style.updateImage(g,C))},f.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)},f.prototype.removeImage=function(g){this.style.removeImage(g)},f.prototype.loadImage=function(g,w){v.getImage(this._requestManager.transformRequest(g,v.ResourceType.Image),w)},f.prototype.listImages=function(){return this.style.listImages()},f.prototype.addLayer=function(g,w){return this._lazyInitEmptyStyle(),this.style.addLayer(g,w),this._update(!0)},f.prototype.moveLayer=function(g,w){return this.style.moveLayer(g,w),this._update(!0)},f.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},f.prototype.getLayer=function(g){return this.style.getLayer(g)},f.prototype.setLayerZoomRange=function(g,w,C){return this.style.setLayerZoomRange(g,w,C),this._update(!0)},f.prototype.setFilter=function(g,w,C){return void 0===C&&(C={}),this.style.setFilter(g,w,C),this._update(!0)},f.prototype.getFilter=function(g){return this.style.getFilter(g)},f.prototype.setPaintProperty=function(g,w,C,T){return void 0===T&&(T={}),this.style.setPaintProperty(g,w,C,T),this._update(!0)},f.prototype.getPaintProperty=function(g,w){return this.style.getPaintProperty(g,w)},f.prototype.setLayoutProperty=function(g,w,C,T){return void 0===T&&(T={}),this.style.setLayoutProperty(g,w,C,T),this._update(!0)},f.prototype.getLayoutProperty=function(g,w){return this.style.getLayoutProperty(g,w)},f.prototype.setLight=function(g,w){return void 0===w&&(w={}),this._lazyInitEmptyStyle(),this.style.setLight(g,w),this._update(!0)},f.prototype.getLight=function(){return this.style.getLight()},f.prototype.setFeatureState=function(g,w){return this.style.setFeatureState(g,w),this._update()},f.prototype.removeFeatureState=function(g,w){return this.style.removeFeatureState(g,w),this._update()},f.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},f.prototype.getContainer=function(){return this._container},f.prototype.getCanvasContainer=function(){return this._canvasContainer},f.prototype.getCanvas=function(){return this._canvas},f.prototype._containerDimensions=function(){var g=0,w=0;return this._container&&(g=this._container.clientWidth||400,w=this._container.clientHeight||300),[g,w]},f.prototype._setupContainer=function(){var g=this._container;g.classList.add("maplibregl-map","mapboxgl-map");var w=this._canvasContainer=Ve.create("div","maplibregl-canvas-container mapboxgl-canvas-container",g);this._interactive&&w.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=Ve.create("canvas","maplibregl-canvas mapboxgl-canvas",w),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var C=this._containerDimensions();this._resizeCanvas(C[0],C[1]);var T=this._controlContainer=Ve.create("div","maplibregl-control-container mapboxgl-control-container",g),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(M){I[M]=Ve.create("div","maplibregl-ctrl-"+M+" mapboxgl-ctrl-"+M,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},f.prototype._resizeCanvas=function(g,w){var C=v.browser.devicePixelRatio||1;this._canvas.width=C*g,this._canvas.height=C*w,this._canvas.style.width=g+"px",this._canvas.style.height=w+"px"},f.prototype._setupPainter=function(){var g=v.extend({},zo.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),w=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);w?(this.painter=new sr(w,this.transform),v.webpSupported.testSupport(w)):this.fire(new v.ErrorEvent(new Error("Failed to initialize WebGL")))},f.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:g}))},f.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:g}))},f.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},f.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},f.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},f.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},f.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},f.prototype._render=function(g){var w,C=this,T=0,I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(w=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,w),T=v.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,$=v.browser.now();this.style.zoomHistory.update(L,$);var q=new v.EvaluationParameters(L,{now:$,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),j=q.crossFadingFactor();1===j&&j===this._crossFadingFactor||(M=!0,this._crossFadingFactor=j),this.style.update(q)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ne=v.browser.now()-T;I.endQueryEXT(I.TIME_ELAPSED_EXT,w),setTimeout(function(){var ee=I.getQueryObjectEXT(w,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(w),C.fire(new v.Event("gpu-timing-frame",{cpuTime:ne,gpuTime:ee}))},50)}if(this.listens("gpu-timing-layer")){var J=this.painter.collectGpuTimers();setTimeout(function(){var ee=C.painter.queryGpuTimers(J);C.fire(new v.Event("gpu-timing-layer",{layerTimes:ee}))},50)}var ae=this._sourcesDirty||this._styleDirty||this._placementDirty;return ae||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.Event("idle")),!this._loaded||this._fullyLoaded||ae||(this._fullyLoaded=!0),this}},f.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,w=this._controls;g<w.length;g+=1)w[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==v.window&&(v.window.removeEventListener("resize",this._onWindowResize,!1),v.window.removeEventListener("orientationchange",this._onWindowResize,!1),v.window.removeEventListener("online",this._onWindowOnline,!1));var C=this.painter.context.gl.getExtension("WEBGL_lose_context");C&&C.loseContext(),uo(this._canvasContainer),uo(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new v.Event("remove"))},f.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=v.browser.frame(function(w){g._frame=null,g._render(w)}))},f.prototype._onWindowOnline=function(){this._update()},f.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(g){this._vertices=g,this._update()},f.prototype._setCacheLimits=function(g,w){v.setCacheLimits(g,w)},h.version.get=function(){return v.version},Object.defineProperties(f.prototype,h),f}(It);function uo(d){d.parentNode&&d.parentNode.removeChild(d)}var zu={showCompass:!0,showZoom:!0,visualizePitch:!1},Ji=function(d){var f=this;this.options=v.extend({},zu,d),this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(h){return f._map.zoomIn({},{originalEvent:h})}),Ve.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(h){return f._map.zoomOut({},{originalEvent:h})}),Ve.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(h){f.options.visualizePitch?f._map.resetNorthPitch({},{originalEvent:h}):f._map.resetNorth({},{originalEvent:h})}),this._compassIcon=Ve.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Ji.prototype._updateZoomButtons=function(){var d=this._map.getZoom(),f=d===this._map.getMaxZoom(),h=d===this._map.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},Ji.prototype._rotateCompassArrow=function(){var d=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=d},Ji.prototype.onAdd=function(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zi(this._map,this._compass,this.options.visualizePitch)),this._container},Ji.prototype.onRemove=function(){Ve.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Ji.prototype._createButton=function(d,f){var h=Ve.create("button",d,this._container);return h.type="button",h.addEventListener("click",f),h},Ji.prototype._setButtonTitle=function(d,f){var h=this._map._getUIString("NavigationControl."+f);d.title=h,d.setAttribute("aria-label",h)};var zi=function(d,f,h){void 0===h&&(h=!1),this._clickTolerance=10,this.element=f,this.mouseRotate=new Gr({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,h&&(this.mousePitch=new qe({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Ve.addEventListener(f,"mousedown",this.mousedown),Ve.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),Ve.addEventListener(f,"touchmove",this.touchmove),Ve.addEventListener(f,"touchend",this.touchend),Ve.addEventListener(f,"touchcancel",this.reset)};function is(d,f,h){if(d=new v.LngLat(d.lng,d.lat),f){var g=new v.LngLat(d.lng-360,d.lat),w=new v.LngLat(d.lng+360,d.lat),C=h.locationPoint(d).distSqr(f);h.locationPoint(g).distSqr(f)<C?d=g:h.locationPoint(w).distSqr(f)<C&&(d=w)}for(;Math.abs(d.lng-h.center.lng)>180;){var T=h.locationPoint(d);if(T.x>=0&&T.y>=0&&T.x<=h.width&&T.y<=h.height)break;d.lng>h.center.lng?d.lng-=360:d.lng+=360}return d}zi.prototype.down=function(d,f){this.mouseRotate.mousedown(d,f),this.mousePitch&&this.mousePitch.mousedown(d,f),Ve.disableDrag()},zi.prototype.move=function(d,f){var h=this.map,g=this.mouseRotate.mousemoveWindow(d,f);if(g&&g.bearingDelta&&h.setBearing(h.getBearing()+g.bearingDelta),this.mousePitch){var w=this.mousePitch.mousemoveWindow(d,f);w&&w.pitchDelta&&h.setPitch(h.getPitch()+w.pitchDelta)}},zi.prototype.off=function(){var d=this.element;Ve.removeEventListener(d,"mousedown",this.mousedown),Ve.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),Ve.removeEventListener(d,"touchmove",this.touchmove),Ve.removeEventListener(d,"touchend",this.touchend),Ve.removeEventListener(d,"touchcancel",this.reset),this.offTemp()},zi.prototype.offTemp=function(){Ve.enableDrag(),Ve.removeEventListener(v.window,"mousemove",this.mousemove),Ve.removeEventListener(v.window,"mouseup",this.mouseup)},zi.prototype.mousedown=function(d){this.down(v.extend({},d,{ctrlKey:!0,preventDefault:function(){return d.preventDefault()}}),Ve.mousePos(this.element,d)),Ve.addEventListener(v.window,"mousemove",this.mousemove),Ve.addEventListener(v.window,"mouseup",this.mouseup)},zi.prototype.mousemove=function(d){this.move(d,Ve.mousePos(this.element,d))},zi.prototype.mouseup=function(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()},zi.prototype.touchstart=function(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=Ve.touchPos(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return d.preventDefault()}},this._startPos))},zi.prototype.touchmove=function(d){1!==d.targetTouches.length?this.reset():(this._lastPos=Ve.touchPos(this.element,d.targetTouches)[0],this.move({preventDefault:function(){return d.preventDefault()}},this._lastPos))},zi.prototype.touchend=function(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},zi.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ql(d,f,h){var g=d.classList;for(var w in os)g.remove("maplibregl-"+h+"-anchor-"+w,"mapboxgl-"+h+"-anchor-"+w);g.add("maplibregl-"+h+"-anchor-"+f,"mapboxgl-"+h+"-anchor-"+f)}var Ud,Ss=function(d){function f(h,g){if(d.call(this),(h instanceof v.window.HTMLElement||g)&&(h=v.extend({element:h},g)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&"auto"!==h.pitchAlignment?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=v.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ve.create("div"),this._element.setAttribute("aria-label","Map marker");var w=Ve.createNS("http://www.w3.org/2000/svg","svg");w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height","41px"),w.setAttributeNS(null,"width","27px"),w.setAttributeNS(null,"viewBox","0 0 27 41");var C=Ve.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"stroke","none"),C.setAttributeNS(null,"stroke-width","1"),C.setAttributeNS(null,"fill","none"),C.setAttributeNS(null,"fill-rule","evenodd");var T=Ve.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var I=Ve.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");for(var M=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];M<L.length;M+=1){var $=L[M],q=Ve.createNS("http://www.w3.org/2000/svg","ellipse");q.setAttributeNS(null,"opacity","0.04"),q.setAttributeNS(null,"cx","10.5"),q.setAttributeNS(null,"cy","5.80029008"),q.setAttributeNS(null,"rx",$.rx),q.setAttributeNS(null,"ry",$.ry),I.appendChild(q)}var j=Ve.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);var ne=Ve.createNS("http://www.w3.org/2000/svg","path");ne.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(ne);var J=Ve.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"fill","#000000");var ae=Ve.createNS("http://www.w3.org/2000/svg","path");ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),J.appendChild(ae);var ee=Ve.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ee.setAttributeNS(null,"fill","#FFFFFF");var ie=Ve.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(8.0, 8.0)");var de=Ve.createNS("http://www.w3.org/2000/svg","circle");de.setAttributeNS(null,"fill","#000000"),de.setAttributeNS(null,"opacity","0.25"),de.setAttributeNS(null,"cx","5.5"),de.setAttributeNS(null,"cy","5.5"),de.setAttributeNS(null,"r","5.4999962");var me=Ve.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#FFFFFF"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962"),ie.appendChild(de),ie.appendChild(me),T.appendChild(I),T.appendChild(j),T.appendChild(J),T.appendChild(ee),T.appendChild(ie),w.appendChild(T),w.setAttributeNS(null,"height",41*this._scale+"px"),w.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(w),this._offset=v.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ie){Ie.preventDefault()}),this._element.addEventListener("mousedown",function(Ie){Ie.preventDefault()}),Ql(this._element,this._anchor,"marker"),this._popup=null}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},f.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Ve.remove(this._element),this._popup&&this._popup.remove(),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},f.prototype.getElement=function(){return this._element},f.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},f.prototype._onKeyPress=function(h){var g=h.code,w=h.charCode||h.keyCode;"Space"!==g&&"Enter"!==g&&32!==w&&13!==w||this.togglePopup()},f.prototype._onMapClick=function(h){var g=h.originalEvent.target,w=this._element;this._popup&&(g===w||w.contains(g))&&this.togglePopup()},f.prototype.getPopup=function(){return this._popup},f.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},f.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=is(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var w="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?w="rotateX(0deg)":"map"===this._pitchAlignment&&(w="rotateX("+this._map.getPitch()+"deg)"),h&&"moveend"!==h.type||(this._pos=this._pos.round()),Ve.setTransform(this._element,os[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+w+" "+g)}},f.prototype.getOffset=function(){return this._offset},f.prototype.setOffset=function(h){return this._offset=v.Point.convert(h),this._update(),this},f.prototype._onMove=function(h){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))},f.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"},f.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},f.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},f.prototype.isDraggable=function(){return this._draggable},f.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},f.prototype.getRotation=function(){return this._rotation},f.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},f.prototype.getRotationAlignment=function(){return this._rotationAlignment},f.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&"auto"!==h?h:this._rotationAlignment,this._update(),this},f.prototype.getPitchAlignment=function(){return this._pitchAlignment},f}(v.Evented),ff={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},pf=0,Jl=!1,Uu=function(d){function f(h){d.call(this),this.options=v.extend({},ff,h),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.onAdd=function(h){var g;return this._map=h,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,void 0!==Ud?g(Ud):void 0!==v.window.navigator.permissions?v.window.navigator.permissions.query({name:"geolocation"}).then(function(w){g(Ud="denied"!==w.state)}):g(Ud=!!v.window.navigator.geolocation),this._container},f.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Ve.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,pf=0,Jl=!1},f.prototype._isOutOfMapMaxBounds=function(h){var g=this._map.getMaxBounds(),w=h.coords;return g&&(w.longitude<g.getWest()||w.longitude>g.getEast()||w.latitude<g.getSouth()||w.latitude>g.getNorth())},f.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},f.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("geolocate",h)),this._finish()}},f.prototype._updateCamera=function(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude),w=h.coords.accuracy,C=this._map.getBearing(),T=v.extend({bearing:C},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(w),T,{geolocateSource:!0})},f.prototype._updateMarker=function(h){if(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},f.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,g=this._map.unproject([0,h]),w=this._map.unproject([1,h]),C=g.distanceTo(w),T=Math.ceil(2*this._accuracy/C);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},f.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},f.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&Jl)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("error",h)),this._finish()}},f.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},f.prototype._setupUI=function(h){var g=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=Ve.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),Ve.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===h){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var w=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}else{var C=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ve.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ss(this._dotElement),this._circleElement=Ve.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ss({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==g._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),g.fire(new v.Event("trackuserlocationend")))})},f.prototype.trigger=function(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":pf--,Jl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++pf>1?(h={maximumAge:6e5,timeout:0},Jl=!0):(h=this.options.positionOptions,Jl=!1),this._geolocationWatchID=v.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else v.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},f.prototype._clearWatch=function(){v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},f}(v.Evented),Ag={maxWidth:100,unit:"metric"},zs=function(d){this.options=v.extend({},Ag,d),v.bindAll(["_onMove","setUnit"],this)};function Vp(d,f,h){var g=h&&h.maxWidth||100,w=d._container.clientHeight/2,C=d.unproject([0,w]),T=d.unproject([g,w]),I=C.distanceTo(T);if(h&&"imperial"===h.unit){var M=3.2808*I;M>5280?ju(f,g,M/5280,d._getUIString("ScaleControl.Miles")):ju(f,g,M,d._getUIString("ScaleControl.Feet"))}else h&&"nautical"===h.unit?ju(f,g,I/1852,d._getUIString("ScaleControl.NauticalMiles")):I>=1e3?ju(f,g,I/1e3,d._getUIString("ScaleControl.Kilometers")):ju(f,g,I,d._getUIString("ScaleControl.Meters"))}function ju(d,f,h,g){var w,C,T,M,L,I=(w=h,(C=Math.pow(10,(""+Math.floor(w)).length-1))*(T=(T=w/C)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(M=T,L=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10)),Math.round(M*L)/L)));d.style.width=f*(I/h)+"px",d.innerHTML=I+"&nbsp;"+g}zs.prototype.getDefaultPosition=function(){return"bottom-left"},zs.prototype._onMove=function(){Vp(this._map,this._container,this.options)},zs.prototype.onAdd=function(d){return this._map=d,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},zs.prototype.onRemove=function(){Ve.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},zs.prototype.setUnit=function(d){this.options.unit=d,Vp(this._map,this._container,this.options)};var Us=function(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof v.window.HTMLElement?this._container=d.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),v.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in v.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in v.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in v.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in v.window.document&&(this._fullscreenchange="MSFullscreenChange")};Us.prototype.onAdd=function(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",v.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Us.prototype.onRemove=function(){Ve.remove(this._controlContainer),this._map=null,v.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Us.prototype._checkFullscreenSupport=function(){return!!(v.window.document.fullscreenEnabled||v.window.document.mozFullScreenEnabled||v.window.document.msFullscreenEnabled||v.window.document.webkitFullscreenEnabled)},Us.prototype._setupUI=function(){var d=this._fullscreenButton=Ve.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);Ve.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),v.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Us.prototype._updateTitle=function(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d},Us.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Us.prototype._isFullscreen=function(){return this._fullscreen},Us.prototype._changeIcon=function(){(v.window.document.fullscreenElement||v.window.document.mozFullScreenElement||v.window.document.webkitFullscreenElement||v.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Us.prototype._onClickFullscreen=function(){this._isFullscreen()?v.window.document.exitFullscreen?v.window.document.exitFullscreen():v.window.document.mozCancelFullScreen?v.window.document.mozCancelFullScreen():v.window.document.msExitFullscreen?v.window.document.msExitFullscreen():v.window.document.webkitCancelFullScreen&&v.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Rg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},zp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),mf=function(d){function f(h){d.call(this),this.options=v.extend(Object.create(Rg),h),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return d&&(f.__proto__=d),(f.prototype=Object.create(d&&d.prototype)).constructor=f,f.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this},f.prototype.isOpen=function(){return!!this._map},f.prototype.remove=function(){return this._content&&Ve.remove(this._content),this._container&&(Ve.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this},f.prototype.getLngLat=function(){return this._lngLat},f.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},f.prototype.getElement=function(){return this._container},f.prototype.setText=function(h){return this.setDOMContent(v.window.document.createTextNode(h))},f.prototype.setHTML=function(h){var g,w=v.window.document.createDocumentFragment(),C=v.window.document.createElement("body");for(C.innerHTML=h;g=C.firstChild;)w.appendChild(g);return this.setDOMContent(w)},f.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},f.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},f.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Ve.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},f.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},f.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},f.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},f.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},f.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=Ve.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},f.prototype._onMouseUp=function(h){this._update(h.point)},f.prototype._onMouseMove=function(h){this._update(h.point)},f.prototype._onDrag=function(h){this._update(h.point)},f.prototype._update=function(h){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Ve.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=Ve.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(q){return g._container.classList.add(q)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=is(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var w=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),C=this.options.anchor,T=function q(j){if(j){if("number"==typeof j){var ne=Math.round(Math.sqrt(.5*Math.pow(j,2)));return{center:new v.Point(0,0),top:new v.Point(0,j),"top-left":new v.Point(ne,ne),"top-right":new v.Point(-ne,ne),bottom:new v.Point(0,-j),"bottom-left":new v.Point(ne,-ne),"bottom-right":new v.Point(-ne,-ne),left:new v.Point(j,0),right:new v.Point(-j,0)}}if(j instanceof v.Point||Array.isArray(j)){var J=v.Point.convert(j);return{center:J,top:J,"top-left":J,"top-right":J,bottom:J,"bottom-left":J,"bottom-right":J,left:J,right:J}}return{center:v.Point.convert(j.center||[0,0]),top:v.Point.convert(j.top||[0,0]),"top-left":v.Point.convert(j["top-left"]||[0,0]),"top-right":v.Point.convert(j["top-right"]||[0,0]),bottom:v.Point.convert(j.bottom||[0,0]),"bottom-left":v.Point.convert(j["bottom-left"]||[0,0]),"bottom-right":v.Point.convert(j["bottom-right"]||[0,0]),left:v.Point.convert(j.left||[0,0]),right:v.Point.convert(j.right||[0,0])}}return q(new v.Point(0,0))}(this.options.offset);if(!C){var I,M=this._container.offsetWidth,L=this._container.offsetHeight;I=w.y+T.bottom.y<L?["top"]:w.y>this._map.transform.height-L?["bottom"]:[],w.x<M/2?I.push("left"):w.x>this._map.transform.width-M/2&&I.push("right"),C=0===I.length?"bottom":I.join("-")}var $=w.add(T[C]).round();Ve.setTransform(this._container,os[C]+" translate("+$.x+"px,"+$.y+"px)"),Ql(this._container,C,"popup")}},f.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(zp);h&&h.focus()}},f.prototype._onClose=function(){this.remove()},f}(v.Evented),Up={version:v.version,supported:zo,setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:_n,NavigationControl:Ji,GeolocateControl:Uu,AttributionControl:li,ScaleControl:zs,FullscreenControl:Us,Popup:mf,Marker:Ss,Style:ql,LngLat:v.LngLat,LngLatBounds:v.LngLatBounds,Point:v.Point,MercatorCoordinate:v.MercatorCoordinate,Evented:v.Evented,config:v.config,prewarm:function(){mt().acquire(Ce)},clearPrewarmedResources:function(){var d=ot;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Ce),ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return v.config.ACCESS_TOKEN},set accessToken(d){v.config.ACCESS_TOKEN=d},get baseApiUrl(){return v.config.API_URL},set baseApiUrl(d){v.config.API_URL=d},get workerCount(){return je.workerCount},set workerCount(d){je.workerCount=d},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){v.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage:function(d){v.clearTileCache(d)},workerUrl:"",addProtocol:function(d,f){v.config.REGISTERED_PROTOCOLS[d]=f},removeProtocol:function(d){delete v.config.REGISTERED_PROTOCOLS[d]}};return Up}),Gi}()},689(jy,Hh,Dd){"use strict";let Gi=null,Td=!1,v=1;const Ve=Symbol("SIGNAL");function yt(e){const t=Gi;return Gi=e,t}const Pl={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function wo(e){if(Td)throw new Error("");if(null===Gi)return;Gi.consumerOnSignalRead(e);const t=Gi.producersTail;if(void 0!==t&&t.producer===e)return;let n;const r=Gi.recomputing;if(r&&(n=void 0!==t?t.nextProducer:Gi.producers,void 0!==n&&n.producer===e))return Gi.producersTail=n,void(n.lastReadVersion=e.version);const i=e.consumersTail;if(void 0!==i&&i.consumer===Gi&&(!r||function ys(e,t){const n=t.producersTail;if(void 0!==n){let r=t.producers;do{if(r===e)return!0;if(r===n)break;r=r.nextProducer}while(void 0!==r)}return!1}(i,Gi)))return;const o=lr(Gi),a={producer:e,consumer:Gi,nextProducer:n,prevConsumer:i,lastReadVersion:e.version,nextConsumer:void 0};Gi.producersTail=a,void 0!==t?t.nextProducer=a:Gi.producers=a,o&&Os(e,a)}function Wi(e){if((!lr(e)||e.dirty)&&(e.dirty||e.lastCleanEpoch!==v)){if(!e.producerMustRecompute(e)&&!Ai(e))return void Ja(e);e.producerRecomputeValue(e),Ja(e)}}function wu(e){if(void 0===e.consumers)return;const t=Td;Td=!0;try{for(let n=e.consumers;void 0!==n;n=n.nextConsumer){const r=n.consumer;r.dirty||$h(r)}}finally{Td=t}}function ki(){return!1!==Gi?.consumerAllowSignalWrites}function $h(e){e.dirty=!0,wu(e),e.consumerMarkedDirty?.(e)}function Ja(e){e.dirty=!1,e.lastCleanEpoch=v}function Yo(e){return e&&function xu(e){e.producersTail=void 0,e.recomputing=!0}(e),yt(e)}function ga(e,t){yt(t),e&&function Rc(e){e.recomputing=!1;const t=e.producersTail;let n=void 0!==t?t.nextProducer:e.producers;if(void 0!==n){if(lr(e))do{n=Ol(n)}while(void 0!==n);void 0!==t?t.nextProducer=void 0:e.producers=void 0}}(e)}function Ai(e){for(let t=e.producers;void 0!==t;t=t.nextProducer){const n=t.producer,r=t.lastReadVersion;if(r!==n.version||(Wi(n),r!==n.version))return!0}return!1}function _s(e){if(lr(e)){let t=e.producers;for(;void 0!==t;)t=Ol(t)}e.producers=void 0,e.producersTail=void 0,e.consumers=void 0,e.consumersTail=void 0}function Os(e,t){const n=e.consumersTail,r=lr(e);if(void 0!==n?(t.nextConsumer=n.nextConsumer,n.nextConsumer=t):(t.nextConsumer=void 0,e.consumers=t),t.prevConsumer=n,e.consumersTail=t,!r)for(let i=e.producers;void 0!==i;i=i.nextProducer)Os(i.producer,i)}function Ol(e){const t=e.producer,n=e.nextProducer,r=e.nextConsumer,i=e.prevConsumer;if(e.nextConsumer=void 0,e.prevConsumer=void 0,void 0!==r?r.prevConsumer=i:t.consumersTail=i,void 0!==i)i.nextConsumer=r;else if(t.consumers=r,!lr(t)){let o=t.producers;for(;void 0!==o;)o=Ol(o)}return n}function lr(e){return e.consumerIsAlwaysLive||void 0!==e.consumers}function Nl(e,t){return Object.is(e,t)}const _a=Symbol("UNSET"),vs=Symbol("COMPUTING"),Zi=Symbol("ERRORED"),ya={...Pl,value:_a,dirty:!0,error:null,equal:Nl,kind:"computed",producerMustRecompute:e=>e.value===_a||e.value===vs,producerRecomputeValue(e){if(e.value===vs)throw new Error("");const t=e.value;e.value=vs;const n=Yo(e);let r,i=!1;try{r=e.computation(),yt(null),i=t!==_a&&t!==Zi&&r!==Zi&&e.equal(t,r)}catch(o){r=Zi,e.error=o}finally{ga(e,n)}i?e.value=t:(e.value=r,e.version++)}};let Ll=function Mc(){throw new Error};function el(e){Ll(e)}function tl(e,t){const n=Object.create(ba);n.value=e,void 0!==t&&(n.equal=t);const r=()=>function va(e){return wo(e),e.value}(n);return r[Ve]=n,[r,a=>nl(n,a),a=>function Ns(e,t){ki()||el(e),nl(e,t(e.value))}(n,a)]}function nl(e,t){ki()||el(e),e.equal(e.value,t)||(e.value=t,function Eo(e){e.version++,function Ac(){v++}(),wu(e)}(e))}const ba={...Pl,equal:Nl,value:void 0,kind:"signal"},kp={...Pl,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"};function cr(e){return"function"==typeof e}function Xo(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const rl=Xo(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function il(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Hn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(cr(r))try{r()}catch(o){t=o instanceof rl?o.errors:[o]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const o of i)try{Fs(o)}catch(a){t=t??[],a instanceof rl?t=[...t,...a.errors]:t.push(a)}}if(t)throw new rl(t)}}add(t){var n;if(t&&t!==this)if(this.closed)Fs(t);else{if(t instanceof Hn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&il(n,t)}remove(t){const{_teardowns:n}=this;n&&il(n,t),t instanceof Hn&&t._removeParent(this)}}Hn.EMPTY=(()=>{const e=new Hn;return e.closed=!0,e})();const bs=Hn.EMPTY;function Fl(e){return e instanceof Hn||e&&"closed"in e&&cr(e.remove)&&cr(e.add)&&cr(e.unsubscribe)}function Fs(e){cr(e)?e():e.unsubscribe()}const wa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Pc={setTimeout(...e){const{delegate:t}=Pc;return(t?.setTimeout||setTimeout)(...e)},clearTimeout(e){const{delegate:t}=Pc;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Cu(e){Pc.setTimeout(()=>{const{onUnhandledError:t}=wa;if(!t)throw e;t(e)})}function xa(){}const Du=Oc("C",void 0,void 0);function Oc(e,t,n){return{kind:e,value:t,error:n}}let ws=null;function Bl(e){if(wa.useDeprecatedSynchronousErrorHandling){const t=!ws;if(t&&(ws={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=ws;if(ws=null,n)throw r}}else e()}class Su extends Hn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Fl(t)&&t.add(this)):this.destination=Nc}static create(t,n,r){return new Id(t,n,r)}next(t){this.isStopped?Ea(function Tu(e){return Oc("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Ea(function qh(e){return Oc("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Ea(Du,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Id extends Su{constructor(t,n,r){let i;if(super(),cr(t))i=t;else if(t){let o;({next:i,error:n,complete:r}=t),this&&wa.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe()):o=t,i=i?.bind(o),n=n?.bind(o),r=r?.bind(o)}this.destination={next:i?ol(i):xa,error:ol(n??Vl),complete:r?ol(r):xa}}}function ol(e,t){return(...n)=>{try{e(...n)}catch(r){wa.useDeprecatedSynchronousErrorHandling?function Sd(e){wa.useDeprecatedSynchronousErrorHandling&&ws&&(ws.errorThrown=!0,ws.error=e)}(r):Cu(r)}}}function Vl(e){throw e}function Ea(e,t){const{onStoppedNotification:n}=wa;n&&Pc.setTimeout(()=>n(e,t))}const Nc={closed:!0,next:xa,error:Vl,complete:xa},zl="function"==typeof Symbol&&Symbol.observable||"@@observable";function Xn(e){return e}function z(e){return 0===e.length?Xn:1===e.length?e[0]:function(n){return e.reduce((r,i)=>i(r),n)}}let U=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,i){const o=function ue(e){return e&&e instanceof Su||function te(e){return e&&cr(e.next)&&cr(e.error)&&cr(e.complete)}(e)&&Fl(e)}(n)?n:new Id(n,r,i);return Bl(()=>{const{operator:a,source:c}=this;o.add(a?a.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=G(r))((i,o)=>{let a;a=this.subscribe(c=>{try{n(c)}catch(p){o(p),a?.unsubscribe()}},o,i)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[zl](){return this}pipe(...n){return z(n)(this)}toPromise(n){return new(n=G(n))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return e.create=t=>new e(t),e})();function G(e){var t;return null!==(t=e??wa.Promise)&&void 0!==t?t:Promise}const he=Xo(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ze,K=(()=>{class e extends U{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new W(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new he}next(n){Bl(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(n)}})}error(n){Bl(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Bl(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:o}=this;return r||i?bs:(o.push(n),new Hn(()=>il(o,n)))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:o}=this;r?n.error(i):o&&n.complete()}asObservable(){const n=new U;return n.source=this,n}}return e.create=(t,n)=>new W(t,n),e})();class W extends K{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:bs}}class re extends K{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}function Ke(){return ze}function Ce(e){const t=ze;return ze=e,t}const ot=Symbol("NotFound");function mt(e){return e===ot||"\u0275NotFound"===e?.name}Error;const Wt="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class se extends Error{code;constructor(t,n){super(Nt(t,n)),this.code=t}}function Nt(e,t){return`${function or(e){return`NG0${Math.abs(e)}`}(e)}${t?": "+t:""}`}const Jt=globalThis;function ut(e){for(let t in e)if(e[t]===ut)return t;throw Error("")}function Rr(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function gn(e){if("string"==typeof e)return e;if(Array.isArray(e))return`[${e.map(gn).join(", ")}]`;if(null==e)return""+e;const t=e.overriddenName||e.name;if(t)return`${t}`;const n=e.toString();if(null==n)return""+n;const r=n.indexOf("\n");return r>=0?n.slice(0,r):n}function an(e,t){return e?t?`${e} ${t}`:e:t||""}const mn=ut({__forward_ref__:ut});function $n(e){return e.__forward_ref__=$n,e.toString=function(){return gn(this())},e}function cn(e){return Qr(e)?e():e}function Qr(e){return"function"==typeof e&&e.hasOwnProperty(mn)&&e.__forward_ref__===$n}function Ue(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Lr(e){return{providers:e.providers||[],imports:e.imports||[]}}function Gh(e){return function $y(e,t){return e.hasOwnProperty(t)&&e[t]||null}(e,Bc)}function Fc(e){return e&&e.hasOwnProperty(Vc)?e[Vc]:null}const Bc=ut({\u0275prov:ut}),Vc=ut({\u0275inj:ut});class Le{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,n){this._desc=t,this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ue({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ad(e){return e&&!!e.\u0275providers}const Zh=ut({\u0275cmp:ut}),Pp=ut({\u0275dir:ut}),Op=ut({\u0275pipe:ut}),Np=ut({\u0275mod:ut}),Gl=ut({\u0275fac:ut}),Rd=ut({__NG_ELEMENT_ID__:ut}),Au=ut({__NG_ENV_ID__:ut});function es(e){return Da(e),e[Np]||null}function en(e){return Da(e),e[Zh]||null}function Jr(e){return Da(e),e[Pp]||null}function Xi(e){return Da(e),e[Op]||null}function Da(e,t){if(null==e)throw new se(-919,!1)}function Zt(e){return"string"==typeof e?e:null==e?"":String(e)}const Yh=ut({ngErrorCode:ut}),pr=ut({ngErrorMessage:ut}),Ta=ut({ngTokenPath:ut});function Mu(e,t){return sl("",-200,t)}function Xh(e,t){throw new se(-201,!1)}function sl(e,t,n){const r=new se(t,e);return r[Yh]=t,r[pr]=e,n&&(r[Ta]=n),r}let Qh;function Jh(){return Qh}function vi(e){const t=Qh;return Qh=e,t}function ef(e,t,n){const r=Gh(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:8&n?null:void 0!==t?t:void Xh()}const Sa={};class ur{injector;constructor(t){this.injector=t}retrieve(t,n){const r=Od(n)||0;try{return this.injector.get(t,8&r?null:Sa,r)}catch(i){if(mt(i))return i;throw i}}}function tf(e,t=0){const n=Ke();if(void 0===n)throw new se(-203,!1);if(null===n)return ef(e,void 0,t);{const r=function Nd(e){return{optional:!!(8&e),host:!!(1&e),self:!!(2&e),skipSelf:!!(4&e)}}(t),i=n.retrieve(e,r);if(mt(i)){if(r.optional)return null;throw i}return i}}function Ct(e,t=0){return(Jh()||tf)(cn(e),t)}function Z(e,t){return Ct(e,Od(t))}function Od(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function nf(e){const t=[];for(let n=0;n<e.length;n++){const r=cn(e[n]);if(Array.isArray(r)){if(0===r.length)throw new se(900,!1);let i,o=0;for(let a=0;a<r.length;a++){const c=r[a],p=rf(c);"number"==typeof p?-1===p?i=c.token:o|=p:i=c}t.push(Ct(i,o))}else t.push(Ct(r))}return t}function rf(e){return e.__NG_DI_FLAG__}function ka(e,t){return e.hasOwnProperty(Gl)?e[Gl]:null}function Kl(e,t){e.forEach(n=>Array.isArray(n)?Kl(n,t):t(n))}function Nu(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function ts(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Aa(e,t,n){let r=al(e,t);return r>=0?e[1|r]=n:(r=~r,function sf(e,t,n,r){let i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function Uc(e,t){const n=al(e,t);if(n>=0)return e[1|n]}function al(e,t){return function Ky(e,t,n){let r=0,i=e.length>>n;for(;i!==r;){const o=r+(i-r>>1),a=e[o<<n];if(t===a)return o<<n;a>t?i=o:r=o+1}return~(i<<n)}(e,t,1)}const Cs={},Tr=[],Vs=new Le(""),af=new Le("",-1),lf=new Le("");class Bd{get(t,n=Sa){if(n===Sa){const i=sl("",-201);throw i.name="\u0275NotFound",i}return n}}function Ra(e){return{\u0275providers:e}}function uf(...e){return{\u0275providers:jc(0,e),\u0275fromNgModule:!0}}function jc(e,...t){const n=[],r=new Set;let i;const o=a=>{n.push(a)};return Kl(t,a=>{const c=a;Lu(c,o,[],r)&&(i||=[],i.push(c))}),void 0!==i&&Fp(i,o),n}function Fp(e,t){for(let n=0;n<e.length;n++){const{ngModule:r,providers:i}=e[n];Fu(i,o=>{t(o,r)})}}function Lu(e,t,n,r){if(!(e=cn(e)))return!1;let i=null,o=Fc(e);const a=!o&&en(e);if(o||a){if(a&&!a.standalone)return!1;i=e}else{const p=e.ngModule;if(o=Fc(p),!o)return!1;i=p}const c=r.has(i);if(a){if(c)return!1;if(r.add(i),a.dependencies){const p="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const _ of p)Lu(_,t,n,r)}}else{if(!o)return!1;{if(null!=o.imports&&!c){let _;r.add(i),Kl(o.imports,x=>{Lu(x,t,n,r)&&(_||=[],_.push(x))}),void 0!==_&&Fp(_,t)}if(!c){const _=ka(i)||(()=>new i);t({provide:i,useFactory:_,deps:Tr},i),t({provide:lf,useValue:i,multi:!0},i),t({provide:Vs,useValue:()=>Ct(i),multi:!0},i)}const p=o.providers;if(null!=p&&!c){const _=e;Fu(p,x=>{t(x,_)})}}}return i!==e&&void 0!==e.providers}function Fu(e,t){for(let n of e)Ad(n)&&(n=n.\u0275providers),Array.isArray(n)?Fu(n,t):t(n)}const Hc=ut({provide:String,useValue:ut});function Ma(e){return null!==e&&"object"==typeof e&&Hc in e}function Uo(e){return"function"==typeof e}const df=new Le(""),ll={},Bu={};let Bp;function Yl(){return void 0===Bp&&(Bp=new Bd),Bp}class Fr{}class Js extends Fr{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,Do(t,a=>this.processProvider(a)),this.records.set(af,nt(void 0,this)),i.has("environment")&&this.records.set(Fr,nt(void 0,this));const o=this.records.get(df);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(lf,Tr,{self:!0}))}retrieve(t,n){const r=Od(n)||0;try{return this.get(t,Sa,r)}catch(i){if(mt(i))return i;throw i}}destroy(){Qi(this),this._destroyed=!0;const t=yt(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),yt(t)}}onDestroy(t){return Qi(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){Qi(this);const n=Ce(this),r=vi(void 0);try{return t()}finally{Ce(n),vi(r)}}get(t,n=Sa,r){if(Qi(this),t.hasOwnProperty(Au))return t[Au](this);const i=Od(r),a=Ce(this),c=vi(void 0);try{if(!(4&i)){let _=this.records.get(t);if(void 0===_){const x=function Xl(e){return"function"==typeof e||"object"==typeof e&&"InjectionToken"===e.ngMetadataName}(t)&&Gh(t);_=x&&this.injectableDefInScope(x)?nt(Pi(t),ll):null,this.records.set(t,_)}if(null!=_)return this.hydrate(t,_,i)}return(2&i?Yl():this.parent).get(t,n=8&i&&n===Sa?null:n)}catch(p){const _=function Pu(e){return e[Yh]}(p);throw-200===_||-201===_?new se(_,null):p}finally{vi(c),Ce(a)}}resolveInjectorInitializers(){const t=yt(null),n=Ce(this),r=vi(void 0);try{const o=this.get(Vs,Tr,{self:!0});for(const a of o)a()}finally{Ce(n),vi(r),yt(t)}}toString(){const t=[],n=this.records;for(const r of n.keys())t.push(gn(r));return`R3Injector[${t.join(", ")}]`}processProvider(t){let n=Uo(t=cn(t))?t:cn(t&&t.provide);const r=function kg(e){return Ma(e)?nt(void 0,e.useValue):nt(bi(e),ll)}(t);if(!Uo(t)&&!0===t.multi){let i=this.records.get(n);i||(i=nt(void 0,ll,!0),i.factory=()=>nf(i.multi),this.records.set(n,i)),n=t,i.multi.push(t)}this.records.set(n,r)}hydrate(t,n,r){const i=yt(null);try{if(n.value===Bu)throw Mu(gn(t));return n.value===ll&&(n.value=Bu,n.value=n.factory(void 0,r)),"object"==typeof n.value&&n.value&&function Vu(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{yt(i)}}injectableDefInScope(t){if(!t.providedIn)return!1;const n=cn(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){const n=this._onDestroyHooks.indexOf(t);-1!==n&&this._onDestroyHooks.splice(n,1)}}function Pi(e){const t=Gh(e),n=null!==t?t.factory:ka(e);if(null!==n)return n;if(e instanceof Le)throw new se(204,!1);if(e instanceof Function)return function Ds(e){if(e.length>0)throw new se(204,!1);const n=function Rp(e){return(e?.[Bc]??null)||null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new se(204,!1)}function bi(e,t,n){let r;if(Uo(e)){const i=cn(e);return ka(i)||Pi(i)}if(Ma(e))r=()=>cn(e.useValue);else if(function xn(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...nf(e.deps||[]));else if(function qn(e){return!(!e||!e.useExisting)}(e))r=(i,o)=>Ct(cn(e.useExisting),void 0!==o&&8&o?8:void 0);else{const i=cn(e&&(e.useClass||e.provide));if(!function Vd(e){return!!e.deps}(e))return ka(i)||Pi(i);r=()=>new i(...nf(e.deps))}return r}function Qi(e){if(e.destroyed)throw new se(205,!1)}function nt(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Do(e,t){for(const n of e)Array.isArray(n)?Do(n,t):n&&Ad(n)?Do(n.\u0275providers,t):t(n)}function Oi(e,t){let n;e instanceof Js?(Qi(e),n=e):n=new ur(e);const i=Ce(n),o=vi(void 0);try{return t()}finally{Ce(i),vi(o)}}function _n(e){return Array.isArray(e)&&"object"==typeof e[1]}function uo(e){return Array.isArray(e)&&!0===e[1]}function zu(e){return!!(4&e.flags)}function Ji(e){return e.componentOffset>-1}function zi(e){return!(1&~e.flags)}function is(e){return!!e.template}function os(e){return!!(512&e[2])}function Ss(e){return!(256&~e[2])}function L(e){for(;Array.isArray(e);)e=e[0];return e}function q(e,t){return L(t[e])}function j(e,t){return L(t[e.index])}function J(e,t){return e.data[t]}function ie(e,t){const n=t[e];return _n(n)?n:n[0]}function me(e){return!(128&~e[2])}function Ee(e,t){return null==t?null:e[t]}function ke(e){e[17]=0}function Ne(e){1024&e[2]||(e[2]|=1024,me(e)&&gt(e))}function He(e){return!!(9216&e[2]||e[24]?.dirty)}function rt(e){e[10].changeDetectionScheduler?.notify(8),64&e[2]&&(e[2]|=1024),He(e)&&gt(e)}function gt(e){e[10].changeDetectionScheduler?.notify(0);let t=ln(e);for(;null!==t&&!(8192&t[2])&&(t[2]|=8192,me(t));)t=ln(t)}function bt(e,t){if(Ss(e))throw new se(911,!1);null===e[21]&&(e[21]=[]),e[21].push(t)}function ln(e){const t=e[3];return uo(t)?t[3]:t}function st(e){return e[7]??=[]}function Ht(e){return e.cleanup??=[]}const Ye={lFrame:x0(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Ot=!1;function Br(){Ye.lFrame.elementDepthCount--}function eo(){return Ye.bindingsEnabled}function ui(){return null!==Ye.skipHydrationRootTNode}function di(e){return Ye.skipHydrationRootTNode===e}function ho(){Ye.skipHydrationRootTNode=null}function Ae(){return Ye.lFrame.lView}function Lt(){return Ye.lFrame.tView}function yn(e){return Ye.lFrame.contextLView=e,e[8]}function er(e){return Ye.lFrame.contextLView=null,e}function $t(){let e=$c();for(;null!==e&&64===e.type;)e=e.parent;return e}function $c(){return Ye.lFrame.currentTNode}function Is(e,t){const n=Ye.lFrame;n.currentTNode=e,n.isParent=t}function qc(){return Ye.lFrame.isParent}function ra(){Ye.lFrame.isParent=!1}function tc(){return Ot}function Sr(e){const t=Ot;return Ot=e,t}function Mn(){const e=Ye.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Ui(){return Ye.lFrame.bindingIndex++}function ul(e){const t=Ye.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Mg(e,t){const n=Ye.lFrame;n.bindingIndex=n.bindingRootIndex=e,Wc(t)}function Wc(e){Ye.lFrame.currentDirectiveIndex=e}function jp(){return Ye.lFrame.currentQueryIndex}function nc(e){Ye.lFrame.currentQueryIndex=e}function ss(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[5]:null}function b0(e,t,n){if(4&n){let i=t,o=e;for(;!(i=i.parent,null!==i||1&n||(i=ss(o),null===i||(o=o[14],10&i.type))););if(null===i)return!1;t=i,e=o}const r=Ye.lFrame=w0();return r.currentTNode=t,r.lView=e,!0}function Og(e){const t=w0(),n=e[1];Ye.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function w0(){const e=Ye.lFrame,t=null===e?null:e.child;return null===t?x0(e):t}function x0(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function E0(){const e=Ye.lFrame;return Ye.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const C0=E0;function Hp(){const e=E0();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function to(){return Ye.lFrame.selectedIndex}function $u(e){Ye.lFrame.selectedIndex=e}function So(){const e=Ye.lFrame;return J(e.tView,e.selectedIndex)}function Oa(){Ye.lFrame.currentNamespace="svg"}let T0=!0;function Ng(){return T0}function $p(e){T0=e}function Lg(e,t=null,n=null,r){const i=S0(e,t,n,r);return i.resolveInjectorInitializers(),i}function S0(e,t=null,n=null,r,i=new Set){const o=[n||Tr,uf(e)];return r=r||("object"==typeof e?void 0:gn(e)),new Js(o,t||Yl(),r||null,i)}class En{static THROW_IF_NOT_FOUND=Sa;static NULL=new Bd;static create(t,n){if(Array.isArray(t))return Lg({name:""},n,t,"");{const r=t.name??"";return Lg({name:r},t.parent,t.providers,r)}}static \u0275prov=Ue({token:En,providedIn:"any",factory:()=>Ct(af)});static __NG_ELEMENT_ID__=-1}const Fn=new Le("");let tr=(()=>class e{static __NG_ELEMENT_ID__=I0;static __NG_ENV_ID__=n=>n})();class qp extends tr{_lView;constructor(t){super(),this._lView=t}get destroyed(){return Ss(this._lView)}onDestroy(t){const n=this._lView;return bt(n,t),()=>function vt(e,t){if(null===e[21])return;const n=e[21].indexOf(t);-1!==n&&e[21].splice(n,1)}(n,t)}}function I0(){return new qp(Ae())}const Gp=!1,Fg=new Le("");let Na=(()=>{class e{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new re(!1);debugTaskTracker=Z(Fg,{optional:!0});get hasPendingTasks(){return!this.destroyed&&this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new U(n=>{n.next(!1),n.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),this.debugTaskTracker?.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.debugTaskTracker?.remove(n),0===this.pendingTasks.size&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new e})}return e})();const Bn=class k0 extends K{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,function ao(){return void 0!==Jh()||null!=Ke()}()&&(this.destroyRef=Z(tr,{optional:!0})??void 0,this.pendingTasks=Z(Na,{optional:!0})??void 0)}emit(t){const n=yt(null);try{super.next(t)}finally{yt(n)}}subscribe(t,n,r){let i=t,o=n||(()=>null),a=r;if(t&&"object"==typeof t){const p=t;i=p.next?.bind(p),o=p.error?.bind(p),a=p.complete?.bind(p)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),a&&(a=this.wrapInTimeout(a)));const c=super.subscribe({next:i,error:o,complete:a});return t instanceof Hn&&t.add(c),c}wrapInTimeout(t){return n=>{const r=this.pendingTasks?.add();setTimeout(()=>{try{t(n)}finally{void 0!==r&&this.pendingTasks?.remove(r)}})}}};function qu(...e){}function Bg(e){let t,n;function r(){e=qu;try{void 0!==n&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(n),void 0!==t&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{e(),r()}),"function"==typeof requestAnimationFrame&&(n=requestAnimationFrame(()=>{e(),r()})),()=>r()}function Yy(e){return queueMicrotask(()=>e()),()=>{e=qu}}const $d="isAngularZone",Vg=$d+"_ID";let Xy=0;class Xt{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Bn(!1);onMicrotaskEmpty=new Bn(!1);onStable=new Bn(!1);onError=new Bn(!1);constructor(t){const{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=Gp}=t;if(typeof Zone>"u")throw new se(908,!1);Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!i&&r,a.shouldCoalesceRunChangeDetection=i,a.callbackScheduled=!1,a.scheduleInRootZone=o,function oT(e){const t=()=>{!function dl(e){function t(){Bg(()=>{e.callbackScheduled=!1,Jy(e),e.isCheckStableRunning=!0,Wp(e),e.isCheckStableRunning=!1})}e.isCheckStableRunning||e.callbackScheduled||(e.callbackScheduled=!0,e.scheduleInRootZone?Zone.root.run(()=>{t()}):e._outer.run(()=>{t()}),Jy(e))}(e)},n=Xy++;e._inner=e._inner.fork({name:"angular",properties:{[$d]:!0,[Vg]:n,[Vg+n]:!0},onInvokeTask:(r,i,o,a,c,p)=>{if(function _f(e){return P0(e,"__ignore_ng_zone__")}(p))return r.invokeTask(o,a,c,p);try{return A0(e),r.invokeTask(o,a,c,p)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),R0(e)}},onInvoke:(r,i,o,a,c,p,_)=>{try{return A0(e),r.invoke(o,a,c,p,_)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!function sT(e){return P0(e,"__scheduler_tick__")}(p)&&t(),R0(e)}},onHasTask:(r,i,o,a)=>{r.hasTask(o,a),i===o&&("microTask"==a.change?(e._hasPendingMicrotasks=a.microTask,Jy(e),Wp(e)):"macroTask"==a.change&&(e.hasPendingMacrotasks=a.macroTask))},onHandleError:(r,i,o,a)=>(r.handleError(o,a),e.runOutsideAngular(()=>e.onError.emit(a)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get($d)}static assertInAngularZone(){if(!Xt.isInAngularZone())throw new se(909,!1)}static assertNotInAngularZone(){if(Xt.isInAngularZone())throw new se(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,t,Qy,qu,qu);try{return o.runTask(a,n,r)}finally{o.cancelTask(a)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const Qy={};function Wp(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Jy(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&!0===e.callbackScheduled)}function A0(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function R0(e){e._nesting--,Wp(e)}class M0{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Bn;onMicrotaskEmpty=new Bn;onStable=new Bn;onError=new Bn;run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,i){return t.apply(n,r)}}function P0(e,t){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0]?.data?.[t]}class yf{_console=console;handleError(t){this._console.error("ERROR",t)}}const hl=new Le("",{factory:()=>{const e=Z(Xt),t=Z(Fr);let n;return r=>{e.runOutsideAngular(()=>{t.destroyed&&!n?setTimeout(()=>{throw r}):(n??=t.get(yf),n.handleError(r))})}}}),O0={provide:Vs,useValue:()=>{Z(yf,{optional:!0})},multi:!0};function as(e,t){const[n,r,i]=tl(e,t?.equal),o=n;return o.set=r,o.update=i,o.asReadonly=qd.bind(o),o}function qd(){const e=this[Ve];if(void 0===e.readonlyFn){const t=()=>this();t[Ve]=e,e.readonlyFn=t}return e.readonlyFn}let ev=(()=>class e{view;node;constructor(n,r){this.view=n,this.node=r}static __NG_ELEMENT_ID__=lT})();function lT(){return new ev(Ae(),$t())}class vf{}const Gu=new Le("",{factory:()=>!0}),N0=new Le("");let tv=(()=>{class e{internalPendingTasks=Z(Na);scheduler=Z(vf);errorHandler=Z(hl);add(){const n=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(n)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(n))}}run(n){const r=this.add();n().catch(this.errorHandler).finally(r)}static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new e})}return e})(),L0=(()=>{class e{static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new uT})}return e})();class uT{dirtyEffectCount=0;queues=new Map;add(t){this.enqueue(t),this.schedule(t)}schedule(t){t.dirty&&this.dirtyEffectCount++}remove(t){const r=this.queues.get(t.zone);r.has(t)&&(r.delete(t),t.dirty&&this.dirtyEffectCount--)}enqueue(t){const n=t.zone;this.queues.has(n)||this.queues.set(n,new Set);const r=this.queues.get(n);r.has(t)||r.add(t)}flush(){for(;this.dirtyEffectCount>0;){let t=!1;for(const[n,r]of this.queues)t||=null===n?this.flushQueue(r):n.run(()=>this.flushQueue(r));t||(this.dirtyEffectCount=0)}}flushQueue(t){let n=!1;for(const r of t)r.dirty&&(this.dirtyEffectCount--,n=!0,r.run());return n}}function mr(e){return function Ls(e){const t=yt(null);try{return e()}finally{yt(t)}}(e)}function j0(e,t,n,r,i,o,a){try{var c=e[o](a),p=c.value}catch(_){return void n(_)}c.done?t(p):Promise.resolve(p).then(r,i)}function _e(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(p){j0(o,r,i,a,c,"next",p)}function c(p){j0(o,r,i,a,c,"throw",p)}a(void 0)})}}function Io(e){return t=>{if(function hT(e){return cr(e?.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class ei extends Su{constructor(t,n,r,i,o){super(t),this.onFinalize=o,this._next=n?function(a){try{n(a)}catch(c){t.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}function ar(e,t){return Io((n,r)=>{let i=0;n.subscribe(new ei(r,o=>{r.next(e.call(t,o,i++))}))})}function ic(e){return{toString:e}.toString()}function xf(e,t,n,r){null!==t?t.applyValueToInputSignal(t,r):e[n]=r}class Hs{previousValue;currentValue;firstChange;constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}const ko=(()=>{const e=()=>fo;return e.ngInherit=!0,e})();function fo(e){return e.type.prototype.ngOnChanges&&(e.setInput=jg),Ug}function Ug(){const e=nv(this),t=e?.current;if(t){const n=e.previous;if(n===Cs)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function jg(e,t,n,r,i){const o=this.declaredInputs[r],a=nv(e)||function G0(e,t){return e[ls]=t}(e,{previous:Cs,current:null}),c=a.current||(a.current={}),p=a.previous,_=p[o];c[o]=new Hs(_&&_.currentValue,n,p===Cs),xf(e,t,i,n)}const ls="__ngSimpleChanges__";function nv(e){return e[ls]||null}const Zd=[],dr=function(e,t=null,n){for(let r=0;r<Zd.length;r++)(0,Zd[r])(e,t,n)};var _t=function(e){return e[e.TemplateCreateStart=0]="TemplateCreateStart",e[e.TemplateCreateEnd=1]="TemplateCreateEnd",e[e.TemplateUpdateStart=2]="TemplateUpdateStart",e[e.TemplateUpdateEnd=3]="TemplateUpdateEnd",e[e.LifecycleHookStart=4]="LifecycleHookStart",e[e.LifecycleHookEnd=5]="LifecycleHookEnd",e[e.OutputStart=6]="OutputStart",e[e.OutputEnd=7]="OutputEnd",e[e.BootstrapApplicationStart=8]="BootstrapApplicationStart",e[e.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",e[e.BootstrapComponentStart=10]="BootstrapComponentStart",e[e.BootstrapComponentEnd=11]="BootstrapComponentEnd",e[e.ChangeDetectionStart=12]="ChangeDetectionStart",e[e.ChangeDetectionEnd=13]="ChangeDetectionEnd",e[e.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",e[e.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",e[e.AfterRenderHooksStart=16]="AfterRenderHooksStart",e[e.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",e[e.ComponentStart=18]="ComponentStart",e[e.ComponentEnd=19]="ComponentEnd",e[e.DeferBlockStateStart=20]="DeferBlockStateStart",e[e.DeferBlockStateEnd=21]="DeferBlockStateEnd",e[e.DynamicComponentStart=22]="DynamicComponentStart",e[e.DynamicComponentEnd=23]="DynamicComponentEnd",e[e.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",e[e.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",e}(_t||{});function Hg(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const o=e.data[n].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:c,ngAfterViewInit:p,ngAfterViewChecked:_,ngOnDestroy:x}=o;a&&(e.contentHooks??=[]).push(-n,a),c&&((e.contentHooks??=[]).push(n,c),(e.contentCheckHooks??=[]).push(n,c)),p&&(e.viewHooks??=[]).push(-n,p),_&&((e.viewHooks??=[]).push(n,_),(e.viewCheckHooks??=[]).push(n,_)),null!=x&&(e.destroyHooks??=[]).push(n,x)}}function Kp(e,t,n){sv(e,t,3,n)}function Yp(e,t,n,r){(3&e[2])===n&&sv(e,t,n,r)}function ov(e,t){let n=e[2];(3&n)===t&&(n&=16383,n+=1,e[2]=n)}function sv(e,t,n,r){const o=r??-1,a=t.length-1;let c=0;for(let p=void 0!==r?65535&e[17]:0;p<a;p++)if("number"==typeof t[p+1]){if(c=t[p],null!=r&&c>=r)break}else t[p]<0&&(e[17]+=65536),(c<o||-1==o)&&(Z0(e,n,t,p),e[17]=(4294901760&e[17])+p+2),p++}function av(e,t){dr(_t.LifecycleHookStart,e,t);const n=yt(null);try{t.call(e)}finally{yt(n),dr(_t.LifecycleHookEnd,e,t)}}function Z0(e,t,n,r){const i=n[r]<0,o=n[r+1],c=e[i?-n[r]:n[r]];i?e[2]>>14<e[17]>>16&&(3&e[2])===t&&(e[2]+=16384,av(c,o)):av(c,o)}class Xp{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,n,r,i){this.factory=t,this.name=i,this.canSeeViewProviders=n,this.injectImpl=r}}function Yu(e){return 3===e||4===e||6===e}function Y0(e){return 64===e.charCodeAt(0)}function Cf(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||X0(e,n,i,0,-1===n||2===n?t[++r]:null)}}return e}function X0(e,t,n,r,i){let o=0,a=e.length;if(-1===t)a=-1;else for(;o<e.length;){const c=e[o++];if("number"==typeof c){if(c===t){a=-1;break}if(c>t){a=o-1;break}}}for(;o<e.length;){const c=e[o];if("number"==typeof c)break;if(c===n)return void(null!==i&&(e[o+1]=i));o++,null!==i&&o++}-1!==a&&(e.splice(a,0,t),o=a+1),e.splice(o++,0,n),null!==i&&e.splice(o++,0,i)}function Xu(e){return-1!==e}function Yd(e){return 32767&e}function Xd(e,t){let n=function Q0(e){return e>>16}(e),r=t;for(;n>0;)r=r[14],n--;return r}let Gg=!0;function Qp(e){const t=Gg;return Gg=e,t}let Wg=0;const Fa={};function Kc(e,t){const n=Gn(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Qd(r.data,e),Qd(t,null),Qd(r.blueprint,null));const i=Zg(e,t),o=e.injectorIndex;if(Xu(i)){const a=Yd(i),c=Xd(i,t),p=c[1].data;for(let _=0;_<8;_++)t[o+_]=c[a+_]|p[a+_]}return t[o+8]=i,o}function Qd(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Gn(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Zg(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){if(r=pv(i),null===r)return-1;if(n++,i=i[14],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Jp(e,t,n){!function ET(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Rd)&&(r=n[Rd]),null==r&&(r=n[Rd]=Wg++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function tx(e,t,n){if(8&n||void 0!==e)return e;Xh()}function nx(e,t,n,r){if(8&n&&void 0===r&&(r=null),!(3&n)){const i=e[9],o=vi(void 0);try{return i?i.get(t,r,8&n):ef(t,r,8&n)}finally{vi(o)}}return tx(r,0,n)}function rx(e,t,n,r=0,i){if(null!==e){if(2048&t[2]&&!(2&r)){const a=function xr(e,t,n,r,i){let o=e,a=t;for(;null!==o&&null!==a&&2048&a[2]&&!os(a);){const c=ix(o,a,n,2|r,Fa);if(c!==Fa)return c;let p=o.parent;if(!p){const _=a[20];if(_){const x=_.get(n,Fa,r);if(x!==Fa)return x}p=pv(a),a=a[14]}o=p}return i}(e,t,n,r,Fa);if(a!==Fa)return a}const o=ix(e,t,n,r,Fa);if(o!==Fa)return o}return nx(t,n,r,i)}function ix(e,t,n,r,i){const o=function ox(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Rd)?e[Rd]:void 0;return"number"==typeof t?t>=0?255&t:Sf:t}(n);if("function"==typeof o){if(!b0(t,e,r))return 1&r?tx(i,0,r):nx(t,n,r,i);try{let a;if(a=o(r),null!=a||8&r)return a;Xh()}finally{C0()}}else if("number"==typeof o){let a=null,c=Gn(e,t),p=-1,_=1&r?t[15][5]:null;for((-1===c||4&r)&&(p=-1===c?Zg(e,t):t[c+8],-1!==p&&fv(r,!1)?(a=t[1],c=Yd(p),t=Xd(p,t)):c=-1);-1!==c;){const x=t[1];if(hv(o,c,x.data)){const D=CT(c,t,n,a,r,_);if(D!==Fa)return D}p=t[c+8],-1!==p&&fv(r,t[1].data[c+8]===_)&&hv(o,c,t)?(a=x,c=Yd(p),t=Xd(p,t)):c=-1}}return i}function CT(e,t,n,r,i,o){const a=t[1],c=a.data[e+8],x=Kg(c,a,n,null==r?Ji(c)&&Gg:r!=a&&!!(3&c.type),1&i&&o===c);return null!==x?Tf(t,a,x,c,i):Fa}function Kg(e,t,n,r,i){const o=e.providerIndexes,a=t.data,c=1048575&o,p=e.directiveStart,x=o>>20,A=i?c+x:e.directiveEnd;for(let O=r?c:c+x;O<A;O++){const B=a[O];if(O<p&&n===B||O>=p&&B.type===n)return O}if(i){const O=a[p];if(O&&is(O)&&O.type===n)return p}return null}function Tf(e,t,n,r,i){let o=e[n];const a=t.data;if(o instanceof Xp){const c=o;if(c.resolving)throw Mu();const p=Qp(c.canSeeViewProviders);c.resolving=!0;const D=c.injectImpl?vi(c.injectImpl):null;b0(e,r,0);try{o=e[n]=c.factory(void 0,i,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function Ef(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=t.type.prototype;if(r){const a=fo(t);(n.preOrderHooks??=[]).push(e,a),(n.preOrderCheckHooks??=[]).push(e,a)}i&&(n.preOrderHooks??=[]).push(0-e,i),o&&((n.preOrderHooks??=[]).push(e,o),(n.preOrderCheckHooks??=[]).push(e,o))}(n,a[n],t)}finally{null!==D&&vi(D),Qp(p),c.resolving=!1,C0()}}return o}function hv(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function fv(e,t){return!(2&e||1&e&&t)}class ti{_tNode;_lView;constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return rx(this._tNode,this._lView,t,Od(r),n)}}function Sf(){return new ti($t(),Ae())}function Vr(e){return ic(()=>{const t=e.prototype.constructor,n=t[Gl]||Zr(t),r=Object.prototype;let i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){const o=i[Gl]||Zr(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Zr(e){return Qr(e)?()=>{const t=Zr(cn(e));return t&&t()}:ka(e)}function pv(e){const t=e[1],n=t.type;return 2===n?t.declTNode:1===n?e[5]:null}function If(e){return function Df(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const o=n[i];if(Yu(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(o===t)return n[i+1];i+=2}}}return null}($t(),e)}function Xc(){return eh($t(),Ae())}function eh(e,t){return new Pr(j(e,t))}let Pr=(()=>class e{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=Xc})();function lx(e){return e instanceof Pr?e.nativeElement:e}function ji(){return this._results[Symbol.iterator]()}class Ju{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new K}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){this.dirty=!1;const r=function so(e){return e.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function Ld(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],o=t[r];if(n&&(i=n(i),o=n(o)),o!==i)return!1}return!0}(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=ji}function m(e){return!(128&~e.flags)}var E=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(E||{});const S=new Map;let k=0;function V(e){S.delete(e[19])}const pe="__ngContext__";function fe(e,t){_n(t)?(e[pe]=t[19],function P(e){S.set(e[19],e)}(t)):e[pe]=t}function Yt(e){return xt(e[12])}function vn(e){return xt(e[4])}function xt(e){for(;null!==e&&!uo(e);)e=e[4];return e}let po;const yr=new Le("",{factory:()=>go}),go="ng",pl=new Le(""),cs=new Le("",{providedIn:"platform",factory:()=>"unknown"}),oa=new Le(""),Nr=new Le("",{factory:()=>Z(Fn).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),om=new Le("",{factory:()=>!1}),cm=new Le("");function ah(e){return!(32&~e.flags)}function d2(e,t){const n=e.contentQueries;if(null!==n){const r=yt(null);try{for(let i=0;i<n.length;i+=2){const a=n[i+1];if(-1!==a){const c=e.data[a];nc(n[i]),c.contentQueries(2,t[a],a)}}}finally{yt(r)}}}function PT(e,t,n){nc(0);const r=yt(null);try{t(e,n)}finally{yt(r)}}function OT(e,t,n){if(zu(t)){const r=yt(null);try{const o=t.directiveEnd;for(let a=t.directiveStart;a<o;a++){const c=e.data[a];c.contentQueries&&c.contentQueries(1,n[a],a)}}finally{yt(r)}}}var fc=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e[e.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",e}(fc||{});let Dx,Tx;function y_(e){return function m2(){if(void 0===Dx&&(Dx=null,Jt.trustedTypes))try{Dx=Jt.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Dx}()?.createHTML(e)||e}function y2(e){return function FT(){if(void 0===Tx&&(Tx=null,Jt.trustedTypes))try{Tx=Jt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Tx}()?.createScriptURL(e)||e}class fm{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Wt})`}}class EW extends fm{getTypeName(){return"HTML"}}class CW extends fm{getTypeName(){return"Style"}}class DW extends fm{getTypeName(){return"Script"}}class TW extends fm{getTypeName(){return"URL"}}class SW extends fm{getTypeName(){return"ResourceURL"}}function gl(e){return e instanceof fm?e.changingThisBreaksApplicationSecurity:e}function nd(e,t){const n=function IW(e){return e instanceof fm&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see ${Wt})`)}return n===t}class OW{inertDocumentHelper;constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const n=(new window.DOMParser).parseFromString(y_(t),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(t):(n.firstChild?.remove(),n)}catch{return null}}}class NW{defaultDoc;inertDocument;constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const n=this.inertDocument.createElement("template");return n.innerHTML=y_(t),n}}const FW=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Sx(e){return(e=String(e)).match(FW)?e:"unsafe:"+e}function dh(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function Iv(...e){const t={};for(const n of e)for(const r in n)n.hasOwnProperty(r)&&(t[r]=!0);return t}const b2=dh("area,br,col,hr,img,wbr"),w2=dh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),x2=dh("rp,rt"),BT=Iv(b2,Iv(w2,dh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Iv(x2,dh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Iv(x2,w2)),VT=dh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),E2=Iv(VT,dh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),dh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),BW=dh("script,style,template");class VW{sanitizedSomething=!1;buf=[];sanitizeChildren(t){let n=t.firstChild,r=!0,i=[];for(;n;)if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild)i.push(n),n=jW(n);else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let o=UW(n);if(o){n=o;break}n=i.pop()}return this.buf.join("")}startElement(t){const n=C2(t).toLowerCase();if(!BT.hasOwnProperty(n))return this.sanitizedSomething=!0,!BW.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const r=t.attributes;for(let i=0;i<r.length;i++){const o=r.item(i),a=o.name,c=a.toLowerCase();if(!E2.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let p=o.value;VT[c]&&(p=Sx(p)),this.buf.push(" ",a,'="',T2(p),'"')}return this.buf.push(">"),!0}endElement(t){const n=C2(t).toLowerCase();BT.hasOwnProperty(n)&&!b2.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(t){this.buf.push(T2(t))}}function UW(e){const t=e.nextSibling;if(t&&e!==t.previousSibling)throw D2(t);return t}function jW(e){const t=e.firstChild;if(t&&function zW(e,t){return(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(e,t))throw D2(t);return t}function C2(e){const t=e.nodeName;return"string"==typeof t?t:"FORM"}function D2(e){return new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`)}const HW=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,$W=/([^\#-~ |!])/g;function T2(e){return e.replace(/&/g,"&amp;").replace(HW,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace($W,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ix;function S2(e,t){let n=null;try{Ix=Ix||function v2(e){const t=new NW(e);return function LW(){try{return!!(new window.DOMParser).parseFromString(y_(""),"text/html")}catch{return!1}}()?new OW(t):t}(e);let r=t?String(t):"";n=Ix.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Ix.getInertBodyElement(r)}while(r!==o);return y_((new VW).sanitizeChildren(zT(n)||n))}finally{if(n){const r=zT(n)||n;for(;r.firstChild;)r.firstChild.remove()}}}function zT(e){return"content"in e&&function qW(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}function kx(e,t,n){return e.createElement(t,n)}function pm(e,t,n,r,i){e.insertBefore(t,n,r,i)}function A2(e,t,n){e.appendChild(t,n)}function R2(e,t,n,r,i){null!==r?pm(e,t,n,r,i):A2(e,t,n)}function kv(e,t,n,r){e.removeChild(null,t,n,r)}function P2(e,t,n){const{mergedAttrs:r,classes:i,styles:o}=n;null!==r&&function qg(e,t,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const o=n[r++],a=n[r++],c=n[r++];e.setAttribute(t,a,c,o)}else{const o=i,a=n[++r];Y0(o)?e.setProperty(t,o,a):e.setAttribute(t,o,a),r++}}}(e,t,r),null!==i&&function YW(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}(e,t,i),null!==o&&function KW(e,t,n){e.setAttribute(t,"style",n)}(e,t,o)}var _l=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(_l||{});function pc(e){const t=Av();return t?t.sanitize(_l.URL,e)||"":nd(e,"URL")?gl(e):Sx(Zt(e))}function O2(e){const t=Av();if(t)return y2(t.sanitize(_l.RESOURCE_URL,e)||"");if(nd(e,"ResourceURL"))return y2(gl(e));throw new se(904,!1)}const r7=new Set(["embed","frame","iframe","media","script"]),i7=new Set(["base","link","script"]);function N2(e,t,n){return function o7(e,t){return"src"===t&&r7.has(e)||"href"===t&&i7.has(e)||"xlink:href"===t&&"script"===e?O2:pc}(t,n)(e)}function Av(){const e=Ae();return e&&e[10].sanitizer}function rd(e){return e instanceof Function?e():e}function g7(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const o=t.length;if(i+o===r||e.charCodeAt(i+o)<=32)return i}n=i+1}}const z2="ng-template";function _7(e,t,n,r){let i=0;if(r){for(;i<t.length&&"string"==typeof t[i];i+=2)if("class"===t[i]&&-1!==g7(t[i+1].toLowerCase(),n,0))return!0}else if(HT(e))return!1;if(i=t.indexOf(1,i),i>-1){let o;for(;++i<t.length&&"string"==typeof(o=t[i]);)if(o.toLowerCase()===n)return!0}return!1}function HT(e){return 4===e.type&&e.value!==z2}function y7(e,t,n){return t===(4!==e.type||n?e.value:z2)}function v7(e,t,n){let r=4;const i=e.attrs,o=null!==i?function x7(e){for(let t=0;t<e.length;t++)if(Yu(e[t]))return t;return e.length}(i):0;let a=!1;for(let c=0;c<t.length;c++){const p=t[c];if("number"!=typeof p){if(!a)if(4&r){if(r=2|1&r,""!==p&&!y7(e,p,n)||""===p&&1===t.length){if(ru(r))return!1;a=!0}}else if(8&r){if(null===i||!_7(e,i,p,n)){if(ru(r))return!1;a=!0}}else{const _=t[++c],x=b7(p,i,HT(e),n);if(-1===x){if(ru(r))return!1;a=!0;continue}if(""!==_){let D;if(D=x>o?"":i[x+1].toLowerCase(),2&r&&_!==D){if(ru(r))return!1;a=!0}}}}else{if(!a&&!ru(r)&&!ru(p))return!1;if(a&&ru(p))continue;a=!1,r=p|1&r}}return ru(r)||a}function ru(e){return!(1&e)}function b7(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let o=!1;for(;i<t.length;){const a=t[i];if(a===e)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let c=t[++i];for(;"string"==typeof c;)c=t[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function E7(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function U2(e,t,n=!1){for(let r=0;r<t.length;r++)if(v7(e,t[r],n))return!0;return!1}function C7(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let i=0;i<e.length;i++)if(e[i]!==r[i])continue e;return!0}}return!1}function j2(e,t){return e?":not("+t.trim()+")":t}function D7(e){let t=e[0],n=1,r=2,i="",o=!1;for(;n<e.length;){let a=e[n];if("string"==typeof a)if(2&r){const c=e[++n];i+="["+a+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!ru(a)&&(t+=j2(o,i),i=""),r=a,o=o||!ru(r);n++}return""!==i&&(t+=j2(o,i)),t}const kr={};function $T(e,t,n,r,i,o,a,c,p,_,x){const D=27+r,A=D+i,O=function I7(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:kr);return n}(D,A),B="function"==typeof _?_():_;return O[1]={type:e,blueprint:O,template:n,queries:null,viewQuery:c,declTNode:t,data:O.slice().fill(null,D),bindingStartIndex:D,expandoStartIndex:A,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:p,consts:B,incompleteFirstPass:!1,ssrId:x}}function Rx(e,t,n,r,i,o,a,c,p,_,x){const D=t.blueprint.slice();return D[0]=i,D[2]=1228|r,(null!==_||e&&2048&e[2])&&(D[2]|=2048),ke(D),D[3]=D[14]=e,D[8]=n,D[10]=a||e&&e[10],D[11]=c||e&&e[11],D[9]=p||e&&e[9]||null,D[5]=o,D[19]=function R(){return k++}(),D[6]=x,D[20]=_,D[15]=2==t.type?e[15]:D,D}function qT(e){let t=16;return e.signals?t=4096:e.onPush&&(t=64),t}function Rv(e,t,n,r){if(0===n)return-1;const i=t.length;for(let o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function GT(e,t){return e[12]?e[13][4]=t:e[12]=t,e[13]=t,t}function Me(e=1){$2(Lt(),Ae(),to()+e,!1)}function $2(e,t,n,r){if(!r)if(3&~t[2]){const o=e.preOrderHooks;null!==o&&Yp(t,o,0,n)}else{const o=e.preOrderCheckHooks;null!==o&&Kp(t,o,n)}$u(n)}var Mx=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(Mx||{});function mm(e,t,n,r){const i=yt(null);try{const[o,a,c]=e.inputs[n];let p=null;0!==(a&Mx.SignalBased)&&(p=t[o][Ve]),null!==p&&void 0!==p.transformFn?r=p.transformFn(r):null!==c&&(r=c.call(t,r)),null!==e.setInput?e.setInput(t,p,r,n,o):xf(t,p,o,r)}finally{yt(i)}}var $f=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}($f||{});function ZT(e,t){return undefined(e,t)}const gm=new Set;var KT=function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e}(KT||{});const w_=new Le(""),Z2=new Set;function qo(e){Z2.has(e)||(Z2.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}let K2=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new e})}return e})();const Y2=[0,1,2,3];let N7=(()=>{class e{ngZone=Z(Xt);scheduler=Z(vf);errorHandler=Z(yf,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){Z(w_,{optional:!0})}execute(){const n=this.sequences.size>0;n&&dr(_t.AfterRenderHooksStart),this.executing=!0;for(const r of Y2)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[r])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>(0,i.hooks[r])(i.pipelinedValue),i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(const r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(const r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),n&&dr(_t.AfterRenderHooksEnd)}register(n){const{view:r}=n;void 0!==r?((r[25]??=[]).push(n),gt(r),r[2]|=8192):this.executing?this.deferredRegistrations.add(n):this.addSequence(n)}addSequence(n){this.sequences.add(n),this.scheduler.notify(7)}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}maybeTrace(n,r){return r?r.run(KT.AFTER_NEXT_RENDER,n):n()}static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new e})}return e})();class X2{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,n,r,i,o,a=null){this.impl=t,this.hooks=n,this.view=r,this.once=i,this.snapshot=a,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();const t=this.view?.[25];t&&(this.view[25]=t.filter(n=>n!==this))}}function iu(e,t){const n=t?.injector??Z(En);return qo("NgAfterNextRender"),function Q2(e,t,n,r){const i=t.get(K2);i.impl??=t.get(N7);const o=t.get(w_,null,{optional:!0}),a=!0!==n?.manualCleanup?t.get(tr):null,c=t.get(ev,null,{optional:!0}),p=new X2(i.impl,function F7(e){return e instanceof Function?[void 0,void 0,e,void 0]:[e.earlyRead,e.write,e.mixedReadWrite,e.read]}(e),c?.view,r,a,o?.snapshot(null));return i.impl.register(p),p}(e,n,t,!0)}const Ox=new Le("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:Z(Fr)})});function J2(e,t,n){const r=e.get(Ox);if(Array.isArray(t))for(const i of t)r.queue.add(i),n?.detachedLeaveAnimationFns?.push(i);else r.queue.add(t),n?.detachedLeaveAnimationFns?.push(t);r.scheduler&&r.scheduler(e)}function eL(e,t,n,r){const i=e?.[26]?.enter;null!==t&&i&&i.has(n.index)&&function YT(e,t){for(const[n,r]of t)J2(e,r.animateFns)}(r,i)}function x_(e,t,n,r,i,o,a,c){if(null!=i){let p,_=!1;uo(i)?p=i:_n(i)&&(_=!0,i=i[0]);const x=L(i);0===e&&null!==r?(eL(c,r,o,n),null==a?A2(t,r,x):pm(t,r,x,a||null,!0)):1===e&&null!==r?(eL(c,r,o,n),pm(t,r,x,a||null,!0)):2===e?rL(c,o,n,D=>{kv(t,x,_,D)}):3===e&&rL(c,o,n,()=>{t.destroyNode(x)}),null!=p&&function G7(e,t,n,r,i,o,a){const c=r[7];c!==L(r)&&x_(t,e,n,o,c,i,a);for(let _=10;_<r.length;_++){const x=r[_];Fx(x[1],x,e,t,o,c)}}(t,e,n,p,o,r,a)}}function nL(e,t){t[10].changeDetectionScheduler?.notify(9),Fx(e,t,t[11],2,null,null)}function XT(e,t){const n=e[9],r=n.indexOf(t);n.splice(r,1)}function Mv(e,t){if(Ss(t))return;const n=t[11];n.destroyNode&&Fx(e,t,n,3,null,null),function U7(e){let t=e[12];if(!t)return QT(e[1],e);for(;t;){let n=null;if(_n(t))n=t[12];else{const r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)_n(t)&&QT(t[1],t),t=t[3];null===t&&(t=e),_n(t)&&QT(t[1],t),n=t&&t[4]}t=n}}(t)}function QT(e,t){if(Ss(t))return;const n=yt(null);try{t[2]&=-129,t[2]|=256,t[24]&&_s(t[24]),function $7(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const i=t[n[r]];if(!(i instanceof Xp)){const o=n[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const c=i[o[a]],p=o[a+1];dr(_t.LifecycleHookStart,c,p);try{p.call(c)}finally{dr(_t.LifecycleHookEnd,c,p)}}else{dr(_t.LifecycleHookStart,i,o);try{o.call(i)}finally{dr(_t.LifecycleHookEnd,i,o)}}}}}(e,t),function H7(e,t){const n=e.cleanup,r=t[7];if(null!==n)for(let a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){const c=n[a+3];c>=0?r[c]():r[-c].unsubscribe(),a+=2}else n[a].call(r[n[a+1]]);null!==r&&(t[7]=null);const i=t[21];if(null!==i){t[21]=null;for(let a=0;a<i.length;a++)(0,i[a])()}const o=t[23];if(null!==o){t[23]=null;for(const a of o)a.destroy()}}(e,t),1===t[1].type&&t[11].destroy();const r=t[16];if(null!==r&&uo(t[3])){r!==t[3]&&XT(r,t);const i=t[18];null!==i&&i.detachView(e)}V(t)}finally{yt(n)}}function rL(e,t,n,r){const i=e?.[26];if(null==i||null==i.leave||!i.leave.has(t.index))return r(!1);e&&gm.add(e[19]),J2(n,()=>{if(i.leave&&i.leave.has(t.index)){const a=i.leave.get(t.index),c=[];if(a){for(let p=0;p<a.animateFns.length;p++){const _=a.animateFns[p],{promise:x}=_();c.push(x)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(c),function j7(e,t){const n=e[26]?.running;n?n.then(()=>{e[26].running=void 0,gm.delete(e[19]),t(!0)}):t(!1)}(e,r)}else e&&gm.delete(e[19]),r(!1)},i)}function JT(e,t,n){return function iL(e,t,n){let r=t;for(;null!==r&&168&r.type;)r=(t=r).parent;if(null===r)return n[0];if(Ji(r)){const{encapsulation:i}=e.data[r.directiveStart+r.componentOffset];if(i===fc.None||i===fc.Emulated)return null}return j(r,n)}(e,t.parent,n)}function oL(e,t,n){return aL(e,t,n)}let aL=function sL(e,t,n){return 40&e.type?j(e,n):null};function tS(e,t,n,r){const i=JT(e,r,t),o=t[11],c=oL(r.parent||t[5],r,t);if(null!=i)if(Array.isArray(n))for(let p=0;p<n.length;p++)R2(o,i,n[p],c,!1);else R2(o,i,n,c,!1)}function _m(e,t){if(null!==t){const n=t.type;if(3&n)return j(t,e);if(4&n)return Lx(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return _m(e,r);{const i=e[t.index];return uo(i)?Lx(-1,i):L(i)}}if(128&n)return _m(e,t.next);if(32&n)return ZT(t,e)()||L(e[t.index]);{const r=cL(e,t);return null!==r?Array.isArray(r)?r[0]:_m(ln(e[15]),r):_m(e,t.next)}}return null}function cL(e,t){return null!==t?e[15][5].projection[t.projection]:null}function Lx(e,t){const n=10+e+1;if(n<t.length){const r=t[n],i=r[1].firstChild;if(null!==i)return _m(r,i)}return t[7]}function nS(e,t,n,r,i,o,a){for(;null!=n;){const c=r[9];if(128===n.type){n=n.next;continue}const p=r[n.index],_=n.type;if(a&&0===t&&(p&&fe(L(p),r),n.flags|=2),!ah(n))if(8&_)nS(e,t,n.child,r,i,o,!1),x_(t,e,c,i,p,n,o,r);else if(32&_){const x=ZT(n,r);let D;for(;D=x();)x_(t,e,c,i,D,n,o,r);x_(t,e,c,i,p,n,o,r)}else 16&_?uL(e,t,r,n,i,o):x_(t,e,c,i,p,n,o,r);n=a?n.projectionNext:n.next}}function Fx(e,t,n,r,i,o){nS(n,r,e.firstChild,t,i,o,!1)}function uL(e,t,n,r,i,o){const a=n[15],p=a[5].projection[r.projection];if(Array.isArray(p))for(let _=0;_<p.length;_++)x_(t,e,n[9],i,p[_],r,o,n);else{let _=p;const x=a[3];m(r)&&(_.flags|=128),nS(e,t,_,x,i,o,!0)}}function dL(e,t,n,r,i){const o=to(),a=2&r;try{$u(-1),a&&t.length>27&&$2(e,t,27,!1),dr(a?_t.TemplateUpdateStart:_t.TemplateCreateStart,i,n),n(r,i)}finally{$u(o),dr(a?_t.TemplateUpdateEnd:_t.TemplateCreateEnd,i,n)}}function Bx(e,t,n){(function Q7(e,t,n){const r=n.directiveStart,i=n.directiveEnd;Ji(n)&&function k7(e,t,n){const r=j(t,e),i=function H2(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=$T(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}(n),o=e[10].rendererFactory,a=GT(e,Rx(e,i,null,qT(n),r,t,null,o.createRenderer(r,n),null,null,null));e[t.index]=a}(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||Kc(n,t);const o=n.initialInputs;for(let a=r;a<i;a++){const c=e.data[a],p=Tf(t,e,a,n);fe(p,t),null!==o&&n9(0,a-r,p,c,0,o),is(c)&&(ie(n.index,t)[8]=Tf(t,e,a,n))}})(e,t,n),!(64&~n.flags)&&function J7(e,t,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,a=function Hd(){return Ye.lFrame.currentDirectiveIndex}();try{$u(o);for(let c=r;c<i;c++){const p=e.data[c],_=t[c];Wc(c),(null!==p.hostBindings||0!==p.hostVars||null!==p.hostAttrs)&&e9(p,_)}}finally{$u(-1),Wc(a)}}(e,t,n)}function E_(e,t,n=j){const r=t.localNames;if(null!==r){let i=t.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],c=-1===a?n(t,e):e[a];e[i++]=c}}}let hL=()=>null;function Vx(e,t,n,r,i,o){Hx(e,t[1],t,n,r)?Ji(e)&&function fL(e,t){const n=ie(t,e);16&n[2]||(n[2]|=64)}(t,e.index):(3&e.type&&(n=function X7(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(n)),rS(e,t,n,r,i,o))}function rS(e,t,n,r,i,o){if(3&e.type){const a=j(e,t);r=null!=o?o(r,e.value||"",n):r,i.setProperty(a,n,r)}}function e9(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function iS(e,t){const n=e.directiveRegistry;let r=null;if(n)for(let i=0;i<n.length;i++){const o=n[i];U2(t,o.selectors,!1)&&(r??=[],is(o)?r.unshift(o):r.push(o))}return r}function n9(e,t,n,r,i,o){const a=o[t];if(null!==a)for(let c=0;c<a.length;c+=2)mm(r,n,a[c],a[c+1])}function Ux(e,t,n,r,i){const o=27+n,a=t[1],c=i(a,t,e,r,n);t[o]=c,Is(e,!0);const p=2===e.type;return p?(P2(t[11],c,e),(0===function Tt(){return Ye.lFrame.elementDepthCount}()||zi(e))&&fe(c,t),function Jn(){Ye.lFrame.elementDepthCount++}()):fe(c,t),Ng()&&(!p||!ah(e))&&tS(a,t,c,e),e}function jx(e){let t=e;return qc()?ra():(t=t.parent,Is(t,!1)),t}function Hx(e,t,n,r,i){const o=e.inputs?.[r],a=e.hostDirectiveInputs?.[r];let c=!1;if(a)for(let p=0;p<a.length;p+=2){const _=a[p];mm(t.data[_],n[_],a[p+1],i),c=!0}if(o)for(const p of o)mm(t.data[p],n[p],r,i),c=!0;return c}function i9(e,t){const n=ie(t,e),r=n[1];!function o9(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n);const i=n[0];null!==i&&null===n[6]&&(n[6]=null),dr(_t.ComponentStart);try{$x(r,n,n[8])}finally{dr(_t.ComponentEnd,n[8])}}function $x(e,t,n){Og(t);try{const r=e.viewQuery;null!==r&&PT(1,r,n);const i=e.template;null!==i&&dL(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),t[18]?.finishViewCreation(e),e.staticContentQueries&&d2(e,t),e.staticViewQueries&&PT(2,e.viewQuery,n);const o=e.components;null!==o&&function s9(e,t){for(let n=0;n<t.length;n++)i9(e,t[n])}(t,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,Hp()}}function C_(e,t,n,r){const i=yt(null);try{const o=t.tView,p=Rx(e,o,n,4096&e[2]?4096:16,null,t,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);p[16]=e[t.index];const x=e[18];return null!==x&&(p[18]=x.createEmbeddedView(o)),$x(o,p,n),p}finally{yt(i)}}function ym(e,t){return!t||null===t.firstChild||m(e)}function Pv(e,t,n,r,i=!1){for(;null!==n;){if(128===n.type){n=i?n.projectionNext:n.next;continue}const o=t[n.index];null!==o&&r.push(L(o)),uo(o)&&a9(o,r);const a=n.type;if(8&a)Pv(e,t,n.child,r);else if(32&a){const c=ZT(n,t);let p;for(;p=c();)r.push(p)}else if(16&a){const c=cL(t,n);if(Array.isArray(c))r.push(...c);else{const p=ln(t[15]);Pv(p[1],p,c,r,!0)}}n=i?n.projectionNext:n.next}return r}function a9(e,t){for(let n=10;n<e.length;n++){const r=e[n],i=r[1].firstChild;null!==i&&Pv(r[1],r,i,t)}e[7]!==e[0]&&t.push(e[7])}function gL(e){if(null!==e[25]){for(const t of e[25])t.impl.addSequence(t);e[25].length=0}}let _L=[];const d9={...Pl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{gt(e.lView)},consumerOnSignalRead(){this.lView[24]=this}},f9={...Pl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{let t=ln(e.lView);for(;t&&!yL(t[1]);)t=ln(t);t&&Ne(t)},consumerOnSignalRead(){this.lView[24]=this}};function yL(e){return 2!==e.type}function vL(e){if(null===e[23])return;let t=!0;for(;t;){let n=!1;for(const r of e[23])r.dirty&&(n=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));t=n&&!!(8192&e[2])}}function qx(e,t=0){const r=e[10].rendererFactory;r.begin?.();try{!function m9(e,t){const n=tc();try{Sr(!0),sS(e,t);let r=0;for(;He(e);){if(100===r)throw new se(103,!1);r++,sS(e,1)}}finally{Sr(n)}}(e,t)}finally{r.end?.()}}function bL(e,t,n,r){if(Ss(t))return;const i=t[2];Og(t);let c=!0,p=null,_=null;yL(e)?(_=function l9(e){return e[24]??function c9(e){const t=_L.pop()??Object.create(d9);return t.lView=e,t}(e)}(t),p=Yo(_)):null===function Vt(){return Gi}()?(c=!1,_=function h9(e){const t=e[24]??Object.create(f9);return t.lView=e,t}(t),p=Yo(_)):t[24]&&(_s(t[24]),t[24]=null);try{ke(t),function Hu(e){return Ye.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&dL(e,t,n,2,r);const x=!(3&~i);if(x){const O=e.preOrderCheckHooks;null!==O&&Kp(t,O,null)}else{const O=e.preOrderHooks;null!==O&&Yp(t,O,0,null),ov(t,0)}if(function g9(e){for(let t=Yt(e);null!==t;t=vn(t)){if(!(2&t[2]))continue;const n=t[9];for(let r=0;r<n.length;r++)Ne(n[r])}}(t),vL(t),wL(t,0),null!==e.contentQueries&&d2(e,t),x){const O=e.contentCheckHooks;null!==O&&Kp(t,O)}else{const O=e.contentHooks;null!==O&&Yp(t,O,1),ov(t,1)}!function y9(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)$u(~i);else{const o=i,a=n[++r],c=n[++r];Mg(a,o);const p=t[o];dr(_t.HostBindingsUpdateStart,p);try{c(2,p)}finally{dr(_t.HostBindingsUpdateEnd,p)}}}}finally{$u(-1)}}(e,t);const D=e.components;null!==D&&EL(t,D,0);const A=e.viewQuery;if(null!==A&&PT(2,A,r),x){const O=e.viewCheckHooks;null!==O&&Kp(t,O)}else{const O=e.viewHooks;null!==O&&Yp(t,O,2),ov(t,2)}if(!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[22]){for(const O of t[22])O();t[22]=null}gL(t),t[2]&=-73}catch(x){throw gt(t),x}finally{null!==_&&(ga(_,p),c&&function u9(e){e.lView[24]!==e&&(e.lView=null,_L.push(e))}(_)),Hp()}}function wL(e,t){for(let n=Yt(e);null!==n;n=vn(n))for(let r=10;r<n.length;r++)xL(n[r],t)}function _9(e,t,n){dr(_t.ComponentStart);const r=ie(t,e);try{xL(r,n)}finally{dr(_t.ComponentEnd,r[8])}}function xL(e,t){me(e)&&sS(e,t)}function sS(e,t){const r=e[1],i=e[2],o=e[24];let a=!!(0===t&&16&i);if(a||=!!(64&i&&0===t),a||=!!(1024&i),a||=!(!o?.dirty||!Ai(o)),a||=!1,o&&(o.dirty=!1),e[2]&=-9217,a)bL(r,e,r.template,e[8]);else if(8192&i){const c=yt(null);try{vL(e),wL(e,1);const p=r.components;null!==p&&EL(e,p,1),gL(e)}finally{yt(c)}}}function EL(e,t,n){for(let r=0;r<t.length;r++)_9(e,t[r],n)}function D_(e,t){const n=tc()?64:1088;for(e[10].changeDetectionScheduler?.notify(t);e;){e[2]|=n;const r=ln(e);if(os(e)&&!r)return e;e=r}return null}function CL(e,t,n,r){return[e,!0,0,t,null,r,null,n,null,null]}function DL(e,t){const n=10+t;if(n<e.length)return e[n]}function T_(e,t,n,r=!0){const i=t[1];if(function v9(e,t,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=t),r<o-10?(t[4]=n[i],Nu(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const a=t[16];null!==a&&n!==a&&TL(a,t);const c=t[18];null!==c&&c.insertView(e),rt(t),t[2]|=128}(i,t,e,n),r){const a=Lx(n,e),c=t[11],p=c.parentNode(e[7]);null!==p&&function z7(e,t,n,r,i,o){r[0]=i,r[5]=t,Fx(e,r,n,1,i,o)}(i,e[5],c,t,p,a)}const o=t[6];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function aS(e,t){const n=Ov(e,t);return void 0!==n&&Mv(n[1],n),n}function Ov(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const i=r[16];null!==i&&i!==e&&XT(i,r),t>0&&(e[n-1][4]=r[4]);const o=ts(e,10+t);!function tL(e,t){nL(e,t),t[0]=null,t[5]=null}(r[1],r);const a=o[18];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function TL(e,t){const n=e[9],r=t[3];(_n(r)||t[15]!==r[3][15])&&(e[2]|=2),null===n?e[9]=[t]:n.push(t)}class Nv{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){const t=this._lView,n=t[1];return Pv(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return Ss(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(uo(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&(Ov(t,r),ts(n,r))}this._attachedToViewContainer=!1}Mv(this._lView[1],this._lView)}onDestroy(t){bt(this._lView,t)}markForCheck(){D_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[2]&=-129}reattach(){rt(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,qx(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const t=os(this._lView),n=this._lView[16];null!==n&&!t&&XT(n,this._lView),nL(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new se(902,!1);this._appRef=t;const n=os(this._lView),r=this._lView[16];null!==r&&!n&&TL(r,this._lView),rt(this._lView)}}let yl=(()=>class e{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=b9;constructor(n,r,i){this._declarationLView=n,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,r){return this.createEmbeddedViewImpl(n,r)}createEmbeddedViewImpl(n,r,i){const o=C_(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:r,dehydratedView:i});return new Nv(o)}})();function b9(){return Gx($t(),Ae())}function Gx(e,t){return 4&e.type?new yl(t,e,eh(e,t)):null}function vm(e,t,n,r,i){let o=e.data[t];if(null===o)o=function dS(e,t,n,r,i){const o=$c(),a=qc(),p=e.data[t]=function k9(e,t,n,r,i,o){let a=t?t.injectorIndex:-1,c=0;return ui()&&(c|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:c,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,n,t,r,i);return function I9(e,t,n,r){null===e.firstChild&&(e.firstChild=t),null!==n&&(r?null==n.child&&null!==t.parent&&(n.child=t):null===n.next&&(n.next=t,t.prev=n))}(e,p,o,a),p}(e,t,n,r,i),function gf(){return Ye.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const a=function na(){const e=Ye.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return Is(o,!0),o}function qL(e,t){let n=0,r=e.firstChild;if(r){const i=e.data.r;for(;n<i;){const o=r.nextSibling;kv(t,r,!1),r=o,n++}}}let dZ=class{},XL=class{};class hZ{resolveComponentFactory(t){throw new se(917,!1)}}let eE=class{static NULL=new hZ};class vl{}let za=(()=>class e{destroyNode=null;static __NG_ELEMENT_ID__=()=>function fZ(){const e=Ae(),n=ie($t().index,e);return(_n(n)?n:e)[11]}()})(),pZ=(()=>{class e{static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>null})}return e})();const vS={};class I_{injector;parentInjector;constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){const i=this.injector.get(t,vS,r);return i!==vS||n===vS?i:this.parentInjector.get(t,n,r)}}function nE(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,o=0;if(null!==t)for(let a=0;a<t.length;a++){const c=t[a];"number"==typeof c?o=c:1==o?i=an(i,c):2==o&&(r=an(r,c+": "+t[++a]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}function Re(e,t=0){const n=Ae();return null===n?Ct(e,t):rx($t(),n,cn(e),t)}function eF(e,t,n,r,i){const o=null===r?null:{"":-1},a=i(e,n);if(null!==a){let c=a,p=null,_=null;for(const x of a)if(null!==x.resolveHostDirectives){[c,p,_]=x.resolveHostDirectives(a);break}!function bZ(e,t,n,r,i,o,a){const c=r.length;let p=null;for(let A=0;A<c;A++){const O=r[A];null===p&&is(O)&&(p=O,vZ(e,n,A)),Jp(Kc(n,t),e,O.type)}(function TZ(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t})(n,e.data.length,c),p?.viewProvidersResolver&&p.viewProvidersResolver(p);for(let A=0;A<c;A++){const O=r[A];O.providersResolver&&O.providersResolver(O)}let _=!1,x=!1,D=Rv(e,t,c,null);c>0&&(n.directiveToIndex=new Map);for(let A=0;A<c;A++){const O=r[A];if(n.mergedAttrs=Cf(n.mergedAttrs,O.hostAttrs),xZ(e,n,t,D,O),DZ(D,O,i),null!==a&&a.has(O)){const[Q,oe]=a.get(O);n.directiveToIndex.set(O.type,[D,Q+n.directiveStart,oe+n.directiveStart])}else(null===o||!o.has(O))&&n.directiveToIndex.set(O.type,D);null!==O.contentQueries&&(n.flags|=4),(null!==O.hostBindings||null!==O.hostAttrs||0!==O.hostVars)&&(n.flags|=64);const B=O.type.prototype;!_&&(B.ngOnChanges||B.ngOnInit||B.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),_=!0),!x&&(B.ngOnChanges||B.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),x=!0),D++}!function wZ(e,t,n){for(let r=t.directiveStart;r<t.directiveEnd;r++){const i=e.data[r];if(null!==n&&n.has(i)){const o=n.get(i);nF(0,t,o,r),nF(1,t,o,r),iF(t,r,!0)}else tF(0,t,i,r),tF(1,t,i,r),iF(t,r,!1)}}(e,n,o)}(e,t,n,c,o,p,_)}null!==o&&null!==r&&function yZ(e,t,n){const r=e.localNames=[];for(let i=0;i<t.length;i+=2){const o=n[t[i+1]];if(null==o)throw new se(-301,!1);r.push(t[i],o)}}(n,r,o)}function vZ(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function tF(e,t,n,r){const i=0===e?n.inputs:n.outputs;for(const o in i)if(i.hasOwnProperty(o)){let a;a=0===e?t.inputs??={}:t.outputs??={},a[o]??=[],a[o].push(r),rF(t,o)}}function nF(e,t,n,r){const i=0===e?n.inputs:n.outputs;for(const o in i)if(i.hasOwnProperty(o)){const a=i[o];let c;c=0===e?t.hostDirectiveInputs??={}:t.hostDirectiveOutputs??={},c[a]??=[],c[a].push(r,o),rF(t,a)}}function rF(e,t){"class"===t?e.flags|=8:"style"===t&&(e.flags|=16)}function iF(e,t,n){const{attrs:r,inputs:i,hostDirectiveInputs:o}=e;if(null===r||!n&&null===i||n&&null===o||HT(e))return e.initialInputs??=[],void e.initialInputs.push(null);let a=null,c=0;for(;c<r.length;){const p=r[c];if(0!==p)if(5!==p){if("number"==typeof p)break;if(!n&&i.hasOwnProperty(p)){const _=i[p];for(const x of _)if(x===t){a??=[],a.push(p,r[c+1]);break}}else if(n&&o.hasOwnProperty(p)){const _=o[p];for(let x=0;x<_.length;x+=2)if(_[x]===t){a??=[],a.push(_[x+1],r[c+1]);break}}c+=2}else c+=2;else c+=4}e.initialInputs??=[],e.initialInputs.push(a)}function xZ(e,t,n,r,i){e.data[r]=i;const o=i.factory||(i.factory=ka(i.type)),a=new Xp(o,is(i),Re,null);e.blueprint[r]=a,n[r]=a,function EZ(e,t,n,r,i){const o=i.hostBindings;if(o){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const c=~t.index;(function CZ(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(a)!=c&&a.push(c),a.push(n,r,o)}}(e,t,r,Rv(e,n,i.hostVars,kr),i)}function DZ(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;is(t)&&(n[""]=e)}}function bS(e,t,n,r,i,o,a,c){const p=t[1],_=p.consts,D=vm(p,e,n,r,Ee(_,a));return o&&eF(p,t,D,Ee(_,c),i),D.mergedAttrs=Cf(D.mergedAttrs,D.attrs),null!==D.attrs&&nE(D,D.attrs,!1),null!==D.mergedAttrs&&nE(D,D.mergedAttrs,!0),null!==p.queries&&p.queries.elementStart(p,D),D}function wS(e,t){Hg(e,t),zu(t)&&e.queries.elementEnd(t)}function id(e,t,n){return e[t]=n}function ni(e,t,n){return n!==kr&&(!Object.is(e[t],n)&&(e[t]=n,!0))}function xm(e,t,n,r){const i=ni(e,t,n);return ni(e,t+1,r)||i}function hh(e,t,n){return function r(i){D_(Ji(e)?ie(e.index,t):t,5);const a=t[8];let c=aF(t,a,n,i),p=r.__ngNextListenerFn__;for(;p;)c=aF(t,a,p,i)&&c,p=p.__ngNextListenerFn__;return c}}function aF(e,t,n,r){const i=yt(null);try{return dr(_t.OutputStart,t,n),!1!==n(r)}catch(o){return function oS(e,t){const n=e[9];if(!n)return;let r;try{r=n.get(hl,null)}catch{r=null}r?.(t)}(e,o),!1}finally{dr(_t.OutputEnd,t,n),yt(i)}}function oE(e,t,n,r,i,o,a,c){const p=zi(e);let _=!1,x=null;if(!r&&p&&(x=function RZ(e,t,n,r){const i=e.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===n&&i[o+1]===r){const c=t[7],p=i[o+2];return c&&c.length>p?c[p]:null}"string"==typeof a&&(o+=2)}return null}(t,n,o,e.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=a,x.__ngLastListenerFn__=a,_=!0;else{const D=j(e,n),A=r?r(D):D,O=i.listen(A,o,c);(function AZ(e){return e.startsWith("animation")||e.startsWith("transition")})(o)||lF(r?Q=>r(L(Q[e.index])):e.index,t,n,o,c,O,!1)}return _}function lF(e,t,n,r,i,o,a){const c=t.firstCreatePass?Ht(t):null,p=st(n),_=p.length;p.push(i,o),c&&c.push(r,e,_,(_+1)*(a?-1:1))}function k_(e,t,n,r,i,o){const c=t[1],D=t[n][c.data[n].outputs[r]].subscribe(o);lF(e.index,c,t,i,o,D,!0)}const fh=Symbol("BINDING");class dF extends eE{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=en(t);return new Gv(n,this.ngModule)}}class Gv extends XL{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function VZ(e){return Object.keys(e).map(t=>{const[n,r,i]=e[t],o={propName:n,templateName:t,isSignal:0!==(r&Mx.SignalBased)};return i&&(o.transform=i),o})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function zZ(e){return Object.keys(e).map(t=>({propName:e[t],templateName:t}))}(this.componentDef.outputs),this.cachedOutputs}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function T7(e){return e.map(D7).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!n}create(t,n,r,i,o,a){dr(_t.DynamicComponentStart);const c=yt(null);try{const p=this.componentDef,_=function qZ(e,t,n,r){const i=e?["ng-version","21.1.2"]:function S7(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!ru(i))break;i=o}r++}return n.length&&t.push(1,...n),t}(t.selectors[0]);let o=null,a=null,c=0;if(n)for(const x of n)c+=x[fh].requiredVars,x.create&&(x.targetIdx=0,(o??=[]).push(x)),x.update&&(x.targetIdx=0,(a??=[]).push(x));if(r)for(let x=0;x<r.length;x++){const D=r[x];if("function"!=typeof D)for(const A of D.bindings){c+=A[fh].requiredVars;const O=x+1;A.create&&(A.targetIdx=O,(o??=[]).push(A)),A.update&&(A.targetIdx=O,(a??=[]).push(A))}}const p=[t];if(r)for(const x of r){const A=Jr("function"==typeof x?x:x.type);p.push(A)}return $T(0,null,function GZ(e,t){return e||t?n=>{if(1&n&&e)for(const r of e)r.create();if(2&n&&t)for(const r of t)r.update()}:null}(o,a),1,c,p,null,null,null,[i],null)}(r,p,a,o),x=function UZ(e,t,n){let r=t instanceof Fr?t:t?.injector;return r&&null!==e.getStandaloneInjector&&(r=e.getStandaloneInjector(r)||r),r?new I_(n,r):n}(p,i||this.ngModule,t),D=function jZ(e){const t=e.get(vl,null);if(null===t)throw new se(407,!1);return{rendererFactory:t,sanitizer:e.get(pZ,null),changeDetectionScheduler:e.get(vf,null),ngReflect:!1}}(x),A=D.rendererFactory.createRenderer(null,p),O=r?function Z7(e,t,n,r){const o=r.get(om,!1)||n===fc.ShadowDom||n===fc.ExperimentalIsolatedShadowDom,a=e.selectRootElement(t,o);return function K7(e){hL(e)}(a),a}(A,r,p.encapsulation,x):function HZ(e,t){const n=function $Z(e){return(e.selectors[0][0]||"div").toLowerCase()}(e);return kx(t,n,"svg"===n?"svg":"math"===n?"math":null)}(p,A),B=a?.some(hF)||o?.some(ye=>"function"!=typeof ye&&ye.bindings.some(hF)),Q=Rx(null,_,null,512|qT(p),null,null,D,A,x,null,null);Q[27]=O,Og(Q);let oe=null;try{const ye=bS(27,Q,2,"#host",()=>_.directiveRegistry,!0,0);P2(A,O,ye),fe(O,Q),Bx(_,Q,ye),OT(_,ye,Q),wS(_,ye),void 0!==n&&function ZZ(e,t,n){const r=e.projection=[];for(let i=0;i<t.length;i++){const o=n[i];r.push(null!=o&&o.length?Array.from(o):null)}}(ye,this.ngContentSelectors,n),oe=ie(ye.index,Q),Q[8]=oe[8],$x(_,Q,null)}catch(ye){throw null!==oe&&V(oe),V(Q),ye}finally{dr(_t.DynamicComponentEnd),Hp()}return new WZ(this.componentType,Q,!!B)}finally{yt(c)}}}function hF(e){const t=e[fh].kind;return"input"===t||"twoWay"===t}class WZ extends dZ{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,n,r){super(),this._rootLView=n,this._hasInputBindings=r,this._tNode=J(n[1],27),this.location=eh(this._tNode,n),this.instance=ie(this._tNode.index,n)[8],this.hostView=this.changeDetectorRef=new Nv(n,void 0),this.componentType=t}setInput(t,n){const r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const i=this._rootLView;Hx(r,i[1],i,t,n),this.previousInputValues.set(t,n),D_(ie(r.index,i),1)}get injector(){return new ti(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}let bl=(()=>class e{static __NG_ELEMENT_ID__=KZ})();function KZ(){return mF($t(),Ae())}const YZ=bl,fF=class extends YZ{_lContainer;_hostTNode;_hostLView;constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return eh(this._hostTNode,this._hostLView)}get injector(){return new ti(this._hostTNode,this._hostLView)}get parentInjector(){const t=Zg(this._hostTNode,this._hostLView);if(Xu(t)){const n=Xd(t,this._hostLView),r=Yd(t);return new ti(n[1].data[r+8],n)}return new ti(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=pF(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,r){let i,o;"number"==typeof r?i=r:null!=r&&(i=r.index,o=r.injector);const c=t.createEmbeddedViewImpl(n||{},o,null);return this.insertImpl(c,i,ym(this._hostTNode,null)),c}createComponent(t,n,r,i,o,a,c){const p=t&&!function Zu(e){return"function"==typeof e}(t);let _;if(p)_=n;else{const oe=n||{};_=oe.index,r=oe.injector,i=oe.projectableNodes,o=oe.environmentInjector||oe.ngModuleRef,a=oe.directives,c=oe.bindings}const x=p?t:new Gv(en(t)),D=r||this.parentInjector;if(!o&&null==x.ngModule){const ye=(p?D:this.parentInjector).get(Fr,null);ye&&(o=ye)}en(x.componentType??{});const Q=x.create(D,i,null,o,a,c);return this.insertImpl(Q.hostView,_,ym(this._hostTNode,null)),Q}insert(t,n){return this.insertImpl(t,n,!0)}insertImpl(t,n,r){const i=t._lView;if(function Ie(e){return uo(e[3])}(i)){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const p=i[3],_=new fF(p,p[5],p[3]);_.detach(_.indexOf(t))}}const o=this._adjustIndex(n),a=this._lContainer;return T_(a,i,o,r),t.attachToViewContainerRef(),Nu(ES(a),o,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=pF(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=Ov(this._lContainer,n);r&&(ts(ES(this._lContainer),n),Mv(r[1],r))}detach(t){const n=this._adjustIndex(t,-1),r=Ov(this._lContainer,n);return r&&null!=ts(ES(this._lContainer),n)?new Nv(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function pF(e){return e[8]}function ES(e){return e[8]||(e[8]=[])}function mF(e,t){let n;const r=t[e.index];return uo(r)?n=r:(n=CL(r,t,null,e),t[e.index]=n,GT(t,n)),gF(n,t,e,r),new fF(n,e,t)}let gF=function yF(e,t,n,r){if(e[7])return;let i;i=8&n.type?L(r):function XZ(e,t){const n=e[11],r=n.createComment(""),i=j(t,e),o=n.parentNode(i);return pm(n,o,r,n.nextSibling(i),!1),r}(t,n),e[7]=i};class DS{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new DS(this.queryList)}setDirty(){this.queryList.setDirty()}}class TS{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[];for(let o=0;o<r;o++){const a=n.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new TS(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==RS(t,n).matches&&this.queries[n].setDirty()}}class vF{flags;read;predicate;constructor(t,n,r=null){this.flags=n,this.read=r,this.predicate="string"==typeof t?function iK(e){return e.split(",").map(t=>t.trim())}(t):t}}class SS{queries;constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){const i=null!==n?n.length:0,o=this.getByIndex(r).embeddedTView(t,i);o&&(o.indexInDeclarationView=r,null!==n?n.push(o):n=[o])}return null!==n?new SS(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class IS{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,n=-1){this.metadata=t,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new IS(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1&~this.metadata.flags){const n=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];this.matchTNodeWithReadOption(t,n,eK(n,o)),this.matchTNodeWithReadOption(t,n,Kg(n,t,o,!1,!1))}else r===yl?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,Kg(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Pr||i===bl||i===yl&&4&n.type)this.addMatch(n.index,-2);else{const o=Kg(n,t,i,!1,!1);null!==o&&this.addMatch(n.index,o)}else this.addMatch(n.index,r)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function eK(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function nK(e,t,n,r){return-1===n?function tK(e,t){return 11&e.type?eh(e,t):4&e.type?Gx(e,t):null}(t,e):-2===n?function rK(e,t,n){return n===Pr?eh(t,e):n===yl?Gx(t,e):n===bl?mF(t,e):void 0}(e,t,r):Tf(e,e[1],n,t)}function bF(e,t,n,r){const i=t[18].queries[r];if(null===i.matches){const o=e.data,a=n.matches,c=[];for(let p=0;null!==a&&p<a.length;p+=2){const _=a[p];c.push(_<0?null:nK(t,o[_],a[p+1],n.metadata.read))}i.matches=c}return i.matches}function kS(e,t,n,r){const i=e.queries.getByIndex(n),o=i.matches;if(null!==o){const a=bF(e,t,i,n);for(let c=0;c<o.length;c+=2){const p=o[c];if(p>0)r.push(a[c/2]);else{const _=o[c+1],x=t[-p];for(let D=10;D<x.length;D++){const A=x[D];A[16]===A[3]&&kS(A[1],A,_,r)}if(null!==x[9]){const D=x[9];for(let A=0;A<D.length;A++){const O=D[A];kS(O[1],O,_,r)}}}}}return r}function wF(e,t,n){const r=new Ju(!(4&~n));return function on(e,t,n,r){const i=st(t);i.push(n),e.firstCreatePass&&Ht(e).push(r,i.length-1)}(e,t,r,r.destroy),(t[18]??=new TS).queries.push(new DS(r))-1}function CF(e,t,n){null===e.queries&&(e.queries=new SS),e.queries.track(new IS(t,n))}function RS(e,t){return e.queries.getByIndex(t)}function DF(e,t){const n=e[1],r=RS(n,t);return r.crossesNgTemplate?kS(n,e,t,[]):bF(n,e,r,t)}let ph=class{},RF=class{};class LS extends ph{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new dF(this);constructor(t,n,r,i=!0){super(),this.ngModuleType=t,this._parent=n;const o=es(t);this._bootstrapComponents=rd(o.bootstrap),this._r3Injector=S0(t,n,[{provide:ph,useValue:this},{provide:eE,useValue:this.componentFactoryResolver},...r],gn(t),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class MF extends RF{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new LS(this.moduleType,t,[])}}class PF extends ph{injector;componentFactoryResolver=new dF(this);instance=null;constructor(t){super();const n=new Js([...t.providers,{provide:ph,useValue:this},{provide:eE,useValue:this.componentFactoryResolver}],t.parent||Yl(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function sE(e,t,n=null){return new PF({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}let fK=(()=>{class e{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=jc(0,n.type),i=r.length>0?sE([r],this._injector,""):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Ue({token:e,providedIn:"environment",factory:()=>new e(Ct(Fr))})}return e})();function Er(e){return ic(()=>{const t=NF(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===E.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:t.standalone?i=>i.get(fK).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||fc.Emulated,styles:e.styles||Tr,_:null,schemas:e.schemas||null,tView:null,id:""};t.standalone&&qo("NgStandalone"),LF(n);const r=e.dependencies;return n.directiveDefs=aE(r,OF),n.pipeDefs=aE(r,Xi),n.id=function _K(e){let t=0;const r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,"function"==typeof e.consts?"":e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(const o of r.join("|"))t=Math.imul(31,t)+o.charCodeAt(0)|0;return t+=2147483648,"c"+t}(n),n})}function OF(e){return en(e)||Jr(e)}function _o(e){return ic(()=>({type:e.type,bootstrap:e.bootstrap||Tr,declarations:e.declarations||Tr,imports:e.imports||Tr,exports:e.exports||Tr,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function pK(e,t){if(null==e)return Cs;const n={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];let o,a,c,p;Array.isArray(i)?(c=i[0],o=i[1],a=i[2]??o,p=i[3]||null):(o=i,a=i,c=Mx.None,p=null),n[o]=[r,c,p],t[o]=a}return n}function mK(e){if(null==e)return Cs;const t={};for(const n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function At(e){return ic(()=>{const t=NF(e);return LF(t),t})}function Ua(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:e.standalone??!0,onDestroy:e.type.prototype.ngOnDestroy||null}}function NF(e){const t={};return{type:e.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputConfig:e.inputs||Cs,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:!0===e.signals,selectors:e.selectors||Tr,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:pK(e.inputs,t),outputs:mK(e.outputs),debugInfo:null}}function LF(e){e.features?.forEach(t=>t(e))}function aE(e,t){return e?()=>{const n="function"==typeof e?e():e,r=[];for(const i of n){const o=t(i);null!==o&&r.push(o)}return r}:null}function zn(e){let t=function bK(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let i;if(is(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new se(903,!1);i=t.\u0275dir}if(i){if(n){r.push(i);const a=e;a.inputs=BS(e.inputs),a.declaredInputs=BS(e.declaredInputs),a.outputs=BS(e.outputs);const c=i.hostBindings;c&&DK(e,c);const p=i.viewQuery,_=i.contentQueries;if(p&&EK(e,p),_&&CK(e,_),wK(e,i),Rr(e.outputs,i.outputs),is(i)&&i.data.animation){const x=e.data;x.animation=(x.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let a=0;a<o.length;a++){const c=o[a];c&&c.ngInherit&&c(e),c===zn&&(n=!1)}}t=Object.getPrototypeOf(t)}!function xK(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Cf(i.hostAttrs,n=Cf(n,i.hostAttrs))}}(r)}function wK(e,t){for(const n in t.inputs){if(!t.inputs.hasOwnProperty(n)||e.inputs.hasOwnProperty(n))continue;const r=t.inputs[n];void 0!==r&&(e.inputs[n]=r,e.declaredInputs[n]=t.declaredInputs[n])}}function BS(e){return e===Cs?{}:e===Tr?[]:e}function EK(e,t){const n=e.viewQuery;e.viewQuery=n?(r,i)=>{t(r,i),n(r,i)}:t}function CK(e,t){const n=e.contentQueries;e.contentQueries=n?(r,i,o)=>{t(r,i,o),n(r,i,o)}:t}function DK(e,t){const n=e.hostBindings;e.hostBindings=n?(r,i)=>{t(r,i),n(r,i)}:t}function jF(e,t,n,r,i,o,a,c){if(n.firstCreatePass){e.mergedAttrs=Cf(e.mergedAttrs,e.attrs);const x=e.tView=$T(2,e,i,o,a,n.directiveRegistry,n.pipeRegistry,null,n.schemas,n.consts,null);null!==n.queries&&(n.queries.template(n,e),x.queries=n.queries.embeddedTView(e))}c&&(e.flags|=c),Is(e,!1);const p=$F(n,t,e,r);Ng()&&tS(n,t,p,e),fe(p,t);const _=CL(p,t,p,e);t[r+27]=_,GT(t,_)}function Cm(e,t,n,r,i,o,a,c,p,_,x){const D=n+27;let A;if(t.firstCreatePass){if(A=vm(t,D,4,a||null,c||null),null!=_){const O=Ee(t.consts,_);A.localNames=[];for(let B=0;B<O.length;B+=2)A.localNames.push(O[B],-1)}}else A=t.data[D];return jF(A,e,t,n,r,i,o,p),null!=_&&E_(e,A,x),A}function Zv(e,t,n,r,i,o,a,c){const p=Ae(),_=Lt();return function TK(e,t,n,r,i,o,a,c,p,_,x){const D=n+27;let A;t.firstCreatePass?(A=vm(t,D,4,a||null,c||null),eo()&&eF(t,e,A,Ee(t.consts,_),iS),Hg(t,A)):A=t.data[D],jF(A,e,t,n,r,i,o,p),zi(A)&&Bx(t,e,A),null!=_&&E_(e,A,x)}(p,_,e,t,n,r,i,Ee(_.consts,o),void 0,a,c),Zv}let $F=function qF(e,t,n,r){return $p(!0),t[11].createComment("")};let iB=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function aB(e){return function sB(e){return"function"==typeof e&&void 0!==e[Ve]}(e)&&"function"==typeof e.set}const xB=new Le("");function Jv(e){return!!e&&"function"==typeof e.then}function CB(e){return!!e&&"function"==typeof e.subscribe}const DB=new Le("");function WS(e){return Ra([{provide:DB,multi:!0,useValue:e}])}let TB=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=Z(DB,{optional:!0})??[];injector=Z(En);constructor(){}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const o=Oi(this.injector,i);if(Jv(o))n.push(o);else if(CB(o)){const a=new Promise((c,p)=>{o.subscribe({complete:c,error:p})});n.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const ZS=new Le("");let wl=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Z(hl);afterRenderManager=Z(K2);zonelessEnabled=Z(Gu);rootEffectScheduler=Z(L0);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new K;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=Z(Na);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(ar(n=>!n))}constructor(){Z(w_,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=Z(Fr);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){return this.bootstrapImpl(n,r)}bootstrapImpl(n,r,i=En.NULL){return this._injector.get(Xt).run(()=>{dr(_t.BootstrapComponentStart);const a=n instanceof XL;if(!this._injector.get(TB).done)throw new se(405,"");let p;p=a?n:this._injector.get(eE).resolveComponentFactory(n),this.componentTypes.push(p.componentType);const _=function LY(e){return e.isBoundToModule}(p)?void 0:this._injector.get(ph),D=p.create(i,[],r||p.selector,_),A=D.location.nativeElement,O=D.injector.get(xB,null);return O?.registerApplication(A),D.onDestroy(()=>{this.detachView(D.hostView),mE(this.components,D),O?.unregisterApplication(A)}),this._loadComponent(D),dr(_t.BootstrapComponentEnd,D),D})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){dr(_t.ChangeDetectionStart),null!==this.tracingSnapshot?this.tracingSnapshot.run(KT.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw dr(_t.ChangeDetectionEnd),new se(101,!1);const n=yt(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,yt(n),this.afterTick.next(),dr(_t.ChangeDetectionEnd)}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(vl,null,{optional:!0}));let n=0;for(;0!==this.dirtyFlags&&n++<10;){dr(_t.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{dr(_t.ChangeDetectionSyncEnd)}}}synchronizeOnce(){16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let n=!1;if(7&this.dirtyFlags){const r=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews)(r||He(i))&&(qx(i,r&&!this.zonelessEnabled?0:1),n=!0);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}n||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:n})=>He(n))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;mE(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(n),this._injector.get(ZS,[]).forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>mE(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new se(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function mE(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function $s(e,t,n,r){const i=Ae();return ni(i,Ui(),t)&&(Lt(),function t9(e,t,n,r,i,o){const a=j(e,t);!function zx(e,t,n,r,i,o,a){if(null==o)e.removeAttribute(t,i,n);else{const c=null==a?Zt(o):a(o,r||"",i);e.setAttribute(t,i,c,n)}}(t[11],a,o,e.value,n,r,i)}(So(),i,e,t,n,r)),$s}typeof document<"u"&&document;Object.keys({disabled:"disabled",disabledReasons:"disabledReasons",dirty:"dirty",errors:"errors",hidden:"hidden",invalid:"invalid",max:"max",maxLength:"maxLength",min:"min",minLength:"minLength",name:"name",pattern:"pattern",pending:"pending",readonly:"readonly",required:"required",touched:"touched"});class lQ{destroy(t){}updateValue(t,n){}swap(t,n){const r=Math.min(t,n),i=Math.max(t,n),o=this.detach(i);if(i-r>1){const a=this.detach(r);this.attach(r,o),this.attach(i,a)}else this.attach(r,o)}move(t,n){this.attach(n,this.detach(t))}}function cI(e,t,n,r,i){return e===n&&Object.is(t,r)?1:Object.is(i(e,t),i(n,r))?-1:0}function uI(e,t,n,r){return!(void 0===t||!t.has(r)||(e.attach(n,t.get(r)),t.delete(r),0))}function YB(e,t,n,r,i){if(uI(e,t,r,n(r,i)))e.updateValue(r,i);else{const o=e.create(r,i);e.attach(r,o)}}function XB(e,t,n,r){const i=new Set;for(let o=t;o<=n;o++)i.add(r(o,e.at(o)));return i}class QB{kvMap=new Map;_vMap=void 0;has(t){return this.kvMap.has(t)}delete(t){if(!this.has(t))return!1;const n=this.kvMap.get(t);return void 0!==this._vMap&&this._vMap.has(n)?(this.kvMap.set(t,this._vMap.get(n)),this._vMap.delete(n)):this.kvMap.delete(t),!0}get(t){return this.kvMap.get(t)}set(t,n){if(this.kvMap.has(t)){let r=this.kvMap.get(t);void 0===this._vMap&&(this._vMap=new Map);const i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,n)}else this.kvMap.set(t,n)}forEach(t){for(let[n,r]of this.kvMap)if(t(r,n),void 0!==this._vMap){const i=this._vMap;for(;i.has(r);)r=i.get(r),t(r,n)}}}function hr(e,t,n,r,i,o,a,c){qo("NgControlFlow");const p=Ae(),_=Lt();return Cm(p,_,e,t,n,r,i,Ee(_.consts,o),256,a,c),dI}function dI(e,t,n,r,i,o,a,c){qo("NgControlFlow");const p=Ae(),_=Lt();return Cm(p,_,e,t,n,r,i,Ee(_.consts,o),512,a,c),dI}function fr(e,t){qo("NgControlFlow");const n=Ae(),r=Ui(),i=n[r]!==kr?n[r]:-1,o=-1!==i?TE(n,27+i):void 0;if(ni(n,r,e)){const c=yt(null);try{if(void 0!==o&&aS(o,0),-1!==e){const p=27+e,_=TE(n,p),x=fI(n[1],p),D=null;T_(_,C_(n,x,t,{dehydratedView:D}),0,ym(x,D))}}finally{yt(c)}}else if(void 0!==o){const c=DL(o,0);void 0!==c&&(c[8]=t)}}class uQ{lContainer;$implicit;$index;constructor(t,n,r){this.lContainer=t,this.$implicit=n,this.$index=r}get $count(){return this.lContainer.length-10}}function hI(e){return e}function xl(e,t){return t}class dQ{hasEmptyBlock;trackByFn;liveCollection;constructor(t,n,r){this.hasEmptyBlock=t,this.trackByFn=n,this.liveCollection=r}}function Go(e,t,n,r,i,o,a,c,p,_,x,D,A){qo("NgControlFlow");const O=Ae(),B=Lt(),Q=void 0!==p,oe=Ae(),ye=c?a.bind(oe[15][8]):a,xe=new dQ(Q,ye);oe[27+e]=xe,Cm(O,B,e+1,t,n,r,i,Ee(B.consts,o),256),Q&&Cm(O,B,e+2,p,_,x,D,Ee(B.consts,A),512)}class hQ extends lQ{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(t,n,r){super(),this.lContainer=t,this.hostLView=n,this.templateTNode=r}get length(){return this.lContainer.length-10}at(t){return this.getLView(t)[8].$implicit}attach(t,n){const r=n[6];this.needsIndexUpdate||=t!==this.length,T_(this.lContainer,n,t,ym(this.templateTNode,r)),function fQ(e,t){if(e.length<=10)return;const r=e[10+t],i=r?r[26]:void 0;r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0&&(function B7(e,t){const n=e.get(Ox);if(t.detachedLeaveAnimationFns){for(const r of t.detachedLeaveAnimationFns)n.queue.delete(r);t.detachedLeaveAnimationFns=void 0}}(r[9],i),gm.delete(r[19]),i.detachedLeaveAnimationFns=void 0)}(this.lContainer,t)}detach(t){return this.needsIndexUpdate||=t!==this.length-1,function pQ(e,t){if(e.length<=10)return;const r=e[10+t],i=r?r[26]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}(this.lContainer,t),function mQ(e,t){return Ov(e,t)}(this.lContainer,t)}create(t,n){return C_(this.hostLView,this.templateTNode,new uQ(this.lContainer,n,t),{dehydratedView:null})}destroy(t){Mv(t[1],t)}updateValue(t,n){this.getLView(t)[8].$implicit=n}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let t=0;t<this.length;t++)this.getLView(t)[8].$index=t}getLView(t){return function gQ(e,t){return DL(e,t)}(this.lContainer,t)}}function Wo(e){const t=yt(null),n=to();try{const r=Ae(),i=r[1],o=r[n],a=n+1,c=TE(r,a);if(void 0===o.liveCollection){const _=fI(i,a);o.liveCollection=new hQ(c,r,_)}else o.liveCollection.reset();const p=o.liveCollection;if(function cQ(e,t,n,r){let i,o,a=0,c=e.length-1;if(Array.isArray(t)){yt(r);let _=t.length-1;for(yt(null);a<=c&&a<=_;){const x=e.at(a),D=t[a],A=cI(a,x,a,D,n);if(0!==A){A<0&&e.updateValue(a,D),a++;continue}const O=e.at(c),B=t[_],Q=cI(c,O,_,B,n);if(0!==Q){Q<0&&e.updateValue(c,B),c--,_--;continue}const oe=n(a,x),ye=n(c,O),xe=n(a,D);if(Object.is(xe,ye)){const $e=n(_,B);Object.is($e,oe)?(e.swap(a,c),e.updateValue(c,B),_--,c--):e.move(c,a),e.updateValue(a,D),a++;continue}if(i??=new QB,o??=XB(e,a,c,n),uI(e,i,a,xe))e.updateValue(a,D),a++,c++;else if(o.has(xe))i.set(oe,e.detach(a)),c--;else{const $e=e.create(a,t[a]);e.attach(a,$e),a++,c++}}for(;a<=_;)YB(e,i,n,a,t[a]),a++}else if(null!=t){yt(r);const _=t[Symbol.iterator]();yt(null);let x=_.next();for(;!x.done&&a<=c;){const D=e.at(a),A=x.value,O=cI(a,D,a,A,n);if(0!==O)O<0&&e.updateValue(a,A),a++,x=_.next();else{i??=new QB,o??=XB(e,a,c,n);const B=n(a,A);if(uI(e,i,a,B))e.updateValue(a,A),a++,c++,x=_.next();else if(o.has(B)){const Q=n(a,D);i.set(Q,e.detach(a)),c--}else e.attach(a,e.create(a,A)),a++,c++,x=_.next()}}for(;!x.done;)YB(e,i,n,e.length,x.value),x=_.next()}for(;a<=c;)e.destroy(e.detach(c--));i?.forEach(_=>{e.destroy(_)})}(p,e,o.trackByFn,t),p.updateIndexes(),o.hasEmptyBlock){const _=Ui(),x=0===p.length;if(ni(r,_,x)){const D=n+2,A=TE(r,D);if(x){const O=fI(i,D),B=null;T_(A,C_(r,O,void 0,{dehydratedView:B}),0,ym(O,B))}else i.firstUpdatePass&&function Xx(e){const t=e[6]??[],r=e[3][11],i=[];for(const o of t)void 0!==o.data.di?i.push(o):qL(o,r);e[6]=i}(A),aS(A,0)}}}finally{yt(t)}}function TE(e,t){return e[t]}function fI(e,t){return J(e,t)}function Un(e,t,n){const r=Ae();return ni(r,Ui(),t)&&(Lt(),Vx(So(),r,e,t,r[11],n)),Un}function pI(e,t,n,r,i){Hx(t,e,n,i?"class":"style",r)}function ge(e,t,n,r){const i=Ae(),o=i[1],a=e+27,c=o.firstCreatePass?bS(a,i,2,t,iS,eo(),n,r):o.data[a];if(Ux(c,i,e,t,mI),zi(c)){const p=i[1];Bx(p,i,c),OT(p,c,i)}return null!=r&&E_(i,c),ge}function be(){const e=Lt(),n=jx($t());return e.firstCreatePass&&wS(e,n),di(n)&&ho(),Br(),null!=n.classesWithoutHost&&function $g(e){return!!(8&e.flags)}(n)&&pI(e,n,Ae(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function K0(e){return!!(16&e.flags)}(n)&&pI(e,n,Ae(),n.stylesWithoutHost,!1),be}function pn(e,t,n,r){return ge(e,t,n,r),be(),pn}function jt(e,t,n,r){const i=Ae(),o=i[1],a=e+27,c=o.firstCreatePass?function oF(e,t,n,r,i,o){const a=t.consts,p=vm(t,e,n,r,Ee(a,i));if(p.mergedAttrs=Cf(p.mergedAttrs,p.attrs),null!=o){const _=Ee(a,o);p.localNames=[];for(let x=0;x<_.length;x+=2)p.localNames.push(_[x],-1)}return null!==p.attrs&&nE(p,p.attrs,!1),null!==p.mergedAttrs&&nE(p,p.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,p),p}(a,o,2,t,n,r):o.data[a];return Ux(c,i,e,t,mI),null!=r&&E_(i,c),jt}function Bt(){return di(jx($t()))&&ho(),Br(),Bt}function od(e,t,n,r){return jt(e,t,n,r),Bt(),od}let mI=(e,t,n,r,i)=>($p(!0),kx(t[11],r,function iT(){return Ye.lFrame.currentNamespace}()));function Mo(){return Ae()}function tb(e,t,n){const r=Ae();return ni(r,Ui(),t)&&(Lt(),rS(So(),r,e,t,r[11],n)),tb}const nb=void 0;var bQ=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],nb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],nb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202fa","h:mm:ss\u202fa","h:mm:ss\u202fa z","h:mm:ss\u202fa zzzz"],["{1}, {0}",nb,nb,nb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function vQ(e){const t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let V_={};function aa(e){const t=function xQ(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=iV(t);if(n)return n;const r=t.split("-")[0];if(n=iV(r),n)return n;if("en"===r)return bQ;throw new se(701,!1)}function iV(e){return e in V_||(V_[e]=Jt.ng&&Jt.ng.common&&Jt.ng.common.locales&&Jt.ng.common.locales[e]),V_[e]}var fi=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(fi||{});const IE="en-US";let oV=IE;function tn(e,t,n){const r=Ae(),i=Lt(),o=$t();return wI(i,r,r[11],o,e,t,n),tn}function la(e,t,n){const r=Ae(),i=Lt(),o=$t();return(3&o.type||n)&&oE(o,i,r,n,r[11],e,t,hh(o,r,t)),la}function wI(e,t,n,r,i,o,a){let c=!0,p=null;if((3&r.type||a)&&(p??=hh(r,t,o),oE(r,e,t,a,n,i,o,p)&&(c=!1)),c){const _=r.outputs?.[i],x=r.hostDirectiveOutputs?.[i];if(x&&x.length)for(let D=0;D<x.length;D+=2){const A=x[D],O=x[D+1];p??=hh(r,t,o),k_(r,t,A,O,i,p)}if(_&&_.length)for(const D of _)p??=hh(r,t,o),k_(r,t,D,i,i,p)}}function Et(e=1){return function tT(e){return(Ye.lFrame.contextLView=function Ze(e,t){for(;e>0;)t=t[14],e--;return t}(e,Ye.lFrame.contextLView))[8]}(e)}function cJ(e,t){let n=null;const r=function w7(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(!(1&n))return t[n+1]}return null}(e);for(let i=0;i<t.length;i++){const o=t[i];if("*"!==o){if(null===r?U2(e,o,!0):C7(r,o))return i}else n=i}return n}function ME(e,t=0,n,r,i,o){const a=Ae(),c=Lt(),p=r?e+1:null;null!==p&&Cm(a,c,p,r,i,o,null,n);const _=vm(c,27+e,16,null,n||null);null===_.projection&&(_.projection=t),ra();const D=!a[6]||ui();null===a[15][5].projection[_.projection]&&null!==p?function uJ(e,t,n){const r=27+n,i=t.data[r],o=e[r];T_(o,C_(e,i,void 0,{dehydratedView:null}),0,ym(i,null))}(a,c,p):D&&!ah(_)&&function q7(e,t,n){uL(t[11],0,t,n,JT(e,n,t),oL(n.parent||t[5],n,t))}(c,a,_)}function xI(e,t,n,r){return function EF(e,t,n,r){const i=Lt();if(i.firstCreatePass){const o=$t();CF(i,new vF(t,n,r),o.index),function oK(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(i,e),!(2&~n)&&(i.staticContentQueries=!0)}return wF(i,Ae(),n)}(e,t,n,r),xI}function Mm(e,t,n){return function xF(e,t,n){const r=Lt();return r.firstCreatePass&&(CF(r,new vF(e,t,n),-1),!(2&~t)&&(r.staticViewQueries=!0)),wF(r,Ae(),t)}(e,t,n),Mm}function Zf(e){const t=Ae(),n=Lt(),r=jp();nc(r+1);const i=RS(n,r);if(e.dirty&&function de(e){return!(4&~e[2])}(t)===!(2&~i.metadata.flags)){if(null===i.matches)e.reset([]);else{const o=DF(t,r);e.reset(o,lx),e.notifyOnChanges()}return!0}return!1}function Kf(){return function AS(e,t){return e[18].queries[t].queryList}(Ae(),jp())}function PE(e,t){return e<<17|t<<2}function Pm(e){return e>>17&32767}function EI(e){return 2|e}function z_(e){return(131068&e)>>2}function CI(e,t){return-131069&e|t<<2}function DI(e){return 1|e}function SV(e,t,n,r){const i=e[n+1],o=null===t;let a=r?Pm(i):z_(i),c=!1;for(;0!==a&&(!1===c||o);){const _=e[a+1];yJ(e[a],t)&&(c=!0,e[a+1]=r?DI(_):EI(_)),a=r?Pm(_):z_(_)}c&&(e[n+1]=r?EI(i):DI(i))}function yJ(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&al(e,t)>=0}const Zo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function IV(e){return e.substring(Zo.key,Zo.keyEnd)}function kV(e,t){const n=Zo.textEnd;return n===t?-1:(t=Zo.keyEnd=function xJ(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Zo.key=t,n),U_(e,t,n))}function U_(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function j_(e,t,n){return OV(e,t,n,!1),j_}function El(e,t){return OV(e,t,null,!0),El}function TI(e){!function NV(e,t,n,r){const i=Lt(),o=ul(2);i.firstUpdatePass&&FV(i,null,o,r);const a=Ae();if(n!==kr&&ni(a,o,n)){const c=i.data[to()];if(UV(c,r)&&!LV(i,o)){let p=r?c.classesWithoutHost:c.stylesWithoutHost;null!==p&&(n=an(p,n||"")),pI(i,c,a,n,r)}else!function OJ(e,t,n,r,i,o,a,c){i===kr&&(i=Tr);let p=0,_=0,x=0<i.length?i[0]:null,D=0<o.length?o[0]:null;for(;null!==x||null!==D;){const A=p<i.length?i[p+1]:void 0,O=_<o.length?o[_+1]:void 0;let Q,B=null;x===D?(p+=2,_+=2,A!==O&&(B=D,Q=O)):null===D||null!==x&&x<D?(p+=2,B=x):(_+=2,B=D,Q=O),null!==B&&VV(e,t,n,r,B,Q,a,c),x=p<i.length?i[p]:null,D=_<o.length?o[_]:null}}(i,c,a,a[11],a[o+1],a[o+1]=function MJ(e,t,n){if(null==n||""===n)return Tr;const r=[],i=gl(n);if(Array.isArray(i))for(let o=0;o<i.length;o++)e(r,i[o],!0);else if(i instanceof Set)for(const o of i)e(r,o,!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),r,o)}}(PJ,SJ,e,!0)}function SJ(e,t){for(let n=function bJ(e){return function RV(e){Zo.key=0,Zo.keyEnd=0,Zo.value=0,Zo.valueEnd=0,Zo.textEnd=e.length}(e),kV(e,U_(e,0,Zo.textEnd))}(t);n>=0;n=kV(t,n))Aa(e,IV(t),!0)}function OV(e,t,n,r){const i=Ae(),o=Lt(),a=ul(2);o.firstUpdatePass&&FV(o,e,a,r),t!==kr&&ni(i,a,t)&&VV(o,o.data[to()],i,i[11],e,i[a+1]=function NJ(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=gn(gl(e)))),e}(t,n),r,a)}function LV(e,t){return t>=e.expandoStartIndex}function FV(e,t,n,r){const i=e.data;if(null===i[n+1]){const o=i[to()],a=LV(e,n);UV(o,r)&&null===t&&!a&&(t=!1),t=function IJ(e,t,n,r){const i=function Pg(e){const t=Ye.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=lb(n=SI(null,e,t,n,r),t.attrs,r),o=null);else{const a=t.directiveStylingLast;if(-1===a||e[a]!==i)if(n=SI(i,e,t,n,r),null===o){let p=function kJ(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==z_(r))return e[Pm(r)]}(e,t,r);void 0!==p&&Array.isArray(p)&&(p=SI(null,e,t,p[1],r),p=lb(p,t.attrs,r),function AJ(e,t,n,r){e[Pm(n?t.classBindings:t.styleBindings)]=r}(e,t,r,p))}else o=function RJ(e,t,n){let r;const i=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<i;o++)r=lb(r,e[o].hostAttrs,n);return lb(r,t.attrs,n)}(e,t,r)}return void 0!==o&&(r?t.residualClasses=o:t.residualStyles=o),n}(i,o,t,r),function gJ(e,t,n,r,i,o){let a=o?t.classBindings:t.styleBindings,c=Pm(a),p=z_(a);e[r]=n;let x,_=!1;if(Array.isArray(n)?(x=n[1],(null===x||al(n,x)>0)&&(_=!0)):x=n,i)if(0!==p){const A=Pm(e[c+1]);e[r+1]=PE(A,c),0!==A&&(e[A+1]=CI(e[A+1],r)),e[c+1]=function pJ(e,t){return 131071&e|t<<17}(e[c+1],r)}else e[r+1]=PE(c,0),0!==c&&(e[c+1]=CI(e[c+1],r)),c=r;else e[r+1]=PE(p,0),0===c?c=r:e[p+1]=CI(e[p+1],r),p=r;_&&(e[r+1]=EI(e[r+1])),SV(e,x,r,!0),SV(e,x,r,!1),function _J(e,t,n,r,i){const o=i?e.residualClasses:e.residualStyles;null!=o&&"string"==typeof t&&al(o,t)>=0&&(n[r+1]=DI(n[r+1]))}(t,x,e,r,o),a=PE(c,p),o?t.classBindings=a:t.styleBindings=a}(i,o,t,n,a,r)}}function SI(e,t,n,r,i){let o=null;const a=n.directiveEnd;let c=n.directiveStylingLast;for(-1===c?c=n.directiveStart:c++;c<a&&(o=t[c],r=lb(r,o.hostAttrs,i),o!==e);)c++;return null!==e&&(n.directiveStylingLast=c),r}function lb(e,t,n){const r=n?1:2;let i=-1;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?i=a:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Aa(e,a,!!n||t[++o]))}return void 0===e?null:e}function PJ(e,t,n){const r=String(t);""!==r&&!r.includes(" ")&&Aa(e,r,n)}function VV(e,t,n,r,i,o,a,c){if(!(3&t.type))return;const p=e.data,_=p[c+1],x=function mJ(e){return!(1&~e)}(_)?zV(p,t,n,i,z_(_),a):void 0;OE(x)||(OE(o)||function fJ(e){return!(2&~e)}(_)&&(o=zV(p,null,n,i,c,a)),function W7(e,t,n,r,i){if(t)i?e.addClass(n,r):e.removeClass(n,r);else{let o=-1===r.indexOf("-")?void 0:$f.DashCase;null==i?e.removeStyle(n,r,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=$f.Important),e.setStyle(n,r,i,o))}}(r,a,q(to(),n),i,o))}function zV(e,t,n,r,i,o){const a=null===t;let c;for(;i>0;){const p=e[i],_=Array.isArray(p),x=_?p[1]:p,D=null===x;let A=n[i+1];A===kr&&(A=D?Tr:void 0);let O=D?Uc(A,r):x===r?A:void 0;if(_&&!OE(O)&&(O=Uc(p,r)),OE(O)&&(c=O,a))return c;const B=e[i+1];i=a?Pm(B):z_(B)}if(null!==t){let p=o?t.residualClasses:t.residualStyles;null!=p&&(c=Uc(p,r))}return c}function OE(e){return void 0!==e}function UV(e,t){return!!(e.flags&(t?8:16))}function we(e,t=""){const n=Ae(),r=Lt(),i=e+27,o=r.firstCreatePass?vm(r,i,1,t,null):r.data[i],a=jV(r,n,o,t);n[i]=a,Ng()&&tS(r,n,a,o),Is(o,!1)}let jV=(e,t,n,r)=>($p(!0),function UT(e,t){return e.createText(t)}(t[11],r));function qV(e,t,n,r,i,o=""){const c=xm(e,function Mr(){return Ye.lFrame.bindingIndex}(),n,i);return ul(2),c?t+Zt(n)+r+Zt(i)+o:kr}function dn(e){return gc("",e),dn}function gc(e,t,n){const r=Ae(),i=function $V(e,t,n,r=""){return ni(e,Ui(),n)?t+Zt(n)+r:kr}(r,e,t,n);return i!==kr&&mh(r,to(),i),gc}function II(e,t,n,r,i){const o=Ae(),a=qV(o,e,t,n,r,i);return a!==kr&&mh(o,to(),a),II}function mh(e,t,n){const r=q(t,e);!function k2(e,t,n){e.setValue(t,n)}(e[11],r,n)}function kI(e,t,n){aB(t)&&(t=t());const r=Ae();return ni(r,Ui(),t)&&(Lt(),Vx(So(),r,e,t,r[11],n)),kI}function AI(e,t){const n=Ae(),r=Lt(),i=$t();return wI(r,n,n[11],i,e,t),AI}function cz(e,t,n){const r=Lt();r.firstCreatePass&&uz(t,r.data,r.blueprint,is(e),n)}function uz(e,t,n,r,i){if(e=cn(e),Array.isArray(e))for(let o=0;o<e.length;o++)uz(e[o],t,n,r,i);else{const o=Lt(),a=Ae(),c=$t();let p=Uo(e)?e:cn(e.provide);const _=bi(e),x=1048575&c.providerIndexes,D=c.directiveStart,A=c.providerIndexes>>20;if(Uo(e)||!e.multi){const O=new Xp(_,i,Re,null),B=MI(p,t,i?x:x+A,D);-1===B?(Jp(Kc(c,a),o,p),RI(o,e,t.length),t.push(p),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(O),a.push(O)):(n[B]=O,a[B]=O)}else{const O=MI(p,t,x+A,D),B=MI(p,t,x,x+A),oe=B>=0&&n[B];if(i&&!oe||!i&&!(O>=0&&n[O])){Jp(Kc(c,a),o,p);const ye=function XJ(e,t,n,r,i){const a=new Xp(e,n,Re,null);return a.multi=[],a.index=t,a.componentProviders=0,dz(a,i,r&&!n),a}(i?YJ:KJ,n.length,i,r,_);!i&&oe&&(n[B].providerFactory=ye),RI(o,e,t.length,0),t.push(p),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(ye),a.push(ye)}else RI(o,e,O>-1?O:B,dz(n[i?B:O],_,!i&&r));!i&&r&&oe&&n[B].componentProviders++}}}function RI(e,t,n,r){const i=Uo(t),o=function Qs(e){return!!e.useClass}(t);if(i||o){const p=(o?cn(t.useClass):t).prototype.ngOnDestroy;if(p){const _=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){const x=_.indexOf(n);-1===x?_.push(n,[r,p]):_[x+1].push(r,p)}else _.push(n,p)}}}function dz(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function MI(e,t,n,r){for(let i=n;i<r;i++)if(t[i]===e)return i;return-1}function KJ(e,t,n,r,i){return PI(this.multi,[])}function YJ(e,t,n,r,i){const o=this.multi;let a;if(this.providerFactory){const c=this.providerFactory.componentProviders,p=Tf(r,r[1],this.providerFactory.index,i);a=p.slice(0,c),PI(o,a);for(let _=c;_<p.length;_++)a.push(p[_])}else a=[],PI(o,a);return a}function PI(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function Cr(e,t){return n=>{n.providersResolver=(r,i)=>cz(r,i?i(e):e,!1),t&&(n.viewProvidersResolver=(r,i)=>cz(r,i?i(t):t,!0))}}function _z(e,t,n,r,i,o,a,c,p){const _=t+n;return function mc(e,t,n,r,i,o){const a=xm(e,t,n,r);return xm(e,t+2,i,o)||a}(e,_,i,o,a,c)?id(e,_+4,p?r.call(p,i,o,a,c):r(i,o,a,c)):function cb(e,t){const n=e[t];return n===kr?void 0:n}(e,_+4)}function H_(e,t){const n=Lt();let r;const i=e+27;n.firstCreatePass?(r=function uee(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}}(t,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];const o=r.factory||(r.factory=ka(r.type)),c=vi(Re);try{const p=Qp(!1),_=o();return Qp(p),function ee(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,Ae(),i,_),_}finally{vi(c)}}function $_(e,t,n,r,i,o){const a=e+27,c=Ae(),p=function ae(e,t){return e[t]}(c,a);return function ub(e,t){return e[1].data[t].pure}(c,a)?_z(c,Mn(),t,p.transform,n,r,i,o,p):p.transform(n,r,i,o)}class Hee{ngModuleFactory;componentFactories;constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let $ee=(()=>{class e{compileModuleSync(n){return new MF(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),o=rd(es(n).declarations).reduce((a,c)=>{const p=en(c);return p&&a.push(new Gv(p)),a},[]);return new Hee(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Gee=(()=>{class e{applicationErrorHandler=Z(hl);appRef=Z(wl);taskService=Z(Na);ngZone=Z(Xt);zonelessEnabled=Z(Gu);tracing=Z(w_,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Hn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Vg):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Z(N0,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{const n=this.taskService.add();this.runningTick||(this.cleanup(),this.zonelessEnabled&&!this.appRef.includeAllTestViews)?(this.switchToMicrotaskScheduler(),this.taskService.remove(n)):this.taskService.remove(n)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{const n=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})})}notify(n){if(!this.zonelessEnabled&&5===n)return;switch(n){case 0:case 6:case 13:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 12:this.appRef.dirtyFlags|=16;break;case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;const r=this.useMicrotaskScheduler?Yy:Bg;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Vg+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(n),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const gh=new Le("",{factory:()=>Z(gh,{optional:!0,skipSelf:!0})||function Wee(){return typeof $localize<"u"&&$localize.locale||IE}()}),zE=Symbol("InputSignalNode#UNSET"),Uz={...ba,transformFn:void 0,applyValueToInputSignal(e,t){nl(e,t)}};function jz(e,t){const n=Object.create(Uz);function r(){if(wo(n),n.value===zE)throw new se(-950,null);return n.value}return n.value=e,n.transformFn=t?.transform,r[Ve]=n,r}class nte{attributeName;constructor(t){this.attributeName=t}__NG_ELEMENT_ID__=()=>If(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}}function Hz(e,t){return jz(e,t)}const ite=(Hz.required=function rte(e){return jz(zE,e)},Hz);let ste=(()=>{class e{zone=Z(Xt);changeDetectionScheduler=Z(vf);applicationRef=Z(wl);applicationErrorHandler=Z(hl);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(n){this.applicationErrorHandler(n)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const ate=new Le("",{factory:()=>!1});function Wz(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}let ute=(()=>{class e{subscription=new Hn;initialized=!1;zone=Z(Xt);pendingTasks=Z(Na);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Xt.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Xt.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const UE=new Le(""),pte=new Le("");function hb(e){return!e.moduleRef}let W_=null;let _h=(()=>class e{static __NG_ELEMENT_ID__=Pte})();function Pte(e){return function Ote(e,t,n){if(Ji(e)&&!n){const r=ie(e.index,t);return new Nv(r,r)}return 175&e.type?new Nv(t[15],t):null}($t(),Ae(),!(16&~e))}function Hte(e){const{rootComponent:t,appProviders:n,platformProviders:r,platformRef:i}=e;dr(_t.BootstrapApplicationStart);try{const o=i?.injector??function vte(e=[]){if(W_)return W_;const t=function Jz(e=[],t){return En.create({name:t,providers:[{provide:df,useValue:"platform"},{provide:UE,useValue:new Set([()=>W_=null])},...e]})}(e);return W_=t,function NY(){!function Ip(e){Ll=e}(()=>{throw new se(600,"")})}(),function eU(e){const t=e.get(pl,null);Oi(e,()=>{t?.forEach(n=>n())})}(t),t}(r),a=[[{provide:vf,useExisting:Gee},{provide:Xt,useClass:M0},{provide:Gu,useValue:!0}],O0,...n||[]];return function Kz(e){const t=hb(e)?e.r3Injector:e.moduleRef.injector,n=t.get(Xt);return n.run(()=>{hb(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();const r=t.get(hl);let i;if(n.runOutsideAngular(()=>{i=n.onError.subscribe({next:r})}),hb(e)){const o=()=>t.destroy(),a=e.platformInjector.get(UE);a.add(o),t.onDestroy(()=>{i.unsubscribe(),a.delete(o)})}else{const o=()=>e.moduleRef.destroy(),a=e.platformInjector.get(UE);a.add(o),e.moduleRef.onDestroy(()=>{mE(e.allPlatformModules,e.moduleRef),i.unsubscribe(),a.delete(o)})}return function gte(e,t,n){try{const r=n();return Jv(r)?r.catch(i=>{throw t.runOutsideAngular(()=>e(i)),i}):r}catch(r){throw t.runOutsideAngular(()=>e(r)),r}}(r,n,()=>{const o=t.get(Na),a=o.add(),c=t.get(TB);return c.runInitializers(),c.donePromise.then(()=>{if(function TQ(e){"string"==typeof e&&(oV=e.toLowerCase().replace(/_/g,"-"))}(t.get(gh,IE)||IE),!t.get(pte,!0))return hb(e)?t.get(wl):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if(hb(e)){const x=t.get(wl);return void 0!==e.rootComponent&&x.bootstrap(e.rootComponent),x}return e.moduleRef}).finally(()=>{o.remove(a)})})})}({r3Injector:new PF({providers:a,parent:o,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:o,rootComponent:t})}catch(o){return Promise.reject(o)}finally{dr(_t.BootstrapApplicationEnd)}}function us(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function bU(e,t=NaN){return isNaN(parseFloat(e))||isNaN(Number(e))?t:Number(e)}function CU(e,t){const n=en(e),r=t.elementInjector||Yl();return new Gv(n).create(r,t.projectableNodes,t.hostElement,t.environmentInjector,t.directives,t.bindings)}let DU=null;function Xf(){return DU}class ane{}let WE=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(cne),providedIn:"platform"})}return e})();const lne=new Le("");let cne=(()=>{class e extends WE{_location;_history;_doc=Z(Fn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xf().getBaseHref(this._doc)}onPopState(n){const r=Xf().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Xf().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function TU(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[i,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===t)return decodeURIComponent(o)}return null}class SU{}function IU(e,t,n){return function wQ(e,t,n){"string"!=typeof t&&(n=t,t=e[fi.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),V_[t]=e,n&&(V_[t][fi.ExtraData]=n)}(e,t,n)}const kU="browser";let AU=(()=>{class e{static \u0275prov=Ue({token:e,providedIn:"root",factory:()=>new hne(Z(Fn),window)})}return e})();class hne{document;window;offset=()=>[0,0];constructor(t,n){this.document=t,this.window=n}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t,n){this.window.scrollTo({...n,left:t[0],top:t[1]})}scrollToAnchor(t,n){const r=function fne(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const a=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(a)return a}i=r.nextNode()}}return null}(this.document,t);r&&(this.scrollToElement(r,n),r.focus())}setHistoryScrollRestoration(t){try{this.window.history.scrollRestoration=t}catch{console.warn(Nt(2400,!1))}}scrollToElement(t,n){const r=t.getBoundingClientRect(),i=r.left+this.window.pageXOffset,o=r.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo({...n,left:i-a[0],top:o-a[1]})}}class UU{_doc;constructor(t){this._doc=t}manager}let KI=(()=>{class e extends UU{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i,o){return n.addEventListener(r,i,o),()=>this.removeEventListener(n,r,i,o)}removeEventListener(n,r,i,o){return n.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||e)(Ct(Fn))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();const YI=new Le("");let jU=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(a=>{a.manager=this});const i=n.filter(a=>!(a instanceof KI));this._plugins=i.slice().reverse();const o=n.find(a=>a instanceof KI);o&&this._plugins.push(o)}addEventListener(n,r,i,o){return this._findPluginFor(r).addEventListener(n,r,i,o)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(o=>o.supports(n)),!r)throw new se(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||e)(Ct(YI),Ct(Xt))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();const XI="ng-app-id";function HU(e){for(const t of e)t.remove()}function $U(e,t){const n=t.createElement("style");return n.textContent=e,n}function QI(e,t){const n=t.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),n}let qU=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,r,i,o={}){this.doc=n,this.appId=r,this.nonce=i,function Une(e,t,n,r){const i=e.head?.querySelectorAll(`style[${XI}="${t}"],link[${XI}="${t}"]`);if(i)for(const o of i)o.removeAttribute(XI),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&n.set(o.textContent,{usage:0,elements:[o]})}(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(const i of n)this.addUsage(i,this.inline,$U);r?.forEach(i=>this.addUsage(i,this.external,QI))}removeStyles(n,r){for(const i of n)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(n,r,i){const o=r.get(n);o?o.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,i(n,this.doc)))})}removeUsage(n,r){const i=r.get(n);i&&(i.usage--,i.usage<=0&&(HU(i.elements),r.delete(n)))}ngOnDestroy(){for(const[,{elements:n}]of[...this.inline,...this.external])HU(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(const[r,{elements:i}]of this.inline)i.push(this.addElement(n,$U(r,this.doc)));for(const[r,{elements:i}]of this.external)i.push(this.addElement(n,QI(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),n.appendChild(r)}static \u0275fac=function(r){return new(r||e)(Ct(Fn),Ct(yr),Ct(Nr,8),Ct(cs))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();const JI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ek=/%COMP%/g,Wne=new Le("",{factory:()=>!0});function WU(e,t){return t.map(n=>n.replace(ek,e))}let tk=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(n,r,i,o,a,c,p=null,_=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=a,this.ngZone=c,this.nonce=p,this.tracingService=_,this.defaultRenderer=new nk(n,a,c,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(n,r);return i instanceof YU?i.applyToHost(n):i instanceof rk&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let o=i.get(r.id);if(!o){const a=this.doc,c=this.ngZone,p=this.eventManager,_=this.sharedStylesHost,x=this.removeStylesOnCompDestroy,D=this.tracingService;switch(r.encapsulation){case fc.Emulated:o=new YU(p,_,r,this.appId,x,a,c,D);break;case fc.ShadowDom:return new KU(p,n,r,a,c,this.nonce,D,_);case fc.ExperimentalIsolatedShadowDom:return new KU(p,n,r,a,c,this.nonce,D);default:o=new rk(p,_,r,x,a,c,D)}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||e)(Ct(jU),Ct(qU),Ct(yr),Ct(Wne),Ct(Fn),Ct(Xt),Ct(Nr),Ct(w_,8))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();class nk{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,n,r,i){this.eventManager=t,this.doc=n,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(t,n){return n?this.doc.createElementNS(JI[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(ZU(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(ZU(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){n.remove()}selectRootElement(t,n){let r="string"==typeof t?this.doc.querySelector(t):t;if(!r)throw new se(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,i){if(i){n=i+":"+n;const o=JI[i];o?t.setAttributeNS(o,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const i=JI[r];i?t.removeAttributeNS(i,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,i){i&($f.DashCase|$f.Important)?t.style.setProperty(n,r,i&$f.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&$f.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){null!=t&&(t[n]=r)}setValue(t,n){t.nodeValue=n}listen(t,n,r,i){if("string"==typeof t&&!(t=Xf().getGlobalEventTarget(this.doc,t)))throw new se(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(t,n,o)),this.eventManager.addEventListener(t,n,o,i)}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&n.preventDefault()}}}function ZU(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class KU extends nk{hostEl;sharedStylesHost;shadowRoot;constructor(t,n,r,i,o,a,c,p){super(t,i,o,c),this.hostEl=n,this.sharedStylesHost=p,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let _=r.styles;_=WU(r.id,_);for(const D of _){const A=document.createElement("style");a&&A.setAttribute("nonce",a),A.textContent=D,this.shadowRoot.appendChild(A)}const x=r.getExternalStyles?.();if(x)for(const D of x){const A=QI(D,i);a&&A.setAttribute("nonce",a),this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(null,n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}}class rk extends nk{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,n,r,i,o,a,c,p){super(t,o,a,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i;let _=r.styles;this.styles=p?WU(p,_):_,this.styleUrls=r.getExternalStyles?.(p)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&0===gm.size&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class YU extends rk{contentAttr;hostAttr;constructor(t,n,r,i,o,a,c,p){const _=i+"-"+r.id;super(t,n,r,o,a,c,p,_),this.contentAttr=function Zne(e){return"_ngcontent-%COMP%".replace(ek,e)}(_),this.hostAttr=function Kne(e){return"_nghost-%COMP%".replace(ek,e)}(_)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}class ik extends ane{supportsDOMEvents=!0;static makeCurrent(){!function sne(e){DU??=e}(new ik)}onAndCancel(t,n,r,i){return t.addEventListener(n,r,i),()=>{t.removeEventListener(n,r,i)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.remove()}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function Xne(){return _b=_b||document.head.querySelector("base"),_b?_b.getAttribute("href"):null}();return null==n?null:function Qne(e){return new URL(e,document.baseURI).pathname}(n)}resetBaseElement(){_b=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return TU(document.cookie,t)}}let _b=null,ere=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();const XU=["alt","control","meta","shift"],tre={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},nre={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};function ok(){return(ok=_e(function*(e,t,n){return Hte({rootComponent:e,...QU(t,n)})})).apply(this,arguments)}function QU(e,t){return{platformRef:t?.platformRef,appProviders:[...ure,...e?.providers??[]],platformProviders:lre}}const lre=[{provide:cs,useValue:kU},{provide:pl,useValue:function ore(){ik.makeCurrent()},multi:!0},{provide:Fn,useFactory:function are(){return function mo(e){po=e}(document),document}}],ure=[{provide:df,useValue:"root"},{provide:yf,useFactory:function sre(){return new yf}},{provide:YI,useClass:KI,multi:!0},{provide:YI,useClass:(()=>{class e extends UU{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,i,o){const a=e.parseEventName(r),c=e.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xf().onAndCancel(n,a.domEventName,c,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=e._normalizeKey(r.pop());let a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),XU.forEach(_=>{const x=r.indexOf(_);x>-1&&(r.splice(x,1),a+=_+".")}),a+=o,0!=r.length||0===o.length)return null;const p={};return p.domEventName=i,p.fullKey=a,p}static matchEventFullKeyCode(n,r){let i=tre[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(i=n.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),XU.forEach(a=>{a!==i&&(0,nre[a])(n)&&(o+=a+".")}),o+=i,o===r)}static eventCallback(n,r,i){return o=>{e.matchEventFullKeyCode(o,n)&&i.runGuarded(()=>r(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}static \u0275fac=function(r){return new(r||e)(Ct(Fn))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})(),multi:!0},tk,qU,jU,{provide:vl,useExisting:tk},{provide:SU,useClass:ere},[]];var hn=function(e){return e[e.State=0]="State",e[e.Transition=1]="Transition",e[e.Sequence=2]="Sequence",e[e.Group=3]="Group",e[e.Animate=4]="Animate",e[e.Keyframes=5]="Keyframes",e[e.Style=6]="Style",e[e.Trigger=7]="Trigger",e[e.Reference=8]="Reference",e[e.AnimateChild=9]="AnimateChild",e[e.AnimateRef=10]="AnimateRef",e[e.Query=11]="Query",e[e.Stagger=12]="Stagger",e}(hn||{});const yh="*";function JU(e){return{type:hn.Style,styles:e,offset:null}}class yb{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(t=0,n=0){this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class e3{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(t){this.players=t;let n=0,r=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++n==o&&this._onFinish()}),a.onDestroy(()=>{++r==o&&this._onDestroy()}),a.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((a,c)=>Math.max(a,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){const t=this.players.reduce((n,r)=>null===n||r.totalTime>n.totalTime?r:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}function t3(e){return new se(3e3,!1)}function wre(e){return new se(3002,!1)}function Qf(e){switch(e.length){case 0:return new yb;case 1:return e[0];default:return new e3(e)}}function n3(e,t,n=new Map,r=new Map){const i=[],o=[];let a=-1,c=null;if(t.forEach(p=>{const _=p.get("offset"),x=_==a,D=x&&c||new Map;p.forEach((A,O)=>{let B=O,Q=A;if("offset"!==O)switch(B=e.normalizePropertyName(B,i),Q){case"!":Q=n.get(O);break;case yh:Q=r.get(O);break;default:Q=e.normalizeStyleValue(O,B,Q,i)}D.set(B,Q)}),x||o.push(D),c=D,a=_}),i.length)throw function Mre(){return new se(3502,!1)}();return o}function ck(e,t,n,r){switch(t){case"start":e.onStart(()=>r(n&&uk(n,"start",e)));break;case"done":e.onDone(()=>r(n&&uk(n,"done",e)));break;case"destroy":e.onDestroy(()=>r(n&&uk(n,"destroy",e)))}}function uk(e,t,n){const o=dk(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),a=e._data;return null!=a&&(o._data=a),o}function dk(e,t,n,r,i="",o=0,a){return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function Cl(e,t,n){let r=e.get(t);return r||e.set(t,r=n),r}function r3(e){const t=e.indexOf(":");return[e.substring(1,t),e.slice(t+1)]}const $re=typeof document>"u"?null:document.documentElement;function hk(e){const t=e.parentNode||e.host||null;return t===$re?null:t}let Nm=null,i3=!1;function o3(e,t){for(;t;){if(t===e)return!0;t=hk(t)}return!1}function s3(e,t,n){if(n)return Array.from(e.querySelectorAll(t));const r=e.querySelector(t);return r?[r]:[]}const l3="ng-enter",fk="ng-leave",QE="ng-trigger",JE=".ng-trigger",c3="ng-animating",pk=".ng-animating";function vh(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:mk(parseFloat(t[1]),t[2])}function mk(e,t){return"s"===t?1e3*e:e}function eC(e,t,n){return e.hasOwnProperty("duration")?e:function Xre(e,t,n){let r,i=0,o="";if("string"==typeof e){const a=e.match(Yre);if(null===a)return t.push(t3()),{duration:0,delay:0,easing:""};r=mk(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(i=mk(parseFloat(c),a[4]));const p=a[5];p&&(o=p)}else r=e;if(!n){let a=!1,c=t.length;r<0&&(t.push(function hre(){return new se(3100,!1)}()),a=!0),i<0&&(t.push(function fre(){return new se(3101,!1)}()),a=!0),a&&t.splice(c,0,t3())}return{duration:r,delay:i,easing:o}}(e,t,n)}const Yre=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i;function sd(e,t,n){t.forEach((r,i)=>{const o=_k(i);n&&!n.has(i)&&n.set(i,e.style[o]),e.style[o]=r})}function Lm(e,t){t.forEach((n,r)=>{const i=_k(r);e.style[i]=""})}function vb(e){return Array.isArray(e)?1==e.length?e[0]:function dre(e,t=null){return{type:hn.Sequence,steps:e,options:t}}(e):e}const gk=new RegExp("{{\\s*(.+?)\\s*}}","g");function u3(e){let t=[];if("string"==typeof e){let n;for(;n=gk.exec(e);)t.push(n[1]);gk.lastIndex=0}return t}function bb(e,t,n){const r=`${e}`,i=r.replace(gk,(o,a)=>{let c=t[a];return null==c&&(n.push(function mre(){return new se(3003,!1)}()),c=""),c.toString()});return i==r?e:i}const eie=/-+([a-z0-9])/g;function _k(e){return e.replace(eie,(...t)=>t[1].toUpperCase())}function Dl(e,t,n){switch(t.type){case hn.Trigger:return e.visitTrigger(t,n);case hn.State:return e.visitState(t,n);case hn.Transition:return e.visitTransition(t,n);case hn.Sequence:return e.visitSequence(t,n);case hn.Group:return e.visitGroup(t,n);case hn.Animate:return e.visitAnimate(t,n);case hn.Keyframes:return e.visitKeyframes(t,n);case hn.Style:return e.visitStyle(t,n);case hn.Reference:return e.visitReference(t,n);case hn.AnimateChild:return e.visitAnimateChild(t,n);case hn.AnimateRef:return e.visitAnimateRef(t,n);case hn.Query:return e.visitQuery(t,n);case hn.Stagger:return e.visitStagger(t,n);default:throw function gre(){return new se(3004,!1)}()}}function yk(e,t){return window.getComputedStyle(e)[t]}let vk=(()=>{class e{validateStyleProperty(n){return function Gre(e){Nm||(Nm=function Wre(){return typeof document<"u"?document.body:null}()||{},i3=!!Nm.style&&"WebkitAppearance"in Nm.style);let t=!0;return Nm.style&&!function qre(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in Nm.style,!t&&i3&&(t="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in Nm.style)),t}(n)}containsElement(n,r){return o3(n,r)}getParentElement(n){return hk(n)}query(n,r,i){return s3(n,r,i)}computeStyle(n,r,i){return i||""}animate(n,r,i,o,a,c=[],p){return new yb(i,o)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();class bk{static NOOP=new vk}class wk{}const iie=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class d3 extends wk{normalizePropertyName(t,n){return _k(t)}normalizeStyleValue(t,n,r,i){let o="";const a=r.toString().trim();if(iie.has(n)&&0!==r&&"0"!==r)if("number"==typeof r)o="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&i.push(function _re(){return new se(3005,!1)}())}return a+o}}const nC=new Set(["true","1"]),rC=new Set(["false","0"]);function h3(e,t){const n=nC.has(e)||rC.has(e),r=nC.has(t)||rC.has(t);return(i,o)=>{let a="*"==e||e==i,c="*"==t||t==o;return!a&&n&&"boolean"==typeof i&&(a=i?nC.has(e):rC.has(e)),!c&&r&&"boolean"==typeof o&&(c=o?nC.has(t):rC.has(t)),a&&c}}const lie=new RegExp("s*:selfs*,?","g");function Ek(e,t,n,r){return new cie(e).build(t,n,r)}class cie{_driver;constructor(t){this._driver=t}build(t,n,r){const i=new hie(n);return this._resetContextStyleTimingState(i),Dl(this,vb(t),i)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,n){let r=n.queryCount=0,i=n.depCount=0;const o=[],a=[];return"@"==t.name.charAt(0)&&n.errors.push(function yre(){return new se(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(n),c.type==hn.State){const p=c,_=p.name;_.toString().split(/\s*,\s*/).forEach(x=>{p.name=x,o.push(this.visitState(p,n))}),p.name=_}else if(c.type==hn.Transition){const p=this.visitTransition(c,n);r+=p.queryCount,i+=p.depCount,a.push(p)}else n.errors.push(function vre(){return new se(3007,!1)}())}),{type:hn.Trigger,name:t.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}visitState(t,n){const r=this.visitStyle(t.styles,n),i=t.options&&t.options.params||null;if(r.containsDynamicStyles){const o=new Set,a=i||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(p=>{u3(p).forEach(_=>{a.hasOwnProperty(_)||o.add(_)})})}),o.size&&n.errors.push(function bre(){return new se(3008,!1)}(0,o.values()))}return{type:hn.State,name:t.name,style:r,options:i?{params:i}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const r=Dl(this,vb(t.animation),n),i=function oie(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(r=>function sie(e,t,n){if(":"==e[0]){const p=function aie(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return t.push(function Are(){return new se(3016,!1)}()),"* => *"}}(e,n);if("function"==typeof p)return void t.push(p);e=p}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(function kre(){return new se(3015,!1)}()),t;const i=r[1],o=r[2],a=r[3];t.push(h3(i,a)),"<"==o[0]&&("*"!=i||"*"!=a)&&t.push(h3(a,i))}(r,n,t)):n.push(e),n}(t.expr,n.errors);return{type:hn.Transition,matchers:i,animation:r,queryCount:n.queryCount,depCount:n.depCount,options:Fm(t.options)}}visitSequence(t,n){return{type:hn.Sequence,steps:t.steps.map(r=>Dl(this,r,n)),options:Fm(t.options)}}visitGroup(t,n){const r=n.currentTime;let i=0;const o=t.steps.map(a=>{n.currentTime=r;const c=Dl(this,a,n);return i=Math.max(i,n.currentTime),c});return n.currentTime=i,{type:hn.Group,steps:o,options:Fm(t.options)}}visitAnimate(t,n){const r=function pie(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return Ck(eC(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=Ck(0,0,"");return o.dynamic=!0,o.strValue=n,o}const i=eC(n,t);return Ck(i.duration,i.delay,i.easing)}(t.timings,n.errors);n.currentAnimateTimings=r;let i,o=t.styles?t.styles:JU({});if(o.type==hn.Keyframes)i=this.visitKeyframes(o,n);else{let a=t.styles,c=!1;if(!a){c=!0;const _={};r.easing&&(_.easing=r.easing),a=JU(_)}n.currentTime+=r.duration+r.delay;const p=this.visitStyle(a,n);p.isEmptyStep=c,i=p}return n.currentAnimateTimings=null,{type:hn.Animate,timings:r,style:i,options:null}}visitStyle(t,n){const r=this._makeStyleAst(t,n);return this._validateStyleAst(r,n),r}_makeStyleAst(t,n){const r=[],i=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of i)"string"==typeof c?c===yh?r.push(c):n.errors.push(wre()):r.push(new Map(Object.entries(c)));let o=!1,a=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(a=c.get("easing"),c.delete("easing")),!o))for(let p of c.values())if(p.toString().indexOf("{{")>=0){o=!0;break}}),{type:hn.Style,styles:r,easing:a,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,n){const r=n.currentAnimateTimings;let i=n.currentTime,o=n.currentTime;r&&o>0&&(o-=r.duration+r.delay),t.styles.forEach(a=>{"string"!=typeof a&&a.forEach((c,p)=>{const _=n.collectedStyles.get(n.currentQuerySelector),x=_.get(p);let D=!0;x&&(o!=i&&o>=x.startTime&&i<=x.endTime&&(n.errors.push(function xre(){return new se(3010,!1)}()),D=!1),o=x.startTime),D&&_.set(p,{startTime:o,endTime:i}),n.options&&function Jre(e,t,n){const r=t.params||{},i=u3(e);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||n.push(function pre(){return new se(3001,!1)}())})}(c,n.options,n.errors)})})}visitKeyframes(t,n){const r={type:hn.Keyframes,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function Ere(){return new se(3011,!1)}()),r;let o=0;const a=[];let c=!1,p=!1,_=0;const x=t.steps.map(ye=>{const xe=this._makeStyleAst(ye,n);let $e=null!=xe.offset?xe.offset:function fie(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(n instanceof Map&&n.has("offset")){const r=n;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}return t}(xe.styles),De=0;return null!=$e&&(o++,De=xe.offset=$e),p=p||De<0||De>1,c=c||De<_,_=De,a.push(De),xe});p&&n.errors.push(function Cre(){return new se(3012,!1)}()),c&&n.errors.push(function Dre(){return new se(3200,!1)}());const D=t.steps.length;let A=0;o>0&&o<D?n.errors.push(function Tre(){return new se(3202,!1)}()):0==o&&(A=1/(D-1));const O=D-1,B=n.currentTime,Q=n.currentAnimateTimings,oe=Q.duration;return x.forEach((ye,xe)=>{const $e=A>0?xe==O?1:A*xe:a[xe],De=$e*oe;n.currentTime=B+Q.delay+De,Q.duration=De,this._validateStyleAst(ye,n),ye.offset=$e,r.styles.push(ye)}),r}visitReference(t,n){return{type:hn.Reference,animation:Dl(this,vb(t.animation),n),options:Fm(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:hn.AnimateChild,options:Fm(t.options)}}visitAnimateRef(t,n){return{type:hn.AnimateRef,animation:this.visitReference(t.animation,n),options:Fm(t.options)}}visitQuery(t,n){const r=n.currentQuerySelector,i=t.options||{};n.queryCount++,n.currentQuery=t;const[o,a]=function uie(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(lie,"")),e=e.replace(/@\*/g,JE).replace(/@\w+/g,n=>JE+"-"+n.slice(1)).replace(/:animating/g,pk),[e,t]}(t.selector);n.currentQuerySelector=r.length?r+" "+o:o,Cl(n.collectedStyles,n.currentQuerySelector,new Map);const c=Dl(this,vb(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:hn.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:a,animation:c,originalSelector:t.selector,options:Fm(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function Sre(){return new se(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:eC(t.timings,n.errors,!0);return{type:hn.Stagger,animation:Dl(this,vb(t.animation),n),timings:r,options:null}}}class hie{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(t){this.errors=t}}function Fm(e){return e?(e={...e}).params&&(e.params=function die(e){return e?{...e}:null}(e.params)):e={},e}function Ck(e,t,n){return{duration:e,delay:t,easing:n}}function Dk(e,t,n,r,i,o,a=null,c=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:c}}class iC{_map=new Map;get(t){return this._map.get(t)||[]}append(t,n){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const _ie=new RegExp(":enter","g"),vie=new RegExp(":leave","g");function Tk(e,t,n,r,i,o=new Map,a=new Map,c,p,_=[]){return(new bie).buildKeyframes(e,t,n,r,i,o,a,c,p,_)}class bie{buildKeyframes(t,n,r,i,o,a,c,p,_,x=[]){_=_||new iC;const D=new Sk(t,n,_,i,o,x,[]);D.options=p;const A=p.delay?vh(p.delay):0;D.currentTimeline.delayNextStep(A),D.currentTimeline.setStyles([a],null,D.errors,p),Dl(this,r,D);const O=D.timelines.filter(B=>B.containsAnimation());if(O.length&&c.size){let B;for(let Q=O.length-1;Q>=0;Q--){const oe=O[Q];if(oe.element===n){B=oe;break}}B&&!B.allowOnlyTimelineStyles()&&B.setStyles([c],null,D.errors,p)}return O.length?O.map(B=>B.buildKeyframes()):[Dk(n,[],[],[],0,A,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const r=n.subInstructions.get(n.element);if(r){const i=n.createSubContext(t.options),o=n.currentTimeline.currentTime,a=this._visitSubInstructions(r,i,i.options);o!=a&&n.transformIntoNewTimeline(a)}n.previousNode=t}visitAnimateRef(t,n){const r=n.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],n,r),this.visitReference(t.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=t}_applyAnimationRefDelays(t,n,r){for(const i of t){const o=i?.delay;if(o){const a="number"==typeof o?o:vh(bb(o,i?.params??{},n.errors));r.delayNextStep(a)}}}_visitSubInstructions(t,n,r){let o=n.currentTimeline.currentTime;const a=null!=r.duration?vh(r.duration):null,c=null!=r.delay?vh(r.delay):null;return 0!==a&&t.forEach(p=>{const _=n.appendInstructionToTimeline(p,a,c);o=Math.max(o,_.duration+_.delay)}),o}visitReference(t,n){n.updateOptions(t.options,!0),Dl(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const r=n.subContextCount;let i=n;const o=t.options;if(o&&(o.params||o.delay)&&(i=n.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){i.previousNode.type==hn.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=oC);const a=vh(o.delay);i.delayNextStep(a)}t.steps.length&&(t.steps.forEach(a=>Dl(this,a,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const r=[];let i=n.currentTimeline.currentTime;const o=t.options&&t.options.delay?vh(t.options.delay):0;t.steps.forEach(a=>{const c=n.createSubContext(t.options);o&&c.delayNextStep(o),Dl(this,a,c),i=Math.max(i,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(a=>n.currentTimeline.mergeTimelineCollectedStyles(a)),n.transformIntoNewTimeline(i),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const r=t.strValue;return eC(n.params?bb(r,n.params,n.errors):r,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const r=n.currentAnimateTimings=this._visitTiming(t.timings,n),i=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),i.snapshotCurrentStyles());const o=t.style;o.type==hn.Keyframes?this.visitKeyframes(o,n):(n.incrementTime(r.duration),this.visitStyle(o,n),i.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const r=n.currentTimeline,i=n.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const o=i&&i.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(o):r.setStyles(t.styles,o,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const r=n.currentAnimateTimings,i=n.currentTimeline.duration,o=r.duration,c=n.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(p=>{c.forwardTime((p.offset||0)*o),c.setStyles(p.styles,p.easing,n.errors,n.options),c.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(c),n.transformIntoNewTimeline(i+o),n.previousNode=t}visitQuery(t,n){const r=n.currentTimeline.currentTime,i=t.options||{},o=i.delay?vh(i.delay):0;o&&(n.previousNode.type===hn.Style||0==r&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=oC);let a=r;const c=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,n.errors);n.currentQueryTotal=c.length;let p=null;c.forEach((_,x)=>{n.currentQueryIndex=x;const D=n.createSubContext(t.options,_);o&&D.delayNextStep(o),_===n.element&&(p=D.currentTimeline),Dl(this,t.animation,D),D.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,D.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(a),p&&(n.currentTimeline.mergeTimelineCollectedStyles(p),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const r=n.parentContext,i=n.currentTimeline,o=t.timings,a=Math.abs(o.duration),c=a*(n.currentQueryTotal-1);let p=a*n.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":p=c-p;break;case"full":p=r.currentStaggerTime}const x=n.currentTimeline;p&&x.delayNextStep(p);const D=x.currentTime;Dl(this,t.animation,n),n.previousNode=t,r.currentStaggerTime=i.currentTime-D+(i.startTime-r.currentTimeline.startTime)}}const oC={};class Sk{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=oC;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(t,n,r,i,o,a,c,p){this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=c,this.currentTimeline=p||new sC(this._driver,n,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const r=t;let i=this.options;null!=r.duration&&(i.duration=vh(r.duration)),null!=r.delay&&(i.delay=vh(r.delay));const o=r.params;if(o){let a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(c=>{(!n||!a.hasOwnProperty(c))&&(a[c]=bb(o[c],a,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const r=t.params={};Object.keys(n).forEach(i=>{r[i]=n[i]})}}return t}createSubContext(t=null,n,r){const i=n||this.element,o=new Sk(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=oC,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,r){const i={duration:n??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},o=new wie(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,r,i,o,a){let c=[];if(i&&c.push(this.element),t.length>0){t=(t=t.replace(_ie,"."+this._enterClassName)).replace(vie,"."+this._leaveClassName);let _=this._driver.query(this.element,t,1!=r);0!==r&&(_=r<0?_.slice(_.length+r,_.length):_.slice(0,r)),c.push(..._)}return!o&&0==c.length&&a.push(function Ire(){return new se(3014,!1)}()),c}}class sC{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(t,n,r,i){this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new sC(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles.set(t,n),this._globalTimelineStyles.set(t,n),this._styleSummary.set(t,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||yh),this._currentKeyframe.set(n,yh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,r,i){n&&this._previousKeyframe.set("easing",n);const o=i&&i.params||{},a=function xie(e,t){const n=new Map;let r;return e.forEach(i=>{if("*"===i){r??=t.keys();for(let o of r)n.set(o,yh)}else for(let[o,a]of i)n.set(o,a)}),n}(t,this._globalTimelineStyles);for(let[c,p]of a){const _=bb(p,o,r);this._pendingStyles.set(c,_),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??yh),this._updateStyle(c,_)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,n)=>{this._currentKeyframe.set(n,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,t)}))}snapshotCurrentStyles(){for(let[t,n]of this._localTimelineStyles)this._pendingStyles.set(t,n),this._updateStyle(t,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((n,r)=>{const i=this._styleSummary.get(r);(!i||n.time>i.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((c,p)=>{const _=new Map([...this._backFill,...c]);_.forEach((x,D)=>{"!"===x?t.add(D):x===yh&&n.add(D)}),r||_.set("offset",p/this.duration),i.push(_)});const o=[...t.values()],a=[...n.values()];if(r){const c=i[0],p=new Map(c);c.set("offset",0),p.set("offset",1),i=[c,p]}return Dk(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}}class wie extends sC{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(t,n,r,i,o,a,c=!1){super(t,n,a.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=c,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&n){const o=[],a=r+n,c=n/a,p=new Map(t[0]);p.set("offset",0),o.push(p);const _=new Map(t[0]);_.set("offset",m3(c)),o.push(_);const x=t.length-1;for(let D=1;D<=x;D++){let A=new Map(t[D]);const O=A.get("offset");A.set("offset",m3((n+O*r)/a)),o.push(A)}r=a,n=0,i="",t=o}return Dk(this.element,t,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}function m3(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}function g3(e,t,n,r,i,o,a,c,p,_,x,D,A){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:a,timelines:c,queriedElements:p,preStyleProps:_,postStyleProps:x,totalTime:D,errors:A}}const Ik={};class _3{_triggerName;ast;_stateStyles;constructor(t,n,r){this._triggerName=t,this.ast=n,this._stateStyles=r}match(t,n,r,i){return function Eie(e,t,n,r,i){return e.some(o=>o(t,n,r,i))}(this.ast.matchers,t,n,r,i)}buildStyles(t,n,r){let i=this._stateStyles.get("*");return void 0!==t&&(i=this._stateStyles.get(t?.toString())||i),i?i.buildStyles(n,r):new Map}build(t,n,r,i,o,a,c,p,_,x){const D=[],A=this.ast.options&&this.ast.options.params||Ik,B=this.buildStyles(r,c&&c.params||Ik,D),Q=p&&p.params||Ik,oe=this.buildStyles(i,Q,D),ye=new Set,xe=new Map,$e=new Map,De="void"===i,ve={params:y3(Q,A),delay:this.ast.options?.delay},Fe=x?[]:Tk(t,n,this.ast.animation,o,a,B,oe,ve,_,D);let We=0;return Fe.forEach(dt=>{We=Math.max(dt.duration+dt.delay,We)}),D.length?g3(n,this._triggerName,r,i,De,B,oe,[],[],xe,$e,We,D):(Fe.forEach(dt=>{const Qt=dt.element,nn=Cl(xe,Qt,new Set);dt.preStyleProps.forEach(gi=>nn.add(gi));const Ii=Cl($e,Qt,new Set);dt.postStyleProps.forEach(gi=>Ii.add(gi)),Qt!==n&&ye.add(Qt)}),g3(n,this._triggerName,r,i,De,B,oe,Fe,[...ye.values()],xe,$e,We))}}function y3(e,t){const n={...t};return Object.entries(e).forEach(([r,i])=>{null!=i&&(n[r]=i)}),n}class Cie{styles;defaultParams;normalizer;constructor(t,n,r){this.styles=t,this.defaultParams=n,this.normalizer=r}buildStyles(t,n){const r=new Map,i=y3(t,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{a&&(a=bb(a,i,n));const p=this.normalizer.normalizePropertyName(c,n);a=this.normalizer.normalizeStyleValue(c,p,a,n),r.set(c,a)})}),r}}class Tie{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(t,n,r){this.name=t,this.ast=n,this._normalizer=r,n.states.forEach(i=>{this.states.set(i.name,new Cie(i.style,i.options&&i.options.params||{},r))}),v3(this.states,"true","1"),v3(this.states,"false","0"),n.transitions.forEach(i=>{this.transitionFactories.push(new _3(t,i,this.states))}),this.fallbackTransition=function Sie(e,t){return new _3(e,{type:hn.Transition,animation:{type:hn.Sequence,steps:[],options:null},matchers:[(a,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,r,i){return this.transitionFactories.find(a=>a.match(t,n,r,i))||null}matchStyles(t,n,r){return this.fallbackTransition.buildStyles(t,n,r)}}function v3(e,t,n){e.has(t)?e.has(n)||e.set(n,e.get(t)):e.has(n)&&e.set(t,e.get(n))}const Iie=new iC;class kie{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(t,n,r){this.bodyNode=t,this._driver=n,this._normalizer=r}register(t,n){const r=[],o=Ek(this._driver,n,r,[]);if(r.length)throw function Pre(){return new se(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,n,r){const i=t.element,o=n3(this._normalizer,t.keyframes,n,r);return this._driver.animate(i,o,t.duration,t.delay,t.easing,[],!0)}create(t,n,r={}){const i=[],o=this._animations.get(t);let a;const c=new Map;if(o?(a=Tk(this._driver,n,o,l3,fk,new Map,new Map,r,Iie,i),a.forEach(x=>{const D=Cl(c,x.element,new Map);x.postStyleProps.forEach(A=>D.set(A,null))})):(i.push(function Ore(){return new se(3300,!1)}()),a=[]),i.length)throw function Nre(){return new se(3504,!1)}();c.forEach((x,D)=>{x.forEach((A,O)=>{x.set(O,this._driver.computeStyle(D,O,yh))})});const _=Qf(a.map(x=>{const D=c.get(x.element);return this._buildPlayer(x,new Map,D)}));return this._playersById.set(t,_),_.onDestroy(()=>this.destroy(t)),this.players.push(_),_}destroy(t){const n=this._getPlayer(t);n.destroy(),this._playersById.delete(t);const r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(t){const n=this._playersById.get(t);if(!n)throw function Lre(){return new se(3301,!1)}();return n}listen(t,n,r,i){const o=dk(n,"","","");return ck(this._getPlayer(t),r,o,i),()=>{}}command(t,n,r,i){if("register"==r)return void this.register(t,i[0]);if("create"==r)return void this.create(t,n,i[0]||{});const o=this._getPlayer(t);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const b3="ng-animate-queued",kk="ng-animate-disabled",Oie=[],w3={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Nie={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ou="__ng_removed";class Ak{namespaceId;value;options;get params(){return this.options.params}constructor(t,n=""){this.namespaceId=n;const r=t&&t.hasOwnProperty("value");if(this.value=function Vie(e){return e??null}(r?t.value:t),r){const{value:o,...a}=t;this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const n=t.params;if(n){const r=this.options.params;Object.keys(n).forEach(i=>{null==r[i]&&(r[i]=n[i])})}}}const wb="void",Rk=new Ak(wb);class Lie{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(t,n,r){this.id=t,this.hostElement=n,this._engine=r,this._hostClassName="ng-tns-"+t,_c(n,this._hostClassName)}listen(t,n,r,i){if(!this._triggers.has(n))throw function Fre(){return new se(3302,!1)}();if(null==r||0==r.length)throw function Bre(){return new se(3303,!1)}();if(!function zie(e){return"start"==e||"done"==e}(r))throw function Vre(){return new se(3400,!1)}();const o=Cl(this._elementListeners,t,[]),a={name:n,phase:r,callback:i};o.push(a);const c=Cl(this._engine.statesByElement,t,new Map);return c.has(n)||(_c(t,QE),_c(t,QE+"-"+n),c.set(n,Rk)),()=>{this._engine.afterFlush(()=>{const p=o.indexOf(a);p>=0&&o.splice(p,1),this._triggers.has(n)||c.delete(n)})}}register(t,n){return!this._triggers.has(t)&&(this._triggers.set(t,n),!0)}_getTrigger(t){const n=this._triggers.get(t);if(!n)throw function zre(){return new se(3401,!1)}();return n}trigger(t,n,r,i=!0){const o=this._getTrigger(n),a=new Mk(this.id,n,t);let c=this._engine.statesByElement.get(t);c||(_c(t,QE),_c(t,QE+"-"+n),this._engine.statesByElement.set(t,c=new Map));let p=c.get(n);const _=new Ak(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&p&&_.absorbOptions(p.options),c.set(n,_),p||(p=Rk),_.value!==wb&&p.value===_.value){if(!function Hie(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const o=n[i];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(p.params,_.params)){const Q=[],oe=o.matchStyles(p.value,p.params,Q),ye=o.matchStyles(_.value,_.params,Q);Q.length?this._engine.reportError(Q):this._engine.afterFlush(()=>{Lm(t,oe),sd(t,ye)})}return}const A=Cl(this._engine.playersByElement,t,[]);A.forEach(Q=>{Q.namespaceId==this.id&&Q.triggerName==n&&Q.queued&&Q.destroy()});let O=o.matchTransition(p.value,_.value,t,_.params),B=!1;if(!O){if(!i)return;O=o.fallbackTransition,B=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:O,fromState:p,toState:_,player:a,isFallbackTransition:B}),B||(_c(t,b3),a.onStart(()=>{Z_(t,b3)})),a.onDone(()=>{let Q=this.players.indexOf(a);Q>=0&&this.players.splice(Q,1);const oe=this._engine.playersByElement.get(t);if(oe){let ye=oe.indexOf(a);ye>=0&&oe.splice(ye,1)}}),this.players.push(a),A.push(a),a}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(n=>n.delete(t)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(i=>i.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const r=this._engine.driver.query(t,JE,!0);r.forEach(i=>{if(i[ou])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(a=>a.triggerLeaveAnimation(i,n,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(t,n,r,i){const o=this._engine.statesByElement.get(t),a=new Map;if(o){const c=[];if(o.forEach((p,_)=>{if(a.set(_,p.value),this._triggers.has(_)){const x=this.trigger(t,_,wb,i);x&&c.push(x)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,a),r&&Qf(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(n&&r){const i=new Set;n.forEach(o=>{const a=o.name;if(i.has(a))return;i.add(a);const p=this._triggers.get(a).fallbackTransition,_=r.get(a)||Rk,x=new Ak(wb),D=new Mk(this.id,a,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:a,transition:p,fromState:_,toState:x,player:D,isFallbackTransition:!0})})}}removeNode(t,n){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let i=!1;if(r.totalAnimations){const o=r.players.length?r.playersByQueriedElement.get(t):[];if(o&&o.length)i=!0;else{let a=t;for(;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)r.markElementAsRemoved(this.id,t,!1,n);else{const o=t[ou];(!o||o===w3)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,n))}}insertNode(t,n){_c(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const o=r.element,a=this._elementListeners.get(o);a&&a.forEach(c=>{if(c.name==r.triggerName){const p=dk(o,r.triggerName,r.fromState.value,r.toState.value);p._data=t,ck(r.player,c.phase,p,c.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):n.push(r)}),this._queue=[],n.sort((r,i)=>{const o=r.transition.ast.depCount,a=i.transition.ast.depCount;return 0==o||0==a?o-a:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class Fie{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(t,n)=>{};_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}constructor(t,n,r){this.bodyNode=t,this.driver=n,this._normalizer=r}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,n){const r=new Lie(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,n){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let a=!1,c=this.driver.getParentElement(n);for(;c;){const p=i.get(c);if(p){const _=r.indexOf(p);r.splice(_+1,0,t),a=!0;break}c=this.driver.getParentElement(c)}a||r.unshift(t)}else r.push(t);return i.set(n,t),t}register(t,n){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,n)),r}registerTrigger(t,n,r){let i=this._namespaceLookup[t];i&&i.register(n,r)&&this.totalAnimations++}destroy(t,n){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(t);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(n),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,r=this.statesByElement.get(t);if(r)for(let i of r.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&n.add(o)}return n}trigger(t,n,r,i){if(aC(n)){const o=this._fetchNamespace(t);if(o)return o.trigger(n,r,i),!0}return!1}insertNode(t,n,r,i){if(!aC(n))return;const o=n[ou];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const a=this.collectedLeaveElements.indexOf(n);a>=0&&this.collectedLeaveElements.splice(a,1)}if(t){const a=this._fetchNamespace(t);a&&a.insertNode(n,r)}i&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),_c(t,kk)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Z_(t,kk))}removeNode(t,n,r){if(aC(n)){const i=t?this._fetchNamespace(t):null;i?i.removeNode(n,r):this.markElementAsRemoved(t,n,!1,r);const o=this.namespacesByHostElement.get(n);o&&o.id!==t&&o.removeNode(n,r)}else this._onRemovalComplete(n,r)}markElementAsRemoved(t,n,r,i,o){this.collectedLeaveElements.push(n),n[ou]={namespaceId:t,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,n,r,i,o){return aC(n)?this._fetchNamespace(t).listen(n,r,i,o):()=>{}}_buildInstruction(t,n,r,i,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,i,t.fromState.options,t.toState.options,n,o)}destroyInnerAnimations(t){let n=this.driver.query(t,JE,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,pk,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Qf(this.players).onDone(()=>t());t()})}processLeaveNode(t){const n=t[ou];if(n&&n.setForRemoval){if(t[ou]=w3,n.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}t.classList?.contains(kk)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)_c(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{n=this._flushAnimations(r,t)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],n.length?Qf(n).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(t){throw function Ure(){return new se(3402,!1)}()}_flushAnimations(t,n){const r=new iC,i=[],o=new Map,a=[],c=new Map,p=new Map,_=new Map,x=new Set;this.disabledNodes.forEach(St=>{x.add(St);const qt=this.driver.query(St,".ng-animate-queued",!0);for(let rn=0;rn<qt.length;rn++)x.add(qt[rn])});const D=this.bodyNode,A=Array.from(this.statesByElement.keys()),O=C3(A,this.collectedEnterElements),B=new Map;let Q=0;O.forEach((St,qt)=>{const rn=l3+Q++;B.set(qt,rn),St.forEach(ir=>_c(ir,rn))});const oe=[],ye=new Set,xe=new Set;for(let St=0;St<this.collectedLeaveElements.length;St++){const qt=this.collectedLeaveElements[St],rn=qt[ou];rn&&rn.setForRemoval&&(oe.push(qt),ye.add(qt),rn.hasAnimation?this.driver.query(qt,".ng-star-inserted",!0).forEach(ir=>ye.add(ir)):xe.add(qt))}const $e=new Map,De=C3(A,Array.from(ye));De.forEach((St,qt)=>{const rn=fk+Q++;$e.set(qt,rn),St.forEach(ir=>_c(ir,rn))}),t.push(()=>{O.forEach((St,qt)=>{const rn=B.get(qt);St.forEach(ir=>Z_(ir,rn))}),De.forEach((St,qt)=>{const rn=$e.get(qt);St.forEach(ir=>Z_(ir,rn))}),oe.forEach(St=>{this.processLeaveNode(St)})});const ve=[],Fe=[];for(let St=this._namespaceList.length-1;St>=0;St--)this._namespaceList[St].drainQueuedTransitions(n).forEach(rn=>{const ir=rn.player,Vo=rn.element;if(ve.push(ir),this.collectedEnterElements.length){const Kn=Vo[ou];if(Kn&&Kn.setForMove){if(Kn.previousTriggersValues&&Kn.previousTriggersValues.has(rn.triggerName)){const Zs=Kn.previousTriggersValues.get(rn.triggerName),gs=this.statesByElement.get(rn.element);if(gs&&gs.has(rn.triggerName)){const Eg=gs.get(rn.triggerName);Eg.value=Zs,gs.set(rn.triggerName,Eg)}}return void ir.destroy()}}const Ml=!D||!this.driver.containsElement(D,Vo),ms=$e.get(Vo),bu=B.get(Vo),_i=this._buildInstruction(rn,r,bu,ms,Ml);if(_i.errors&&_i.errors.length)return void Fe.push(_i);if(Ml)return ir.onStart(()=>Lm(Vo,_i.fromStyles)),ir.onDestroy(()=>sd(Vo,_i.toStyles)),void i.push(ir);if(rn.isFallbackTransition)return ir.onStart(()=>Lm(Vo,_i.fromStyles)),ir.onDestroy(()=>sd(Vo,_i.toStyles)),void i.push(ir);const eT=[];_i.timelines.forEach(Kn=>{Kn.stretchStartingKeyframe=!0,this.disabledNodes.has(Kn.element)||eT.push(Kn)}),_i.timelines=eT,r.append(Vo,_i.timelines),a.push({instruction:_i,player:ir,element:Vo}),_i.queriedElements.forEach(Kn=>Cl(c,Kn,[]).push(ir)),_i.preStyleProps.forEach((Kn,Zs)=>{if(Kn.size){let gs=p.get(Zs);gs||p.set(Zs,gs=new Set),Kn.forEach((Eg,n2)=>gs.add(n2))}}),_i.postStyleProps.forEach((Kn,Zs)=>{let gs=_.get(Zs);gs||_.set(Zs,gs=new Set),Kn.forEach((Eg,n2)=>gs.add(n2))})});if(Fe.length){const St=[];Fe.forEach(qt=>{St.push(function jre(){return new se(3505,!1)}())}),ve.forEach(qt=>qt.destroy()),this.reportError(St)}const We=new Map,dt=new Map;a.forEach(St=>{const qt=St.element;r.has(qt)&&(dt.set(qt,qt),this._beforeAnimationBuild(St.player.namespaceId,St.instruction,We))}),i.forEach(St=>{const qt=St.element;this._getPreviousPlayers(qt,!1,St.namespaceId,St.triggerName,null).forEach(ir=>{Cl(We,qt,[]).push(ir),ir.destroy()})});const Qt=oe.filter(St=>T3(St,p,_)),nn=new Map;E3(nn,this.driver,xe,_,yh).forEach(St=>{T3(St,p,_)&&Qt.push(St)});const gi=new Map;O.forEach((St,qt)=>{E3(gi,this.driver,new Set(St),p,"!")}),Qt.forEach(St=>{const qt=nn.get(St),rn=gi.get(St);nn.set(St,new Map([...qt?.entries()??[],...rn?.entries()??[]]))});const Xa=[],Cd=[],m0={};a.forEach(St=>{const{element:qt,player:rn,instruction:ir}=St;if(r.has(qt)){if(x.has(qt))return rn.onDestroy(()=>sd(qt,ir.toStyles)),rn.disabled=!0,rn.overrideTotalTime(ir.totalTime),void i.push(rn);let Vo=m0;if(dt.size>1){let ms=qt;const bu=[];for(;ms=ms.parentNode;){const _i=dt.get(ms);if(_i){Vo=_i;break}bu.push(ms)}bu.forEach(_i=>dt.set(_i,Vo))}const Ml=this._buildAnimation(rn.namespaceId,ir,We,o,gi,nn);if(rn.setRealPlayer(Ml),Vo===m0)Xa.push(rn);else{const ms=this.playersByElement.get(Vo);ms&&ms.length&&(rn.parentPlayer=Qf(ms)),i.push(rn)}}else Lm(qt,ir.fromStyles),rn.onDestroy(()=>sd(qt,ir.toStyles)),Cd.push(rn),x.has(qt)&&i.push(rn)}),Cd.forEach(St=>{const qt=o.get(St.element);if(qt&&qt.length){const rn=Qf(qt);St.setRealPlayer(rn)}}),i.forEach(St=>{St.parentPlayer?St.syncPlayerEvents(St.parentPlayer):St.destroy()});for(let St=0;St<oe.length;St++){const qt=oe[St],rn=qt[ou];if(Z_(qt,fk),rn&&rn.hasAnimation)continue;let ir=[];if(c.size){let Ml=c.get(qt);Ml&&Ml.length&&ir.push(...Ml);let ms=this.driver.query(qt,pk,!0);for(let bu=0;bu<ms.length;bu++){let _i=c.get(ms[bu]);_i&&_i.length&&ir.push(..._i)}}const Vo=ir.filter(Ml=>!Ml.destroyed);Vo.length?Uie(this,qt,Vo):this.processLeaveNode(qt)}return oe.length=0,Xa.forEach(St=>{this.players.push(St),St.onDone(()=>{St.destroy();const qt=this.players.indexOf(St);this.players.splice(qt,1)}),St.play()}),Xa}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,r,i,o){let a=[];if(n){const c=this.playersByQueriedElement.get(t);c&&(a=c)}else{const c=this.playersByElement.get(t);if(c){const p=!o||o==wb;c.forEach(_=>{_.queued||!p&&_.triggerName!=i||a.push(_)})}}return(r||i)&&(a=a.filter(c=>!(r&&r!=c.namespaceId||i&&i!=c.triggerName))),a}_beforeAnimationBuild(t,n,r){const o=n.element,a=n.isRemovalTransition?void 0:t,c=n.isRemovalTransition?void 0:n.triggerName;for(const p of n.timelines){const _=p.element,x=_!==o,D=Cl(r,_,[]);this._getPreviousPlayers(_,x,a,c,n.toState).forEach(O=>{const B=O.getRealPlayer();B.beforeDestroy&&B.beforeDestroy(),O.destroy(),D.push(O)})}Lm(o,n.fromStyles)}_buildAnimation(t,n,r,i,o,a){const c=n.triggerName,p=n.element,_=[],x=new Set,D=new Set,A=n.timelines.map(B=>{const Q=B.element;x.add(Q);const oe=Q[ou];if(oe&&oe.removedBeforeQueried)return new yb(B.duration,B.delay);const ye=Q!==p,xe=function jie(e){const t=[];return D3(e,t),t}((r.get(Q)||Oie).map(We=>We.getRealPlayer())).filter(We=>!!We.element&&We.element===Q),$e=o.get(Q),De=a.get(Q),ve=n3(this._normalizer,B.keyframes,$e,De),Fe=this._buildPlayer(B,ve,xe);if(B.subTimeline&&i&&D.add(Q),ye){const We=new Mk(t,c,Q);We.setRealPlayer(Fe),_.push(We)}return Fe});_.forEach(B=>{Cl(this.playersByQueriedElement,B.element,[]).push(B),B.onDone(()=>function Bie(e,t,n){let r=e.get(t);if(r){if(r.length){const i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}return r}(this.playersByQueriedElement,B.element,B))}),x.forEach(B=>_c(B,c3));const O=Qf(A);return O.onDestroy(()=>{x.forEach(B=>Z_(B,c3)),sd(p,n.toStyles)}),D.forEach(B=>{Cl(i,B,[]).push(O)}),O}_buildPlayer(t,n,r){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,r):new yb(t.duration,t.delay)}}class Mk{namespaceId;triggerName;element;_player=new yb;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(t,n,r){this.namespaceId=t,this.triggerName=n,this.element=r}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((n,r)=>{n.forEach(i=>ck(t,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){Cl(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function aC(e){return e&&1===e.nodeType}function x3(e,t){const n=e.style.display;return e.style.display=t??"none",n}function E3(e,t,n,r,i){const o=[];n.forEach(p=>o.push(x3(p)));const a=[];r.forEach((p,_)=>{const x=new Map;p.forEach(D=>{const A=t.computeStyle(_,D,i);x.set(D,A),(!A||0==A.length)&&(_[ou]=Nie,a.push(_))}),e.set(_,x)});let c=0;return n.forEach(p=>x3(p,o[c++])),a}function C3(e,t){const n=new Map;if(e.forEach(c=>n.set(c,[])),0==t.length)return n;const i=new Set(t),o=new Map;function a(c){if(!c)return 1;let p=o.get(c);if(p)return p;const _=c.parentNode;return p=n.has(_)?_:i.has(_)?1:a(_),o.set(c,p),p}return t.forEach(c=>{const p=a(c);1!==p&&n.get(p).push(c)}),n}function _c(e,t){e.classList?.add(t)}function Z_(e,t){e.classList?.remove(t)}function Uie(e,t,n){Qf(n).onDone(()=>e.processLeaveNode(t))}function D3(e,t){for(let n=0;n<e.length;n++){const r=e[n];r instanceof e3?D3(r.players,t):t.push(r)}}function T3(e,t,n){const r=n.get(e);if(!r)return!1;let i=t.get(e);return i?r.forEach(o=>i.add(o)):t.set(e,r),n.delete(e),!0}class xb{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(t,n)=>{};constructor(t,n,r){this._driver=n,this._normalizer=r,this._transitionEngine=new Fie(t.body,n,r),this._timelineEngine=new kie(t.body,n,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(t,n,r,i,o){const a=t+"-"+i;let c=this._triggerCache[a];if(!c){const p=[],x=Ek(this._driver,o,p,[]);if(p.length)throw function Rre(){return new se(3404,!1)}();c=function Die(e,t,n){return new Tie(e,t,n)}(i,x,this._normalizer),this._triggerCache[a]=c}this._transitionEngine.registerTrigger(n,i,c)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,r,i){this._transitionEngine.insertNode(t,n,r,i)}onRemove(t,n,r){this._transitionEngine.removeNode(t,n,r)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,r,i){if("@"==r.charAt(0)){const[o,a]=r3(r);this._timelineEngine.command(o,n,a,i)}else this._transitionEngine.trigger(t,n,r,i)}listen(t,n,r,i,o){if("@"==r.charAt(0)){const[a,c]=r3(r);return this._timelineEngine.listen(a,n,c,o)}return this._transitionEngine.listen(t,n,r,i,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}let qie=(()=>{class e{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(n,r,i){this._element=n,this._startStyles=r,this._endStyles=i;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&sd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(sd(this._element,this._initialStyles),this._endStyles&&(sd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Lm(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Lm(this._element,this._endStyles),this._endStyles=null),sd(this._element,this._initialStyles),this._state=3)}}return e})();function Pk(e){let t=null;return e.forEach((n,r)=>{(function Gie(e){return"display"===e||"position"===e})(r)&&(t=t||new Map,t.set(r,n))}),t}class S3{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer=null;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(t,n,r,i){this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer()&&this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return this.domPlayer;this._initialized=!0;const t=this.keyframes,n=this._triggerWebAnimation(this.element,t,this.options);if(!n)return this._onFinish(),null;this.domPlayer=n,this._finalKeyframe=t.length?t[t.length-1]:new Map;const r=()=>this._onFinish();return n.addEventListener("finish",r),this.onDestroy(()=>{n.removeEventListener("finish",r)}),n}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer?.pause()}_convertKeyframesToObject(t){const n=[];return t.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(t,n,r){const i=this._convertKeyframesToObject(n);try{return t.animate(i,r)}catch{return null}}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){const t=this._buildPlayer();t&&(this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),t.play())}pause(){this.init(),this.domPlayer?.pause()}finish(){this.init(),this.domPlayer&&(this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish())}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer?.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer||this.init(),this.domPlayer&&(this.domPlayer.currentTime=t*this.time)}getPosition(){return this.domPlayer?+(this.domPlayer.currentTime??0)/this.time:this._initialized?1:0}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&t.set(i,this._finished?r:yk(this.element,i))}),this.currentSnapshot=t}triggerCallback(t){const n="start"===t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class I3{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}containsElement(t,n){return o3(t,n)}getParentElement(t){return hk(t)}query(t,n,r){return s3(t,n,r)}computeStyle(t,n,r){return yk(t,n)}animate(t,n,r,i,o,a=[]){const p={duration:r,delay:i,fill:0==i?"both":"forwards"};o&&(p.easing=o);const _=new Map,x=a.filter(O=>O instanceof S3);(function tie(e,t){return 0===e||0===t})(r,i)&&x.forEach(O=>{O.currentSnapshot.forEach((B,Q)=>_.set(Q,B))});let D=function Qre(e){return e.length?e[0]instanceof Map?e:e.map(t=>new Map(Object.entries(t))):[]}(n).map(O=>new Map(O));D=function nie(e,t,n){if(n.size&&t.length){let r=t[0],i=[];if(n.forEach((o,a)=>{r.has(a)||i.push(a),r.set(a,o)}),i.length)for(let o=1;o<t.length;o++){let a=t[o];i.forEach(c=>a.set(c,yk(e,c)))}}return t}(t,D,_);const A=function $ie(e,t){let n=null,r=null;return Array.isArray(t)&&t.length?(n=Pk(t[0]),t.length>1&&(r=Pk(t[t.length-1]))):t instanceof Map&&(n=Pk(t)),n||r?new qie(e,n,r):null}(t,D);return new S3(t,D,p,A)}}const k3="@.disabled";class A3{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(t,n,r,i){this.namespaceId=t,this.delegate=n,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,r,i=!0){this.delegate.insertBefore(t,n,r),this.engine.onInsert(this.namespaceId,n,t,i)}removeChild(t,n,r,i){i?this.delegate.removeChild(t,n,r,i):this.parentNode(n)&&this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,r,i){this.delegate.setAttribute(t,n,r,i)}removeAttribute(t,n,r){this.delegate.removeAttribute(t,n,r)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,r,i){this.delegate.setStyle(t,n,r,i)}removeStyle(t,n,r){this.delegate.removeStyle(t,n,r)}setProperty(t,n,r){"@"==n.charAt(0)&&n==k3?this.disableAnimations(t,!!r):this.delegate.setProperty(t,n,r)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,r,i){return this.delegate.listen(t,n,r,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class Wie extends A3{factory;constructor(t,n,r,i,o){super(n,r,i,o),this.factory=t,this.namespaceId=n}setProperty(t,n,r){"@"==n.charAt(0)?"."==n.charAt(1)&&n==k3?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,n.slice(1),r):this.delegate.setProperty(t,n,r)}listen(t,n,r,i){if("@"==n.charAt(0)){const o=function Zie(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let a=n.slice(1),c="";return"@"!=a.charAt(0)&&([a,c]=function Kie(e){const t=e.indexOf(".");return[e.substring(0,t),e.slice(t+1)]}(a)),this.engine.listen(this.namespaceId,o,a,c,p=>{this.factory.scheduleListenerCallback(p._data||-1,r,p)})}return this.delegate.listen(t,n,r,i)}}class Yie{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,n.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(t,n){const i=this.delegate.createRenderer(t,n);if(!t||!n?.data?.animation){const _=this._rendererCache;let x=_.get(i);return x||(x=new A3("",i,this.engine,()=>_.delete(i)),_.set(i,x)),x}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const c=_=>{Array.isArray(_)?_.forEach(c):this.engine.registerTrigger(o,a,t,_.name,_)};return n.data.animation.forEach(c),new Wie(this,a,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){if(t>=0&&t<this._microtaskId)return void this._zone.run(()=>n(r));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),i.push([n,r])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(t){this.engine.flush(),this.delegate.componentReplaced?.(t)}}const toe=[{provide:bk,useFactory:()=>new I3},{provide:oa,useFactory:()=>"BrowserAnimations"},...[{provide:wk,useFactory:function Qie(){return new d3}},{provide:xb,useClass:(()=>{class e extends xb{constructor(n,r,i){super(n,r,i)}ngOnDestroy(){this.flush()}static \u0275fac=function(r){return new(r||e)(Ct(Fn),Ct(bk),Ct(wk))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})()},{provide:vl,useFactory:function Jie(){return new Yie(Z(tk),Z(xb),Z(Xt))}}]];function Ok(e,t){return e?t?e.endsWith("/")?t.startsWith("/")?e+t.slice(1):e+t:t.startsWith("/")?e+t:`${e}/${t}`:e:t}function M3(e){const t=e.search(/#|\?|$/);return"/"===e[t-1]?e.slice(0,t-1)+e.slice(t):e}function bh(e){return e&&"?"!==e[0]?`?${e}`:e}let Bm=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(O3),providedIn:"root"})}return e})();const P3=new Le("");let O3=(()=>{class e extends Bm{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Z(Fn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Ok(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+bh(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,o){const a=this.prepareExternalUrl(i+bh(o));this._platformLocation.pushState(n,r,a)}replaceState(n,r,i,o){const a=this.prepareExternalUrl(i+bh(o));this._platformLocation.replaceState(n,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||e)(Ct(WE),Ct(P3,8))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),K_=(()=>{class e{_subject=new K;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function ooe(e){if(new RegExp("^(https?:)?//").test(e)){const[,n]=e.split(/\/\/[^\/]+/);return n}return e}(M3(N3(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+bh(r))}normalize(n){return e.stripTrailingSlash(function ioe(e,t){if(!e||!t.startsWith(e))return t;const n=t.substring(e.length);return""===n||["/",";","?","#"].includes(n[0])?n:t}(this._basePath,N3(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bh(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+bh(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=bh;static joinWithSlash=Ok;static stripTrailingSlash=M3;static \u0275fac=function(r){return new(r||e)(Ct(Bm))};static \u0275prov=Ue({token:e,factory:()=>function roe(){return new K_(Ct(Bm))}(),providedIn:"root"})}return e})();function N3(e){return e.replace(/\/index.html$/,"")}let soe=(()=>{class e extends Bm{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){const r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=Ok(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,o){const a=this.prepareExternalUrl(i+bh(o))||this._platformLocation.pathname;this._platformLocation.pushState(n,r,a)}replaceState(n,r,i,o){const a=this.prepareExternalUrl(i+bh(o))||this._platformLocation.pathname;this._platformLocation.replaceState(n,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||e)(Ct(WE),Ct(P3,8))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();var ca=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(ca||{}),Yr=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(Yr||{}),Tl=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(Tl||{});function uC(e,t){return vc(aa(e)[fi.DateFormat],t)}function dC(e,t){return vc(aa(e)[fi.TimeFormat],t)}function hC(e,t){return vc(aa(e)[fi.DateTimeFormat],t)}function yc(e,t){const n=aa(e),r=n[fi.NumberSymbols][t];if(typeof r>"u"){if(12===t)return n[fi.NumberSymbols][0];if(13===t)return n[fi.NumberSymbols][1]}return r}function F3(e){if(!e[fi.ExtraData])throw new se(2303,!1)}function vc(e,t){for(let n=t;n>-1;n--)if(typeof e[n]<"u")return e[n];throw new se(2304,!1)}function Lk(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const boe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,fC={},woe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function xoe(e,t,n,r){let i=function Roe(e){if(z3(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[i,o=1,a=1]=e.split("-").map(c=>+c);return pC(i,o-1,a)}const n=parseFloat(e);if(!isNaN(e-n))return new Date(n);let r;if(r=e.match(boe))return function Moe(e){const t=new Date(0);let n=0,r=0;const i=e[8]?t.setUTCFullYear:t.setFullYear,o=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const a=Number(e[4]||0)-n,c=Number(e[5]||0)-r,p=Number(e[6]||0),_=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return o.call(t,a,c,p,_),t}(r)}const t=new Date(e);if(!z3(t))throw new se(2311,!1);return t}(e);t=wh(n,t)||t;let c,a=[];for(;t;){if(c=woe.exec(t),!c){a.push(t);break}{a=a.concat(c.slice(1));const x=a.pop();if(!x)break;t=x}}let p=i.getTimezoneOffset();r&&(p=V3(r,p),i=function Aoe(e,t){const i=e.getTimezoneOffset();return function koe(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(V3(t,i)-i))}(i,r));let _="";return a.forEach(x=>{const D=function Ioe(e){if(Bk[e])return Bk[e];let t;switch(e){case"G":case"GG":case"GGG":t=ri(3,Yr.Abbreviated);break;case"GGGG":t=ri(3,Yr.Wide);break;case"GGGGG":t=ri(3,Yr.Narrow);break;case"y":t=Oo(0,1,0,!1,!0);break;case"yy":t=Oo(0,2,0,!0,!0);break;case"yyy":t=Oo(0,3,0,!1,!0);break;case"yyyy":t=Oo(0,4,0,!1,!0);break;case"Y":t=yC(1);break;case"YY":t=yC(2,!0);break;case"YYY":t=yC(3);break;case"YYYY":t=yC(4);break;case"M":case"L":t=Oo(1,1,1);break;case"MM":case"LL":t=Oo(1,2,1);break;case"MMM":t=ri(2,Yr.Abbreviated);break;case"MMMM":t=ri(2,Yr.Wide);break;case"MMMMM":t=ri(2,Yr.Narrow);break;case"LLL":t=ri(2,Yr.Abbreviated,ca.Standalone);break;case"LLLL":t=ri(2,Yr.Wide,ca.Standalone);break;case"LLLLL":t=ri(2,Yr.Narrow,ca.Standalone);break;case"w":t=Fk(1);break;case"ww":t=Fk(2);break;case"W":t=Fk(1,!0);break;case"d":t=Oo(2,1);break;case"dd":t=Oo(2,2);break;case"c":case"cc":t=Oo(7,1);break;case"ccc":t=ri(1,Yr.Abbreviated,ca.Standalone);break;case"cccc":t=ri(1,Yr.Wide,ca.Standalone);break;case"ccccc":t=ri(1,Yr.Narrow,ca.Standalone);break;case"cccccc":t=ri(1,Yr.Short,ca.Standalone);break;case"E":case"EE":case"EEE":t=ri(1,Yr.Abbreviated);break;case"EEEE":t=ri(1,Yr.Wide);break;case"EEEEE":t=ri(1,Yr.Narrow);break;case"EEEEEE":t=ri(1,Yr.Short);break;case"a":case"aa":case"aaa":t=ri(0,Yr.Abbreviated);break;case"aaaa":t=ri(0,Yr.Wide);break;case"aaaaa":t=ri(0,Yr.Narrow);break;case"b":case"bb":case"bbb":t=ri(0,Yr.Abbreviated,ca.Standalone,!0);break;case"bbbb":t=ri(0,Yr.Wide,ca.Standalone,!0);break;case"bbbbb":t=ri(0,Yr.Narrow,ca.Standalone,!0);break;case"B":case"BB":case"BBB":t=ri(0,Yr.Abbreviated,ca.Format,!0);break;case"BBBB":t=ri(0,Yr.Wide,ca.Format,!0);break;case"BBBBB":t=ri(0,Yr.Narrow,ca.Format,!0);break;case"h":t=Oo(3,1,-12);break;case"hh":t=Oo(3,2,-12);break;case"H":t=Oo(3,1);break;case"HH":t=Oo(3,2);break;case"m":t=Oo(4,1);break;case"mm":t=Oo(4,2);break;case"s":t=Oo(5,1);break;case"ss":t=Oo(5,2);break;case"S":t=Oo(6,1);break;case"SS":t=Oo(6,2);break;case"SSS":t=Oo(6,3);break;case"Z":case"ZZ":case"ZZZ":t=gC(0);break;case"ZZZZZ":t=gC(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=gC(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=gC(2);break;default:return null}return Bk[e]=t,t}(x);_+=D?D(i,n,p):"''"===x?"'":x.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),_}function pC(e,t,n){const r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function wh(e,t){const n=function loe(e){return aa(e)[fi.LocaleId]}(e);if(fC[n]??={},fC[n][t])return fC[n][t];let r="";switch(t){case"shortDate":r=uC(e,Tl.Short);break;case"mediumDate":r=uC(e,Tl.Medium);break;case"longDate":r=uC(e,Tl.Long);break;case"fullDate":r=uC(e,Tl.Full);break;case"shortTime":r=dC(e,Tl.Short);break;case"mediumTime":r=dC(e,Tl.Medium);break;case"longTime":r=dC(e,Tl.Long);break;case"fullTime":r=dC(e,Tl.Full);break;case"short":const i=wh(e,"shortTime"),o=wh(e,"shortDate");r=mC(hC(e,Tl.Short),[i,o]);break;case"medium":const a=wh(e,"mediumTime"),c=wh(e,"mediumDate");r=mC(hC(e,Tl.Medium),[a,c]);break;case"long":const p=wh(e,"longTime"),_=wh(e,"longDate");r=mC(hC(e,Tl.Long),[p,_]);break;case"full":const x=wh(e,"fullTime"),D=wh(e,"fullDate");r=mC(hC(e,Tl.Full),[x,D])}return r&&(fC[n][t]=r),r}function mC(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(n,r){return null!=t&&r in t?t[r]:n})),e}function su(e,t,n="-",r,i){let o="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,o=n));let a=String(e);for(;a.length<t;)a="0"+a;return r&&(a=a.slice(a.length-t)),o+a}function Oo(e,t,n=0,r=!1,i=!1){return function(o,a){let c=function Coe(e,t){switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new se(2301,!1)}}(e,o);if((n>0||c>-n)&&(c+=n),3===e)0===c&&-12===n&&(c=12);else if(6===e)return function Eoe(e,t){return su(e,3).substring(0,t)}(c,t);const p=yc(a,5);return su(c,t,p,r,i)}}function ri(e,t,n=ca.Format,r=!1){return function(i,o){return function Doe(e,t,n,r,i,o){switch(n){case 2:return function doe(e,t,n){const r=aa(e),o=vc([r[fi.MonthsFormat],r[fi.MonthsStandalone]],t);return vc(o,n)}(t,i,r)[e.getMonth()];case 1:return function uoe(e,t,n){const r=aa(e),o=vc([r[fi.DaysFormat],r[fi.DaysStandalone]],t);return vc(o,n)}(t,i,r)[e.getDay()];case 0:const a=e.getHours(),c=e.getMinutes();if(o){const _=function moe(e){const t=aa(e);return F3(t),(t[fi.ExtraData][2]||[]).map(r=>"string"==typeof r?Lk(r):[Lk(r[0]),Lk(r[1])])}(t),x=function goe(e,t,n){const r=aa(e);F3(r);const o=vc([r[fi.ExtraData][0],r[fi.ExtraData][1]],t)||[];return vc(o,n)||[]}(t,i,r),D=_.findIndex(A=>{if(Array.isArray(A)){const[O,B]=A,Q=a>=O.hours&&c>=O.minutes,oe=a<B.hours||a===B.hours&&c<B.minutes;if(O.hours<B.hours){if(Q&&oe)return!0}else if(Q||oe)return!0}else if(A.hours===a&&A.minutes===c)return!0;return!1});if(-1!==D)return x[D]}return function coe(e,t,n){const r=aa(e),o=vc([r[fi.DayPeriodsFormat],r[fi.DayPeriodsStandalone]],t);return vc(o,n)}(t,i,r)[a<12?0:1];case 3:return function hoe(e,t){return vc(aa(e)[fi.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new se(2302,!1)}}(i,o,e,t,n,r)}}function gC(e){return function(t,n,r){const i=-1*r,o=yc(n,5),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case 0:return(i>=0?"+":"")+su(a,2,o)+su(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+su(a,1,o);case 2:return"GMT"+(i>=0?"+":"")+su(a,2,o)+":"+su(Math.abs(i%60),2,o);case 3:return 0===r?"Z":(i>=0?"+":"")+su(a,2,o)+":"+su(Math.abs(i%60),2,o);default:throw new se(2310,!1)}}}function B3(e){const t=e.getDay(),n=0===t?-3:4-t;return pC(e.getFullYear(),e.getMonth(),e.getDate()+n)}function Fk(e,t=!1){return function(n,r){let i;if(t){const o=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,a=n.getDate();i=1+Math.floor((a+o)/7)}else{const o=B3(n),a=function Soe(e){const t=pC(e,0,1).getDay();return pC(e,0,1+(t<=4?4:11)-t)}(o.getFullYear()),c=o.getTime()-a.getTime();i=1+Math.round(c/6048e5)}return su(i,e,yc(r,5))}}function yC(e,t=!1){return function(n,r){return su(B3(n).getFullYear(),e,yc(r,5),t)}}const Bk={};function V3(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function z3(e){return e instanceof Date&&!isNaN(e.valueOf())}const $k=/\s+/,$3=[];let q3=(()=>{class e{_ngEl;_renderer;initialClasses=$3;rawClass;stateMap=new Map;constructor(n,r){this._ngEl=n,this._renderer=r}set klass(n){this.initialClasses=null!=n?n.trim().split($k):$3}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split($k):n}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const r of n)this._updateState(r,!0);else if(null!=n)for(const r of Object.keys(n))this._updateState(r,!!n[r]);this._applyStateDiff()}_updateState(n,r){const i=this.stateMap.get(n);void 0!==i?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(n,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const r=n[0],i=n[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(n,r){(n=n.trim()).length>0&&n.split($k).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||e)(Re(Pr),Re(za))};static \u0275dir=At({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return e})();const lse=new Le(""),cse=new Le("");let bC=(()=>{class e{locale;defaultTimezone;defaultOptions;constructor(n,r,i){this.locale=n,this.defaultTimezone=r,this.defaultOptions=i}transform(n,r,i,o){if(null==n||""===n||n!=n)return null;try{return xoe(n,r??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,i??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(a){throw function au(e,t){return new se(2100,!1)}()}}static \u0275fac=function(r){return new(r||e)(Re(gh,16),Re(lse,24),Re(cse,24))};static \u0275pipe=Ua({name:"date",type:e,pure:!0})}return e})(),wC=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})();function bc(e,t){return function Eu(e,t){const n=Object.create(ya);n.computation=e,void 0!==t&&(n.equal=t);const r=()=>{if(Wi(n),wo(n),n.value===Zi)throw n.error;return n.value};return r[Ve]=n,r}(e,t?.equal)}function tj(e){return!!e&&(e instanceof U||cr(e.lift)&&cr(e.subscribe))}function Vm(e){return this instanceof Vm?(this.v=e,this):new Vm(e)}function Ose(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function ij(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(a){return new Promise(function(c,p){!function i(o,a,c,p){Promise.resolve(p).then(function(_){o({value:_,done:c})},a)}(c,p,(a=e[o](a)).done,a.value)})}}}Error,Error;const oj=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function sj(e){return cr(e?.then)}function aj(e){return cr(e[zl])}function lj(e){return Symbol.asyncIterator&&cr(e?.[Symbol.asyncIterator])}function cj(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const uj=function Lse(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function dj(e){return cr(e?.[uj])}function hj(e){return function Pse(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(A){r[A]&&(i[A]=function(O){return new Promise(function(B,Q){o.push([A,O,B,Q])>1||c(A,O)})})}function c(A,O){try{!function p(A){A.value instanceof Vm?Promise.resolve(A.value.v).then(_,x):D(o[0][2],A)}(r[A](O))}catch(B){D(o[0][3],B)}}function _(A){c("next",A)}function x(A){c("throw",A)}function D(A,O){A(O),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:i}=yield Vm(n.read());if(i)return yield Vm(void 0);yield yield Vm(r)}}finally{n.releaseLock()}})}function fj(e){return cr(e?.getReader)}function wc(e){if(e instanceof U)return e;if(null!=e){if(aj(e))return function Fse(e){return new U(t=>{const n=e[zl]();if(cr(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(oj(e))return function Bse(e){return new U(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(sj(e))return function Vse(e){return new U(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,Cu)})}(e);if(lj(e))return pj(e);if(dj(e))return function zse(e){return new U(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(fj(e))return function Use(e){return pj(hj(e))}(e)}throw cj(e)}function pj(e){return new U(t=>{(function jse(e,t){var n,r,i,o;return function Rse(e,t,n,r){return new(n||(n=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(D){a(D)}}function p(x){try{_(r.throw(x))}catch(D){a(D)}}function _(x){x.done?o(x.value):function i(o){return o instanceof n?o:new n(function(a){a(o)})}(x.value).then(c,p)}_((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=Ose(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(a){i={error:a}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function xh(e,t,n,r=0,i=!1){const o=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!i)return o}function mj(e,t=0){return Io((n,r)=>{n.subscribe(new ei(r,i=>xh(r,e,()=>r.next(i),t),()=>xh(r,e,()=>r.complete(),t),i=>xh(r,e,()=>r.error(i),t)))})}function gj(e,t=0){return Io((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function _j(e,t){if(!e)throw new Error("Iterable cannot be null");return new U(n=>{xh(n,t,()=>{const r=e[Symbol.asyncIterator]();xh(n,t,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function ds(e,t){return t?function Zse(e,t){if(null!=e){if(aj(e))return function Hse(e,t){return wc(e).pipe(gj(t),mj(t))}(e,t);if(oj(e))return function qse(e,t){return new U(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(sj(e))return function $se(e,t){return wc(e).pipe(gj(t),mj(t))}(e,t);if(lj(e))return _j(e,t);if(dj(e))return function Gse(e,t){return new U(n=>{let r;return xh(n,t,()=>{r=e[uj](),xh(n,t,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(a){return void n.error(a)}o?n.complete():n.next(i)},0,!0)}),()=>cr(r?.return)&&r.return()})}(e,t);if(fj(e))return function Wse(e,t){return _j(hj(e),t)}(e,t)}throw cj(e)}(e,t):wc(e)}function yj(e){return e&&cr(e.schedule)}function Xk(e){return e[e.length-1]}function vj(e){return cr(Xk(e))?e.pop():void 0}function Cb(e){return yj(Xk(e))?e.pop():void 0}function Sn(...e){return ds(e,Cb(e))}const{isArray:Yse}=Array,{getPrototypeOf:Xse,prototype:Qse,keys:Jse}=Object;function bj(e){if(1===e.length){const t=e[0];if(Yse(t))return{args:t,keys:null};if(function eae(e){return e&&"object"==typeof e&&Xse(e)===Qse}(t)){const n=Jse(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}const{isArray:tae}=Array;function wj(e){return ar(t=>function nae(e,t){return tae(t)?e(...t):e(t)}(e,t))}function xj(e,t){return e.reduce((n,r,i)=>(n[r]=t[i],n),{})}function Qk(...e){const t=Cb(e),n=vj(e),{args:r,keys:i}=bj(e);if(0===r.length)return ds([],t);const o=new U(function rae(e,t,n=Xn){return r=>{Ej(t,()=>{const{length:i}=e,o=new Array(i);let a=i,c=i;for(let p=0;p<i;p++)Ej(t,()=>{const _=ds(e[p],t);let x=!1;_.subscribe(new ei(r,D=>{o[p]=D,x||(x=!0,c--),c||r.next(n(o.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,t,i?a=>xj(i,a):Xn));return n?o.pipe(wj(n)):o}function Ej(e,t,n){e?xh(n,e,t):t()}const Jk=Xo(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function xc(e,t,n=1/0){return cr(t)?xc((r,i)=>ar((o,a)=>t(r,o,i,a))(wc(e(r,i))),n):("number"==typeof t&&(n=t),Io((r,i)=>function iae(e,t,n,r,i,o,a,c){const p=[];let _=0,x=0,D=!1;const A=()=>{D&&!p.length&&!_&&t.complete()},O=Q=>_<r?B(Q):p.push(Q),B=Q=>{o&&t.next(Q),_++;let oe=!1;wc(n(Q,x++)).subscribe(new ei(t,ye=>{i?.(ye),o?O(ye):t.next(ye)},()=>{oe=!0},void 0,()=>{if(oe)try{for(_--;p.length&&_<r;){const ye=p.shift();a?xh(t,a,()=>B(ye)):B(ye)}A()}catch(ye){t.error(ye)}}))};return e.subscribe(new ei(t,O,()=>{D=!0,A()})),()=>{c?.()}}(r,i,e,n)))}function X_(e=1/0){return xc(Xn,e)}function xC(...e){return function oae(){return X_(1)}()(ds(e,Cb(e)))}function Db(e){return new U(t=>{wc(e()).subscribe(t)})}const ua=new U(e=>e.complete());function As(e,t){return Io((n,r)=>{let i=0;n.subscribe(new ei(r,o=>e.call(t,o,i++)&&r.next(o)))})}function Rs(e){return e<=0?()=>ua:Io((t,n)=>{let r=0;t.subscribe(new ei(n,i=>{++r<=e&&(n.next(i),e<=r&&n.complete())}))})}function cae(e=uae){return Io((t,n)=>{let r=!1;t.subscribe(new ei(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(e())))})}function uae(){return new Jk}function zm(e,t){const n=arguments.length>=2;return r=>r.pipe(e?As((i,o)=>e(i,o,r)):Xn,Rs(1),n?function lae(e){return Io((t,n)=>{let r=!1;t.subscribe(new ei(n,i=>{r=!0,n.next(i)},()=>{r||n.next(e),n.complete()}))})}(t):cae(()=>new Jk))}function qa(e,t){return Io((n,r)=>{let i=null,o=0,a=!1;const c=()=>a&&!i&&r.complete();n.subscribe(new ei(r,p=>{i?.unsubscribe();let _=0;const x=o++;wc(e(p,x)).subscribe(i=new ei(r,D=>r.next(t?t(p,D,x,_++):D),()=>{i=null,c()}))},()=>{a=!0,c()}))})}function Q_(...e){const t=Cb(e);return Io((n,r)=>{(t?xC(e,n,t):xC(e,n)).subscribe(r)})}function ad(e){return Io((t,n)=>{wc(e).subscribe(new ei(n,()=>n.complete(),xa)),!n.closed&&t.subscribe(n)})}function EC(e,t){return cr(t)?xc(e,t,1):xc(e,1)}function Eh(e,t,n){const r=cr(e)||t||n?{next:e,error:t,complete:n}:e;return r?Io((i,o)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let c=!0;i.subscribe(new ei(o,p=>{var _;null===(_=r.next)||void 0===_||_.call(r,p),o.next(p)},()=>{var p;c=!1,null===(p=r.complete)||void 0===p||p.call(r),o.complete()},p=>{var _;c=!1,null===(_=r.error)||void 0===_||_.call(r,p),o.error(p)},()=>{var p,_;c&&(null===(p=r.unsubscribe)||void 0===p||p.call(r)),null===(_=r.finalize)||void 0===_||_.call(r)}))}):Xn}function Cj(e){return e<=0?()=>ua:Io((t,n)=>{let r=[];t.subscribe(new ei(n,i=>{r.push(i),e<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function eA(e){return Io((t,n)=>{let o,r=null,i=!1;r=t.subscribe(new ei(n,void 0,void 0,a=>{o=wc(e(a,eA(e)(t))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function Dj(e){return Io((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}let dae=(()=>{class e{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||e)(Ct(Fn))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ij=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:function(r){let i=null;return i=r?new(r||e):Ct(mae),i},providedIn:"root"})}return e})(),mae=(()=>{class e extends Ij{_doc;constructor(n){super(),this._doc=n}sanitize(n,r){if(null==r)return null;switch(n){case _l.NONE:return r;case _l.HTML:return nd(r,"HTML")?gl(r):S2(this._doc,String(r)).toString();case _l.STYLE:return nd(r,"Style")?gl(r):r;case _l.SCRIPT:if(nd(r,"Script"))return gl(r);throw new se(5200,!1);case _l.URL:return nd(r,"URL")?gl(r):Sx(String(r));case _l.RESOURCE_URL:if(nd(r,"ResourceURL"))return gl(r);throw new se(5201,!1);default:throw new se(5202,!1)}}bypassSecurityTrustHtml(n){return function kW(e){return new EW(e)}(n)}bypassSecurityTrustStyle(n){return function AW(e){return new CW(e)}(n)}bypassSecurityTrustScript(n){return function RW(e){return new DW(e)}(n)}bypassSecurityTrustUrl(n){return function MW(e){return new TW(e)}(n)}bypassSecurityTrustResourceUrl(n){return function PW(e){return new SW(e)}(n)}static \u0275fac=function(r){return new(r||e)(Ct(Fn))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const In="primary",Sb=Symbol("RouteTitle");class gae{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function J_(e){return new gae(e)}function tA(e,t,n){for(let r=0;r<e.length;r++){const i=e[r],o=t[r];if(":"===i[0])n[i.substring(1)]=o;else if(i!==o.path)return!1}return!0}function _ae(e,t,n){const r=n.path.split("/"),i=r.indexOf("**");if(-1===i){if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const p={},_=e.slice(0,r.length);return tA(r,_,p)?{consumed:_,posParams:p}:null}if(i!==r.lastIndexOf("**"))return null;const o=r.slice(0,i),a=r.slice(i+1);if(o.length+a.length>e.length||"full"===n.pathMatch&&t.hasChildren()&&"**"!==n.path)return null;const c={};return tA(o,e.slice(0,o.length),c)&&tA(a,e.slice(e.length-a.length),c)?{consumed:e,posParams:c}:null}function CC(e){return new Promise((t,n)=>{e.pipe(zm()).subscribe({next:r=>t(r),error:r=>n(r)})})}function ld(e,t){const n=e?nA(e):void 0,r=t?nA(t):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!kj(e[i],t[i]))return!1;return!0}function nA(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function kj(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((i,o)=>r[o]===i)}return e===t}function Um(e){return tj(e)?e:Jv(e)?ds(Promise.resolve(e)):Sn(e)}function Aj(e){return tj(e)?CC(e):Promise.resolve(e)}const bae={exact:function Mj(e,t,n){if(!jm(e.segments,t.segments)||!DC(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!e.children[r]||!Mj(e.children[r],t.children[r],n))return!1;return!0},subset:Pj},Rj={exact:function xae(e,t){return ld(e,t)},subset:function Eae(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>kj(e[n],t[n]))},ignored:()=>!0};function rA(e,t,n){return bae[n.paths](e.root,t.root,n.matrixParams)&&Rj[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function Pj(e,t,n){return Oj(e,t,t.segments,n)}function Oj(e,t,n,r){if(e.segments.length>n.length){const i=e.segments.slice(0,n.length);return!(!jm(i,n)||t.hasChildren()||!DC(i,n,r))}if(e.segments.length===n.length){if(!jm(e.segments,n)||!DC(e.segments,n,r))return!1;for(const i in t.children)if(!e.children[i]||!Pj(e.children[i],t.children[i],r))return!1;return!0}{const i=n.slice(0,e.segments.length),o=n.slice(e.segments.length);return!!(jm(e.segments,i)&&DC(e.segments,i,r)&&e.children[In])&&Oj(e.children[In],t,o,r)}}function DC(e,t,n){return t.every((r,i)=>Rj[n](e[i].parameters,r.parameters))}class cd{root;queryParams;fragment;_queryParamMap;constructor(t=new $r([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=J_(this.queryParams),this._queryParamMap}toString(){return Tae.serialize(this)}}class $r{segments;children;parent=null;constructor(t,n){this.segments=t,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return TC(this)}}class Ib{path;parameters;_parameterMap;constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=J_(this.parameters),this._parameterMap}toString(){return Fj(this)}}function jm(e,t){return e.length===t.length&&e.every((n,r)=>n.path===t[r].path)}let kb=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>new Ab,providedIn:"root"})}return e})();class Ab{parse(t){const n=new Fae(t);return new cd(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Rb(t.root,!0)}`,r=function kae(e){const t=Object.entries(e).map(([n,r])=>Array.isArray(r)?r.map(i=>`${SC(n)}=${SC(i)}`).join("&"):`${SC(n)}=${SC(r)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${r}${"string"==typeof t.fragment?`#${function Sae(e){return encodeURI(e)}(t.fragment)}`:""}`}}const Tae=new Ab;function TC(e){return e.segments.map(t=>Fj(t)).join("/")}function Rb(e,t){if(!e.hasChildren())return TC(e);if(t){const n=e.children[In]?Rb(e.children[In],!1):"",r=[];return Object.entries(e.children).forEach(([i,o])=>{i!==In&&r.push(`${i}:${Rb(o,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function Dae(e,t){let n=[];return Object.entries(e.children).forEach(([r,i])=>{r===In&&(n=n.concat(t(i,r)))}),Object.entries(e.children).forEach(([r,i])=>{r!==In&&(n=n.concat(t(i,r)))}),n}(e,(r,i)=>i===In?[Rb(e.children[In],!1)]:[`${i}:${Rb(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[In]?`${TC(e)}/${n[0]}`:`${TC(e)}/(${n.join("//")})`}}function Nj(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function SC(e){return Nj(e).replace(/%3B/gi,";")}function iA(e){return Nj(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function IC(e){return decodeURIComponent(e)}function Lj(e){return IC(e.replace(/\+/g,"%20"))}function Fj(e){return`${iA(e.path)}${function Iae(e){return Object.entries(e).map(([t,n])=>`;${iA(t)}=${iA(n)}`).join("")}(e.parameters)}`}const Aae=/^[^\/()?;#]+/;function oA(e){const t=e.match(Aae);return t?t[0]:""}const Rae=/^[^\/()?;=#]+/,Pae=/^[^=?&#]+/,Nae=/^[^&#]+/;class Fae{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new $r([],{}):new $r([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[In]=new $r(t,n)),r}parseSegment(){const t=oA(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(t),new Ib(IC(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=function Mae(e){const t=e.match(Rae);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=oA(this.remaining);i&&(r=i,this.capture(r))}t[IC(n)]=IC(r)}parseQueryParam(t){const n=function Oae(e){const t=e.match(Pae);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const a=function Lae(e){const t=e.match(Nae);return t?t[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const i=Lj(n),o=Lj(r);if(t.hasOwnProperty(i)){let a=t[i];Array.isArray(a)||(a=[a],t[i]=a),a.push(o)}else t[i]=o}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=oA(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new se(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=In);const a=this.parseChildren();n[o??In]=1===Object.keys(a).length&&a[In]?a[In]:new $r([],a),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new se(4011,!1)}}function Bj(e){return e.segments.length>0?new $r([],{[In]:e}):e}function Vj(e){const t={};for(const[r,i]of Object.entries(e.children)){const o=Vj(i);if(r===In&&0===o.segments.length&&o.hasChildren())for(const[a,c]of Object.entries(o.children))t[a]=c;else(o.segments.length>0||o.hasChildren())&&(t[r]=o)}return function Bae(e){if(1===e.numberOfChildren&&e.children[In]){const t=e.children[In];return new $r(e.segments.concat(t.segments),t.children)}return e}(new $r(e.segments,t))}function Hm(e){return e instanceof cd}function zj(e){let t;const i=Bj(function n(o){const a={};for(const p of o.children){const _=n(p);a[p.outlet]=_}const c=new $r(o.url,a);return o===e&&(t=c),c}(e.root));return t??i}function Uj(e,t,n,r,i){let o=e;for(;o.parent;)o=o.parent;if(0===t.length)return sA(o,o,o,n,r,i);const a=function zae(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new $j(!0,0,e);let t=0,n=!1;const r=e.reduce((i,o,a)=>{if("object"==typeof o&&null!=o){if(o.outlets){const c={};return Object.entries(o.outlets).forEach(([p,_])=>{c[p]="string"==typeof _?_.split("/"):_}),[...i,{outlets:c}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===a?(o.split("/").forEach((c,p)=>{0==p&&"."===c||(0==p&&""===c?n=!0:".."===c?t++:""!=c&&i.push(c))}),i):[...i,o]},[]);return new $j(n,t,r)}(t);if(a.toRoot())return sA(o,o,new $r([],{}),n,r,i);const c=function Uae(e,t,n){if(e.isAbsolute)return new AC(t,!0,0);if(!n)return new AC(t,!1,NaN);if(null===n.parent)return new AC(n,!0,0);const r=kC(e.commands[0])?0:1;return function jae(e,t,n){let r=e,i=t,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new se(4005,!1);i=r.segments.length}return new AC(r,!1,i-o)}(n,n.segments.length-1+r,e.numberOfDoubleDots)}(a,o,e),p=c.processChildren?Pb(c.segmentGroup,c.index,a.commands):qj(c.segmentGroup,c.index,a.commands);return sA(o,c.segmentGroup,p,n,r,i)}function kC(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Mb(e){return"object"==typeof e&&null!=e&&e.outlets}function jj(e,t,n){e||="\u0275";const r=new cd;return r.queryParams={[e]:t},n.parse(n.serialize(r)).queryParams[e]}function sA(e,t,n,r,i,o){const a={};for(const[_,x]of Object.entries(r??{}))a[_]=Array.isArray(x)?x.map(D=>jj(_,D,o)):jj(_,x,o);let c;c=e===t?n:Hj(e,t,n);const p=Bj(Vj(c));return new cd(p,a,i)}function Hj(e,t,n){const r={};return Object.entries(e.children).forEach(([i,o])=>{r[i]=o===t?n:Hj(o,t,n)}),new $r(e.segments,r)}class $j{isAbsolute;numberOfDoubleDots;commands;constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&kC(r[0]))throw new se(4003,!1);const i=r.find(Mb);if(i&&i!==function vae(e){return e.length>0?e[e.length-1]:null}(r))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class AC{segmentGroup;processChildren;index;constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}}function qj(e,t,n){if(e??=new $r([],{}),0===e.segments.length&&e.hasChildren())return Pb(e,t,n);const r=function $ae(e,t,n){let r=0,i=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=n.length)return o;const a=e.segments[i],c=n[r];if(Mb(c))break;const p=`${c}`,_=r<n.length-1?n[r+1]:null;if(i>0&&void 0===p)break;if(p&&_&&"object"==typeof _&&void 0===_.outlets){if(!Wj(p,_,a))return o;r+=2}else{if(!Wj(p,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const o=new $r(e.segments.slice(0,r.pathIndex),{});return o.children[In]=new $r(e.segments.slice(r.pathIndex),e.children),Pb(o,0,i)}return r.match&&0===i.length?new $r(e.segments,{}):r.match&&!e.hasChildren()?aA(e,t,n):r.match?Pb(e,0,i):aA(e,t,n)}function Pb(e,t,n){if(0===n.length)return new $r(e.segments,{});{const r=function Hae(e){return Mb(e[0])?e[0].outlets:{[In]:e}}(n),i={};if(Object.keys(r).some(o=>o!==In)&&e.children[In]&&1===e.numberOfChildren&&0===e.children[In].segments.length){const o=Pb(e.children[In],t,n);return new $r(e.segments,o.children)}return Object.entries(r).forEach(([o,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(i[o]=qj(e.children[o],t,a))}),Object.entries(e.children).forEach(([o,a])=>{void 0===r[o]&&(i[o]=a)}),new $r(e.segments,i)}}function aA(e,t,n){const r=e.segments.slice(0,t);let i=0;for(;i<n.length;){const o=n[i];if(Mb(o)){const p=qae(o.outlets);return new $r(r,p)}if(0===i&&kC(n[0])){r.push(new Ib(e.segments[t].path,Gj(n[0]))),i++;continue}const a=Mb(o)?o.outlets[In]:`${o}`,c=i<n.length-1?n[i+1]:null;a&&c&&kC(c)?(r.push(new Ib(a,Gj(c))),i+=2):(r.push(new Ib(a,{})),i++)}return new $r(r,{})}function qae(e){const t={};return Object.entries(e).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(t[n]=aA(new $r([],{}),0,r))}),t}function Gj(e){const t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function Wj(e,t,n){return e==n.path&&ld(t,n.parameters)}const Ob="imperative";var rr=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(rr||{});class ud{id;url;constructor(t,n){this.id=t,this.url=n}}class RC extends ud{type=rr.NavigationStart;navigationTrigger;restoredState;constructor(t,n,r="imperative",i=null){super(t,n),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ch extends ud{urlAfterRedirects;type=rr.NavigationEnd;constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Ga=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e[e.Aborted=4]="Aborted",e}(Ga||{}),MC=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(MC||{});class ep extends ud{reason;code;type=rr.NavigationCancel;constructor(t,n,r,i){super(t,n),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ey extends ud{reason;code;type=rr.NavigationSkipped;constructor(t,n,r,i){super(t,n),this.reason=r,this.code=i}}class lA extends ud{error;target;type=rr.NavigationError;constructor(t,n,r,i){super(t,n),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Zj extends ud{urlAfterRedirects;state;type=rr.RoutesRecognized;constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wae extends ud{urlAfterRedirects;state;type=rr.GuardsCheckStart;constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zae extends ud{urlAfterRedirects;state;shouldActivate;type=rr.GuardsCheckEnd;constructor(t,n,r,i,o){super(t,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Kae extends ud{urlAfterRedirects;state;type=rr.ResolveStart;constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yae extends ud{urlAfterRedirects;state;type=rr.ResolveEnd;constructor(t,n,r,i){super(t,n),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xae{route;type=rr.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Qae{route;type=rr.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Jae{snapshot;type=rr.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ele{snapshot;type=rr.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tle{snapshot;type=rr.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nle{snapshot;type=rr.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kj{routerEvent;position;anchor;scrollBehavior;type=rr.Scroll;constructor(t,n,r,i){this.routerEvent=t,this.position=n,this.anchor=r,this.scrollBehavior=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class cA{}class PC{url;navigationBehaviorOptions;constructor(t,n){this.url=t,this.navigationBehaviorOptions=n}}class ile{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new Nb(this.rootInjector)}}let Nb=(()=>{class e{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new ile(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||e)(Ct(Fr))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Yj{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=uA(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){const n=uA(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=dA(t,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==t)}pathFromRoot(t){return dA(t,this._root).map(n=>n.value)}}function uA(e,t){if(e===t.value)return t;for(const n of t.children){const r=uA(e,n);if(r)return r}return null}function dA(e,t){if(e===t.value)return[t];for(const n of t.children){const r=dA(e,n);if(r.length)return r.unshift(t),r}return[]}class lu{value;children;constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function ty(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class Xj extends Yj{snapshot;constructor(t,n){super(t),this.snapshot=n,hA(this,t)}toString(){return this.snapshot.toString()}}function Qj(e,t){const n=function ole(e,t){const a=new NC([],{},{},"",{},In,e,null,{},t);return new Jj("",new lu(a,[]))}(e,t),r=new re([new Ib("",{})]),i=new re({}),o=new re({}),a=new re({}),c=new re(""),p=new $m(r,i,a,c,o,In,e,n.root);return p.snapshot=n.root,new Xj(new lu(p,[]),n)}class $m{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,n,r,i,o,a,c,p){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=a,this.component=c,this._futureSnapshot=p,this.title=this.dataSubject?.pipe(ar(_=>_[Sb]))??Sn(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ar(t=>J_(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ar(t=>J_(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function OC(e,t,n="emptyOnly"){let r;const{routeConfig:i}=e;return r=null===t||"always"!==n&&""!==i?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...e.params},data:{...e.data},resolve:{...e.data,...e._resolvedData??{}}}:{params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.data,...i?.data,...e._resolvedData}},i&&t4(i)&&(r.resolve[Sb]=i.title),r}class NC{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[Sb]}constructor(t,n,r,i,o,a,c,p,_,x){this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=c,this.routeConfig=p,this._resolve=_,this._environmentInjector=x}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=J_(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=J_(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Jj extends Yj{url;constructor(t,n){super(n),this.url=t,hA(this,n)}toString(){return e4(this._root)}}function hA(e,t){t.value._routerState=e,t.children.forEach(n=>hA(e,n))}function e4(e){const t=e.children.length>0?` { ${e.children.map(e4).join(", ")} } `:"";return`${e.value}${t}`}function fA(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,ld(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),ld(t.params,n.params)||e.paramsSubject.next(n.params),function yae(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!ld(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.urlSubject.next(n.url),ld(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function pA(e,t){const n=ld(e.params,t.params)&&function Cae(e,t){return jm(e,t)&&e.every((n,r)=>ld(n.parameters,t[r].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||pA(e.parent,t.parent))}function t4(e){return"string"==typeof e.title||null===e.title}const sle=new Le("");let mA=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=In;activateEvents=new Bn;deactivateEvents=new Bn;attachEvents=new Bn;detachEvents=new Bn;routerOutletData=ite();parentContexts=Z(Nb);location=Z(bl);changeDetector=Z(_h);inputBinder=Z(LC,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=n;const i=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,p=new ale(n,c,i.injector,this.routerOutletData);this.activated=i.createComponent(a,{index:i.length,injector:p,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[ko]})}return e})();class ale{route;childContexts;parent;outletData;constructor(t,n,r,i){this.route=t,this.childContexts=n,this.parent=r,this.outletData=i}get(t,n){return t===$m?this.route:t===Nb?this.childContexts:t===sle?this.outletData:this.parent.get(t,n)}}const LC=new Le("");let n4=(()=>{class e{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,i=Qk([r.queryParams,r.params,r.data]).pipe(qa(([o,a,c],p)=>(c={...o,...a,...c},0===p?Sn(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const a=function one(e){const t=en(e);if(!t)return null;const n=new Gv(t);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(r.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,i)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})(),r4=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){1&r&&pn(0,"router-outlet")},dependencies:[mA],encapsulation:2})}return e})();function gA(e){const t=e.children&&e.children.map(gA),n=t?{...e,children:t}:{...e};return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==In&&(n.component=r4),n}function Lb(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const i=function cle(e,t,n){return t.children.map(r=>{for(const i of n.children)if(e.shouldReuseRoute(r.value,i.value.snapshot))return Lb(e,r,i);return Lb(e,r)})}(e,t,n);return new lu(r,i)}{if(e.shouldAttach(t.value)){const o=e.retrieve(t.value);if(null!==o){const a=o.route;return a.value._futureSnapshot=t.value,a.children=t.children.map(c=>Lb(e,c)),a}}const r=function ule(e){return new $m(new re(e.url),new re(e.params),new re(e.queryParams),new re(e.fragment),new re(e.data),e.outlet,e.component,e)}(t.value),i=t.children.map(o=>Lb(e,o));return new lu(r,i)}}class _A{redirectTo;navigationBehaviorOptions;constructor(t,n){this.redirectTo=t,this.navigationBehaviorOptions=n}}const i4="ngNavigationCancelingError";function FC(e,t){const{redirectTo:n,navigationBehaviorOptions:r}=Hm(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,i=o4(!1,Ga.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function o4(e,t){const n=new Error(`NavigationCancelingError: ${e||""}`);return n[i4]=!0,n.cancellationCode=t,n}function s4(e){return!!e&&e[i4]}class hle{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,n,r,i,o){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(t){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),fA(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){const i=ty(n);t.children.forEach(o=>{const a=o.value.outlet;this.deactivateRoutes(o,i[a],r),delete i[a]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(t,n,r){const i=t.value,o=n?n.value:null;if(i===o)if(i.component){const a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(t,n,a.children)}else this.deactivateChildRoutes(t,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=ty(t);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){const a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:a,route:t,contexts:c})}}deactivateRouteAndOutlet(t,n){const r=n.getContext(t.value.outlet),i=r&&t.value.component?r.children:n,o=ty(t);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){const i=ty(n);t.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new nle(o.value.snapshot))}),t.children.length&&this.forwardEvent(new ele(t.value.snapshot))}activateRoutes(t,n,r){const i=t.value,o=n?n.value:null;if(fA(i),i===o)if(i.component){const a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(t,n,a.children)}else this.activateChildRoutes(t,n,r);else if(i.component){const a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),fA(c.route.value),this.activateChildRoutes(t,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(t,null,a.children)}else this.activateChildRoutes(t,null,r)}}class a4{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class BC{component;route;constructor(t,n){this.component=t,this.route=n}}function fle(e,t,n){const r=e._root;return Fb(r,t?t._root:null,n,[r.value])}function ny(e,t){const n=Symbol(),r=t.get(e,n);return r===n?"function"!=typeof e||function Dg(e){return null!==Gh(e)}(e)?t.get(e):e:r}function Fb(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=ty(t);return e.children.forEach(a=>{(function mle(e,t,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,a=t?t.value:null,c=n?n.getContext(e.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const p=function gle(e,t,n){if("function"==typeof n)return Oi(t._environmentInjector,()=>n(e,t));switch(n){case"pathParamsChange":return!jm(e.url,t.url);case"pathParamsOrQueryParamsChange":return!jm(e.url,t.url)||!ld(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!pA(e,t)||!ld(e.queryParams,t.queryParams);default:return!pA(e,t)}}(a,o,o.routeConfig.runGuardsAndResolvers);p?i.canActivateChecks.push(new a4(r)):(o.data=a.data,o._resolvedData=a._resolvedData),Fb(e,t,o.component?c?c.children:null:n,r,i),p&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new BC(c.outlet.component,a))}else a&&Bb(t,c,i),i.canActivateChecks.push(new a4(r)),Fb(e,null,o.component?c?c.children:null:n,r,i)})(a,o[a.value.outlet],n,r.concat([a.value]),i),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,c])=>Bb(c,n.getContext(a),i)),i}function Bb(e,t,n){const r=ty(e),i=e.value;Object.entries(r).forEach(([o,a])=>{Bb(a,i.component?t?t.children.getContext(o):null:t,n)}),n.canDeactivateChecks.push(new BC(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}function Vb(e){return"function"==typeof e}function l4(e){return e instanceof Jk||"EmptyError"===e?.name}const VC=Symbol("INITIAL_VALUE");function ry(){return qa(e=>Qk(e.map(t=>t.pipe(Rs(1),Q_(VC)))).pipe(ar(t=>{for(const n of t)if(!0!==n){if(n===VC)return VC;if(!1===n||Ele(n))return n}return!0}),As(t=>t!==VC),Rs(1)))}function Ele(e){return Hm(e)||e instanceof _A}function c4(e){return e.aborted?Sn(void 0).pipe(Rs(1)):new U(t=>{const n=()=>{t.next(),t.complete()};return e.addEventListener("abort",n),()=>e.removeEventListener("abort",n)})}function u4(e){return ad(c4(e))}function d4(e){return function F(...e){return z(e)}(Eh(t=>{if("boolean"!=typeof t)throw FC(0,t)}),ar(t=>!0===t))}class Dh extends Error{segmentGroup;constructor(t){super(),this.segmentGroup=t||null,Object.setPrototypeOf(this,Dh.prototype)}}class zb extends Error{urlTree;constructor(t){super(),this.urlTree=t,Object.setPrototypeOf(this,zb.prototype)}}function Ole(e){throw new se(4e3,!1)}class Lle{urlSerializer;urlTree;constructor(t,n){this.urlSerializer=t,this.urlTree=n}lineralizeSegments(t,n){return _e(function*(){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return r;if(i.numberOfChildren>1||!i.children[In])throw Ole();i=i.children[In]}})()}applyRedirectCommands(t,n,r,i,o){var a=this;return _e(function*(){const c=yield function Fle(e,t,n){if("string"==typeof e)return Promise.resolve(e);const r=e,{queryParams:i,fragment:o,routeConfig:a,url:c,outlet:p,params:_,data:x,title:D,paramMap:A,queryParamMap:O}=t;return CC(Um(Oi(n,()=>r({params:_,data:x,queryParams:i,fragment:o,routeConfig:a,url:c,outlet:p,title:D,paramMap:A,queryParamMap:O}))))}(n,i,o);if(c instanceof cd)throw new zb(c);const p=a.applyRedirectCreateUrlTree(c,a.urlSerializer.parse(c),t,r);if("/"===c[0])throw new zb(p);return p})()}applyRedirectCreateUrlTree(t,n,r,i){const o=this.createSegmentGroup(t,n.root,r,i);return new cd(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const r={};return Object.entries(t).forEach(([i,o])=>{if("string"==typeof o&&":"===o[0]){const c=o.substring(1);r[i]=n[c]}else r[i]=o}),r}createSegmentGroup(t,n,r,i){const o=this.createSegments(t,n.segments,r,i);let a={};return Object.entries(n.children).forEach(([c,p])=>{a[c]=this.createSegmentGroup(t,p,r,i)}),new $r(o,a)}createSegments(t,n,r,i){return n.map(o=>":"===o.path[0]?this.findPosParam(t,o,i):this.findOrReturn(o,r))}findPosParam(t,n,r){const i=r[n.path.substring(1)];if(!i)throw new se(4001,!1);return i}findOrReturn(t,n){let r=0;for(const i of n){if(i.path===t.path)return n.splice(r),i;r++}return t}}function cu(e){return e.outlet||In}function jle(e,t){const n=e.filter(r=>cu(r)===t);return n.push(...e.filter(r=>cu(r)!==t)),n}const yA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Hle(e,t,n,r,i,o){const a=h4(e,t,n);return a.matched?(r=function Ble(e,t){return e.providers&&!e._injector&&(e._injector=sE(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,r),function Ple(e,t,n,r,i){const o=t.canMatch;return o&&0!==o.length?Sn(o.map(c=>{const p=ny(c,e);return Um(function xle(e){return e&&Vb(e.canMatch)}(p)?p.canMatch(t,n):Oi(e,()=>p(t,n))).pipe(u4(i))})).pipe(ry(),d4()):Sn(!0)}(r,t,n,0,o).pipe(ar(c=>!0===c?a:{...yA}))):Sn(a)}function h4(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{...yA}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(t.matcher||_ae)(n,e,t);if(!i)return{...yA};const o={};Object.entries(i.posParams??{}).forEach(([c,p])=>{o[c]=p.path});const a=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function f4(e,t,n,r){return n.length>0&&function Gle(e,t,n){return n.some(r=>zC(e,t,r)&&cu(r)!==In)}(e,n,r)?{segmentGroup:new $r(t,qle(r,new $r(n,e.children))),slicedSegments:[]}:0===n.length&&function Wle(e,t,n){return n.some(r=>zC(e,t,r))}(e,n,r)?{segmentGroup:new $r(e.segments,$le(e,n,r,e.children)),slicedSegments:n}:{segmentGroup:new $r(e.segments,e.children),slicedSegments:n}}function $le(e,t,n,r){const i={};for(const o of n)if(zC(e,t,o)&&!r[cu(o)]){const a=new $r([],{});i[cu(o)]=a}return{...r,...i}}function qle(e,t){const n={};n[In]=t;for(const r of e)if(""===r.path&&cu(r)!==In){const i=new $r([],{});n[cu(r)]=i}return n}function zC(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}class Kle{}function vA(){return(vA=_e(function*(e,t,n,r,i,o,a="emptyOnly",c){return new Qle(e,t,n,r,i,a,o,c).recognize()})).apply(this,arguments)}class Qle{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,n,r,i,o,a,c,p){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.abortSignal=p,this.applyRedirects=new Lle(this.urlSerializer,this.urlTree)}noMatchError(t){return new se(4002,`'${t.segmentGroup}'`)}recognize(){var t=this;return _e(function*(){const n=f4(t.urlTree.root,[],[],t.config).segmentGroup,{children:r,rootSnapshot:i}=yield t.match(n),o=new lu(i,r),a=new Jj("",o),c=function Vae(e,t,n=null,r=null,i=new Ab){return Uj(zj(e),t,n,r,i)}(i,[],t.urlTree.queryParams,t.urlTree.fragment);return c.queryParams=t.urlTree.queryParams,a.url=t.urlSerializer.serialize(c),{state:a,tree:c}})()}match(t){var n=this;return _e(function*(){const r=new NC([],Object.freeze({}),Object.freeze({...n.urlTree.queryParams}),n.urlTree.fragment,Object.freeze({}),In,n.rootComponentType,null,{},n.injector);try{return{children:yield n.processSegmentGroup(n.injector,n.config,t,In,r),rootSnapshot:r}}catch(i){if(i instanceof zb)return n.urlTree=i.urlTree,n.match(i.urlTree.root);throw i instanceof Dh?n.noMatchError(i):i}})()}processSegmentGroup(t,n,r,i,o){var a=this;return _e(function*(){if(0===r.segments.length&&r.hasChildren())return a.processChildren(t,n,r,o);const c=yield a.processSegment(t,n,r,r.segments,i,!0,o);return c instanceof lu?[c]:[]})()}processChildren(t,n,r,i){var o=this;return _e(function*(){const a=[];for(const _ of Object.keys(r.children))"primary"===_?a.unshift(_):a.push(_);let c=[];for(const _ of a){const x=r.children[_],D=jle(n,_),A=yield o.processSegmentGroup(t,D,x,_,i);c.push(...A)}const p=p4(c);return function Jle(e){e.sort((t,n)=>t.value.outlet===In?-1:n.value.outlet===In?1:t.value.outlet.localeCompare(n.value.outlet))}(p),p})()}processSegment(t,n,r,i,o,a,c){var p=this;return _e(function*(){for(const _ of n)try{return yield p.processSegmentAgainstRoute(_._injector??t,n,_,r,i,o,a,c)}catch(x){if(x instanceof Dh||l4(x))continue;throw x}if(function Zle(e,t,n){return 0===t.length&&!e.children[n]}(r,i,o))return new Kle;throw new Dh(r)})()}processSegmentAgainstRoute(t,n,r,i,o,a,c,p){var _=this;return _e(function*(){if(cu(r)!==a&&(a===In||!zC(i,o,r)))throw new Dh(i);if(void 0===r.redirectTo)return _.matchSegmentAgainstRoute(t,i,r,o,a,p);if(_.allowRedirects&&c)return _.expandSegmentAgainstRouteUsingRedirect(t,i,n,r,o,a,p);throw new Dh(i)})()}expandSegmentAgainstRouteUsingRedirect(t,n,r,i,o,a,c){var p=this;return _e(function*(){const{matched:_,parameters:x,consumedSegments:D,positionalParamSegments:A,remainingSegments:O}=h4(n,i,o);if(!_)throw new Dh(n);"string"==typeof i.redirectTo&&"/"===i.redirectTo[0]&&(p.absoluteRedirectCount++,p.absoluteRedirectCount>31&&(p.allowRedirects=!1));const B=new NC(o,x,Object.freeze({...p.urlTree.queryParams}),p.urlTree.fragment,m4(i),cu(i),i.component??i._loadedComponent??null,i,g4(i),t),Q=OC(B,c,p.paramsInheritanceStrategy);if(B.params=Object.freeze(Q.params),B.data=Object.freeze(Q.data),p.abortSignal.aborted)throw new Error(p.abortSignal.reason);const oe=yield p.applyRedirects.applyRedirectCommands(D,i.redirectTo,A,B,t),ye=yield p.applyRedirects.lineralizeSegments(i,oe);return p.processSegment(t,r,n,ye.concat(O),a,!1,c)})()}matchSegmentAgainstRoute(t,n,r,i,o,a){var c=this;return _e(function*(){if(c.abortSignal.aborted)throw new Error(c.abortSignal.reason);const p=yield CC(Hle(n,r,i,t,0,c.abortSignal));if("**"===r.path&&(n.children={}),!p?.matched)throw new Dh(n);t=r._injector??t;const{routes:_}=yield c.getChildConfig(t,r,i),x=r._loadedInjector??t,{parameters:D,consumedSegments:A,remainingSegments:O}=p,B=new NC(A,D,Object.freeze({...c.urlTree.queryParams}),c.urlTree.fragment,m4(r),cu(r),r.component??r._loadedComponent??null,r,g4(r),t),Q=OC(B,a,c.paramsInheritanceStrategy);B.params=Object.freeze(Q.params),B.data=Object.freeze(Q.data);const{segmentGroup:oe,slicedSegments:ye}=f4(n,A,O,_);if(0===ye.length&&oe.hasChildren()){const De=yield c.processChildren(x,_,oe,B);return new lu(B,De)}if(0===_.length&&0===ye.length)return new lu(B,[]);const xe=cu(r)===o,$e=yield c.processSegment(x,_,oe,ye,xe?In:o,!0,B);return new lu(B,$e instanceof lu?[$e]:[])})()}getChildConfig(t,n,r){var i=this;return _e(function*(){if(n.children)return{routes:n.children,injector:t};if(n.loadChildren){if(void 0!==n._loadedRoutes){const a=n._loadedNgModuleFactory;return a&&!n._loadedInjector&&(n._loadedInjector=a.create(t).injector),{routes:n._loadedRoutes,injector:n._loadedInjector}}if(i.abortSignal.aborted)throw new Error(i.abortSignal.reason);if(yield CC(function Mle(e,t,n,r,i){const o=t.canLoad;return void 0===o||0===o.length?Sn(!0):Sn(o.map(c=>{const p=ny(c,e),x=Um(function yle(e){return e&&Vb(e.canLoad)}(p)?p.canLoad(t,n):Oi(e,()=>p(t,n)));return i?x.pipe(u4(i)):x})).pipe(ry(),d4())}(t,n,r,0,i.abortSignal))){const a=yield i.configLoader.loadChildren(t,n);return n._loadedRoutes=a.routes,n._loadedInjector=a.injector,n._loadedNgModuleFactory=a.factory,a}throw function Nle(){throw o4(!1,Ga.GuardRejected)}()}return{routes:[],injector:t}})()}}function ece(e){const t=e.value.routeConfig;return t&&""===t.path}function p4(e){const t=[],n=new Set;for(const r of e){if(!ece(r)){t.push(r);continue}const i=t.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):t.push(r)}for(const r of n){const i=p4(r.children);t.push(new lu(r.value,i))}return t.filter(r=>!n.has(r))}function m4(e){return e.data||{}}function g4(e){return e.resolve||{}}function _4(e){const t=e.children.map(n=>_4(n)).flat();return[e,...t]}function y4(e){return qa(t=>{const n=e(t);return n?ds(n).pipe(ar(()=>t)):Sn(t)})}let v4=(()=>{class e{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===In);return r}getResolvedTitleForRoute(n){return n.data[Sb]}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(sce),providedIn:"root"})}return e})(),sce=(()=>{class e extends v4{title;constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||e)(Ct(dae))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const iy=new Le("",{factory:()=>({})}),Ub=new Le("");let bA=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Z($ee);loadComponent(n,r){var i=this;return _e(function*(){if(i.componentLoaders.get(r))return i.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);i.onLoadStartListener&&i.onLoadStartListener(r);const o=_e(function*(){try{const a=yield Aj(Oi(n,()=>r.loadComponent())),c=yield w4(b4(a));return i.onLoadEndListener&&i.onLoadEndListener(r),r._loadedComponent=c,c}finally{i.componentLoaders.delete(r)}})();return i.componentLoaders.set(r,o),o})()}loadChildren(n,r){var i=this;if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=_e(function*(){try{const a=yield function ace(e,t,n,r){return wA.apply(this,arguments)}(r,i.compiler,n,i.onLoadEndListener);return r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,a}finally{i.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function wA(){return(wA=_e(function*(e,t,n,r){const i=yield Aj(Oi(n,()=>e.loadChildren())),o=yield w4(b4(i));let a;a=o instanceof RF||Array.isArray(o)?o:yield t.compileModuleAsync(o),r&&r(e);let c,p,x;return Array.isArray(a)?p=a:(c=a.create(n).injector,x=a,p=c.get(Ub,[],{optional:!0,self:!0}).flat()),{routes:p.map(gA),injector:c,factory:x}})).apply(this,arguments)}function b4(e){return function lce(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}function w4(e){return xA.apply(this,arguments)}function xA(){return(xA=_e(function*(e){return e})).apply(this,arguments)}let EA=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(cce),providedIn:"root"})}return e})(),cce=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const x4=new Le(""),E4=new Le("");function uce(e,t,n){const r=e.get(E4),i=e.get(Fn);if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(_=>setTimeout(_));let o;const a=new Promise(_=>{o=_}),c=i.startViewTransition(()=>(o(),function dce(e){return new Promise(t=>{iu({read:()=>setTimeout(t)},{injector:e})})}(e)));c.updateCallbackDone.catch(_=>{}),c.ready.catch(_=>{}),c.finished.catch(_=>{});const{onViewTransitionCreated:p}=r;return p&&Oi(e,()=>p({transition:c,from:t,to:n})),a}const hce=()=>{},C4=new Le("");let CA=(()=>{class e{currentNavigation=as(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=as(null);events=new K;transitionAbortWithErrorSubject=new K;configLoader=Z(bA);environmentInjector=Z(Fr);destroyRef=Z(tr);urlSerializer=Z(kb);rootContexts=Z(Nb);location=Z(K_);inputBindingEnabled=null!==Z(LC,{optional:!0});titleStrategy=Z(v4);options=Z(iy,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Z(EA);createViewTransition=Z(x4,{optional:!0});navigationErrorHandler=Z(C4,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>Sn(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=i=>this.events.next(new Qae(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new Xae(i)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;mr(()=>{this.transitions?.next({...n,extractedUrl:this.urlHandlingStrategy.extract(n.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r})})}setupNavigations(n){return this.transitions=new re(null),this.transitions.pipe(As(r=>null!==r),qa(r=>{let i=!1;const o=new AbortController,a=()=>!i&&this.currentTransition?.id===r.id;return Sn(r).pipe(qa(c=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Ga.SupersededByNewNavigation),ua;this.currentTransition=r;const p=this.lastSuccessfulNavigation();this.currentNavigation.set({id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:"string"==typeof c.extras.browserUrl?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:p?{...p,previousNavigation:null}:null,abort:()=>o.abort()});const _=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!_&&"reload"!==(c.extras.onSameUrlNavigation??n.onSameUrlNavigation))return this.events.next(new ey(c.id,this.urlSerializer.serialize(c.rawUrl),"",MC.IgnoredSameUrlNavigation)),c.resolve(!1),ua;if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Sn(c).pipe(qa(D=>(this.events.next(new RC(D.id,this.urlSerializer.serialize(D.extractedUrl),D.source,D.restoredState)),D.id!==this.navigationId?ua:Promise.resolve(D))),function tce(e,t,n,r,i,o,a){return xc(function(){var c=_e(function*(p){const{state:_,tree:x}=yield function Yle(e,t,n,r,i,o){return vA.apply(this,arguments)}(e,t,n,r,p.extractedUrl,i,o,a);return{...p,targetSnapshot:_,urlAfterRedirects:x}});return function(p){return c.apply(this,arguments)}}())}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),Eh(D=>{r.targetSnapshot=D.targetSnapshot,r.urlAfterRedirects=D.urlAfterRedirects,this.currentNavigation.update(O=>(O.finalUrl=D.urlAfterRedirects,O));const A=new Zj(D.id,this.urlSerializer.serialize(D.extractedUrl),this.urlSerializer.serialize(D.urlAfterRedirects),D.targetSnapshot);this.events.next(A)}));if(_&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:D,extractedUrl:A,source:O,restoredState:B,extras:Q}=c,oe=new RC(D,this.urlSerializer.serialize(A),O,B);this.events.next(oe);const ye=Qj(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=r={...c,targetSnapshot:ye,urlAfterRedirects:A,extras:{...Q,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.update(xe=>(xe.finalUrl=A,xe)),Sn(r)}return this.events.next(new ey(c.id,this.urlSerializer.serialize(c.extractedUrl),"",MC.IgnoredByUrlHandlingStrategy)),c.resolve(!1),ua}),ar(c=>{const p=new Wae(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);return this.events.next(p),this.currentTransition=r={...c,guards:fle(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},r}),function Cle(e){return xc(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:i,canDeactivateChecks:o}}=t;return 0===o.length&&0===i.length?Sn({...t,guardsResult:!0}):function Dle(e,t,n){return ds(e).pipe(xc(r=>function Rle(e,t,n,r){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Sn(i.map(a=>{const c=t._environmentInjector,p=ny(a,c);return Um(function wle(e){return e&&Vb(e.canDeactivate)}(p)?p.canDeactivate(e,t,n,r):Oi(c,()=>p(e,t,n,r))).pipe(zm())})).pipe(ry()):Sn(!0)}(r.component,r.route,n,t)),zm(r=>!0!==r,!0))}(o,n,r).pipe(xc(a=>a&&function _le(e){return"boolean"==typeof e}(a)?function Tle(e,t,n){return ds(t).pipe(EC(r=>xC(function Ile(e,t){return null!==e&&t&&t(new Jae(e)),Sn(!0)}(r.route.parent,n),function Sle(e,t){return null!==e&&t&&t(new tle(e)),Sn(!0)}(r.route,n),function Ale(e,t){const n=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function ple(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(o)).filter(o=>null!==o).map(o=>Db(()=>Sn(o.guards.map(c=>{const p=o.node._environmentInjector,_=ny(c,p);return Um(function ble(e){return e&&Vb(e.canActivateChild)}(_)?_.canActivateChild(n,e):Oi(p,()=>_(n,e))).pipe(zm())})).pipe(ry())));return Sn(i).pipe(ry())}(e,r.path),function kle(e,t){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Sn(!0);const r=n.map(i=>Db(()=>{const o=t._environmentInjector,a=ny(i,o);return Um(function vle(e){return e&&Vb(e.canActivate)}(a)?a.canActivate(t,e):Oi(o,()=>a(t,e))).pipe(zm())}));return Sn(r).pipe(ry())}(e,r.route))),zm(r=>!0!==r,!0))}(n,i,e):Sn(a)),ar(a=>({...t,guardsResult:a})))})}(c=>this.events.next(c)),qa(c=>{if(r.guardsResult=c.guardsResult,c.guardsResult&&"boolean"!=typeof c.guardsResult)throw FC(0,c.guardsResult);const p=new Zae(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);if(this.events.next(p),!a())return ua;if(!c.guardsResult)return this.cancelNavigationTransition(c,"",Ga.GuardRejected),ua;if(0===c.guards.canActivateChecks.length)return Sn(c);const _=new Kae(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);if(this.events.next(_),!a())return ua;let x=!1;return Sn(c).pipe(function nce(e){return xc(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Sn(t);const i=new Set(r.map(c=>c.route)),o=new Set;for(const c of i)if(!o.has(c))for(const p of _4(c))o.add(p);let a=0;return ds(o).pipe(EC(c=>i.has(c)?function rce(e,t,n){const r=e.routeConfig,i=e._resolve;return void 0!==r?.title&&!t4(r)&&(i[Sb]=r.title),Db(()=>(e.data=OC(e,e.parent,n).resolve,function ice(e,t,n){const r=nA(e);if(0===r.length)return Sn({});const i={};return ds(r).pipe(xc(o=>function oce(e,t,n){const r=t._environmentInjector,i=ny(e,r);return Um(i.resolve?i.resolve(t,n):Oi(r,()=>i(t,n)))}(e[o],t,n).pipe(zm(),Eh(a=>{if(a instanceof _A)throw FC(new Ab,a);i[o]=a}))),Cj(1),ar(()=>i),eA(o=>l4(o)?ua:function aae(e,t){const n=cr(e)?e:()=>e,r=i=>i.error(n());return new U(t?i=>t.schedule(r,0,i):r)}(o)))}(i,e,t).pipe(ar(o=>(e._resolvedData=o,e.data={...e.data,...o},null)))))}(c,n,e):(c.data=OC(c,c.parent,e).resolve,Sn(void 0))),Eh(()=>a++),Cj(1),xc(c=>a===o.size?Sn(t):ua))})}(this.paramsInheritanceStrategy),Eh({next:()=>{x=!0;const D=new Yae(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(D)},complete:()=>{x||this.cancelNavigationTransition(c,"",Ga.NoDataFromResolver)}}))}),y4(c=>{const p=x=>{const D=[];x.routeConfig?._loadedComponent?x.component=x.routeConfig?._loadedComponent:x.routeConfig?.loadComponent&&D.push(this.configLoader.loadComponent(x._environmentInjector,x.routeConfig).then(O=>{x.component=O}));for(const A of x.children)D.push(...p(A));return D},_=p(c.targetSnapshot.root);return 0===_.length?Sn(c):ds(Promise.all(_).then(()=>c))}),y4(()=>this.afterPreactivation()),qa(()=>{const{currentSnapshot:c,targetSnapshot:p}=r,_=this.createViewTransition?.(this.environmentInjector,c.root,p.root);return _?ds(_).pipe(ar(()=>r)):Sn(r)}),Rs(1),ar(c=>{const p=function lle(e,t,n){const r=Lb(e,t._root,n?n._root:void 0);return new Xj(r,t)}(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);this.currentTransition=r=c={...c,targetRouterState:p},this.currentNavigation.update(_=>(_.targetRouterState=p,_)),this.events.next(new cA),a()&&(new hle(n.routeReuseStrategy,r.targetRouterState,r.currentRouterState,_=>this.events.next(_),this.inputBindingEnabled).activate(this.rootContexts),a()&&(i=!0,this.currentNavigation.update(_=>(_.abort=hce,_)),this.lastSuccessfulNavigation.set(mr(this.currentNavigation)),this.events.next(new Ch(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)))}),ad(c4(o.signal).pipe(As(()=>!i&&!r.targetRouterState),Eh(()=>{this.cancelNavigationTransition(r,o.signal.reason+"",Ga.Aborted)}))),Eh({complete:()=>{i=!0}}),ad(this.transitionAbortWithErrorSubject.pipe(Eh(c=>{throw c}))),Dj(()=>{o.abort(),i||this.cancelNavigationTransition(r,"",Ga.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),eA(c=>{if(i=!0,this.destroyed)return r.resolve(!1),ua;if(s4(c))this.events.next(new ep(r.id,this.urlSerializer.serialize(r.extractedUrl),c.message,c.cancellationCode)),function dle(e){return s4(e)&&Hm(e.url)}(c)?this.events.next(new PC(c.url,c.navigationBehaviorOptions)):r.resolve(!1);else{const p=new lA(r.id,this.urlSerializer.serialize(r.extractedUrl),c,r.targetSnapshot??void 0);try{const _=Oi(this.environmentInjector,()=>this.navigationErrorHandler?.(p));if(!(_ instanceof _A))throw this.events.next(p),c;{const{message:x,cancellationCode:D}=FC(0,_);this.events.next(new ep(r.id,this.urlSerializer.serialize(r.extractedUrl),x,D)),this.events.next(new PC(_.redirectTo,_.navigationBehaviorOptions))}}catch(_){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(_)}}return ua}))}))}cancelNavigationTransition(n,r,i){const o=new ep(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=mr(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return n.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function fce(e){return e!==Ob}const pce=new Le("");let mce=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(_ce),providedIn:"root"})}return e})();class gce{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}shouldDestroyInjector(t){return!0}}let _ce=(()=>{class e extends gce{static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),T4=(()=>{class e{urlSerializer=Z(kb);options=Z(iy,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=Z(K_);urlHandlingStrategy=Z(EA);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new cd;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:n,initialUrl:r,targetBrowserUrl:i}){const o=void 0!==n?this.urlHandlingStrategy.merge(n,r):r,a=i??o;return a instanceof cd?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:n,finalUrl:r,initialUrl:i}){r&&n?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=n):this.rawUrlTree=i}routerState=Qj(null,Z(Fr));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:()=>Z(yce),providedIn:"root"})}return e})(),yce=(()=>{class e extends T4{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{"popstate"===r.type&&setTimeout(()=>{n(r.url,r.state,"popstate")})})}handleRouterEvent(n,r){n instanceof RC?this.updateStateMemento():n instanceof ey?this.commitTransition(r):n instanceof Zj?"eager"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof cA?(this.commitTransition(r),"deferred"===this.urlUpdateStrategy&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof ep&&!function Gae(e){return e instanceof ep&&(e.code===Ga.Redirect||e.code===Ga.SupersededByNewNavigation)}(n)?this.restoreHistory(r):n instanceof lA?this.restoreHistory(r,!0):n instanceof Ch&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,{extras:r,id:i}){const{replaceUrl:o,state:a}=r;if(this.location.isCurrentPathEqualTo(n)||o){const c=this.browserPageId,p={...a,...this.generateNgRouterState(i,c)};this.location.replaceState(n,"",p)}else{const c={...a,...this.generateNgRouterState(i,this.browserPageId+1)};this.location.go(n,"",c)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.getCurrentUrlTree()===n.finalUrl&&0===o&&(this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:n}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function S4(e,t){e.events.pipe(As(n=>n instanceof Ch||n instanceof ep||n instanceof lA||n instanceof ey),ar(n=>n instanceof Ch||n instanceof ey?0:n instanceof ep&&(n.code===Ga.Redirect||n.code===Ga.SupersededByNewNavigation)?2:1),As(n=>2!==n),Rs(1)).subscribe(()=>{t()})}const I4={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},k4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ms=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Z(iB);stateManager=Z(T4);options=Z(iy,{optional:!0})||{};pendingTasks=Z(Na);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Z(CA);urlSerializer=Z(kb);location=Z(K_);urlHandlingStrategy=Z(EA);injector=Z(Fr);_events=new K;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Z(mce);injectorCleanup=Z(pce,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Z(Ub,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Z(LC,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:n=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Hn;subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,o=mr(this.navigationTransitions.currentNavigation);if(null!==i&&null!==o)if(this.stateManager.handleRouterEvent(r,o),r instanceof ep&&r.code!==Ga.Redirect&&r.code!==Ga.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ch)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(r instanceof PC){const a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),p={scroll:i.extras.scroll,browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||"eager"===this.urlUpdateStrategy||fce(i.source),...a};this.scheduleNavigation(c,Ob,null,p,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function rle(e){return!(e instanceof cA||e instanceof PC)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ob,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r,i)=>{this.navigateToSyncWithBrowser(n,i,r)})}navigateToSyncWithBrowser(n,r,i){const o={replaceUrl:!0},a=i?.navigationId?i:null;if(i){const p={...i};delete p.navigationId,delete p.\u0275routerPageId,0!==Object.keys(p).length&&(o.state=p)}const c=this.parseUrl(n);this.scheduleNavigation(c,r,a,o).catch(p=>{this.disposed||this.injector.get(hl)(p)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return mr(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(gA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:i,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:p}=r,_=p?this.currentUrlTree.fragment:a;let D,x=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":x={...this.currentUrlTree.queryParams,...o};break;case"preserve":x=this.currentUrlTree.queryParams;break;default:x=o||null}null!==x&&(x=this.removeEmptyProps(x));try{D=zj(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||"/"!==n[0][0])&&(n=[]),D=this.currentUrlTree.root}return Uj(D,n,x,_??null,this.urlSerializer)}navigateByUrl(n,r={skipLocationChange:!1}){const i=Hm(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Ob,null,r)}navigate(n,r={skipLocationChange:!1}){return function vce(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new se(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.console.warn(Nt(4018,!1)),this.urlSerializer.parse("/")}}isActive(n,r){let i;if(i=!0===r?{...I4}:!1===r?{...k4}:r,Hm(n))return rA(this.currentUrlTree,n,i);const o=this.parseUrl(n);return rA(this.currentUrlTree,o,i)}removeEmptyProps(n){return Object.entries(n).reduce((r,[i,o])=>(null!=o&&(r[i]=o),r),{})}scheduleNavigation(n,r,i,o,a){if(this.disposed)return Promise.resolve(!1);let c,p,_;a?(c=a.resolve,p=a.reject,_=a.promise):_=new Promise((D,A)=>{c=D,p=A});const x=this.pendingTasks.add();return S4(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(x))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:p,promise:_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_.catch(D=>Promise.reject(D))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),tp=(()=>{class e{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=as(null);get href(){return mr(this.reactiveHref)}set href(n){this.reactiveHref.set(n)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new K;applicationErrorHandler=Z(hl);options=Z(iy,{optional:!0});constructor(n,r,i,o,a,c){this.router=n,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=a,this.locationStrategy=c,this.reactiveHref.set(Z(new nte("href"),{optional:!0}));const p=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===p||"area"===p||!("object"!=typeof customElements||!customElements.get(p)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){void 0===this.subscription&&(this.subscription=this.router.events.subscribe(n=>{n instanceof Ch&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(n){null==n?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=Hm(n)||Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,r,i,o,a){const c=this.urlTree;if(null===c||this.isAnchorElement&&(0!==n||r||i||o||a||"string"==typeof this.target&&"_self"!=this.target))return!0;const p={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,p)?.catch(_=>{this.applicationErrorHandler(_)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const n=this.urlTree;this.reactiveHref.set(null!==n&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n))??"":null)}applyAttributeValue(n,r){const i=this.renderer,o=this.el.nativeElement;null!==r?i.setAttribute(o,n,r):i.removeAttribute(o,n)}get urlTree(){return null===this.routerLinkInput?null:Hm(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||e)(Re(Ms),Re($m),If("tabindex"),Re(za),Re(Pr),Re(Bm))};static \u0275dir=At({type:e,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){1&r&&tn("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&r&&$s("href",i.reactiveHref(),N2)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",us],skipLocationChange:[2,"skipLocationChange","skipLocationChange",us],replaceUrl:[2,"replaceUrl","replaceUrl",us],routerLink:"routerLink"},features:[ko]})}return e})(),TA=(()=>{class e{router;element;renderer;cdr;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new Bn;link=Z(tp,{optional:!0});constructor(n,r,i,o){this.router=n,this.element=r,this.renderer=i,this.cdr=o,this.routerEventsSubscription=n.events.subscribe(a=>{a instanceof Ch&&this.update()})}ngAfterContentInit(){Sn(this.links.changes,Sn(null)).pipe(X_()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const n=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=ds(n).pipe(X_()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(n){const r=Array.isArray(n)?n:n.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const n=this.hasActiveLinks();this.classes.forEach(r=>{n?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),n&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.isActiveChange.emit(n))})}isLinkActive(n){const r=function bce(e){return!!e.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact?{...I4}:{...k4};return i=>{const o=i.urlTree;return!!o&&mr(function wae(e,t,n){const r=e instanceof cd?e:t.parseUrl(e);return bc(()=>rA(t.lastSuccessfulNavigation()?.finalUrl??new cd,r,n))}(o,n,r))}}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}static \u0275fac=function(r){return new(r||e)(Re(Ms),Re(Pr),Re(za),Re(_h))};static \u0275dir=At({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,o){if(1&r&&xI(o,tp,5),2&r){let a;Zf(a=Kf())&&(i.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[ko]})}return e})();class A4{}let wce=(()=>{class e{router;injector;preloadingStrategy;loader;subscription;constructor(n,r,i,o){this.router=n,this.injector=r,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(As(n=>n instanceof Ch),EC(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription?.unsubscribe()}processRoutes(n,r){const i=[];for(const o of r){o.providers&&!o._injector&&(o._injector=sE(o.providers,n,""));const a=o._injector??n;o._loadedNgModuleFactory&&!o._loadedInjector&&(o._loadedInjector=o._loadedNgModuleFactory.create(a).injector);const c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ds(i).pipe(X_())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{if(n.destroyed)return Sn(null);let i;i=r.loadChildren&&void 0===r.canLoad?ds(this.loader.loadChildren(n,r)):Sn(null);const o=i.pipe(xc(a=>null===a?Sn(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,this.processRoutes(a.injector??n,a.routes))));return r.loadComponent&&!r._loadedComponent?ds([o,this.loader.loadComponent(n,r)]).pipe(X_()):o})}static \u0275fac=function(r){return new(r||e)(Ct(Ms),Ct(Fr),Ct(A4),Ct(bA))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const SA=new Le("");let R4=(()=>{class e{options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=Ob;restoredId=0;store={};urlSerializer=Z(kb);zone=Z(Xt);viewportScroller=Z(AU);transitions=Z(CA);constructor(n){this.options=n,this.options.scrollPositionRestoration||="disabled",this.options.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof RC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Ch?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof ey&&n.code===MC.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{if(!(n instanceof Kj)||"manual"===n.scrollBehavior)return;const r={behavior:"instant"};n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0],r):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position,r):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(n,r){var i=this;const o=mr(this.transitions.currentNavigation)?.extras.scroll;this.zone.runOutsideAngular(_e(function*(){yield new Promise(a=>{setTimeout(a),typeof requestAnimationFrame<"u"&&requestAnimationFrame(a)}),i.zone.run(()=>{i.transitions.events.next(new Kj(n,"popstate"===i.lastSource?i.store[i.restoredId]:null,r,o))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){!function JL(){throw new Error("invalid")}()};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();function M4(){return Z(Ms).routerState.root}function Ec(e,t){return{\u0275kind:e,\u0275providers:t}}function P4(){const e=Z(En);return t=>{const n=e.get(wl);if(t!==n.components[0])return;const r=e.get(Ms),i=e.get(O4);1===e.get(IA)&&r.initialNavigation(),e.get(N4,null,{optional:!0})?.setUpPreloading(),e.get(SA,null,{optional:!0})?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const O4=new Le("",{factory:()=>new K}),IA=new Le("",{factory:()=>1}),N4=new Le("");function Sce(e){return Ec(0,[{provide:N4,useExisting:wce},{provide:A4,useExisting:e}])}function kce(e){return qo("NgRouterViewTransitions"),Ec(9,[{provide:x4,useValue:uce},{provide:E4,useValue:{skipNextTransition:!!e?.skipInitialTransition,...e}}])}const Ace=[K_,{provide:kb,useClass:Ab},Ms,Nb,{provide:$m,useFactory:M4},bA,[]];let jb=(()=>{class e{constructor(){}static forRoot(n,r){return{ngModule:e,providers:[Ace,[],{provide:Ub,multi:!0,useValue:n},[],r?.errorHandler?{provide:C4,useValue:r.errorHandler}:[],{provide:iy,useValue:r||{}},r?.useHash?{provide:Bm,useClass:soe}:{provide:Bm,useClass:O3},{provide:SA,useFactory:()=>{const e=Z(AU),t=Z(iy);return t.scrollOffset&&e.setOffset(t.scrollOffset),new R4(t)}},r?.preloadingStrategy?Sce(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Oce(r):[],r?.bindToComponentInputs?Ec(8,[n4,{provide:LC,useExisting:n4}]).\u0275providers:[],r?.enableViewTransitions?kce().\u0275providers:[],[{provide:L4,useFactory:P4},{provide:ZS,multi:!0,useExisting:L4}]]}}static forChild(n){return{ngModule:e,providers:[{provide:Ub,multi:!0,useValue:n}]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})();function Oce(e){return["disabled"===e.initialNavigation?Ec(3,[WS(()=>{Z(Ms).setUpLocationChangeListener()}),{provide:IA,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Ec(2,[{provide:cm,useValue:!0},{provide:IA,useValue:0},WS(()=>{const t=Z(En);return t.get(lne,Promise.resolve()).then(()=>new Promise(r=>{const i=t.get(Ms),o=t.get(O4);S4(i,()=>{r(!0)}),t.get(CA).afterPreactivation=()=>(r(!0),o.closed?Sn(void 0):o),i.initialNavigation()}))})]).\u0275providers:[]]}const L4=new Le("");class uu{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const i=n.slice(0,r),o=n.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((n,r)=>{this.addHeaderEntry(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof uu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new uu;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof uu?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,n);const i=("a"===t.op?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":const o=t.value;if(o){let a=this.headers.get(n);if(!a)return;a=a.filter(c=>-1===o.indexOf(c)),0===a.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,a)}else this.headers.delete(n),this.normalizedNames.delete(n)}}addHeaderEntry(t,n){const r=t.toLowerCase();this.maybeSetNormalizedName(t,r),this.headers.has(r)?this.headers.get(r).push(n):this.headers.set(r,[n])}setHeaderEntries(t,n){const r=(Array.isArray(n)?n:[n]).map(o=>o.toString()),i=t.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(t,i)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class Lce{map=new Map;set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}class Fce{encodeKey(t){return F4(t)}encodeValue(t){return F4(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Vce=/%(\d[a-f0-9])/gi,zce={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function F4(e){return encodeURIComponent(e).replace(Vce,(t,n)=>zce[n]??t)}function UC(e){return`${e}`}class np{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new Fce,t.fromString){if(t.fromObject)throw new se(2805,!1);this.map=function Bce(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[a,c]=-1==o?[t.decodeKey(i),""]:[t.decodeKey(i.slice(0,o)),t.decodeValue(i.slice(o+1))],p=n.get(a)||[];p.push(c),n.set(a,p)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const r=t.fromObject[n],i=Array.isArray(r)?r.map(UC):[UC(r)];this.map.set(n,i)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(r=>{const i=t[r];Array.isArray(i)?i.forEach(o=>{n.push({param:r,value:o,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new np({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(UC(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const i=r.indexOf(UC(t.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function B4(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function V4(e){return typeof Blob<"u"&&e instanceof Blob}function z4(e){return typeof FormData<"u"&&e instanceof FormData}const Hb="Content-Type",U4="text/plain",j4="application/json",H4=`${j4}, ${U4}, */*`;class $b{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(t,n,r,i){let o;if(this.url=n,this.method=t.toUpperCase(),function Uce(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),"number"==typeof o.timeout){if(o.timeout<1||!Number.isInteger(o.timeout))throw new se(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),o.referrerPolicy&&(this.referrerPolicy=o.referrerPolicy),this.transferCache=o.transferCache}if(this.headers??=new uu,this.context??=new Lce,this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{const c=n.indexOf("?");this.urlWithParams=n+(-1===c?"?":c<n.length-1?"&":"")+a}}else this.params=new np,this.urlWithParams=n}serializeBody(){return null===this.body?null:"string"==typeof this.body||B4(this.body)||V4(this.body)||z4(this.body)||function jce(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)?this.body:this.body instanceof np?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||z4(this.body)?null:V4(this.body)?this.body.type||null:B4(this.body)?null:"string"==typeof this.body?U4:this.body instanceof np?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?j4:null}clone(t={}){const n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=t.keepalive??this.keepalive,a=t.priority||this.priority,c=t.cache||this.cache,p=t.mode||this.mode,_=t.redirect||this.redirect,x=t.credentials||this.credentials,D=t.referrer||this.referrer,A=t.integrity||this.integrity,O=t.referrerPolicy||this.referrerPolicy,B=t.transferCache??this.transferCache,Q=t.timeout??this.timeout,oe=void 0!==t.body?t.body:this.body,ye=t.withCredentials??this.withCredentials,xe=t.reportProgress??this.reportProgress;let $e=t.headers||this.headers,De=t.params||this.params;const ve=t.context??this.context;return void 0!==t.setHeaders&&($e=Object.keys(t.setHeaders).reduce((Fe,We)=>Fe.set(We,t.setHeaders[We]),$e)),t.setParams&&(De=Object.keys(t.setParams).reduce((Fe,We)=>Fe.set(We,t.setParams[We]),De)),new $b(n,r,oe,{params:De,headers:$e,context:ve,reportProgress:xe,responseType:i,withCredentials:ye,transferCache:B,keepalive:o,cache:c,priority:a,timeout:Q,mode:p,redirect:_,credentials:x,referrer:D,integrity:A,referrerPolicy:O})}}var rp=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(rp||{});class kA{headers;status;statusText;url;ok;type;redirected;responseType;constructor(t,n=200,r="OK"){this.headers=t.headers||new uu,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.redirected=t.redirected,this.responseType=t.responseType,this.ok=this.status>=200&&this.status<300}}class HC extends kA{constructor(t={}){super(t)}type=rp.ResponseHeader;clone(t={}){return new HC({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class qb extends kA{body;constructor(t={}){super(t),this.body=void 0!==t.body?t.body:null}type=rp.Response;clone(t={}){return new qb({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0,redirected:t.redirected??this.redirected,responseType:t.responseType??this.responseType})}}class qm extends kA{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}const q4=new Le(""),Zce=/^\)\]\}',?\n/;let G4=(()=>{class e{xhrFactory;tracingService=Z(w_,{optional:!0});constructor(n){this.xhrFactory=n}maybePropagateTrace(n){return this.tracingService?.propagate?this.tracingService.propagate(n):n}handle(n){if("JSONP"===n.method)throw new se(-2800,!1);const r=this.xhrFactory;return Sn(null).pipe(qa(()=>new U(o=>{const a=r.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((oe,ye)=>a.setRequestHeader(oe,ye.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept",H4),!n.headers.has(Hb)){const oe=n.detectContentTypeHeader();null!==oe&&a.setRequestHeader(Hb,oe)}if(n.timeout&&(a.timeout=n.timeout),n.responseType){const oe=n.responseType.toLowerCase();a.responseType="json"!==oe?oe:"text"}const c=n.serializeBody();let p=null;const _=()=>{if(null!==p)return p;const oe=a.statusText||"OK",ye=new uu(a.getAllResponseHeaders());return p=new HC({headers:ye,status:a.status,statusText:oe,url:a.responseURL||n.url}),p},x=this.maybePropagateTrace(()=>{let{headers:oe,status:ye,statusText:xe,url:$e}=_(),De=null;204!==ye&&(De=typeof a.response>"u"?a.responseText:a.response),0===ye&&(ye=De?200:0);let ve=ye>=200&&ye<300;if("json"===n.responseType&&"string"==typeof De){const Fe=De;De=De.replace(Zce,"");try{De=""!==De?JSON.parse(De):null}catch(We){De=Fe,ve&&(ve=!1,De={error:We,text:De})}}ve?(o.next(new qb({body:De,headers:oe,status:ye,statusText:xe,url:$e||void 0})),o.complete()):o.error(new qm({error:De,headers:oe,status:ye,statusText:xe,url:$e||void 0}))}),D=this.maybePropagateTrace(oe=>{const{url:ye}=_(),xe=new qm({error:oe,status:a.status||0,statusText:a.statusText||"Unknown Error",url:ye||void 0});o.error(xe)});let A=D;n.timeout&&(A=this.maybePropagateTrace(oe=>{const{url:ye}=_(),xe=new qm({error:new DOMException("Request timed out","TimeoutError"),status:a.status||0,statusText:a.statusText||"Request timeout",url:ye||void 0});o.error(xe)}));let O=!1;const B=this.maybePropagateTrace(oe=>{O||(o.next(_()),O=!0);let ye={type:rp.DownloadProgress,loaded:oe.loaded};oe.lengthComputable&&(ye.total=oe.total),"text"===n.responseType&&a.responseText&&(ye.partialText=a.responseText),o.next(ye)}),Q=this.maybePropagateTrace(oe=>{let ye={type:rp.UploadProgress,loaded:oe.loaded};oe.lengthComputable&&(ye.total=oe.total),o.next(ye)});return a.addEventListener("load",x),a.addEventListener("error",D),a.addEventListener("timeout",A),a.addEventListener("abort",D),n.reportProgress&&(a.addEventListener("progress",B),null!==c&&a.upload&&a.upload.addEventListener("progress",Q)),a.send(c),o.next({type:rp.Sent}),()=>{a.removeEventListener("error",D),a.removeEventListener("abort",D),a.removeEventListener("load",x),a.removeEventListener("timeout",A),n.reportProgress&&(a.removeEventListener("progress",B),null!==c&&a.upload&&a.upload.removeEventListener("progress",Q)),a.readyState!==a.DONE&&a.abort()}})))}static \u0275fac=function(r){return new(r||e)(Ct(SU))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function W4(e,t){return t(e)}const Gb=new Le("",{factory:()=>[]}),Qce=new Le(""),Z4=new Le("",{factory:()=>!0});let $C=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:function(r){let i=null;return i=r?new(r||e):Ct(G4),i},providedIn:"root"})}return e})(),MA=(()=>{class e{backend;injector;chain=null;pendingTasks=Z(tv);contributeToStability=Z(Z4);constructor(n,r){this.backend=n,this.injector=r}handle(n){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Gb),...this.injector.get(Qce,[])]));this.chain=r.reduceRight((i,o)=>function Yce(e,t,n){return(r,i)=>Oi(n,()=>t(r,o=>e(o,i)))}(i,o,this.injector),W4)}if(this.contributeToStability){const r=this.pendingTasks.add();return this.chain(n,i=>this.backend.handle(i)).pipe(Dj(r))}return this.chain(n,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||e)(Ct($C),Ct(Fr))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),PA=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:function(r){let i=null;return i=r?new(r||e):Ct(MA),i},providedIn:"root"})}return e})();function OA(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,credentials:e.credentials,transferCache:e.transferCache,timeout:e.timeout,keepalive:e.keepalive,priority:e.priority,cache:e.cache,mode:e.mode,redirect:e.redirect,integrity:e.integrity,referrer:e.referrer,referrerPolicy:e.referrerPolicy}}let eue=(()=>{class e{handler;constructor(n){this.handler=n}request(n,r,i={}){let o;if(n instanceof $b)o=n;else{let p,_;p=i.headers instanceof uu?i.headers:new uu(i.headers),i.params&&(_=i.params instanceof np?i.params:new np({fromObject:i.params})),o=new $b(n,r,void 0!==i.body?i.body:null,{headers:p,context:i.context,params:_,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}const a=Sn(o).pipe(EC(p=>this.handler.handle(p)));if(n instanceof $b||"events"===i.observe)return a;const c=a.pipe(As(p=>p instanceof qb));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(ar(p=>{if(null!==p.body&&!(p.body instanceof ArrayBuffer))throw new se(2806,!1);return p.body}));case"blob":return c.pipe(ar(p=>{if(null!==p.body&&!(p.body instanceof Blob))throw new se(2807,!1);return p.body}));case"text":return c.pipe(ar(p=>{if(null!==p.body&&"string"!=typeof p.body)throw new se(2808,!1);return p.body}));default:return c.pipe(ar(p=>p.body))}case"response":return c;default:throw new se(2809,!1)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new np).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,i={}){return this.request("PATCH",n,OA(i,r))}post(n,r,i={}){return this.request("POST",n,OA(i,r))}put(n,r,i={}){return this.request("PUT",n,OA(i,r))}static \u0275fac=function(r){return new(r||e)(Ct(PA))};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Y4=new Le("",{factory:()=>!0}),X4=new Le("",{factory:()=>"XSRF-TOKEN"}),Q4=new Le("",{factory:()=>"X-XSRF-TOKEN"});let sue=(()=>{class e{cookieName=Z(X4);doc=Z(Fn);lastCookieString="";lastToken=null;parseCount=0;getToken(){const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=TU(n,this.cookieName),this.lastCookieString=n),this.lastToken}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),aue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:function(r){let i=null;return i=r?new(r||e):Ct(sue),i},providedIn:"root"})}return e})();function lue(e,t){if(!Z(Y4)||"GET"===e.method||"HEAD"===e.method)return t(e);try{const i=Z(WE).href,{origin:o}=new URL(i),{origin:a}=new URL(e.url,o);if(o!==a)return t(e)}catch{return t(e)}const n=Z(aue).getToken(),r=Z(Q4);return null!=n&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,n)})),t(e)}const No=void 0,e5=["fr",[["AM","PM"]],No,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],No,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],No,[["av. J.-C.","ap. J.-C."],No,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}",No,No],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[No,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[No,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[No,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[No,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[No,"\xa5"],KMF:[No,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[No,"$C"],NZD:["$NZ","$"],PHP:[No,"\u20b1"],RHD:["$RH"],RON:[No,"L"],RWF:[No,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[No,"$T"],TTD:["$TT","$"],TWD:[No,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[No,"$"],XPF:["FCFP"],ZMW:[No,"Kw"]},"ltr",function uue(e){const n=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(e.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===n||1===n?1:0===i&&0!==n&&n%1e6==0&&0===r||!(i>=0&&i<=5)?4:5}];function t5(e){return As((t,n)=>e<=n)}function hue(e,t){return e===t}function NA(e){return 0===e.buttons||0===e.detail}function LA(e){const t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}let FA,VA;function qC(e){if(function yue(){if(null==FA){const e=typeof document<"u"?document.head:null;FA=!(!e||!e.createShadowRoot&&!e.attachShadow)}return FA}()){const t=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function BA(){let e=typeof document<"u"&&document?document.activeElement:null;for(;e&&e.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}function Sl(e){return e.composedPath?e.composedPath()[0]:e.target}try{VA=typeof Intl<"u"&&Intl.v8BreakIterator}catch{VA=!1}let Wb,Il=(()=>{class e{_platformId=Z(cs);isBrowser=this._platformId?function dne(e){return e===kU}(this._platformId):"object"==typeof document&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!(!window.chrome&&!VA)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function zA(e){return function vue(){if(null==Wb&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Wb=!0}))}finally{Wb=Wb||!1}return Wb}()?e:!!e.capture}function GC(e,t=0){return function bue(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):2===arguments.length?t:0}function Wa(e){return e instanceof Pr?e.nativeElement:e}const wue=new Le("cdk-input-modality-detector-options"),xue={ignoreKeys:[18,17,224,91,16]},UA={passive:!0,capture:!0};let Eue=(()=>{class e{_platform=Z(Il);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new re(null);_options;_lastTouchMs=0;_onKeydown=n=>{this._options?.ignoreKeys?.some(r=>r===n.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Sl(n))};_onMousedown=n=>{Date.now()-this._lastTouchMs<650||(this._modality.next(NA(n)?"keyboard":"mouse"),this._mostRecentTarget=Sl(n))};_onTouchstart=n=>{LA(n)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Sl(n))};constructor(){const n=Z(Xt),r=Z(Fn),i=Z(wue,{optional:!0});if(this._options={...xue,...i},this.modalityDetected=this._modality.pipe(t5(1)),this.modalityChanged=this.modalityDetected.pipe(function due(e,t=Xn){return e=e??hue,Io((n,r)=>{let i,o=!0;n.subscribe(new ei(r,a=>{const c=t(a);(o||!e(i,c))&&(o=!1,i=c,r.next(a))}))})}()),this._platform.isBrowser){const o=Z(vl).createRenderer(null,null);this._listenerCleanups=n.runOutsideAngular(()=>[o.listen(r,"keydown",this._onKeydown,UA),o.listen(r,"mousedown",this._onMousedown,UA),o.listen(r,"touchstart",this._onTouchstart,UA)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(n=>n())}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var WC=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(WC||{});const Cue=new Le("cdk-focus-monitor-default-options"),ZC=zA({passive:!0,capture:!0});let i5=(()=>{class e{_ngZone=Z(Xt);_platform=Z(Il);_inputModalityDetector=Z(Eue);_origin=null;_lastFocusOrigin=null;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=Z(Fn);_stopInputModalityDetector=new K;constructor(){const n=Z(Cue,{optional:!0});this._detectionMode=n?.detectionMode||WC.IMMEDIATE}_rootNodeFocusAndBlurListener=n=>{for(let i=Sl(n);i;i=i.parentElement)"focus"===n.type?this._onFocus(n,i):this._onBlur(n,i)};monitor(n,r=!1){const i=Wa(n);if(!this._platform.isBrowser||1!==i.nodeType)return Sn();const o=qC(i)||this._document,a=this._elementInfo.get(i);if(a)return r&&(a.checkChildren=!0),a.subject;const c={checkChildren:r,subject:new K,rootNode:o};return this._elementInfo.set(i,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(n){const r=Wa(n),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(n,r,i){const o=Wa(n);o===this._document.activeElement?this._getClosestElementsInfo(o).forEach(([c,p])=>this._originChanged(c,r,p)):(this._setOrigin(r),"function"==typeof o.focus&&o.focus(i))}ngOnDestroy(){this._elementInfo.forEach((n,r)=>this.stopMonitoring(r))}_getWindow(){return this._document.defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return this._detectionMode===WC.EVENTUAL||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,r){n.classList.toggle("cdk-focused",!!r),n.classList.toggle("cdk-touch-focused","touch"===r),n.classList.toggle("cdk-keyboard-focused","keyboard"===r),n.classList.toggle("cdk-mouse-focused","mouse"===r),n.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(n,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=n,this._originFromTouchInteraction="touch"===n&&r,this._detectionMode===WC.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(n,r){const i=this._elementInfo.get(r),o=Sl(n);!i||!i.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),i)}_onBlur(n,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&n.relatedTarget instanceof Node&&r.contains(n.relatedTarget)||(this._setClasses(r),this._emitOrigin(i,null))}_emitOrigin(n,r){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(r))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;const r=n.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,ZC),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,ZC)}),this._rootNodeFocusListenerCount.set(r,i+1),1===++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ad(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(n){const r=n.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,ZC),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,ZC),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,r,i){this._setClasses(n,r),this._emitOrigin(i,r),this._lastFocusOrigin=r}_getClosestElementsInfo(n){const r=[];return this._elementInfo.forEach((i,o)=>{(o===n||i.checkChildren&&o.contains(n))&&r.push([o,i])}),r}_isLastInteractionFromInputLabel(n){const{_mostRecentTarget:r,mostRecentModality:i}=this._inputModalityDetector;if("mouse"!==i||!r||r===n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName||n.disabled)return!1;const o=n.labels;if(o)for(let a=0;a<o.length;a++)if(o[a].contains(r))return!0;return!1}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const KC=new WeakMap;let oy=(()=>{class e{_appRef;_injector=Z(En);_environmentInjector=Z(Fr);load(n){const r=this._appRef=this._appRef||this._injector.get(wl);let i=KC.get(r);i||(i={loaders:new Set,refs:[]},KC.set(r,i),r.onDestroy(()=>{KC.get(r)?.refs.forEach(o=>o.destroy()),KC.delete(r)})),i.loaders.has(n)||(i.loaders.add(n),i.refs.push(CU(n,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Due extends Hn{constructor(t,n){super()}schedule(t,n=0){return this}}const YC={setInterval(...e){const{delegate:t}=YC;return(t?.setInterval||setInterval)(...e)},clearInterval(e){const{delegate:t}=YC;return(t?.clearInterval||clearInterval)(e)},delegate:void 0};class jA extends Due{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){if(this.closed)return this;this.state=t;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(i,this.id,n),this}requestAsyncId(t,n,r=0){return YC.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;YC.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let i,r=!1;try{this.work(t)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,il(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}const HA={now:()=>(HA.delegate||Date).now(),delegate:void 0};class Zb{constructor(t,n=Zb.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,r){return new this.schedulerActionCtor(this,t).schedule(r,n)}}Zb.now=HA.now;class $A extends Zb{constructor(t,n=Zb.now){super(t,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,r){for(;t=n.shift();)t.unsubscribe();throw r}}}const qA=new $A(jA),o5=qA;function Kb(e){return Array.isArray(e)?e:[e]}const s5=new Set;let Wm,a5=(()=>{class e{_platform=Z(Il);_nonce=Z(Nr,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Iue}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&function Sue(e,t){if(!s5.has(e))try{Wm||(Wm=document.createElement("style"),t&&Wm.setAttribute("nonce",t),Wm.setAttribute("type","text/css"),document.head.appendChild(Wm)),Wm.sheet&&(Wm.sheet.insertRule(`@media ${e} {body{ }}`,0),s5.add(e))}catch(n){console.error(n)}}(n,this._nonce),this._matchMedia(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Iue(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let l5=(()=>{class e{_mediaMatcher=Z(a5);_zone=Z(Xt);_queries=new Map;_destroySubject=new K;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return c5(Kb(n)).some(i=>this._registerQuery(i).mql.matches)}observe(n){let o=Qk(c5(Kb(n)).map(a=>this._registerQuery(a).observable));return o=xC(o.pipe(Rs(1)),o.pipe(t5(1),function Tue(e,t=qA){return Io((n,r)=>{let i=null,o=null,a=null;const c=()=>{if(i){i.unsubscribe(),i=null;const _=o;o=null,r.next(_)}};function p(){const _=a+e,x=t.now();if(x<_)return i=this.schedule(void 0,_-x),void r.add(i);c()}n.subscribe(new ei(r,_=>{o=_,a=t.now(),i||(i=t.schedule(p,e),r.add(i))},()=>{c(),r.complete()},void 0,()=>{o=i=null}))})}(0))),o.pipe(ar(a=>{const c={matches:!1,breakpoints:{}};return a.forEach(({matches:p,query:_})=>{c.matches=c.matches||p,c.breakpoints[_]=p}),c}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);const r=this._mediaMatcher.matchMedia(n),o={observable:new U(a=>{const c=p=>this._zone.run(()=>a.next(p));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(Q_(r),ar(({matches:a})=>({query:n,matches:a})),ad(this._destroySubject)),mql:r};return this._queries.set(n,o),o}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function c5(e){return e.map(t=>t.split(",")).reduce((t,n)=>t.concat(n)).map(t=>t.trim())}const kue=new Le("MATERIAL_ANIMATIONS");let u5=null;function sy(){return"enabled"!==function Aue(){return Z(kue,{optional:!0})?.animationsDisabled||"NoopAnimations"===Z(oa,{optional:!0})?"di-disabled":(u5??=Z(a5).matchMedia("(prefers-reduced-motion)").matches,u5?"reduced-motion":"enabled")}()}var Cc=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(Cc||{});class Rue{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Cc.HIDDEN;constructor(t,n,r,i=!1){this._renderer=t,this.element=n,this.config=r,this._animationForciblyDisabledThroughCss=i}fadeOut(){this._renderer.fadeOutRipple(this)}}const d5=zA({passive:!0,capture:!0});class Mue{_events=new Map;addHandler(t,n,r,i){const o=this._events.get(n);if(o){const a=o.get(r);a?a.add(i):o.set(r,new Set([i]))}else this._events.set(n,new Map([[r,new Set([i])]])),t.runOutsideAngular(()=>{document.addEventListener(n,this._delegateEventHandler,d5)})}removeHandler(t,n,r){const i=this._events.get(t);if(!i)return;const o=i.get(n);o&&(o.delete(r),0===o.size&&i.delete(n),0===i.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,d5)))}_delegateEventHandler=t=>{const n=Sl(t);n&&this._events.get(t.type)?.forEach((r,i)=>{(i===n||i.contains(n))&&r.forEach(o=>o.handleEvent(t))})}}const XC={enterDuration:225,exitDuration:150},h5=zA({passive:!0,capture:!0}),f5=["mousedown","touchstart"],p5=["mouseup","mouseleave","touchend","touchcancel"];let Oue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}\n"],encapsulation:2,changeDetection:0})}return e})();class QC{_target;_ngZone;_platform;_containerElement;_triggerElement=null;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple=null;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect=null;static _eventManager=new Mue;constructor(t,n,r,i,o){this._target=t,this._ngZone=n,this._platform=i,i.isBrowser&&(this._containerElement=Wa(r)),o&&o.get(oy).load(Oue)}fadeInRipple(t,n,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...XC,...r.animation};r.centered&&(t=i.left+i.width/2,n=i.top+i.height/2);const a=r.radius||function Nue(e,t,n){const r=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),i=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(r*r+i*i)}(t,n,i),c=t-i.left,p=n-i.top,_=o.enterDuration,x=document.createElement("div");x.classList.add("mat-ripple-element"),x.style.left=c-a+"px",x.style.top=p-a+"px",x.style.height=2*a+"px",x.style.width=2*a+"px",null!=r.color&&(x.style.backgroundColor=r.color),x.style.transitionDuration=`${_}ms`,this._containerElement.appendChild(x);const D=window.getComputedStyle(x),O=D.transitionDuration,B="none"===D.transitionProperty||"0s"===O||"0s, 0s"===O||0===i.width&&0===i.height,Q=new Rue(this,x,r,B);x.style.transform="scale3d(1, 1, 1)",Q.state=Cc.FADING_IN,r.persistent||(this._mostRecentTransientRipple=Q);let oe=null;return!B&&(_||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ye=()=>{oe&&(oe.fallbackTimer=null),clearTimeout($e),this._finishRippleTransition(Q)},xe=()=>this._destroyRipple(Q),$e=setTimeout(xe,_+100);x.addEventListener("transitionend",ye),x.addEventListener("transitioncancel",xe),oe={onTransitionEnd:ye,onTransitionCancel:xe,fallbackTimer:$e}}),this._activeRipples.set(Q,oe),(B||!_)&&this._finishRippleTransition(Q),Q}fadeOutRipple(t){if(t.state===Cc.FADING_OUT||t.state===Cc.HIDDEN)return;const n=t.element,r={...XC,...t.config.animation};n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=Cc.FADING_OUT,(t._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const n=Wa(t);!this._platform.isBrowser||!n||n===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=n,f5.forEach(r=>{QC._eventManager.addHandler(this._ngZone,r,n,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{p5.forEach(n=>{this._triggerElement.addEventListener(n,this,h5)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===Cc.FADING_IN?this._startFadeOutTransition(t):t.state===Cc.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){const n=t===this._mostRecentTransientRipple,{persistent:r}=t.config;t.state=Cc.VISIBLE,!r&&(!n||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const n=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=Cc.HIDDEN,null!==n&&(t.element.removeEventListener("transitionend",n.onTransitionEnd),t.element.removeEventListener("transitioncancel",n.onTransitionCancel),null!==n.fallbackTimer&&clearTimeout(n.fallbackTimer)),t.element.remove()}_onMousedown(t){const n=NA(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!n&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!LA(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const n=t.changedTouches;if(n)for(let r=0;r<n.length;r++)this.fadeInRipple(n[r].clientX,n[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(t.state===Cc.VISIBLE||t.config.terminateOnPointerUp&&t.state===Cc.FADING_IN)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(f5.forEach(n=>QC._eventManager.removeHandler(n,t,this)),this._pointerUpEventsRegistered&&(p5.forEach(n=>t.removeEventListener(n,this,h5)),this._pointerUpEventsRegistered=!1))}}const Lue=new Le("mat-ripple-global-options"),Fue={capture:!0},Bue=["focus","mousedown","mouseenter","touchstart"],GA="mat-ripple-loader-uninitialized",WA="mat-ripple-loader-class-name",m5="mat-ripple-loader-centered",JC="mat-ripple-loader-disabled";let Vue=(()=>{class e{_document=Z(Fn);_animationsDisabled=sy();_globalRippleOptions=Z(Lue,{optional:!0});_platform=Z(Il);_ngZone=Z(Xt);_injector=Z(En);_eventCleanups;_hosts=new Map;constructor(){const n=Z(vl).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>Bue.map(r=>n.listen(this._document,r,this._onInteraction,Fue)))}ngOnDestroy(){const n=this._hosts.keys();for(const r of n)this.destroyRipple(r);this._eventCleanups.forEach(r=>r())}configureRipple(n,r){n.setAttribute(GA,this._globalRippleOptions?.namespace??""),(r.className||!n.hasAttribute(WA))&&n.setAttribute(WA,r.className||""),r.centered&&n.setAttribute(m5,""),r.disabled&&n.setAttribute(JC,"")}setDisabled(n,r){const i=this._hosts.get(n);i?(i.target.rippleDisabled=r,!r&&!i.hasSetUpEvents&&(i.hasSetUpEvents=!0,i.renderer.setupTriggerEvents(n))):r?n.setAttribute(JC,""):n.removeAttribute(JC)}_onInteraction=n=>{const r=Sl(n);if(r instanceof HTMLElement){const i=r.closest(`[${GA}="${this._globalRippleOptions?.namespace??""}"]`);i&&this._createRipple(i)}};_createRipple(n){if(!this._document||this._hosts.has(n))return;n.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",n.getAttribute(WA)),n.append(r);const i=this._globalRippleOptions,o=this._animationsDisabled?0:i?.animation?.enterDuration??XC.enterDuration,a=this._animationsDisabled?0:i?.animation?.exitDuration??XC.exitDuration,c={rippleDisabled:this._animationsDisabled||i?.disabled||n.hasAttribute(JC),rippleConfig:{centered:n.hasAttribute(m5),terminateOnPointerUp:i?.terminateOnPointerUp,animation:{enterDuration:o,exitDuration:a}}},p=new QC(c,this._ngZone,r,this._platform,this._injector),_=!c.rippleDisabled;_&&p.setupTriggerEvents(n),this._hosts.set(n,{target:c,renderer:p,hasSetUpEvents:_}),n.removeAttribute(GA)}destroyRipple(n){const r=this._hosts.get(n);r&&(r.renderer._removeTriggerEvents(),this._hosts.delete(n))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),zue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["structural-styles"]],decls:0,vars:0,template:function(r,i){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus-visible::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}\n'],encapsulation:2,changeDetection:0})}return e})();const Uue=new Le("MAT_BUTTON_CONFIG");function g5(e){return null==e?void 0:bU(e)}let jue=(()=>{class e{_elementRef=Z(Pr);_ngZone=Z(Xt);_animationsDisabled=sy();_config=Z(Uue,{optional:!0});_focusMonitor=Z(i5);_cleanupClick;_renderer=Z(za);_rippleLoader=Z(Vue);_isAnchor;_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=n,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;tabIndex;set _tabindex(n){this.tabIndex=n}constructor(){Z(oy).load(zue);const n=this._elementRef.nativeElement;this._isAnchor="A"===n.tagName,this.disabledInteractive=this._config?.disabledInteractive??!1,this.color=this._config?.color??null,this._rippleLoader?.configureRipple(n,{className:"mat-mdc-button-ripple"})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0),this._isAnchor&&this._setupAsAnchor()}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(n="program",r){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:this._isAnchor?this.disabled||null:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}_getTabIndex(){return this._isAnchor&&this.disabled&&!this.disabledInteractive?-1:this.tabIndex}_setupAsAnchor(){this._cleanupClick=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"click",n=>{this.disabled&&(n.preventDefault(),n.stopImmediatePropagation())}))}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,hostAttrs:[1,"mat-mdc-button-base"],hostVars:13,hostBindings:function(r,i){2&r&&($s("disabled",i._getDisabledAttribute())("aria-disabled",i._getAriaDisabled())("tabindex",i._getTabIndex()),TI(i.color?"mat-"+i.color:""),El("mat-mdc-button-disabled",i.disabled)("mat-mdc-button-disabled-interactive",i.disabledInteractive)("mat-unthemed",!i.color)("_mat-animation-noopable",i._animationsDisabled))},inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",us],disabled:[2,"disabled","disabled",us],ariaDisabled:[2,"aria-disabled","ariaDisabled",us],disabledInteractive:[2,"disabledInteractive","disabledInteractive",us],tabIndex:[2,"tabIndex","tabIndex",g5],_tabindex:[2,"tabindex","_tabindex",g5]}})}return e})(),Zm=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})(),Hue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[Zm]})}return e})();const $ue=["matButton",""],que=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Gue=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],_5=new Map([["text",["mat-mdc-button"]],["filled",["mdc-button--unelevated","mat-mdc-unelevated-button"]],["elevated",["mdc-button--raised","mat-mdc-raised-button"]],["outlined",["mdc-button--outlined","mat-mdc-outlined-button"]],["tonal",["mat-tonal-button"]]]);let Wue=(()=>{class e extends jue{get appearance(){return this._appearance}set appearance(n){this.setAppearance(n||this._config?.defaultAppearance||"text")}_appearance=null;constructor(){super();const n=function Zue(e){return e.hasAttribute("mat-raised-button")?"elevated":e.hasAttribute("mat-stroked-button")?"outlined":e.hasAttribute("mat-flat-button")?"filled":e.hasAttribute("mat-button")?"text":null}(this._elementRef.nativeElement);n&&this.setAppearance(n)}setAppearance(n){if(n===this._appearance)return;const r=this._elementRef.nativeElement.classList,i=this._appearance?_5.get(this._appearance):null,o=_5.get(n);i&&r.remove(...i),r.add(...o),this._appearance=n}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["button","matButton",""],["a","matButton",""],["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""],["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostAttrs:[1,"mdc-button"],inputs:{appearance:[0,"matButton","appearance"]},exportAs:["matButton","matAnchor"],features:[zn],attrs:$ue,ngContentSelectors:Gue,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,i){1&r&&(function CV(e){const t=Ae()[15][5];if(!t.projection){const r=t.projection=function Fd(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}(e?e.length:1,null),i=r.slice();let o=t.child;for(;null!==o;){if(128!==o.type){const a=e?cJ(o,e):0;null!==a&&(i[a]?i[a].projectionNext=o:r[a]=o,i[a]=o)}o=o.next}}}(que),od(0,"span",0),ME(1),jt(2,"span",1),ME(3,1),Bt(),ME(4,2),od(5,"span",2)(6,"span",3)),2&r&&El("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mat-mdc-button-base .mat-icon{min-height:fit-content;flex-shrink:0}@media(hover: none){.mat-mdc-button-base:hover>span.mat-mdc-button-persistent-ripple::before{opacity:0}}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-button-text-horizontal-padding, 12px);height:var(--mat-button-text-container-height, 40px);font-family:var(--mat-button-text-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-text-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-text-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-text-label-text-transform);font-weight:var(--mat-button-text-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mat-button-text-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mat-button-text-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-text-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-button-text-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-button-text-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-text-touch-target-size, 48px);display:var(--mat-button-text-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-filled-container-height, 40px);font-family:var(--mat-button-filled-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-filled-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-filled-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-filled-label-text-transform);font-weight:var(--mat-button-filled-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-filled-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-button-filled-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-filled-touch-target-size, 48px);display:var(--mat-button-filled-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mat-button-filled-label-text-color, var(--mat-sys-on-primary));background-color:var(--mat-button-filled-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mat-button-filled-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-filled-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-filled-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mat-button-protected-container-elevation-shadow, var(--mat-sys-level1));height:var(--mat-button-protected-container-height, 40px);font-family:var(--mat-button-protected-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-protected-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-protected-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-protected-label-text-transform);font-weight:var(--mat-button-protected-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-protected-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-button-protected-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-protected-touch-target-size, 48px);display:var(--mat-button-protected-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-raised-button:not(:disabled){color:var(--mat-button-protected-label-text-color, var(--mat-sys-primary));background-color:var(--mat-button-protected-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mat-button-protected-container-shape, var(--mat-sys-corner-full))}@media(hover: hover){.mat-mdc-raised-button:hover{box-shadow:var(--mat-button-protected-hover-container-elevation-shadow, var(--mat-sys-level2))}}.mat-mdc-raised-button:focus{box-shadow:var(--mat-button-protected-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mat-button-protected-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-protected-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-protected-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mat-button-protected-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-outlined-container-height, 40px);font-family:var(--mat-button-outlined-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-outlined-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-outlined-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-outlined-label-text-transform);font-weight:var(--mat-button-outlined-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mat-button-outlined-container-shape, var(--mat-sys-corner-full));border-width:var(--mat-button-outlined-outline-width, 1px);padding:0 var(--mat-button-outlined-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-button-outlined-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-outlined-touch-target-size, 48px);display:var(--mat-button-outlined-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-outlined-button:not(:disabled){color:var(--mat-button-outlined-label-text-color, var(--mat-sys-primary));border-color:var(--mat-button-outlined-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-outlined-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mat-button-outlined-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-tonal-container-height, 40px);font-family:var(--mat-button-tonal-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-tonal-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-tonal-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-tonal-label-text-transform);font-weight:var(--mat-button-tonal-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-tonal-horizontal-padding, 24px)}.mat-tonal-button:not(:disabled){color:var(--mat-button-tonal-label-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-button-tonal-container-color, var(--mat-sys-secondary-container))}.mat-tonal-button,.mat-tonal-button .mdc-button__ripple{border-radius:var(--mat-button-tonal-container-shape, var(--mat-sys-corner-full))}.mat-tonal-button[disabled],.mat-tonal-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-tonal-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-tonal-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-tonal-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}[dir=rtl] .mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}.mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}[dir=rtl] .mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}.mat-tonal-button .mat-ripple-element{background-color:var(--mat-button-tonal-ripple-color, color-mix(in srgb, var(--mat-sys-on-secondary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-tonal-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-tonal-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-tonal-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-tonal-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-tonal-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-tonal-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-tonal-touch-target-size, 48px);display:var(--mat-button-tonal-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button,.mat-tonal-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon,.mat-tonal-button .mdc-button__label,.mat-tonal-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator,.mat-tonal-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit}.mat-mdc-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-raised-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus-visible>.mat-focus-indicator::before,.mat-tonal-button:focus-visible>.mat-focus-indicator::before{content:"";border-radius:inherit}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable,.mat-tonal-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon,.mat-tonal-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-tonal-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}\n',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-button-base.mat-tonal-button,.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}\n"],encapsulation:2,changeDetection:0})}return e})(),Yue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[Hue,Zm]})}return e})();const ZA={};class du{_appId=Z(yr);static _infix=`a${Math.floor(1e5*Math.random()).toString()}`;getId(t,n=!1){return"ng"!==this._appId&&(t+=this._appId),ZA.hasOwnProperty(t)||(ZA[t]=0),`${t}${n?du._infix+"-":""}${ZA[t]++}`}static \u0275fac=function(n){return new(n||du)};static \u0275prov=Ue({token:du,factory:du.\u0275fac,providedIn:"root"})}let e1,Xue=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(r,i){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}\n"],encapsulation:2,changeDetection:0})}return e})();let tde=(()=>{class e{create(n){return typeof MutationObserver>"u"?null:new MutationObserver(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),nde=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[tde]})}return e})(),y5=(()=>{class e{_platform=Z(Il);constructor(){}isDisabled(n){return n.hasAttribute("disabled")}isVisible(n){return function ide(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(n)&&"visible"===getComputedStyle(n).visibility}isTabbable(n){if(!this._platform.isBrowser)return!1;const r=function rde(e){try{return e.frameElement}catch{return null}}(function hde(e){return e.ownerDocument&&e.ownerDocument.defaultView||window}(n));if(r&&(-1===b5(r)||!this.isVisible(r)))return!1;let i=n.nodeName.toLowerCase(),o=b5(n);return n.hasAttribute("contenteditable")?-1!==o:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function ude(e){let t=e.nodeName.toLowerCase(),n="input"===t&&e.type;return"text"===n||"password"===n||"select"===t||"textarea"===t}(n))&&("audio"===i?!!n.hasAttribute("controls")&&-1!==o:"video"===i?-1!==o&&(null!==o||this._platform.FIREFOX||n.hasAttribute("controls")):n.tabIndex>=0)}isFocusable(n,r){return function dde(e){return!function sde(e){return function lde(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function ode(e){let t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(e)||function ade(e){return function cde(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||v5(e))}(n)&&!this.isDisabled(n)&&(r?.ignoreVisibility||this.isVisible(n))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function v5(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;let t=e.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function b5(e){if(!v5(e))return null;const t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class fde{_element;_checker;_ngZone;_document;_injector;_startAnchor=null;_endAnchor=null;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_enabled=!0;constructor(t,n,r,i,o=!1,a){this._element=t,this._checker=n,this._ngZone=r,this._document=i,this._injector=a,o||this.attachAnchors()}destroy(){const t=this._startAnchor,n=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),n&&(n.removeEventListener("focus",this.endAnchorListener),n.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(n=>{this._executeOnStable(()=>n(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const n=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?n.length?n[0]:this._getFirstTabbableElement(this._element):n.length?n[n.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const n=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(n){if(!this._checker.isFocusable(n)){const r=this._getFirstTabbableElement(n);return r?.focus(t),!!r}return n.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const n=this._getRegionBoundary("start");return n&&n.focus(t),!!n}focusLastTabbableElement(t){const n=this._getRegionBoundary("end");return n&&n.focus(t),!!n}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const n=t.children;for(let r=0;r<n.length;r++){const i=n[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(n[r]):null;if(i)return i}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const n=t.children;for(let r=n.length-1;r>=0;r--){const i=n[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(n[r]):null;if(i)return i}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,n){t?n.setAttribute("tabindex","0"):n.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._injector?iu(t,{injector:this._injector}):setTimeout(t)}}let pde=(()=>{class e{_checker=Z(y5);_ngZone=Z(Xt);_document=Z(Fn);_injector=Z(En);constructor(){Z(oy).load(Xue)}create(n,r=!1){return new fde(n,this._checker,this._ngZone,this._document,r,this._injector)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const mde=new Le("liveAnnouncerElement",{providedIn:"root",factory:()=>null}),gde=new Le("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let _de=0,yde=(()=>{class e{_ngZone=Z(Xt);_defaultOptions=Z(gde,{optional:!0});_liveElement;_document=Z(Fn);_sanitizer=Z(Ij);_previousTimeout;_currentPromise;_currentResolve;constructor(){const n=Z(mde,{optional:!0});this._liveElement=n||this._createLiveElement()}announce(n,...r){const i=this._defaultOptions;let o,a;return 1===r.length&&"number"==typeof r[0]?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=i&&i.politeness?i.politeness:"polite"),null==a&&i&&(a=i.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(c=>this._currentResolve=c)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{n&&"string"!=typeof n?function ede(e,t,n){const r=n.sanitize(_l.HTML,t);e.innerHTML=function Jue(e){return function Que(){if(void 0===e1&&(e1=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(e1=e.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return e1}()?.createHTML(e)||e}(r||"")}(this._liveElement,n,this._sanitizer):this._liveElement.textContent=n,"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const n="cdk-live-announcer-element",r=this._document.getElementsByClassName(n),i=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return i.classList.add(n),i.classList.add("cdk-visually-hidden"),i.setAttribute("aria-atomic","true"),i.setAttribute("aria-live","polite"),i.id="cdk-live-announcer-"+_de++,this._document.body.appendChild(i),i}_exposeAnnouncerToModals(n){const r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");a?-1===a.indexOf(n)&&o.setAttribute("aria-owns",a+" "+n):o.setAttribute("aria-owns",n)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Km=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(Km||{});const w5="cdk-high-contrast-black-on-white",x5="cdk-high-contrast-white-on-black",KA="cdk-high-contrast-active";let vde=(()=>{class e{_platform=Z(Il);_hasCheckedHighContrastMode=!1;_document=Z(Fn);_breakpointSubscription;constructor(){this._breakpointSubscription=Z(l5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Km.NONE;const n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(n):null,o=(i&&i.backgroundColor||"").replace(/ /g,"");switch(n.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Km.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Km.BLACK_ON_WHITE}return Km.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const n=this._document.body.classList;n.remove(KA,w5,x5),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();r===Km.BLACK_ON_WHITE?n.add(KA,w5):r===Km.WHITE_ON_BLACK&&n.add(KA,x5)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),bde=(()=>{class e{constructor(){Z(vde)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[nde]})}return e})();class YA{_attachedHost=null;attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class Yb extends YA{component;viewContainerRef;injector;projectableNodes;constructor(t,n,r,i){super(),this.component=t,this.viewContainerRef=n,this.injector=r,this.projectableNodes=i}}class XA extends YA{templateRef;viewContainerRef;context;injector;constructor(t,n,r,i){super(),this.templateRef=t,this.viewContainerRef=n,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(t,n=this.context){return this.context=n,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class wde extends YA{element;constructor(t){super(),this.element=t instanceof Pr?t.nativeElement:t}}class t1{_attachedPortal=null;_disposeFn=null;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof Yb?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof XA?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof wde?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class xde extends t1{outletElement;_appRef;_defaultInjector;constructor(t,n,r){super(),this.outletElement=t,this._appRef=n,this._defaultInjector=r}attachComponentPortal(t){let n;if(t.viewContainerRef){const r=t.injector||t.viewContainerRef.injector,i=r.get(ph,null,{optional:!0})||void 0;n=t.viewContainerRef.createComponent(t.component,{index:t.viewContainerRef.length,injector:r,ngModuleRef:i,projectableNodes:t.projectableNodes||void 0}),this.setDisposeFn(()=>n.destroy())}else{const r=this._appRef,i=t.injector||this._defaultInjector||En.NULL,o=i.get(Fr,r.injector);n=CU(t.component,{elementInjector:i,environmentInjector:o,projectableNodes:t.projectableNodes||void 0}),r.attachView(n.hostView),this.setDisposeFn(()=>{r.viewCount>0&&r.detachView(n.hostView),n.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(n)),this._attachedPortal=t,n}attachTemplatePortal(t){let n=t.viewContainerRef,r=n.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=n.indexOf(r);-1!==i&&n.remove(i)}),this._attachedPortal=t,r}attachDomPortal=t=>{const n=t.element,r=this.outletElement.ownerDocument.createComment("dom-portal");n.parentNode.insertBefore(r,n),this.outletElement.appendChild(n),this._attachedPortal=t,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(n,r)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let Xb=(()=>{class e extends t1{_moduleRef=Z(ph,{optional:!0});_document=Z(Fn);_viewContainerRef=Z(bl);_isInitialized=!1;_attachedRef=null;constructor(){super()}get portal(){return this._attachedPortal}set portal(n){this.hasAttached()&&!n&&!this._isInitialized||(this.hasAttached()&&super.detach(),n&&super.attach(n),this._attachedPortal=n||null)}attached=new Bn;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(n){n.setAttachedHost(this);const r=null!=n.viewContainerRef?n.viewContainerRef:this._viewContainerRef,i=r.createComponent(n.component,{index:r.length,injector:n.injector||r.injector,projectableNodes:n.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return r!==this._viewContainerRef&&this._getRootNode().appendChild(i.hostView.rootNodes[0]),super.setDisposeFn(()=>i.destroy()),this._attachedPortal=n,this._attachedRef=i,this.attached.emit(i),i}attachTemplatePortal(n){n.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=n,this._attachedRef=r,this.attached.emit(r),r}attachDomPortal=n=>{const r=n.element,i=this._document.createComment("dom-portal");n.setAttachedHost(this),r.parentNode.insertBefore(i,r),this._getRootNode().appendChild(r),this._attachedPortal=n,super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(r,i)})};_getRootNode(){const n=this._viewContainerRef.element.nativeElement;return n.nodeType===n.ELEMENT_NODE?n:n.parentNode}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[zn]})}return e})(),Qb=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})();function E5(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Lo(e){return null==e?"":"string"==typeof e?e:`${e}px`}const Jb={schedule(e){let t=requestAnimationFrame,n=cancelAnimationFrame;const{delegate:r}=Jb;r&&(t=r.requestAnimationFrame,n=r.cancelAnimationFrame);const i=t(o=>{n=void 0,e(o)});return new Hn(()=>n?.(i))},requestAnimationFrame(...e){const{delegate:t}=Jb;return(t?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:t}=Jb;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0},C5=new class Dde extends $A{flush(t){this._active=!0,this._scheduled=void 0;const{actions:n}=this;let r,i=-1;t=t||n.shift();const o=n.length;do{if(r=t.execute(t.state,t.delay))break}while(++i<o&&(t=n.shift()));if(this._active=!1,r){for(;++i<o&&(t=n.shift());)t.unsubscribe();throw r}}}(class Cde extends jA{constructor(t,n){super(t,n),this.scheduler=t,this.work=n}requestAsyncId(t,n,r=0){return null!==r&&r>0?super.requestAsyncId(t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=Jb.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,n,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(t,n,r);0===t.actions.length&&(Jb.cancelAnimationFrame(n),t._scheduled=void 0)}});let QA,Tde=1;const n1={};function D5(e){return e in n1&&(delete n1[e],!0)}const Sde={setImmediate(e){const t=Tde++;return n1[t]=!0,QA||(QA=Promise.resolve()),QA.then(()=>D5(t)&&e()),t},clearImmediate(e){D5(e)}},{setImmediate:Ide,clearImmediate:kde}=Sde,r1={setImmediate(...e){const{delegate:t}=r1;return(t?.setImmediate||Ide)(...e)},clearImmediate(e){const{delegate:t}=r1;return(t?.clearImmediate||kde)(e)},delegate:void 0};new class Rde extends $A{flush(t){this._active=!0,this._scheduled=void 0;const{actions:n}=this;let r,i=-1;t=t||n.shift();const o=n.length;do{if(r=t.execute(t.state,t.delay))break}while(++i<o&&(t=n.shift()));if(this._active=!1,r){for(;++i<o&&(t=n.shift());)t.unsubscribe();throw r}}}(class Ade extends jA{constructor(t,n){super(t,n),this.scheduler=t,this.work=n}requestAsyncId(t,n,r=0){return null!==r&&r>0?super.requestAsyncId(t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=r1.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,n,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(t,n,r);0===t.actions.length&&(r1.clearImmediate(n),t._scheduled=void 0)}});function T5(e=0,t,n=o5){let r=-1;return null!=t&&(yj(t)?n=t:r=t),new U(i=>{let o=function Ode(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;o<0&&(o=0);let a=0;return n.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function S5(e,t=o5){return function Pde(e){return Io((t,n)=>{let r=!1,i=null,o=null,a=!1;const c=()=>{if(o?.unsubscribe(),o=null,r){r=!1;const _=i;i=null,n.next(_)}a&&n.complete()},p=()=>{o=null,a&&n.complete()};t.subscribe(new ei(n,_=>{r=!0,i=_,o||wc(e(_)).subscribe(o=new ei(n,c,p))},()=>{a=!0,(!r||!o||o.closed)&&n.complete()}))})}(()=>T5(e,t))}const Nde=new Le("cdk-dir-doc",{providedIn:"root",factory:()=>Z(Fn)}),Lde=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Ym,ay=(()=>{class e{get value(){return this.valueSignal()}valueSignal=as("ltr");change=new Bn;constructor(){const n=Z(Nde,{optional:!0});n&&this.valueSignal.set(function Fde(e){const t=e?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?Lde.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((n.body?n.body.dir:null)||(n.documentElement?n.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function I5(){if(null==Ym){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Ym=!1,Ym;if(document.documentElement?.style&&"scrollBehavior"in document.documentElement.style)Ym=!0;else{const e=Element.prototype.scrollTo;Ym=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return Ym}let o1=(()=>{class e{_ngZone=Z(Xt);_platform=Z(Il);_renderer=Z(vl).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new K;_scrolledCount=0;scrollContainers=new Map;register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){const r=this.scrollContainers.get(n);r&&(r.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=20){return this._platform.isBrowser?new U(r=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));const i=n>0?this._scrolled.pipe(S5(n)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Sn()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((n,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(n,r){const i=this.getAncestorScrollContainers(n);return this.scrolled(r).pipe(As(o=>!o||i.indexOf(o)>-1))}getAncestorScrollContainers(n){const r=[];return this.scrollContainers.forEach((i,o)=>{this._scrollableContainsElement(o,n)&&r.push(o)}),r}_scrollableContainsElement(n,r){let i=Wa(r),o=n.getElementRef().nativeElement;do{if(i==o)return!0}while(i=i.parentElement);return!1}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ly=(()=>{class e{_platform=Z(Il);_listeners;_viewportSize=null;_change=new K;_document=Z(Fn);constructor(){const n=Z(Xt),r=Z(vl).createRenderer(null,null);n.runOutsideAngular(()=>{if(this._platform.isBrowser){const i=o=>this._change.next(o);this._listeners=[r.listen("window","resize",i),r.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(n=>n()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){const n=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+i,right:n.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const n=this._document,r=this._getWindow(),i=n.documentElement,o=i.getBoundingClientRect();return{top:-o.top||n.body?.scrollTop||r.scrollY||i.scrollTop||0,left:-o.left||n.body?.scrollLeft||r.scrollX||i.scrollLeft||0}}change(n=20){return n>0?this._change.pipe(S5(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),JA=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})(),k5=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[Zm,JA,Zm,JA]})}return e})();const A5=I5();function eR(e){return new Ude(e.get(ly),e.get(Fn))}class Ude{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(t,n){this._viewportRuler=t,this._document=n}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Lo(-this._previousScrollPosition.left),t.style.top=Lo(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,r=t.style,i=this._document.body.style,o=r.scrollBehavior||"",a=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),A5&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),A5&&(r.scrollBehavior=o,i.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const n=this._document.documentElement,r=this._viewportRuler.getViewportSize();return n.scrollHeight>r.height||n.scrollWidth>r.width}}class Hde{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(t,n,r,i){this._scrollDispatcher=t,this._ngZone=n,this._viewportRuler=r,this._config=i}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(As(n=>!n||!this._overlayRef.overlayElement.contains(n.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const n=this._viewportRuler.getViewportScrollPosition().top;Math.abs(n-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}class tR{enable(){}disable(){}attach(){}}function nR(e,t){return t.some(n=>e.bottom<n.top||e.top>n.bottom||e.right<n.left||e.left>n.right)}function R5(e,t){return t.some(n=>e.top<n.top||e.bottom>n.bottom||e.left<n.left||e.right>n.right)}class $de{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(t,n,r,i){this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this._config=i}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const n=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();nR(n,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let qde=(()=>{class e{_injector=Z(En);constructor(){}noop=()=>new tR;close=n=>function jde(e,t){return new Hde(e.get(o1),e.get(Xt),e.get(ly),t)}(this._injector,n);block=()=>eR(this._injector);reposition=n=>function M5(e,t){return new $de(e.get(o1),e.get(ly),e.get(Xt),t)}(this._injector,n);static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class rR{positionStrategy;scrollStrategy=new tR;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";disableAnimations;width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;usePopover;constructor(t){if(t){const n=Object.keys(t);for(const r of n)void 0!==t[r]&&(this[r]=t[r])}}}class Gde{connectionPair;scrollableViewProperties;constructor(t,n){this.connectionPair=t,this.scrollableViewProperties=n}}let P5=(()=>{class e{_attachedOverlays=[];_document=Z(Fn);_isAttached=!1;constructor(){}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){const r=this._attachedOverlays.indexOf(n);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Wde=(()=>{class e extends P5{_ngZone=Z(Xt);_renderer=Z(vl).createRenderer(null,null);_cleanupKeydown;add(n){super.add(n),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=n=>{const r=this._attachedOverlays;for(let i=r.length-1;i>-1;i--)if(r[i]._keydownEvents.observers.length>0){this._ngZone.run(()=>r[i]._keydownEvents.next(n));break}};static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Zde=(()=>{class e extends P5{_platform=Z(Il);_ngZone=Z(Xt);_renderer=Z(vl).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget=null;_cleanups;add(n){if(super.add(n),!this._isAttached){const r=this._document.body,i={capture:!0},o=this._renderer;this._cleanups=this._ngZone.runOutsideAngular(()=>[o.listen(r,"pointerdown",this._pointerDownListener,i),o.listen(r,"click",this._clickListener,i),o.listen(r,"auxclick",this._clickListener,i),o.listen(r,"contextmenu",this._clickListener,i)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(n=>n()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=n=>{this._pointerDownEventTarget=Sl(n)};_clickListener=n=>{const r=Sl(n),i="click"===n.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:r;this._pointerDownEventTarget=null;const o=this._attachedOverlays.slice();for(let a=o.length-1;a>-1;a--){const c=o[a];if(c._outsidePointerEvents.observers.length<1||!c.hasAttached())continue;if(O5(c.overlayElement,r)||O5(c.overlayElement,i))break;const p=c._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>p.next(n)):p.next(n)}};static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function O5(e,t){const n=typeof ShadowRoot<"u"&&ShadowRoot;let r=t;for(;r;){if(r===e)return!0;r=n&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}let N5=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0;touch-action:manipulation}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}.cdk-overlay-popover{background:none;border:none;padding:0;outline:0;overflow:visible;position:fixed;pointer-events:none;white-space:normal;color:inherit;text-decoration:none;width:100%;height:100%;inset:auto;top:0;left:0}.cdk-overlay-popover::backdrop{display:none}.cdk-overlay-popover .cdk-overlay-backdrop{position:fixed;z-index:auto}\n"],encapsulation:2,changeDetection:0})}return e})(),iR=(()=>{class e{_platform=Z(Il);_containerElement;_document=Z(Fn);_styleLoader=Z(oy);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const n="cdk-overlay-container";if(this._platform.isBrowser||E5()){const i=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let o=0;o<i.length;o++)i[o].remove()}const r=this._document.createElement("div");r.classList.add(n),E5()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}_loadStyles(){this._styleLoader.load(N5)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class Kde{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(t,n,r,i){this._renderer=n,this._ngZone=r,this.element=t.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=n.listen(this.element,"click",i)}detach(){this._ngZone.runOutsideAngular(()=>{const t=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(t,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),t.style.pointerEvents="none",t.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}}function oR(e){return e&&1===e.nodeType}class L5{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new K;_attachments=new K;_detachments=new K;_positionStrategy;_scrollStrategy;_locationChanges=Hn.EMPTY;_backdropRef=null;_detachContentMutationObserver;_detachContentAfterRenderRef;_disposed=!1;_previousHostParent;_keydownEvents=new K;_outsidePointerEvents=new K;_afterNextRenderRef;constructor(t,n,r,i,o,a,c,p,_,x=!1,D,A){this._portalOutlet=t,this._host=n,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=a,this._document=c,this._location=p,this._outsideClickDispatcher=_,this._animationsDisabled=x,this._injector=D,this._renderer=A,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(t){if(this._disposed)return null;this._attachHost();const n=this._portalOutlet.attach(t);return this._positionStrategy?.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=iu(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._completeDetachContent(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof n?.onDestroy&&n.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),n}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._completeDetachContent(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){if(this._disposed)return;const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,t&&this._detachments.next(),this._detachments.complete(),this._completeDetachContent(),this._disposed=!0}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Lo(this._config.width),t.height=Lo(this._config.height),t.minWidth=Lo(this._config.minWidth),t.minHeight=Lo(this._config.minHeight),t.maxWidth=Lo(this._config.maxWidth),t.maxHeight=Lo(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachHost(){if(!this._host.parentElement){const t=this._config.usePopover?this._positionStrategy?.getPopoverInsertionPoint?.():null;oR(t)?t.after(this._host):"parent"===t?.type?t.element.appendChild(this._host):this._previousHostParent?.appendChild(this._host)}if(this._config.usePopover)try{this._host.showPopover()}catch{}}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new Kde(this._document,this._renderer,this._ngZone,n=>{this._backdropClick.next(n)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._config.usePopover?this._host.prepend(this._backdropRef.element):this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(t))}):this._backdropRef.element.classList.add(t)}_updateStackingOrder(){!this._config.usePopover&&this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(t,n,r){const i=Kb(n||[]).filter(o=>!!o);i.length&&(r?t.classList.add(...i):t.classList.remove(...i))}_detachContentWhenEmpty(){let t=!1;try{this._detachContentAfterRenderRef=iu(()=>{t=!0,this._detachContent()},{injector:this._injector})}catch(n){if(t)throw n;this._detachContent()}globalThis.MutationObserver&&this._pane&&(this._detachContentMutationObserver||=new globalThis.MutationObserver(()=>{this._detachContent()}),this._detachContentMutationObserver.observe(this._pane,{childList:!0}))}_detachContent(){(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),this._completeDetachContent())}_completeDetachContent(){this._detachContentAfterRenderRef?.destroy(),this._detachContentAfterRenderRef=void 0,this._detachContentMutationObserver?.disconnect()}_disposeScrollStrategy(){const t=this._scrollStrategy;t?.disable(),t?.detach?.()}}const F5="cdk-overlay-connected-position-bounding-box",Yde=/([A-Za-z%]+)$/;class Qde{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender=!1;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed=!1;_boundingBox=null;_lastPosition=null;_lastScrollVisibility=null;_positionChanges=new K;_resizeSubscription=Hn.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount=null;_popoverLocation="global";positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(t,n,r,i,o){this._viewportRuler=n,this._document=r,this._platform=i,this._overlayContainer=o,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(F5),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._getContainerRect();const t=this._originRect,n=this._overlayRect,r=this._viewportRect,i=this._containerRect,o=[];let a;for(let c of this._preferredPositions){let p=this._getOriginPoint(t,i,c),_=this._getOverlayPoint(p,n,c),x=this._getOverlayFit(_,n,r,c);if(x.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(c,p);this._canFitWithFlexibleDimensions(x,_,r)?o.push({position:c,origin:p,overlayRect:n,boundingBoxRect:this._calculateBoundingBoxRect(p,c)}):(!a||a.overlayFit.visibleArea<x.visibleArea)&&(a={overlayFit:x,overlayPoint:_,originPoint:p,position:c,overlayRect:n})}if(o.length){let c=null,p=-1;for(const _ of o){const x=_.boundingBoxRect.width*_.boundingBoxRect.height*(_.position.weight||1);x>p&&(p=x,c=_)}return this._isPushed=!1,void this._applyPosition(c.position,c.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Xm(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(F5),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;t?(this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._getContainerRect(),this._applyPosition(t,this._getOriginPoint(this._originRect,this._containerRect,t))):this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}withPopoverLocation(t){return this._popoverLocation=t,this}getPopoverInsertionPoint(){return"global"===this._popoverLocation?null:"inline"!==this._popoverLocation?this._popoverLocation:this._origin instanceof Pr?this._origin.nativeElement:oR(this._origin)?this._origin:null}_getOriginPoint(t,n,r){let i,o;if("center"==r.originX)i=t.left+t.width/2;else{const a=this._isRtl()?t.right:t.left,c=this._isRtl()?t.left:t.right;i="start"==r.originX?a:c}return n.left<0&&(i-=n.left),o="center"==r.originY?t.top+t.height/2:"top"==r.originY?t.top:t.bottom,n.top<0&&(o-=n.top),{x:i,y:o}}_getOverlayPoint(t,n,r){let i,o;return i="center"==r.overlayX?-n.width/2:"start"===r.overlayX?this._isRtl()?-n.width:0:this._isRtl()?0:-n.width,o="center"==r.overlayY?-n.height/2:"top"==r.overlayY?0:-n.height,{x:t.x+i,y:t.y+o}}_getOverlayFit(t,n,r,i){const o=V5(n);let{x:a,y:c}=t,p=this._getOffset(i,"x"),_=this._getOffset(i,"y");p&&(a+=p),_&&(c+=_);let A=0-c,O=c+o.height-r.height,B=this._subtractOverflows(o.width,0-a,a+o.width-r.width),Q=this._subtractOverflows(o.height,A,O),oe=B*Q;return{visibleArea:oe,isCompletelyWithinViewport:o.width*o.height===oe,fitsInViewportVertically:Q===o.height,fitsInViewportHorizontally:B==o.width}}_canFitWithFlexibleDimensions(t,n,r){if(this._hasFlexibleDimensions){const i=r.bottom-n.y,o=r.right-n.x,a=B5(this._overlayRef.getConfig().minHeight),c=B5(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=a&&a<=i)&&(t.fitsInViewportHorizontally||null!=c&&c<=o)}return!1}_pushOverlayOnScreen(t,n,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const i=V5(n),o=this._viewportRect,a=Math.max(t.x+i.width-o.width,0),c=Math.max(t.y+i.height-o.height,0),p=Math.max(o.top-r.top-t.y,0),_=Math.max(o.left-r.left-t.x,0);let x=0,D=0;return x=i.width<=o.width?_||-a:t.x<this._getViewportMarginStart()?o.left-r.left-t.x:0,D=i.height<=o.height?p||-c:t.y<this._getViewportMarginTop()?o.top-r.top-t.y:0,this._previousPushAmount={x,y:D},{x:t.x+x,y:t.y+D}}_applyPosition(t,n){if(this._setTransformOrigin(t),this._setOverlayElementStyles(n,t),this._setBoundingBoxStyles(n,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){const r=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!function Jde(e,t){return e===t||e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}(this._lastScrollVisibility,r)){const i=new Gde(t,r);this._positionChanges.next(i)}this._lastScrollVisibility=r}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const n=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=t.overlayY;r="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let o=0;o<n.length;o++)n[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(t,n){const r=this._viewportRect,i=this._isRtl();let o,a,c;if("top"===n.overlayY)a=t.y,o=r.height-a+this._getViewportMarginBottom();else if("bottom"===n.overlayY)c=r.height-t.y+this._getViewportMarginTop()+this._getViewportMarginBottom(),o=r.height-c+this._getViewportMarginTop();else{const O=Math.min(r.bottom-t.y+r.top,t.y),B=this._lastBoundingBoxSize.height;o=2*O,a=t.y-O,o>B&&!this._isInitialRender&&!this._growAfterOpen&&(a=t.y-B/2)}const p="start"===n.overlayX&&!i||"end"===n.overlayX&&i;let x,D,A;if("end"===n.overlayX&&!i||"start"===n.overlayX&&i)A=r.width-t.x+this._getViewportMarginStart()+this._getViewportMarginEnd(),x=t.x-this._getViewportMarginStart();else if(p)D=t.x,x=r.right-t.x-this._getViewportMarginEnd();else{const O=Math.min(r.right-t.x+r.left,t.x),B=this._lastBoundingBoxSize.width;x=2*O,D=t.x-O,x>B&&!this._isInitialRender&&!this._growAfterOpen&&(D=t.x-B/2)}return{top:a,left:D,bottom:c,right:A,width:x,height:o}}_setBoundingBoxStyles(t,n){const r=this._calculateBoundingBoxRect(t,n);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right="auto",i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;i.width=Lo(r.width),i.height=Lo(r.height),i.top=Lo(r.top)||"auto",i.bottom=Lo(r.bottom)||"auto",i.left=Lo(r.left)||"auto",i.right=Lo(r.right)||"auto",i.alignItems="center"===n.overlayX?"center":"end"===n.overlayX?"flex-end":"flex-start",i.justifyContent="center"===n.overlayY?"center":"bottom"===n.overlayY?"flex-end":"flex-start",o&&(i.maxHeight=Lo(o)),a&&(i.maxWidth=Lo(a))}this._lastBoundingBoxSize=r,Xm(this._boundingBox.style,i)}_resetBoundingBoxStyles(){Xm(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Xm(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,n){const r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(i){const x=this._viewportRuler.getViewportScrollPosition();Xm(r,this._getExactOverlayY(n,t,x)),Xm(r,this._getExactOverlayX(n,t,x))}else r.position="static";let c="",p=this._getOffset(n,"x"),_=this._getOffset(n,"y");p&&(c+=`translateX(${p}px) `),_&&(c+=`translateY(${_}px)`),r.transform=c.trim(),a.maxHeight&&(i?r.maxHeight=Lo(a.maxHeight):o&&(r.maxHeight="")),a.maxWidth&&(i?r.maxWidth=Lo(a.maxWidth):o&&(r.maxWidth="")),Xm(this._pane.style,r)}_getExactOverlayY(t,n,r){let i={top:"",bottom:""},o=this._getOverlayPoint(n,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),"bottom"===t.overlayY?i.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":i.top=Lo(o.y),i}_getExactOverlayX(t,n,r){let a,i={left:"",right:""},o=this._getOverlayPoint(n,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),a=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===a?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=Lo(o.x),i}_getScrollVisibility(){const t=this._getOriginRect(),n=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:R5(t,r),isOriginOutsideView:nR(t,r),isOverlayClipped:R5(n,r),isOverlayOutsideView:nR(n,r)}}_subtractOverflows(t,...n){return n.reduce((r,i)=>r-Math.max(i,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,n=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._getViewportMarginTop(),left:r.left+this._getViewportMarginStart(),right:r.left+t-this._getViewportMarginEnd(),bottom:r.top+n-this._getViewportMarginBottom(),width:t-this._getViewportMarginStart()-this._getViewportMarginEnd(),height:n-this._getViewportMarginTop()-this._getViewportMarginBottom()}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,n){return"x"===n?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Kb(t).forEach(n=>{""!==n&&-1===this._appliedPanelClasses.indexOf(n)&&(this._appliedPanelClasses.push(n),this._pane.classList.add(n))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getViewportMarginStart(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.start??0}_getViewportMarginEnd(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.end??0}_getViewportMarginTop(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.top??0}_getViewportMarginBottom(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.bottom??0}_getOriginRect(){const t=this._origin;if(t instanceof Pr)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const n=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+n,height:r,width:n}}_getContainerRect(){const t=this._overlayRef.getConfig().usePopover&&"global"!==this._popoverLocation,n=this._overlayContainer.getContainerElement();t&&(n.style.display="block");const r=n.getBoundingClientRect();return t&&(n.style.display=""),r}}function Xm(e,t){for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function B5(e){if("number"!=typeof e&&null!=e){const[t,n]=e.split(Yde);return n&&"px"!==n?null:parseFloat(t)}return e||null}function V5(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const z5="cdk-global-overlay-wrapper";function s1(e){return new ehe}class ehe{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(t){const n=t.getConfig();this._overlayRef=t,this._width&&!n.width&&t.updateSize({width:this._width}),this._height&&!n.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(z5),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:a,maxHeight:c}=r,p=!("100%"!==i&&"100vw"!==i||a&&"100%"!==a&&"100vw"!==a),_=!("100%"!==o&&"100vh"!==o||c&&"100%"!==c&&"100vh"!==c),x=this._xPosition,D=this._xOffset,A="rtl"===this._overlayRef.getConfig().direction;let O="",B="",Q="";p?Q="flex-start":"center"===x?(Q="center",A?B=D:O=D):A?"left"===x||"end"===x?(Q="flex-end",O=D):("right"===x||"start"===x)&&(Q="flex-start",B=D):"left"===x||"start"===x?(Q="flex-start",O=D):("right"===x||"end"===x)&&(Q="flex-end",B=D),t.position=this._cssPosition,t.marginLeft=p?"0":O,t.marginTop=_?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=p?"0":B,n.justifyContent=Q,n.alignItems=_?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,n=this._overlayRef.hostElement,r=n.style;n.classList.remove(z5),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let the=(()=>{class e{_injector=Z(En);constructor(){}global(){return s1()}flexibleConnectedTo(n){return function Xde(e,t){return new Qde(t,e.get(ly),e.get(Fn),e.get(Il),e.get(iR))}(this._injector,n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const nhe=new Le("OVERLAY_DEFAULT_CONFIG");function sR(e,t){e.get(oy).load(N5);const n=e.get(iR),r=e.get(Fn),i=e.get(du),o=e.get(wl),a=e.get(ay),c=e.get(za,null,{optional:!0})||e.get(vl).createRenderer(null,null),p=new rR(t),_=e.get(nhe,null,{optional:!0})?.usePopover??!0;p.direction=p.direction||a.value,p.usePopover="showPopover"in r.body&&(t?.usePopover??_);const x=r.createElement("div"),D=r.createElement("div");x.id=i.getId("cdk-overlay-"),x.classList.add("cdk-overlay-pane"),D.appendChild(x),p.usePopover&&(D.setAttribute("popover","manual"),D.classList.add("cdk-overlay-popover"));const A=p.usePopover?p.positionStrategy?.getPopoverInsertionPoint?.():null;return oR(A)?A.after(D):"parent"===A?.type?A.element.appendChild(D):n.getContainerElement().appendChild(D),new L5(new xde(x,o,e),D,x,p,e.get(Xt),e.get(Wde),r,e.get(K_),e.get(Zde),t?.disableAnimations??"NoopAnimations"===e.get(oa,null,{optional:!0}),e.get(Fr),c)}let rhe=(()=>{class e{scrollStrategies=Z(qde);_positionBuilder=Z(the);_injector=Z(En);constructor(){}create(n){return sR(this._injector,n)}position(){return this._positionBuilder}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),aR=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[rhe],imports:[Zm,Qb,k5,k5]})}return e})();function ihe(e,t){if(1&e){const n=Mo();ge(0,"div",1)(1,"button",2),tn("click",function(){return yn(n),er(Et().action())}),we(2),be()()}if(2&e){const n=Et();Me(2),gc(" ",n.data.action," ")}}const ohe=["label"];function she(e,t){}const ahe=Math.pow(2,31)-1;class lR{_overlayRef;instance;containerInstance;_afterDismissed=new K;_afterOpened=new K;_onAction=new K;_durationTimeoutId;_dismissedByAction=!1;constructor(t,n){this._overlayRef=n,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,ahe))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const U5=new Le("MatSnackBarData");class a1{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"}let j5=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return e})(),H5=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return e})(),$5=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return e})(),q5=(()=>{class e{snackBarRef=Z(lR);data=Z(U5);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(r,i){1&r&&(ge(0,"div",0),we(1),be(),hr(2,ihe,3,1,"div",1)),2&r&&(Me(),gc(" ",i.data.message,"\n"),Me(),fr(i.hasAction?2:-1))},dependencies:[Wue,j5,H5,$5],styles:[".mat-mdc-simple-snack-bar{display:flex}.mat-mdc-simple-snack-bar .mat-mdc-snack-bar-label{max-height:50vh;overflow:auto}\n"],encapsulation:2,changeDetection:0})}return e})();const cR="_mat-snack-bar-enter",uR="_mat-snack-bar-exit";let G5=(()=>{class e extends t1{_ngZone=Z(Xt);_elementRef=Z(Pr);_changeDetectorRef=Z(_h);_platform=Z(Il);_animationsDisabled=sy();snackBarConfig=Z(a1);_document=Z(Fn);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=Z(En);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new K;_onExit=new K;_onEnter=new K;_animationState="void";_live;_label;_role;_liveElementId=Z(du).getId("mat-snack-bar-container-live-");constructor(){super();const n=this.snackBarConfig;this._live="assertive"!==n.politeness||n.announcementMessage?"off"===n.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(n){this._assertNotAttached();const r=this._portalOutlet.attachComponentPortal(n);return this._afterPortalAttached(),r}attachTemplatePortal(n){this._assertNotAttached();const r=this._portalOutlet.attachTemplatePortal(n);return this._afterPortalAttached(),r}attachDomPortal=n=>{this._assertNotAttached();const r=this._portalOutlet.attachDomPortal(n);return this._afterPortalAttached(),r};onAnimationEnd(n){n===uR?this._completeExit():n===cR&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?iu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(cR)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(cR)},200)))}exit(){return this._destroyed?Sn(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?iu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(uR)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(uR),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){const n=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(a=>n.classList.add(a)):n.classList.add(r)),this._exposeToModals();const i=this._label.nativeElement,o="mdc-snackbar__label";i.classList.toggle(o,!i.querySelector(`.${o}`))}_exposeToModals(){const n=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");this._trackedModals.add(o),a?-1===a.indexOf(n)&&o.setAttribute("aria-owns",a+" "+n):o.setAttribute("aria-owns",n)}}_clearFromModals(){this._trackedModals.forEach(n=>{const r=n.getAttribute("aria-owns");if(r){const i=r.replace(this._liveElementId,"").trim();i.length>0?n.setAttribute("aria-owns",i):n.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;const n=this._elementRef.nativeElement,r=n.querySelector("[aria-hidden]"),i=n.querySelector("[aria-live]");if(r&&i){let o=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&r.contains(document.activeElement)&&(o=document.activeElement),r.removeAttribute("aria-hidden"),i.appendChild(r),o?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,i){if(1&r&&Mm(Xb,7)(ohe,7),2&r){let o;Zf(o=Kf())&&(i._portalOutlet=o.first),Zf(o=Kf())&&(i._label=o.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(r,i){1&r&&tn("animationend",function(a){return i.onAnimationEnd(a.animationName)})("animationcancel",function(a){return i.onAnimationEnd(a.animationName)}),2&r&&El("mat-snack-bar-container-enter","visible"===i._animationState)("mat-snack-bar-container-exit","hidden"===i._animationState)("mat-snack-bar-container-animations-enabled",!i._animationsDisabled)},features:[zn],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(ge(0,"div",1)(1,"div",2,0)(3,"div",3),Zv(4,she,0,0,"ng-template",4),be(),pn(5,"div"),be()()),2&r&&(Me(5),$s("aria-live",i._live)("role",i._role)("id",i._liveElementId))},dependencies:[Xb],styles:["@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}\n"],encapsulation:2})}return e})();const lhe=new Le("mat-snack-bar-default-options",{providedIn:"root",factory:()=>new a1});let cy=(()=>{class e{_live=Z(yde);_injector=Z(En);_breakpointObserver=Z(l5);_parentSnackBar=Z(e,{optional:!0,skipSelf:!0});_defaultConfig=Z(lhe);_animationsDisabled=sy();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=q5;snackBarContainerComponent=G5;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){const n=this._parentSnackBar;return n?n._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(n){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=n:this._snackBarRefAtThisLevel=n}constructor(){}openFromComponent(n,r){return this._attach(n,r)}openFromTemplate(n,r){return this._attach(n,r)}open(n,r="",i){const o={...this._defaultConfig,...i};return o.data={message:n,action:r},o.announcementMessage===n&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(n,r){const o=En.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:a1,useValue:r}]}),a=new Yb(this.snackBarContainerComponent,r.viewContainerRef,o),c=n.attach(a);return c.instance.snackBarConfig=r,c.instance}_attach(n,r){const i={...new a1,...this._defaultConfig,...r},o=this._createOverlay(i),a=this._attachSnackBarContainer(o,i),c=new lR(a,o);if(n instanceof yl){const p=new XA(n,null,{$implicit:i.data,snackBarRef:c});c.instance=a.attachTemplatePortal(p)}else{const p=this._createInjector(i,c),_=new Yb(n,void 0,p),x=a.attachComponentPortal(_);c.instance=x.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(ad(o.detachments())).subscribe(p=>{o.overlayElement.classList.toggle(this.handsetCssClass,p.matches)}),i.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(c,i),this._openedSnackBarRef=c,this._openedSnackBarRef}_animateSnackBar(n,r){n.afterDismissed().subscribe(()=>{this._openedSnackBarRef==n&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),r.duration&&r.duration>0&&n.afterOpened().subscribe(()=>n._dismissAfter(r.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{n.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):n.containerInstance.enter()}_createOverlay(n){const r=new rR;r.direction=n.direction;const i=s1(),o="rtl"===n.direction,a="left"===n.horizontalPosition||"start"===n.horizontalPosition&&!o||"end"===n.horizontalPosition&&o,c=!a&&"center"!==n.horizontalPosition;return a?i.left("0"):c?i.right("0"):i.centerHorizontally(),"top"===n.verticalPosition?i.top("0"):i.bottom("0"),r.positionStrategy=i,r.disableAnimations=this._animationsDisabled,sR(this._injector,r)}_createInjector(n,r){return En.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:lR,useValue:r},{provide:U5,useValue:n.data}]})}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),che=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[cy],imports:[aR,Qb,Yue,q5,Zm]})}return e})();function W5(e,...t){return t.length?t.some(n=>e[n]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}function uhe(e,t){}class tw{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;disableAnimations=!1;providers;container;templateContext}let Z5=(()=>{class e extends t1{_elementRef=Z(Pr);_focusTrapFactory=Z(pde);_config;_interactivityChecker=Z(y5);_ngZone=Z(Xt);_focusMonitor=Z(i5);_renderer=Z(za);_changeDetectorRef=Z(_h);_injector=Z(En);_platform=Z(Il);_document=Z(Fn);_portalOutlet;_focusTrapped=new K;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_isDestroyed=!1;constructor(){super(),this._config=Z(tw,{optional:!0})||new tw,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(n){this._ariaLabelledByQueue.push(n),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(n){const r=this._ariaLabelledByQueue.indexOf(n);r>-1&&(this._ariaLabelledByQueue.splice(r,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._focusTrapped.complete(),this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(n){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(n);return this._contentAttached(),r}attachTemplatePortal(n){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(n);return this._contentAttached(),r}attachDomPortal=n=>{this._portalOutlet.hasAttached();const r=this._portalOutlet.attachDomPortal(n);return this._contentAttached(),r};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(n,r){this._interactivityChecker.isFocusable(n)||(n.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const i=()=>{o(),a(),n.removeAttribute("tabindex")},o=this._renderer.listen(n,"blur",i),a=this._renderer.listen(n,"mousedown",i)})),n.focus(r)}_focusByCssSelector(n,r){let i=this._elementRef.nativeElement.querySelector(n);i&&this._forceFocus(i,r)}_trapFocus(n){this._isDestroyed||iu(()=>{const r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus(n);break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement(n)||this._focusDialogContainer(n);break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]',n);break;default:this._focusByCssSelector(this._config.autoFocus,n)}this._focusTrapped.next()},{injector:this._injector})}_restoreFocus(){const n=this._config.restoreFocus;let r=null;if("string"==typeof n?r=this._document.querySelector(n):"boolean"==typeof n?r=n?this._elementFocusedBeforeDialogWasOpened:null:n&&(r=n),this._config.restoreFocus&&r&&"function"==typeof r.focus){const i=BA(),o=this._elementRef.nativeElement;(!i||i===this._document.body||i===o||o.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(n){this._elementRef.nativeElement.focus?.(n)}_containsFocus(){const n=this._elementRef.nativeElement,r=BA();return n===r||n.contains(r)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=BA()))}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(r,i){if(1&r&&Mm(Xb,7),2&r){let o;Zf(o=Kf())&&(i._portalOutlet=o.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,i){2&r&&$s("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[zn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,i){1&r&&Zv(0,uhe,0,0,"ng-template",0)},dependencies:[Xb],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}\n"],encapsulation:2})}return e})();class dR{overlayRef;config;componentInstance=null;componentRef=null;containerInstance;disableClose;closed=new K;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(t,n){this.overlayRef=t,this.config=n,this.disableClose=n.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=n.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!W5(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{!this.disableClose&&this._canClose()?this.close(void 0,{focusOrigin:"mouse"}):this.containerInstance._recaptureFocus?.()}),this._detachSubscription=t.detachments().subscribe(()=>{!1!==n.closeOnOverlayDetachments&&this.close()})}close(t,n){if(this._canClose(t)){const r=this.closed;this.containerInstance._closeInteractionType=n?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(t),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",n=""){return this.overlayRef.updateSize({width:t,height:n}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}_canClose(t){const n=this.config;return!!this.containerInstance&&(!n.closePredicate||n.closePredicate(t,n,this.componentInstance))}}const dhe=new Le("DialogScrollStrategy",{providedIn:"root",factory:()=>{const e=Z(En);return()=>eR(e)}}),hhe=new Le("DialogData"),fhe=new Le("DefaultDialogConfig");function phe(e){const t=as(e),n=new Bn;return{valueSignal:t,get value(){return t()},change:n,ngOnDestroy(){n.complete()}}}let K5=(()=>{class e{_injector=Z(En);_defaultOptions=Z(fhe,{optional:!0});_parentDialog=Z(e,{optional:!0,skipSelf:!0});_overlayContainer=Z(iR);_idGenerator=Z(du);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new K;_afterOpenedAtThisLevel=new K;_ariaHiddenElements=new Map;_scrollStrategy=Z(dhe);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=Db(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Q_(void 0)));constructor(){}open(n,r){(r={...this._defaultOptions||new tw,...r}).id=r.id||this._idGenerator.getId("cdk-dialog-"),r.id&&this.getDialogById(r.id);const o=this._getOverlayConfig(r),a=sR(this._injector,o),c=new dR(a,r),p=this._attachContainer(a,c,r);if(c.containerInstance=p,!this.openDialogs.length){const _=this._overlayContainer.getContainerElement();p._focusTrapped?p._focusTrapped.pipe(Rs(1)).subscribe(()=>{this._hideNonDialogContentFromAssistiveTechnology(_)}):this._hideNonDialogContentFromAssistiveTechnology(_)}return this._attachDialogContent(n,c,p,r),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){hR(this.openDialogs,n=>n.close())}getDialogById(n){return this.openDialogs.find(r=>r.id===n)}ngOnDestroy(){hR(this._openDialogsAtThisLevel,n=>{!1===n.config.closeOnDestroy&&this._removeOpenDialog(n,!1)}),hR(this._openDialogsAtThisLevel,n=>n.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(n){const r=new rR({positionStrategy:n.positionStrategy||s1().centerHorizontally().centerVertically(),scrollStrategy:n.scrollStrategy||this._scrollStrategy(),panelClass:n.panelClass,hasBackdrop:n.hasBackdrop,direction:n.direction,minWidth:n.minWidth,minHeight:n.minHeight,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.width,height:n.height,disposeOnNavigation:n.closeOnNavigation,disableAnimations:n.disableAnimations});return n.backdropClass&&(r.backdropClass=n.backdropClass),r}_attachContainer(n,r,i){const o=i.injector||i.viewContainerRef?.injector,a=[{provide:tw,useValue:i},{provide:dR,useValue:r},{provide:L5,useValue:n}];let c;i.container?"function"==typeof i.container?c=i.container:(c=i.container.type,a.push(...i.container.providers(i))):c=Z5;const p=new Yb(c,i.viewContainerRef,En.create({parent:o||this._injector,providers:a}));return n.attach(p).instance}_attachDialogContent(n,r,i,o){if(n instanceof yl){const a=this._createInjector(o,r,i,void 0);let c={$implicit:o.data,dialogRef:r};o.templateContext&&(c={...c,..."function"==typeof o.templateContext?o.templateContext():o.templateContext}),i.attachTemplatePortal(new XA(n,null,c,a))}else{const a=this._createInjector(o,r,i,this._injector),c=i.attachComponentPortal(new Yb(n,o.viewContainerRef,a));r.componentRef=c,r.componentInstance=c.instance}}_createInjector(n,r,i,o){const a=n.injector||n.viewContainerRef?.injector,c=[{provide:hhe,useValue:n.data},{provide:dR,useValue:r}];return n.providers&&("function"==typeof n.providers?c.push(...n.providers(r,n,i)):c.push(...n.providers)),n.direction&&(!a||!a.get(ay,null,{optional:!0}))&&c.push({provide:ay,useValue:phe(n.direction)}),En.create({parent:a||o,providers:c})}_removeOpenDialog(n,r){const i=this.openDialogs.indexOf(n);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((o,a)=>{o?a.setAttribute("aria-hidden",o):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(n){if(n.parentElement){const r=n.parentElement.children;for(let i=r.length-1;i>-1;i--){const o=r[i];o!==n&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&!o.hasAttribute("popover")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function hR(e,t){let n=e.length;for(;n--;)t(e[n])}let mhe=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[K5],imports:[aR,Qb,bde,Qb]})}return e})();class Y5 extends K{constructor(t=1/0,n=1/0,r=HA){super(),this._bufferSize=t,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,n)}next(t){const{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:a}=this;n||(r.push(t),!i&&r.push(o.now()+a)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let a=0;a<o.length&&!t.closed;a+=r?1:2)t.next(o[a]);return this._checkFinalizedStatuses(t),n}_trimBuffer(){const{_bufferSize:t,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){const a=n.now();let c=0;for(let p=1;p<r.length&&r[p]<=a;p+=2)c=p;c&&r.splice(0,c+1)}}}function l1(...e){const t=Cb(e),n=function Kse(e,t){return"number"==typeof Xk(e)?e.pop():t}(e,1/0),r=e;return r.length?1===r.length?wc(r[0]):X_(n)(ds(r,t)):ua}function ghe(e,t){}class X5{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;enterAnimationDuration;exitAnimationDuration}const fR="mdc-dialog--open",Q5="mdc-dialog--opening",J5="mdc-dialog--closing";let eH=(()=>{class e extends Z5{_animationStateChanged=new Bn;_animationsEnabled=!sy();_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?nH(this._config.enterAnimationDuration)??150:0;_exitAnimationDuration=this._animationsEnabled?nH(this._config.exitAnimationDuration)??75:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(tH,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(Q5,fR)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(fR),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(fR),this._animationsEnabled?(this._hostElement.style.setProperty(tH,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(J5)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(n){this._actionSectionCount+=n,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(Q5,J5)}_waitForAnimationToComplete(n,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,n)}_requestAnimationFrame(n){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(n):n()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(n){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:n})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(n){const r=super.attachComponentPortal(n);return r.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),r}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275cmp=Er({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(r,i){2&r&&(tb("id",i._config.id),$s("aria-modal",i._config.ariaModal)("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),El("_mat-animation-noopable",!i._animationsEnabled)("mat-mdc-dialog-container-with-actions",i._actionSectionCount>0))},features:[zn],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"div",1),Zv(2,ghe,0,0,"ng-template",2),be()())},dependencies:[Xb],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mat-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mat-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mat-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mat-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mat-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mat-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mat-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mat-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mat-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mat-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mat-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mat-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mat-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;box-sizing:border-box;min-height:52px;margin:0;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}\n'],encapsulation:2})}return e})();const tH="--mat-dialog-transition-duration";function nH(e){return null==e?null:"number"==typeof e?e:e.endsWith("ms")?GC(e.substring(0,e.length-2)):e.endsWith("s")?1e3*GC(e.substring(0,e.length-1)):"0"===e?0:null}var c1=function(e){return e[e.OPEN=0]="OPEN",e[e.CLOSING=1]="CLOSING",e[e.CLOSED=2]="CLOSED",e}(c1||{});class Qm{_ref;_config;_containerInstance;componentInstance;componentRef=null;disableClose;id;_afterOpened=new Y5(1);_beforeClosed=new Y5(1);_result;_closeFallbackTimeout;_state=c1.OPEN;_closeInteractionType;constructor(t,n,r){this._ref=t,this._config=n,this._containerInstance=r,this.disableClose=n.disableClose,this.id=t.id,t.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(As(i=>"opened"===i.state),Rs(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(As(i=>"closed"===i.state),Rs(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),l1(this.backdropClick(),this.keydownEvents().pipe(As(i=>27===i.keyCode&&!this.disableClose&&!W5(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),function rH(e,t,n){return e._closeInteractionType=t,e.close(n)}(this,"keydown"===i.type?"keyboard":"mouse"))})}close(t){const n=this._config.closePredicate;n&&!n(t,this._config,this.componentInstance)||(this._result=t,this._containerInstance._animationStateChanged.pipe(As(r=>"closing"===r.state),Rs(1)).subscribe(r=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),r.totalTime+100)}),this._state=c1.CLOSING,this._containerInstance._startExitAnimation())}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let n=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?n.left(t.left):n.right(t.right):n.centerHorizontally(),t&&(t.top||t.bottom)?t.top?n.top(t.top):n.bottom(t.bottom):n.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",n=""){return this._ref.updateSize(t,n),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=c1.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const u1=new Le("MatMdcDialogData"),vhe=new Le("mat-mdc-dialog-default-options"),bhe=new Le("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const e=Z(En);return()=>eR(e)}});let op=(()=>{class e{_defaultOptions=Z(vhe,{optional:!0});_scrollStrategy=Z(bhe);_parentDialog=Z(e,{optional:!0,skipSelf:!0});_idGenerator=Z(du);_injector=Z(En);_dialog=Z(K5);_animationsDisabled=sy();_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new K;_afterOpenedAtThisLevel=new K;dialogConfigClass=X5;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=Db(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Q_(void 0)));constructor(){this._dialogRefConstructor=Qm,this._dialogContainerType=eH,this._dialogDataToken=u1}open(n,r){let i;(r={...this._defaultOptions||new X5,...r}).id=r.id||this._idGenerator.getId("mat-mdc-dialog-"),r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const o=this._dialog.open(n,{...r,positionStrategy:s1().centerHorizontally().centerVertically(),disableClose:!0,closePredicate:void 0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,disableAnimations:this._animationsDisabled||"0"===r.enterAnimationDuration?.toLocaleString()||"0"===r.exitAnimationDuration?.toString(),container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:tw,useValue:r}]},templateContext:()=>({dialogRef:i}),providers:(a,c,p)=>(i=new this._dialogRefConstructor(a,r,p),i.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:p},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:i}])});return i.componentRef=o.componentRef,i.componentInstance=o.componentInstance,this.openDialogs.push(i),this.afterOpened.next(i),i.afterClosed().subscribe(()=>{const a=this.openDialogs.indexOf(i);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(n){return this.openDialogs.find(r=>r.id===n)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(n){let r=n.length;for(;r--;)n[r].close()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Dhe=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[op],imports:[mhe,aR,Qb,Zm]})}return e})();const sp=new U(xa),pR="Service workers are disabled or not supported by this browser";class d1{serviceWorker;worker;registration;events;constructor(t,n){if(this.serviceWorker=t,t){let r=null;const i=new K;this.worker=new U(_=>(null!==r&&_.next(r),i.subscribe(x=>_.next(x))));const o=()=>{const{controller:_}=t;null!==_&&(r=_,i.next(r))};t.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(qa(()=>t.getRegistration().then(_=>{if(!_)throw new se(5601,!1);return _})));const a=new K;this.events=a.asObservable();const c=_=>{const{data:x}=_;x?.type&&a.next(x)};t.addEventListener("message",c),n?.get(wl,null,{optional:!0})?.onDestroy(()=>{t.removeEventListener("controllerchange",o),t.removeEventListener("message",c)})}else this.worker=this.events=this.registration=new U(r=>r.error(new se(5601,!1)))}postMessage(t,n){return new Promise(r=>{this.worker.pipe(Rs(1)).subscribe(i=>{i.postMessage({action:t,...n}),r()})})}postMessageWithOperation(t,n,r){const i=this.waitForOperationCompleted(r),o=this.postMessage(t,n);return Promise.all([o,i]).then(([,a])=>a)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(t){let n;return n="string"==typeof t?r=>r.type===t:r=>t.includes(r.type),this.events.pipe(As(n))}nextEventOfType(t){return this.eventsOfType(t).pipe(Rs(1))}waitForOperationCompleted(t){return new Promise((n,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(As(i=>i.nonce===t),Rs(1),ar(i=>{if(void 0!==i.result)return i.result;throw new Error(i.error)})).subscribe({next:n,error:r})})}get isEnabled(){return!!this.serviceWorker}}let sH=(()=>{class e{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new K;constructor(n){if(this.sw=n,!n.isEnabled)return this.messages=sp,this.notificationClicks=sp,this.notificationCloses=sp,this.pushSubscriptionChanges=sp,void(this.subscription=sp);this.messages=this.sw.eventsOfType("PUSH").pipe(ar(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(ar(i=>i.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(ar(i=>i.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(ar(i=>i.data)),this.pushManager=this.sw.registration.pipe(ar(i=>i.pushManager));const r=this.pushManager.pipe(qa(i=>i.getSubscription()));this.subscription=new U(i=>{const o=r.subscribe(i),a=this.subscriptionChanges.subscribe(i);return()=>{o.unsubscribe(),a.unsubscribe()}})}requestSubscription(n){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(pR));const r={userVisibleOnly:!0};let i=this.decodeBase64(n.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return r.applicationServerKey=o,new Promise((a,c)=>{this.pushManager.pipe(qa(p=>p.subscribe(r)),Rs(1)).subscribe({next:p=>{this.subscriptionChanges.next(p),a(p)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(pR));const n=r=>{if(null===r)throw new se(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new se(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(Rs(1),qa(n)).subscribe({next:r,error:i})})}decodeBase64(n){return atob(n)}static \u0275fac=function(r){return new(r||e)(Ct(d1))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})(),aH=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(n){if(this.sw=n,!n.isEnabled)return this.versionUpdates=sp,void(this.unrecoverable=sp);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(pR));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;const n=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:n},n).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new se(5601,!1));const n=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:n},n)}static \u0275fac=function(r){return new(r||e)(Ct(d1))};static \u0275prov=Ue({token:e,factory:e.\u0275fac})}return e})();const lH=new Le("");function The(){const e=Z(mR);if(!("serviceWorker"in navigator)||!1===e.enabled)return;const t=Z(lH),n=Z(Xt),r=Z(wl);n.runOutsideAngular(()=>{const i=navigator.serviceWorker,o=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",o),r.onDestroy(()=>{i.removeEventListener("controllerchange",o)})}),n.runOutsideAngular(()=>{let i;const{registrationStrategy:o}=e;if("function"==typeof o)i=new Promise(a=>o().subscribe(()=>a()));else{const[a,...c]=(o||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=cH(+c[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),cH(+c[0])]);break;default:throw new se(5600,!1)}}i.then(()=>{r.destroyed||navigator.serviceWorker.register(t,{scope:e.scope,updateViaCache:e.updateViaCache,type:e.type}).catch(a=>console.error(Nt(5604,!1)))})})}function cH(e){return new Promise(t=>setTimeout(t,e))}function She(){const e=Z(mR),t=Z(En);return new d1(!1!==e.enabled?navigator.serviceWorker:void 0,t)}class mR{enabled;updateViaCache;type;scope;registrationStrategy}function Ihe(e,t={}){return Ra([sH,aH,{provide:lH,useValue:e},{provide:mR,useValue:t},{provide:d1,useFactory:She},WS(The)])}let khe=(()=>{class e{static register(n,r={}){return{ngModule:e,providers:[Ihe(n,r)]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[sH,aH]})}return e})();const it=function(e,t){if(!e)throw uy(t)},uy=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},uH=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},_R={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const o=e[i],a=i+1<e.length,c=a?e[i+1]:0,p=i+2<e.length,_=p?e[i+2]:0;let A=(15&c)<<2|_>>6,O=63&_;p||(O=64,a||(A=64)),r.push(n[o>>2],n[(3&o)<<4|c>>4],n[A],n[O])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(uH(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const p=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(p>>10)),t[r++]=String.fromCharCode(56320+(1023&p))}else{const o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const o=n[e.charAt(i++)],c=i<e.length?n[e.charAt(i)]:0;++i;const _=i<e.length?n[e.charAt(i)]:64;++i;const D=i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==c||null==_||null==D)throw new Rhe;r.push(o<<2|c>>4),64!==_&&(r.push(c<<4&240|_>>2),64!==D&&r.push(_<<6&192|D))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Rhe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dH=function(e){const t=uH(e);return _R.encodeByteArray(t,!0)},h1=function(e){return dH(e).replace(/\./g,"")},f1=function(e){try{return _R.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Mhe(e){return hH(void 0,e)}function hH(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!Phe(n)||(e[n]=hH(e[n],t[n]));return e}function Phe(e){return"__proto__"!==e}const p1=()=>{try{return function Ohe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&f1(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},fH=e=>{var t,n;return null===(n=null===(t=p1())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},pH=e=>{const t=fH(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},mH=()=>{var e;return null===(e=p1())||void 0===e?void 0:e.config},gH=e=>{var t;return null===(t=p1())||void 0===t?void 0:t[`_${e}`]};class dy{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(n):t(n,r))}}}function _H(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",i=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[h1(JSON.stringify({alg:"none",type:"JWT"})),h1(JSON.stringify(a)),""].join(".")}function Ps(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function yR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ps())}function yH(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class Sh extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Sh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nw.prototype.create)}}class nw{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,o=this.errors[t],a=o?function Ghe(e,t){return e.replace(Whe,(n,r)=>{const i=t[r];return null!=i?String(i):`<${r}?>`})}(o,r):"Error";return new Sh(i,`${this.serviceName}: ${a} (${i}).`,r)}}const Whe=/\{\$([^}]+)}/g;function rw(e){return JSON.parse(e)}function Ko(e){return JSON.stringify(e)}const m1=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=rw(f1(o[0])||""),n=rw(f1(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:r,signature:i}};function hd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function hy(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function vR(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function g1(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function _1(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const o=e[i],a=t[i];if(vH(o)&&vH(a)){if(!_1(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function vH(e){return null!==e&&"object"==typeof e}function fy(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(i=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class Yhe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const r=this.W_;if("string"==typeof t)for(let D=0;D<16;D++)r[D]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let D=0;D<16;D++)r[D]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let D=16;D<80;D++){const A=r[D-3]^r[D-8]^r[D-14]^r[D-16];r[D]=4294967295&(A<<1|A>>>31)}let _,x,i=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],p=this.chain_[4];for(let D=0;D<80;D++){D<40?D<20?(_=c^o&(a^c),x=1518500249):(_=o^a^c,x=1859775393):D<60?(_=o&a|c&(o|a),x=2400959708):(_=o^a^c,x=3395469782);const A=(i<<5|i>>>27)+_+p+x+r[D]&4294967295;p=c,c=a,a=4294967295&(o<<30|o>>>2),o=i,i=A}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+p&4294967295}update(t,n){if(null==t)return;void 0===n&&(n=t.length);const r=n-this.blockSize;let i=0;const o=this.buf_;let a=this.inbuf_;for(;i<n;){if(0===a)for(;i<=r;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<n;)if(o[a]=t.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}else for(;i<n;)if(o[a]=t[i],++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=n}digest(){const t=[];let n=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&n,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)t[r]=this.chain_[i]>>o&255,++r;return t}}class Qhe{constructor(t,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(n=>{n.next(t)})}error(t){this.forEachObserver(n=>{n.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,n,r){let i;if(void 0===t&&void 0===n&&void 0===r)throw new Error("Missing Observer.");i=function Jhe(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:n,complete:r},void 0===i.next&&(i.next=bR),void 0===i.error&&(i.error=bR),void 0===i.complete&&(i.complete=bR);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,t)}sendOne(t,n){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{n(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bR(){}function Jm(e,t){return`${e} failed: ${t} argument `}const y1=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Fo(e){return e&&e._delegate?e._delegate:e}class ap{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const eg="[DEFAULT]";class sfe{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new dy;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){var n;const r=this.normalizeInstanceIdentifier(t?.identifier),i=null!==(n=t?.optional)&&void 0!==n&&n;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function lfe(e){return"EAGER"===e.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:eg})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(t=eg){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return _e(function*(){const n=Array.from(t.instances.values());yield Promise.all([...n.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...n.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=eg){return this.instances.has(t)}getOptions(t=eg){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,a]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(o)&&a.resolve(i);return i}onInit(t,n){var r;const i=this.normalizeInstanceIdentifier(n),o=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;o.add(t),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&t(a,i),()=>{o.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(e=t,e===eg?void 0:e),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var e;return r||null}normalizeInstanceIdentifier(t=eg){return this.component?this.component.multipleInstances?t:eg:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class cfe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new sfe(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}const wR=[];var qr=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}(qr||{});const bH={debug:qr.DEBUG,verbose:qr.VERBOSE,info:qr.INFO,warn:qr.WARN,error:qr.ERROR,silent:qr.SILENT},ufe=qr.INFO,dfe={[qr.DEBUG]:"log",[qr.VERBOSE]:"log",[qr.INFO]:"info",[qr.WARN]:"warn",[qr.ERROR]:"error"},hfe=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=dfe[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class xR{constructor(t){this.name=t,this._logLevel=ufe,this._logHandler=hfe,this._userLogHandler=null,wR.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in qr))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?bH[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,qr.DEBUG,...t),this._logHandler(this,qr.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,qr.VERBOSE,...t),this._logHandler(this,qr.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,qr.INFO,...t),this._logHandler(this,qr.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,qr.WARN,...t),this._logHandler(this,qr.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,qr.ERROR,...t),this._logHandler(this,qr.ERROR,...t)}}let wH,xH;const EH=new WeakMap,ER=new WeakMap,CH=new WeakMap,CR=new WeakMap,DR=new WeakMap;let TR={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ER.get(e);if("objectStoreNames"===t)return e.objectStoreNames||CH.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lp(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function bfe(e){return"function"==typeof e?function vfe(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function mfe(){return xH||(xH=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(e)?function(...t){return e.apply(SR(this),t),lp(EH.get(this))}:function(...t){return lp(e.apply(SR(this),t))}:function(t,...n){const r=e.call(SR(this),t,...n);return CH.set(r,t.sort?t.sort():[t]),lp(r)}}(e):(e instanceof IDBTransaction&&function _fe(e){if(ER.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{n(),i()},a=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});ER.set(e,t)}(e),((e,t)=>t.some(n=>e instanceof n))(e,function pfe(){return wH||(wH=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(e,TR):e)}function lp(e){if(e instanceof IDBRequest)return function gfe(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{n(lp(e.result)),i()},a=()=>{r(e.error),i()};e.addEventListener("success",o),e.addEventListener("error",a)});return t.then(n=>{n instanceof IDBCursor&&EH.set(n,e)}).catch(()=>{}),DR.set(t,e),t}(e);if(CR.has(e))return CR.get(e);const t=bfe(e);return t!==e&&(CR.set(e,t),DR.set(t,e)),t}const SR=e=>DR.get(e),xfe=["get","getKey","getAll","getAllKeys","count"],Efe=["put","add","delete","clear"],IR=new Map;function DH(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(IR.get(t))return IR.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Efe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!xfe.includes(n))return;const o=function(){var a=_e(function*(c,...p){const _=this.transaction(c,i?"readwrite":"readonly");let x=_.store;return r&&(x=x.index(p.shift())),(yield Promise.all([x[n](...p),i&&_.done]))[0]});return function(p){return a.apply(this,arguments)}}();return IR.set(t,o),o}!function yfe(e){TR=e(TR)}(e=>({...e,get:(t,n,r)=>DH(t,n)||e.get(t,n,r),has:(t,n)=>!!DH(t,n)||e.has(t,n)}));class Cfe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(function Dfe(e){const t=e.getComponent();return"VERSION"===t?.type}(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}return null}).filter(n=>n).join(" ")}}const v1="@firebase/app",kR="0.10.13",Ih=new xR("@firebase/app"),Tfe="@firebase/app-compat",Sfe="@firebase/analytics-compat",Ife="@firebase/analytics",kfe="@firebase/app-check-compat",Afe="@firebase/app-check",Rfe="@firebase/auth",Mfe="@firebase/auth-compat",Pfe="@firebase/database",Ofe="@firebase/data-connect",Nfe="@firebase/database-compat",Lfe="@firebase/functions",Ffe="@firebase/functions-compat",Bfe="@firebase/installations",Vfe="@firebase/installations-compat",zfe="@firebase/messaging",Ufe="@firebase/messaging-compat",jfe="@firebase/performance",Hfe="@firebase/performance-compat",$fe="@firebase/remote-config",qfe="@firebase/remote-config-compat",Gfe="@firebase/storage",Wfe="@firebase/storage-compat",Zfe="@firebase/firestore",Kfe="@firebase/vertexai-preview",Yfe="@firebase/firestore-compat",Xfe="firebase",b1="[DEFAULT]",Jfe={[v1]:"fire-core",[Tfe]:"fire-core-compat",[Ife]:"fire-analytics",[Sfe]:"fire-analytics-compat",[Afe]:"fire-app-check",[kfe]:"fire-app-check-compat",[Rfe]:"fire-auth",[Mfe]:"fire-auth-compat",[Pfe]:"fire-rtdb",[Ofe]:"fire-data-connect",[Nfe]:"fire-rtdb-compat",[Lfe]:"fire-fn",[Ffe]:"fire-fn-compat",[Bfe]:"fire-iid",[Vfe]:"fire-iid-compat",[zfe]:"fire-fcm",[Ufe]:"fire-fcm-compat",[jfe]:"fire-perf",[Hfe]:"fire-perf-compat",[$fe]:"fire-rc",[qfe]:"fire-rc-compat",[Gfe]:"fire-gcs",[Wfe]:"fire-gcs-compat",[Zfe]:"fire-fst",[Yfe]:"fire-fst-compat",[Kfe]:"fire-vertex","fire-js":"fire-js",[Xfe]:"fire-js-all"},tg=new Map,iw=new Map,ow=new Map;function TH(e,t){try{e.container.addComponent(t)}catch(n){Ih.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ng(e){const t=e.name;if(ow.has(t))return Ih.debug(`There were multiple attempts to register component ${t}.`),!1;ow.set(t,e);for(const n of tg.values())TH(n,e);for(const n of iw.values())TH(n,e);return!0}function sw(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function kh(e){return void 0!==e.settings}const Dc=new nw("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class SH{constructor(t,n,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ap("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Dc.create("app-deleted",{appName:this._name})}}const rg="10.14.1";function IH(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:b1,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Dc.create("bad-app-name",{appName:String(i)});if(n||(n=mH()),!n)throw Dc.create("no-options");const o=tg.get(i);if(o){if(_1(n,o.options)&&_1(r,o.config))return o;throw Dc.create("duplicate-app",{appName:i})}const a=new cfe(i);for(const p of ow.values())a.addComponent(p);const c=new SH(n,r,a);return tg.set(i,c),c}function AR(e=b1){const t=tg.get(e);if(!t&&e===b1&&mH())return IH();if(!t)throw Dc.create("no-app",{appName:e});return t}function hu(e,t,n){var r;let i=null!==(r=Jfe[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const c=[`Unable to register library "${i}" with version "${t}":`];return o&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&c.push("and"),a&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ih.warn(c.join(" "))}ng(new ap(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const aw="firebase-heartbeat-store";let MR=null;function kH(){return MR||(MR=function wfe(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(e,t),c=lp(a);return r&&a.addEventListener("upgradeneeded",p=>{r(lp(a.result),p.oldVersion,p.newVersion,lp(a.transaction),p)}),n&&a.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),c.then(p=>{o&&p.addEventListener("close",()=>o()),i&&p.addEventListener("versionchange",_=>i(_.oldVersion,_.newVersion,_))}).catch(()=>{}),c}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(aw)}catch(n){console.warn(n)}}}).catch(e=>{throw Dc.create("idb-open",{originalErrorMessage:e.message})})),MR}function PR(){return(PR=_e(function*(e){try{const n=(yield kH()).transaction(aw),r=yield n.objectStore(aw).get(RH(e));return yield n.done,r}catch(t){if(t instanceof Sh)Ih.warn(t.message);else{const n=Dc.create("idb-get",{originalErrorMessage:t?.message});Ih.warn(n.message)}}})).apply(this,arguments)}function AH(e,t){return OR.apply(this,arguments)}function OR(){return(OR=_e(function*(e,t){try{const r=(yield kH()).transaction(aw,"readwrite");yield r.objectStore(aw).put(t,RH(e)),yield r.done}catch(n){if(n instanceof Sh)Ih.warn(n.message);else{const r=Dc.create("idb-set",{originalErrorMessage:n?.message});Ih.warn(r.message)}}})).apply(this,arguments)}function RH(e){return`${e.name}!${e.options.appId}`}class cpe{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new dpe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return _e(function*(){var n,r;try{const o=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=MH();return null==(null===(n=t._heartbeatsCache)||void 0===n?void 0:n.heartbeats)&&(t._heartbeatsCache=yield t._heartbeatsCachePromise,null==(null===(r=t._heartbeatsCache)||void 0===r?void 0:r.heartbeats))||t._heartbeatsCache.lastSentHeartbeatDate===a||t._heartbeatsCache.heartbeats.some(c=>c.date===a)?void 0:(t._heartbeatsCache.heartbeats.push({date:a,agent:o}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(c=>{const p=new Date(c.date).valueOf();return Date.now()-p<=2592e6}),t._storage.overwrite(t._heartbeatsCache))}catch(i){Ih.warn(i)}})()}getHeartbeatsHeader(){var t=this;return _e(function*(){var n;try{if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null==(null===(n=t._heartbeatsCache)||void 0===n?void 0:n.heartbeats)||0===t._heartbeatsCache.heartbeats.length)return"";const r=MH(),{heartbeatsToSend:i,unsentEntries:o}=function upe(e,t=1024){const n=[];let r=e.slice();for(const i of e){const o=n.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),PH(n)>t){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),PH(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(t._heartbeatsCache.heartbeats),a=h1(JSON.stringify({version:2,heartbeats:i}));return t._heartbeatsCache.lastSentHeartbeatDate=r,o.length>0?(t._heartbeatsCache.heartbeats=o,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),a}catch(r){return Ih.warn(r),""}})()}}function MH(){return(new Date).toISOString().substring(0,10)}class dpe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return _e(function*(){return!!function Hhe(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function $he(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;t((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(n){t(n)}})}().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return _e(function*(){if(yield t._canUseIndexedDBPromise){const r=yield function spe(e){return PR.apply(this,arguments)}(t.app);return r?.heartbeats?r:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(t){var n=this;return _e(function*(){var r;if(yield n._canUseIndexedDBPromise){const o=yield n.read();return AH(n.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var n=this;return _e(function*(){var r;if(yield n._canUseIndexedDBPromise){const o=yield n.read();return AH(n.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...t.heartbeats]})}})()}}function PH(e){return h1(JSON.stringify({version:2,heartbeats:e})).length}function w1(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}!function hpe(e){ng(new ap("platform-logger",t=>new Cfe(t),"PRIVATE")),ng(new ap("heartbeat",t=>new cpe(t),"PRIVATE")),hu(v1,kR,e),hu(v1,kR,"esm2017"),hu("fire-js","")}(""),hu("firebase","10.14.1","app"),"function"==typeof SuppressedError&&SuppressedError;const Hpe=function NH(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},LH=new nw("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),x1=new xR("@firebase/auth");function E1(e,...t){x1.logLevel<=qr.ERROR&&x1.error(`Auth (${rg}): ${e}`,...t)}function Za(e,...t){throw UR(e,...t)}function da(e,...t){return UR(e,...t)}function zR(e,t,n){const r=Object.assign(Object.assign({},Hpe()),{[t]:n});return new nw("auth","Firebase",r).create(t,{appName:e.name})}function hs(e){return zR(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function UR(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return LH.create(e,...t)}function ct(e,t,...n){if(!e)throw UR(t,...n)}function fd(e){const t="INTERNAL ASSERTION FAILED: "+e;throw E1(t),new Error(t)}function Ah(e,t){e||fd(t)}function cw(){var e;return typeof self<"u"&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function FH(){var e;return typeof self<"u"&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function qpe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function jR(){return"http:"===FH()||"https:"===FH()}()||function Uhe(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class uw{constructor(t,n){this.shortDelay=t,this.longDelay=n,Ah(n>t,"Short delay should be less than long delay!"),this.isMobile=yR()||yH()}get(){return qpe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function HR(e,t){Ah(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class BH{static initialize(t,n,r){this.fetchImpl=t,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void fd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void fd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void fd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Wpe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Zpe=new uw(3e4,6e4);function pi(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function mi(e,t,n,r){return $R.apply(this,arguments)}function $R(){return($R=_e(function*(e,t,n,r,i={}){return VH(e,i,_e(function*(){let o={},a={};r&&("GET"===t?a=r:o={body:JSON.stringify(r)});const c=fy(Object.assign({key:e.config.apiKey},a)).slice(1),p=yield e._getAdditionalHeaders();p["Content-Type"]="application/json",e.languageCode&&(p["X-Firebase-Locale"]=e.languageCode);const _=Object.assign({method:t,headers:p},o);return function zhe(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}()||(_.referrerPolicy="no-referrer"),BH.fetch()(zH(e,e.config.apiHost,n,c),_)}))})).apply(this,arguments)}function VH(e,t,n){return qR.apply(this,arguments)}function qR(){return(qR=_e(function*(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Wpe),t);try{const i=new Ype(e),o=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();const a=yield o.json();if("needConfirmation"in a)throw dw(e,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[p,_]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===p)throw dw(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===p)throw dw(e,"email-already-in-use",a);if("USER_DISABLED"===p)throw dw(e,"user-disabled",a);const x=r[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw zR(e,x,_);Za(e,x)}}catch(i){if(i instanceof Sh)throw i;Za(e,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function Rh(e,t,n,r){return GR.apply(this,arguments)}function GR(){return(GR=_e(function*(e,t,n,r,i={}){const o=yield mi(e,t,n,r,i);return"mfaPendingCredential"in o&&Za(e,"multi-factor-auth-required",{_serverResponse:o}),o})).apply(this,arguments)}function zH(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?HR(e.config,i):`${e.config.apiScheme}://${i}`}class Ype{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(da(this.auth,"network-request-failed")),Zpe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function dw(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=da(e,t,r);return i.customData._tokenResponse=n,i}function KR(){return(KR=_e(function*(e,t){return mi(e,"POST","/v1/accounts:delete",t)})).apply(this,arguments)}function qH(e,t){return XR.apply(this,arguments)}function XR(){return(XR=_e(function*(e,t){return mi(e,"POST","/v1/accounts:lookup",t)})).apply(this,arguments)}function hw(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function QR(){return(QR=_e(function*(e,t=!1){const n=Fo(e),r=yield n.getIdToken(t),i=C1(r);ct(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:hw(JR(i.auth_time)),issuedAtTime:hw(JR(i.iat)),expirationTime:hw(JR(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})).apply(this,arguments)}function JR(e){return 1e3*Number(e)}function C1(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return E1("JWT malformed, contained fewer than 3 sections"),null;try{const i=f1(n);return i?JSON.parse(i):(E1("Failed to decode base64 JWT payload"),null)}catch(i){return E1("Caught error parsing JWT payload as JSON",i?.toString()),null}}function GH(e){const t=C1(e);return ct(t,"internal-error"),ct(typeof t.exp<"u","internal-error"),ct(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}function Mh(e,t){return eM.apply(this,arguments)}function eM(){return(eM=_e(function*(e,t,n=!1){if(n)return t;try{return yield t}catch(r){throw r instanceof Sh&&function tme({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)&&e.auth.currentUser===e&&(yield e.auth.signOut()),r}})).apply(this,arguments)}class nme{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var n;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const i=(null!==(n=this.user.stsTokenManager.expirationTime)&&void 0!==n?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){var n=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(_e(function*(){yield n.iteration()}),r)}iteration(){var t=this;return _e(function*(){try{yield t.user.getIdToken(!0)}catch(n){return void("auth/network-request-failed"===n?.code&&t.schedule(!0))}t.schedule()})()}}class tM{constructor(t,n){this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=hw(this.lastLoginAt),this.creationTime=hw(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function fw(e){return nM.apply(this,arguments)}function nM(){return(nM=_e(function*(e){var t;const n=e.auth,r=yield e.getIdToken(),i=yield Mh(e,qH(n,{idToken:r}));ct(i?.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const a=null!==(t=o.providerUserInfo)&&void 0!==t&&t.length?WH(o.providerUserInfo):[],c=function ime(e,t){return[...e.filter(r=>!t.some(i=>i.providerId===r.providerId)),...t]}(e.providerData,a),x=!!e.isAnonymous&&!(e.email&&o.passwordHash||c?.length),D={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new tM(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(e,D)})).apply(this,arguments)}function rM(){return(rM=_e(function*(e){const t=Fo(e);yield fw(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)})).apply(this,arguments)}function WH(e){return e.map(t=>{var{providerId:n}=t,r=w1(t,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function iM(){return(iM=_e(function*(e,t){const n=yield VH(e,{},_e(function*(){const r=fy({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:o}=e.config,a=zH(e,i,"/v1/token",`key=${o}`),c=yield e._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",BH.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})).apply(this,arguments)}function oM(){return(oM=_e(function*(e,t){return mi(e,"POST","/v2/accounts:revokeToken",pi(e,t))})).apply(this,arguments)}class my{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){ct(t.idToken,"internal-error"),ct(typeof t.idToken<"u","internal-error"),ct(typeof t.refreshToken<"u","internal-error");const n="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):GH(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,n)}updateFromIdToken(t){ct(0!==t.length,"internal-error");const n=GH(t);this.updateTokensAndExpiration(t,null,n)}getToken(t){var n=this;return _e(function*(r,i=!1){return i||!n.accessToken||n.isExpired?(ct(n.refreshToken,r,"user-token-expired"),n.refreshToken?(yield n.refresh(r,n.refreshToken),n.accessToken):null):n.accessToken}).apply(this,arguments)}clearRefreshToken(){this.refreshToken=null}refresh(t,n){var r=this;return _e(function*(){const{accessToken:i,refreshToken:o,expiresIn:a}=yield function ome(e,t){return iM.apply(this,arguments)}(t,n);r.updateTokensAndExpiration(i,o,Number(a))})()}updateTokensAndExpiration(t,n,r){this.refreshToken=n||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,a=new my;return r&&(ct("string"==typeof r,"internal-error",{appName:t}),a.refreshToken=r),i&&(ct("string"==typeof i,"internal-error",{appName:t}),a.accessToken=i),o&&(ct("number"==typeof o,"internal-error",{appName:t}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new my,this.toJSON())}_performRefresh(){return fd("not implemented")}}function cp(e,t){ct("string"==typeof e||typeof e>"u","internal-error",{appName:t})}class Ph{constructor(t){var{uid:n,auth:r,stsTokenManager:i}=t,o=w1(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nme(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new tM(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(t){var n=this;return _e(function*(){const r=yield Mh(n,n.stsTokenManager.getToken(n.auth,t));return ct(r,n.auth,"internal-error"),n.accessToken!==r&&(n.accessToken=r,yield n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)),r})()}getIdTokenResult(t){return function eme(e){return QR.apply(this,arguments)}(this,t)}reload(){return function rme(e){return rM.apply(this,arguments)}(this)}_assign(t){this!==t&&(ct(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(n=>Object.assign({},n)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const n=new Ph(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(t){ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t){var n=this;return _e(function*(r,i=!1){let o=!1;r.idToken&&r.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(r),o=!0),i&&(yield fw(n)),yield n.auth._persistUserIfCurrent(n),o&&n.auth._notifyListenersIfCurrent(n)}).apply(this,arguments)}delete(){var t=this;return _e(function*(){if(kh(t.auth.app))return Promise.reject(hs(t.auth));const n=yield t.getIdToken();return yield Mh(t,function Qpe(e,t){return KR.apply(this,arguments)}(t.auth,{idToken:n})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,n){var r,i,o,a,c,p,_,x;const D=null!==(r=n.displayName)&&void 0!==r?r:void 0,A=null!==(i=n.email)&&void 0!==i?i:void 0,O=null!==(o=n.phoneNumber)&&void 0!==o?o:void 0,B=null!==(a=n.photoURL)&&void 0!==a?a:void 0,Q=null!==(c=n.tenantId)&&void 0!==c?c:void 0,oe=null!==(p=n._redirectEventId)&&void 0!==p?p:void 0,ye=null!==(_=n.createdAt)&&void 0!==_?_:void 0,xe=null!==(x=n.lastLoginAt)&&void 0!==x?x:void 0,{uid:$e,emailVerified:De,isAnonymous:ve,providerData:Fe,stsTokenManager:We}=n;ct($e&&We,t,"internal-error");const dt=my.fromJSON(this.name,We);ct("string"==typeof $e,t,"internal-error"),cp(D,t.name),cp(A,t.name),ct("boolean"==typeof De,t,"internal-error"),ct("boolean"==typeof ve,t,"internal-error"),cp(O,t.name),cp(B,t.name),cp(Q,t.name),cp(oe,t.name),cp(ye,t.name),cp(xe,t.name);const Qt=new Ph({uid:$e,auth:t,email:A,emailVerified:De,displayName:D,isAnonymous:ve,photoURL:B,phoneNumber:O,tenantId:Q,stsTokenManager:dt,createdAt:ye,lastLoginAt:xe});return Fe&&Array.isArray(Fe)&&(Qt.providerData=Fe.map(nn=>Object.assign({},nn))),oe&&(Qt._redirectEventId=oe),Qt}static _fromIdTokenResponse(t,n){return _e(function*(r,i,o=!1){const a=new my;a.updateFromServerResponse(i);const c=new Ph({uid:i.localId,auth:r,stsTokenManager:a,isAnonymous:o});return yield fw(c),c}).apply(this,arguments)}static _fromGetAccountInfoResponse(t,n,r){return _e(function*(){const i=n.users[0];ct(void 0!==i.localId,"internal-error");const o=void 0!==i.providerUserInfo?WH(i.providerUserInfo):[],a=!(i.email&&i.passwordHash||o?.length),c=new my;c.updateFromIdToken(r);const p=new Ph({uid:i.localId,auth:t,stsTokenManager:c,isAnonymous:a}),_={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new tM(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||o?.length)};return Object.assign(p,_),p})()}}const ZH=new Map;function Oh(e){Ah(e instanceof Function,"Expected a class definition");let t=ZH.get(e);return t?(Ah(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ZH.set(e,t),t)}const KH=(()=>{class e{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return _e(function*(){return!0})()}_set(n,r){var i=this;return _e(function*(){i.storage[n]=r})()}_get(n){var r=this;return _e(function*(){const i=r.storage[n];return void 0===i?null:i})()}_remove(n){var r=this;return _e(function*(){delete r.storage[n]})()}_addListener(n,r){}_removeListener(n,r){}}return e.type="NONE",e})();function D1(e,t,n){return`firebase:${e}:${t}:${n}`}class gy{constructor(t,n,r){this.persistence=t,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=D1(this.userKey,i.apiKey,o),this.fullPersistenceKey=D1("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return _e(function*(){const n=yield t.persistence._get(t.fullUserKey);return n?Ph._fromJSON(t.auth,n):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var n=this;return _e(function*(){if(n.persistence===t)return;const r=yield n.getCurrentUser();return yield n.removeCurrentUser(),n.persistence=t,r?n.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,n){return _e(function*(r,i,o="authUser"){if(!i.length)return new gy(Oh(KH),r,o);const a=(yield Promise.all(i.map(function(){var D=_e(function*(A){if(yield A._isAvailable())return A});return function(A){return D.apply(this,arguments)}}()))).filter(D=>D);let c=a[0]||Oh(KH);const p=D1(o,r.config.apiKey,r.name);let _=null;for(const D of i)try{const A=yield D._get(p);if(A){const O=Ph._fromJSON(r,A);D!==c&&(_=O),c=D;break}}catch{}const x=a.filter(D=>D._shouldAllowMigration);return c._shouldAllowMigration&&x.length?(c=x[0],_&&(yield c._set(p,_.toJSON())),yield Promise.all(i.map(function(){var D=_e(function*(A){if(A!==c)try{yield A._remove(p)}catch{}});return function(A){return D.apply(this,arguments)}}())),new gy(c,r,o)):new gy(c,r,o)}).apply(this,arguments)}}function YH(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(e6(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(XH(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(n6(t))return"Blackberry";if(r6(t))return"Webos";if(QH(t))return"Safari";if((t.includes("chrome/")||JH(t))&&!t.includes("edge/"))return"Chrome";if(t6(t))return"Android";{const r=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function XH(e=Ps()){return/firefox\//i.test(e)}function QH(e=Ps()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function JH(e=Ps()){return/crios\//i.test(e)}function e6(e=Ps()){return/iemobile/i.test(e)}function t6(e=Ps()){return/android/i.test(e)}function n6(e=Ps()){return/blackberry/i.test(e)}function r6(e=Ps()){return/webos/i.test(e)}function sM(e=Ps()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function i6(e=Ps()){return sM(e)||t6(e)||r6(e)||n6(e)||/windows phone/i.test(e)||e6(e)}function o6(e,t=[]){let n;switch(e){case"Browser":n=YH(Ps());break;case"Worker":n=`${YH(Ps())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${rg}/${r}`}class cme{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,n){const r=o=>new Promise((a,c)=>{try{a(t(o))}catch(p){c(p)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(t){var n=this;return _e(function*(){if(n.auth.currentUser===t)return;const r=[];try{for(const i of n.queue)yield i(t),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const o of r)try{o()}catch{}throw n.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function aM(){return(aM=_e(function*(e,t={}){return mi(e,"GET","/v2/passwordPolicy",pi(e,t))})).apply(this,arguments)}class hme{constructor(t){var n,r,i,o;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(n=a.minPasswordLength)&&void 0!==n?n:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(r=t.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(o=t.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=t.schemaVersion}validatePassword(t){var n,r,i,o,a,c;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,p),this.validatePasswordCharacterOptions(t,p),p.isValid&&(p.isValid=null===(n=p.meetsMinPasswordLength)||void 0===n||n),p.isValid&&(p.isValid=null===(r=p.meetsMaxPasswordLength)||void 0===r||r),p.isValid&&(p.isValid=null===(i=p.containsLowercaseLetter)||void 0===i||i),p.isValid&&(p.isValid=null===(o=p.containsUppercaseLetter)||void 0===o||o),p.isValid&&(p.isValid=null===(a=p.containsNumericCharacter)||void 0===a||a),p.isValid&&(p.isValid=null===(c=p.containsNonAlphanumericCharacter)||void 0===c||c),p}validatePasswordLengthOptions(t,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=t.length>=r),i&&(n.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,n){let r;this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);for(let i=0;i<t.length;i++)r=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}class fme{constructor(t,n,r,i){this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new s6(this),this.idTokenSubscription=new s6(this),this.beforeStateQueue=new cme(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LH,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,n){var r=this;return n&&(this._popupRedirectResolver=Oh(n)),this._initializationPromise=this.queue(_e(function*(){var i,o;if(!r._deleted&&(r.persistenceManager=yield gy.create(r,t),!r._deleted)){if(null!==(i=r._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(n),r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return _e(function*(){if(t._deleted)return;const n=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||n){if(t.currentUser&&n&&t.currentUser.uid===n.uid)return t._currentUser._assign(n),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(n,!0)}})()}initializeCurrentUserFromIdToken(t){var n=this;return _e(function*(){try{const r=yield qH(n,{idToken:t}),i=yield Ph._fromGetAccountInfoResponse(n,r,t);yield n.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield n.directlySetCurrentUser(null)}})()}initializeCurrentUser(t){var n=this;return _e(function*(){var r;if(kh(n.app)){const c=n.app.settings.authIdToken;return c?new Promise(p=>{setTimeout(()=>n.initializeCurrentUserFromIdToken(c).then(p,p))}):n.directlySetCurrentUser(null)}const i=yield n.assertedPersistence.getCurrentUser();let o=i,a=!1;if(t&&n.config.authDomain){yield n.getOrInitRedirectPersistenceManager();const c=null===(r=n.redirectUser)||void 0===r?void 0:r._redirectEventId,p=o?._redirectEventId,_=yield n.tryRedirectSignIn(t);(!c||c===p)&&_?.user&&(o=_.user,a=!0)}if(!o)return n.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{yield n.beforeStateQueue.runMiddleware(o)}catch(c){o=i,n._popupRedirectResolver._overrideRedirectResult(n,()=>Promise.reject(c))}return o?n.reloadAndSetCurrentUserOrClear(o):n.directlySetCurrentUser(null)}return ct(n._popupRedirectResolver,n,"argument-error"),yield n.getOrInitRedirectPersistenceManager(),n.redirectUser&&n.redirectUser._redirectEventId===o._redirectEventId?n.directlySetCurrentUser(o):n.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(t){var n=this;return _e(function*(){let r=null;try{r=yield n._popupRedirectResolver._completeRedirectFn(n,t,!0)}catch{yield n._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var n=this;return _e(function*(){try{yield fw(t)}catch(r){if("auth/network-request-failed"!==r?.code)return n.directlySetCurrentUser(null)}return n.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function Gpe(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}_delete(){var t=this;return _e(function*(){t._deleted=!0})()}updateCurrentUser(t){var n=this;return _e(function*(){if(kh(n.app))return Promise.reject(hs(n));const r=t?Fo(t):null;return r&&ct(r.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),n._updateCurrentUser(r&&r._clone(n))})()}_updateCurrentUser(t){var n=this;return _e(function*(r,i=!1){if(!n._deleted)return r&&ct(n.tenantId===r.tenantId,n,"tenant-id-mismatch"),i||(yield n.beforeStateQueue.runMiddleware(r)),n.queue(_e(function*(){yield n.directlySetCurrentUser(r),n.notifyAuthListeners()}))}).apply(this,arguments)}signOut(){var t=this;return _e(function*(){return kh(t.app)?Promise.reject(hs(t)):(yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0))})()}setPersistence(t){var n=this;return kh(this.app)?Promise.reject(hs(this)):this.queue(_e(function*(){yield n.assertedPersistence.setPersistence(Oh(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(t){var n=this;return _e(function*(){n._getPasswordPolicyInternal()||(yield n._updatePasswordPolicy());const r=n._getPasswordPolicyInternal();return r.schemaVersion!==n.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(n._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var t=this;return _e(function*(){const n=yield function ume(e){return aM.apply(this,arguments)}(t),r=new hme(n);null===t.tenantId?t._projectPasswordPolicy=r:t._tenantPasswordPolicies[t.tenantId]=r})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new nw("auth","Firebase",t())}onAuthStateChanged(t,n,r){return this.registerStateListener(this.authStateSubscription,t,n,r)}beforeAuthStateChanged(t,n){return this.beforeStateQueue.pushCallback(t,n)}onIdTokenChanged(t,n,r){return this.registerStateListener(this.idTokenSubscription,t,n,r)}authStateReady(){return new Promise((t,n)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},n)}})}revokeAccessToken(t){var n=this;return _e(function*(){if(n.currentUser){const r=yield n.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};null!=n.tenantId&&(i.tenantId=n.tenantId),yield function sme(e,t){return oM.apply(this,arguments)}(n,i)}})()}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,n){var r=this;return _e(function*(){const i=yield r.getOrInitRedirectPersistenceManager(n);return null===t?i.removeCurrentUser():i.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var n=this;return _e(function*(){if(!n.redirectPersistenceManager){const r=t&&Oh(t)||n._popupRedirectResolver;ct(r,n,"argument-error"),n.redirectPersistenceManager=yield gy.create(n,[Oh(r._redirectPersistence)],"redirectUser"),n.redirectUser=yield n.redirectPersistenceManager.getCurrentUser()}return n.redirectPersistenceManager})()}_redirectUserForId(t){var n=this;return _e(function*(){var r,i;return n._isInitialized&&(yield n.queue(_e(function*(){}))),(null===(r=n._currentUser)||void 0===r?void 0:r._redirectEventId)===t?n._currentUser:(null===(i=n.redirectUser)||void 0===i?void 0:i._redirectEventId)===t?n.redirectUser:null})()}_persistUserIfCurrent(t){var n=this;return _e(function*(){if(t===n.currentUser)return n.queue(_e(function*(){return n.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(n=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==n?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,n,r,i){if(this._deleted)return()=>{};const o="function"==typeof n?n:n.next.bind(n);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ct(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),"function"==typeof n){const p=t.addObserver(n,r,i);return()=>{a=!0,p()}}{const p=t.addObserver(n);return()=>{a=!0,p()}}}directlySetCurrentUser(t){var n=this;return _e(function*(){n.currentUser&&n.currentUser!==t&&n._currentUser._stopProactiveRefresh(),t&&n.isProactiveRefreshEnabled&&t._startProactiveRefresh(),n.currentUser=t,t?yield n.assertedPersistence.setCurrentUser(t):yield n.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=o6(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return _e(function*(){var n;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const i=yield null===(n=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();i&&(r["X-Firebase-Client"]=i);const o=yield t._getAppCheckToken();return o&&(r["X-Firebase-AppCheck"]=o),r})()}_getAppCheckToken(){var t=this;return _e(function*(){var n;const r=yield null===(n=t.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getToken();return r?.error&&function $pe(e,...t){x1.logLevel<=qr.WARN&&x1.warn(`Auth (${rg}): ${e}`,...t)}(`Error while retrieving App Check token: ${r.error}`),r?.token})()}}function vo(e){return Fo(e)}class s6{constructor(t){this.auth=t,this.observer=null,this.addObserver=function Xhe(e,t){const n=new Qhe(e,t);return n.subscribe.bind(n)}(n=>this.observer=n)}get next(){return ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let pw={loadJS:()=>_e(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function a6(e){return`__${e}${Math.floor(1e6*Math.random())}`}function u6(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function d6(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class gw{constructor(t,n){this.providerId=t,this.signInMethod=n}toJSON(){return fd("not implemented")}_getIdTokenResponse(t){return fd("not implemented")}_linkToIdToken(t,n){return fd("not implemented")}_getReauthenticationResolver(t){return fd("not implemented")}}function Nh(e,t){return DM.apply(this,arguments)}function DM(){return(DM=_e(function*(e,t){return Rh(e,"POST","/v1/accounts:signInWithIdp",pi(e,t))})).apply(this,arguments)}class _y extends gw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const n=new _y(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):Za("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const n="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:i}=n,o=w1(n,["providerId","signInMethod"]);if(!r||!i)return null;const a=new _y(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(t){return Nh(t,this.buildRequest())}_linkToIdToken(t,n){const r=this.buildRequest();return r.idToken=n,Nh(t,r)}_getReauthenticationResolver(t){const n=this.buildRequest();return n.autoCreate=!1,Nh(t,n)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=fy(n)}return t}}class Lh{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class p6 extends Lh{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let m6=(()=>{class e extends p6{constructor(){super("google.com"),this.addScope("profile")}static credential(n,r){return _y._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:n,accessToken:r})}static credentialFromResult(n){return e.credentialFromTaggedObject(n)}static credentialFromError(n){return e.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthIdToken:r,oauthAccessToken:i}=n;if(!r&&!i)return null;try{return e.credential(r,i)}catch{return null}}}return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e})();class Tc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,n,r){return _e(function*(i,o,a,c=!1){const p=yield Ph._fromIdTokenResponse(i,a,c),_=_6(a);return new Tc({user:p,providerId:_,_tokenResponse:a,operationType:o})}).apply(this,arguments)}static _forOperation(t,n,r){return _e(function*(){yield t._updateTokensIfNecessary(r,!0);const i=_6(r);return new Tc({user:t,providerId:i,_tokenResponse:r,operationType:n})})()}}function _6(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class k1 extends Sh{constructor(t,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,k1.prototype),this.customData={appName:t.name,tenantId:null!==(o=t.tenantId)&&void 0!==o?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,n,r,i){return new k1(t,n,r,i)}}function y6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?k1._fromErrorAndOperation(e,o,t,r):o})}function OM(e,t){return NM.apply(this,arguments)}function NM(){return(NM=_e(function*(e,t,n=!1){const r=yield Mh(e,t._linkToIdToken(e.auth,yield e.getIdToken()),n);return Tc._forOperation(e,"link",r)})).apply(this,arguments)}function b6(e,t){return FM.apply(this,arguments)}function FM(){return(FM=_e(function*(e,t,n=!1){const{auth:r}=e;if(kh(r.app))return Promise.reject(hs(r));const i="reauthenticate";try{const o=yield Mh(e,y6(r,i,t,e),n);ct(o.idToken,r,"internal-error");const a=C1(o.idToken);ct(a,r,"internal-error");const{sub:c}=a;return ct(e.uid===c,r,"user-mismatch"),Tc._forOperation(e,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&Za(r,"user-mismatch"),o}})).apply(this,arguments)}function w6(e,t){return BM.apply(this,arguments)}function BM(){return(BM=_e(function*(e,t,n=!1){if(kh(e.app))return Promise.reject(hs(e));const r="signIn",i=yield y6(e,r,t),o=yield Tc._fromIdTokenResponse(e,r,i);return n||(yield e._updateCurrentUser(o.user)),o})).apply(this,arguments)}function M1(e,t,n,r){return Fo(e).onAuthStateChanged(t,n,r)}const P1="__sak";class C6{constructor(t,n){this.storageRetriever=t,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(P1,"1"),this.storage.removeItem(P1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,n){return this.storage.setItem(t,JSON.stringify(n)),Promise.resolve()}_get(t){const n=this.storage.getItem(t);return Promise.resolve(n?JSON.parse(n):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const hge=(()=>{class e extends C6{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=i6(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),o=this.localCache[r];i!==o&&n(r,o,i)}}onStorageEvent(n,r=!1){if(!n.key)return void this.forAllChangedKeys((c,p,_)=>{this.notifyListeners(c,_)});const i=n.key;r?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);!function lme(){return function jhe(){const e=Ps();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}()||a===n.newValue||n.newValue===n.oldValue?o():setTimeout(o,10)}notifyListeners(n,r){this.localCache[n]=r;const i=this.listeners[n];if(i)for(const o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),0===this.listeners[n].size&&delete this.listeners[n]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(n,r){var i=()=>super._set,o=this;return _e(function*(){yield i().call(o,n,r),o.localCache[n]=JSON.stringify(r)})()}_get(n){var r=()=>super._get,i=this;return _e(function*(){const o=yield r().call(i,n);return i.localCache[n]=JSON.stringify(o),o})()}_remove(n){var r=()=>super._remove,i=this;return _e(function*(){yield r().call(i,n),delete i.localCache[n]})()}}return e.type="LOCAL",e})(),D6=(()=>{class e extends C6{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return e.type="SESSION",e})();let pge=(()=>{class e{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){const r=this.receivers.find(o=>o.isListeningto(n));if(r)return r;const i=new e(n);return this.receivers.push(i),i}isListeningto(n){return this.eventTarget===n}handleEvent(n){var r=this;return _e(function*(){const i=n,{eventId:o,eventType:a,data:c}=i.data,p=r.handlersMap[a];if(!p?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:a});const _=Array.from(p).map(function(){var D=_e(function*(A){return A(i.origin,c)});return function(A){return D.apply(this,arguments)}}()),x=yield function fge(e){return Promise.all(e.map(function(){var t=_e(function*(n){try{return{fulfilled:!0,value:yield n}}catch(r){return{fulfilled:!1,reason:r}}});return function(n){return t.apply(this,arguments)}}()))}(_);i.ports[0].postMessage({status:"done",eventId:o,eventType:a,response:x})})()}_subscribe(n,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||0===this.handlersMap[n].size)&&delete this.handlersMap[n],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return e.receivers=[],e})();function O1(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}class mge{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,n){var r=this;return _e(function*(i,o,a=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let p,_;return new Promise((x,D)=>{const A=O1("",20);c.port1.start();const O=setTimeout(()=>{D(new Error("unsupported_event"))},a);_={messageChannel:c,onMessage(B){const Q=B;if(Q.data.eventId===A)switch(Q.data.status){case"ack":clearTimeout(O),p=setTimeout(()=>{D(new Error("timeout"))},3e3);break;case"done":clearTimeout(p),x(Q.data.response);break;default:clearTimeout(O),clearTimeout(p),D(new Error("invalid_response"))}}},r.handlers.add(_),c.port1.addEventListener("message",_.onMessage),r.target.postMessage({eventType:i,eventId:A,data:o},[c.port2])}).finally(()=>{_&&r.removeMessageHandler(_)})}).apply(this,arguments)}}function Bo(){return window}function mP(){return typeof Bo().WorkerGlobalScope<"u"&&"function"==typeof Bo().importScripts}function gP(){return(gP=_e(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const T6="firebaseLocalStorageDb",N1="firebaseLocalStorage",S6="fbase_key";class bw{constructor(t){this.request=t}toPromise(){return new Promise((t,n)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function L1(e,t){return e.transaction([N1],t?"readwrite":"readonly").objectStore(N1)}function _P(){const e=indexedDB.open(T6,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const r=e.result;try{r.createObjectStore(N1,{keyPath:S6})}catch(i){n(i)}}),e.addEventListener("success",_e(function*(){const r=e.result;r.objectStoreNames.contains(N1)?t(r):(r.close(),yield function wge(){const e=indexedDB.deleteDatabase(T6);return new bw(e).toPromise()}(),t(yield _P()))}))})}function I6(e,t,n){return yP.apply(this,arguments)}function yP(){return(yP=_e(function*(e,t,n){const r=L1(e,!0).put({[S6]:t,value:n});return new bw(r).toPromise()})).apply(this,arguments)}function vP(){return(vP=_e(function*(e,t){const n=L1(e,!1).get(t),r=yield new bw(n).toPromise();return void 0===r?null:r.value})).apply(this,arguments)}function k6(e,t){const n=L1(e,!0).delete(t);return new bw(n).toPromise()}const Dge=(()=>{class e{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var n=this;return _e(function*(){return n.db||(n.db=yield _P()),n.db})()}_withRetries(n){var r=this;return _e(function*(){let i=0;for(;;)try{const o=yield r._openDb();return yield n(o)}catch(o){if(i++>3)throw o;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var n=this;return _e(function*(){return mP()?n.initializeReceiver():n.initializeSender()})()}initializeReceiver(){var n=this;return _e(function*(){n.receiver=pge._getInstance(function vge(){return mP()?self:null}()),n.receiver._subscribe("keyChanged",function(){var r=_e(function*(i,o){return{keyProcessed:(yield n._poll()).includes(o.key)}});return function(i,o){return r.apply(this,arguments)}}()),n.receiver._subscribe("ping",function(){var r=_e(function*(i,o){return["keyChanged"]});return function(i,o){return r.apply(this,arguments)}}())})()}initializeSender(){var n=this;return _e(function*(){var r,i;if(n.activeServiceWorker=yield function _ge(){return gP.apply(this,arguments)}(),!n.activeServiceWorker)return;n.sender=new mge(n.activeServiceWorker);const o=yield n.sender._send("ping",{},800);o&&null!==(r=o[0])&&void 0!==r&&r.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(n.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(n){var r=this;return _e(function*(){if(r.sender&&r.activeServiceWorker&&function yge(){var e;return(null===(e=navigator?.serviceWorker)||void 0===e?void 0:e.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:n},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return _e(function*(){try{if(!indexedDB)return!1;const n=yield _P();return yield I6(n,P1,"1"),yield k6(n,P1),!0}catch{}return!1})()}_withPendingWrite(n){var r=this;return _e(function*(){r.pendingWrites++;try{yield n()}finally{r.pendingWrites--}})()}_set(n,r){var i=this;return _e(function*(){return i._withPendingWrite(_e(function*(){return yield i._withRetries(o=>I6(o,n,r)),i.localCache[n]=r,i.notifyServiceWorker(n)}))})()}_get(n){var r=this;return _e(function*(){const i=yield r._withRetries(o=>function xge(e,t){return vP.apply(this,arguments)}(o,n));return r.localCache[n]=i,i})()}_remove(n){var r=this;return _e(function*(){return r._withPendingWrite(_e(function*(){return yield r._withRetries(i=>k6(i,n)),delete r.localCache[n],r.notifyServiceWorker(n)}))})()}_poll(){var n=this;return _e(function*(){const r=yield n._withRetries(a=>{const c=L1(a,!1).getAll();return new bw(c).toPromise()});if(!r)return[];if(0!==n.pendingWrites)return[];const i=[],o=new Set;if(0!==r.length)for(const{fbase_key:a,value:c}of r)o.add(a),JSON.stringify(n.localCache[a])!==JSON.stringify(c)&&(n.notifyListeners(a,c),i.push(a));for(const a of Object.keys(n.localCache))n.localCache[a]&&!o.has(a)&&(n.notifyListeners(a,null),i.push(a));return i})()}notifyListeners(n,r){this.localCache[n]=r;const i=this.listeners[n];if(i)for(const o of Array.from(i))o(r)}startPolling(){var n=this;this.stopPolling(),this.pollTimer=setInterval(_e(function*(){return n._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),0===this.listeners[n].size&&delete this.listeners[n]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return e.type="LOCAL",e})();function og(e,t){return t?Oh(t):(ct(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}a6("rcb"),new uw(3e4,6e4);class IP extends gw{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Nh(t,this._buildIdpRequest())}_linkToIdToken(t,n){return Nh(t,this._buildIdpRequest(n))}_getReauthenticationResolver(t){return Nh(t,this._buildIdpRequest())}_buildIdpRequest(t){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(n.idToken=t),n}}function zge(e){return w6(e.auth,new IP(e),e.bypassAuthState)}function Uge(e){const{auth:t,user:n}=e;return ct(n,t,"internal-error"),b6(n,new IP(e),e.bypassAuthState)}function jge(e){return kP.apply(this,arguments)}function kP(){return(kP=_e(function*(e){const{auth:t,user:n}=e;return ct(n,t,"internal-error"),OM(n,new IP(e),e.bypassAuthState)})).apply(this,arguments)}class R6{constructor(t,n,r,i,o=!1){this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){var t=this;return new Promise(function(){var n=_e(function*(r,i){t.pendingPromise={resolve:r,reject:i};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(o){t.reject(o)}});return function(r,i){return n.apply(this,arguments)}}())}onAuthEvent(t){var n=this;return _e(function*(){const{urlResponse:r,sessionId:i,postBody:o,tenantId:a,error:c,type:p}=t;if(c)return void n.reject(c);const _={auth:n.auth,requestUri:r,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:n.user,bypassAuthState:n.bypassAuthState};try{n.resolve(yield n.getIdpTask(p)(_))}catch(x){n.reject(x)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return zge;case"linkViaPopup":case"linkViaRedirect":return jge;case"reauthViaPopup":case"reauthViaRedirect":return Uge;default:Za(this.auth,"internal-error")}}resolve(t){Ah(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ah(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Hge=new uw(2e3,1e4);function AP(){return(AP=_e(function*(e,t,n){if(kh(e.app))return Promise.reject(da(e,"operation-not-supported-in-this-environment"));const r=vo(e);!function py(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Za(e,"argument-error"),zR(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,Lh);const i=og(r,n);return new PP(r,"signInViaPopup",t,i).executeNotNull()})).apply(this,arguments)}let PP=(()=>{class e extends R6{constructor(n,r,i,o,a){super(n,r,o,a),this.provider=i,this.authWindow=null,this.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=this}executeNotNull(){var n=this;return _e(function*(){const r=yield n.execute();return ct(r,n.auth,"internal-error"),r})()}onExecution(){var n=this;return _e(function*(){Ah(1===n.filter.length,"Popup operations only handle one event");const r=O1();n.authWindow=yield n.resolver._openPopup(n.auth,n.provider,n.filter[0],r),n.authWindow.associatedEvent=r,n.resolver._originValidation(n.auth).catch(i=>{n.reject(i)}),n.resolver._isIframeWebStorageSupported(n.auth,i=>{i||n.reject(da(n.auth,"web-storage-unsupported"))}),n.pollUserCancellation()})()}get eventId(){var n;return(null===(n=this.authWindow)||void 0===n?void 0:n.associatedEvent)||null}cancel(){this.reject(da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null}pollUserCancellation(){const n=()=>{var r,i;this.pollId=null!==(i=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(da(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(n,Hge.get())};n()}}return e.currentPopupAction=null,e})();const ww=new Map;class Gge extends R6{constructor(t,n,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,n=this;return _e(function*(){let r=ww.get(n.auth._key());if(!r){try{const o=(yield function Wge(e,t){return OP.apply(this,arguments)}(n.resolver,n.auth))?yield t().call(n):null;r=()=>Promise.resolve(o)}catch(i){r=()=>Promise.reject(i)}ww.set(n.auth._key(),r)}return n.bypassAuthState||ww.set(n.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var n=()=>super.onAuthEvent,r=this;return _e(function*(){if("signInViaRedirect"===t.type)return n().call(r,t);if("unknown"!==t.type){if(t.eventId){const i=yield r.auth._redirectUserForId(t.eventId);if(i)return r.user=i,n().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return _e(function*(){})()}cleanUp(){}}function OP(){return(OP=_e(function*(e,t){const n=function P6(e){return D1("pendingRedirect",e.config.apiKey,e.name)}(t),r=function M6(e){return Oh(e._redirectPersistence)}(e);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(n));return yield r._remove(n),i})).apply(this,arguments)}function Zge(e,t){ww.set(e._key(),t)}function O6(e,t){return UP.apply(this,arguments)}function UP(){return(UP=_e(function*(e,t,n=!1){if(kh(e.app))return Promise.reject(hs(e));const r=vo(e),i=og(r,t),a=yield new Gge(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,t)),a})).apply(this,arguments)}class Jge{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(n=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function e_e(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return F6(e);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=t,n=!0)),n}sendToConsumer(t,n){var r;if(t.error&&!F6(t)){const i=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";n.onError(da(this.auth,i))}else n.onAuthEvent(t)}isEventForConsumer(t,n){const r=null===n.eventId||!!t.eventId&&t.eventId===n.eventId;return n.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(L6(t))}saveEventToCache(t){this.cachedEventUids.add(L6(t)),this.lastProcessedEventTime=Date.now()}}function L6(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function F6({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}function HP(){return(HP=_e(function*(e,t={}){return mi(e,"GET","/v1/projects",t)})).apply(this,arguments)}const n_e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r_e=/^https?/;function $P(){return $P=_e(function*(e){if(e.config.emulator)return;const{authorizedDomains:t}=yield function t_e(e){return HP.apply(this,arguments)}(e);for(const n of t)try{if(o_e(n))return}catch{}Za(e,"unauthorized-domain")}),$P.apply(this,arguments)}function o_e(e){const t=cw(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!r_e.test(n))return!1;if(n_e.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const s_e=new uw(3e4,6e4);function B6(){const e=Bo().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function a_e(e){return new Promise((t,n)=>{var r,i,o;function a(){B6(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{B6(),n(da(e,"network-request-failed"))},timeout:s_e.get()})}if(null!==(i=null===(r=Bo().gapi)||void 0===r?void 0:r.iframes)&&void 0!==i&&i.Iframe)t(gapi.iframes.getContext());else{if(null===(o=Bo().gapi)||void 0===o||!o.load){const c=a6("iframefcb");return Bo()[c]=()=>{gapi.load?a():n(da(e,"network-request-failed"))},function lM(e){return pw.loadJS(e)}(`${function _me(){return pw.gapiScript}()}?onload=${c}`).catch(p=>n(p))}a()}}).catch(t=>{throw B1=null,t})}let B1=null;const c_e=new uw(5e3,15e3),h_e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},f_e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function p_e(e){const t=e.config;ct(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?HR(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:rg},i=f_e.get(e.config.apiHost);i&&(r.eid=i);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${fy(r).slice(1)}`}function qP(){return qP=_e(function*(e){const t=yield function l_e(e){return B1=B1||a_e(e),B1}(e),n=Bo().gapi;return ct(n,e,"internal-error"),t.open({where:document.body,url:p_e(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h_e,dontclear:!0},r=>new Promise(function(){var i=_e(function*(o,a){yield r.restyle({setHideOnLeave:!1});const c=da(e,"network-request-failed"),p=Bo().setTimeout(()=>{a(c)},c_e.get());function _(){Bo().clearTimeout(p),o(r)}r.ping(_).then(_,()=>{a(c)})});return function(o,a){return i.apply(this,arguments)}}()))}),qP.apply(this,arguments)}const g_e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class V6{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const D_e=encodeURIComponent("fac");function z6(e,t,n,r,i,o){return GP.apply(this,arguments)}function GP(){return(GP=_e(function*(e,t,n,r,i,o){ct(e.config.authDomain,e,"auth-domain-config-required"),ct(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:rg,eventId:i};if(t instanceof Lh){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",vR(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[x,D]of Object.entries(o||{}))a[x]=D}if(t instanceof p6){const x=t.getScopes().filter(D=>""!==D);x.length>0&&(a.scopes=x.join(","))}e.tenantId&&(a.tid=e.tenantId);const c=a;for(const x of Object.keys(c))void 0===c[x]&&delete c[x];const p=yield e._getAppCheckToken(),_=p?`#${D_e}=${encodeURIComponent(p)}`:"";return`${function T_e({config:e}){return e.emulator?HR(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${fy(c).slice(1)}${_}`})).apply(this,arguments)}const WP="webStorageSupport",I_e=class S_e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D6,this._completeRedirectFn=O6,this._overrideRedirectResult=Zge}_openPopup(t,n,r,i){var o=this;return _e(function*(){var a;Ah(null===(a=o.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");const c=yield z6(t,n,r,cw(),i);return function w_e(e,t,n,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const p=Object.assign(Object.assign({},g_e),{width:r.toString(),height:i.toString(),top:o,left:a}),_=Ps().toLowerCase();n&&(c=JH(_)?"_blank":n),XH(_)&&(t=t||"http://localhost",p.scrollbars="yes");const x=Object.entries(p).reduce((A,[O,B])=>`${A}${O}=${B},`,"");if(function ame(e=Ps()){var t;return sM(e)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(_)&&"_self"!==c)return function x_e(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new V6(null);const D=window.open(t||"",c,x);ct(D,e,"popup-blocked");try{D.focus()}catch{}return new V6(D)}(t,c,O1())})()}_openRedirect(t,n,r,i){var o=this;return _e(function*(){return yield o._originValidation(t),function gge(e){Bo().location.href=e}(yield z6(t,n,r,cw(),i)),new Promise(()=>{})})()}_initialize(t){const n=t._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(Ah(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(t);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(t){var n=this;return _e(function*(){const r=yield function m_e(e){return qP.apply(this,arguments)}(t),i=new Jge(t);return r.register("authEvent",o=>(ct(o?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[t._key()]={manager:i},n.iframes[t._key()]=r,i})()}_isIframeWebStorageSupported(t,n){this.iframes[t._key()].send(WP,{type:WP},i=>{var o;const a=null===(o=i?.[0])||void 0===o?void 0:o[WP];void 0!==a&&n(!!a),Za(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const n=t._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=function i_e(e){return $P.apply(this,arguments)}(t)),this.originValidationPromises[n]}get _shouldInitProactively(){return i6()||QH()||sM()}};var $6="@firebase/auth";class k_e{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var n=this;return _e(function*(){return n.assertAuthConfigured(),yield n.auth._initializationPromise,n.auth.currentUser?{accessToken:yield n.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const n=this.auth.onIdTokenChanged(r=>{t(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,n),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const n=this.internalListeners.get(t);n&&(this.internalListeners.delete(t),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const M_e=gH("authIdTokenMaxAge")||300;let G6=null;const P_e=e=>function(){var t=_e(function*(n){const r=n&&(yield n.getIdTokenResult()),i=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>M_e)return;const o=r?.token;G6!==o&&(G6=o,yield fetch(e,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(n){return t.apply(this,arguments)}}();(function pme(e){pw=e})({loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=i=>{const o=da("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",function N_e(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function R_e(e){ng(new ap("auth",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;ct(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const p={apiKey:a,authDomain:c,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:o6(e)},_=new fme(r,i,o,p);return function xme(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Oh);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(_,n),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,n,r)=>{t.getProvider("auth-internal").initialize()})),ng(new ap("auth-internal",t=>{const n=vo(t.getProvider("auth").getImmediate());return new k_e(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),hu($6,"1.7.9",function A_e(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(e)),hu($6,"1.7.9","esm2017")}("Browser");const W6="@firebase/database";let KP="";class L_e{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){null==n?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Ko(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return null==n?null:rw(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class F_e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){null==n?delete this.cache_[t]:this.cache_[t]=n}get(t){return hd(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const Y6=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new L_e(t)}}catch{}return new F_e},sg=Y6("localStorage"),YP=Y6("sessionStorage"),vy=new xR("@firebase/database"),X6=function(){let e=1;return function(){return e++}}(),Q6=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,it(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Yhe;n.update(t);const r=n.digest();return _R.encodeByteArray(r)},xw=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=xw.apply(null,r):t+="object"==typeof r?Ko(r):r,t+=" "}return t};let ag=null,J6=!0;const fs=function(...e){if(!0===J6&&(J6=!1,null===ag&&!0===YP.get("logging_enabled")&&function(e,t){it(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(vy.logLevel=qr.VERBOSE,ag=vy.log.bind(vy),t&&YP.set("logging_enabled",!0)):"function"==typeof e?ag=e:(ag=null,YP.remove("logging_enabled"))}(!0)),ag){const t=xw.apply(null,e);ag(t)}},Ew=function(e){return function(...t){fs(e,...t)}},XP=function(...e){const t="FIREBASE INTERNAL ERROR: "+xw(...e);vy.error(t)},pd=function(...e){const t=`FIREBASE FATAL ERROR: ${xw(...e)}`;throw vy.error(t),new Error(t)},qs=function(...e){const t="FIREBASE WARNING: "+xw(...e);vy.warn(t)},z1=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},up="[MIN_NAME]",Fh="[MAX_NAME]",lg=function(e,t){if(e===t)return 0;if(e===up||t===Fh)return-1;if(t===up||e===Fh)return 1;{const n=r8(e),r=r8(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},z_e=function(e,t){return e===t?0:e<t?-1:1},Cw=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ko(t))},QP=function(e){if("object"!=typeof e||null===e)return Ko(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=Ko(t[r]),n+=":",n+=QP(e[t[r]]);return n+="}",n},t8=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function ps(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const n8=function(e){it(!z1(e),"Invalid JSON number");const r=1023;let i,o,a,c,p;0===e?(o=0,a=0,i=1/e==-1/0?1:0):(i=e<0,(e=Math.abs(e))>=Math.pow(2,1-r)?(c=Math.min(Math.floor(Math.log(e)/Math.LN2),r),o=c+r,a=Math.round(e*Math.pow(2,52-c)-Math.pow(2,52))):(o=0,a=Math.round(e/Math.pow(2,-1074))));const _=[];for(p=52;p;p-=1)_.push(a%2?1:0),a=Math.floor(a/2);for(p=11;p;p-=1)_.push(o%2?1:0),o=Math.floor(o/2);_.push(i?1:0),_.reverse();const x=_.join("");let D="";for(p=0;p<64;p+=8){let A=parseInt(x.substr(p,8),2).toString(16);1===A.length&&(A="0"+A),D+=A}return D.toLowerCase()},$_e=new RegExp("^-?(0*)\\d{1,10}$"),r8=function(e){if($_e.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},by=function(e){try{e()}catch(t){setTimeout(()=>{throw qs("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},Dw=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Z_e{constructor(t,n){this.appName_=t,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){var n;null===(n=this.appCheckProvider)||void 0===n||n.get().then(r=>r.addTokenListener(t))}notifyForInvalidToken(){qs(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class K_e{constructor(t,n,r){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&"auth/token-not-initialized"===n.code?(fs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',qs(t)}}let Tw=(()=>{class e{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}return e.OWNER="owner",e})();const l8=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,d8="websocket",h8="long_polling";class eO{constructor(t,n,r,i,o=!1,a="",c=!1,p=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=p,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=sg.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&sg.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function f8(e,t,n){let r;if(it("string"==typeof t,"typeof type must == string"),it("object"==typeof n,"typeof params must == object"),t===d8)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==h8)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function Y_e(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return ps(n,(o,a)=>{i.push(o+"="+a)}),r+i.join("&")}class X_e{constructor(){this.counters_={}}incrementCounter(t,n=1){hd(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return Mhe(this.counters_)}}const tO={},nO={};function rO(e){const t=e.toString();return tO[t]||(tO[t]=new X_e),tO[t]}class J_e{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&by(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class dp{constructor(t,n,r,i,o,a,c){this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=a,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ew(t),this.stats_=rO(n),this.urlFn=p=>(this.appCheckToken&&(p.ac=this.appCheckToken),f8(n,h8,p))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new J_e(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new iO((...o)=>{const[a,c,p,_,x]=o;if(this.incrementIncomingBytes_(o),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=c,this.password=p;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_()}},(...o)=>{const[a,c]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,c)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&l8.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){dp.forceAllow_=!0}static forceDisallow(){dp.forceDisallow_=!0}static isAvailable(){return!(!dp.forceAllow_&&(dp.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=Ko(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=dH(n),i=t8(r,1840);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=t,r.pw=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=Ko(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class iO{constructor(t,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=X6(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=iO.createIFrame_();let o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(c){fs("frame writing exception"),c.stack&&fs(c.stack),fs(c)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||fs("No IE domain setting required")}catch{const r=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let n=this.urlFn(t),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const a=this.pendingSegs.shift();r=r+"&seg"+i+"="+a.seg+"&ts"+i+"="+a.ts+"&d"+i+"="+a.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(t,n,r){this.pendingSegs.push({seg:t,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,()=>{clearTimeout(i),r()})}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{fs("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let j1=null;typeof MozWebSocket<"u"?j1=MozWebSocket:typeof WebSocket<"u"&&(j1=WebSocket);let wy=(()=>{class e{constructor(n,r,i,o,a,c,p){this.connId=n,this.applicationId=i,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ew(this.connId),this.stats_=rO(r),this.connURL=e.connectionURL_(r,c,p,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,o,a){const c={v:"5"};return typeof location<"u"&&location.hostname&&l8.test(location.hostname)&&(c.r="f"),r&&(c.s=r),i&&(c.ls=i),o&&(c.ac=o),a&&(c.p=a),f8(n,d8,c)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,sg.set("previous_websocket_failure",!0);try{let i;0,this.mySock=new j1(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const o=i.message||i.data;return o&&this.log_(o),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){e.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&null!==j1&&!e.forceDisallow_}static previouslyFailed(){return sg.isInMemoryStorage||!0===sg.get("previous_websocket_failure")}markConnectionHealthy(){sg.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=rw(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(it(null===this.frames,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(null===this.mySock)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=Ko(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=t8(r,16384);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e})(),b8=(()=>{class e{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[dp,wy]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){const r=wy&&wy.isAvailable();let i=r&&!wy.previouslyFailed();if(n.webSocketOnly&&(r||qs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[wy];else{const o=this.transports_=[];for(const a of e.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);e.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return e.globalTransportInitialized_=!1,e})();class S8{constructor(t,n,r,i,o,a,c,p,_,x){this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=a,this.onReady_=c,this.onDisconnect_=p,this.onKill_=_,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ew("c:"+this.id+":"),this.transportManager_=new b8(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Dw(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){this.sendData_({t:"d",d:t})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const n=t.t;"a"===n?this.upgradeIfSecondaryHealthy_():"r"===n?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===n&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=Cw("t",t),r=Cw("d",t);if("c"===n)this.onSecondaryControl_(r);else{if("d"!==n)throw new Error("Unknown protocol layer: "+n);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=Cw("t",t),r=Cw("d",t);"c"===n?this.onControl_(r):"d"===n&&this.onDataMessage_(r)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=Cw("t",t);if("d"in t){const r=t.d;if("h"===n){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===n?this.onConnectionShutdown_(r):"r"===n?this.onReset_(r):"e"===n?XP("Server Error: "+r):"o"===n?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):XP("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,r=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),"5"!==r&&qs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Dw(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Dw(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(sg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class I8{put(t,n,r,i){}merge(t,n,r,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,r){}onDisconnectMerge(t,n,r){}onDisconnectCancel(t,n){}reportStats(t){}}class k8{constructor(t){this.allowedEvents_=t,this.listeners_={},it(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const r=[...this.listeners_[t]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(t,n,r){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:r});const i=this.getInitialEvent(t);i&&n.apply(r,i)}off(t,n,r){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let o=0;o<i.length;o++)if(i[o].callback===n&&(!r||r===i[o].context))return void i.splice(o,1)}validateEventType_(t){it(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}class H1 extends k8{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!yR()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new H1}getInitialEvent(t){return it("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class Ar{constructor(t,n){if(void 0===n){this.pieces_=t.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)""!==this.pieces_[n]&&(t+="/"+this.pieces_[n]);return t||"/"}}function vr(){return new Ar("")}function Nn(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function hp(e){return e.pieces_.length-e.pieceNum_}function Xr(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Ar(e.pieces_,t)}function sO(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Sw(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function M8(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Ar(t,0)}function Ti(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Ar)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const r=t.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ar(n,0)}function Ln(e){return e.pieceNum_>=e.pieces_.length}function ha(e,t){const n=Nn(e),r=Nn(t);if(null===n)return t;if(n===r)return ha(Xr(e),Xr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function wye(e,t){const n=Sw(e,0),r=Sw(t,0);for(let i=0;i<n.length&&i<r.length;i++){const o=lg(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function aO(e,t){if(hp(e)!==hp(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Sc(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(hp(e)>hp(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class xye{constructor(t,n){this.errorPrefix_=n,this.parts_=Sw(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=y1(this.parts_[r]);P8(this)}}function P8(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+cg(e))}function cg(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class lO extends k8{constructor(){let t,n;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[t];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new lO}getInitialEvent(t){return it("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Iw=1e3;let q1,ug=(()=>{class e extends I8{constructor(n,r,i,o,a,c,p,_){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=c,this.appCheckTokenProvider_=p,this.authOverride_=_,this.id=e.nextPersistentConnectionId_++,this.log_=Ew("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Iw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,_)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lO.getInstance().on("visible",this.onVisible_,this),-1===n.host.indexOf("fblocal")&&H1.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const o=++this.requestNumber_,a={r:o,a:n,b:r};this.log_(Ko(a)),it(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),i&&(this.requestCBHash_[o]=i)}get(n){this.initConnection_();const r=new dy,o={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:c=>{const p=c.d;"ok"===c.s?r.resolve(p):r.reject(p)}};return this.outstandingGets_.push(o),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(n,r,i,o){this.initConnection_();const a=n._queryIdentifier,c=n._path.toString();this.log_("Listen called for "+c+" "+a),this.listens.has(c)||this.listens.set(c,new Map),it(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),it(!this.listens.get(c).has(a),"listen() called twice for same path/queryId.");const p={onComplete:o,hashFn:r,query:n,tag:i};this.listens.get(c).set(a,p),this.connected_&&this.sendListen_(p)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);const a={p:i};n.tag&&(a.q=r._queryObject,a.t=n.tag),a.h=n.hashFn(),this.sendRequest("q",a,p=>{const _=p.d,x=p.s;e.warnOnListenWarnings_(_,r),(this.listens.get(i)&&this.listens.get(i).get(o))===n&&(this.log_("listen response",p),"ok"!==x&&this.removeListen_(i,o),n.onComplete&&n.onComplete(x,_))})}static warnOnListenWarnings_(n,r){if(n&&"object"==typeof n&&hd(n,"w")){const i=hy(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',a=r._path.toString();qs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&40===n.length||function(e){const t=m1(e).claims;return"object"==typeof t&&!0===t.admin}(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=function(e){const n=m1(e).claims;return!!n&&"object"==typeof n&&n.hasOwnProperty("iat")}(n)?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{const a=o.s,c=o.d||"error";this.authToken_===n&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),o=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),it(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,n._queryObject,r)}sendUnlisten_(n,r,i,o){this.log_("Unlisten on "+n+" for "+r);const a={p:n};o&&(a.q=i,a.t=o),this.sendRequest("n",a)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,o){const a={p:r,d:i};this.log_("onDisconnect "+n,a),this.sendRequest(n,a,c=>{o&&setTimeout(()=>{o(c.s,c.d)},Math.floor(0))})}put(n,r,i,o){this.putInternal("p",n,r,i,o)}merge(n,r,i,o){this.putInternal("m",n,r,i,o)}putInternal(n,r,i,o,a){this.initConnection_();const c={p:r,d:i};void 0!==a&&(c.h=a),this.outstandingPuts_.push({action:n,request:c,onComplete:o}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,o=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,a=>{this.log_(r+" response",a),delete this.outstandingPuts_[n],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Ko(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),"d"===n?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===n?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===n?this.onListenRevoked_(r.p,r.q):"ac"===n?this.onAuthRevoked_(r.s,r.d):"apc"===n?this.onAppCheckRevoked_(r.s,r.d):"sd"===n?this.onSecurityDebugPacket_(r):XP("Unrecognized action received from server: "+Ko(n)+"\nAre you using the latest client?")}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){it(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Iw,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Iw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Iw),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const n=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var n=this;return _e(function*(){if(n.shouldReconnect_()){n.log_("Making a connection attempt"),n.lastConnectionAttemptTime_=(new Date).getTime(),n.lastConnectionEstablishedTime_=null;const r=n.onDataMessage_.bind(n),i=n.onReady_.bind(n),o=n.onRealtimeDisconnect_.bind(n),a=n.id+":"+e.nextConnectionId_++,c=n.lastSessionId;let p=!1,_=null;const x=function(){_?_.close():(p=!0,o())};n.realtime_={close:x,sendRequest:function(O){it(_,"sendRequest call when we're not connected not allowed."),_.sendRequest(O)}};const A=n.forceTokenRefresh_;n.forceTokenRefresh_=!1;try{const[O,B]=yield Promise.all([n.authTokenProvider_.getToken(A),n.appCheckTokenProvider_.getToken(A)]);p?fs("getToken() completed but was canceled"):(fs("getToken() completed. Creating connection."),n.authToken_=O&&O.accessToken,n.appCheckToken_=B&&B.token,_=new S8(a,n.repoInfo_,n.applicationId_,n.appCheckToken_,n.authToken_,r,i,o,Q=>{qs(Q+" ("+n.repoInfo_.toString()+")"),n.interrupt("server_kill")},c))}catch(O){n.log_("Failed to get token: "+O),p||(n.repoInfo_.nodeAdmin&&qs(O),x())}}})()}interrupt(n){fs("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){fs("Resuming connection for reason: "+n),delete this.interruptReasons_[n],vR(this.interruptReasons_)&&(this.reconnectDelay_=Iw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;i=r?r.map(a=>QP(a)).join("$"):"default";const o=this.removeListen_(n,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(n,r){const i=new Ar(n).toString();let o;if(this.listens.has(i)){const a=this.listens.get(i);o=a.get(r),a.delete(r),0===a.size&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(n,r){fs("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===n||"permission_denied"===n)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){fs("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===n||"permission_denied"===n)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";n["sdk."+r+"."+KP.replace(/\./g,"-")]=1,yR()?n["framework.cordova"]=1:yH()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=H1.getInstance().currentlyOnline();return vR(this.interruptReasons_)&&n}}return e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e})();class jn{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new jn(t,n)}}class $1{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const r=new jn(up,t),i=new jn(up,n);return 0!==this.compare(r,i)}minPost(){return jn.MIN}}class L8 extends $1{static get __EMPTY_NODE(){return q1}static set __EMPTY_NODE(t){q1=t}compare(t,n){return lg(t.name,n.name)}isDefinedOn(t){throw uy("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return jn.MIN}maxPost(){return new jn(Fh,q1)}makePost(t,n){return it("string"==typeof t,"KeyIndex indexValue must always be a string."),new jn(t,q1)}toString(){return".key"}}const md=new L8;class G1{constructor(t,n,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!t.isEmpty();)if(a=n?r(t.key,n):1,i&&(a*=-1),a<0)t=this.isReverse_?t.left:t.right;else{if(0===a){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let n,t=this.nodeStack_.pop();if(n=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}let uO,fu=(()=>{class e{constructor(n,r,i,o,a){this.key=n,this.value=r,this.color=i??e.RED,this.left=o??Ka.EMPTY_NODE,this.right=a??Ka.EMPTY_NODE}copy(n,r,i,o,a){return new e(n??this.key,r??this.value,i??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let o=this;const a=i(n,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(n,r,i),null):0===a?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(n,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ka.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,o;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(n,i.key)){if(i.right.isEmpty())return Ka.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return e.RED=!0,e.BLACK=!1,e})();class Ka{constructor(t,n=Ka.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new Ka(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,fu.BLACK,null,null))}remove(t){return new Ka(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,fu.BLACK,null,null))}get(t){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(t,r.key),0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(t){let n,r=this.root_,i=null;for(;!r.isEmpty();){if(n=this.comparator_(t,r.key),0===n){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}n<0?r=r.left:n>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new G1(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new G1(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new G1(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new G1(this.root_,null,this.comparator_,!0,t)}}function Aye(e,t){return lg(e.name,t.name)}function cO(e,t){return lg(e,t)}Ka.EMPTY_NODE=new class kye{copy(t,n,r,i,o){return this}insert(t,n,r){return new fu(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const F8=function(e){return"number"==typeof e?"number:"+n8(e):"string:"+e},B8=function(e){if(e.isLeafNode()){const t=e.val();it("string"==typeof t||"number"==typeof t||"object"==typeof t&&hd(t,".sv"),"Priority must be a string or number.")}else it(e===uO||e.isEmpty(),"priority of unexpected type.");it(e===uO||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let V8,z8,U8,xy=(()=>{class e{constructor(n,r=e.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,it(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),B8(this.priorityNode_)}static set __childrenNodeConstructor(n){V8=n}static get __childrenNodeConstructor(){return V8}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new e(this.value_,n)}getImmediateChild(n){return".priority"===n?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return Ln(n)?this:".priority"===Nn(n)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return".priority"===n?this.updatePriority(r):r.isEmpty()&&".priority"!==n?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=Nn(n);return null===i?r:r.isEmpty()&&".priority"!==i?this:(it(".priority"!==i||1===hp(n),".priority must be the last token in a path"),this.updateImmediateChild(i,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xr(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+F8(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",n+="number"===r?n8(this.value_):this.value_,this.lazyHash_=Q6(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===e.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof e.__childrenNodeConstructor?-1:(it(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,o=e.VALUE_TYPE_ORDER.indexOf(r),a=e.VALUE_TYPE_ORDER.indexOf(i);return it(o>=0,"Unknown leaf type: "+r),it(a>=0,"Unknown leaf type: "+i),o===a?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(n){return n===this||!!n.isLeafNode()&&(this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_))}}return e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e})();const ii=new class Oye extends $1{compare(t,n){const r=t.node.getPriority(),i=n.node.getPriority(),o=r.compareTo(i);return 0===o?lg(t.name,n.name):o}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return jn.MIN}maxPost(){return new jn(Fh,new xy("[PRIORITY-POST]",U8))}makePost(t,n){const r=z8(t);return new jn(n,new xy("[PRIORITY-POST]",r))}toString(){return".priority"}},Nye=Math.log(2);class Lye{constructor(t){this.count=parseInt(Math.log(t+1)/Nye,10),this.current_=this.count-1;const i=(()=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=t+1&i}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const W1=function(e,t,n,r){e.sort(t);const i=function(p,_){const x=_-p;let D,A;if(0===x)return null;if(1===x)return D=e[p],A=n?n(D):D,new fu(A,D.node,fu.BLACK,null,null);{const O=parseInt(x/2,10)+p,B=i(p,O),Q=i(O+1,_);return D=e[O],A=n?n(D):D,new fu(A,D.node,fu.BLACK,B,Q)}},c=function(p){let _=null,x=null,D=e.length;const A=function(B,Q){const oe=D-B,ye=D;D-=B;const xe=i(oe+1,ye),$e=e[oe],De=n?n($e):$e;O(new fu(De,$e.node,Q,null,xe))},O=function(B){_?(_.left=B,_=B):(x=B,_=B)};for(let B=0;B<p.count;++B){const Q=p.nextBitIsOne(),oe=Math.pow(2,p.count-(B+1));Q?A(oe,fu.BLACK):(A(oe,fu.BLACK),A(oe,fu.RED))}return x}(new Lye(e.length));return new Ka(r||t,c)};let dO;const Ey={};class Bh{constructor(t,n){this.indexes_=t,this.indexSet_=n}static get Default(){return it(Ey&&ii,"ChildrenNode.ts has not been loaded"),dO=dO||new Bh({".priority":Ey},{".priority":ii}),dO}get(t){const n=hy(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof Ka?n:null}hasIndex(t){return hd(this.indexSet_,t.toString())}addIndex(t,n){it(t!==md,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=n.getIterator(jn.Wrap);let c,a=o.getNext();for(;a;)i=i||t.isDefinedOn(a.node),r.push(a),a=o.getNext();c=i?W1(r,t.getCompare()):Ey;const p=t.toString(),_=Object.assign({},this.indexSet_);_[p]=t;const x=Object.assign({},this.indexes_);return x[p]=c,new Bh(x,_)}addToIndexes(t,n){const r=g1(this.indexes_,(i,o)=>{const a=hy(this.indexSet_,o);if(it(a,"Missing index implementation for "+o),i===Ey){if(a.isDefinedOn(t.node)){const c=[],p=n.getIterator(jn.Wrap);let _=p.getNext();for(;_;)_.name!==t.name&&c.push(_),_=p.getNext();return c.push(t),W1(c,a.getCompare())}return Ey}{const c=n.get(t.name);let p=i;return c&&(p=p.remove(new jn(t.name,c))),p.insert(t,t.node)}});return new Bh(r,this.indexSet_)}removeFromIndexes(t,n){const r=g1(this.indexes_,i=>{if(i===Ey)return i;{const o=n.get(t.name);return o?i.remove(new jn(t.name,o)):i}});return new Bh(r,this.indexSet_)}}let kw,kn=(()=>{class e{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&B8(this.priorityNode_),this.children_.isEmpty()&&it(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return kw||(kw=new e(new Ka(cO),null,Bh.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||kw}updatePriority(n){return this.children_.isEmpty()?this:new e(this.children_,n,this.indexMap_)}getImmediateChild(n){if(".priority"===n)return this.getPriority();{const r=this.children_.get(n);return null===r?kw:r}}getChild(n){const r=Nn(n);return null===r?this:this.getImmediateChild(r).getChild(Xr(n))}hasChild(n){return null!==this.children_.get(n)}updateImmediateChild(n,r){if(it(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{const i=new jn(n,r);let o,a;r.isEmpty()?(o=this.children_.remove(n),a=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(n,r),a=this.indexMap_.addToIndexes(i,this.children_));const c=o.isEmpty()?kw:this.priorityNode_;return new e(o,c,a)}}updateChild(n,r){const i=Nn(n);if(null===i)return r;{it(".priority"!==Nn(n)||1===hp(n),".priority must be the last token in a path");const o=this.getImmediateChild(i).updateChild(Xr(n),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,o=0,a=!0;if(this.forEachChild(ii,(c,p)=>{r[c]=p.val(n),i++,a&&e.INTEGER_REGEXP_.test(c)?o=Math.max(o,Number(c)):a=!1}),!n&&a&&o<2*i){const c=[];for(const p in r)c[p]=r[p];return c}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let n="";this.getPriority().isEmpty()||(n+="priority:"+F8(this.getPriority().val())+":"),this.forEachChild(ii,(r,i)=>{const o=i.hash();""!==o&&(n+=":"+r+":"+o)}),this.lazyHash_=""===n?"":Q6(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const o=this.resolveIndex_(i);if(o){const a=o.getPredecessorKey(new jn(n,r));return a?a.name:null}return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new jn(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new jn(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,o=>o);{const o=this.children_.getIteratorFrom(n.name,jn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,n)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,o=>o);{const o=this.children_.getReverseIteratorFrom(n.name,jn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,n)>0;)o.getNext(),a=o.peek();return o}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Aw?-1:0}withIndex(n){if(n===md||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new e(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===md||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(ii),o=r.getIterator(ii);let a=i.getNext(),c=o.getNext();for(;a&&c;){if(a.name!==c.name||!a.node.equals(c.node))return!1;a=i.getNext(),c=o.getNext()}return null===a&&null===c}return!1}return!1}}resolveIndex_(n){return n===md?null:this.indexMap_.get(n.toString())}}return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e})();const Aw=new class Fye extends kn{constructor(){super(new Ka(cO),kn.EMPTY_NODE,Bh.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return kn.EMPTY_NODE}isEmpty(){return!1}};function $i(e,t=null){if(null===e)return kn.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),it(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new xy(e,$i(t));if(e instanceof Array){let n=kn.EMPTY_NODE;return ps(e,(r,i)=>{if(hd(e,r)&&"."!==r.substring(0,1)){const o=$i(i);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(r,o))}}),n.updatePriority($i(t))}{const n=[];let r=!1;if(ps(e,(a,c)=>{if("."!==a.substring(0,1)){const p=$i(c);p.isEmpty()||(r=r||!p.getPriority().isEmpty(),n.push(new jn(a,p)))}}),0===n.length)return kn.EMPTY_NODE;const o=W1(n,Aye,a=>a.name,cO);if(r){const a=W1(n,ii.getCompare());return new kn(o,$i(t),new Bh({".priority":a},{".priority":ii}))}return new kn(o,$i(t),Bh.Default)}}Object.defineProperties(jn,{MIN:{value:new jn(up,kn.EMPTY_NODE)},MAX:{value:new jn(Fh,Aw)}}),L8.__EMPTY_NODE=kn.EMPTY_NODE,xy.__childrenNodeConstructor=kn,function Rye(e){uO=e}(Aw),function Pye(e){U8=e}(Aw),function Mye(e){z8=e}($i);class hO extends $1{constructor(t){super(),this.indexPath_=t,it(!Ln(t)&&".priority"!==Nn(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const r=this.extractChild(t.node),i=this.extractChild(n.node),o=r.compareTo(i);return 0===o?lg(t.name,n.name):o}makePost(t,n){const r=$i(t),i=kn.EMPTY_NODE.updateChild(this.indexPath_,r);return new jn(n,i)}maxPost(){const t=kn.EMPTY_NODE.updateChild(this.indexPath_,Aw);return new jn(Fh,t)}toString(){return Sw(this.indexPath_,0).join("/")}}const fO=new class Vye extends $1{compare(t,n){const r=t.node.compareTo(n.node);return 0===r?lg(t.name,n.name):r}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return jn.MIN}maxPost(){return jn.MAX}makePost(t,n){const r=$i(t);return new jn(n,r)}toString(){return".value"}};function j8(e){return{type:"value",snapshotNode:e}}function Cy(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Rw(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Mw(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class pO{constructor(t){this.index_=t}updateChild(t,n,r,i,o,a){it(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=t.getImmediateChild(n);return c.getChild(i).equals(r.getChild(i))&&c.isEmpty()===r.isEmpty()||(null!=a&&(r.isEmpty()?t.hasChild(n)?a.trackChildChange(Rw(n,c)):it(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?a.trackChildChange(Cy(n,r)):a.trackChildChange(Mw(n,r,c))),t.isLeafNode()&&r.isEmpty())?t:t.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(t,n,r){return null!=r&&(t.isLeafNode()||t.forEachChild(ii,(i,o)=>{n.hasChild(i)||r.trackChildChange(Rw(i,o))}),n.isLeafNode()||n.forEachChild(ii,(i,o)=>{if(t.hasChild(i)){const a=t.getImmediateChild(i);a.equals(o)||r.trackChildChange(Mw(i,o,a))}else r.trackChildChange(Cy(i,o))})),n.withIndex(this.index_)}updatePriority(t,n){return t.isEmpty()?kn.EMPTY_NODE:t.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Pw{constructor(t){this.indexedFilter_=new pO(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Pw.getStartPost_(t),this.endPost_=Pw.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,r=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return n&&r}updateChild(t,n,r,i,o,a){return this.matches(new jn(n,r))||(r=kn.EMPTY_NODE),this.indexedFilter_.updateChild(t,n,r,i,o,a)}updateFullNode(t,n,r){n.isLeafNode()&&(n=kn.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(kn.EMPTY_NODE);const o=this;return n.forEachChild(ii,(a,c)=>{o.matches(new jn(a,c))||(i=i.updateImmediateChild(a,kn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const n=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),n)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const n=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),n)}return t.getIndex().maxPost()}}class Uye{constructor(t){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Pw(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,n,r,i,o,a){return this.rangedFilter_.matches(new jn(n,r))||(r=kn.EMPTY_NODE),t.getImmediateChild(n).equals(r)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,n,r,i,o,a):this.fullLimitUpdateChild_(t,n,r,o,a)}updateFullNode(t,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=kn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<n.numChildren()&&n.isIndexed(this.index_)){let o;i=kn.EMPTY_NODE.withIndex(this.index_),o=this.reverse_?n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const c=o.getNext();if(this.withinDirectionalStart(c)){if(!this.withinDirectionalEnd(c))break;i=i.updateImmediateChild(c.name,c.node),a++}}}else{let o;i=n.withIndex(this.index_),i=i.updatePriority(kn.EMPTY_NODE),o=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let a=0;for(;o.hasNext();){const c=o.getNext();a<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?a++:i=i.updateImmediateChild(c.name,kn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,r,i,o){let a;if(this.reverse_){const D=this.index_.getCompare();a=(A,O)=>D(O,A)}else a=this.index_.getCompare();const c=t;it(c.numChildren()===this.limit_,"");const p=new jn(n,r),_=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),x=this.rangedFilter_.matches(p);if(c.hasChild(n)){const D=c.getImmediateChild(n);let A=i.getChildAfterChild(this.index_,_,this.reverse_);for(;null!=A&&(A.name===n||c.hasChild(A.name));)A=i.getChildAfterChild(this.index_,A,this.reverse_);const O=null==A?1:a(A,p);if(x&&!r.isEmpty()&&O>=0)return o?.trackChildChange(Mw(n,r,D)),c.updateImmediateChild(n,r);{o?.trackChildChange(Rw(n,D));const Q=c.updateImmediateChild(n,kn.EMPTY_NODE);return null!=A&&this.rangedFilter_.matches(A)?(o?.trackChildChange(Cy(A.name,A.node)),Q.updateImmediateChild(A.name,A.node)):Q}}return r.isEmpty()?t:x&&a(_,p)>=0?(null!=o&&(o.trackChildChange(Rw(_.name,_.node)),o.trackChildChange(Cy(n,r))),c.updateImmediateChild(n,r).updateImmediateChild(_.name,kn.EMPTY_NODE)):t}}class mO{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ii}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return it(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return it(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:up}hasEnd(){return this.endSet_}getIndexEndValue(){return it(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return it(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Fh}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return it(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ii}copy(){const t=new mO;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function H8(e){const t={};if(e.isDefault())return t;let n;if(e.index_===ii?n="$priority":e.index_===fO?n="$value":e.index_===md?n="$key":(it(e.index_ instanceof hO,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Ko(n),e.startSet_){const r=e.startAfterSet_?"startAfter":"startAt";t[r]=Ko(e.indexStartValue_),e.startNameSet_&&(t[r]+=","+Ko(e.indexStartName_))}if(e.endSet_){const r=e.endBeforeSet_?"endBefore":"endAt";t[r]=Ko(e.indexEndValue_),e.endNameSet_&&(t[r]+=","+Ko(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function $8(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ii&&(t.i=e.index_.toString()),t}class K1 extends I8{constructor(t,n,r,i){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ew("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return void 0!==n?"tag$"+n:(it(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,n,r,i){const o=t._path.toString();this.log_("Listen called for "+o+" "+t._queryIdentifier);const a=K1.getListenId_(t,r),c={};this.listens_[a]=c;const p=H8(t._queryParams);this.restRequest_(o+".json",p,(_,x)=>{let D=x;if(404===_&&(D=null,_=null),null===_&&this.onDataUpdate_(o,D,!1,r),hy(this.listens_,a)===c){let A;A=_?401===_?"permission_denied":"rest_error:"+_:"ok",i(A,null)}})}unlisten(t,n){const r=K1.getListenId_(t,n);delete this.listens_[r]}get(t){const n=H8(t._queryParams),r=t._path.toString(),i=new dy;return this.restRequest_(r+".json",n,(o,a)=>{let c=a;404===o&&(c=null,o=null),null===o?(this.onDataUpdate_(r,c,!1,null),i.resolve(c)):i.reject(new Error(c))}),i.promise}refreshAuthToken(t){}restRequest_(t,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(n.auth=i.accessToken),o&&o.token&&(n.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+fy(n);this.log_("Sending REST request for "+a);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(r&&4===c.readyState){this.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);let p=null;if(c.status>=200&&c.status<300){try{p=rw(c.responseText)}catch{qs("Failed to parse JSON response for "+a+": "+c.responseText)}r(null,p)}else 401!==c.status&&404!==c.status&&qs("Got unsuccessful REST response for "+a+" Status: "+c.status),r(c.status);r=null}},c.open("GET",a,!0),c.send()})}}class Wye{constructor(){this.rootNode_=kn.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}function Y1(){return{value:null,children:new Map}}function Dy(e,t,n){if(Ln(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Nn(t);e.children.has(r)||e.children.set(r,Y1()),Dy(e.children.get(r),t=Xr(t),n)}}function vO(e,t,n){null!==e.value?n(t,e.value):function Zye(e,t){e.children.forEach((n,r)=>{t(r,n)})}(e,(r,i)=>{vO(i,new Ar(t.toString()+"/"+r),n)})}class Kye{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n=Object.assign({},t);return this.last_&&ps(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=t,n}}class Qye{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Kye(t);const r=1e4+2e4*Math.random();Dw(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const t=this.statsListener_.get(),n={};let r=!1;ps(t,(i,o)=>{o>0&&hd(this.statsToReport_,i)&&(n[i]=o,r=!0)}),r&&this.server_.reportStats(n),Dw(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var gd=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}(gd||{});function xO(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}class X1{constructor(t,n,r){this.path=t,this.affectedTree=n,this.revert=r,this.type=gd.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(Ln(this.path)){if(null!=this.affectedTree.value)return it(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ar(t));return new X1(vr(),n,this.revert)}}return it(Nn(this.path)===t,"operationForChild called for unrelated child."),new X1(Xr(this.path),this.affectedTree,this.revert)}}class Ow{constructor(t,n){this.source=t,this.path=n,this.type=gd.LISTEN_COMPLETE}operationForChild(t){return Ln(this.path)?new Ow(this.source,vr()):new Ow(this.source,Xr(this.path))}}class dg{constructor(t,n,r){this.source=t,this.path=n,this.snap=r,this.type=gd.OVERWRITE}operationForChild(t){return Ln(this.path)?new dg(this.source,vr(),this.snap.getImmediateChild(t)):new dg(this.source,Xr(this.path),this.snap)}}class Ty{constructor(t,n,r){this.source=t,this.path=n,this.children=r,this.type=gd.MERGE}operationForChild(t){if(Ln(this.path)){const n=this.children.subtree(new Ar(t));return n.isEmpty()?null:n.value?new dg(this.source,vr(),n.value):new Ty(this.source,vr(),n)}return it(Nn(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Ty(this.source,Xr(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class fp{constructor(t,n,r){this.node_=t,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ln(t))return this.isFullyInitialized()&&!this.filtered_;const n=Nn(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class Jye{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function Nw(e,t,n,r,i,o){const a=r.filter(c=>c.type===n);a.sort((c,p)=>function nve(e,t,n){if(null==t.childName||null==n.childName)throw uy("Should only compare child_ events.");const r=new jn(t.childName,t.snapshotNode),i=new jn(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,c,p)),a.forEach(c=>{const p=function tve(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,c,o);i.forEach(_=>{_.respondsTo(c.type)&&t.push(_.createEvent(p,e.query_))})})}function Q1(e,t){return{eventCache:e,serverCache:t}}function Lw(e,t,n,r){return Q1(new fp(t,n,r),e.serverCache)}function G8(e,t,n,r){return Q1(e.eventCache,new fp(t,n,r))}function J1(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function hg(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let EO;class oi{constructor(t,n=(()=>(EO||(EO=new Ka(z_e)),EO))()){this.value=t,this.children=n}static fromObject(t){let n=new oi(null);return ps(t,(r,i)=>{n=n.set(new Ar(r),i)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(null!=this.value&&n(this.value))return{path:vr(),value:this.value};if(Ln(t))return null;{const r=Nn(t),i=this.children.get(r);if(null!==i){const o=i.findRootMostMatchingPathAndValue(Xr(t),n);return null!=o?{path:Ti(new Ar(r),o.path),value:o.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ln(t))return this;{const n=Nn(t),r=this.children.get(n);return null!==r?r.subtree(Xr(t)):new oi(null)}}set(t,n){if(Ln(t))return new oi(n,this.children);{const r=Nn(t),o=(this.children.get(r)||new oi(null)).set(Xr(t),n),a=this.children.insert(r,o);return new oi(this.value,a)}}remove(t){if(Ln(t))return this.children.isEmpty()?new oi(null):new oi(null,this.children);{const n=Nn(t),r=this.children.get(n);if(r){const i=r.remove(Xr(t));let o;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new oi(null):new oi(this.value,o)}return this}}get(t){if(Ln(t))return this.value;{const n=Nn(t),r=this.children.get(n);return r?r.get(Xr(t)):null}}setTree(t,n){if(Ln(t))return n;{const r=Nn(t),o=(this.children.get(r)||new oi(null)).setTree(Xr(t),n);let a;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new oi(this.value,a)}}fold(t){return this.fold_(vr(),t)}fold_(t,n){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Ti(t,i),n)}),n(t,this.value,r)}findOnPath(t,n){return this.findOnPath_(t,vr(),n)}findOnPath_(t,n,r){const i=!!this.value&&r(n,this.value);if(i)return i;if(Ln(t))return null;{const o=Nn(t),a=this.children.get(o);return a?a.findOnPath_(Xr(t),Ti(n,o),r):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,vr(),n)}foreachOnPath_(t,n,r){if(Ln(t))return this;{this.value&&r(n,this.value);const i=Nn(t),o=this.children.get(i);return o?o.foreachOnPath_(Xr(t),Ti(n,i),r):new oi(null)}}foreach(t){this.foreach_(vr(),t)}foreach_(t,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ti(t,r),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,r)=>{r.value&&t(n,r.value)})}}class pu{constructor(t){this.writeTree_=t}static empty(){return new pu(new oi(null))}}function Fw(e,t,n){if(Ln(t))return new pu(new oi(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const a=ha(i,t);return o=o.updateChild(a,n),new pu(e.writeTree_.set(i,o))}{const i=new oi(n),o=e.writeTree_.setTree(t,i);return new pu(o)}}}function CO(e,t,n){let r=e;return ps(n,(i,o)=>{r=Fw(r,Ti(t,i),o)}),r}function W8(e,t){if(Ln(t))return pu.empty();{const n=e.writeTree_.setTree(t,new oi(null));return new pu(n)}}function DO(e,t){return null!=fg(e,t)}function fg(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ha(n.path,t)):null}function Z8(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ii,(r,i)=>{t.push(new jn(r,i))}):e.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&t.push(new jn(r,i.value))}),t}function pp(e,t){if(Ln(t))return e;{const n=fg(e,t);return new pu(null!=n?new oi(n):e.writeTree_.subtree(t))}}function TO(e){return e.writeTree_.isEmpty()}function Sy(e,t){return K8(vr(),e.writeTree_,t)}function K8(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((i,o)=>{".priority"===i?(it(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=K8(Ti(e,i),o,n)}),!n.getChild(e).isEmpty()&&null!==r&&(n=n.updateChild(Ti(e,".priority"),r)),n}}function eD(e,t){return e$(t,e)}function lve(e,t){if(e.snap)return Sc(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Sc(Ti(e.path,n),t))return!0;return!1}function uve(e){return e.visible}function Y8(e,t,n){let r=pu.empty();for(let i=0;i<e.length;++i){const o=e[i];if(t(o)){const a=o.path;let c;if(o.snap)Sc(n,a)?(c=ha(n,a),r=Fw(r,c,o.snap)):Sc(a,n)&&(c=ha(a,n),r=Fw(r,vr(),o.snap.getChild(c)));else{if(!o.children)throw uy("WriteRecord should have .snap or .children");if(Sc(n,a))c=ha(n,a),r=CO(r,c,o.children);else if(Sc(a,n))if(c=ha(a,n),Ln(c))r=CO(r,vr(),o.children);else{const p=hy(o.children,Nn(c));if(p){const _=p.getChild(Xr(c));r=Fw(r,vr(),_)}}}}}return r}function X8(e,t,n,r,i){if(r||i){const o=pp(e.visibleWrites,t);return!i&&TO(o)?n:i||null!=n||DO(o,vr())?Sy(Y8(e.allWrites,function(_){return(_.visible||i)&&(!r||!~r.indexOf(_.writeId))&&(Sc(_.path,t)||Sc(t,_.path))},t),n||kn.EMPTY_NODE):null}{const o=fg(e.visibleWrites,t);if(null!=o)return o;{const a=pp(e.visibleWrites,t);return TO(a)?n:null!=n||DO(a,vr())?Sy(a,n||kn.EMPTY_NODE):null}}}function tD(e,t,n,r){return X8(e.writeTree,e.treePath,t,n,r)}function SO(e,t){return function dve(e,t,n){let r=kn.EMPTY_NODE;const i=fg(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(ii,(o,a)=>{r=r.updateImmediateChild(o,a)}),r;if(n){const o=pp(e.visibleWrites,t);return n.forEachChild(ii,(a,c)=>{const p=Sy(pp(o,new Ar(a)),c);r=r.updateImmediateChild(a,p)}),Z8(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}return Z8(pp(e.visibleWrites,t)).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}(e.writeTree,e.treePath,t)}function Q8(e,t,n,r){return function hve(e,t,n,r,i){it(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Ti(t,n);if(DO(e.visibleWrites,o))return null;{const a=pp(e.visibleWrites,o);return TO(a)?i.getChild(n):Sy(a,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function nD(e,t){return function pve(e,t){return fg(e.visibleWrites,t)}(e.writeTree,Ti(e.treePath,t))}function IO(e,t,n){return function fve(e,t,n,r){const i=Ti(t,n),o=fg(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?Sy(pp(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function J8(e,t){return e$(Ti(e.treePath,t),e.writeTree)}function e$(e,t){return{treePath:e,writeTree:t}}class yve{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,r=t.childName;it("child_added"===n||"child_changed"===n||"child_removed"===n,"Only child changes supported for tracking"),it(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if("child_added"===n&&"child_removed"===o)this.changeMap.set(r,Mw(r,t.snapshotNode,i.snapshotNode));else if("child_removed"===n&&"child_added"===o)this.changeMap.delete(r);else if("child_removed"===n&&"child_changed"===o)this.changeMap.set(r,Rw(r,i.oldSnap));else if("child_changed"===n&&"child_added"===o)this.changeMap.set(r,Cy(r,t.snapshotNode));else{if("child_changed"!==n||"child_changed"!==o)throw uy("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(r,Mw(r,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,t)}getChanges(){return Array.from(this.changeMap.values())}}const t$=new class vve{getCompleteChild(t){return null}getChildAfterChild(t,n,r){return null}};class kO{constructor(t,n,r=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const r=null!=this.optCompleteServerCache_?new fp(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return IO(this.writes_,t,r)}}getChildAfterChild(t,n,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:hg(this.viewCache_),o=function _ve(e,t,n,r,i,o){return function mve(e,t,n,r,i,o,a){let c;const p=pp(e.visibleWrites,t),_=fg(p,vr());if(null!=_)c=_;else{if(null==n)return[];c=Sy(p,n)}if(c=c.withIndex(a),c.isEmpty()||c.isLeafNode())return[];{const x=[],D=a.getCompare(),A=o?c.getReverseIteratorFrom(r,a):c.getIteratorFrom(r,a);let O=A.getNext();for(;O&&x.length<i;)0!==D(O,r)&&x.push(O),O=A.getNext();return x}}(e.writeTree,e.treePath,t,n,r,i,o)}(this.writes_,i,n,1,r,t);return 0===o.length?null:o[0]}}function n$(e,t,n,r,i,o){const a=t.eventCache;if(null!=nD(r,n))return t;{let c,p;if(Ln(n))if(it(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const _=hg(t),D=SO(r,_ instanceof kn?_:kn.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),D,o)}else{const _=tD(r,hg(t));c=e.filter.updateFullNode(t.eventCache.getNode(),_,o)}else{const _=Nn(n);if(".priority"===_){it(1===hp(n),"Can't have a priority with additional path components");const x=a.getNode();p=t.serverCache.getNode();const D=Q8(r,n,x,p);c=null!=D?e.filter.updatePriority(x,D):a.getNode()}else{const x=Xr(n);let D;if(a.isCompleteForChild(_)){p=t.serverCache.getNode();const A=Q8(r,n,a.getNode(),p);D=null!=A?a.getNode().getImmediateChild(_).updateChild(x,A):a.getNode().getImmediateChild(_)}else D=IO(r,_,t.serverCache);c=null!=D?e.filter.updateChild(a.getNode(),_,D,x,i,o):a.getNode()}}return Lw(t,c,a.isFullyInitialized()||Ln(n),e.filter.filtersNodes())}}function rD(e,t,n,r,i,o,a,c){const p=t.serverCache;let _;const x=a?e.filter:e.filter.getIndexedFilter();if(Ln(n))_=x.updateFullNode(p.getNode(),r,null);else if(x.filtersNodes()&&!p.isFiltered()){const O=p.getNode().updateChild(n,r);_=x.updateFullNode(p.getNode(),O,null)}else{const O=Nn(n);if(!p.isCompleteForPath(n)&&hp(n)>1)return t;const B=Xr(n),oe=p.getNode().getImmediateChild(O).updateChild(B,r);_=".priority"===O?x.updatePriority(p.getNode(),oe):x.updateChild(p.getNode(),O,oe,B,t$,null)}const D=G8(t,_,p.isFullyInitialized()||Ln(n),x.filtersNodes());return n$(e,D,n,i,new kO(i,D,o),c)}function AO(e,t,n,r,i,o,a){const c=t.eventCache;let p,_;const x=new kO(i,t,o);if(Ln(n))_=e.filter.updateFullNode(t.eventCache.getNode(),r,a),p=Lw(t,_,!0,e.filter.filtersNodes());else{const D=Nn(n);if(".priority"===D)_=e.filter.updatePriority(t.eventCache.getNode(),r),p=Lw(t,_,c.isFullyInitialized(),c.isFiltered());else{const A=Xr(n),O=c.getNode().getImmediateChild(D);let B;if(Ln(A))B=r;else{const Q=x.getCompleteChild(D);B=null!=Q?".priority"===sO(A)&&Q.getChild(M8(A)).isEmpty()?Q:Q.updateChild(A,r):kn.EMPTY_NODE}p=O.equals(B)?t:Lw(t,e.filter.updateChild(c.getNode(),D,B,A,x,a),c.isFullyInitialized(),e.filter.filtersNodes())}}return p}function r$(e,t){return e.eventCache.isCompleteForChild(t)}function i$(e,t,n){return n.foreach((r,i)=>{t=t.updateChild(r,i)}),t}function RO(e,t,n,r,i,o,a,c){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let _,p=t;_=Ln(n)?r:new oi(null).setTree(n,r);const x=t.serverCache.getNode();return _.children.inorderTraversal((D,A)=>{if(x.hasChild(D)){const B=i$(0,t.serverCache.getNode().getImmediateChild(D),A);p=rD(e,p,new Ar(D),B,i,o,a,c)}}),_.children.inorderTraversal((D,A)=>{const O=!t.serverCache.isCompleteForChild(D)&&null===A.value;if(!x.hasChild(D)&&!O){const Q=i$(0,t.serverCache.getNode().getImmediateChild(D),A);p=rD(e,p,new Ar(D),Q,i,o,a,c)}}),p}class Ive{constructor(t,n){this.query_=t,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new pO(r.getIndex()),o=function jye(e){return e.loadsAllData()?new pO(e.getIndex()):e.hasLimit()?new Uye(e):new Pw(e)}(r);this.processor_=function bve(e){return{filter:e}}(o);const a=n.serverCache,c=n.eventCache,p=i.updateFullNode(kn.EMPTY_NODE,a.getNode(),null),_=o.updateFullNode(kn.EMPTY_NODE,c.getNode(),null),x=new fp(p,a.isFullyInitialized(),i.filtersNodes()),D=new fp(_,c.isFullyInitialized(),o.filtersNodes());this.viewCache_=Q1(D,x),this.eventGenerator_=new Jye(this.query_)}get query(){return this.query_}}function Rve(e,t){const n=hg(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ln(t)&&!n.getImmediateChild(Nn(t)).isEmpty())?n.getChild(t):null}function o$(e){return 0===e.eventRegistrations_.length}function s$(e,t,n){const r=[];if(n){it(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(n,i);a&&r.push(a)})}if(t){let i=[];for(let o=0;o<e.eventRegistrations_.length;++o){const a=e.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(o+1));break}}else i.push(a)}e.eventRegistrations_=i}else e.eventRegistrations_=[];return r}function a$(e,t,n,r){t.type===gd.MERGE&&null!==t.source.queryId&&(it(hg(e.viewCache_),"We should always have a full cache before handling merges"),it(J1(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,o=function xve(e,t,n,r,i){const o=new yve;let a,c;if(n.type===gd.OVERWRITE){const _=n;_.source.fromUser?a=AO(e,t,_.path,_.snap,r,i,o):(it(_.source.fromServer,"Unknown source."),c=_.source.tagged||t.serverCache.isFiltered()&&!Ln(_.path),a=rD(e,t,_.path,_.snap,r,i,c,o))}else if(n.type===gd.MERGE){const _=n;_.source.fromUser?a=function Cve(e,t,n,r,i,o,a){let c=t;return r.foreach((p,_)=>{const x=Ti(n,p);r$(t,Nn(x))&&(c=AO(e,c,x,_,i,o,a))}),r.foreach((p,_)=>{const x=Ti(n,p);r$(t,Nn(x))||(c=AO(e,c,x,_,i,o,a))}),c}(e,t,_.path,_.children,r,i,o):(it(_.source.fromServer,"Unknown source."),c=_.source.tagged||t.serverCache.isFiltered(),a=RO(e,t,_.path,_.children,r,i,c,o))}else if(n.type===gd.ACK_USER_WRITE){const _=n;a=_.revert?function Sve(e,t,n,r,i,o){let a;if(null!=nD(r,n))return t;{const c=new kO(r,t,i),p=t.eventCache.getNode();let _;if(Ln(n)||".priority"===Nn(n)){let x;if(t.serverCache.isFullyInitialized())x=tD(r,hg(t));else{const D=t.serverCache.getNode();it(D instanceof kn,"serverChildren would be complete if leaf node"),x=SO(r,D)}_=e.filter.updateFullNode(p,x,o)}else{const x=Nn(n);let D=IO(r,x,t.serverCache);null==D&&t.serverCache.isCompleteForChild(x)&&(D=p.getImmediateChild(x)),_=null!=D?e.filter.updateChild(p,x,D,Xr(n),c,o):t.eventCache.getNode().hasChild(x)?e.filter.updateChild(p,x,kn.EMPTY_NODE,Xr(n),c,o):p,_.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=tD(r,hg(t)),a.isLeafNode()&&(_=e.filter.updateFullNode(_,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=nD(r,vr()),Lw(t,_,a,e.filter.filtersNodes())}}(e,t,_.path,r,i,o):function Dve(e,t,n,r,i,o,a){if(null!=nD(i,n))return t;const c=t.serverCache.isFiltered(),p=t.serverCache;if(null!=r.value){if(Ln(n)&&p.isFullyInitialized()||p.isCompleteForPath(n))return rD(e,t,n,p.getNode().getChild(n),i,o,c,a);if(Ln(n)){let _=new oi(null);return p.getNode().forEachChild(md,(x,D)=>{_=_.set(new Ar(x),D)}),RO(e,t,n,_,i,o,c,a)}return t}{let _=new oi(null);return r.foreach((x,D)=>{const A=Ti(n,x);p.isCompleteForPath(A)&&(_=_.set(x,p.getNode().getChild(A)))}),RO(e,t,n,_,i,o,c,a)}}(e,t,_.path,_.affectedTree,r,i,o)}else{if(n.type!==gd.LISTEN_COMPLETE)throw uy("Unknown operation type: "+n.type);a=function Tve(e,t,n,r,i){const o=t.serverCache;return n$(e,G8(t,o.getNode(),o.isFullyInitialized()||Ln(n),o.isFiltered()),n,r,t$,i)}(e,t,n.path,r,o)}const p=o.getChanges();return function Eve(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=J1(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(j8(J1(t)))}}(t,a,p),{viewCache:a,changes:p}}(e.processor_,i,t,n,r);return function wve(e,t){it(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),it(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}(e.processor_,o.viewCache),it(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,l$(e,o.changes,o.viewCache.eventCache.getNode(),null)}function l$(e,t,n,r){return function eve(e,t,n,r){const i=[],o=[];return t.forEach(a=>{"child_changed"===a.type&&e.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(function zye(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}(a.childName,a.snapshotNode))}),Nw(e,i,"child_removed",t,r,n),Nw(e,i,"child_added",t,r,n),Nw(e,i,"child_moved",o,r,n),Nw(e,i,"child_changed",t,r,n),Nw(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,r?[r]:e.eventRegistrations_)}let iD,sD;class c${constructor(){this.views=new Map}}function MO(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return it(null!=o,"SyncTree gave us an op for an invalid query."),a$(o,t,n,r)}{let o=[];for(const a of e.views.values())o=o.concat(a$(a,t,n,r));return o}}function u$(e,t,n,r,i){const a=e.views.get(t._queryIdentifier);if(!a){let c=tD(n,i?r:null),p=!1;c?p=!0:r instanceof kn?(c=SO(n,r),p=!1):(c=kn.EMPTY_NODE,p=!1);const _=Q1(new fp(c,p,!1),new fp(r,i,!1));return new Ive(t,_)}return a}function d$(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function mp(e,t){let n=null;for(const r of e.views.values())n=n||Rve(r,t);return n}function h$(e,t){return t._queryParams.loadsAllData()?oD(e):e.views.get(t._queryIdentifier)}function f$(e,t){return null!=h$(e,t)}function gp(e){return null!=oD(e)}function oD(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Uve=1;class p${constructor(t){this.listenProvider_=t,this.syncPointTree_=new oi(null),this.pendingWriteTree_=function gve(){return{visibleWrites:pu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function PO(e,t,n,r,i){return function ive(e,t,n,r,i){it(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Fw(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Iy(e,new dg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function _p(e,t,n=!1){const r=function sve(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function ave(e,t){const n=e.allWrites.findIndex(c=>c.writeId===t);it(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const c=e.allWrites[a];c.visible&&(a>=n&&lve(c,r.path)?i=!1:Sc(r.path,c.path)&&(o=!0)),a--}return!!i&&(o?(function cve(e){e.visibleWrites=Y8(e.allWrites,uve,vr()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=W8(e.visibleWrites,r.path):ps(r.children,p=>{e.visibleWrites=W8(e.visibleWrites,Ti(r.path,p))}),!0))}(e.pendingWriteTree_,t)){let o=new oi(null);return null!=r.snap?o=o.set(vr(),!0):ps(r.children,a=>{o=o.set(new Ar(a),!0)}),Iy(e,new X1(r.path,o,n))}return[]}function Bw(e,t,n){return Iy(e,new dg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function aD(e,t,n,r,i=!1){const o=t._path,a=e.syncPointTree_.get(o);let c=[];if(a&&("default"===t._queryIdentifier||f$(a,t))){const p=function Bve(e,t,n,r){const i=t._queryIdentifier,o=[];let a=[];const c=gp(e);if("default"===i)for(const[p,_]of e.views.entries())a=a.concat(s$(_,n,r)),o$(_)&&(e.views.delete(p),_.query._queryParams.loadsAllData()||o.push(_.query));else{const p=e.views.get(i);p&&(a=a.concat(s$(p,n,r)),o$(p)&&(e.views.delete(i),p.query._queryParams.loadsAllData()||o.push(p.query)))}return c&&!gp(e)&&o.push(new(function Nve(){return it(iD,"Reference.ts has not been loaded"),iD}())(t._repo,t._path)),{removed:o,events:a}}(a,t,n,r);(function Lve(e){return 0===e.views.size})(a)&&(e.syncPointTree_=e.syncPointTree_.remove(o));const _=p.removed;if(c=p.events,!i){const x=-1!==_.findIndex(A=>A._queryParams.loadsAllData()),D=e.syncPointTree_.findOnPath(o,(A,O)=>gp(O));if(x&&!D){const A=e.syncPointTree_.subtree(o);if(!A.isEmpty()){const O=function Zve(e){return e.fold((t,n,r)=>{if(n&&gp(n))return[oD(n)];{let i=[];return n&&(i=d$(n)),ps(r,(o,a)=>{i=i.concat(a)}),i}})}(A);for(let B=0;B<O.length;++B){const Q=O[B],oe=Q.query,ye=y$(e,Q);e.listenProvider_.startListening(zw(oe),Vw(e,oe),ye.hashFn,ye.onComplete)}}}!D&&_.length>0&&!r&&(x?e.listenProvider_.stopListening(zw(t),null):_.forEach(A=>{const O=e.queryToTagMap.get(cD(A));e.listenProvider_.stopListening(zw(A),O)}))}!function Kve(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const i=cD(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,_)}return c}function m$(e,t,n,r){const i=NO(e,r);if(null!=i){const o=LO(i),a=o.path,c=o.queryId,p=ha(a,t);return FO(e,a,new dg(xO(c),p,n))}return[]}function OO(e,t,n,r=!1){const i=t._path;let o=null,a=!1;e.syncPointTree_.foreachOnPath(i,(A,O)=>{const B=ha(A,i);o=o||mp(O,B),a=a||gp(O)});let p,c=e.syncPointTree_.get(i);c?(a=a||gp(c),o=o||mp(c,vr())):(c=new c$,e.syncPointTree_=e.syncPointTree_.set(i,c)),null!=o?p=!0:(p=!1,o=kn.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((O,B)=>{const Q=mp(B,vr());Q&&(o=o.updateImmediateChild(O,Q))}));const _=f$(c,t);if(!_&&!t._queryParams.loadsAllData()){const A=cD(t);it(!e.queryToTagMap.has(A),"View does not exist, but we have a tag");const O=function Yve(){return Uve++}();e.queryToTagMap.set(A,O),e.tagToQueryMap.set(O,A)}let D=function Fve(e,t,n,r,i,o){const a=u$(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function Mve(e,t){e.eventRegistrations_.push(t)}(a,n),function Pve(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ii,(o,a)=>{r.push(Cy(o,a))}),n.isFullyInitialized()&&r.push(j8(n.getNode())),l$(e,r,n.getNode(),t)}(a,n)}(c,t,n,eD(e.pendingWriteTree_,i),o,p);if(!_&&!a&&!r){const A=h$(c,t);D=D.concat(function Xve(e,t,n){const r=t._path,i=Vw(e,t),o=y$(e,n),a=e.listenProvider_.startListening(zw(t),i,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(r);if(i)it(!gp(c.value),"If we're adding a query, it shouldn't be shadowed");else{const p=c.fold((_,x,D)=>{if(!Ln(_)&&x&&gp(x))return[oD(x).query];{let A=[];return x&&(A=A.concat(d$(x).map(O=>O.query))),ps(D,(O,B)=>{A=A.concat(B)}),A}});for(let _=0;_<p.length;++_){const x=p[_];e.listenProvider_.stopListening(zw(x),Vw(e,x))}}return a}(e,t,A))}return D}function lD(e,t,n){const i=e.pendingWriteTree_,o=e.syncPointTree_.findOnPath(t,(a,c)=>{const _=mp(c,ha(a,t));if(_)return _});return X8(i,t,o,n,!0)}function Iy(e,t){return g$(t,e.syncPointTree_,null,eD(e.pendingWriteTree_,vr()))}function g$(e,t,n,r){if(Ln(e.path))return _$(e,t,n,r);{const i=t.get(vr());null==n&&null!=i&&(n=mp(i,vr()));let o=[];const a=Nn(e.path),c=e.operationForChild(a),p=t.children.get(a);if(p&&c){const _=n?n.getImmediateChild(a):null,x=J8(r,a);o=o.concat(g$(c,p,_,x))}return i&&(o=o.concat(MO(i,e,r,n))),o}}function _$(e,t,n,r){const i=t.get(vr());null==n&&null!=i&&(n=mp(i,vr()));let o=[];return t.children.inorderTraversal((a,c)=>{const p=n?n.getImmediateChild(a):null,_=J8(r,a),x=e.operationForChild(a);x&&(o=o.concat(_$(x,c,p,_)))}),i&&(o=o.concat(MO(i,e,r,n))),o}function y$(e,t){const n=t.query,r=Vw(e,n);return{hashFn:()=>(function kve(e){return e.viewCache_.serverCache.getNode()}(t)||kn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function qve(e,t,n){const r=NO(e,n);if(r){const i=LO(r),o=i.path,a=i.queryId,c=ha(o,t);return FO(e,o,new Ow(xO(a),c))}return[]}(e,n._path,r):function $ve(e,t){return Iy(e,new Ow({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const o=function H_e(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(i,n);return aD(e,n,null,o)}}}}function Vw(e,t){const n=cD(t);return e.queryToTagMap.get(n)}function cD(e){return e._path.toString()+"$"+e._queryIdentifier}function NO(e,t){return e.tagToQueryMap.get(t)}function LO(e){const t=e.indexOf("$");return it(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ar(e.substr(0,t))}}function FO(e,t,n){const r=e.syncPointTree_.get(t);return it(r,"Missing sync point for query tag that we're tracking"),MO(r,n,eD(e.pendingWriteTree_,t),null)}function zw(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(function zve(){return it(sD,"Reference.ts has not been loaded"),sD}())(e._repo,e._path):e}class BO{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new BO(n)}node(){return this.node_}}class VO{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=Ti(this.path_,t);return new VO(this.syncTree_,n)}node(){return lD(this.syncTree_,this.path_)}}const v$=function(e,t,n){return e&&"object"==typeof e?(it(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Jve(e[".sv"],t,n):"object"==typeof e[".sv"]?ebe(e[".sv"],t):void it(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Jve=function(e,t,n){if("timestamp"===e)return n.timestamp;it(!1,"Unexpected server value: "+e)},ebe=function(e,t,n){e.hasOwnProperty("increment")||it(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&it(!1,"Unexpected increment value: "+r);const i=t.node();if(it(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const a=i.getValue();return"number"!=typeof a?r:a+r},b$=function(e,t,n,r){return UO(t,new VO(n,e),r)},zO=function(e,t,n){return UO(e,new BO(t),n)};function UO(e,t,n){const r=e.getPriority().val(),i=v$(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const a=e,c=v$(a.getValue(),t,n);return c!==a.getValue()||i!==a.getPriority().val()?new xy(c,$i(i)):e}{const a=e;return o=a,i!==a.getPriority().val()&&(o=o.updatePriority(new xy(i))),a.forEachChild(ii,(c,p)=>{const _=UO(p,t.getImmediateChild(c),n);_!==p&&(o=o.updateImmediateChild(c,_))}),o}}class jO{constructor(t="",n=null,r={children:{},childCount:0}){this.name=t,this.parent=n,this.node=r}}function uD(e,t){let n=t instanceof Ar?t:new Ar(t),r=e,i=Nn(n);for(;null!==i;){const o=hy(r.node.children,i)||{children:{},childCount:0};r=new jO(i,r,o),n=Xr(n),i=Nn(n)}return r}function pg(e){return e.node.value}function HO(e,t){e.node.value=t,$O(e)}function w$(e){return e.node.childCount>0}function dD(e,t){ps(e.node.children,(n,r)=>{t(new jO(n,e,r))})}function x$(e,t,n,r){n&&!r&&t(e),dD(e,i=>{x$(i,t,!0,r)}),n&&r&&t(e)}function Uw(e){return new Ar(null===e.parent?e.name:Uw(e.parent)+"/"+e.name)}function $O(e){null!==e.parent&&function rbe(e,t,n){const r=function tbe(e){return void 0===pg(e)&&!w$(e)}(n),i=hd(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,$O(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,$O(e))}(e.parent,e.name,e)}const ibe=/[\[\].#$\/\u0000-\u001F\u007F]/,obe=/[\[\].#$\u0000-\u001F\u007F]/,qO=10485760,hD=function(e){return"string"==typeof e&&0!==e.length&&!ibe.test(e)},E$=function(e){return"string"==typeof e&&0!==e.length&&!obe.test(e)},_d=function(e,t,n,r){r&&void 0===t||Hw(Jm(e,"value"),t,n)},Hw=function(e,t,n){const r=n instanceof Ar?new xye(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+cg(r));if("function"==typeof t)throw new Error(e+"contains a function "+cg(r)+" with contents = "+t.toString());if(z1(t))throw new Error(e+"contains "+t.toString()+" "+cg(r));if("string"==typeof t&&t.length>qO/3&&y1(t)>qO)throw new Error(e+"contains a string greater than "+qO+" utf8 bytes "+cg(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let i=!1,o=!1;if(ps(t,(a,c)=>{if(".value"===a)i=!0;else if(".priority"!==a&&".sv"!==a&&(o=!0,!hD(a)))throw new Error(e+" contains an invalid key ("+a+") "+cg(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Eye(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=y1(t),P8(e)})(r,a),Hw(e,c,r),function Cye(e){const t=e.parts_.pop();e.byteLength_-=y1(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)}),i&&o)throw new Error(e+' contains ".value" child '+cg(r)+" in addition to actual children.")}},C$=function(e,t,n,r){if(r&&void 0===t)return;const i=Jm(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const o=[];ps(t,(a,c)=>{const p=new Ar(a);if(Hw(i,c,Ti(n,p)),".priority"===sO(p)&&!function(e){return null===e||"string"==typeof e||"number"==typeof e&&!z1(e)||e&&"object"==typeof e&&hd(e,".sv")}(c))throw new Error(i+"contains an invalid value for '"+p.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(p)}),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const o=Sw(r);for(let a=0;a<o.length;a++)if((".priority"!==o[a]||a!==o.length-1)&&!hD(o[a]))throw new Error(e+"contains an invalid key ("+o[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(wye);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Sc(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,o)},WO=function(e,t,n,r){if(!(r&&void 0===n||E$(n)))throw new Error(Jm(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},yd=function(e,t){if(".info"===Nn(t))throw new Error(e+" failed = Can't modify data under /.info/")};class cbe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function fD(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null!==n&&!aO(o,n.path)&&(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function T$(e,t,n){fD(e,n),S$(e,r=>aO(r,t))}function kl(e,t,n){fD(e,n),S$(e,r=>Sc(r,t)||Sc(t,r))}function S$(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(ube(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function ube(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();ag&&fs("event: "+n.toString()),by(r)}}}class hbe{constructor(t,n,r,i){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new cbe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Y1(),this.transactionQueueTree_=new jO,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function k$(e){const n=e.infoData_.getNode(new Ar(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+n}function qw(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:k$(e)})}function A$(e,t,n,r,i){e.dataUpdateCount++;const o=new Ar(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let a=[];if(i)if(r){const p=g1(n,_=>$i(_));a=function Gve(e,t,n,r){const i=NO(e,r);if(i){const o=LO(i),a=o.path,c=o.queryId,p=ha(a,t),_=oi.fromObject(n);return FO(e,a,new Ty(xO(c),p,_))}return[]}(e.serverSyncTree_,o,p,i)}else{const p=$i(n);a=m$(e.serverSyncTree_,o,p,i)}else if(r){const p=g1(n,_=>$i(_));a=function Hve(e,t,n){const r=oi.fromObject(n);return Iy(e,new Ty({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,p)}else{const p=$i(n);a=Bw(e.serverSyncTree_,o,p)}let c=o;a.length>0&&(c=Ay(e,o)),kl(e.eventQueue_,c,a)}function R$(e,t){ZO(e,"connected",t),!1===t&&function _be(e){ky(e,"onDisconnectEvents");const t=qw(e),n=Y1();vO(e.onDisconnect_,vr(),(i,o)=>{const a=b$(i,o,e.serverSyncTree_,t);Dy(n,i,a)});let r=[];vO(n,vr(),(i,o)=>{r=r.concat(Bw(e.serverSyncTree_,i,o));const a=QO(e,i);Ay(e,a)}),e.onDisconnect_=Y1(),kl(e.eventQueue_,vr(),r)}(e)}function ZO(e,t,n){const r=new Ar("/.info/"+t),i=$i(n);e.infoData_.updateSnapshot(r,i);const o=Bw(e.infoSyncTree_,r,i);kl(e.eventQueue_,r,o)}function pD(e){return e.nextWriteId_++}function YO(e,t,n){let r;r=".info"===Nn(t._path)?aD(e.infoSyncTree_,t,n):aD(e.serverSyncTree_,t,n),T$(e.eventQueue_,t._path,r)}function ky(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),fs(n,...t)}function yp(e,t,n,r){t&&by(()=>{if("ok"===n)t(null);else{const i=(n||"error").toUpperCase();let o=i;r&&(o+=": "+r);const a=new Error(o);a.code=i,t(a)}})}function XO(e,t,n){return lD(e.serverSyncTree_,t,n)||kn.EMPTY_NODE}function mD(e,t=e.transactionQueueTree_){if(t||gD(e,t),pg(t)){const n=N$(e,t);it(n.length>0,"Sending zero length transaction queue"),n.every(i=>0===i.status)&&function Cbe(e,t,n){const r=n.map(_=>_.currentWriteId),i=XO(e,t,r);let o=i;const a=i.hash();for(let _=0;_<n.length;_++){const x=n[_];it(0===x.status,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const D=ha(t,x.path);o=o.updateChild(D,x.currentOutputSnapshotRaw)}const c=o.val(!0),p=t;e.server_.put(p.toString(),c,_=>{ky(e,"transaction put response",{path:p.toString(),status:_});let x=[];if("ok"===_){const D=[];for(let A=0;A<n.length;A++)n[A].status=2,x=x.concat(_p(e.serverSyncTree_,n[A].currentWriteId)),n[A].onComplete&&D.push(()=>n[A].onComplete(null,!0,n[A].currentOutputSnapshotResolved)),n[A].unwatcher();gD(e,uD(e.transactionQueueTree_,t)),mD(e,e.transactionQueueTree_),kl(e.eventQueue_,t,x);for(let A=0;A<D.length;A++)by(D[A])}else{if("datastale"===_)for(let D=0;D<n.length;D++)n[D].status=3===n[D].status?4:0;else{qs("transaction at "+p.toString()+" failed: "+_);for(let D=0;D<n.length;D++)n[D].status=4,n[D].abortReason=_}Ay(e,t)}},a)}(e,Uw(t),n)}else w$(t)&&dD(t,n=>{mD(e,n)})}function Ay(e,t){const n=O$(e,t),r=Uw(n);return function Dbe(e,t,n){if(0===t.length)return;const r=[];let i=[];const a=t.filter(c=>0===c.status).map(c=>c.currentWriteId);for(let c=0;c<t.length;c++){const p=t[c],_=ha(n,p.path);let D,x=!1;if(it(null!==_,"rerunTransactionsUnderNode_: relativePath should not be null."),4===p.status)x=!0,D=p.abortReason,i=i.concat(_p(e.serverSyncTree_,p.currentWriteId,!0));else if(0===p.status)if(p.retryCount>=25)x=!0,D="maxretry",i=i.concat(_p(e.serverSyncTree_,p.currentWriteId,!0));else{const A=XO(e,p.path,a);p.currentInputSnapshot=A;const O=t[c].update(A.val());if(void 0!==O){Hw("transaction failed: Data returned ",O,p.path);let B=$i(O);"object"==typeof O&&null!=O&&hd(O,".priority")||(B=B.updatePriority(A.getPriority()));const oe=p.currentWriteId,ye=qw(e),xe=zO(B,A,ye);p.currentOutputSnapshotRaw=B,p.currentOutputSnapshotResolved=xe,p.currentWriteId=pD(e),a.splice(a.indexOf(oe),1),i=i.concat(PO(e.serverSyncTree_,p.path,xe,p.currentWriteId,p.applyLocally)),i=i.concat(_p(e.serverSyncTree_,oe,!0))}else x=!0,D="nodata",i=i.concat(_p(e.serverSyncTree_,p.currentWriteId,!0))}kl(e.eventQueue_,n,i),i=[],x&&(t[c].status=2,function(A){setTimeout(A,Math.floor(0))}(t[c].unwatcher),t[c].onComplete&&r.push("nodata"===D?()=>t[c].onComplete(null,!1,t[c].currentInputSnapshot):()=>t[c].onComplete(new Error(D),!1,null)))}gD(e,e.transactionQueueTree_);for(let c=0;c<r.length;c++)by(r[c]);mD(e,e.transactionQueueTree_)}(e,N$(e,n),r),r}function O$(e,t){let n,r=e.transactionQueueTree_;for(n=Nn(t);null!==n&&void 0===pg(r);)r=uD(r,n),n=Nn(t=Xr(t));return r}function N$(e,t){const n=[];return L$(e,t,n),n.sort((r,i)=>r.order-i.order),n}function L$(e,t,n){const r=pg(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);dD(t,i=>{L$(e,i,n)})}function gD(e,t){const n=pg(t);if(n){let r=0;for(let i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,HO(t,n.length>0?n:void 0)}dD(t,r=>{gD(e,r)})}function QO(e,t){const n=Uw(O$(e,t)),r=uD(e.transactionQueueTree_,t);return function nbe(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,i=>{JO(e,i)}),JO(e,r),x$(r,i=>{JO(e,i)}),n}function JO(e,t){const n=pg(t);if(n){const r=[];let i=[],o=-1;for(let a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(it(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):(it(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat(_p(e.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?HO(t,void 0):n.length=o+1,kl(e.eventQueue_,Uw(t),i);for(let a=0;a<r.length;a++)by(r[a])}}const eN=function(e,t){const n=Ibe(e),r=n.namespace;return"firebase.com"===n.domain&&pd(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&pd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&qs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new eO(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,t,"",r!==n.subdomain),path:new Ar(n.pathString)}},Ibe=function(e){let t="",n="",r="",i="",o="",a=!0,c="https",p=443;if("string"==typeof e){let _=e.indexOf("//");_>=0&&(c=e.substring(0,_-1),e=e.substring(_+2));let x=e.indexOf("/");-1===x&&(x=e.length);let D=e.indexOf("?");-1===D&&(D=e.length),t=e.substring(0,Math.min(x,D)),x<D&&(i=function Tbe(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}t+="/"+i}return t}(e.substring(x,D)));const A=function Sbe(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):qs(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,D)));_=t.indexOf(":"),_>=0?(a="https"===c||"wss"===c,p=parseInt(t.substring(_+1),10)):_=t.length;const O=t.slice(0,_);if("localhost"===O.toLowerCase())n="localhost";else if(O.split(".").length<=2)n=O;else{const B=t.indexOf(".");r=t.substring(0,B).toLowerCase(),n=t.substring(B+1),o=r}"ns"in A&&(o=A.ns)}return{host:t,port:p,domain:n,subdomain:r,secure:a,scheme:c,pathString:i,namespace:o}},F$="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",kbe=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const o=new Array(8);for(i=7;i>=0;i--)o[i]=F$.charAt(n%64),n=Math.floor(n/64);it(0===n,"Cannot push at time == 0");let a=o.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=F$.charAt(t[i]);return it(20===a.length,"nextPushId: Length should be 20."),a}}();class B${constructor(t,n,r,i){this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ko(this.snapshot.exportVal())}}class V${constructor(t,n,r){this.eventRegistration=t,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class tN{constructor(t,n){this.snapshotCallback=t,this.cancelCallback=n}onValue(t,n){this.snapshotCallback.call(null,t,n)}onCancel(t){return it(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class Al{constructor(t,n,r,i){this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return Ln(this._path)?null:sO(this._path)}get ref(){return new mu(this._repo,this._path)}get _queryIdentifier(){const t=$8(this._queryParams),n=QP(t);return"{}"===n?"default":n}get _queryObject(){return $8(this._queryParams)}isEqual(t){if(!((t=Fo(t))instanceof Al))return!1;const n=this._repo===t._repo,r=aO(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function bye(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class mu extends Al{constructor(t,n){super(t,n,new mO,!1)}get parent(){const t=M8(this._path);return null===t?null:new mu(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class mg{constructor(t,n,r){this._node=t,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const n=new Ar(t),r=Ry(this.ref,t);return new mg(this._node.getChild(n),r,ii)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>t(new mg(i,Ry(this.ref,r),ii)))}hasChild(t){const n=new Ar(t);return!this._node.getChild(n).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ro(e,t){return(e=Fo(e))._checkNotDeleted("ref"),void 0!==t?Ry(e._root,t):e._root}function Ry(e,t){return null===Nn((e=Fo(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),WO("child","path",n,!1)):WO("child","path",t,!1),new mu(e._repo,Ti(e._path,t));var n}function z$(e){return yd("remove",e._path),Vh(e,null)}function Vh(e,t){e=Fo(e),yd("set",e._path),_d("set",t,e._path,!1);const n=new dy;return function KO(e,t,n,r,i){ky(e,"set",{path:t.toString(),value:n,priority:r});const o=qw(e),a=$i(n,r),c=lD(e.serverSyncTree_,t),p=zO(a,c,o),_=pD(e),x=PO(e.serverSyncTree_,t,p,_,!0);fD(e.eventQueue_,x),e.server_.put(t.toString(),a.val(!0),(A,O)=>{const B="ok"===A;B||qs("set at "+t+" failed: "+A);const Q=_p(e.serverSyncTree_,_,!B);kl(e.eventQueue_,t,Q),yp(0,i,A,O)});const D=QO(e,t);Ay(e,D),kl(e.eventQueue_,D,[])}(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function U$(e,t){C$("update",t,e._path,!1);const n=new dy;return function gbe(e,t,n,r){ky(e,"update",{path:t.toString(),value:n});let i=!0;const o=qw(e),a={};if(ps(n,(c,p)=>{i=!1,a[c]=b$(Ti(t,c),$i(p),e.serverSyncTree_,o)}),i)fs("update() called with empty data.  Don't do anything."),yp(0,r,"ok",void 0);else{const c=pD(e),p=function jve(e,t,n,r){!function ove(e,t,n,r){it(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=CO(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=oi.fromObject(n);return Iy(e,new Ty({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,t,a,c);fD(e.eventQueue_,p),e.server_.merge(t.toString(),n,(_,x)=>{const D="ok"===_;D||qs("update at "+t+" failed: "+_);const A=_p(e.serverSyncTree_,c,!D),O=A.length>0?Ay(e,t):t;kl(e.eventQueue_,O,A),yp(0,r,_,x)}),ps(n,_=>{const x=QO(e,Ti(t,_));Ay(e,x)}),kl(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function bp(e){e=Fo(e);const t=new tN(()=>{}),n=new Gw(t);return function mbe(e,t,n){const r=function Wve(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,(_,x)=>{const D=ha(_,n);r=r||mp(x,D)});let i=e.syncPointTree_.get(n);i?r=r||mp(i,vr()):(i=new c$,e.syncPointTree_=e.syncPointTree_.set(n,i));const o=null!=r,a=o?new fp(r,!0,!1):null;return function Ave(e){return J1(e.viewCache_)}(u$(i,t,eD(e.pendingWriteTree_,t._path),o?a.getNode():kn.EMPTY_NODE,o))}(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then(i=>{const o=$i(i).withIndex(t._queryParams.getIndex());let a;if(OO(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())a=Bw(e.serverSyncTree_,t._path,o);else{const c=Vw(e.serverSyncTree_,t);a=m$(e.serverSyncTree_,t._path,o,c)}return kl(e.eventQueue_,t._path,a),aD(e.serverSyncTree_,t,n,null,!0),o},i=>(ky(e,"get for query "+Ko(t)+" failed: "+i),Promise.reject(new Error(i))))}(e._repo,e,n).then(r=>new mg(r,new mu(e._repo,e._path),e._queryParams.getIndex()))}class Gw{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,n){const r=n._queryParams.getIndex();return new B$("value",this,new mg(t.snapshotNode,new mu(n._repo,n._path),r))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new V$(this,t,n):null}matches(t){return t instanceof Gw&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class vD{constructor(t,n){this.eventType=t,this.callbackContext=n}respondsTo(t){let n="children_added"===t?"child_added":t;return n="children_removed"===n?"child_removed":n,this.eventType===n}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new V$(this,t,n):null}createEvent(t,n){it(null!=t.childName,"Child events should have a childName.");const r=Ry(new mu(n._repo,n._path),t.childName),i=n._queryParams.getIndex();return new B$(t.type,this,new mg(t.snapshotNode,r,i),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof vD&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Zw(e,t,n,r){return function Ww(e,t,n,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const p=n,_=(x,D)=>{YO(e._repo,e,c),p(x,D)};_.userCallback=n.userCallback,_.context=n.context,n=_}const a=new tN(n,o||void 0),c="value"===t?new Gw(a):new vD(t,a);return function wbe(e,t,n){let r;r=".info"===Nn(t._path)?OO(e.infoSyncTree_,t,n):OO(e.serverSyncTree_,t,n),T$(e.eventQueue_,t._path,r)}(e._repo,e,c),()=>YO(e._repo,e,c)}(e,"value",t,n,r)}(function Ove(e){it(!iD,"__referenceConstructor has already been defined"),iD=e})(mu),function Vve(e){it(!sD,"__referenceConstructor has already been defined"),sD=e}(mu);const nN={};function q$(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||pd("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),fs("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let p,_,a=eN(o,i),c=a.repoInfo;typeof process<"u"&&process.env&&(_=process.env.FIREBASE_DATABASE_EMULATOR_HOST),_?(p=!0,o=`http://${_}?ns=${c.namespace}`,a=eN(o,i),c=a.repoInfo):p=!a.repoInfo.secure;const x=i&&p?new Tw(Tw.OWNER):new K_e(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!hD(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),E$(e)}(n))throw new Error(Jm(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),Ln(a.path)||pd("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function $be(e,t,n,r){let i=nN[t.name];i||(i={},nN[t.name]=i);let o=i[e.toURLString()];return o&&pd("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new hbe(e,false,n,r),i[e.toURLString()]=o,o}(c,e,x,new Z_e(e.name,n));return new Gbe(D,e)}class Gbe{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function fbe(e,t,n){if(e.stats_=rO(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new K1(e.repoInfo_,(r,i,o,a)=>{A$(e,r,i,o,a)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>R$(e,!0),0);else{if(typeof n<"u"&&null!==n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ko(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new ug(e.repoInfo_,t,(r,i,o,a)=>{A$(e,r,i,o,a)},r=>{R$(e,r)},r=>{!function pbe(e,t){ps(t,(n,r)=>{ZO(e,n,r)})}(e,r)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(r=>{e.server_.refreshAuthToken(r)}),e.appCheckProvider_.addTokenChangeListener(r=>{e.server_.refreshAppCheckToken(r.token)}),e.statsReporter_=function Q_e(e,t){const n=e.toString();return nO[n]||(nO[n]=t()),nO[n]}(e.repoInfo_,()=>new Qye(e.stats_,e.server_)),e.infoData_=new Wye,e.infoSyncTree_=new p$({startListening:(r,i,o,a)=>{let c=[];const p=e.infoData_.getNode(r._path);return p.isEmpty()||(c=Bw(e.infoSyncTree_,r._path,p),setTimeout(()=>{a("ok")},0)),c},stopListening:()=>{}}),ZO(e,"connected",!1),e.serverSyncTree_=new p$({startListening:(r,i,o,a)=>(e.server_.listen(r,o,i,(c,p)=>{const _=a(c,p);kl(e.eventQueue_,r._path,_)}),[]),stopListening:(r,i)=>{e.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mu(this._repo,vr())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Hbe(e,t){const n=nN[t];(!n||n[e.key]!==e)&&pd(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function P$(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&pd("Cannot call "+t+" on a deleted database.")}}ug.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},ug.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},function Kbe(e){(function K6(e){KP=e})(rg),ng(new ap("database",(t,{instanceIdentifier:n})=>q$(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),n),"PUBLIC").setMultipleInstances(!0)),hu(W6,"1.0.8",e),hu(W6,"1.0.8","esm2017")}();const W$="firebasestorage.googleapis.com",Z$="storageBucket";class qi extends Sh{constructor(t,n,r=0){super(rN(t),`Firebase Storage: ${n} (${rN(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,qi.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return rN(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Si=function(e){return e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment",e}(Si||{});function rN(e){return"storage/"+e}function iN(){return new qi(Si.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function oN(e){return new qi(Si.INVALID_ARGUMENT,e)}function Q$(){return new qi(Si.APP_DELETED,"The Firebase app was deleted.")}function Kw(e,t){return new qi(Si.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Yw(e){throw new qi(Si.INTERNAL_ERROR,"Internal error: "+e)}class fa{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let r;try{r=fa.makeFromUrl(t,n)}catch{return new fa(t,"")}if(""===r.path)return r;throw function awe(e){return new qi(Si.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}(t)}static makeFromUrl(t,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+i+"(/(.*))?$","i");function _(De){De.path_=decodeURIComponent(De.path)}const D=n.replace(/[.]/g,"\\."),$e=[{regex:c,indices:{bucket:1,path:3},postModify:function o(De){"/"===De.path.charAt(De.path.length-1)&&(De.path_=De.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${D}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:_},{regex:new RegExp(`^https?://${n===W$?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:_}];for(let De=0;De<$e.length;De++){const ve=$e[De],Fe=ve.regex.exec(t);if(Fe){let dt=Fe[ve.indices.path];dt||(dt=""),r=new fa(Fe[ve.indices.bucket],dt),ve.postModify(r);break}}if(null==r)throw function swe(e){return new qi(Si.INVALID_URL,"Invalid URL '"+e+"'.")}(t);return r}}class fwe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function bD(e){return"string"==typeof e||e instanceof String}function J$(e){return sN()&&e instanceof Blob}function sN(){return typeof Blob<"u"}function aN(e,t,n,r){if(r<t)throw oN(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw oN(`Invalid value for '${e}'. Expected ${n} or less.`)}function zh(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function eq(e){const t=encodeURIComponent;let n="?";for(const r in e)e.hasOwnProperty(r)&&(n=n+(t(r)+"=")+t(e[r])+"&");return n=n.slice(0,-1),n}var My=function(e){return e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT",e}(My||{});class vwe{constructor(t,n,r,i,o,a,c,p,_,x,D,A=!0){this.url_=t,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=p,this.timeout_=_,this.progressCallback_=x,this.connectionFactory_=D,this.retry=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((O,B)=>{this.resolve_=O,this.reject_=B,this.start_()})}start_(){const n=(r,i)=>{const o=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const p=this.callback_(c,c.getResponse());!function gwe(e){return void 0!==e}(p)?o():o(p)}catch(p){a(p)}else if(null!==c){const p=iN();p.serverResponse=c.getErrorText(),a(this.errorCallback_?this.errorCallback_(c,p):p)}else a(i.canceled?this.appDelete_?Q$():function Y$(){return new qi(Si.CANCELED,"User canceled the upload/download.")}():function K$(){return new qi(Si.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?n(0,new wD(!1,null,!0)):this.backoffId_=function pwe(e,t,n){let r=1,i=null,o=null,a=!1,c=0;function p(){return 2===c}let _=!1;function x(...oe){_||(_=!0,t.apply(null,oe))}function D(oe){i=setTimeout(()=>{i=null,e(O,p())},oe)}function A(){o&&clearTimeout(o)}function O(oe,...ye){if(_)return void A();if(oe)return A(),void x.call(null,oe,...ye);if(p()||a)return A(),void x.call(null,oe,...ye);let $e;r<64&&(r*=2),1===c?(c=2,$e=0):$e=1e3*(r+Math.random()),D($e)}let B=!1;function Q(oe){B||(B=!0,A(),!_&&(null!==i?(oe||(c=2),clearTimeout(i),D(0)):oe||(c=1)))}return D(0),o=setTimeout(()=>{a=!0,Q(!0)},n),Q}((r,i)=>{if(i)return void r(!1,new wD(!1,null,!0));const o=this.connectionFactory_();this.pendingConnection_=o;const a=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const c=o.getErrorCode()===My.NO_ERROR,p=o.getStatus();if(!c||function tq(e,t){const n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),o=-1!==t.indexOf(e);return n||i||o}(p,this.additionalRetryCodes_)&&this.retry){const x=o.getErrorCode()===My.ABORT;return void r(!1,new wD(!1,null,x))}const _=-1!==this.successCodes_.indexOf(p);r(!0,new wD(_,o))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function mwe(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class wD{constructor(t,n,r){this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}}function Twe(...e){const t=function Dwe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==t){const n=new t;for(let r=0;r<e.length;r++)n.append(e[r]);return n.getBlob()}if(sN())return new Blob(e);throw new qi(Si.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}class lN{constructor(t,n){this.data=t,this.contentType=n||null}}function rq(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function iq(e,t){switch(e){case"base64":{const i=-1!==t.indexOf("-"),o=-1!==t.indexOf("_");if(i||o)throw Kw(e,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case"base64url":{const i=-1!==t.indexOf("+"),o=-1!==t.indexOf("/");if(i||o)throw Kw(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function Iwe(e){if(typeof atob>"u")throw function dwe(e){return new qi(Si.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(e)}(t)}catch(i){throw i.message.includes("polyfill")?i:Kw(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class oq{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(null===n)throw Kw("data_url","Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function Mwe(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}class Uh{constructor(t,n){let r=0,i="";J$(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,n){if(J$(this.data_)){const i=function Swe(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===i?null:new Uh(i)}{const r=new Uint8Array(this.data_.buffer,t,n-t);return new Uh(r,!0)}}static getBlob(...t){if(sN()){const n=t.map(r=>r instanceof Uh?r.data_:r);return new Uh(Twe.apply(null,n))}{const n=t.map(a=>bD(a)?function nq(e,t){switch(e){case"raw":return new lN(rq(t));case"base64":case"base64url":return new lN(iq(e,t));case"data_url":return new lN(function Awe(e){const t=new oq(e);return t.base64?iq("base64",t.rest):function kwe(e){let t;try{t=decodeURIComponent(e)}catch{throw Kw("data_url","Malformed data URL.")}return rq(t)}(t.rest)}(t),function Rwe(e){return new oq(e).contentType}(t))}throw iN()}("raw",a).data:a.data_);let r=0;n.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(a=>{for(let c=0;c<a.length;c++)i[o++]=a[c]}),new Uh(i,!0)}}uploadData(){return this.data_}}function cN(e){let t;try{t=JSON.parse(e)}catch{return null}return function ywe(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}function sq(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Nwe(e,t){return t}class pa{constructor(t,n,r,i){this.server=t,this.local=n||t,this.writable=!!r,this.xform=i||Nwe}}let xD=null;function Xw(){if(xD)return xD;const e=[];e.push(new pa("bucket")),e.push(new pa("generation")),e.push(new pa("metageneration")),e.push(new pa("name","fullPath",!0));const n=new pa("name");n.xform=function t(o,a){return function Lwe(e){return!bD(e)||e.length<2?e:sq(e)}(a)},e.push(n);const i=new pa("size");return i.xform=function r(o,a){return void 0!==a?Number(a):a},e.push(i),e.push(new pa("timeCreated")),e.push(new pa("updated")),e.push(new pa("md5Hash",null,!0)),e.push(new pa("cacheControl",null,!0)),e.push(new pa("contentDisposition",null,!0)),e.push(new pa("contentEncoding",null,!0)),e.push(new pa("contentLanguage",null,!0)),e.push(new pa("contentType",null,!0)),e.push(new pa("metadata","customMetadata",!0)),xD=e,xD}function aq(e,t,n){const r=cN(t);return null===r?null:function Bwe(e,t,n){const r={type:"file"},i=n.length;for(let o=0;o<i;o++){const a=n[o];r[a.local]=a.xform(r,t[a.server])}return function Fwe(e,t){Object.defineProperty(e,"ref",{get:function n(){const o=new fa(e.bucket,e.fullPath);return t._makeStorageReference(o)}})}(r,e),r}(e,r,n)}class vd{constructor(t,n,r,i){this.url=t,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function bd(e){if(!e)throw iN()}function Py(e){return function t(n,r){let i;return i=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function iwe(){return new qi(Si.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function rwe(){return new qi(Si.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function nwe(e){return new qi(Si.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(e.bucket):403===n.getStatus()?function owe(e){return new qi(Si.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}(e.path):r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}}function Qw(e){const t=Py(e);return function n(r,i){let o=t(r,i);return 404===r.getStatus()&&(o=function twe(e){return new qi(Si.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}(e.path)),o.serverResponse=i.serverResponse,o}}function fq(e,t,n,r,i){const o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},p=function c(){let $e="";for(let De=0;De<2;De++)$e+=Math.random().toString().slice(2);return $e}();a["Content-Type"]="multipart/related; boundary="+p;const _=function hq(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function Zwe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}(t,r,i),x=function uN(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}(_,n),O=Uh.getBlob("--"+p+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+x+"\r\n--"+p+"\r\nContent-Type: "+_.contentType+"\r\n\r\n",r,"\r\n--"+p+"--");if(null===O)throw function X$(){return new qi(Si.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const B={name:_.fullPath},Q=zh(o,e.host,e._protocol),ye=e.maxUploadRetryTime,xe=new vd(Q,"POST",function ED(e,t){return function n(r,i){const o=aq(e,i,t);return bd(null!==o),o}}(e,n),ye);return xe.urlParams=B,xe.headers=a,xe.body=O.uploadData(),xe.errorHandler=Py(t),xe}class Jwe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=My.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=My.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=My.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,r,i){if(this.sent_)throw Yw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,t,!0),void 0!==i)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yw("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class e0e extends Jwe{initXhr(){this.xhr_.responseType="text"}}function yu(){return new e0e}class gg{constructor(t,n){this._service=t,this._location=n instanceof fa?n:fa.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new gg(t,n)}get root(){const t=new fa(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sq(this._location.path)}get storage(){return this._service}get parent(){const t=function Pwe(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;const n=new fa(this._location.bucket,t);return new gg(this._service,n)}_throwIfRoot(t){if(""===this._location.path)throw function hwe(e){return new qi(Si.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}function f0e(e){e._throwIfRoot("getDownloadURL");const t=function qwe(e,t,n){const i=zh(t.fullServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new vd(i,"GET",function Hwe(e,t){return function n(r,i){const o=aq(e,i,t);return bd(null!==o),function Vwe(e,t,n,r){const i=cN(t);if(null===i||!bD(i.downloadTokens))return null;const o=i.downloadTokens;if(0===o.length)return null;const a=encodeURIComponent;return o.split(",").map(_=>{const D=e.fullPath;return zh("/b/"+a(e.bucket)+"/o/"+a(D),n,r)+eq({alt:"media",token:_})})[0]}(o,i,e.host,e._protocol)}}(e,n),a);return c.errorHandler=Qw(t),c}(e.storage,e._location,Xw());return e.storage.makeRequestWithTokens(t,yu).then(n=>{if(null===n)throw function uwe(){return new qi(Si.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return n})}function bq(e,t){if(e instanceof pN){const n=e;if(null==n._bucket)throw function lwe(){return new qi(Si.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Z$+"' property when initializing the app?")}();const r=new gg(n,n._bucket);return null!=t?bq(r,t):r}return void 0!==t?function vq(e,t){const n=function Owe(e,t){const n=t.split("/").filter(r=>r.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new fa(e._location.bucket,n);return new gg(e.storage,r)}(e,t):e}function wq(e,t){const n=t?.[Z$];return null==n?null:fa.makeFromBucketSpec(n,e)}class pN{constructor(t,n,r,i,o){this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=W$,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?fa.makeFromBucketSpec(i,this._host):wq(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._bucket=null!=this._url?fa.makeFromBucketSpec(this._url,t):wq(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){aN("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){aN("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}_getAuthToken(){var t=this;return _e(function*(){if(t._overrideAuthToken)return t._overrideAuthToken;const n=t._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var t=this;return _e(function*(){const n=t._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new gg(this,t)}_makeRequest(t,n,r,i,o=!0){if(this._deleted)return new fwe(Q$());{const a=function Cwe(e,t,n,r,i,o,a=!0){const c=eq(e.urlParams),p=e.url+c,_=Object.assign({},e.headers);return function xwe(e,t){t&&(e["X-Firebase-GMPID"]=t)}(_,t),function bwe(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(_,n),function wwe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(_,o),function Ewe(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(_,r),new vwe(p,e.method,_,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}(t,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(t,n){var r=this;return _e(function*(){const[i,o]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(t,n,i,o).getPromise()})()}}const xq="@firebase/storage",Cq="storage";function Dq(e,t,n){return function gq(e,t,n){e._throwIfRoot("uploadBytes");const r=fq(e.storage,e._location,Xw(),new Uh(t,!0),n);return e.storage.makeRequestWithTokens(r,yu).then(i=>({metadata:i,ref:e}))}(e=Fo(e),t,n)}function Tq(e){return f0e(e=Fo(e))}function Sq(e){return function p0e(e){e._throwIfRoot("deleteObject");const t=function Wwe(e,t){const r=zh(t.fullServerUrl(),e.host,e._protocol),c=new vd(r,"DELETE",function a(p,_){},e.maxOperationRetryTime);return c.successCodes=[200,204],c.errorHandler=Qw(t),c}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,yu)}(e=Fo(e))}function DD(e,t){return function _0e(e,t){if(t&&function m0e(e){return/^[A-Za-z]+:\/\//.test(e)}(t)){if(e instanceof pN)return function g0e(e,t){return new gg(e,t)}(e,t);throw oN("To use ref(service, url), the first argument must be a Storage instance.")}return bq(e,t)}(e=Fo(e),t)}function w0e(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new pN(n,r,i,t,rg)}!function x0e(){ng(new ap(Cq,w0e,"PUBLIC").setMultipleInstances(!0)),hu(xq,"0.13.2",""),hu(xq,"0.13.2","esm2017")}();const mN=IH({apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",authDomain:"familyapp-e83b7.firebaseapp.com",databaseURL:"https://familyapp-e83b7-default-rtdb.europe-west1.firebasedatabase.app",projectId:"familyapp-e83b7",storageBucket:"familyapp-e83b7.appspot.com",messagingSenderId:"728695329604",appId:"1:728695329604:web:c0a1ef7ebf32de4bcd7d11"}),Ic=function O_e(e=AR()){const t=sw(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function wme(e,t){const n=sw(e,"auth");if(n.isInitialized()){const i=n.getImmediate();if(_1(n.getOptions(),t??{}))return i;Za(i,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:I_e,persistence:[Dge,hge,D6]}),r=gH("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=P_e(o.toString());(function ige(e,t,n){Fo(e).beforeAuthStateChanged(t,n)})(n,a,()=>a(n.currentUser)),function rge(e,t,n,r){Fo(e).onIdTokenChanged(t,n,r)}(n,c=>a(c))}}const i=fH("auth");return i&&function Eme(e,t,n){const r=vo(e);ct(r._canInitEmulator,r,"emulator-config-failed"),ct(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!n?.disableWarnings,o=u6(t),{host:a,port:c}=function Cme(e){const t=u6(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:d6(r.substr(o.length+1))}}{const[o,a]=r.split(":");return{host:o,port:d6(a)}}}(t);r.config.emulator={url:`${o}//${a}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function Dme(){function e(){const t=document.createElement("p"),n=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${i}`),n}(mN),bo=function Wbe(e=AR(),t){const n=sw(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const r=pH("database");r&&function Zbe(e,t,n,r={}){(e=Fo(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&pd("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&pd('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Tw(Tw.OWNER);else if(r.mockUserToken){const a="string"==typeof r.mockUserToken?r.mockUserToken:_H(r.mockUserToken,e.app.options.projectId);o=new Tw(a)}!function jbe(e,t,n,r){e.repoInfo_=new eO(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,o)}(n,...r)}return n}(mN),TD=function v0e(e=AR(),t){const r=sw(e=Fo(e),Cq).getImmediate({identifier:t}),i=pH("storage");return i&&function b0e(e,t,n,r={}){!function y0e(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:_H(i,e.app.options.projectId))}(e,t,n,r)}(r,...i),r}(mN);let SD=(()=>{class e{constructor(){}getUserData(){return new U(n=>M1(Ic,i=>{i?bp(ro(bo,"/users/"+i.uid)).then(o=>{const a=o.val();n.next(a)}).catch(o=>{n.error(o)}):n.next(null)},i=>{n.error(i)},()=>{n.complete()}))}updateUserData(n,r){return U$(ro(bo,`/users/${n}`),r)}deleteOldAvatar(n){return n&&n.includes("firebasestorage.googleapis.com")?Sq(DD(TD,n)).catch(()=>{}):Promise.resolve()}compressImage(n,r=400,i=.7){return new Promise((o,a)=>{const c=new Image,p=new FileReader;p.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let D=c.width,A=c.height;D>r&&(A=Math.round(A*r/D),D=r),x.width=D,x.height=A,x.getContext("2d").drawImage(c,0,0,D,A),x.toBlob(B=>B?o(B):a("Compression echouee"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},p.onerror=a,p.readAsDataURL(n)})}uploadFile(n){return this.compressImage(n).then(r=>{const i=Date.now().toString();return Dq(DD(TD,"/avatars/"+i+".jpg"),r,{contentType:"image/jpeg"}).then(a=>Tq(a.ref))})}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),wd=(()=>{class e{constructor(){this.googleToken$=new K,this.redirectReady=Promise.resolve(),this.allUsers=[]}signInWithGoogle(){const n=new m6;return n.addScope("https://www.googleapis.com/auth/calendar"),n.addScope("https://www.googleapis.com/auth/calendar.events"),function $ge(e,t,n){return AP.apply(this,arguments)}(Ic,n).then(r=>{const i=m6.credentialFromResult(r);i?.accessToken&&this.googleToken$.next(i.accessToken);const o=r.user;return Vh(ro(bo,"/users/"+o.uid),{email:o.email,uid:o.uid,displayName:o.displayName||"",photoURL:o.photoURL||""}).then(()=>{})})}signOutUser(){!function oge(e){Fo(e).signOut()}(Ic)}getAllUsers(){return bp(ro(bo,"/users")).then(n=>{const r=n.val();return this.allUsers=r?Object.keys(r).map(i=>({id:i,...r[i]})):[],this.allUsers})}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),E0e=(()=>{class e{constructor(n,r){this.editProfileService=n,this.authService=r,this.userName="",this.userPhoto=""}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(n=>{n&&(this.userName=n.displayName||"",this.userPhoto=n.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg")})}onSignOut(){this.authService.signOutUser()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(SD),Re(wd))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-sidebar"]],decls:20,vars:0,consts:[[1,"w-64","h-screen","bg-white/80","backdrop-blur-lg","border-r","border-warm-100","flex","flex-col","p-4","sticky","top-0"],[1,"flex","items-center","gap-3","px-3","py-4","mb-6"],[1,"font-display","font-extrabold","text-xl","text-gradient"],[1,"flex-1","space-y-1"],["routerLink","/home","routerLinkActive","bg-gradient-to-r from-family-pink/10 to-family-orange/10 text-family-pink",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/photo","routerLinkActive","bg-gradient-to-r from-family-coral/10 to-family-orange/10 text-family-coral",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/add-task","routerLinkActive","bg-gradient-to-r from-family-purple/10 to-family-lavender/10 text-family-purple",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/shopping","routerLinkActive","bg-gradient-to-r from-family-green/10 to-family-green/10 text-family-green",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/map","routerLinkActive","bg-gradient-to-r from-family-sky/10 to-family-sky/10 text-family-sky",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/calendar","routerLinkActive","bg-gradient-to-r from-family-yellow/10 to-family-orange/10 text-family-orange",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],[1,"border-t","border-warm-100","pt-4"],[1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-400","hover:bg-red-50","hover:text-red-400","transition-all","font-medium","w-full","text-left",3,"click"]],template:function(r,i){1&r&&(ge(0,"aside",0)(1,"div",1)(2,"h1",2),we(3,"Family App"),be()(),ge(4,"nav",3)(5,"a",4),we(6," Tableau de bord "),be(),ge(7,"a",5),we(8," Photos "),be(),ge(9,"a",6),we(10," Nouvelle tache "),be(),ge(11,"a",7),we(12," Courses "),be(),ge(13,"a",8),we(14," Carte "),be(),ge(15,"a",9),we(16," Calendrier "),be()(),ge(17,"div",10)(18,"button",11),tn("click",function(){return i.onSignOut()}),we(19," Deconnexion "),be()()())},dependencies:[jb,tp,TA],encapsulation:2})}}return e})();const C0e=()=>({exact:!1});let D0e=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Er({type:e,selectors:[["app-bottom-nav"]],decls:20,vars:2,consts:[[1,"fixed","bottom-0","left-0","right-0","bg-white/90","backdrop-blur-lg","border-t","border-warm-100","pb-safe","z-50"],[1,"flex","justify-around","items-center","h-16"],["routerLink","/home","routerLinkActive","text-family-pink",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors",3,"routerLinkActiveOptions"],[1,"text-[10px]","font-medium"],["routerLink","/photo","routerLinkActive","text-family-coral",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors"],["routerLink","/add-task","routerLinkActive","text-family-purple",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors"],["routerLink","/shopping","routerLinkActive","text-family-green",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors"],["routerLink","/map","routerLinkActive","text-family-sky",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors"],["routerLink","/calendar","routerLinkActive","text-family-orange",1,"flex","flex-col","items-center","gap-0.5","text-gray-400","transition-colors"]],template:function(r,i){1&r&&(ge(0,"nav",0)(1,"div",1)(2,"a",2)(3,"span",3),we(4,"Accueil"),be()(),ge(5,"a",4)(6,"span",3),we(7,"Photos"),be()(),ge(8,"a",5)(9,"span",3),we(10,"Taches"),be()(),ge(11,"a",6)(12,"span",3),we(13,"Courses"),be()(),ge(14,"a",7)(15,"span",3),we(16,"Carte"),be()(),ge(17,"a",8)(18,"span",3),we(19,"Calendrier"),be()()()()),2&r&&(Me(2),Un("routerLinkActiveOptions",function fz(e,t){const n=Mn()+e,r=Ae();return r[n]===kr?id(r,n,t()):function qv(e,t){return e[t]}(r,n)}(1,C0e)))},dependencies:[jb,tp,TA],encapsulation:2})}}return e})();function T0e(e,t){if(1&e&&(ge(0,"a",0),pn(1,"img",1),ge(2,"span",2),we(3),be()()),2&e){const n=Et();Me(),Un("src",n.fileUrl,pc),Me(2),dn(n.user.displayName)}}let S0e=(()=>{class e{constructor(n){this.editProfileService=n,this.user=null}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(n=>{this.user=n,this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"},n=>{console.error(n)})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(SD))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-user-avatar"]],decls:1,vars:1,consts:[["routerLink","/user-profile",1,"flex","items-center","gap-2","hover:opacity-80","transition-opacity"],["alt","Photo de profil",1,"w-9","h-9","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"font-medium","text-sm","text-gray-700","hidden","md:inline"]],template:function(r,i){1&r&&hr(0,T0e,4,2,"a",0),2&r&&fr(i.user?0:-1)},dependencies:[jb,tp],encapsulation:2})}}return e})(),I0e=(()=>{class e{constructor(n){this.authService=n}onSignOut(){this.authService.signOutUser()}static{this.\u0275fac=function(r){return new(r||e)(Re(wd))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-top-bar"]],decls:9,vars:0,consts:[[1,"flex","items-center","justify-between","px-4","md:px-6","py-3","bg-white/60","backdrop-blur-sm","border-b","border-warm-100"],[1,"flex","items-center","gap-2","md:hidden"],[1,"font-display","font-bold","text-lg","text-gradient"],[1,"hidden","md:block"],[1,"flex","items-center","gap-3"],[1,"md:hidden","text-gray-400","hover:text-red-400","transition-colors","text-sm","font-medium",3,"click"]],template:function(r,i){1&r&&(ge(0,"header",0)(1,"div",1)(2,"span",2),we(3,"Family App"),be()(),pn(4,"div",3),ge(5,"div",4),pn(6,"app-user-avatar"),ge(7,"button",5),tn("click",function(){return i.onSignOut()}),we(8," Deconnexion "),be()()())},dependencies:[S0e],encapsulation:2})}}return e})();function k0e(e,t){1&e&&(ge(0,"div",0),pn(1,"app-sidebar",1),ge(2,"div",2),pn(3,"app-top-bar"),ge(4,"main",3),pn(5,"router-outlet"),be(),pn(6,"app-bottom-nav",4),be()())}function A0e(e,t){1&e&&pn(0,"router-outlet")}let R0e=(()=>{class e{constructor(){this.title="FamilyApp",this.isAuth=!1}ngOnInit(){M1(Ic,n=>{this.isAuth=!!n})}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Er({type:e,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen"],[1,"hidden","md:flex","flex-shrink-0"],[1,"flex-1","flex","flex-col","min-h-screen","overflow-hidden"],[1,"flex-1","overflow-y-auto","p-4","md:p-6","pb-24","md:pb-6"],[1,"md:hidden"]],template:function(r,i){1&r&&hr(0,k0e,7,0,"div",0)(1,A0e,1,0,"router-outlet"),2&r&&fr(i.isAuth?0:1)},dependencies:[mA,E0e,D0e,I0e],encapsulation:2})}}return e})(),Iq=(()=>{class e{_renderer;_elementRef;onChange=n=>{};onTouched=()=>{};constructor(n,r){this._renderer=n,this._elementRef=r}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}static \u0275fac=function(r){return new(r||e)(Re(za),Re(Pr))};static \u0275dir=At({type:e})}return e})(),_g=(()=>{class e extends Iq{static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,features:[zn]})}return e})();const xd=new Le(""),P0e={provide:xd,useExisting:$n(()=>gN),multi:!0};let gN=(()=>{class e extends _g{writeValue(n){this.setProperty("checked",n)}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){1&r&&tn("change",function(a){return i.onChange(a.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Cr([P0e]),zn]})}return e})();const O0e={provide:xd,useExisting:$n(()=>Ed),multi:!0},L0e=new Le("");let Ed=(()=>{class e extends Iq{_compositionMode;_composing=!1;constructor(n,r,i){super(n,r),this._compositionMode=i,null==this._compositionMode&&(this._compositionMode=!function N0e(){const e=Xf()?Xf().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}static \u0275fac=function(r){return new(r||e)(Re(za),Re(Pr),Re(L0e,8))};static \u0275dir=At({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&tn("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Cr([O0e]),zn]})}return e})();function _N(e){return null==e||0===yN(e)}function yN(e){return null==e?null:Array.isArray(e)||"string"==typeof e?e.length:e instanceof Set?e.size:null}const Gs=new Le(""),wp=new Le(""),F0e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Rl{static min(t){return function kq(e){return t=>{if(null==t.value||null==e)return null;const n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(t)}static max(t){return function Aq(e){return t=>{if(null==t.value||null==e)return null;const n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(t)}static required(t){return Rq(t)}static requiredTrue(t){return function Mq(e){return!0===e.value?null:{required:!0}}(t)}static email(t){return function Pq(e){return _N(e.value)||F0e.test(e.value)?null:{email:!0}}(t)}static minLength(t){return function Oq(e){return t=>{const n=t.value?.length??yN(t.value);return null===n||0===n?null:n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}(t)}static maxLength(t){return function Nq(e){return t=>{const n=t.value?.length??yN(t.value);return null!==n&&n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}(t)}static pattern(t){return function Lq(e){if(!e)return ID;let t,n;return"string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),r=>{if(_N(r.value))return null;const i=r.value;return t.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}(t)}static nullValidator(t){return null}static compose(t){return jq(t)}static composeAsync(t){return Hq(t)}}function Rq(e){return _N(e.value)?{required:!0}:null}function ID(e){return null}function Fq(e){return null!=e}function Bq(e){return Jv(e)?ds(e):e}function Vq(e){let t={};return e.forEach(n=>{t=null!=n?{...t,...n}:t}),0===Object.keys(t).length?null:t}function zq(e,t){return t.map(n=>n(e))}function Uq(e){return e.map(t=>function B0e(e){return!e.validate}(t)?t:n=>t.validate(n))}function jq(e){if(!e)return null;const t=e.filter(Fq);return 0==t.length?null:function(n){return Vq(zq(n,t))}}function vN(e){return null!=e?jq(Uq(e)):null}function Hq(e){if(!e)return null;const t=e.filter(Fq);return 0==t.length?null:function(n){return function M0e(...e){const t=vj(e),{args:n,keys:r}=bj(e),i=new U(o=>{const{length:a}=n;if(!a)return void o.complete();const c=new Array(a);let p=a,_=a;for(let x=0;x<a;x++){let D=!1;wc(n[x]).subscribe(new ei(o,A=>{D||(D=!0,_--),c[x]=A},()=>p--,void 0,()=>{(!p||!D)&&(_||o.next(r?xj(r,c):c),o.complete())}))}});return t?i.pipe(wj(t)):i}(zq(n,t).map(Bq)).pipe(ar(Vq))}}function bN(e){return null!=e?Hq(Uq(e)):null}function $q(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function qq(e){return e._rawValidators}function Gq(e){return e._rawAsyncValidators}function wN(e){return e?Array.isArray(e)?e:[e]:[]}function kD(e,t){return Array.isArray(e)?e.includes(t):e===t}function Wq(e,t){const n=wN(t);return wN(e).forEach(i=>{kD(n,i)||n.push(i)}),n}function Zq(e,t){return wN(t).filter(n=>!kD(e,n))}class Kq{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=vN(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=bN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Ws extends Kq{name;get formDirective(){return null}get path(){return null}}class xp extends Kq{_parent=null;name=null;valueAccessor=null}class Yq{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let Ep=(()=>{class e extends Yq{constructor(n){super(n)}static \u0275fac=function(r){return new(r||e)(Re(xp,2))};static \u0275dir=At({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&El("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[zn]})}return e})(),yg=(()=>{class e extends Yq{constructor(n){super(n)}static \u0275fac=function(r){return new(r||e)(Re(Ws,10))};static \u0275dir=At({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&El("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[zn]})}return e})();const Jw="VALID",RD="INVALID",Ny="PENDING",e0="DISABLED";class Ly{}class Jq extends Ly{value;source;constructor(t,n){super(),this.value=t,this.source=n}}class CN extends Ly{pristine;source;constructor(t,n){super(),this.pristine=t,this.source=n}}class DN extends Ly{touched;source;constructor(t,n){super(),this.touched=t,this.source=n}}class MD extends Ly{status;source;constructor(t,n){super(),this.status=t,this.source=n}}class eG extends Ly{source;constructor(t){super(),this.source=t}}class TN extends Ly{source;constructor(t){super(),this.source=t}}function SN(e){return(PD(e)?e.validators:e)||null}function IN(e,t){return(PD(t)?t.asyncValidators:e)||null}function PD(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function tG(e,t,n){const r=e.controls;if(!(t?Object.keys(r):r).length)throw new se(1e3,"");if(!r[n])throw new se(1001,"")}function nG(e,t,n){e._forEachChild((r,i)=>{if(void 0===n[i])throw new se(1002,"")})}class OD{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,n){this._assignValidators(t),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return mr(this.statusReactive)}set status(t){mr(()=>this.statusReactive.set(t))}_status=bc(()=>this.statusReactive());statusReactive=as(void 0);get valid(){return this.status===Jw}get invalid(){return this.status===RD}get pending(){return this.status==Ny}get disabled(){return this.status===e0}get enabled(){return this.status!==e0}errors;get pristine(){return mr(this.pristineReactive)}set pristine(t){mr(()=>this.pristineReactive.set(t))}_pristine=bc(()=>this.pristineReactive());pristineReactive=as(!0);get dirty(){return!this.pristine}get touched(){return mr(this.touchedReactive)}set touched(t){mr(()=>this.touchedReactive.set(t))}_touched=bc(()=>this.touchedReactive());touchedReactive=as(!1);get untouched(){return!this.touched}_events=new K;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Wq(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Wq(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Zq(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Zq(t,this._rawAsyncValidators))}hasValidator(t){return kD(this._rawValidators,t)}hasAsyncValidator(t){return kD(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){const n=!1===this.touched;this.touched=!0;const r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched({...t,sourceControl:r}),n&&!1!==t.emitEvent&&this._events.next(new DN(!0,r))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(n=>n.markAllAsTouched(t))}markAsUntouched(t={}){const n=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const r=t.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:r})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,r),n&&!1!==t.emitEvent&&this._events.next(new DN(!1,r))}markAsDirty(t={}){const n=!0===this.pristine;this.pristine=!1;const r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty({...t,sourceControl:r}),n&&!1!==t.emitEvent&&this._events.next(new CN(!1,r))}markAsPristine(t={}){const n=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const r=t.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,r),n&&!1!==t.emitEvent&&this._events.next(new CN(!0,r))}markAsPending(t={}){this.status=Ny;const n=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new MD(this.status,n)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending({...t,sourceControl:n})}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=e0,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue();const r=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new Jq(this.value,r)),this._events.next(new MD(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:n},this),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=Jw,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:n},this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t,n){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},n),this._parent._updateTouched({},n))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Jw||this.status===Ny)&&this._runAsyncValidator(r,t.emitEvent)}const n=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new Jq(this.value,n)),this._events.next(new MD(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity({...t,sourceControl:n})}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?e0:Jw}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,n){if(this.asyncValidator){this.status=Ny,this._hasOwnPendingAsyncValidator={emitEvent:!1!==n,shouldHaveEmitted:!1!==t};const r=Bq(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:n,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent,this,n.shouldHaveEmitted)}get(t){let n=t;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(t,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,n,r){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||r)&&this._events.next(new MD(this.status,n)),this._parent&&this._parent._updateControlsErrors(t,n,r)}_initObservables(){this.valueChanges=new Bn,this.statusChanges=new Bn}_calculateStatus(){return this._allControlsDisabled()?e0:this.errors?RD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ny)?Ny:this._anyControlsHaveStatus(RD)?RD:Jw}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,n){const r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),i&&this._events.next(new CN(this.pristine,n))}_updateTouched(t={},n){this.touched=this._anyControlsTouched(),this._events.next(new DN(this.touched,n)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){PD(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function q0e(e){return Array.isArray(e)?vN(e):e||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function G0e(e){return Array.isArray(e)?bN(e):e||null}(this._rawAsyncValidators)}}class t0 extends OD{constructor(t,n,r){super(SN(n),IN(r,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,r={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){nG(this,0,t),Object.keys(t).forEach(r=>{tG(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(r=>{const i=this.controls[r];i&&i.patchValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((r,i)=>{r.reset(t?t[i]:null,{...n,onlySelf:!0})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n),!1!==n?.emitEvent&&this._events.next(new TN(this))}getRawValue(){return this._reduceChildren({},(t,n,r)=>(t[r]=n.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,r)=>!!r._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const r=this.controls[n];r&&t(r,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[n,r]of Object.entries(this.controls))if(this.contains(n)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(t,n){let r=t;return this._forEachChild((i,o)=>{r=n(r,i,o)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class rG extends t0{}const vg=new Le("",{factory:()=>n0}),n0="always";function ND(e,t){return[...t.path,e]}function r0(e,t,n=n0){kN(e,t),t.valueAccessor.writeValue(e.value),(e.disabled||"always"===n)&&t.valueAccessor.setDisabledState?.(e.disabled),function Z0e(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&iG(e,t)})}(e,t),function Y0e(e,t){const n=(r,i)=>{t.valueAccessor.writeValue(r),i&&t.viewToModelUpdate(r)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function K0e(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&iG(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function W0e(e,t){if(t.valueAccessor.setDisabledState){const n=r=>{t.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function LD(e,t,n=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),BD(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function FD(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function kN(e,t){const n=qq(e);null!==t.validator?e.setValidators($q(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const r=Gq(e);null!==t.asyncValidator?e.setAsyncValidators($q(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const i=()=>e.updateValueAndValidity();FD(t._rawValidators,i),FD(t._rawAsyncValidators,i)}function BD(e,t){let n=!1;if(null!==e){if(null!==t.validator){const i=qq(e);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==t.validator);o.length!==i.length&&(n=!0,e.setValidators(o))}}if(null!==t.asyncValidator){const i=Gq(e);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==t.asyncValidator);o.length!==i.length&&(n=!0,e.setAsyncValidators(o))}}}const r=()=>{};return FD(t._rawValidators,r),FD(t._rawAsyncValidators,r),n}function iG(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function RN(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function MN(e,t){if(!t)return null;let n,r,i;return Array.isArray(t),t.forEach(o=>{o.constructor===Ed?n=o:function J0e(e){return Object.getPrototypeOf(e.constructor)===_g}(o)?r=o:i=o}),i||r||n||null}function aG(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function lG(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}Promise.resolve();const s0=class extends OD{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,n,r){super(SN(n),IN(r,n)),this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),PD(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=lG(t)?t.value:t)}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=this.defaultValue,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),n.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,!1!==n?.emitEvent&&this._events.next(new TN(this))}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){aG(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){aG(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){lG(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},sxe={provide:xp,useExisting:$n(()=>PN)},cG=Promise.resolve();let PN=(()=>{class e extends xp{_changeDetectorRef;callSetDisabledState;control=new s0;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Bn;constructor(n,r,i,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=MN(0,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),RN(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){r0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){cG.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,i=0!==r&&us(r);cG.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?ND(n,this._parent):[n]}static \u0275fac=function(r){return new(r||e)(Re(Ws,9),Re(Gs,10),Re(wp,10),Re(xd,10),Re(_h,8),Re(vg,8))};static \u0275dir=At({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Cr([sxe]),zn,ko]})}return e})(),bg=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return e})();class fG extends OD{constructor(t,n,r){super(SN(n),IN(r,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,n={}){Array.isArray(t)?t.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,r={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,n={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,r={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){nG(this,0,t),t.forEach((r,i)=>{tG(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((r,i)=>{r.reset(t[i],{...n,onlySelf:!0})}),this._updatePristine(n,this),this._updateTouched(n,this),this.updateValueAndValidity(n),!1!==n?.emitEvent&&this._events.next(new TN(this))}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((n,r)=>!!r._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((n,r)=>{t(n,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}let jD=(()=>{class e extends Ws{callSetDisabledState;get submitted(){return mr(this._submittedReactive)}set submitted(n){this._submittedReactive.set(n)}_submitted=bc(()=>this._submittedReactive());_submittedReactive=as(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(n,r,i){super(),this.callSetDisabledState=i,this._setValidators(n),this._setAsyncValidators(r)}ngOnChanges(n){this.onChanges(n)}ngOnDestroy(){this.onDestroy()}onChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(BD(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(n){const r=this.form.get(n.path);return r0(r,n,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),r}getControl(n){return this.form.get(n.path)}removeControl(n){LD(n.control||null,n,!1),function exe(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}getFormArray(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}updateModel(n,r){this.form.get(n.path).setValue(r)}onReset(){this.resetForm()}resetForm(n=void 0,r={}){this.form.reset(n,r),this._submittedReactive.set(!1)}onSubmit(n){return this.submitted=!0,function sG(e,t){e._syncPendingControls(),t.forEach(n=>{const r=n.control;"submit"===r.updateOn&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(n),this.form._events.next(new eG(this.control)),"dialog"===n?.target?.method}_updateDomValue(){this.directives.forEach(n=>{const r=n.control,i=this.form.get(n.path);r!==i&&(LD(r||null,n),(e=>e instanceof s0)(i)&&(r0(i,n,this.callSetDisabledState),n.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const r=this.form.get(n.path);(function oG(e,t){kN(e,t)})(r,n),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const r=this.form.get(n.path);r&&function X0e(e,t){return BD(e,t)}(r,n)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){kN(this.form,this),this._oldForm&&BD(this._oldForm,this)}_checkFormPresent(){}static \u0275fac=function(r){return new(r||e)(Re(Gs,10),Re(wp,10),Re(vg,8))};static \u0275dir=At({type:e,features:[zn,ko]})}return e})();const ON=new Le(""),mxe={provide:xp,useExisting:$n(()=>Cp)};let Cp=(()=>{class e extends xp{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(n){}model;update=new Bn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(n,r,i,o,a){super(),this._ngModelWarningConfig=a,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=MN(0,o)}ngOnChanges(n){this._added||this._setUpControl(),RN(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return ND(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||e)(Re(Ws,13),Re(Gs,10),Re(wp,10),Re(xd,10),Re(ON,8))};static \u0275dir=At({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Cr([mxe]),zn,ko]})}return e})();const gxe={provide:Ws,useExisting:$n(()=>Dp)};let Dp=(()=>{class e extends jD{form=null;ngSubmit=new Bn;get control(){return this.form}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&tn("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Cr([gxe]),zn]})}return e})();const _xe={provide:xd,useExisting:$n(()=>Fy),multi:!0};function _G(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Fy=(()=>{class e extends _g{value;_optionMap=new Map;_idCounter=0;set compareWith(n){this._compareWith=n}_compareWith=Object.is;appRefInjector=Z(wl).injector;destroyRef=Z(tr);cdr=Z(_h);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,iu({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(n){this.cdr.markForCheck(),this.value=n;const i=_G(this._getOptionId(n),n);this.setProperty("value",i)}registerOnChange(n){this.onChange=r=>{this.value=this._getOptionValue(r),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),n))return r;return null}_getOptionValue(n){const r=function yxe(e){return e.split(":")[0]}(n);return this._optionMap.has(r)?this._optionMap.get(r):n}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){1&r&&tn("change",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Cr([_xe]),zn]})}return e})(),$D=(()=>{class e{_element;_renderer;_select;id;constructor(n,r,i){this._element=n,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(_G(this.id,n)),this._select._writeValueAfterRender())}set value(n){this._setElementValue(n),this._select&&this._select._writeValueAfterRender()}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||e)(Re(Pr),Re(za),Re(Fy,9))};static \u0275dir=At({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return e})();const vxe={provide:xd,useExisting:$n(()=>NN),multi:!0};function yG(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let NN=(()=>{class e extends _g{value;_optionMap=new Map;_idCounter=0;set compareWith(n){this._compareWith=n}_compareWith=Object.is;writeValue(n){let r;if(this.value=n,Array.isArray(n)){const i=n.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(n){this.onChange=r=>{const i=[],o=r.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const _=this._getOptionValue(a[c].value);i.push(_)}}else{const a=r.options;for(let c=0;c<a.length;c++){const p=a[c];if(p.selected){const _=this._getOptionValue(p.value);i.push(_)}}}this.value=i,n(i)}}_registerOption(n){const r=(this._idCounter++).toString();return this._optionMap.set(r,n),r}_getOptionId(n){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,n))return r;return null}_getOptionValue(n){const r=function bxe(e){return e.split(":")[0]}(n);return this._optionMap.has(r)?this._optionMap.get(r)._value:n}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){1&r&&tn("change",function(a){return i.onChange(a.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Cr([vxe]),zn]})}return e})(),qD=(()=>{class e{_element;_renderer;_select;id;_value;constructor(n,r,i){this._element=n,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(yG(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(yG(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||e)(Re(Pr),Re(za),Re(NN,9))};static \u0275dir=At({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return e})(),wg=(()=>{class e{_validator=ID;_onChange;_enabled;ngOnChanges(n){if(this.inputName in n){const r=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):ID,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,features:[ko]})}return e})();const Exe={provide:Gs,useExisting:$n(()=>xg),multi:!0};let xg=(()=>{class e extends wg{required;inputName="required";normalizeInput=us;createValidator=n=>Rq;enabled(n){return n}static \u0275fac=(()=>{let n;return function(i){return(n||(n=Vr(e)))(i||e)}})();static \u0275dir=At({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){2&r&&$s("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Cr([Exe]),zn]})}return e})(),IG=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({})}return e})();function kG(e){return!!e&&(void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn)}let By=(()=>{class e{useNonNullable=!1;get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,r=null){const i=this._reduceControls(n);let o={};return kG(r)?o=r:null!==r&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new t0(i,o)}record(n,r=null){const i=this._reduceControls(n);return new rG(i,r)}control(n,r,i){let o={};return this.useNonNullable?(kG(r)?o=r:(o.validators=r,o.asyncValidators=i),new s0(n,{...o,nonNullable:!0})):new s0(n,r,i)}array(n,r,i){const o=n.map(a=>this._createControl(a));return new fG(o,r,i)}_reduceControls(n){const r={};return Object.keys(n).forEach(i=>{r[i]=this._createControl(n[i])}),r}_createControl(n){return n instanceof s0||n instanceof OD?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),kxe=(()=>{class e{static withConfig(n){return{ngModule:e,providers:[{provide:vg,useValue:n.callSetDisabledState??n0}]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[IG]})}return e})(),Vy=(()=>{class e{static withConfig(n){return{ngModule:e,providers:[{provide:ON,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:vg,useValue:n.callSetDisabledState??n0}]}}static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({imports:[IG]})}return e})();class Axe{constructor(t,n,r,i,o,a,c){this.id=t,this.name=n,this.urg=r,this.title=i,this.descriptif=o,this.statut=a,this.createdDate=c}}let zy=(()=>{class e{constructor(){this.tasks=[],this.tasksSubject=new K,this.getTasks()}emitTasks(){this.tasksSubject.next(this.tasks),console.log(this.tasks)}saveTasks(){Vh(ro(bo,"/tasks"),this.tasks),console.log("T\xe2che sauvegarder",this.tasks)}getTasks(){Zw(ro(bo,"/tasks"),n=>{this.tasks=n.val()?n.val():[],this.emitTasks(),console.log("T\xe2ches r\xe9cup\xe9rer",this.tasks)})}generateUniqueId(){return`${(new Date).getTime()}-${Math.random().toString(36).substring(2,15)}`}createNewTask(n){n.id=this.generateUniqueId(),this.tasks.push(n),this.saveTasks(),console.log("T\xe2che cr\xe9er",this.tasks)}removeTask(n){const r=this.tasks.findIndex(i=>i.id===n);-1!==r?(this.tasks.splice(r,1),this.saveTasks(),this.emitTasks(),console.log("T\xe2che supprim\xe9e avec l'ID:",n)):console.error("T\xe2che non trouv\xe9e avec l'ID:",n)}getTaskById(n){return this.tasks.find(i=>i.id===n)||null}updateTaskById(n,r){const i=this.tasks.findIndex(o=>o.id===n);-1!==i?(this.tasks[i]=r,this.saveTasks(),this.emitTasks()):console.error("ID de t\xe2che invalide:",n)}updateTaskStatus(n){const r=this.tasks.findIndex(i=>i.id===n.id);-1!==r&&(this.tasks[r]=n,this.saveTasks(),this.emitTasks())}ngOnDestroy(){this.tasksSubject.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Rxe(e,t){if(1&e&&(ge(0,"option",8),we(1),be()),2&e){const n=t.$implicit;Un("value",n.displayName||n.email),Me(),dn(n.displayName||n.email)}}let Mxe=(()=>{class e{constructor(n,r,i,o,a){this.formBuilder=n,this.ts=r,this.router=i,this._snackBar=o,this.userService=a,this.allUsers=[]}ngOnInit(){this.userService.getAllUsers().then(n=>{this.allUsers=n}).catch(()=>{this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3})}),this.initForm()}initForm(){this.addTaskForm=this.formBuilder.group({name:["",[Rl.required]],urg:["",[Rl.required]],title:["",[Rl.required]],descriptif:[""]})}goBack(){this.router.navigate(["/home"])}onSubmit(){const n=this.addTaskForm.get("name")?.value,r=this.addTaskForm.get("urg")?.value,i=this.addTaskForm.get("title")?.value,o=this.addTaskForm.get("descriptif")?.value,c=(new Date).toISOString(),p=new Axe("",n,r,i,o,"Nouveau",c);this.ts.createNewTask(p),this._snackBar.open("Tache ajout\xe9e","avec succ\xe8s !!",{duration:5e3}),this.router.navigate(["/home"])}static{this.\u0275fac=function(r){return new(r||e)(Re(By),Re(zy),Re(Ms),Re(cy),Re(wd))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-add-task"]],decls:40,vars:2,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","name",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","name","id","name",1,"input-fun","w-full"],["value","","disabled",""],["value","Tout le monde"],[3,"value"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","D\xe9crivez la t\xe2che...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient",3,"disabled"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"div",1)(2,"h3",2),we(3,"\u270f\ufe0f Ajouter une Tache"),be(),ge(4,"form",3),tn("ngSubmit",function(){return i.onSubmit()}),ge(5,"div")(6,"label",4),we(7,"Tache pour"),be(),ge(8,"select",5)(9,"option",6),we(10,"Choisir..."),be(),ge(11,"option",7),we(12,"Tout le monde"),be(),Go(13,Rxe,2,2,"option",8,xl),be()(),ge(15,"div")(16,"label",9),we(17,"Priorite"),be(),ge(18,"select",10)(19,"option",6),we(20,"Choisir..."),be(),ge(21,"option",11),we(22,"Urgent !"),be(),ge(23,"option",12),we(24,"Relativement urgent"),be(),ge(25,"option",13),we(26,"Pas Urgent"),be()()(),ge(27,"div")(28,"label",14),we(29,"Titre"),be(),pn(30,"input",15),be(),ge(31,"div")(32,"label",16),we(33,"Descriptif"),be(),pn(34,"textarea",17),be(),ge(35,"div",18)(36,"button",19),tn("click",function(){return i.goBack()}),we(37,"Retour"),be(),ge(38,"button",20),we(39,"Ajouter"),be()()()()()),2&r&&(Me(4),Un("formGroup",i.addTaskForm),Me(9),Wo(i.allUsers),Me(25),Un("disabled",i.addTaskForm.invalid))},dependencies:[Vy,bg,$D,qD,Ed,Fy,Ep,yg,xg,Dp,Cp],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:80%;margin:20px auto;padding:10px 30px}@media only screen and (min-width:1224px){.mat-card[_ngcontent-%COMP%]{width:80%}}"]})}}return e})();function Pxe(e,t){if(1&e&&(jt(0,"p",14),we(1),Bt()),2&e){const n=Et();Me(),dn(n.errorMessage)}}let Oxe=(()=>{class e{constructor(n,r){this.authService=n,this.router=r,this.errorMessage=""}signInWithGoogle(){this.authService.signInWithGoogle().then(()=>{this.router.navigate(["/home"])},n=>{console.error("Google Sign-In error:",n);const r=n?.code||"";this.errorMessage="auth/popup-closed-by-user"===r||"auth/cancelled-popup-request"===r?"":`Erreur lors de la connexion Google (${r})`})}static{this.\u0275fac=function(r){return new(r||e)(Re(wd),Re(Ms))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-signin"]],decls:20,vars:1,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-family-pink","via-family-coral","to-family-orange","p-4"],[1,"w-full","max-w-md"],[1,"text-center","mb-8"],[1,"text-6xl","block","mb-2"],[1,"font-display","font-extrabold","text-3xl","text-white"],[1,"text-white/80","mt-1"],[1,"bg-white","rounded-3xl","shadow-fun","p-8"],[1,"font-display","font-bold","text-xl","text-center","text-gray-800","mb-6"],[1,"w-full","flex","items-center","justify-center","gap-3","px-6","py-3","rounded-2xl","border-2","border-gray-200","bg-white","hover:bg-gray-50","transition-all","hover:shadow-md","text-gray-700","font-semibold",3,"click"],["viewBox","0 0 24 24",1,"w-5","h-5"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],[1,"mt-4","text-red-400","text-center","text-sm"]],template:function(r,i){1&r&&(jt(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),we(4,"\u{1f468}\u200d\u{1f469}\u200d\u{1f467}\u200d\u{1f466}"),Bt(),jt(5,"h1",4),we(6,"Family App"),Bt(),jt(7,"p",5),we(8,"Votre espace famille"),Bt()(),jt(9,"div",6)(10,"h2",7),we(11,"Connexion \u{1f44b}"),Bt(),jt(12,"button",8),la("click",function(){return i.signInWithGoogle()}),Oa(),jt(13,"svg",9),od(14,"path",10)(15,"path",11)(16,"path",12)(17,"path",13),Bt(),we(18," Se connecter avec Google "),Bt(),hr(19,Pxe,2,1,"p",14),Bt()()()),2&r&&(Me(19),fr(i.errorMessage?19:-1))},styles:["mat-card[_ngcontent-%COMP%]{width:300px;margin-top:20px}"]})}}return e})();function LN(e){const t=e.cloneNode(!0),n=t.querySelectorAll("[id]"),r=e.nodeName.toLowerCase();t.removeAttribute("id");for(let i=0;i<n.length;i++)n[i].removeAttribute("id");return"canvas"===r?MG(e,t):("input"===r||"select"===r||"textarea"===r)&&RG(e,t),AG("canvas",e,t,MG),AG("input, textarea, select",e,t,RG),t}function AG(e,t,n,r){const i=t.querySelectorAll(e);if(i.length){const o=n.querySelectorAll(e);for(let a=0;a<i.length;a++)r(i[a],o[a])}}let Lxe=0;function RG(e,t){"file"!==t.type&&(t.value=e.value),"radio"===t.type&&t.name&&(t.name=`mat-clone-${t.name}-${Lxe++}`)}function MG(e,t){const n=t.getContext("2d");if(n)try{n.drawImage(e,0,0)}catch{}}function FN(e){const t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function BN(e,t,n){const{top:r,bottom:i,left:o,right:a}=e;return n>=r&&n<=i&&t>=o&&t<=a}function l0(e,t,n){e.top+=t,e.bottom=e.top+e.height,e.left+=n,e.right=e.left+e.width}function PG(e,t,n,r){const{top:i,right:o,bottom:a,left:c,width:p,height:_}=e,x=p*t,D=_*t;return r>i-D&&r<a+D&&n>c-x&&n<o+x}class OG{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(n=>{this.positions.set(n,{scrollPosition:{top:n.scrollTop,left:n.scrollLeft},clientRect:FN(n)})})}handleScroll(t){const n=Sl(t),r=this.positions.get(n);if(!r)return null;const i=r.scrollPosition;let o,a;if(n===this._document){const _=this.getViewportScrollPosition();o=_.top,a=_.left}else o=n.scrollTop,a=n.scrollLeft;const c=i.top-o,p=i.left-a;return this.positions.forEach((_,x)=>{_.clientRect&&n!==x&&n.contains(x)&&l0(_.clientRect,c,p)}),i.top=o,i.left=a,{top:c,left:p}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function NG(e,t){const n=e.rootNodes;if(1===n.length&&n[0].nodeType===t.ELEMENT_NODE)return n[0];const r=t.createElement("div");return n.forEach(i=>r.appendChild(i)),r}function VN(e,t,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];i?e.setProperty(r,i,n?.has(r)?"important":""):e.removeProperty(r)}return e}function Uy(e,t){const n=t?"":"none";VN(e.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":n,"-ms-user-select":n,"-webkit-user-select":n,"-moz-user-select":n})}function LG(e,t,n){VN(e.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},n)}function GD(e,t){return t&&"none"!=t?e+" "+t:e}function FG(e,t){e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.transform=c0(t.left,t.top)}function c0(e,t){return`translate3d(${Math.round(e)}px, ${Math.round(t)}px, 0)`}const u0={capture:!0},zN={passive:!1,capture:!0};let Bxe=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Er({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(r,i){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}\n"],encapsulation:2,changeDetection:0})}return e})(),WD=(()=>{class e{_ngZone=Z(Xt);_document=Z(Fn);_styleLoader=Z(oy);_renderer=Z(vl).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new K;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=as([]);_globalListeners;_draggingPredicate=n=>n.isDragging();_domNodesToDirectives=null;pointerMove=new K;pointerUp=new K;constructor(){}registerDropContainer(n){this._dropInstances.has(n)||this._dropInstances.add(n)}registerDragItem(n){this._dragInstances.add(n),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,zN)})}removeDropContainer(n){this._dropInstances.delete(n)}removeDragItem(n){this._dragInstances.delete(n),this.stopDragging(n),0===this._dragInstances.size&&this._cleanupDocumentTouchmove?.()}startDragging(n,r){if(!(this._activeDragInstances().indexOf(n)>-1)&&(this._styleLoader.load(Bxe),this._activeDragInstances.update(i=>[...i,n]),1===this._activeDragInstances().length)){const i=r.type.startsWith("touch"),o=c=>this.pointerUp.next(c),a=[["scroll",c=>this._scroll.next(c),u0],["selectstart",this._preventDefaultWhileDragging,zN]];i?a.push(["touchend",o,u0],["touchcancel",o,u0]):a.push(["mouseup",o,u0]),i||a.push(["mousemove",c=>this.pointerMove.next(c),zN]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=a.map(([c,p,_])=>this._renderer.listen(this._document,c,p,_))})}}stopDragging(n){this._activeDragInstances.update(r=>{const i=r.indexOf(n);return i>-1?(r.splice(i,1),[...r]):r}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(n){return this._activeDragInstances().indexOf(n)>-1}scrolled(n){const r=[this._scroll];return n&&n!==this._document&&r.push(new U(i=>this._ngZone.runOutsideAngular(()=>{const o=this._renderer.listen(n,"scroll",a=>{this._activeDragInstances().length&&i.next(a)},u0);return()=>{o()}}))),l1(...r)}registerDirectiveNode(n,r){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(n,r)}removeDirectiveNode(n){this._domNodesToDirectives?.delete(n)}getDragDirectiveForNode(n){return this._domNodesToDirectives?.get(n)||null}ngOnDestroy(){this._dragInstances.forEach(n=>this.removeDragItem(n)),this._dropInstances.forEach(n=>this.removeDropContainer(n)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=n=>{this._activeDragInstances().length>0&&n.preventDefault()};_persistentTouchmoveListener=n=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&n.preventDefault(),this.pointerMove.next(n))};_clearGlobalListeners(){this._globalListeners?.forEach(n=>n()),this._globalListeners=void 0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function BG(e){const t=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*t}function UN(e,t){return e.getPropertyValue(t).split(",").map(r=>r.trim())}const zxe=new Set(["position"]);class Uxe{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView=null;_preview;get element(){return this._preview}constructor(t,n,r,i,o,a,c,p,_,x){this._document=t,this._rootElement=n,this._direction=r,this._initialDomRect=i,this._previewTemplate=o,this._previewClass=a,this._pickupPositionOnPage=c,this._initialTransform=p,this._zIndex=_,this._renderer=x}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),VG(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return function Vxe(e){const t=getComputedStyle(e),n=UN(t,"transition-property"),r=n.find(c=>"transform"===c||"all"===c);if(!r)return 0;const i=n.indexOf(r),o=UN(t,"transition-duration"),a=UN(t,"transition-delay");return BG(o[i])+BG(a[i])}(this._preview)}addEventListener(t,n){return this._renderer.listen(this._preview,t,n)}_createPreview(){const t=this._previewTemplate,n=this._previewClass,r=t?t.template:null;let i;if(r&&t){const o=t.matchSize?this._initialDomRect:null,a=t.viewContainer.createEmbeddedView(r,t.context);a.detectChanges(),i=NG(a,this._document),this._previewEmbeddedView=a,t.matchSize?FG(i,o):i.style.transform=c0(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=LN(this._rootElement),FG(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return VN(i.style,{"pointer-events":"none",margin:VG(i)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},zxe),Uy(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),n&&(Array.isArray(n)?n.forEach(o=>i.classList.add(o)):i.classList.add(n)),i}}function VG(e){return"showPopover"in e}const jxe={passive:!0},zG={passive:!1},Hxe={passive:!1,capture:!0},UG="cdk-drag-placeholder",jG=new Set(["position"]);function HG(e,t,n={dragStartThreshold:5,pointerDirectionChangeThreshold:5}){const r=e.get(za,null,{optional:!0})||e.get(vl).createRenderer(null,null);return new qxe(t,n,e.get(Fn),e.get(Xt),e.get(ly),e.get(WD),r)}class qxe{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview=null;_previewContainer;_placeholderRef=null;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=as(!1);_hasMoved=!1;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new K;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement=null;_rootElementTapHighlight;_pointerMoveSubscription=Hn.EMPTY;_pointerUpSubscription=Hn.EMPTY;_scrollSubscription=Hn.EMPTY;_resizeSubscription=Hn.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef=null;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(n=>Uy(n,t)))}_disabled=!1;beforeStarted=new K;started=new K;released=new K;ended=new K;entered=new K;exited=new K;dropped=new K;moved=this._moveEvents;data;constrainPosition;constructor(t,n,r,i,o,a,c){this._config=n,this._document=r,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=a,this._renderer=c,this.withRootElement(t).withParent(n.parentDragRef||null),this._parentPositions=new OG(r),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(r=>Wa(r)),this._handles.forEach(r=>Uy(r,this.disabled)),this._toggleNativeDragInteractions();const n=new Set;return this._disabledHandles.forEach(r=>{this._handles.indexOf(r)>-1&&n.add(r)}),this._disabledHandles=n,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const n=Wa(t);if(n!==this._rootElement){this._removeRootElementListeners();const r=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[r.listen(n,"mousedown",this._pointerDown,zG),r.listen(n,"touchstart",this._pointerDown,jxe),r.listen(n,"dragstart",this._nativeDragStart,zG)]),this._initialTransform=void 0,this._rootElement=n}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Wa(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&function Fxe(e,t){return t.left<e.left||t.left+t.width>e.right||t.top<e.top||t.top+t.height>e.bottom}(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){const t=this._boundaryElement.getBoundingClientRect(),n=this._rootElement.getBoundingClientRect();let r=0,i=0;n.left<t.left?r=t.left-n.left:n.right>t.right&&(r=t.right-n.right),n.top<t.top?i=t.top-n.top:n.bottom>t.bottom&&(i=t.bottom-n.bottom);let c=this._activeTransform.x+r,p=this._activeTransform.y+i;this._rootElement.style.transform=c0(c,p),this._activeTransform={x:c,y:p},this._passiveTransform={x:c,y:p}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Uy(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Uy(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const n=this._getTargetHandle(t);n&&!this._disabledHandles.has(n)&&!this.disabled&&this._initializeDragSequence(n,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{const n=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){if(Math.abs(n.x-this._pickupPositionOnPage.x)+Math.abs(n.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const c=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),p=this._dropContainer;if(!c)return void this._endDragSequence(t);(!p||!p.isDragging()&&!p.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();const r=this._getConstrainedPointerPosition(n);if(this._hasMoved=!0,this._lastKnownPointerPosition=n,this._updatePointerDirectionDelta(r),this._dropContainer)this._updateActiveDropContainer(r,n);else{const i=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=r.x-i.x+this._passiveTransform.x,o.y=r.y-i.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:r,event:t,distance:this._getDragDistance(r),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const n=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(n),dropPoint:n,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){d0(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const n=this._getShadowRoot(),r=this._dropContainer;if(n&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(n,"selectstart",Gxe,Hxe)}),r){const i=this._rootElement,o=i.parentNode,a=this._placeholder=this._createPlaceholderElement(),c=this._marker=this._marker||this._document.createComment("");o.insertBefore(c,i),this._initialTransform=i.style.transform||"",this._preview=new Uxe(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,n)),LG(i,!1,jG),this._document.body.appendChild(o.replaceChild(a,i)),this.started.next({source:this,event:t}),r.start(),this._initialContainer=r,this._initialIndex=r.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(r?r.getScrollableParents():[])}_initializeDragSequence(t,n){this._parentDragRef&&n.stopPropagation();const r=this.isDragging(),i=d0(n),o=!i&&0!==n.button,a=this._rootElement,c=Sl(n),p=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),_=i?LA(n):NA(n);if(c&&c.draggable&&"mousedown"===n.type&&n.preventDefault(),r||o||p||_)return;if(this._handles.length){const A=a.style;this._rootElementTapHighlight=A.webkitTapHighlightColor||"",A.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(A=>this._updateOnScroll(A)),this._boundaryElement&&(this._boundaryRect=FN(this._boundaryElement));const x=this._previewTemplate;this._pickupPositionInElement=x&&x.template&&!x.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,n);const D=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(n);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:D.x,y:D.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,n)}_cleanupDragArtifacts(t){LG(this._rootElement,!0,jG),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const n=this._dropContainer,r=n.getItemIndex(this),i=this._getPointerPositionOnPage(t),o=this._getDragDistance(i),a=n._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:o,dropPoint:i,event:t}),this.dropped.next({item:this,currentIndex:r,previousIndex:this._initialIndex,container:n,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:o,dropPoint:i,event:t}),n.drop(this,r,this._initialIndex,this._initialContainer,a,o,i,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:n},{x:r,y:i}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,n);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,n)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{const a=this._dropContainer.getItemIndex(this),c=this._dropContainer.getItemAtIndex(a+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,c),this._dropContainer=o,this._dropContainer.enter(this,t,n,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(r,i),this._dropContainer._sortItem(this,t,n,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,n):this._applyPreviewTransform(t-this._pickupPositionInElement.x,n-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);const n=this._preview.getTransitionDuration();return 0===n?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(r=>{const i=c=>{(!c||this._preview&&Sl(c)===this._preview.element&&"transform"===c.propertyName)&&(a(),r(),clearTimeout(o))},o=setTimeout(i,1.5*n),a=this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,n=t?t.template:null;let r;return n?(this._placeholderRef=t.viewContainer.createEmbeddedView(n,t.context),this._placeholderRef.detectChanges(),r=NG(this._placeholderRef,this._document)):r=LN(this._rootElement),r.style.pointerEvents="none",r.classList.add(UG),r}_getPointerPositionInElement(t,n,r){const i=n===this._rootElement?null:n,o=i?i.getBoundingClientRect():t,a=d0(r)?r.targetTouches[0]:r,c=this._getViewportScrollPosition();return{x:o.left-t.left+(a.pageX-o.left-c.left),y:o.top-t.top+(a.pageY-o.top-c.top)}}_getPointerPositionOnPage(t){const n=this._getViewportScrollPosition(),r=d0(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,i=r.pageX-n.left,o=r.pageY-n.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const c=this._ownerSVGElement.createSVGPoint();return c.x=i,c.y=o,c.matrixTransform(a.inverse())}}return{x:i,y:o}}_getConstrainedPointerPosition(t){const n=this._dropContainer?this._dropContainer.lockAxis:null;let{x:r,y:i}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if("x"===this.lockAxis||"x"===n?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===n)&&(r=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:o,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,c=this._boundaryRect,{width:p,height:_}=this._getPreviewRect(),x=c.top+a,D=c.bottom-(_-a);r=$G(r,c.left+o,c.right-(p-o)),i=$G(i,x,D)}return{x:r,y:i}}_updatePointerDirectionDelta(t){const{x:n,y:r}=t,i=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,a=Math.abs(n-o.x),c=Math.abs(r-o.y);return a>this._config.pointerDirectionChangeThreshold&&(i.x=n>o.x?1:-1,o.x=n),c>this._config.pointerDirectionChangeThreshold&&(i.y=r>o.y?1:-1,o.y=r),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Uy(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,n){const r=1/this.scale,i=c0(t*r,n*r),o=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=o.transform&&"none"!=o.transform?o.transform:""),o.transform=GD(i,this._initialTransform)}_applyPreviewTransform(t,n){const r=this._previewTemplate?.template?void 0:this._initialTransform,i=c0(t,n);this._preview.setTransform(GD(i,r))}_getDragDistance(t){const n=this._pickupPositionOnPage;return n?{x:t.x-n.x,y:t.y-n.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:n}=this._passiveTransform;if(0===t&&0===n||this.isDragging()||!this._boundaryElement)return;const r=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===r.width&&0===r.height)return;const o=i.left-r.left,a=r.right-i.right,c=i.top-r.top,p=r.bottom-i.bottom;i.width>r.width?(o>0&&(t+=o),a>0&&(t-=a)):t=0,i.height>r.height?(c>0&&(n+=c),p>0&&(n-=p)):n=0,(t!==this._passiveTransform.x||n!==this._passiveTransform.y)&&this.setFreeDragPosition({y:n,x:t})}_getDragStartDelay(t){const n=this.dragStartDelay;return"number"==typeof n?n:d0(t)?n.touch:n?n.mouse:0}_updateOnScroll(t){const n=this._parentPositions.handleScroll(t);if(n){const r=Sl(t);this._boundaryRect&&r!==this._boundaryElement&&r.contains(this._boundaryElement)&&l0(this._boundaryRect,n.top,n.left),this._pickupPositionOnPage.x+=n.left,this._pickupPositionOnPage.y+=n.top,this._dropContainer||(this._activeTransform.x-=n.left,this._activeTransform.y-=n.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=qC(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,n){const r=this._previewContainer||"global";if("parent"===r)return t;if("global"===r){const i=this._document;return n||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return Wa(r)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){const n=this._getTargetHandle(t);n&&!this._disabledHandles.has(n)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(n=>t.target&&(t.target===n||n.contains(t.target)))}_conditionallyInsertAnchor(t,n,r){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(n===this._initialContainer&&n.hasAnchor){const i=this._anchor??=LN(this._placeholder);i.classList.remove(UG),i.classList.add("cdk-drag-anchor"),i.style.transform="",r?r.before(i):Wa(n.element).appendChild(i)}}}function $G(e,t,n){return Math.max(t,Math.min(n,e))}function d0(e){return"t"===e.type[0]}function Gxe(e){e.preventDefault()}function ZD(e,t,n){const r=h0(t,e.length-1),i=h0(n,e.length-1);if(r===i)return;const o=e[r],a=i<r?-1:1;for(let c=r;c!==i;c+=a)e[c]=e[c+a];e[i]=o}function h0(e,t){return Math.max(0,Math.min(t,e))}class qG{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction="ltr";constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,n,r,i){const o=this._itemPositions,a=this._getItemIndexFromPointerPosition(t,n,r,i);if(-1===a&&o.length>0)return null;const c="horizontal"===this.orientation,p=o.findIndex(oe=>oe.drag===t),_=o[a],D=_.clientRect,A=p>a?1:-1,O=this._getItemOffsetPx(o[p].clientRect,D,A),B=this._getSiblingOffsetPx(p,o,A),Q=o.slice();return ZD(o,p,a),o.forEach((oe,ye)=>{if(Q[ye]===oe)return;const xe=oe.drag===t,$e=xe?O:B,De=xe?t.getPlaceholderElement():oe.drag.getRootElement();oe.offset+=$e;const ve=Math.round(oe.offset*(1/oe.drag.scale));c?(De.style.transform=GD(`translate3d(${ve}px, 0, 0)`,oe.initialTransform),l0(oe.clientRect,0,$e)):(De.style.transform=GD(`translate3d(0, ${ve}px, 0)`,oe.initialTransform),l0(oe.clientRect,$e,0))}),this._previousSwap.overlaps=BN(D,n,r),this._previousSwap.drag=_.drag,this._previousSwap.delta=c?i.x:i.y,{previousIndex:p,currentIndex:a}}enter(t,n,r,i){const o=null==i||i<0?this._getItemIndexFromPointerPosition(t,n,r):i,a=this._activeDraggables,c=a.indexOf(t),p=t.getPlaceholderElement();let _=a[o];if(_===t&&(_=a[o+1]),!_&&(null==o||-1===o||o<a.length-1)&&this._shouldEnterAsFirstChild(n,r)&&(_=a[0]),c>-1&&a.splice(c,1),_&&!this._dragDropRegistry.isDragging(_)){const x=_.getRootElement();x.parentElement.insertBefore(p,x),a.splice(o,0,t)}else this._element.appendChild(p),a.push(t);p.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{const n=t.getRootElement();if(n){const r=this._itemPositions.find(i=>i.drag===t)?.initialTransform;n.style.transform=r||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(n=>n.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,n){this._itemPositions.forEach(({clientRect:r})=>{l0(r,t,n)}),this._itemPositions.forEach(({drag:r})=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){const t="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(n=>{const r=n.getVisibleElement();return{drag:n,offset:0,initialTransform:r.style.transform||"",clientRect:FN(r)}}).sort((n,r)=>t?n.clientRect.left-r.clientRect.left:n.clientRect.top-r.clientRect.top)}_getVisualItemPositions(){return"horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,n,r){const i="horizontal"===this.orientation;let o=i?n.left-t.left:n.top-t.top;return-1===r&&(o+=i?n.width-t.width:n.height-t.height),o}_getSiblingOffsetPx(t,n,r){const i="horizontal"===this.orientation,o=n[t].clientRect,a=n[t+-1*r];let c=o[i?"width":"height"]*r;if(a){const p=i?"left":"top",_=i?"right":"bottom";-1===r?c-=a.clientRect[p]-o[_]:c+=o[p]-a.clientRect[_]}return c}_shouldEnterAsFirstChild(t,n){if(!this._activeDraggables.length)return!1;const r=this._itemPositions,i="horizontal"===this.orientation;if(r[0].drag!==this._activeDraggables[0]){const a=r[r.length-1].clientRect;return i?t>=a.right:n>=a.bottom}{const a=r[0].clientRect;return i?t<=a.left:n<=a.top}}_getItemIndexFromPointerPosition(t,n,r,i){const o="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:c,clientRect:p})=>c!==t&&((!i||c!==this._previousSwap.drag||!this._previousSwap.overlaps||(o?i.x:i.y)!==this._previousSwap.delta)&&(o?n>=Math.floor(p.left)&&n<Math.floor(p.right):r>=Math.floor(p.top)&&r<Math.floor(p.bottom))));return-1!==a&&this._sortPredicate(a,t)?a:-1}}class Wxe{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,n){this._document=t,this._dragDropRegistry=n}start(t){const n=this._element.childNodes;this._relatedNodes=[];for(let r=0;r<n.length;r++){const i=n[r];this._relatedNodes.push([i,i.nextSibling])}this.withItems(t)}sort(t,n,r,i){const o=this._getItemIndexFromPointerPosition(t,n,r),a=this._previousSwap;if(-1===o||this._activeItems[o]===t)return null;const c=this._activeItems[o];if(a.drag===c&&a.overlaps&&a.deltaX===i.x&&a.deltaY===i.y)return null;const p=this.getItemIndex(t),_=t.getPlaceholderElement(),x=c.getRootElement();o>p?x.after(_):x.before(_),ZD(this._activeItems,p,o);const D=this._getRootNode().elementFromPoint(n,r);return a.deltaX=i.x,a.deltaY=i.y,a.drag=c,a.overlaps=x===D||x.contains(D),{previousIndex:p,currentIndex:o}}enter(t,n,r,i){const o=this._activeItems.indexOf(t);o>-1&&this._activeItems.splice(o,1);let a=null==i||i<0?this._getItemIndexFromPointerPosition(t,n,r):i;-1===a&&(a=this._getClosestItemIndexToPointer(t,n,r));const c=this._activeItems[a];c&&!this._dragDropRegistry.isDragging(c)?(this._activeItems.splice(a,0,t),c.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){const t=this._element,n=this._previousSwap;for(let r=this._relatedNodes.length-1;r>-1;r--){const[i,o]=this._relatedNodes[r];i.parentNode===t&&i.nextSibling!==o&&(null===o?t.appendChild(i):o.parentNode===t&&t.insertBefore(i,o))}this._relatedNodes=[],this._activeItems=[],n.drag=null,n.deltaX=n.deltaY=0,n.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,n,r){const i=this._getRootNode().elementFromPoint(Math.floor(n),Math.floor(r)),o=i?this._activeItems.findIndex(a=>{const c=a.getRootElement();return i===c||c.contains(i)}):-1;return-1!==o&&this._sortPredicate(o,t)?o:-1}_getRootNode(){return this._rootNode||(this._rootNode=qC(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,n,r){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let i=1/0,o=-1;for(let a=0;a<this._activeItems.length;a++){const c=this._activeItems[a];if(c!==t){const{x:p,y:_}=c.getRootElement().getBoundingClientRect(),x=Math.hypot(n-p,r-_);x<i&&(i=x,o=a)}}return o}}var kc=function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e}(kc||{}),ma=function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e}(ma||{});function ZG(e,t){return new Zxe(t,e.get(WD),e.get(Fn),e.get(Xt),e.get(ly))}class Zxe{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new K;entered=new K;exited=new K;dropped=new K;sorted=new K;receivingStarted=new K;receivingStopped=new K;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Hn.EMPTY;_verticalScrollDirection=kc.NONE;_horizontalScrollDirection=ma.NONE;_scrollNode;_stopScrollTimers=new K;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,n,r,i,o){this._dragDropRegistry=n,this._ngZone=i,this._viewportRuler=o;const a=this.element=Wa(t);this._document=r,this.withOrientation("vertical").withElementContainer(a),n.registerDropContainer(this),this._parentPositions=new OG(r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,n,r,i){this._draggingStarted(),null==i&&this.sortingDisabled&&(i=this._draggables.indexOf(t)),this._sortStrategy.enter(t,n,r,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,n,r,i,o,a,c,p={}){this._reset(),this.dropped.next({item:t,currentIndex:n,previousIndex:r,container:this,previousContainer:i,isPointerOverContainer:o,distance:a,dropPoint:c,event:p})}withItems(t){const n=this._draggables;return this._draggables=t,t.forEach(r=>r._withDropContainer(this)),this.isDragging()&&(n.filter(i=>i.isDragging()).every(i=>-1===t.indexOf(i))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof qG&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if("mixed"===t)this._sortStrategy=new Wxe(this._document,this._dragDropRegistry);else{const n=new qG(this._dragDropRegistry);n.direction=this._direction,n.orientation=t,this._sortStrategy=n}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((n,r)=>this.sortPredicate(n,r,this)),this}withScrollableParents(t){const n=this._container;return this._scrollableElements=-1===t.indexOf(n)?[n,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;Wa(this.element);const r=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(t);return r>-1&&this._scrollableElements.splice(r,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,n,r,i){if(this.sortingDisabled||!this._domRect||!PG(this._domRect,.05,n,r))return;const o=this._sortStrategy.sort(t,n,r,i);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,n){if(this.autoScrollDisabled)return;let r,i=kc.NONE,o=ma.NONE;if(this._parentPositions.positions.forEach((a,c)=>{c===this._document||!a.clientRect||r||PG(a.clientRect,.05,t,n)&&([i,o]=function Kxe(e,t,n,r,i){const o=KG(t,i),a=YG(t,r);let c=kc.NONE,p=ma.NONE;if(o){const _=e.scrollTop;o===kc.UP?_>0&&(c=kc.UP):e.scrollHeight-_>e.clientHeight&&(c=kc.DOWN)}if(a){const _=e.scrollLeft;"rtl"===n?a===ma.RIGHT?_<0&&(p=ma.RIGHT):e.scrollWidth+_>e.clientWidth&&(p=ma.LEFT):a===ma.LEFT?_>0&&(p=ma.LEFT):e.scrollWidth-_>e.clientWidth&&(p=ma.RIGHT)}return[c,p]}(c,a.clientRect,this._direction,t,n),(i||o)&&(r=c))}),!i&&!o){const{width:a,height:c}=this._viewportRuler.getViewportSize(),p={width:a,height:c,top:0,right:a,bottom:c,left:0};i=KG(p,n),o=YG(p,t),r=window}r&&(i!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||r!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=o,this._scrollNode=r,(i||o)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(n=>n._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),function Nxe(e=0,t=qA){return e<0&&(e=0),T5(e,e,t)}(0,C5).pipe(ad(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode,n=this.autoScrollStep;this._verticalScrollDirection===kc.UP?t.scrollBy(0,-n):this._verticalScrollDirection===kc.DOWN&&t.scrollBy(0,n),this._horizontalScrollDirection===ma.LEFT?t.scrollBy(-n,0):this._horizontalScrollDirection===ma.RIGHT&&t.scrollBy(n,0)})};_isOverContainer(t,n){return null!=this._domRect&&BN(this._domRect,t,n)}_getSiblingContainerFromPosition(t,n,r){return this._siblings.find(i=>i._canReceive(t,n,r))}_canReceive(t,n,r){if(!this._domRect||!BN(this._domRect,n,r)||!this.enterPredicate(t,this))return!1;const i=this._getShadowRoot().elementFromPoint(n,r);return!!i&&(i===this._container||this._container.contains(i))}_startReceiving(t,n){const r=this._activeSiblings;!r.has(t)&&n.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(r.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:n}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){const n=this._parentPositions.handleScroll(t);n&&this._sortStrategy.updateOnScroll(n.top,n.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=qC(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._sortStrategy.getActiveItemsSnapshot().filter(n=>n.isDragging());this._siblings.forEach(n=>n._startReceiving(this,t))}}function KG(e,t){const{top:n,bottom:r,height:i}=e,o=.05*i;return t>=n-o&&t<=n+o?kc.UP:t>=r-o&&t<=r+o?kc.DOWN:kc.NONE}function YG(e,t){const{left:n,right:r,width:i}=e,o=.05*i;return t>=n-o&&t<=n+o?ma.LEFT:t>=r-o&&t<=r+o?ma.RIGHT:ma.NONE}let Yxe=(()=>{class e{_injector=Z(En);constructor(){}createDrag(n,r){return HG(this._injector,n,r)}createDropList(n){return ZG(this._injector,n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const f0=new Le("CDK_DRAG_PARENT"),XG=new Le("CdkDragHandle"),QG=new Le("CDK_DRAG_CONFIG"),JG=new Le("CdkDropList");let jN=(()=>{class e{element=Z(Pr);dropContainer=Z(JG,{optional:!0,skipSelf:!0});_ngZone=Z(Xt);_viewContainerRef=Z(bl);_dir=Z(ay,{optional:!0});_changeDetectorRef=Z(_h);_selfHandle=Z(XG,{optional:!0,self:!0});_parentDrag=Z(f0,{optional:!0,skipSelf:!0});_dragDropRegistry=Z(WD);_destroyed=new K;_handles=new re([]);_previewTemplate=null;_placeholderTemplate=null;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!(!this.dropContainer||!this.dropContainer.disabled)}set disabled(n){this._disabled=n,this._dragRef.disabled=this._disabled}_disabled=!1;constrainPosition;previewClass;previewContainer;scale=1;started=new Bn;released=new Bn;ended=new Bn;entered=new Bn;exited=new Bn;dropped=new Bn;moved=new U(n=>{const r=this._dragRef.moved.pipe(ar(i=>({source:this,pointerPosition:i.pointerPosition,event:i.event,delta:i.delta,distance:i.distance}))).subscribe(n);return()=>{r.unsubscribe()}});_injector=Z(En);constructor(){const n=this.dropContainer,r=Z(QG,{optional:!0});this._dragRef=HG(this._injector,this.element,{dragStartThreshold:r&&null!=r.dragStartThreshold?r.dragStartThreshold:5,pointerDirectionChangeThreshold:r&&null!=r.pointerDirectionChangeThreshold?r.pointerDirectionChangeThreshold:5,zIndex:r?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),r&&this._assignDefaults(r),n&&(n.addItem(this),n._dropListRef.beforeStarted.pipe(ad(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(n){this._dragRef.setFreeDragPosition(n)}ngAfterViewInit(){iu(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(n){const r=n.rootElementSelector,i=n.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(n){const r=this._handles.getValue();r.push(n),this._handles.next(r)}_removeHandle(n){const r=this._handles.getValue(),i=r.indexOf(n);i>-1&&(r.splice(i,1),this._handles.next(r))}_setPreviewTemplate(n){this._previewTemplate=n}_resetPreviewTemplate(n){n===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(n){this._placeholderTemplate=n}_resetPlaceholderTemplate(n){n===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const n=this.element.nativeElement;let r=n;this.rootElementSelector&&(r=void 0!==n.closest?n.closest(this.rootElementSelector):n.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||n)}_getBoundaryElement(){const n=this.boundaryElement;return n?"string"==typeof n?this.element.nativeElement.closest(n):Wa(n):null}_syncInputs(n){n.beforeStarted.subscribe(()=>{if(!n.isDragging()){const r=this._dir,i=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;n.disabled=this.disabled,n.lockAxis=this.lockAxis,n.scale=this.scale,n.dragStartDelay="object"==typeof i&&i?i:GC(i),n.constrainPosition=this.constrainPosition,n.previewClass=this.previewClass,n.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),r&&n.withDirection(r.value)}}),n.beforeStarted.pipe(Rs(1)).subscribe(()=>{if(this._parentDrag)return void n.withParent(this._parentDrag._dragRef);let r=this.element.nativeElement.parentElement;for(;r;){const i=this._dragDropRegistry.getDragDirectiveForNode(r);if(i){n.withParent(i._dragRef);break}r=r.parentElement}})}_handleEvents(n){n.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),n.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),n.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),n.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),n.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),n.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(n){const{lockAxis:r,dragStartDelay:i,constrainPosition:o,previewClass:a,boundaryElement:c,draggingDisabled:p,rootElementSelector:_,previewContainer:x}=n;this.disabled=p??!1,this.dragStartDelay=i||0,this.lockAxis=r||null,o&&(this.constrainPosition=o),a&&(this.previewClass=a),c&&(this.boundaryElement=c),_&&(this.rootElementSelector=_),x&&(this.previewContainer=x)}_setupHandlesListener(){this._handles.pipe(Eh(n=>{const r=n.map(i=>i.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),qa(n=>l1(...n.map(r=>r._stateChanges.pipe(Q_(r))))),ad(this._destroyed)).subscribe(n=>{const r=this._dragRef,i=n.element.nativeElement;n.disabled?r.disableHandle(i):r.enableHandle(i)})}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,i){2&r&&El("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",us],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",bU]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Cr([{provide:f0,useExisting:e}]),ko]})}return e})();const HN=new Le("CdkDropListGroup");let $N=(()=>{class e{_items=new Set;disabled=!1;ngOnDestroy(){this._items.clear()}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:[2,"cdkDropListGroupDisabled","disabled",us]},exportAs:["cdkDropListGroup"],features:[Cr([{provide:HN,useExisting:e}])]})}return e})(),qN=(()=>{class e{element=Z(Pr);_changeDetectorRef=Z(_h);_scrollDispatcher=Z(o1);_dir=Z(ay,{optional:!0});_group=Z(HN,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new K;_scrollableParentsResolved=!1;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation="vertical";id=Z(du).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(n){this._dropListRef.disabled=this._disabled=n}_disabled=!1;sortingDisabled=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled=!1;autoScrollStep;elementContainerSelector=null;hasAnchor=!1;dropped=new Bn;entered=new Bn;exited=new Bn;sorted=new Bn;_unsortedItems=new Set;constructor(){const n=Z(QG,{optional:!0}),r=Z(En);this._dropListRef=ZG(r,this.element),this._dropListRef.data=this,n&&this._assignDefaults(n),this._dropListRef.enterPredicate=(i,o)=>this.enterPredicate(i.data,o.data),this._dropListRef.sortPredicate=(i,o,a)=>this.sortPredicate(i,o.data,a.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(n){this._unsortedItems.add(n),n._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef))}removeItem(n){if(this._unsortedItems.delete(n),this._latestSortedRefs){const r=this._latestSortedRefs.indexOf(n._dragRef);r>-1&&(this._latestSortedRefs.splice(r,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((n,r)=>n._dragRef.getVisibleElement().compareDocumentPosition(r._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const n=e._dropLists.indexOf(this);n>-1&&e._dropLists.splice(n,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(n){this._dir&&this._dir.change.pipe(Q_(this._dir.value),ad(this._destroyed)).subscribe(r=>n.withDirection(r)),n.beforeStarted.subscribe(()=>{const r=Kb(this.connectedTo).map(i=>"string"==typeof i?e._dropLists.find(a=>a.id===i):i);if(this._group&&this._group._items.forEach(i=>{-1===r.indexOf(i)&&r.push(i)}),!this._scrollableParentsResolved){const i=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(i),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){const i=this.element.nativeElement.querySelector(this.elementContainerSelector);n.withElementContainer(i)}n.disabled=this.disabled,n.lockAxis=this.lockAxis,n.sortingDisabled=this.sortingDisabled,n.autoScrollDisabled=this.autoScrollDisabled,n.autoScrollStep=GC(this.autoScrollStep,2),n.hasAnchor=this.hasAnchor,n.connectedTo(r.filter(i=>i&&i!==this).map(i=>i._dropListRef)).withOrientation(this.orientation)})}_handleEvents(n){n.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef)),this._changeDetectorRef.markForCheck()}),n.entered.subscribe(r=>{this.entered.emit({container:this,item:r.item.data,currentIndex:r.currentIndex})}),n.exited.subscribe(r=>{this.exited.emit({container:this,item:r.item.data}),this._changeDetectorRef.markForCheck()}),n.sorted.subscribe(r=>{this.sorted.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:r.item.data})}),n.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,item:r.item.data,isPointerOverContainer:r.isPointerOverContainer,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),l1(n.receivingStarted,n.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(n){const{lockAxis:r,draggingDisabled:i,sortingDisabled:o,listAutoScrollDisabled:a,listOrientation:c}=n;this.disabled=i??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=a??!1,this.orientation=c||"vertical",this.lockAxis=r||null}_syncItemsWithRef(n){this._latestSortedRefs=n,this._dropListRef.withItems(n)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=At({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(r,i){2&r&&($s("id",i.id),El("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",us],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",us],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",us],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",us]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Cr([{provide:HN,useValue:void 0},{provide:JG,useExisting:e}])]})}return e})(),eW=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=_o({type:e});static \u0275inj=Lr({providers:[Yxe],imports:[JA]})}return e})(),tEe=(()=>{class e{constructor(n){this.tasksService=n}transferTask(n,r,i,o){const a={...r,statut:o};this.tasksService.updateTaskStatus(a),n.splice(n.indexOf(r),1),i.push(a)}static{this.\u0275fac=function(r){return new(r||e)(Ct(zy))}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function nEe(e,t){if(1&e&&pn(0,"img",23),2&e){const n=Et().$implicit;Un("src",Et().userAvatars[n.name],pc)}}function rEe(e,t){if(1&e){const n=Mo();ge(0,"div",10)(1,"div",19),tn("click",function(){const i=yn(n).$implicit;return er(Et().onEdit(i.id))}),ge(2,"span",20),we(3),be(),ge(4,"h4",21),we(5),be(),ge(6,"div",22),hr(7,nEe,1,1,"img",23),ge(8,"span",24),we(9),be()()()()}if(2&e){const n=t.$implicit,r=Et();Me(2),Un("ngClass",r.getUrgencyClass(n.urg)),Me(),dn(n.urg),Me(2),dn(n.title),Me(2),fr(r.userAvatars[n.name]?7:-1),Me(2),dn(n.name)}}function iEe(e,t){if(1&e&&pn(0,"img",23),2&e){const n=Et().$implicit;Un("src",Et().userAvatars[n.name],pc)}}function oEe(e,t){if(1&e){const n=Mo();ge(0,"div",10)(1,"div",25),tn("click",function(){const i=yn(n).$implicit;return er(Et().onEdit(i.id))}),ge(2,"span",20),we(3),be(),ge(4,"h4",21),we(5),be(),ge(6,"div",22),hr(7,iEe,1,1,"img",23),ge(8,"span",24),we(9),be()()()()}if(2&e){const n=t.$implicit,r=Et();Me(2),Un("ngClass",r.getUrgencyClass(n.urg)),Me(),dn(n.urg),Me(2),dn(n.title),Me(2),fr(r.userAvatars[n.name]?7:-1),Me(2),dn(n.name)}}function sEe(e,t){if(1&e&&pn(0,"img",23),2&e){const n=Et().$implicit;Un("src",Et().userAvatars[n.name],pc)}}function aEe(e,t){if(1&e){const n=Mo();ge(0,"div",10)(1,"div",26),tn("click",function(){const i=yn(n).$implicit;return er(Et().onEdit(i.id))}),ge(2,"span",20),we(3),be(),ge(4,"h4",21),we(5),be(),ge(6,"div",22),hr(7,sEe,1,1,"img",23),ge(8,"span",24),we(9),be()()()()}if(2&e){const n=t.$implicit,r=Et();Me(2),Un("ngClass",r.getUrgencyClass(n.urg)),Me(),dn(n.urg),Me(2),dn(n.title),Me(2),fr(r.userAvatars[n.name]?7:-1),Me(2),dn(n.name)}}function lEe(e,t){if(1&e&&pn(0,"img",23),2&e){const n=Et().$implicit;Un("src",Et().userAvatars[n.name],pc)}}function cEe(e,t){if(1&e){const n=Mo();ge(0,"div",10)(1,"div",27),tn("click",function(){const i=yn(n).$implicit;return er(Et().onEdit(i.id))}),ge(2,"span",20),we(3),be(),ge(4,"h4",21),we(5),be(),ge(6,"div",22),hr(7,lEe,1,1,"img",23),ge(8,"span",24),we(9),be()()()()}if(2&e){const n=t.$implicit,r=Et();Me(2),Un("ngClass",r.getUrgencyClass(n.urg)),Me(),dn(n.urg),Me(2),dn(n.title),Me(2),fr(r.userAvatars[n.name]?7:-1),Me(2),dn(n.name)}}function uEe(e,t){if(1&e&&pn(0,"img",23),2&e){const n=Et().$implicit;Un("src",Et().userAvatars[n.name],pc)}}function dEe(e,t){if(1&e){const n=Mo();ge(0,"div",10)(1,"div",28),tn("click",function(){const i=yn(n).$implicit;return er(Et().onEdit(i.id))}),ge(2,"span",20),we(3),be(),ge(4,"h4",21),we(5),be(),ge(6,"div",22),hr(7,uEe,1,1,"img",23),ge(8,"span",24),we(9),be()()()()}if(2&e){const n=t.$implicit,r=Et();Me(2),Un("ngClass",r.getUrgencyClass(n.urg)),Me(),dn(n.urg),Me(2),dn(n.title),Me(2),fr(r.userAvatars[n.name]?7:-1),Me(2),dn(n.name)}}let hEe=(()=>{class e{constructor(n,r,i,o,a){this.ts=n,this.dialog=r,this.router=i,this.kanbanService=o,this.authService=a,this.tasks=[],this.userAvatars={},this.new=[],this.en_cours=[],this.fait=[],this.bloquer=[],this.archiver=[]}ngOnInit(){this.tasksSubsription=this.ts.tasksSubject.subscribe(n=>{this.tasks=n,this.new=n.filter(r=>"Nouveau"===r.statut),this.en_cours=n.filter(r=>"En cours"===r.statut),this.fait=n.filter(r=>"Fait"===r.statut),this.bloquer=n.filter(r=>"Bloque"===r.statut),this.archiver=n.filter(r=>"Archive"===r.statut)}),this.ts.getTasks(),this.ts.emitTasks(),this.authService.getAllUsers().then(n=>{n.forEach(r=>{r.displayName&&r.photoURL&&(this.userAvatars[r.displayName]=r.photoURL)})})}drop(n){if(n.previousContainer===n.container)ZD(n.container.data,n.previousIndex,n.currentIndex);else{const r=n.previousContainer.data[n.previousIndex],i=this.getStatusFromContainer(n.container.id);this.kanbanService.transferTask(n.previousContainer.data,r,n.container.data,i)}}getStatusFromContainer(n){switch(n){case"newContainer":default:return"Nouveau";case"inProgressContainer":return"En cours";case"doneContainer":return"Fait";case"bloqueContainer":return"Bloque";case"archiveContainer":return"Archive"}}getUrgencyClass(n){switch(n){case"Urgent":return"flex h-6 items-center rounded-full bg-red-100 px-3 text-xs font-semibold text-red-600";case"Relativement urgent":return"flex h-6 items-center rounded-full bg-yellow-100 px-3 text-xs font-semibold text-yellow-600";case"Pas urgent":return"flex h-6 items-center rounded-full bg-green-100 px-3 text-xs font-semibold text-green-600";default:return"flex h-6 items-center rounded-full bg-gray-100 px-3 text-xs font-semibold text-gray-600"}}onEdit(n){this.router.navigate(["/task/edit",n])}ngOnDestroy(){this.tasksSubsription&&this.tasksSubsription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(zy),Re(op),Re(Ms),Re(tEe),Re(wd))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-kanban"]],decls:50,vars:10,consts:[["cdkDropListGroup","",1,"flex","flex-col"],[1,"flex","flex-grow","space-x-4","overflow-x-auto","pb-4"],[1,"flex","w-64","flex-shrink-0","flex-col"],[1,"flex","items-center","px-2","mb-3"],[1,"font-display","font-bold","text-gray-700"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-sky/20","text-xs","font-bold","text-family-sky"],["routerLink","/add-task",1,"ml-auto","text-family-pink","hover:text-family-coral","transition-colors"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v12m6-6H6"],["id","newContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag",""],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-orange/20","text-xs","font-bold","text-family-orange"],["id","inProgressContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-green/20","text-xs","font-bold","text-family-green"],["id","doneContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-red-100","text-xs","font-bold","text-red-500"],["id","bloqueContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-purple/20","text-xs","font-bold","text-family-purple"],["id","archiveContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-sky","hover:shadow-card-hover","transition-shadow",3,"click"],[3,"ngClass"],[1,"mt-2","text-sm","font-semibold","text-gray-700"],[1,"flex","items-center","gap-1.5","mt-1"],[1,"w-5","h-5","rounded-full","object-cover",3,"src"],[1,"text-xs","text-gray-400"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-orange","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-green","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-red-400","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-purple","hover:shadow-card-hover","transition-shadow",3,"click"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),we(5,"\u{1f195} Nouveau"),be(),ge(6,"span",5),we(7),be(),ge(8,"button",6),Oa(),ge(9,"svg",7),pn(10,"path",8),be()()(),function D0(){!function rT(){Ye.lFrame.currentNamespace=null}()}(),ge(11,"div",9),tn("cdkDropListDropped",function(a){return i.drop(a)}),Go(12,rEe,10,5,"div",10,xl),be()(),ge(14,"div",2)(15,"div",3)(16,"span",4),we(17,"\u{1f504} En cours"),be(),ge(18,"span",11),we(19),be()(),ge(20,"div",12),tn("cdkDropListDropped",function(a){return i.drop(a)}),Go(21,oEe,10,5,"div",10,xl),be()(),ge(23,"div",2)(24,"div",3)(25,"span",4),we(26,"\u2705 Fait"),be(),ge(27,"span",13),we(28),be()(),ge(29,"div",14),tn("cdkDropListDropped",function(a){return i.drop(a)}),Go(30,aEe,10,5,"div",10,xl),be()(),ge(32,"div",2)(33,"div",3)(34,"span",4),we(35,"\u{1f6ab} Bloque"),be(),ge(36,"span",15),we(37),be()(),ge(38,"div",16),tn("cdkDropListDropped",function(a){return i.drop(a)}),Go(39,cEe,10,5,"div",10,xl),be()(),ge(41,"div",2)(42,"div",3)(43,"span",4),we(44,"\u{1f4e6} Archive"),be(),ge(45,"span",17),we(46),be()(),ge(47,"div",18),tn("cdkDropListDropped",function(a){return i.drop(a)}),Go(48,dEe,10,5,"div",10,xl),be()()()()),2&r&&(Me(7),dn(i.new.length||0),Me(4),Un("cdkDropListData",i.new),Me(),Wo(i.new),Me(7),dn(i.en_cours.length),Me(),Un("cdkDropListData",i.en_cours),Me(),Wo(i.en_cours),Me(7),dn(i.fait.length),Me(),Un("cdkDropListData",i.fait),Me(),Wo(i.fait),Me(7),dn(i.bloquer.length),Me(),Un("cdkDropListData",i.bloquer),Me(),Wo(i.bloquer),Me(7),dn(i.archiver.length),Me(),Un("cdkDropListData",i.archiver),Me(),Wo(i.archiver))},dependencies:[wC,q3,eW,qN,$N,jN,jb,tp],styles:[".drop-container[_ngcontent-%COMP%]{min-height:100vh;border:1px dashed #ccc}"]})}}return e})(),fEe=(()=>{class e{constructor(n,r,i){this.ts=n,this.dialog=r,this.router=i,this.tasks=[],this.listeUrgence=["aucune","urgent","relative","pas urgent"]}getCouleurUrgence(n){return"Pas urgent"===n?"green":"Urgent"===n?"red":"Relativement urgent"===n?"orange":"white"}ngOnInit(){this.tasksSubsription=this.ts.tasksSubject.subscribe(n=>{this.tasks=n,console.log(n)}),this.ts.getTasks(),this.ts.emitTasks()}ngOnDestroy(){this.tasksSubsription&&this.tasksSubsription.unsubscribe()}onEdit(n){this.router.navigate(["/task/edit",n])}static{this.\u0275fac=function(r){return new(r||e)(Re(zy),Re(op),Re(Ms))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-home"]],decls:35,vars:0,consts:[[1,"card-fun","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","mb-6"],["routerLink","/photo",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],[1,"text-3xl","mb-2"],[1,"font-display","font-semibold","text-gray-700","text-sm"],["routerLink","/add-task",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/shopping",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/map",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/calendar",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],[1,"card-fun","p-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"h1",1),we(2,"Bonjour la famille ! \u{1f44b}"),be(),ge(3,"p",2),we(4,"Bienvenue sur votre espace famille"),be()(),ge(5,"div",3)(6,"a",4)(7,"div",5),we(8,"\u{1f4f8}"),be(),ge(9,"div",6),we(10,"Photos"),be()(),ge(11,"a",7)(12,"div",5),we(13,"\u270f\ufe0f"),be(),ge(14,"div",6),we(15,"Nouvelle tache"),be()(),ge(16,"a",8)(17,"div",5),we(18,"\u{1f6d2}"),be(),ge(19,"div",6),we(20,"Courses"),be()(),ge(21,"a",9)(22,"div",5),we(23,"\u{1f5fa}\ufe0f"),be(),ge(24,"div",6),we(25,"Carte"),be()(),ge(26,"a",10)(27,"div",5),we(28,"\u{1f4c5}"),be(),ge(29,"div",6),we(30,"Calendrier"),be()()(),ge(31,"div",11)(32,"h2",12),we(33,"\u{1f4cb} Tableau des taches"),be(),pn(34,"app-kanban"),be())},dependencies:[hEe,jb,tp],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:300px;margin:20px auto;padding:10px 30px}h1[_ngcontent-%COMP%]{margin:10px}.close-button[_ngcontent-%COMP%], .edit-button[_ngcontent-%COMP%]{float:right;top:-14px;right:-30px}"]})}}return e})();var tW=Dd(197),KD=Dd.n(tW);function GN(e,t,n,r){return new(n||(n=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(D){a(D)}}function p(x){try{_(r.throw(x))}catch(D){a(D)}}function _(x){x.done?o(x.value):function i(o){return o instanceof n?o:new n(function(a){a(o)})}(x.value).then(c,p)}_((r=r.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var WN,nW,YD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function XD(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function rW(){if(nW)return WN;nW=1,WN=function t(){for(var n={},r=0;r<arguments.length;r++){var i=arguments[r];for(var o in i)e.call(i,o)&&(n[o]=i[o])}return n};var e=Object.prototype.hasOwnProperty;return WN}var iW,KN,oW,YN,sW,XN,aW,ZN={exports:{}};var lW,QN,cW,uW,vEe=XD(function _Ee(){if(aW)return XN;aW=1;var e=function gEe(){if(sW)return YN;sW=1;var e=rW(),t=function pEe(){return iW||(iW=1,ZN.exports=n={},n.simpleFilter=function(r,i){return i.filter(function(o){return n.test(r,o)})},n.test=function(r,i){return null!==n.match(r,i)},n.match=function(r,i,o){var B,a=0,c=[],p=i.length,_=0,x=0,D=(o=o||{}).pre||"",A=o.post||"",O=o.caseSensitive&&i||i.toLowerCase();r=o.caseSensitive&&r||r.toLowerCase();for(var Q=0;Q<p;Q++)B=i[Q],O[Q]===r[a]?(B=D+B+A,a+=1,x+=1+x):x=0,_+=x,c[c.length]=B;return a===r.length?(_=O===r?1/0:_,{rendered:c.join(""),score:_}):null},n.filter=function(r,i,o){return i&&0!==i.length?"string"!=typeof r?i:(o=o||{},i.reduce(function(a,c,p,_){var x=c;o.extract&&(x=o.extract(c));var D=n.match(r,x,o);return null!=D&&(a[a.length]={string:D.rendered,score:D.score,index:p,original:c}),a},[]).sort(function(a,c){return c.score-a.score||a.index-c.index})):[]}),ZN.exports;var n}(),n=function mEe(){if(oW)return KN;oW=1;var e=function(t){return this.component=t,this.items=[],this.active=t.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};return e.prototype.show=function(){this.element.style.display="block"},e.prototype.hide=function(){this.element.style.display="none"},e.prototype.add=function(t){this.items.push(t)},e.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},e.prototype.isEmpty=function(){return!this.items.length},e.prototype.isVisible=function(){return"block"===this.element.style.display},e.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()}else this.hide()},e.prototype.drawItem=function(t,n){var r=document.createElement("li"),i=document.createElement("a");n&&(r.className+=" active"),i.innerHTML=t.string,r.appendChild(i),this.element.appendChild(r),r.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),r.addEventListener("mouseup",function(){this.handleMouseUp.call(this,t)}.bind(this))},e.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()},e.prototype.move=function(t){this.active=t,this.draw()},e.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},e.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},e.prototype.drawError=function(t){var n=document.createElement("li");n.innerHTML=t,this.element.appendChild(n),this.show()},KN=e}(),r=function(i,o,a){return this.options=e({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},a=a||{}),this.el=i,this.data=o||[],this.list=new n(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(c){this.handleKeyUp(c.keyCode,c)}.bind(this),!1),this.el.addEventListener("keydown",function(c){this.handleKeyDown(c)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(c){this.handlePaste(c)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return r.prototype.handleKeyUp=function(i,o){if(40!==i&&38!==i&&27!==i&&9!==i){if(13===i)return void(this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),o.stopPropagation()));this.handleInputChange(this.el.value)}},r.prototype.handleKeyDown=function(i){switch(i.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&i.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},r.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},r.prototype.handlePaste=function(i){if(i.clipboardData)this.handleInputChange(i.clipboardData.getData("Text"));else{var o=this;setTimeout(function(){o.handleInputChange(i.target.value)},100)}},r.prototype.handleInputChange=function(i){this.query=this.normalize(i),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(o){for(var a=0;a<o.length&&(this.list.add(o[a]),a!==this.options.limit-1);a++);this.list.draw()}.bind(this))},r.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},r.prototype.update=function(i){this.data=i,this.handleKeyUp()},r.prototype.clear=function(){this.data=[],this.list.clear()},r.prototype.normalize=function(i){return i.toLowerCase()},r.prototype.match=function(i,o){return i.indexOf(o)>-1},r.prototype.value=function(i){if(this.selected=i,this.el.value=this.getItemValue(i||{place_name:this.query}),document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!1),this.el.dispatchEvent(o)}else this.el.fireEvent("onchange")},r.prototype.getCandidates=function(i){var o={pre:"<strong>",post:"</strong>",extract:function(c){return this.getItemValue(c)}.bind(this)};i(this.options.filter?t.filter(this.query,this.data,o).map(function(c){return{original:c.original,string:this.render(c.original,c.string)}}.bind(this)):this.data.map(function(c){return{original:c,string:this.render(c)}}.bind(this)))},r.prototype.getItemValue=function(i){return i},r.prototype.render=function(i,o){if(o)return o;for(var a=this.getItemValue(i.original?i.original:i),c=this.normalize(a),p=c.lastIndexOf(this.query);p>-1;){var _=p+this.query.length;a=a.slice(0,p)+"<strong>"+a.slice(p,_)+"</strong>"+a.slice(_),p=c.slice(0,p).lastIndexOf(this.query)}return a},r.prototype.renderError=function(i){this.list.drawError(i)},YN=r}();return XN=e,typeof window<"u"&&(window.Suggestions=e),XN}()),QD={exports:{}},bEe=QD.exports,EEe=XD(function wEe(){return lW||(lW=1,t=bEe,r=function(){var n=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(p){return p.match(n)||[]}function o(p){return{language:(p=r(p))[1]||"",extlang:p[2]||"",script:p[3]||"",region:p[4]||""}}function a(p,_,x){Object.defineProperty(p,_,{value:x,enumerable:!0})}function c(p,_,x){function D(A){return r(A)[p]||""}a(D,"pattern",_),a(o,x,D)}return c(1,/^[a-zA-Z]{2,3}$/,"language"),c(2,/^[a-zA-Z]{3}$/,"extlang"),c(3,/^[a-zA-Z]{4}$/,"script"),c(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(o,"split",function i(p){return r(p).filter(function(_,x){return _&&x})}),o},(e=QD).exports?e.exports=r():t.subtag=r()),QD.exports;var e,t,r}()),DEe=function CEe(){if(cW)return QN;cW=1;var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,_="object"==typeof self&&self&&self.Object===Object&&self,x="object"==typeof YD&&YD&&YD.Object===Object&&YD||_||Function("return this")(),A=Object.prototype.toString,O=Math.max,B=Math.min,Q=function(){return x.Date.now()};function ye(ve){var Fe=typeof ve;return!!ve&&("object"==Fe||"function"==Fe)}function De(ve){if("number"==typeof ve)return ve;if(function $e(ve){return"symbol"==typeof ve||function xe(ve){return!!ve&&"object"==typeof ve}(ve)&&"[object Symbol]"==A.call(ve)}(ve))return NaN;if(ye(ve)){var Fe="function"==typeof ve.valueOf?ve.valueOf():ve;ve=ye(Fe)?Fe+"":Fe}if("string"!=typeof ve)return 0===ve?ve:+ve;ve=ve.replace(r,"");var We=o.test(ve);return We||a.test(ve)?c(ve.slice(2),We?2:8):i.test(ve)?NaN:+ve}return QN=function oe(ve,Fe,We){var dt,Qt,nn,Ii,gi,Xa,Cd=0,m0=!1,St=!1,qt=!0;if("function"!=typeof ve)throw new TypeError("Expected a function");function rn(Kn){var Zs=dt,gs=Qt;return dt=Qt=void 0,Cd=Kn,Ii=ve.apply(gs,Zs)}function Ml(Kn){var Zs=Kn-Xa;return void 0===Xa||Zs>=Fe||Zs<0||St&&Kn-Cd>=nn}function ms(){var Kn=Q();if(Ml(Kn))return bu(Kn);gi=setTimeout(ms,function Vo(Kn){var Eg=Fe-(Kn-Xa);return St?B(Eg,nn-(Kn-Cd)):Eg}(Kn))}function bu(Kn){return gi=void 0,qt&&dt?rn(Kn):(dt=Qt=void 0,Ii)}function g0(){var Kn=Q(),Zs=Ml(Kn);if(dt=arguments,Qt=this,Xa=Kn,Zs){if(void 0===gi)return function ir(Kn){return Cd=Kn,gi=setTimeout(ms,Fe),m0?rn(Kn):Ii}(Xa);if(St)return gi=setTimeout(ms,Fe),rn(Xa)}return void 0===gi&&(gi=setTimeout(ms,Fe)),Ii}return Fe=De(Fe)||0,ye(We)&&(m0=!!We.leading,nn=(St="maxWait"in We)?O(De(We.maxWait)||0,Fe):nn,qt="trailing"in We?!!We.trailing:qt),g0.cancel=function _i(){void 0!==gi&&clearTimeout(gi),Cd=0,dt=Xa=Qt=gi=void 0},g0.flush=function eT(){return void 0===gi?Ii:bu(Q())},g0},QN}(),TEe=XD(DEe),vu=XD(rW()),JD={exports:{}},kEe=function IEe(){if(uW)return JD.exports;uW=1;var n,e="object"==typeof Reflect?Reflect:null,t=e&&"function"==typeof e.apply?e.apply:function(ve,Fe,We){return Function.prototype.apply.call(ve,Fe,We)};n=e&&"function"==typeof e.ownKeys?e.ownKeys:Object.getOwnPropertySymbols?function(ve){return Object.getOwnPropertyNames(ve).concat(Object.getOwnPropertySymbols(ve))}:function(ve){return Object.getOwnPropertyNames(ve)};var i=Number.isNaN||function(ve){return ve!=ve};function o(){o.init.call(this)}JD.exports=o,JD.exports.once=function ye(De,ve){return new Promise(function(Fe,We){function dt(nn){De.removeListener(ve,Qt),We(nn)}function Qt(){"function"==typeof De.removeListener&&De.removeListener("error",dt),Fe([].slice.call(arguments))}$e(De,ve,Qt,{once:!0}),"error"!==ve&&function xe(De,ve,Fe){"function"==typeof De.on&&$e(De,"error",ve,Fe)}(De,dt,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function c(De){if("function"!=typeof De)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof De)}function p(De){return void 0===De._maxListeners?o.defaultMaxListeners:De._maxListeners}function _(De,ve,Fe,We){var dt,Qt,nn;if(c(Fe),void 0===(Qt=De._events)?(Qt=De._events=Object.create(null),De._eventsCount=0):(void 0!==Qt.newListener&&(De.emit("newListener",ve,Fe.listener?Fe.listener:Fe),Qt=De._events),nn=Qt[ve]),void 0===nn)nn=Qt[ve]=Fe,++De._eventsCount;else if("function"==typeof nn?nn=Qt[ve]=We?[Fe,nn]:[nn,Fe]:We?nn.unshift(Fe):nn.push(Fe),(dt=p(De))>0&&nn.length>dt&&!nn.warned){nn.warned=!0;var Ii=new Error("Possible EventEmitter memory leak detected. "+nn.length+" "+String(ve)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ii.name="MaxListenersExceededWarning",Ii.emitter=De,Ii.type=ve,Ii.count=nn.length,function r(De){console&&console.warn&&console.warn(De)}(Ii)}return De}function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(De,ve,Fe){var We={fired:!1,wrapFn:void 0,target:De,type:ve,listener:Fe},dt=x.bind(We);return dt.listener=Fe,We.wrapFn=dt,dt}function A(De,ve,Fe){var We=De._events;if(void 0===We)return[];var dt=We[ve];return void 0===dt?[]:"function"==typeof dt?Fe?[dt.listener||dt]:[dt]:Fe?function oe(De){for(var ve=new Array(De.length),Fe=0;Fe<ve.length;++Fe)ve[Fe]=De[Fe].listener||De[Fe];return ve}(dt):B(dt,dt.length)}function O(De){var ve=this._events;if(void 0!==ve){var Fe=ve[De];if("function"==typeof Fe)return 1;if(void 0!==Fe)return Fe.length}return 0}function B(De,ve){for(var Fe=new Array(ve),We=0;We<ve;++We)Fe[We]=De[We];return Fe}function $e(De,ve,Fe,We){if("function"==typeof De.on)We.once?De.once(ve,Fe):De.on(ve,Fe);else{if("function"!=typeof De.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof De);De.addEventListener(ve,function dt(Qt){We.once&&De.removeEventListener(ve,dt),Fe(Qt)})}}return Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(De){if("number"!=typeof De||De<0||i(De))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+De+".");a=De}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(ve){if("number"!=typeof ve||ve<0||i(ve))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ve+".");return this._maxListeners=ve,this},o.prototype.getMaxListeners=function(){return p(this)},o.prototype.emit=function(ve){for(var Fe=[],We=1;We<arguments.length;We++)Fe.push(arguments[We]);var dt="error"===ve,Qt=this._events;if(void 0!==Qt)dt=dt&&void 0===Qt.error;else if(!dt)return!1;if(dt){var nn;if(Fe.length>0&&(nn=Fe[0]),nn instanceof Error)throw nn;var Ii=new Error("Unhandled error."+(nn?" ("+nn.message+")":""));throw Ii.context=nn,Ii}var gi=Qt[ve];if(void 0===gi)return!1;if("function"==typeof gi)t(gi,this,Fe);else{var Xa=gi.length,Cd=B(gi,Xa);for(We=0;We<Xa;++We)t(Cd[We],this,Fe)}return!0},o.prototype.on=o.prototype.addListener=function(ve,Fe){return _(this,ve,Fe,!1)},o.prototype.prependListener=function(ve,Fe){return _(this,ve,Fe,!0)},o.prototype.once=function(ve,Fe){return c(Fe),this.on(ve,D(this,ve,Fe)),this},o.prototype.prependOnceListener=function(ve,Fe){return c(Fe),this.prependListener(ve,D(this,ve,Fe)),this},o.prototype.off=o.prototype.removeListener=function(ve,Fe){var We,dt,Qt,nn,Ii;if(c(Fe),void 0===(dt=this._events))return this;if(void 0===(We=dt[ve]))return this;if(We===Fe||We.listener===Fe)0===--this._eventsCount?this._events=Object.create(null):(delete dt[ve],dt.removeListener&&this.emit("removeListener",ve,We.listener||Fe));else if("function"!=typeof We){for(Qt=-1,nn=We.length-1;nn>=0;nn--)if(We[nn]===Fe||We[nn].listener===Fe){Ii=We[nn].listener,Qt=nn;break}if(Qt<0)return this;0===Qt?We.shift():function Q(De,ve){for(;ve+1<De.length;ve++)De[ve]=De[ve+1];De.pop()}(We,Qt),1===We.length&&(dt[ve]=We[0]),void 0!==dt.removeListener&&this.emit("removeListener",ve,Ii||Fe)}return this},o.prototype.removeAllListeners=function(ve){var Fe,We,dt;if(void 0===(We=this._events))return this;if(void 0===We.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==We[ve]&&(0===--this._eventsCount?this._events=Object.create(null):delete We[ve]),this;if(0===arguments.length){var nn,Qt=Object.keys(We);for(dt=0;dt<Qt.length;++dt)"removeListener"!==(nn=Qt[dt])&&this.removeAllListeners(nn);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Fe=We[ve]))this.removeListener(ve,Fe);else if(void 0!==Fe)for(dt=Fe.length-1;dt>=0;dt--)this.removeListener(ve,Fe[dt]);return this},o.prototype.listeners=function(ve){return A(this,ve,!0)},o.prototype.rawListeners=function(ve){return A(this,ve,!1)},o.listenerCount=function(De,ve){return"function"==typeof De.listenerCount?De.listenerCount(ve):O.call(De,ve)},o.prototype.listenerCount=O,o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]},JD.exports}();const dW={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};var p0={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a",es:"Buscar"},errorNoResults:{en:"No results found",de:"Keine Ergebnisse gefunden",es:"No hay resultados",fr:"Aucun r\xe9sultat trouv\xe9"},errorConnectionFailed:{en:"There was an error reaching the server",de:"Verbindung fehlgeschlagen",es:"Error al conectarse al servidor",fr:"Une erreur est survenue lors de la connexion au serveur"}};const AEe=/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;class REe{constructor(t,n,r=(i,o,a)=>new vEe(i,o,a)){this.options={zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:void 0,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,proximityMinZoom:9,getItemValue:i=>null!=i.text?i.text:i.place_name,render:i=>{if(!("geometry"in i)){const a=i.text,c=a.toLowerCase().indexOf(this._typeahead.query.toLowerCase()),p=this._typeahead.query.length;return'<div class="maplibregl-ctrl-geocoder--suggestion"><svg class="maplibregl-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="maplibregl-ctrl-geocoder--suggestion-info"><div class="maplibregl-ctrl-geocoder--suggestion-title">'+a.substring(0,c)+'<span class="maplibregl-ctrl-geocoder--suggestion-match">'+a.substring(c,c+p)+"</span>"+a.substring(c+p)+"</div></div></div>"}const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--result"><svg class="maplibregl-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"},popupRender:i=>{const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--suggestion popup-suggestion"><div class="maplibregl-ctrl-geocoder--suggestion-title popup-suggestion-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--suggestion-address popup-suggestion-address">'+o.splice(1,o.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},this._eventEmitter=new kEe.EventEmitter,this.options=vu({},this.options,n),this.fresh=!0,this.lastSelected=null,this.geocoderApi=t,this.typeaheadFactory=r}addTo(t){function n(r,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const o=r.onAdd();i.appendChild(o)}if(t instanceof HTMLElement)n(this,t);else if("string"==typeof t){const r=document.querySelectorAll(t);if(0===r.length)throw new Error("Element "+t+"not found.");if(r.length>1)throw new Error("Geocoder can only be added to a single html element");n(this,r[0])}else{if(!("addControl"in t))throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element");t.addControl(this)}}onAdd(t){if(t&&"string"!=typeof t&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);const n=this.container=document.createElement("div");n.className="maplibregl-ctrl-geocoder maplibregl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";const r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="search",this._inputEl.className="maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",TEe(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);const i=document.createElement("div");i.classList.add("maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("type","button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="maplibregl-ctrl-geocoder--button";const o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),i.appendChild(this._clearEl),i.appendChild(this._loadingEl),n.appendChild(r),n.appendChild(this._inputEl),n.appendChild(i),this._typeahead=this.typeaheadFactory(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.container.addEventListener("click",()=>{this._typeahead.update(this._typeahead.data)}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),n}createIcon(t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("class","maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+t),r.setAttribute("viewBox","0 0 18 18"),r.setAttribute("xml:space","preserve"),r.setAttribute("width","18"),r.setAttribute("height","18"),"innerHTML"in r)r.innerHTML=n;else{const i=document.createElement("div");i.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",r.appendChild(i.firstChild.firstChild)}return r}onRemove(){return this.container.remove(),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this}_onPaste(t){const n=(t.clipboardData||window.clipboardData).getData("text");n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n)}_onKeyDown(t){if("Escape"===t.key&&this.options.clearAndBlurOnEsc)return this._clear(t),void this._inputEl.blur();const n=this._inputEl.value;if(!n)return this.fresh=!0,"Tab"!==t.key&&this.clear(t),void(this._clearEl.style.display="none");if(!t.metaKey&&"Tab"!==t.key&&"Escape"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key&&"ArrowDown"!==t.key){if("Enter"===t.key){if(this.options.showResultsWhileTyping)return void(null==this._typeahead.selected&&this.geocoderApi.getSuggestions?this._geocode(n,!0):null==this._typeahead.selected&&this.options.showResultMarkers&&this._fitBoundsForMarkers());this._typeahead.selected||this._geocode(n)}n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n)}}_showButton(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")}_hideButton(){this._typeahead.selected&&(this._clearEl.style.display="none")}_onBlur(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()}_onChange(){var t;const n=this._typeahead.selected;if(n){if(!("geometry"in n))return void(n.placeId?this._geocode(n.placeId,!0,!0):this._geocode(n.text,!0));if(JSON.stringify(n)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){let r;if(this._removeResultMarkers(),n.properties&&dW[n.properties.short_code])r=vu({},this.options.flyTo),this._map&&this._map.fitBounds(dW[n.properties.short_code].bbox,r);else if(n.bbox){const i=n.bbox;r=vu({},this.options.flyTo),this._map&&this._map.fitBounds([[i[0],i[1]],[i[2],i[3]]],r)}else r=vu({},{zoom:this.options.zoom},this.options.flyTo),n.center?r.center=n.center:"Point"===(null===(t=n.geometry)||void 0===t?void 0:t.type)&&n.geometry.coordinates&&(r.center=n.geometry.coordinates),this._map&&this._map.flyTo(r)}this.options.marker&&this._maplibregl&&this._handleMarker(n),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(n),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:n})}}}_getConfigForRequest(){return["bbox","limit","proximity","countries","types","language","reverseMode"].reduce((r,i)=>(this.options[i]&&(r[i]=["countries","types","language"].indexOf(i)>-1?this.options[i].split(/[\s,]+/):this.options[i],"proximity"===i&&this.options[i]&&"number"==typeof this.options[i].longitude&&"number"==typeof this.options[i].latitude&&(r[i]=[this.options[i].longitude,this.options[i].latitude])),r),{})}_geocode(t){return GN(this,arguments,void 0,function*(n,r=!1,i=!1){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:n});const o=this._getConfigForRequest(),a=this._createGeocodeRequest(o,n,r,i),c=this.options.localGeocoder&&this.options.localGeocoder(n)||[];try{const p=yield a;yield this._handleGeocodeResponse(p,o,n,r,c)}catch(p){this._handleGeocodeErrorResponse(p,c)}return a})}_createGeocodeRequest(t,n,r,i){return this.options.localGeocoderOnly?Promise.resolve({}):this.options.reverseGeocode&&AEe.test(n)?this._createReverseGeocodeRequest(n,t):(t.query=n,this.geocoderApi.getSuggestions?r?this.geocoderApi.searchByPlaceId&&i?this.geocoderApi.searchByPlaceId(t):this.geocoderApi.forwardGeocode(t):this.geocoderApi.getSuggestions(t):this.geocoderApi.forwardGeocode(t))}_createReverseGeocodeRequest(t,n){const r=t.split(/[\s(,)?]+/).map(i=>parseFloat(i)).reverse();return n.query=r,n.limit=1,"proximity"in n&&delete n.proximity,this.geocoderApi.reverseGeocode(n)}_handleGeocodeResponse(t,n,r,i,o){return GN(this,void 0,void 0,function*(){this._loadingEl.style.display="none";let a={};a=t||{type:"FeatureCollection",features:[]},a.config=n,this.fresh&&(this.fresh=!1),a.features=a.features?o.concat(a.features):o;const c=this.options.externalGeocoder&&this.options.externalGeocoder(r,a.features,n)||Promise.resolve([]);try{const _=yield c;a.features=a.features?_.concat(a.features):_}catch{}this.options.filter&&a.features.length&&(a.features=a.features.filter(this.options.filter));let p=[];p="suggestions"in a?a.suggestions:"place"in a?Array.isArray(a.place)?a.place:[a.place]:a.features,p.length?(this._clearEl.style.display="block",this._typeahead.update(p),(!this.options.showResultsWhileTyping||i)&&this.options.showResultMarkers&&(a.features.length>0||"place"in a)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",a)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",a))})}_handleGeocodeErrorResponse(t,n){this._loadingEl.style.display="none",n.length&&this.options.localGeocoder?(this._clearEl.style.display="block",this._typeahead.update(n)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:n}),this._eventEmitter.emit("error",{error:t})}_clear(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0}clear(t){this._clear(t),this._inputEl.focus()}_clearOnBlur(t){t.relatedTarget&&this._clear(t)}_onQueryResult(t){if(!("features"in t)||!t.features.length)return;const n=t.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}_updateProximity(){if(this._map)if(this._map.getZoom()>this.options.proximityMinZoom){const t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat})}else this.setProximity(null)}_collapse(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("maplibregl-ctrl-geocoder--collapsed")}_unCollapse(){this.container.classList.remove("maplibregl-ctrl-geocoder--collapsed")}query(t){return GN(this,void 0,void 0,function*(){const n=yield this._geocode(t);this._onQueryResult(n)})}_renderError(){const t=`<div class='maplibre-gl-geocoder--error'>${this._localize("errorConnectionFailed")}</div>`;this._renderMessage(t)}_renderNoResults(){const t=`<div class='maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>\n        ${this._localize("errorNoResults")}</div>`;this._renderMessage(t)}_renderMessage(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)}_localize(t){const n=EEe.language(this.options.language.split(",")[0]);return this.options.language&&p0?.[t][n]?p0[t][n]:p0[t].en}_fitBoundsForMarkers(){var t;if(this._typeahead.data.length<1)return;const n=this._typeahead.data.filter(r=>"string"!=typeof r).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){const i=vu({},{padding:100},this.options.flyTo),o=new this._maplibregl.LngLatBounds;for(const a of n)"geometry"in a&&"Point"===(null===(t=a.geometry)||void 0===t?void 0:t.type)&&o.extend(a.geometry.coordinates);this._map.fitBounds(o,i)}return n.length>0&&this._maplibregl&&this._handleResultMarkers(n),this}setInput(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t),this}setProximity(t){return this.options.proximity=t,this}getProximity(){return this.options.proximity}setRenderFunction(t){return t&&"function"==typeof t&&(this._typeahead.render=t),this}getRenderFunction(){return this._typeahead.render}setLanguage(t){return this.options.language=t||this.options.language||navigator.language,this}getLanguage(){return this.options.language}getZoom(){return this.options.zoom}setZoom(t){return this.options.zoom=t,this}getFlyTo(){return this.options.flyTo}setFlyTo(t){return this.options.flyTo=t,this}getPlaceholder(){return this.options.placeholder}setPlaceholder(t){return this.options.placeholder=t||this.options.placeholder||this._localize("placeholder"),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this}getBbox(){return this.options.bbox}setBbox(t){return this.options.bbox=t,this}getCountries(){return this.options.countries}setCountries(t){return this.options.countries=t,this}getTypes(){return this.options.types}setTypes(t){return this.options.types=t,this}getMinLength(){return this.options.minLength}setMinLength(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this}getLimit(){return this.options.limit}setLimit(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this}getFilter(){return this.options.filter}setFilter(t){return this.options.filter=t,this}setGeocoderApi(t){return this.geocoderApi=t,this}getGeocoderApi(){return this.geocoderApi}_handleMarker(t){var n;if(!this._map)return;this._removeMarker();const i=vu({},{color:"#4668F2"},this.options.marker);this.mapMarker=new this._maplibregl.Marker(i);let o=null;if(this.options.popup){const c=vu({},{},this.options.popup);o=new this._maplibregl.Popup(c).setHTML(this.options.popupRender(t))}return t.center?(this.mapMarker.setLngLat(t.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):"Point"===(null===(n=t.geometry)||void 0===n?void 0:n.type)&&t.geometry.coordinates&&(this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}_removeMarker(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)}_handleResultMarkers(t){if(!this._map)return;this._removeResultMarkers();let r=vu({},{color:"#4668F2"},this.options.showResultMarkers);for(const i of t){let o;if(this.options.showResultMarkers){this.options.showResultMarkers&&this.options.showResultMarkers.element&&(o=this.options.showResultMarkers.element.cloneNode(!0),r=vu(r,{element:o}));const a=new this._maplibregl.Marker(vu({},r,{element:o}));let c;if(this.options.popup){const _=vu({},{},this.options.popup);c=new this._maplibregl.Popup(_).setHTML(this.options.popupRender(i))}i.center?(a.setLngLat(i.center).addTo(this._map),this.options.popup&&a.setPopup(c)):i.geometry&&i.geometry.type&&"Point"===i.geometry.type&&i.geometry.coordinates&&(a.setLngLat(i.geometry.coordinates).addTo(this._map),this.options.popup&&a.setPopup(c)),this.resultMarkers.push(a)}}return this}_removeResultMarkers(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(t){t.remove()}),this.resultMarkers=[])}on(t,n){return this._eventEmitter.on(t,n),this}once(t){return new Promise(n=>{this._eventEmitter.once(t,n)})}off(t,n){return this._eventEmitter.removeListener(t,n),this}}const MEe=["map"];let PEe=(()=>{class e{constructor(){var n;this.geocoderApi={forwardGeocode:(n=_e(function*(r){const i=[];try{const o=`https://nominatim.openstreetmap.org/search?q=${r.query}&format=geojson&polygon_geojson=1&addressdetails=1`,c=yield(yield fetch(o)).json();for(const p of c.features){const _=[p.bbox[0]+(p.bbox[2]-p.bbox[0])/2,p.bbox[1]+(p.bbox[3]-p.bbox[1])/2];i.push({type:"Feature",geometry:{type:"Point",coordinates:_},place_name:p.properties.display_name,properties:p.properties,text:p.properties.display_name,place_type:["place"],center:_})}}catch(o){console.error(`Failed to forwardGeocode with error: ${o}`)}return{type:"FeatureCollection",features:i}}),function(i){return n.apply(this,arguments)})}}ngAfterViewInit(){this.map=new tW.Map({container:this.mapContainer.nativeElement,style:"https://maps.geoapify.com/v1/styles/maptiler-3d/style.json?apiKey=793f93202015411eaa6fceaeadaad99c",center:[2.213749,46.227638],zoom:5}),this.map.addControl(new(KD().NavigationControl)({visualizePitch:!0,showZoom:!0,showCompass:!0})),this.map.addControl(new(KD().FullscreenControl));let o=new(KD().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserLocation:!0});this.map.addControl(o),o.on("geolocate",function(){console.log("A geolocate event has occurred.")}),o.trigger(),this.map.addControl(new REe(this.geocoderApi,{maplibregl:KD()}),"top-left")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Er({type:e,selectors:[["app-map"]],viewQuery:function(r,i){if(1&r&&Mm(MEe,5),2&r){let o;Zf(o=Kf())&&(i.mapContainer=o.first)}},decls:5,vars:0,consts:[["map",""],[1,"card-fun","p-4","h-[calc(100vh-12rem)]"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-3"],[1,"map-container","rounded-xl","overflow-hidden","h-[calc(100%-3rem)]"]],template:function(r,i){1&r&&(jt(0,"div",1)(1,"h2",2),we(2,"\u{1f5fa}\ufe0f Carte"),Bt(),od(3,"div",3,0),Bt())},styles:[".map-container[_ngcontent-%COMP%]{height:100%}"]})}}return e})();class OEe{constructor(t,n){this.title=t,this.createdDate=n}}let JN=(()=>{class e{constructor(n){this._snackBar=n,this.photos=[],this.photosSubject=new K,this.durationInSeconds=5,this.getPhotos()}emitPhotos(){this.photosSubject.next(this.photos)}savePhotos(){Vh(ro(bo,"/photos"),this.photos)}getPhotos(){Zw(ro(bo,"/photos"),n=>{this.photos=n.val()?n.val():[],this.emitPhotos()})}createNewPhoto(n){this.photos.push(n),this.savePhotos(),this._snackBar.open("Photo ajout\xe9e","avec succ\xe8s !!",{duration:1e3*this.durationInSeconds})}compressImage(n,r=1200,i=.7){return new Promise((o,a)=>{const c=new Image,p=new FileReader;p.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let D=c.width,A=c.height;D>r&&(A=Math.round(A*r/D),D=r),x.width=D,x.height=A,x.getContext("2d").drawImage(c,0,0,D,A),x.toBlob(B=>B?o(B):a("Compression echouee"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},p.onerror=a,p.readAsDataURL(n)})}uploadFile(n){return this.compressImage(n).then(r=>{const i=Date.now().toString();return Dq(DD(TD,"photos/"+i+".jpg"),r,{contentType:"image/jpeg"}).then(a=>Tq(a.ref))})}removePhoto(n){n?.image&&Sq(DD(TD,n.image)).catch(o=>{console.log("Fichier non trouv\xe9 : "+o)});const r=this.photos.findIndex(i=>i===n);this.photos.splice(r,1),this.savePhotos(),this.emitPhotos(),this._snackBar.open("Photo supprim\xe9e","avec succ\xe8s !!",{duration:1e3*this.durationInSeconds})}static{this.\u0275fac=function(r){return new(r||e)(Ct(cy))}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function NEe(e,t){1&e&&(ge(0,"p",7),we(1,"Fichier charge !"),be())}let LEe=(()=>{class e{constructor(n,r,i){this.ps=n,this.formBuilder=r,this.dialogRef=i,this.fileIsUploading=!1,this.fileUploaded=!1}ngOnInit(){this.initForm()}initForm(){this.photoForm=this.formBuilder.group({title:[""]})}onSavePhoto(){const n=this.photoForm.get("title").value,i=(new Date).toString(),o=new OEe(n,i);o.image=this.fileUrl,this.ps.createNewPhoto(o),this.dialogRef.close()}onUploadFile(n){this.fileIsUploading=!0,this.ps.uploadFile(n).then(r=>{this.fileUrl=r,this.fileIsUploading=!1,this.fileUploaded=!0})}detectFiles(n){const r=n.target;r.files?.[0]&&this.onUploadFile(r.files[0])}static{this.\u0275fac=function(r){return new(r||e)(Re(JN),Re(By),Re(Qm))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-dialog-photo"]],decls:19,vars:3,consts:[[1,"p-6"],[1,"font-display","text-xl","font-bold","text-gradient","mb-4"],[3,"formGroup"],[1,"mb-4"],[1,"block"],[1,"sr-only"],["type","file","accept","image/*","required","",1,"block","w-full","text-sm","text-gray-500","file:mr-3","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-family-pink/10","file:text-family-pink","hover:file:bg-family-pink/20","transition-colors",3,"change"],[1,"text-family-green","text-sm","font-medium","mt-2"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","text","formControlName","title","placeholder","Titre de la photo...",1,"input-fun","w-full"],[1,"flex","justify-end","gap-3","mt-4"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"btn-gradient",3,"click","disabled"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"h2",1),we(2,"\u{1f4f8} Ajouter une photo"),be(),ge(3,"form",2)(4,"div",3)(5,"label",4)(6,"span",5),we(7,"Choisir un fichier"),be(),ge(8,"input",6),tn("change",function(a){return i.detectFiles(a)}),be()(),hr(9,NEe,2,0,"p",7),be(),ge(10,"div")(11,"label",8),we(12,"Titre"),be(),pn(13,"input",9),be(),ge(14,"div",10)(15,"button",11),tn("click",function(){return i.dialogRef.close()}),we(16,"Retour"),be(),ge(17,"button",12),tn("click",function(){return i.onSavePhoto()}),we(18,"Enregistrer"),be()()()()),2&r&&(Me(3),Un("formGroup",i.photoForm),Me(6),fr(i.fileUploaded?9:-1),Me(8),Un("disabled",!i.fileUploaded))},dependencies:[Vy,bg,Ed,Ep,yg,Dp,Cp],encapsulation:2})}}return e})(),e2=(()=>{class e{constructor(n,r){this.dialogRef=n,this.data=r,this.customMessage=r.customMessage}static{this.\u0275fac=function(r){return new(r||e)(Re(Qm),Re(u1))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-confirm-dialog"]],decls:8,vars:1,consts:[[1,"p-6","max-w-sm"],[1,"font-display","text-lg","font-semibold","text-gray-700"],[1,"flex","justify-end","gap-3","mt-6"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"btn-gradient","px-6","py-2",3,"click"]],template:function(r,i){1&r&&(jt(0,"div",0)(1,"h2",1),we(2),Bt(),jt(3,"div",2)(4,"button",3),la("click",function(){return i.dialogRef.close()}),we(5,"Non"),Bt(),jt(6,"button",4),la("click",function(){return i.dialogRef.close(!0)}),we(7,"Oui"),Bt()()()),2&r&&(Me(2),dn(i.customMessage))},encapsulation:2})}}return e})(),FEe=(()=>{class e{constructor(){}getComments(n){return bp(ro(bo,`/photo-interactions/${n}/comments`)).then(r=>{const i=r.val();return i?Object.keys(i).map(o=>({...i[o],id:o})):[]})}addComment(n,r){const i=function Rbe(e,t){e=Fo(e),yd("push",e._path),_d("push",t,e._path,!0);const n=k$(e._repo),r=kbe(n),i=Ry(e,r),o=Ry(e,r);let a;return a=null!=t?Vh(o,t).then(()=>o):Promise.resolve(o),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}(ro(bo,`/photo-interactions/${n}/comments`));return Vh(i,{...r,id:i.key})}deleteComment(n,r){return z$(ro(bo,`/photo-interactions/${n}/comments/${r}`))}toggleLike(n,r){const i=ro(bo,`/photo-interactions/${n}/likes/${r}`);return bp(i).then(o=>o.val()?z$(i).then(()=>!1):Vh(i,!0).then(()=>!0))}getLikeCount(n){return bp(ro(bo,`/photo-interactions/${n}/likes`)).then(r=>{const i=r.val();return i?Object.keys(i).length:0})}isLiked(n,r){return bp(ro(bo,`/photo-interactions/${n}/likes/${r}`)).then(i=>!!i.val())}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const BEe=["photoContainer"];function VEe(e,t){if(1&e){const n=Mo();ge(0,"button",32),tn("click",function(){yn(n);const i=Et().$implicit,o=Et(2).$index;return er(Et().deleteComment(o,i.id))}),Oa(),ge(1,"svg",33),pn(2,"path",34),be()()}}function zEe(e,t){if(1&e&&(ge(0,"div",22),pn(1,"img",26),ge(2,"div",27)(3,"div",28)(4,"span",29),we(5),be(),hr(6,VEe,3,0,"button",30),be(),ge(7,"p",31),we(8),be()()()),2&e){const n=t.$implicit,r=Et(3);Me(),Un("src",(null==r.usersCache[n.userId]?null:r.usersCache[n.userId].photoURL)||n.userPhoto||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg",pc),Me(4),dn((null==r.usersCache[n.userId]?null:r.usersCache[n.userId].displayName)||n.userName||"Anonyme"),Me(),fr(n.userId===r.currentUid?6:-1),Me(2),dn(n.text)}}function UEe(e,t){if(1&e){const n=Mo();ge(0,"div",21),Go(1,zEe,9,4,"div",22,xl),ge(3,"div",23)(4,"input",24),AI("ngModelChange",function(i){yn(n);const o=Et().$implicit;return function oz(e,t){const n=aB(e);return n&&e.set(t),n}(o._newCommentText,i)||(o._newCommentText=i),er(i)}),tn("keyup.enter",function(){yn(n);const i=Et().$index;return er(Et().addComment(i))}),be(),ge(5,"button",25),tn("click",function(){yn(n);const i=Et().$index;return er(Et().addComment(i))}),we(6,"Envoyer"),be()()()}if(2&e){const n=Et().$implicit;Me(),Wo(n._comments),Me(3),kI("ngModel",n._newCommentText)}}function jEe(e,t){if(1&e){const n=Mo();ge(0,"div",5),pn(1,"img",10),ge(2,"div",11)(3,"h3",12),we(4),be(),ge(5,"p",13),we(6),H_(7,"date"),be(),ge(8,"div",14)(9,"button",15),tn("click",function(){const i=yn(n).$index;return er(Et().toggleLike(i))}),ge(10,"span"),we(11),be(),ge(12,"span",16),we(13),be()(),ge(14,"button",17),tn("click",function(){const i=yn(n).$index;return er(Et().toggleComments(i))}),ge(15,"span"),we(16,"\u{1f4ac}"),be(),ge(17,"span",16),we(18),be()(),ge(19,"button",18),tn("click",function(){const i=yn(n).$implicit;return er(Et().onDelete(i))}),Oa(),ge(20,"svg",19),pn(21,"path",20),be()()(),hr(22,UEe,7,1,"div",21),be()()}if(2&e){const n=t.$implicit;Me(),Un("alt",function lz(e){return ni(Ae(),Ui(),e)?Zt(e):kr}(n.title))("src",n.image,pc),Me(3),dn(n.title),Me(2),dn($_(7,11,n.createdDate,"d MMMM yyyy '\xe0' HH:mm","","fr")),Me(3),TI(n._liked?"text-family-pink":"text-gray-400 hover:text-family-pink"),Me(2),dn(n._liked?"\u2764\ufe0f":"\u{1f90d}"),Me(2),dn(n._likeCount||0),Me(5),dn((null==n._comments?null:n._comments.length)||0),Me(4),fr(n._showComments?22:-1)}}function HEe(e,t){if(1&e){const n=Mo();ge(0,"button",35),tn("click",function(){return yn(n),er(Et().scrollToTop())}),Oa(),ge(1,"svg",36),pn(2,"path",37),be()()}}IU(e5);let $Ee=(()=>{class e{constructor(n,r,i){this.dialog=n,this.ps=r,this.commentsService=i,this.photos=[],this.hideButton=!1,this.currentUid=Ic.currentUser?.uid||"",this.usersCache={}}ngOnInit(){bp(ro(bo,"/users")).then(n=>{const r=n.val()||{};Object.keys(r).forEach(i=>{this.usersCache[i]={displayName:r[i].displayName||"",photoURL:r[i].photoURL||""}})}),this.photosSubscription=this.ps.photosSubject.subscribe(n=>{this.photos=n.sort((r,i)=>{const o=new Date(r.createdDate);return new Date(i.createdDate).getTime()-o.getTime()}),this.loadInteractions()}),this.ps.emitPhotos(),this.ps.getPhotos()}loadInteractions(){const n=Ic.currentUser?.uid;this.photos.forEach((r,i)=>{this.commentsService.getComments(i).then(o=>r._comments=o),this.commentsService.getLikeCount(i).then(o=>r._likeCount=o),n&&this.commentsService.isLiked(i,n).then(o=>r._liked=o)})}toggleLike(n){const r=Ic.currentUser?.uid;r&&this.commentsService.toggleLike(n,r).then(i=>(this.photos[n]._liked=i,this.commentsService.getLikeCount(n))).then(i=>{this.photos[n]._likeCount=i})}toggleComments(n){this.photos[n]._showComments=!this.photos[n]._showComments,this.photos[n]._showComments&&!this.photos[n]._comments?.length&&this.commentsService.getComments(n).then(r=>this.photos[n]._comments=r)}addComment(n){const r=this.photos[n]._newCommentText?.trim();if(!r)return;const i=Ic.currentUser;i&&bp(ro(bo,`/users/${i.uid}`)).then(o=>{const a=o.val()||{},c={photoIndex:n,userId:i.uid,userName:a.displayName||i.displayName||i.email||"Anonyme",userPhoto:a.photoURL||i.photoURL||"",text:r,createdDate:(new Date).toISOString()};return this.commentsService.addComment(n,c)}).then(()=>{this.photos[n]._newCommentText="",this.commentsService.getComments(n).then(o=>this.photos[n]._comments=o)})}deleteComment(n,r){this.commentsService.deleteComment(n,r).then(()=>{this.commentsService.getComments(n).then(i=>this.photos[n]._comments=i)})}openDialog(){this.dialog.open(LEe,{disableClose:!0})}onDelete(n){this.dialog.open(e2,{data:{customMessage:"Etes-vous sur(e) de vouloir supprimer la photo ?"}}).afterClosed().subscribe(i=>{!0===i&&this.ps.removePhoto(n)})}onScroll(n){const r=n.target;r&&(this.hideButton=!0,0===r.scrollTop&&(this.hideButton=!1))}scrollToTop(){this.photoContainer&&(this.photoContainer.nativeElement.scrollTop=0)}ngOnDestroy(){this.photosSubscription&&this.photosSubscription.unsubscribe(),this.scrollSubscription&&this.scrollSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(op),Re(JN),Re(FEe))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-photo"]],viewQuery:function(r,i){if(1&r&&Mm(BEe,5),2&r){let o;Zf(o=Kf())&&(i.photoContainer=o.first)}},decls:12,vars:1,consts:[["photoContainer",""],[1,"max-w-2xl","mx-auto","px-4",3,"scroll"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"space-y-6"],[1,"card-fun","overflow-hidden"],["title","ajouter une photo",1,"fixed","bottom-24","md:bottom-8","right-6","w-14","h-14","rounded-full","btn-gradient","flex","items-center","justify-center","shadow-lg","hover:shadow-xl","transition-shadow","z-50",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-6","h-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],["title","Vers le haut",1,"fixed","bottom-24","md:bottom-8","right-24","w-14","h-14","rounded-full","bg-white","shadow-lg","flex","items-center","justify-center","hover:shadow-xl","transition-shadow","z-50","text-family-pink"],[1,"w-full","object-contain",3,"src","alt"],[1,"p-4"],[1,"font-display","font-bold","text-gray-700"],[1,"text-xs","text-gray-400","mt-1"],[1,"flex","items-center","gap-4","mt-3","pt-3","border-t","border-gray-100"],[1,"flex","items-center","gap-1","text-sm","transition-colors",3,"click"],[1,"font-medium"],[1,"flex","items-center","gap-1","text-sm","text-gray-400","hover:text-family-sky","transition-colors",3,"click"],["title","supprimer",1,"ml-auto","text-gray-300","hover:text-red-400","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"mt-3","pt-3","border-t","border-gray-100"],[1,"flex","gap-2","mb-3"],[1,"flex","gap-2","mt-2"],["placeholder","Ecrire un commentaire...",1,"input-fun","flex-1","text-sm","py-2",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-gradient","text-sm","px-3","py-2",3,"click"],[1,"w-7","h-7","rounded-full","object-cover","flex-shrink-0",3,"src"],[1,"bg-gray-50","rounded-xl","px-3","py-2","flex-1"],[1,"flex","items-center","justify-between"],[1,"text-xs","font-semibold","text-gray-600"],[1,"text-gray-300","hover:text-red-400","transition-colors","ml-2"],[1,"text-sm","text-gray-700"],[1,"text-gray-300","hover:text-red-400","transition-colors","ml-2",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],["title","Vers le haut",1,"fixed","bottom-24","md:bottom-8","right-24","w-14","h-14","rounded-full","bg-white","shadow-lg","flex","items-center","justify-center","hover:shadow-xl","transition-shadow","z-50","text-family-pink",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M5 15l7-7 7 7"]],template:function(r,i){if(1&r){const o=Mo();ge(0,"div",1,0),tn("scroll",function(c){return yn(o),er(i.onScroll(c))}),ge(2,"div",2)(3,"h1",3),we(4,"\u{1f4f8} Photos de famille"),be()(),ge(5,"div",4),Go(6,jEe,23,16,"div",5,xl),be()(),ge(8,"button",6),tn("click",function(){return yn(o),er(i.openDialog())}),Oa(),ge(9,"svg",7),pn(10,"path",8),be()(),hr(11,HEe,3,0,"button",9)}2&r&&(Me(6),Wo(i.photos),Me(5),fr(i.hideButton?11:-1))},dependencies:[wC,kxe,Ed,Ep,PN,bC],styles:[".card[_ngcontent-%COMP%]{margin:20px auto;padding:10px 30px;width:80%}.bg-gradient-to-tr[_ngcontent-%COMP%]{height:calc(100vh - 64px);overflow-y:auto}@media only screen and (min-width:860px){.card[_ngcontent-%COMP%]{box-sizing:border-box;width:50%;margin:20px auto;padding:10px 30px}}#add-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;z-index:1000}#scroll-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;z-index:1000}.container[_ngcontent-%COMP%]{position:relative;overflow:hidden}h2[_ngcontent-%COMP%]{margin:10px}.photo-list-container[_ngcontent-%COMP%]{max-height:calc(100vh - 100px);overflow-y:auto}"]})}}return e})(),jh=(()=>{class e{constructor(n,r){this.router=n,this.authService=r}canActivate(){return this.authService.redirectReady.then(()=>new Promise(n=>{M1(Ic,r=>{r?n(!0):(this.router.navigate(["/auth","signin"]),n(!1))})}))}static{this.\u0275fac=function(r){return new(r||e)(Ct(Ms),Ct(wd))}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac})}}return e})();class qEe{constructor(t){this.nom=t}}let GEe=(()=>{class e{constructor(){this.items=[],this.itemSubject=new K,this.basket=[],this.basketSubject=new K}emitItems(){this.itemSubject.next(this.items)}saveItems(){Vh(ro(bo,"/items"),this.items)}getItems(){Zw(ro(bo,"/items"),n=>{this.items=n.val()?n.val():[],this.emitItems()})}emitBasket(){this.basketSubject.next(this.basket)}saveBasket(){Vh(ro(bo,"/basket"),this.basket)}getBasket(){Zw(ro(bo,"/basket"),n=>{this.basket=n.val()?n.val():[],this.emitBasket()})}crateNewItem(n){this.items.push(n),this.saveItems()}removeItem(n){const r=this.items.findIndex(i=>i===n);this.items.splice(r,1),this.saveItems(),this.emitItems()}transferItem(n,r,i){n.splice(n.indexOf(r),1),i.push(r),n===this.items?(this.items=n,this.basket=i):(this.basket=n,this.items=i),this.saveItems(),this.saveBasket(),this.emitItems(),this.emitBasket()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function WEe(e,t){if(1&e){const n=Mo();ge(0,"div",7)(1,"span"),we(2),be(),ge(3,"button",9),tn("click",function(){const i=yn(n).$implicit;return er(Et().OnDelete(i))}),Oa(),ge(4,"svg",10),pn(5,"path",11),be()()()}if(2&e){const n=t.$implicit;Me(2),dn(n.nom)}}function ZEe(e,t){if(1&e&&(ge(0,"div",8)(1,"span"),we(2),be()()),2&e){const n=t.$implicit;Me(2),dn(n.nom)}}let KEe=(()=>{class e{constructor(n,r){this.formBuilder=n,this.is=r,this.items=[],this.basket=[]}drop(n){n.previousContainer===n.container?ZD(n.container.data,n.previousIndex,n.currentIndex):this.is.transferItem(n.previousContainer.data,n.previousContainer.data[n.previousIndex],n.container.data)}ngOnInit(){this.initForm(),this.getItem(),this.getBasket()}getBasket(){this.basketSub=this.is.basketSubject.subscribe(n=>{this.basket=n}),this.is.getBasket()}getItem(){this.itemsSubsciption=this.is.itemSubject.subscribe(n=>{this.items=n})}initForm(){this.addItemForm=this.formBuilder.group({item:["",[Rl.required]]}),this.itemsSubsciption=this.is.itemSubject.subscribe(n=>{this.items=n}),this.is.getItems(),this.is.emitItems()}onSubmit(){const n=this.addItemForm.get("item")?.value,r=new qEe(n);this.is.crateNewItem(r),this.addItemForm.reset()}OnDelete(n){this.is.removeItem(n)}ngOnDestroy(){this.itemsSubsciption&&this.itemsSubsciption.unsubscribe(),this.basketSub&&this.basketSub.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(By),Re(GEe))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-shopping"]],decls:17,vars:3,consts:[["cdkDropListGroup","",1,"flex","flex-col","md:flex-row","gap-6"],[1,"card-fun","flex-1","p-6"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"mb-4",3,"ngSubmit","formGroup"],["formControlName","item","placeholder","Ex. Lait, Pain, Beurre...","required","",1,"input-fun","w-full"],["cdkDropList","",3,"cdkDropListDropped","cdkDropListData"],[1,"flex","flex-row","flex-wrap","gap-2"],["cdkDrag","",1,"cursor-move","flex","items-center","gap-1","py-1.5","px-3","rounded-full","bg-gradient-to-r","from-family-purple","to-family-lavender","text-white","text-xs","font-medium","shadow-sm","hover:shadow-md","transition-shadow"],["cdkDrag","",1,"cursor-move","flex","items-center","py-1.5","px-3","rounded-full","bg-gradient-to-r","from-family-green","to-emerald-400","text-white","text-xs","font-medium","shadow-sm","hover:shadow-md","transition-shadow"],["title","supprimer",1,"ml-1","hover:text-red-200","transition-colors",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"div",1)(2,"h3",2),we(3,"\u{1f6cd}\ufe0f Ajouter un Produit"),be(),ge(4,"form",3),tn("ngSubmit",function(){return i.onSubmit()}),pn(5,"input",4),be(),ge(6,"div",5),tn("cdkDropListDropped",function(a){return i.drop(a)}),ge(7,"div",6),Go(8,WEe,6,1,"div",7,xl),be()()(),ge(10,"div",1)(11,"h3",2),we(12,"\u{1f9fa} Panier"),be(),ge(13,"div",5),tn("cdkDropListDropped",function(a){return i.drop(a)}),ge(14,"div",6),Go(15,ZEe,3,1,"div",8,xl),be()()()()),2&r&&(Me(4),Un("formGroup",i.addItemForm),Me(2),Un("cdkDropListData",i.items),Me(2),Wo(i.items),Me(5),Un("cdkDropListData",i.basket),Me(2),Wo(i.basket))},dependencies:[eW,qN,$N,jN,Vy,bg,Ed,Ep,yg,xg,Dp,Cp],styles:[".container[_ngcontent-%COMP%]{width:400px;max-width:100%;margin:0 25px 25px 0;display:inline-block;vertical-align:top}.list[_ngcontent-%COMP%]{border:solid 1px #ccc;min-height:60px;background:#fff;border-radius:4px;overflow:hidden}.box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:#fff;font-size:14px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.box[_ngcontent-%COMP%]:last-child{border:none}.list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list[_ngcontent-%COMP%]{display:flex;padding-right:10px;padding-bottom:10px}form[_ngcontent-%COMP%]{display:flex;justify-content:space-around}"]})}}return e})();function YEe(e,t){if(1&e&&(ge(0,"option",8),we(1),be()),2&e){const n=t.$implicit;Un("value",n.displayName||n.email),Me(),dn(n.displayName||n.email)}}let XEe=(()=>{class e{constructor(n,r,i,o,a,c,p){this.route=n,this.tasksService=r,this.formBuilder=i,this._snackBar=o,this.router=a,this.dialog=c,this.userService=p,this.taskToEdit=null,this.allUsers=[]}onDelete(n){this.dialog.open(e2,{data:{customMessage:"Etes-vous s\xfbr(e) de vouloir supprimer la t\xe2che"}}).afterClosed().subscribe(i=>{!0===i&&(this.tasksService.removeTask(n.id),this.router.navigate(["/home"]))})}ngOnInit(){this.userService.getAllUsers().then(r=>this.allUsers=r).catch(()=>this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3}));const n=this.route.snapshot.params.id;this.tasksSubscription=this.tasksService.tasksSubject.subscribe(r=>{if(this.taskToEdit)return;const i=r.find(o=>o.id===n);i&&(this.taskToEdit=i,this.editTaskForm=this.formBuilder.group({id:[i.id,[Rl.required]],name:[i.name,[Rl.required]],urg:[i.urg,[Rl.required]],title:[i.title,[Rl.required]],descriptif:[i.descriptif],createdDate:[i.createdDate||""],statut:[i.statut||""]}))}),this.tasksService.getTasks(),this.tasksService.emitTasks()}editTask(){this.dialog.open(e2,{data:{customMessage:"Etes-vous s\xfbr(e) de vouloir modifier la t\xe2che"}}).afterClosed().subscribe(r=>{!0===r&&(this.tasksService.updateTaskById(this.route.snapshot.params.id,this.editTaskForm.value),this.router.navigate(["/home"]),this._snackBar.open("T\xe2che modifi\xe9e","avec succ\xe8s !!",{duration:5e3}))})}goBack(){this.router.navigate(["/home"])}ngOnDestroy(){this.tasksSubscription&&this.tasksSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re($m),Re(zy),Re(By),Re(cy),Re(Ms),Re(op),Re(wd))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-edit-task"]],decls:54,vars:1,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],["for","name",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","name","id","name",1,"input-fun","w-full"],["value","","disabled",""],["value","Tout le monde"],[3,"value"],["for","statut",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","statut","id","statut","required","",1,"input-fun","w-full"],["value","Nouveau"],["value","En cours"],["value","Fait"],["value","Bloque"],["value","Archive"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","D\xe9crivez la t\xe2che...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"px-4","py-2","rounded-xl","bg-red-50","text-red-500","hover:bg-red-100","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient","px-6","py-2",3,"click"]],template:function(r,i){1&r&&(ge(0,"div",0)(1,"div",1)(2,"h3",2),we(3,"\u{1f4dd} Editer la Tache"),be(),ge(4,"form",3)(5,"div")(6,"label",4),we(7,"Tache pour"),be(),ge(8,"select",5)(9,"option",6),we(10,"Choisir..."),be(),ge(11,"option",7),we(12,"Tout le monde"),be(),Go(13,YEe,2,2,"option",8,xl),be()(),ge(15,"div")(16,"label",9),we(17,"Statut"),be(),ge(18,"select",10)(19,"option",11),we(20,"Nouveau"),be(),ge(21,"option",12),we(22,"En cours"),be(),ge(23,"option",13),we(24,"Fait"),be(),ge(25,"option",14),we(26,"Bloque"),be(),ge(27,"option",15),we(28,"Archive"),be()()(),ge(29,"div")(30,"label",16),we(31,"Priorite"),be(),ge(32,"select",17)(33,"option",18),we(34,"Urgent !"),be(),ge(35,"option",19),we(36,"Relativement urgent"),be(),ge(37,"option",20),we(38,"Pas Urgent"),be()()(),ge(39,"div")(40,"label",21),we(41,"Titre"),be(),pn(42,"input",22),be(),ge(43,"div")(44,"label",23),we(45,"Descriptif"),be(),pn(46,"textarea",24),be(),ge(47,"div",25)(48,"button",26),tn("click",function(){return i.goBack()}),we(49,"Retour"),be(),ge(50,"button",27),tn("click",function(){return i.onDelete(i.taskToEdit)}),we(51,"Supprimer"),be(),ge(52,"button",28),tn("click",function(){return i.editTask()}),we(53,"Modifier"),be()()()()()),2&r&&(Me(4),Un("formGroup",i.editTaskForm),Me(9),Wo(i.allUsers))},dependencies:[Vy,bg,$D,qD,Ed,Fy,Ep,yg,xg,Dp,Cp],encapsulation:2})}}return e})();const QEe=["previewImg"];function JEe(e,t){1&e&&(ge(0,"span",15),we(1,"Charge !"),be())}function eCe(e,t){if(1&e){const n=Mo();ge(0,"div",7)(1,"h3",8),we(2,"\u270f\ufe0f Modifier le profil"),be(),ge(3,"form",9),tn("ngSubmit",function(){return yn(n),er(Et().onSubmitProfileForm())}),ge(4,"div",10),pn(5,"img",11),ge(6,"label",12)(7,"span",13),we(8,"Choisir une photo"),be(),ge(9,"input",14),tn("change",function(i){return yn(n),er(Et().detectFiles(i))}),be()(),hr(10,JEe,2,0,"span",15),be(),ge(11,"div")(12,"label",16),we(13,"Prenom"),be(),pn(14,"input",17),be(),ge(15,"div")(16,"label",18),we(17,"Telephone"),be(),pn(18,"input",19),be(),ge(19,"div")(20,"label",20),we(21,"Email"),be(),pn(22,"input",21),be(),ge(23,"div")(24,"label",22),we(25,"Anniversaire"),be(),pn(26,"input",23),be(),ge(27,"button",24),we(28,"Enregistrer"),be()()(),ge(29,"div",25)(30,"h3",8),we(31,"\u{1f4c5} Google Calendar"),be(),ge(32,"div",26),pn(33,"div",27),ge(34,"span",28),we(35,"Connecte automatiquement via votre compte Google"),be()()()}if(2&e){const n=Et();Me(3),Un("formGroup",n.profileForm),Me(2),Un("src",n.fileUrl,pc),Me(5),fr(n.fileUploaded?10:-1),Me(17),Un("disabled",n.profileForm.invalid)}}let tCe=(()=>{class e{constructor(n,r,i){this.editProfileService=n,this._snackBar=r,this.formBuilder=i,this.user=null,this.fileIsUploading=!1,this.fileUploaded=!1}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(n=>{this.user=n,this.user&&this.initForm(this.user)},()=>{this._snackBar.open("Erreur lors du chargement du profil","",{duration:5e3})})}initForm(n){this.profileForm=this.formBuilder.group({emailControl:[{value:n?.email||"",disabled:!0},[Rl.required,Rl.email]],displayNameControl:[n?.displayName||""],phoneNumberControl:[n?.phoneNumber||""],photoURLControl:[""],dateBirthControl:[n?.dateBirth?n.dateBirth.substring(0,10):""]}),this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"}loadFile(n){this.fileIsUploading=!0,this.editProfileService.deleteOldAvatar(this.user?.photoURL||"").then(()=>this.editProfileService.uploadFile(n)).then(i=>{this.fileUrl=i,this.profileForm.get("photoURLControl")?.setValue(""),this.fileIsUploading=!1,this.fileUploaded=!0})}detectFiles(n){const r=n.target;r.files?.[0]&&this.loadFile(r.files[0])}onSubmitProfileForm(){const n=this.user?.uid;if(!n)return;const r=this.profileForm.value;this.editProfileService.updateUserData(n,{displayName:r.displayNameControl,phoneNumber:r.phoneNumberControl,photoURL:this.fileUrl,dateBirth:r.dateBirthControl}).then(()=>this._snackBar.open("Profil mis a jour","avec succes !!",{duration:5e3})).catch(()=>this._snackBar.open("Erreur lors de la mise a jour","",{duration:5e3}))}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(SD),Re(cy),Re(By))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-user-profile"]],viewQuery:function(r,i){if(1&r&&Mm(QEe,5),2&r){let o;Zf(o=Kf())&&(i.previewImg=o.first)}},decls:10,vars:4,consts:[[1,"card-fun","overflow-hidden","mb-6"],[1,"h-24","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange"],[1,"px-6","pb-6","-mt-10","flex","items-end","gap-4"],["alt","Photo de profil",1,"h-20","w-20","rounded-full","object-cover","ring-4","ring-white","shadow-lg",3,"src"],[1,"pb-1"],[1,"font-display","text-xl","font-bold","text-gray-700"],[1,"text-sm","text-gray-400"],[1,"card-fun","p-6","max-w-lg","mx-auto"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4"],["alt","Avatar",1,"h-14","w-14","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"block"],[1,"sr-only"],["formControlName","photoURLControl","type","file","accept","image/*",1,"block","w-full","text-sm","text-gray-500","file:mr-3","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-family-pink/10","file:text-family-pink","hover:file:bg-family-pink/20","transition-colors",3,"change"],[1,"text-family-green","text-sm","font-medium"],["for","prenom",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","text","id","prenom","formControlName","displayNameControl","placeholder","Prenom",1,"input-fun","w-full"],["for","phone",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","tel","id","phone","formControlName","phoneNumberControl","placeholder","Votre numero",1,"input-fun","w-full"],["for","email",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","email","id","email","formControlName","emailControl","placeholder","Votre email",1,"input-fun","w-full"],["for","dateBirth",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","date","id","dateBirth","formControlName","dateBirthControl",1,"input-fun","w-full"],["type","submit",1,"btn-gradient","w-full",3,"disabled"],[1,"card-fun","p-6","max-w-lg","mx-auto","mt-6"],[1,"flex","items-center","gap-3"],[1,"w-3","h-3","rounded-full","bg-family-green"],[1,"text-sm","text-gray-600"]],template:function(r,i){1&r&&(ge(0,"div",0),pn(1,"div",1),ge(2,"div",2),pn(3,"img",3),ge(4,"div",4)(5,"h2",5),we(6),be(),ge(7,"p",6),we(8),be()()()(),hr(9,eCe,36,4)),2&r&&(Me(3),Un("src",i.fileUrl,pc),Me(3),dn((null==i.user?null:i.user.displayName)||"Mon Profil"),Me(2),dn(null==i.user?null:i.user.email),Me(),fr(i.profileForm?9:-1))},dependencies:[Vy,bg,Ed,Ep,yg,Dp,Cp],encapsulation:2})}}return e})();const Tp={production:!0,googleCalendar:{apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",clientId:"728695329604-70417p57psoofhqlsio6qjv705a0ieqf.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],scopes:"https://www.googleapis.com/auth/calendar",familyCalendarId:"family12498967542838679084@group.calendar.google.com"}},nCe=(e,t)=>t.id;function rCe(e,t){if(1&e&&(ge(0,"option",16),we(1),be()),2&e){const n=t.$implicit;Un("value",n.id),Me(),dn(n.summary)}}function iCe(e,t){if(1&e&&(ge(0,"div")(1,"label",3),we(2,"Agenda"),be(),ge(3,"select",15),Go(4,rCe,2,2,"option",16,nCe),be()()),2&e){const n=Et();Me(4),Wo(n.data.calendars)}}function oCe(e,t){1&e&&(ge(0,"div",9)(1,"div")(2,"label",3),we(3,"Heure debut"),be(),pn(4,"input",17),be(),ge(5,"div")(6,"label",3),we(7,"Heure fin"),be(),pn(8,"input",18),be()())}let sCe=(()=>{class e{constructor(n,r,i){this.fb=n,this.dialogRef=r,this.data=i;const o=i.date.toISOString().substring(0,10),a=Tp.googleCalendar.familyCalendarId,c=i.calendars?.find(p=>p.id===a)?.id||i.calendars?.find(p=>p.primary)?.id||"primary";this.eventForm=this.fb.group({title:["",Rl.required],description:[""],calendarId:[c],allDay:[!0],startDate:[o,Rl.required],endDate:[o,Rl.required],startTime:["09:00"],endTime:["10:00"]})}onCancel(){this.dialogRef.close()}onSubmit(){if(this.eventForm.invalid)return;const n=this.eventForm.value;this.dialogRef.close({id:"",title:n.title,description:n.description,allDay:n.allDay,calendarId:n.calendarId||"primary",startDate:n.allDay?n.startDate:`${n.startDate}T${n.startTime}:00`,endDate:n.allDay?n.endDate:`${n.endDate}T${n.endTime}:00`})}static{this.\u0275fac=function(r){return new(r||e)(Re(By),Re(Qm),Re(u1))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-add-event-dialog"]],decls:32,vars:4,consts:[[1,"p-6"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","placeholder","Ex. Reunion famille...","required","",1,"input-fun","w-full"],["formControlName","description","rows","3","placeholder","Details...",1,"input-fun","w-full","resize-y"],[1,"flex","items-center","gap-2","mb-2"],["type","checkbox","formControlName","allDay","id","allDay",1,"rounded"],["for","allDay",1,"text-sm","text-gray-600"],[1,"grid","grid-cols-2","gap-3"],["formControlName","startDate","type","date",1,"input-fun","w-full"],["formControlName","endDate","type","date",1,"input-fun","w-full"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"btn-gradient","px-6","py-2",3,"click","disabled"],["formControlName","calendarId",1,"input-fun","w-full"],[3,"value"],["formControlName","startTime","type","time",1,"input-fun","w-full"],["formControlName","endTime","type","time",1,"input-fun","w-full"]],template:function(r,i){if(1&r&&(ge(0,"div",0)(1,"h2",1),we(2,"Nouvel evenement"),be(),ge(3,"form",2)(4,"div")(5,"label",3),we(6,"Titre"),be(),pn(7,"input",4),be(),hr(8,iCe,6,0,"div"),ge(9,"div")(10,"label",3),we(11,"Description"),be(),pn(12,"textarea",5),be(),ge(13,"div",6),pn(14,"input",7),ge(15,"label",8),we(16,"Toute la journee"),be()(),ge(17,"div",9)(18,"div")(19,"label",3),we(20,"Debut"),be(),pn(21,"input",10),be(),ge(22,"div")(23,"label",3),we(24,"Fin"),be(),pn(25,"input",11),be()(),hr(26,oCe,9,0,"div",9),ge(27,"div",12)(28,"button",13),tn("click",function(){return i.onCancel()}),we(29," Annuler "),be(),ge(30,"button",14),tn("click",function(){return i.onSubmit()}),we(31," Creer "),be()()()()),2&r){let o;Me(3),Un("formGroup",i.eventForm),Me(5),fr(i.data.calendars&&i.data.calendars.length>1?8:-1),Me(18),fr(null!=(o=i.eventForm.get("allDay"))&&o.value?-1:26),Me(4),Un("disabled",i.eventForm.invalid)}},dependencies:[Vy,bg,$D,qD,Ed,gN,Fy,Ep,yg,xg,Dp,Cp],encapsulation:2})}}return e})();function aCe(e,t){if(1&e&&(jt(0,"div",5)(1,"span",6),we(2,"\u{1f4c5}"),Bt(),jt(3,"span"),we(4),Bt()()),2&e){const n=Et();Me(4),dn(n.data.event.calendarName)}}function lCe(e,t){if(1&e&&(jt(0,"span"),we(1),H_(2,"date"),Bt()),2&e){const n=Et();Me(),gc("Toute la journee \xb7 ",$_(2,1,n.data.event.startDate,"EEEE d MMMM yyyy","","fr"))}}function cCe(e,t){if(1&e&&(jt(0,"span"),we(1),H_(2,"date"),H_(3,"date"),Bt()),2&e){const n=Et();Me(),II("",$_(2,2,n.data.event.startDate,"EEEE d MMMM yyyy, HH:mm","","fr")," \u2014 ",$_(3,7,n.data.event.endDate,"HH:mm","","fr"))}}function uCe(e,t){if(1&e&&(jt(0,"div",7)(1,"span",11),we(2,"\u{1f4cd}"),Bt(),jt(3,"span"),we(4),Bt()()),2&e){const n=Et();Me(4),dn(n.data.event.location)}}function dCe(e,t){if(1&e&&(jt(0,"div",5)(1,"span",6),we(2,"\u{1f464}"),Bt(),jt(3,"span"),we(4,"Cree par : "),jt(5,"span",12),we(6),Bt()()()),2&e){const n=Et();Me(6),dn(n.data.event.creatorName)}}function hCe(e,t){if(1&e&&(jt(0,"div",8),we(1),Bt()),2&e){const n=Et();Me(),dn(n.data.event.description)}}let fCe=(()=>{class e{constructor(n,r){this.dialogRef=n,this.data=r}close(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||e)(Re(Qm),Re(u1))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-event-detail-dialog"]],decls:18,vars:8,consts:[[1,"p-6"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-3","h-3","rounded-full","shrink-0"],[1,"font-display","text-lg","font-bold","text-gray-700"],[1,"space-y-3","text-sm"],[1,"flex","items-center","gap-2","text-gray-500"],[1,"w-5","text-center"],[1,"flex","items-start","gap-2","text-gray-500"],[1,"mt-3","p-3","bg-gray-50","rounded-xl","text-gray-600","text-sm","whitespace-pre-wrap"],[1,"flex","justify-end","pt-4"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"w-5","text-center","shrink-0"],[1,"font-medium","text-gray-600"]],template:function(r,i){1&r&&(jt(0,"div",0)(1,"div",1),od(2,"div",2),jt(3,"h2",3),we(4),Bt()(),jt(5,"div",4),hr(6,aCe,5,1,"div",5),jt(7,"div",5)(8,"span",6),we(9,"\u{1f550}"),Bt(),hr(10,lCe,3,6,"span")(11,cCe,4,12,"span"),Bt(),hr(12,uCe,5,1,"div",7),hr(13,dCe,7,1,"div",5),hr(14,hCe,2,1,"div",8),Bt(),jt(15,"div",9)(16,"button",10),la("click",function(){return i.close()}),we(17," Fermer "),Bt()()()),2&r&&(Me(2),j_("background-color",i.data.event.color||"#4285f4"),Me(2),dn(i.data.event.title),Me(2),fr(i.data.event.calendarName?6:-1),Me(4),fr(i.data.event.allDay?10:11),Me(2),fr(i.data.event.location?12:-1),Me(),fr(i.data.event.creatorName?13:-1),Me(),fr(i.data.event.description?14:-1))},dependencies:[wC,bC],encapsulation:2})}}return e})(),hW=(()=>{class e{constructor(n){this.authService=n,this.gapiLoaded=!1,this.tokenClient=null,this.accessToken=null,this.googleEmail=null,this.signInResolve=null,this.connectionChanged=new K,this.authService.googleToken$.subscribe(r=>{this.setToken(r)}),M1(Ic,r=>{r&&!this.accessToken&&setTimeout(()=>{this.accessToken||this.requestTokenSilently()},1500)})}requestTokenSilently(){var n=this;return _e(function*(){try{yield n.loadGapi(),yield n.initTokenClient(),n.tokenClient&&n.tokenClient.requestAccessToken({prompt:""})}catch{}})()}setToken(n){this.accessToken=n,this.loadGapi().then(()=>{gapi.client.setToken({access_token:n})}).catch(()=>{}),this.fetchGoogleEmail(),this.saveConnectionStatus(!0),this.connectionChanged.next(!0)}loadGapi(){var n=this;return this.gapiLoaded?Promise.resolve():new Promise((r,i)=>{const o=()=>{typeof gapi>"u"?setTimeout(o,200):gapi.load("client",_e(function*(){try{yield gapi.client.init({discoveryDocs:Tp.googleCalendar.discoveryDocs}),n.gapiLoaded=!0,r()}catch(a){i(a)}}))};o()})}initTokenClient(){return new Promise(n=>{const r=()=>{typeof google>"u"||!google.accounts?.oauth2?setTimeout(r,200):(this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:Tp.googleCalendar.clientId,scope:Tp.googleCalendar.scopes,callback:i=>{i.error?this.signInResolve&&(this.signInResolve(!1),this.signInResolve=null):(this.accessToken=i.access_token||null,this.accessToken&&(gapi.client.setToken({access_token:this.accessToken}),this.fetchGoogleEmail()),this.saveConnectionStatus(!!this.accessToken),this.connectionChanged.next(!!this.accessToken),this.signInResolve&&(this.signInResolve(!!this.accessToken),this.signInResolve=null))}}),n())};r()})}signIn(){return new Promise(n=>{this.tokenClient?(this.signInResolve=n,this.tokenClient.requestAccessToken({prompt:"consent"})):n(!1)})}signOut(){if(this.accessToken){try{google.accounts.oauth2.revoke(this.accessToken)}catch{}try{gapi.client.setToken(null)}catch{}this.accessToken=null,this.googleEmail=null,this.saveConnectionStatus(!1),this.connectionChanged.next(!1)}}isConnected(){return!!this.accessToken}getAccessToken(){return this.accessToken}getGoogleEmail(){return this.googleEmail}fetchGoogleEmail(){var n=this;return _e(function*(){try{const i=yield(yield fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${n.accessToken}`}})).json();n.googleEmail=i.email||null}catch{n.googleEmail=null}})()}saveConnectionStatus(n){const r=Ic.currentUser?.uid;r&&U$(ro(bo,`/users/${r}`),{googleCalendar:{connected:n,calendarId:"primary"}})}static{this.\u0275fac=function(r){return new(r||e)(Ct(wd))}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),pCe=(()=>{class e{constructor(n,r){this.googleAuth=n,this.authService=r,this.events=[],this.eventsSubject=new K,this.calendars=[],this.calendarsSubject=new K}emitEvents(){this.eventsSubject.next(this.events)}ensureToken(){const n=this.googleAuth.getAccessToken();n&&gapi.client.setToken({access_token:n})}getCalendars(){var n=this;return _e(function*(){if(!n.googleAuth.isConnected())return[];try{yield n.googleAuth.loadGapi(),n.ensureToken();const r=yield gapi.client.calendar.calendarList.list();console.log("Calendar list response:",r.result.items?.length,"calendars");const i=(r.result.items||[]).filter(a=>{const c=a.id||"";return!(c.includes("#weeknum")||c.includes("#contacts")||c.includes("#holiday")||c.includes("addressbook")||c.endsWith("#birthday@group.v.calendar.google.com"))});n.calendars=i.map(a=>({id:a.id,summary:a.summary||a.id,backgroundColor:a.backgroundColor||"#4285f4",primary:!!a.primary}));const o=Tp.googleCalendar.familyCalendarId;return o&&!n.calendars.find(a=>a.id===o)&&n.calendars.push({id:o,summary:"Famille",backgroundColor:"#e67c73"}),n.calendarsSubject.next(n.calendars),n.calendars}catch{return[]}})()}getEvents(n,r){var i=this;return _e(function*(){if(!i.googleAuth.isConnected())return[];try{yield i.googleAuth.loadGapi(),i.ensureToken(),0===i.calendars.length&&(yield i.getCalendars());const o=Ic.currentUser,a=i.calendars.map(function(){var _=_e(function*(x){try{return((yield gapi.client.calendar.events.list({calendarId:x.id,timeMin:n.toISOString(),timeMax:r.toISOString(),showDeleted:!1,singleEvents:!0,orderBy:"startTime"})).result.items||[]).map(A=>({id:A.id,title:A.summary||"(Sans titre)",description:A.description||"",startDate:A.start?.dateTime||A.start?.date||"",endDate:A.end?.dateTime||A.end?.date||"",allDay:!!A.start?.date,color:x.backgroundColor,calendarId:x.id,calendarName:x.summary,location:A.location||"",creatorUid:o?.uid||"",creatorName:A.creator?.displayName||A.creator?.email||""}))}catch(D){return console.error("Error fetching events from",x.id,D),[]}});return function(x){return _.apply(this,arguments)}}()),c=yield Promise.all(a),p=[];return c.forEach(_=>p.push(..._)),console.log("Total events fetched:",p.length,"from",i.calendars.length,"calendars"),p.sort((_,x)=>_.startDate.localeCompare(x.startDate)),i.events=p,i.emitEvents(),i.events}catch{return[]}})()}createEvent(n){var r=this;return _e(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=n.calendarId||Tp.googleCalendar.familyCalendarId||"primary",o={summary:n.title,description:n.description||""};n.allDay?(o.start={date:n.startDate.substring(0,10)},o.end={date:n.endDate.substring(0,10)}):(o.start={dateTime:n.startDate},o.end={dateTime:n.endDate});const a=yield gapi.client.calendar.events.insert({calendarId:i,resource:o}),c=r.calendars.find(_=>_.id===i);return{id:a.result.id,title:a.result.summary,description:a.result.description||"",startDate:a.result.start?.dateTime||a.result.start?.date||"",endDate:a.result.end?.dateTime||a.result.end?.date||"",allDay:!!a.result.start?.date,calendarId:i,calendarName:c?.summary||i,color:c?.backgroundColor}}catch{return null}})()}deleteEvent(n){var r=this;return _e(function*(i,o="primary"){if(r.googleAuth.isConnected())try{yield r.googleAuth.loadGapi(),r.ensureToken(),yield gapi.client.calendar.events.delete({calendarId:o,eventId:i})}catch{}}).apply(this,arguments)}static{this.\u0275fac=function(r){return new(r||e)(Ct(hW),Ct(wd))}}static{this.\u0275prov=Ue({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const t2=(e,t)=>t.id;function mCe(e,t){if(1&e){const n=Mo();jt(0,"div",4)(1,"div",5),we(2,"\u{1f4c5}"),Bt(),jt(3,"h2",6),we(4,"Chargement du calendrier..."),Bt(),jt(5,"p",7),we(6,"Connexion a Google Calendar en cours"),Bt(),jt(7,"button",8),la("click",function(){return yn(n),er(Et().connectGoogle())}),we(8," Reconnecter Google Calendar "),Bt()()}}function gCe(e,t){if(1&e&&(jt(0,"div",24),od(1,"div",25),jt(2,"span",26),we(3),Bt()()),2&e){const n=t.$implicit;Me(),j_("background-color",n.backgroundColor),Me(2),dn(n.summary)}}function _Ce(e,t){if(1&e&&(jt(0,"div",17)(1,"div",23),Go(2,gCe,4,3,"div",24,t2),Bt()()),2&e){const n=Et(2);Me(2),Wo(n.calendars)}}function yCe(e,t){if(1&e&&(jt(0,"div",20),we(1),Bt()),2&e){const n=t.$implicit;Me(),dn(n)}}function vCe(e,t){if(1&e&&(jt(0,"span",32),we(1),Bt()),2&e){const n=Et(2).$implicit,r=Et(3);Me(),gc("S",r.getWeekNumber(n))}}function bCe(e,t){if(1&e){const n=Mo();jt(0,"div",34),la("click",function(i){const o=yn(n).$implicit;return Et(5).viewEvent(o),er(i.stopPropagation())}),we(1),Bt()}if(2&e){const n=t.$implicit;j_("background-color",n.color||"#4285f4"),tb("title",n.calendarName?n.calendarName+" \u2014 "+n.title:n.title),Me(),gc(" ",n.title," ")}}function wCe(e,t){if(1&e){const n=Mo();jt(0,"div",29),la("click",function(){yn(n);const i=Et().$implicit;return er(Et(3).openAddEvent(i))}),jt(1,"div",30)(2,"span",31),we(3),Bt(),hr(4,vCe,2,1,"span",32),Bt(),Go(5,bCe,2,4,"div",33,t2),Bt()}if(2&e){const n=Et().$implicit,r=Et(3);El("bg-gradient-to-br",r.isToday(n))("from-family-pink/10",r.isToday(n))("to-family-orange/10",r.isToday(n))("border-family-pink",r.isToday(n))("border-gray-100",!r.isToday(n)),Me(2),El("text-family-pink",r.isToday(n))("text-gray-600",!r.isToday(n)),Me(),gc(" ",n.getDate()," "),Me(),fr(r.isMonday(n)?4:-1),Me(),Wo(r.getEventsForDay(n))}}function xCe(e,t){1&e&&od(0,"div",28)}function ECe(e,t){1&e&&hr(0,wCe,7,16,"div",27)(1,xCe,1,0,"div",28),2&e&&fr(t.$implicit?0:1)}function CCe(e,t){if(1&e&&(jt(0,"div",21),Go(1,ECe,2,1,null,null,hI),Bt()),2&e){const n=t.$implicit;Me(),Wo(n)}}function DCe(e,t){if(1&e&&(jt(0,"span",43),we(1),Bt(),we(2," \xb7 ")),2&e){const n=Et().$implicit;Me(),dn(n.calendarName)}}function TCe(e,t){1&e&&we(0),2&e&&gc(" ",Et().$implicit.creatorName," \xb7 ")}function SCe(e,t){1&e&&we(0," Toute la journee ")}function ICe(e,t){1&e&&(we(0),H_(1,"date")),2&e&&gc(" ",$_(1,1,Et().$implicit.startDate,"d MMM, HH:mm","","fr")," ")}function kCe(e,t){if(1&e){const n=Mo();jt(0,"button",44),la("click",function(i){yn(n);const o=Et().$implicit;return Et(3).deleteEvent(o),er(i.stopPropagation())}),we(1," Supprimer "),Bt()}}function ACe(e,t){if(1&e){const n=Mo();jt(0,"div",37),la("click",function(){const i=yn(n).$implicit;return er(Et(3).viewEvent(i))}),jt(1,"div",38),od(2,"div",39),jt(3,"div")(4,"div",40),we(5),Bt(),jt(6,"div",41),hr(7,DCe,3,1),hr(8,TCe,1,1),hr(9,SCe,1,0)(10,ICe,2,6),Bt()()(),hr(11,kCe,2,0,"button",42),Bt()}if(2&e){const n=t.$implicit,r=Et(3);Me(2),j_("background-color",n.color||"#4285f4"),Me(3),dn(n.title),Me(2),fr(n.calendarName?7:-1),Me(),fr(n.creatorName?8:-1),Me(),fr(n.allDay?9:10),Me(2),fr(r.canDelete(n)?11:-1)}}function RCe(e,t){if(1&e&&(jt(0,"div",22)(1,"h3",35),we(2,"Prochains evenements"),Bt(),Go(3,ACe,12,7,"div",36,t2),Bt()),2&e){const n=Et(2);Me(3),Wo(n.events)}}function MCe(e,t){if(1&e){const n=Mo();jt(0,"div",9)(1,"div",10)(2,"div",11)(3,"button",12),la("click",function(){return yn(n),er(Et().previousMonth())}),we(4," < "),Bt(),jt(5,"h2",13),we(6),Bt(),jt(7,"button",12),la("click",function(){return yn(n),er(Et().nextMonth())}),we(8," > "),Bt(),jt(9,"button",14),la("click",function(){return yn(n),er(Et().goToday())}),we(10," Aujourd'hui "),Bt()(),jt(11,"div",15)(12,"button",16),la("click",function(){return yn(n),er(Et().openAddEvent())}),we(13," + Nouvel evenement "),Bt()()()(),hr(14,_Ce,4,0,"div",17),jt(15,"div",18)(16,"div",19),Go(17,yCe,2,1,"div",20,xl),Bt(),Go(19,CCe,3,0,"div",21,hI),Bt(),hr(21,RCe,5,0,"div",22)}if(2&e){const n=Et();Me(6),gc(" ",n.monthLabel," "),Me(8),fr(n.calendars.length>1?14:-1),Me(3),Wo(n.weekDays),Me(2),Wo(n.daysInMonth),Me(2),fr(n.events.length>0?21:-1)}}const PCe=[{path:"auth/signin",component:Oxe},{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",canActivate:[jh],component:fEe},{path:"user-profile",canActivate:[jh],component:tCe},{path:"add-task",canActivate:[jh],component:Mxe},{path:"photo",canActivate:[jh],component:$Ee},{path:"shopping",canActivate:[jh],component:KEe},{path:"map",canActivate:[jh],component:PEe},{path:"calendar",canActivate:[jh],component:(()=>{class e{constructor(n,r,i,o){this.googleAuth=n,this.calendarService=r,this.dialog=i,this.snackBar=o,this.isConnected=!1,this.currentDate=new Date,this.viewMode="month",this.events=[],this.calendars=[],this.daysInMonth=[],this.weekDays=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]}ngOnInit(){this.eventsSubscription=this.calendarService.eventsSubject.subscribe(n=>this.events=n.filter(r=>!this.isWeekNumberEvent(r))),this.calendarsSubscription=this.calendarService.calendarsSubject.subscribe(n=>this.calendars=n),this.connectionSubscription=this.googleAuth.connectionChanged.subscribe(n=>{this.isConnected=n,n&&this.loadEvents()}),this.initGoogle(),this.buildCalendarGrid()}initGoogle(){var n=this;return _e(function*(){try{yield n.googleAuth.loadGapi(),yield n.googleAuth.initTokenClient();const r=n.googleAuth.getAccessToken();r&&window.gapi.client.setToken({access_token:r}),n.isConnected=n.googleAuth.isConnected(),n.isConnected&&n.loadEvents()}catch{}})()}connectGoogle(){this.googleAuth.signIn().then(n=>{this.isConnected=n,n&&(this.loadEvents(),this.snackBar.open("Google Calendar connecte !","",{duration:3e3}))})}disconnectGoogle(){this.googleAuth.signOut(),this.isConnected=!1,this.events=[],this.snackBar.open("Google Calendar deconnecte","",{duration:3e3})}loadEvents(){const{start:n,end:r}=this.getMonthRange();this.calendarService.getEvents(n,r)}getMonthRange(){const n=this.currentDate.getFullYear(),r=this.currentDate.getMonth();return{start:new Date(n,r,1),end:new Date(n,r+1,0,23,59,59)}}buildCalendarGrid(){const n=this.currentDate.getFullYear(),r=this.currentDate.getMonth(),i=new Date(n,r,1),o=new Date(n,r+1,0);let a=i.getDay()-1;a<0&&(a=6);const c=[];for(let p=0;p<a;p++)c.push(null);for(let p=1;p<=o.getDate();p++)c.push(new Date(n,r,p));for(;c.length%7!=0;)c.push(null);this.daysInMonth=[];for(let p=0;p<c.length;p+=7)this.daysInMonth.push(c.slice(p,p+7))}isWeekNumberEvent(n){const r=n.title.trim();return/^(S|W|Wk|Semaine|Week)\s?\d{1,2}$/.test(r)||(n.calendarId?.includes("#weeknum")??!1)}getEventsForDay(n){if(!n)return[];const r=n.toISOString().substring(0,10);return this.events.filter(i=>i.startDate.substring(0,10)===r&&!this.isWeekNumberEvent(i))}getWeekNumber(n){if(!n)return 0;const r=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));const i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}isMonday(n){return!!n&&1===n.getDay()}isToday(n){if(!n)return!1;const r=new Date;return n.getDate()===r.getDate()&&n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()}previousMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}goToday(){this.currentDate=new Date,this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}get monthLabel(){return this.currentDate.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}openAddEvent(n){this.dialog.open(sCe,{data:{date:n||new Date,calendars:this.calendars},width:"400px"}).afterClosed().subscribe(i=>{i&&this.calendarService.createEvent(i).then(o=>{o&&(this.loadEvents(),this.snackBar.open("Evenement cree !","",{duration:3e3}))})})}viewEvent(n){this.dialog.open(fCe,{data:{event:n},width:"400px"})}canDelete(n){const r=this.googleAuth.getGoogleEmail();return!!r&&n.creatorName===r}deleteEvent(n){this.calendarService.deleteEvent(n.id,n.calendarId||"primary").then(()=>{this.loadEvents(),this.snackBar.open("Evenement supprime","",{duration:3e3})})}ngOnDestroy(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.calendarsSubscription&&this.calendarsSubscription.unsubscribe(),this.connectionSubscription&&this.connectionSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)(Re(hW),Re(pCe),Re(op),Re(cy))}}static{this.\u0275cmp=Er({type:e,selectors:[["app-calendar"]],decls:8,vars:2,consts:[[1,"max-w-4xl","mx-auto"],[1,"card-fun","bg-gradient-to-r","from-family-sky","via-family-purple","to-family-pink","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"card-fun","p-8","text-center"],[1,"text-5xl","mb-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-2"],[1,"text-gray-500","mb-6"],[1,"btn-gradient","px-6","py-3","text-lg",3,"click"],[1,"card-fun","p-4","mb-4"],[1,"flex","items-center","justify-between","flex-wrap","gap-3"],[1,"flex","items-center","gap-2"],[1,"p-2","rounded-xl","hover:bg-warm-50","transition-colors","text-gray-600",3,"click"],[1,"font-display","font-bold","text-gray-700","text-lg","capitalize","min-w-[180px]","text-center"],[1,"ml-2","px-3","py-1","rounded-xl","border","border-gray-200","text-sm","text-gray-600","hover:bg-warm-50","transition-colors",3,"click"],[1,"flex","gap-2"],[1,"btn-gradient","px-4","py-2","text-sm",3,"click"],[1,"card-fun","p-3","mb-4"],[1,"card-fun","p-4"],[1,"grid","grid-cols-7","gap-1","mb-2"],[1,"text-center","text-xs","font-semibold","text-gray-500","py-2"],[1,"grid","grid-cols-7","gap-1","mb-1"],[1,"card-fun","p-4","mt-4"],[1,"flex","flex-wrap","gap-3"],[1,"flex","items-center","gap-1.5"],[1,"w-3","h-3","rounded-full"],[1,"text-xs","text-gray-600","font-medium"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"bg-gradient-to-br","from-family-pink/10","to-family-orange/10","border-family-pink","border-gray-100"],[1,"min-h-20","p-1","rounded-xl","bg-gray-50/50"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"click"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold"],[1,"text-[9px]","text-gray-300","font-medium"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"background-color","title"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"click","title"],[1,"font-display","font-bold","text-gray-700","mb-3"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-2","h-2","rounded-full"],[1,"font-medium","text-gray-700","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors"],[1,"font-medium"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors",3,"click"]],template:function(r,i){1&r&&(jt(0,"div",0)(1,"div",1)(2,"h1",2),we(3,"Calendrier"),Bt(),jt(4,"p",3),we(5,"Vos evenements Google Calendar"),Bt()(),hr(6,mCe,9,0,"div",4),hr(7,MCe,22,3),Bt()),2&r&&(Me(6),fr(i.isConnected?-1:6),Me(),fr(i.isConnected?7:-1))},dependencies:[wC,bC],encapsulation:2})}}return e})()},{path:"task/edit/:id",canActivate:[jh],component:XEe}];IU(e5),function ire(){return ok.apply(this,arguments)}(R0e,{providers:[function cte(e){const t=e?.scheduleInRootZone,n=function lte({ngZoneFactory:e,scheduleInRootZone:t}){return e??=()=>new Xt({...Wz(),scheduleInRootZone:t}),[{provide:Gu,useValue:!1},{provide:Xt,useFactory:e},{provide:Vs,multi:!0,useFactory:()=>{const n=Z(ste,{optional:!0});return()=>n.initialize()}},{provide:Vs,multi:!0,useFactory:()=>{const n=Z(ute);return()=>{n.initialize()}}},{provide:N0,useValue:t??Gp}]}({ngZoneFactory:()=>{const r=Wz(e);return r.scheduleInRootZone=t,r.shouldCoalesceEventChangeDetection&&qo("NgZone_CoalesceEvent"),new Xt(r)},scheduleInRootZone:t});return Ra([{provide:ate,useValue:!0},n])}(),function Ece(e,...t){return Ra([{provide:Ub,multi:!0,useValue:e},[],{provide:$m,useFactory:M4},{provide:ZS,multi:!0,useFactory:P4},t.map(n=>n.\u0275providers)])}(PCe),function noe(){return qo("NgEagerAnimations"),[...toe]}(),function cue(...e){const t=[eue,MA,{provide:PA,useExisting:MA},{provide:$C,useFactory:()=>Z(q4,{optional:!0})??Z(G4)},{provide:Gb,useValue:lue,multi:!0}];for(const n of e)t.push(...n.\u0275providers);return Ra(t)}(),uf(che,Dhe,khe.register("ngsw-worker.js",{enabled:Tp.production,registrationStrategy:"registerWhenStable:30000"})),wd,jh,zy,JN,SD,{provide:gh,useValue:"fr-FR"}]}).catch(e=>console.error(e))}},jy=>{jy(jy.s=689)}]);