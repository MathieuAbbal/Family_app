(self.webpackChunkfamilyapp=self.webpackChunkfamilyapp||[]).push([[792],{197(Zy){Zy.exports=function(){"use strict";var ef,Nd,eo;function Od(v,Zo){if(ef)if(Nd){var ze="var sharedChunk = {}; ("+ef+")(sharedChunk); ("+Nd+")(sharedChunk);",Tt={};ef(Tt),eo=Zo(Tt),typeof window<"u"&&(eo.workerUrl=window.URL.createObjectURL(new Blob([ze],{type:"text/javascript"})))}else Nd=Zo;else ef=Zo}return Od(0,function(v){function Zo(s,l){return s(l={exports:{}},l.exports),l.exports}var ze=Tt;function Tt(s,l,u,m){this.cx=3*s,this.bx=3*(u-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=m,this.p2x=u,this.p2y=m}Tt.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},Tt.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},Tt.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},Tt.prototype.solveCurveX=function(s,l){var u,m,y,b,E;for(void 0===l&&(l=1e-6),y=s,E=0;E<8;E++){if(b=this.sampleCurveX(y)-s,Math.abs(b)<l)return y;var S=this.sampleCurveDerivativeX(y);if(Math.abs(S)<1e-6)break;y-=b/S}if((y=s)<(u=0))return u;if(y>(m=1))return m;for(;u<m;){if(b=this.sampleCurveX(y),Math.abs(b-s)<l)return y;s>b?u=y:m=y,y=.5*(m-u)+u}return y},Tt.prototype.solve=function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))};var Gt=cl;function cl(s,l){this.x=s,this.y=l}cl.prototype={clone:function(){return new cl(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,l){return this.clone()._rotateAround(s,l)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var l=s.x-this.x,u=s.y-this.y;return l*l+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,l){return Math.atan2(this.x*l-this.y*s,this.x*s+this.y*l)},_matMult:function(s){var l=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=l,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var l=Math.cos(s),u=Math.sin(s),m=u*this.x+l*this.y;return this.x=l*this.x-u*this.y,this.y=m,this},_rotateAround:function(s,l){var u=Math.cos(s),m=Math.sin(s),y=l.y+m*(this.x-l.x)+u*(this.y-l.y);return this.x=l.x+u*(this.x-l.x)-m*(this.y-l.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},cl.convert=function(s){return s instanceof cl?s:Array.isArray(s)?new cl(s[0],s[1]):s};var _t=typeof self<"u"?self:{},zl=Math.pow(2,53)-1;function Ro(s,l,u,m){var y=new ze(s,l,u,m);return function(b){return y.solve(b)}}var Oc=Ro(.25,.1,.25,1);function to(s,l,u){return Math.min(u,Math.max(l,s))}function Su(s,l,u){var m=u-l,y=((s-l)%m+m)%m+l;return y===l?u:y}function Fi(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}var tf=1;function ul(){return tf++}function ns(){return function s(l){return l?(l^16*Math.random()>>l/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function Iu(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function Da(s,l){s.forEach(function(u){l[u]&&(l[u]=l[u].bind(l))})}function Lc(s,l){return-1!==s.indexOf(l,s.length-l.length)}function Bi(s,l,u){var m={};for(var y in s)m[y]=l.call(u||this,s[y],y,s);return m}function Es(s,l,u){var m={};for(var y in s)l.call(u||this,s[y],y,s)&&(m[y]=s[y]);return m}function zs(s){return Array.isArray(s)?s.map(zs):"object"==typeof s&&s?Bi(s,zs):s}var Ul={};function fr(s){Ul[s]||(typeof console<"u"&&console.warn(s),Ul[s]=!0)}function Po(s,l,u){return(u.y-s.y)*(l.x-s.x)>(l.y-s.y)*(u.x-s.x)}function Np(s){for(var l=0,u=0,m=s.length,y=m-1,b=void 0,E=void 0;u<m;y=u++)l+=((E=s[y]).x-(b=s[u]).x)*(b.y+E.y);return l}function Cs(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function jl(s){var l={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(m,y,b,E){var S=b||E;return l[y]=!S||S.toLowerCase(),""}),l["max-age"]){var u=parseInt(l["max-age"],10);isNaN(u)?delete l["max-age"]:l["max-age"]=u}return l}var ku=null;function Ta(s){if(null==ku){var l=s.navigator?s.navigator.userAgent:null;ku=!!s.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return ku}function Ds(s){try{var l=_t[s];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}var no,Sa,Fc,Hl,dl=_t.performance&&_t.performance.now?_t.performance.now.bind(_t.performance):Date.now.bind(Date),Op=_t.requestAnimationFrame||_t.mozRequestAnimationFrame||_t.webkitRequestAnimationFrame||_t.msRequestAnimationFrame,Vi=_t.cancelAnimationFrame||_t.mozCancelAnimationFrame||_t.webkitCancelAnimationFrame||_t.msCancelAnimationFrame,hl={now:dl,frame:function(s){var l=Op(s);return{cancel:function(){return Vi(l)}}},getImageData:function(s,l){void 0===l&&(l=0);var u=_t.document.createElement("canvas"),m=u.getContext("2d");if(!m)throw new Error("failed to create canvas 2d context");return u.width=s.width,u.height=s.height,m.drawImage(s,0,0,s.width,s.height),m.getImageData(-l,-l,s.width+2*l,s.height+2*l)},resolveURL:function(s){return no||(no=_t.document.createElement("a")),no.href=s,no.href},hardwareConcurrency:_t.navigator&&_t.navigator.hardwareConcurrency||4,get devicePixelRatio(){return _t.devicePixelRatio},get prefersReducedMotion(){return!!_t.matchMedia&&(null==Sa&&(Sa=_t.matchMedia("(prefers-reduced-motion: reduce)")),Sa.matches)}},er={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ia={supported:!1,testSupport:function(s){!fl&&Hl&&(Us?Dn(s):Fc=s)}},fl=!1,Us=!1;function Dn(s){var l=s.createTexture();s.bindTexture(s.TEXTURE_2D,l);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,Hl),s.isContextLost())return;Ia.supported=!0}catch{}s.deleteTexture(l),fl=!0}_t.document&&((Hl=_t.document.createElement("img")).onload=function(){Fc&&Dn(Fc),Fc=null,Us=!0},Hl.onerror=function(){fl=!0,Fc=null},Hl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ka="01",No=function(s,l){this._transformRequestFn=s,this._customAccessToken=l,this._createSkuToken()};function js(s){return 0===s.indexOf("mapbox:")}No.prototype._createSkuToken=function(){var s=function(){for(var l="",u=0;u<10;u++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ka,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt},No.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},No.prototype.transformRequest=function(s,l){return this._transformRequestFn&&this._transformRequestFn(s,l)||{url:s}},No.prototype.normalizeStyleURL=function(s,l){if(!js(s))return s;var u=rs(s);return u.path="/styles/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},No.prototype.normalizeGlyphsURL=function(s,l){if(!js(s))return s;var u=rs(s);return u.path="/fonts/v1"+u.path,this._makeAPIURL(u,this._customAccessToken||l)},No.prototype.normalizeSourceURL=function(s,l){if(!js(s))return s;var u=rs(s);return u.path="/v4/"+u.authority+".json",u.params.push("secure"),this._makeAPIURL(u,this._customAccessToken||l)},No.prototype.normalizeSpriteURL=function(s,l,u,m){var y=rs(s);return js(s)?(y.path="/styles/v1"+y.path+"/sprite"+l+u,this._makeAPIURL(y,this._customAccessToken||m)):(y.path+=""+l+u,pl(y))},No.prototype.normalizeTileURL=function(s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!js(s))return s;var u=rs(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,(hl.devicePixelRatio>=2||512===l?"@2x":"")+(Ia.supported?".webp":"$1")),u.path=u.path.replace(/^.+\/v4\//,"/"),u.path="/v4"+u.path;var m=this._customAccessToken||function(y){for(var b=0,E=y;b<E.length;b+=1){var S=E[b].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(u.params)||er.ACCESS_TOKEN;return er.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&u.params.push("sku="+this._skuToken),this._makeAPIURL(u,m)},No.prototype.canonicalizeTileURL=function(s,l){var u=rs(s);if(!u.path.match(/(^\/v4\/)/)||!u.path.match(/\.[\w]+$/))return s;var m="mapbox://tiles/";m+=u.path.replace("/v4/","");var y=u.params;return l&&(y=y.filter(function(b){return!b.match(/^access_token=/)})),y.length&&(m+="?"+y.join("&")),m},No.prototype.canonicalizeTileset=function(s,l){for(var u=!!l&&js(l),m=[],y=0,b=s.tiles||[];y<b.length;y+=1){var E=b[y];ta(E)?m.push(this.canonicalizeTileURL(E,u)):m.push(E)}return m},No.prototype._makeAPIURL=function(s,l){var u="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",m=rs(er.API_URL);if(s.protocol=m.protocol,s.authority=m.authority,"http"===s.protocol){var y=s.params.indexOf("secure");y>=0&&s.params.splice(y,1)}if("/"!==m.path&&(s.path=""+m.path+s.path),!er.REQUIRE_ACCESS_TOKEN)return pl(s);if(!(l=l||er.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+u);if("s"===l[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+u);return s.params=s.params.filter(function(b){return-1===b.indexOf("access_token")}),s.params.push("access_token="+l),pl(s)},No.prototype.setTransformRequest=function(s){this._transformRequestFn=s};var Lp=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ta(s){return Lp.test(s)}var pr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function rs(s){var l=s.match(pr);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function pl(s){var l=s.params.length?"?"+s.params.join("&"):"";return s.protocol+"://"+s.authority+s.path+l}function ml(s){if(!s)return null;var l=s.split(".");if(!l||3!==l.length)return null;try{return JSON.parse(decodeURIComponent(_t.atob(l[1]).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Wn=function(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Wn.prototype.getStorageKey=function(s){var l,u=ml(er.ACCESS_TOKEN);return l=u&&u.u?_t.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,function(m,y){return String.fromCharCode(+("0x"+y))})):er.ACCESS_TOKEN||"",s?"mapbox.eventData."+s+":"+l:"mapbox.eventData:"+l},Wn.prototype.fetchEventData=function(){var s=Ds("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{var m=_t.localStorage.getItem(l);m&&(this.eventData=JSON.parse(m));var y=_t.localStorage.getItem(u);y&&(this.anonId=y)}catch{fr("Unable to read from LocalStorage")}},Wn.prototype.saveEventData=function(){var s=Ds("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(s)try{_t.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&_t.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{fr("Unable to write to LocalStorage")}},Wn.prototype.processRequests=function(s){},Wn.prototype.postEvent=function(s,l,u,m){var y=this;if(er.EVENTS_URL){var b=rs(er.EVENTS_URL);b.params.push("access_token="+(m||er.ACCESS_TOKEN||""));var E={event:this.type,created:new Date(s).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.15.3",skuId:ka,userId:this.anonId},S=l?Fi(E,l):E,k={url:pl(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=F(k,function(M){y.pendingRequest=null,u(M),y.saveEventData(),y.processRequests(m)})}},Wn.prototype.queueRequest=function(s,l){this.queue.push(s),this.processRequests(l)};var Ts,$l,Hs=function(s){function l(){s.call(this,"map.load"),this.success={},this.skuToken=""}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postMapLoadEvent=function(u,m,y,b){this.skuToken=y,(er.EVENTS_URL&&b||er.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(E){return js(E)||ta(E)}))&&this.queueRequest({id:m,timestamp:Date.now()},b)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){var y=this.queue.shift(),b=y.id,E=y.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),Iu(this.anonId)||(this.anonId=ns()),this.postEvent(E,{skuToken:this.skuToken},function(S){S||b&&(m.success[b]=!0)},u))}},l}(Wn),Aa=new(function(s){function l(u){s.call(this,"appUserTurnstile"),this._customAccessToken=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.postTurnstileEvent=function(u,m){er.EVENTS_URL&&er.ACCESS_TOKEN&&Array.isArray(u)&&u.some(function(y){return js(y)||ta(y)})&&this.queueRequest(Date.now(),m)},l.prototype.processRequests=function(u){var m=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var y=ml(er.ACCESS_TOKEN),b=y?y.u:er.ACCESS_TOKEN,E=b!==this.eventData.tokenU;Iu(this.anonId)||(this.anonId=ns(),E=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var k=new Date(this.eventData.lastSuccess),M=new Date(S),P=(S-this.eventData.lastSuccess)/864e5;E=E||P>=1||P<-1||k.getDate()!==M.getDate()}else E=!0;if(!E)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(O){O||(m.eventData.lastSuccess=S,m.eventData.tokenU=b)},u)}},l}(Wn)),Bc=Aa.postTurnstileEvent.bind(Aa),Au=new Hs,Ma=Au.postMapLoadEvent.bind(Au),Mu=500,nf=50;function Ru(){_t.caches&&!Ts&&(Ts=_t.caches.open("mapbox-tiles"))}function Vc(s){var l=s.indexOf("?");return l<0?s:s.slice(0,l)}var Ss,ql=1/0;function Ld(){return null==Ss&&(Ss=_t.OffscreenCanvas&&new _t.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof _t.createImageBitmap),Ss}var Pu={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Pu);var Fd=function(s){function l(u,m,y){401===m&&ta(y)&&(u+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),s.call(this,u),this.status=m,this.url=y,this.name=this.constructor.name,this.message=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},l}(Error),gl=Cs()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===_t.location.protocol?_t.parent:_t).location.href};function Gl(s,l){var u,m=new _t.AbortController,y=new _t.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:gl(),signal:m.signal}),b=!1,E=!1,S=(u=y.url).indexOf("sku=")>0&&ta(u);"json"===s.type&&y.headers.set("Accept","application/json");var k=function(P,O,V){if(!E){if(P&&"SecurityError"!==P.message&&fr(P),O&&V)return M(O);var $=Date.now();_t.fetch(y).then(function(ee){if(ee.ok){var Q=S?ee.clone():null;return M(ee,Q,$)}return l(new Fd(ee.statusText,ee.status,s.url))}).catch(function(ee){20!==ee.code&&l(new Error(ee.message))})}},M=function(P,O,V){("arrayBuffer"===s.type?P.arrayBuffer():"json"===s.type?P.json():P.text()).then(function($){E||(O&&V&&function(ee,Q,pe){if(Ru(),Ts){var he={status:Q.status,statusText:Q.statusText,headers:new _t.Headers};Q.headers.forEach(function(ye,Ie){return he.headers.set(Ie,ye)});var ve=jl(Q.headers.get("Cache-Control")||"");ve["no-store"]||(ve["max-age"]&&he.headers.set("Expires",new Date(pe+1e3*ve["max-age"]).toUTCString()),new Date(he.headers.get("Expires")).getTime()-pe<42e4||function(ye,Ie){if(void 0===$l)try{new Response(new ReadableStream),$l=!0}catch{$l=!1}$l?Ie(ye.body):ye.blob().then(Ie)}(Q,function(ye){var Ie=new _t.Response(ye,he);Ru(),Ts&&Ts.then(function(ke){return ke.put(Vc(ee.url),Ie)}).catch(function(ke){return fr(ke.message)})}))}}(y,O,V),b=!0,l(null,$,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(function($){E||l(new Error($.message))})};return S?function(P,O){if(Ru(),!Ts)return O(null);var V=Vc(P.url);Ts.then(function($){$.match(V).then(function(ee){var Q=function(pe){if(!pe)return!1;var he=new Date(pe.headers.get("Expires")||0),ve=jl(pe.headers.get("Cache-Control")||"");return he>Date.now()&&!ve["no-cache"]}(ee);$.delete(V),Q&&$.put(V,ee.clone()),O(null,ee,Q)}).catch(O)}).catch(O)}(y,k):k(null,null),{cancel:function(){E=!0,b||m.abort()}}}var Ra,zc,Wl=function(s,l){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){if(Cs()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l);if(!Cs()){var u=s.url.substring(0,s.url.indexOf("://"));return(er.REGISTERED_PROTOCOLS[u]||Gl)(s,l)}}if(!(/^file:/.test(m=s.url)||/^file:/.test(gl())&&!/^\w+:/.test(m))){if(_t.fetch&&_t.Request&&_t.AbortController&&_t.Request.prototype.hasOwnProperty("signal"))return Gl(s,l);if(Cs()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,l,void 0,!0)}var m;return function(y,b){var E=new _t.XMLHttpRequest;for(var S in E.open(y.method||"GET",y.url,!0),"arrayBuffer"===y.type&&(E.responseType="arraybuffer"),y.headers)E.setRequestHeader(S,y.headers[S]);return"json"===y.type&&(E.responseType="text",E.setRequestHeader("Accept","application/json")),E.withCredentials="include"===y.credentials,E.onerror=function(){b(new Error(E.statusText))},E.onload=function(){if((E.status>=200&&E.status<300||0===E.status)&&null!==E.response){var k=E.response;if("json"===y.type)try{k=JSON.parse(E.response)}catch(M){return b(M)}b(null,k,E.getResponseHeader("Cache-Control"),E.getResponseHeader("Expires"))}else b(new Fd(E.statusText,E.status,y.url))},E.send(y.body),{cancel:function(){return E.abort()}}}(s,l)},tr=function(s,l){return Wl(Fi(s,{type:"arrayBuffer"}),l)},F=function(s,l){return Wl(Fi(s,{method:"POST"}),l)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Ra=[],zc=0;var U=function(s,l){if(Ia.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),zc>=er.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:s,callback:l,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ra.push(u),u}zc++;var m=!1,y=function(){if(!m)for(m=!0,zc--;Ra.length&&zc<er.MAX_PARALLEL_IMAGE_REQUESTS;){var E=Ra.shift();E.cancelled||(E.cancel=U(E.requestParameters,E.callback).cancel)}},b=tr(s,function(E,S,k,M){var O,V;y(),E?l(E):S&&(Ld()?(O=l,V=new _t.Blob([new Uint8Array(S)],{type:"image/png"}),_t.createImageBitmap(V).then(function($){O(null,$)}).catch(function($){O(new Error("Could not load image because of "+$.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(P,O,V,$){var ee=new _t.Image,Q=_t.URL;ee.onload=function(){O(null,ee),Q.revokeObjectURL(ee.src),ee.onload=null,_t.requestAnimationFrame(function(){ee.src=z})},ee.onerror=function(){return O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var pe=new _t.Blob([new Uint8Array(P)],{type:"image/png"});ee.cacheControl=V,ee.expires=$,ee.src=P.byteLength?Q.createObjectURL(pe):z}(S,l,k,M))});return{cancel:function(){b.cancel(),y()}}};function K(s,l,u){u[s]&&-1!==u[s].indexOf(l)||(u[s]=u[s]||[],u[s].push(l))}function ie(s,l,u){if(u&&u[s]){var m=u[s].indexOf(l);-1!==m&&u[s].splice(m,1)}}var me=function(s,l){void 0===l&&(l={}),Fi(this,l),this.type=s},_e=function(s){function l(u,m){void 0===m&&(m={}),s.call(this,"error",Fi({error:u},m))}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(me),J=function(){};J.prototype.on=function(s,l){return this._listeners=this._listeners||{},K(s,l,this._listeners),this},J.prototype.off=function(s,l){return ie(s,l,this._listeners),ie(s,l,this._oneTimeListeners),this},J.prototype.once=function(s,l){return this._oneTimeListeners=this._oneTimeListeners||{},K(s,l,this._oneTimeListeners),this},J.prototype.fire=function(s,l){"string"==typeof s&&(s=new me(s,l||{}));var u=s.type;if(this.listens(u)){s.target=this;for(var m=0,y=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];m<y.length;m+=1)y[m].call(this,s);for(var b=0,E=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];b<E.length;b+=1){var S=E[b];ie(u,S,this._oneTimeListeners),S.call(this,s)}var k=this._eventedParent;k&&(Fi(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),k.fire(s))}else s instanceof _e&&console.error(s.error);return this},J.prototype.listens=function(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)},J.prototype.setEventedParent=function(s,l){return this._eventedParent=s,this._eventedParentData=l,this};var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},se=function(s,l,u,m){this.message=(s?s+": ":"")+u,m&&(this.identifier=m),null!=l&&l.__line__&&(this.line=l.__line__)};function Ue(s){var l=s.value;return l?[new se(s.key,l,"constants have been deprecated as of v8")]:[]}function Je(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];for(var m=0,y=l;m<y.length;m+=1){var b=y[m];for(var E in b)s[E]=b[E]}return s}function Te(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function $e(s){if(Array.isArray(s))return s.map($e);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){var l={};for(var u in s)l[u]=$e(s[u]);return l}return Te(s)}var ct=function(s){function l(u,m){s.call(this,m),this.message=m,this.key=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(Error),dt=function(s,l){void 0===l&&(l=[]),this.parent=s,this.bindings={};for(var u=0,m=l;u<m.length;u+=1){var y=m[u];this.bindings[y[0]]=y[1]}};dt.prototype.concat=function(s){return new dt(this,s)},dt.prototype.get=function(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(s+" not found in scope.")},dt.prototype.has=function(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)};var xt={kind:"null"},Ne={kind:"number"},rt={kind:"string"},Ve={kind:"boolean"},Jt={kind:"color"},en={kind:"object"},ue={kind:"value"},ur={kind:"collator"},jt={kind:"formatted"},an={kind:"resolvedImage"};function Cr(s,l){return{kind:"array",itemType:s,N:l}}function On(s){if("array"===s.kind){var l=On(s.itemType);return"number"==typeof s.N?"array<"+l+", "+s.N+">":"value"===s.itemType.kind?"array":"array<"+l+">"}return s.kind}var pt=[xt,Ne,rt,Ve,Jt,jt,en,Cr(ue),an];function Fr(s,l){if("error"===l.kind)return null;if("array"===s.kind){if("array"===l.kind&&(0===l.N&&"value"===l.itemType.kind||!Fr(s.itemType,l.itemType))&&("number"!=typeof s.N||s.N===l.N))return null}else{if(s.kind===l.kind)return null;if("value"===s.kind)for(var u=0,m=pt;u<m.length;u+=1)if(!Fr(m[u],l))return null}return"Expected "+On(s)+" but found "+On(l)+" instead."}function xn(s,l){return l.some(function(u){return u.kind===s.kind})}function fn(s,l){return l.some(function(u){return"null"===u?null===s:"array"===u?Array.isArray(s):"object"===u?s&&!Array.isArray(s)&&"object"==typeof s:u===typeof s})}var Bd=Zo(function(s,l){var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function m(S){return(S=Math.round(S))<0?0:S>255?255:S}function y(S){return m("%"===S[S.length-1]?parseFloat(S)/100*255:parseInt(S))}function b(S){return(k="%"===S[S.length-1]?parseFloat(S)/100:parseFloat(S))<0?0:k>1?1:k;var k}function E(S,k,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?S+(k-S)*M*6:2*M<1?k:3*M<2?S+(k-S)*(2/3-M)*6:S}try{l.parseCSSColor=function(S){var k,M=S.replace(/ /g,"").toLowerCase();if(M in u)return u[M].slice();if("#"===M[0])return 4===M.length?(k=parseInt(M.substr(1),16))>=0&&k<=4095?[(3840&k)>>4|(3840&k)>>8,240&k|(240&k)>>4,15&k|(15&k)<<4,1]:null:7===M.length&&(k=parseInt(M.substr(1),16))>=0&&k<=16777215?[(16711680&k)>>16,(65280&k)>>8,255&k,1]:null;var P=M.indexOf("("),O=M.indexOf(")");if(-1!==P&&O+1===M.length){var V=M.substr(0,P),$=M.substr(P+1,O-(P+1)).split(","),ee=1;switch(V){case"rgba":if(4!==$.length)return null;ee=b($.pop());case"rgb":return 3!==$.length?null:[y($[0]),y($[1]),y($[2]),ee];case"hsla":if(4!==$.length)return null;ee=b($.pop());case"hsl":if(3!==$.length)return null;var Q=(parseFloat($[0])%360+360)%360/360,pe=b($[1]),he=b($[2]),ve=he<=.5?he*(pe+1):he+pe-he*pe,ye=2*he-ve;return[m(255*E(ye,ve,Q+1/3)),m(255*E(ye,ve,Q)),m(255*E(ye,ve,Q-1/3)),ee];default:return null}}return null}}catch{}}).parseCSSColor,wn=function(s,l,u,m){void 0===m&&(m=1),this.r=s,this.g=l,this.b=u,this.a=m};wn.parse=function(s){if(s){if(s instanceof wn)return s;if("string"==typeof s){var l=Bd(s);if(l)return new wn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3])}}},wn.prototype.toString=function(){var s=this.toArray(),l=s[1],u=s[2],m=s[3];return"rgba("+Math.round(s[0])+","+Math.round(l)+","+Math.round(u)+","+m+")"},wn.prototype.toArray=function(){var s=this.a;return 0===s?[0,0,0,0]:[255*this.r/s,255*this.g/s,255*this.b/s,s]},wn.black=new wn(0,0,0,1),wn.white=new wn(1,1,1,1),wn.transparent=new wn(0,0,0,0),wn.red=new wn(1,0,0,1);var Kn=function(s,l,u){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Kn.prototype.compare=function(s,l){return this.collator.compare(s,l)},Kn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var mn=function(s,l,u,m,y){this.text=s,this.image=l,this.scale=u,this.fontStack=m,this.textColor=y},ii=function(s){this.sections=s};ii.fromString=function(s){return new ii([new mn(s,null,null,null,null)])},ii.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(s){return 0!==s.text.length||s.image&&0!==s.image.name.length})},ii.factory=function(s){return s instanceof ii?s:ii.fromString(s)},ii.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(s){return s.text}).join("")},ii.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];if(m.image)s.push(["image",m.image.name]);else{s.push(m.text);var y={};m.fontStack&&(y["text-font"]=["literal",m.fontStack.split(",")]),m.scale&&(y["font-scale"]=m.scale),m.textColor&&(y["text-color"]=["rgba"].concat(m.textColor.toArray())),s.push(y)}}return s};var Dr=function(s){this.name=s.name,this.available=s.available};function Pg(s,l,u,m){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof l&&l>=0&&l<=255&&"number"==typeof u&&u>=0&&u<=255?void 0===m||"number"==typeof m&&m>=0&&m<=1?null:"Invalid rgba value ["+[s,l,u,m].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof m?[s,l,u,m]:[s,l,u]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Uc(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof wn||s instanceof Kn||s instanceof ii||s instanceof Dr)return!0;if(Array.isArray(s)){for(var l=0,u=s;l<u.length;l+=1)if(!Uc(u[l]))return!1;return!0}if("object"==typeof s){for(var m in s)if(!Uc(s[m]))return!1;return!0}return!1}function zi(s){if(null===s)return xt;if("string"==typeof s)return rt;if("boolean"==typeof s)return Ve;if("number"==typeof s)return Ne;if(s instanceof wn)return Jt;if(s instanceof Kn)return ur;if(s instanceof ii)return jt;if(s instanceof Dr)return an;if(Array.isArray(s)){for(var l,u=s.length,m=0,y=s;m<y.length;m+=1){var b=zi(y[m]);if(l){if(l===b)continue;l=ue;break}l=b}return Cr(l||ue,u)}return en}function Oo(s){var l=typeof s;return null===s?"":"string"===l||"number"===l||"boolean"===l?String(s):s instanceof wn||s instanceof ii||s instanceof Dr?s.toString():JSON.stringify(s)}Dr.prototype.toString=function(){return this.name},Dr.fromString=function(s){return s?new Dr({name:s,available:!1}):null},Dr.prototype.serialize=function(){return["image",this.name]};var na=function(s,l){this.type=s,this.value=l};na.parse=function(s,l){if(2!==s.length)return l.error("'literal' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(!Uc(s[1]))return l.error("invalid value");var u=s[1],m=zi(u),y=l.expectedType;return"array"!==m.kind||0!==m.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(m=y),new na(m,u)},na.prototype.evaluate=function(){return this.value},na.prototype.eachChild=function(){},na.prototype.outputDefined=function(){return!0},na.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof wn?["rgba"].concat(this.value.toArray()):this.value instanceof ii?this.value.serialize():this.value};var kr=function(s){this.name="ExpressionEvaluationError",this.message=s};kr.prototype.toJSON=function(){return this.message};var is={string:rt,number:Ne,boolean:Ve,object:en},fo=function(s,l){this.type=s,this.args=l};fo.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u,m=1,y=s[0];if("array"===y){var b,E;if(s.length>2){var S=s[1];if("string"!=typeof S||!(S in is)||"object"===S)return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=is[S],m++}else b=ue;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=s[2],m++}u=Cr(b,E)}else u=is[y];for(var k=[];m<s.length;m++){var M=l.parse(s[m],m,ue);if(!M)return null;k.push(M)}return new fo(u,k)},fo.prototype.evaluate=function(s){for(var l=0;l<this.args.length;l++){var u=this.args[l].evaluate(s);if(!Fr(this.type,zi(u)))return u;if(l===this.args.length-1)throw new kr("Expected value to be of type "+On(this.type)+", but found "+On(zi(u))+" instead.")}return null},fo.prototype.eachChild=function(s){this.args.forEach(s)},fo.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},fo.prototype.serialize=function(){var s=this.type,l=[s.kind];if("array"===s.kind){var u=s.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){l.push(u.kind);var m=s.N;("number"==typeof m||this.args.length>1)&&l.push(m)}}return l.concat(this.args.map(function(y){return y.serialize()}))};var os=function(s){this.type=jt,this.sections=s};os.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[1];if(!Array.isArray(u)&&"object"==typeof u)return l.error("First argument must be an image or text section.");for(var m=[],y=!1,b=1;b<=s.length-1;++b){var E=s[b];if(y&&"object"==typeof E&&!Array.isArray(E)){y=!1;var S=null;if(E["font-scale"]&&!(S=l.parse(E["font-scale"],1,Ne)))return null;var k=null;if(E["text-font"]&&!(k=l.parse(E["text-font"],1,Cr(rt))))return null;var M=null;if(E["text-color"]&&!(M=l.parse(E["text-color"],1,Jt)))return null;var P=m[m.length-1];P.scale=S,P.font=k,P.textColor=M}else{var O=l.parse(s[b],1,ue);if(!O)return null;var V=O.type.kind;if("string"!==V&&"value"!==V&&"null"!==V&&"resolvedImage"!==V)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:O,scale:null,font:null,textColor:null})}}return new os(m)},os.prototype.evaluate=function(s){return new ii(this.sections.map(function(l){var u=l.content.evaluate(s);return zi(u)===an?new mn("",u,null,null,null):new mn(Oo(u),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))},os.prototype.eachChild=function(s){for(var l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s(m.content),m.scale&&s(m.scale),m.font&&s(m.font),m.textColor&&s(m.textColor)}},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){for(var s=["format"],l=0,u=this.sections;l<u.length;l+=1){var m=u[l];s.push(m.content.serialize());var y={};m.scale&&(y["font-scale"]=m.scale.serialize()),m.font&&(y["text-font"]=m.font.serialize()),m.textColor&&(y["text-color"]=m.textColor.serialize()),s.push(y)}return s};var Kl=function(s){this.type=an,this.input=s};Kl.parse=function(s,l){if(2!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,rt);return u?new Kl(u):l.error("No image name provided.")},Kl.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=Dr.fromString(l);return u&&s.availableImages&&(u.available=s.availableImages.indexOf(l)>-1),u},Kl.prototype.eachChild=function(s){s(this.input)},Kl.prototype.outputDefined=function(){return!1},Kl.prototype.serialize=function(){return["image",this.input.serialize()]};var Yy={"to-boolean":Ve,"to-color":Jt,"to-number":Ne,"to-string":rt},ra=function(s,l){this.type=s,this.args=l};ra.parse=function(s,l){if(s.length<2)return l.error("Expected at least one argument.");var u=s[0];if(("to-boolean"===u||"to-string"===u)&&2!==s.length)return l.error("Expected one argument.");for(var m=Yy[u],y=[],b=1;b<s.length;b++){var E=l.parse(s[b],b,ue);if(!E)return null;y.push(E)}return new ra(m,y)},ra.prototype.evaluate=function(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){for(var l,u,m=0,y=this.args;m<y.length;m+=1){if(u=null,(l=y[m].evaluate(s))instanceof wn)return l;if("string"==typeof l){var b=s.parseColor(l);if(b)return b}else if(Array.isArray(l)&&!(u=l.length<3||l.length>4?"Invalid rbga value "+JSON.stringify(l)+": expected an array containing either three or four numeric values.":Pg(l[0],l[1],l[2],l[3])))return new wn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new kr(u||"Could not parse color from value '"+("string"==typeof l?l:String(JSON.stringify(l)))+"'")}if("number"===this.type.kind){for(var E=null,S=0,k=this.args;S<k.length;S+=1){if(null===(E=k[S].evaluate(s)))return 0;var M=Number(E);if(!isNaN(M))return M}throw new kr("Could not convert "+JSON.stringify(E)+" to number.")}return"formatted"===this.type.kind?ii.fromString(Oo(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?Dr.fromString(Oo(this.args[0].evaluate(s))):Oo(this.args[0].evaluate(s))},ra.prototype.eachChild=function(s){this.args.forEach(s)},ra.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},ra.prototype.serialize=function(){if("formatted"===this.type.kind)return new os([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Kl(this.args[0]).serialize();var s=["to-"+this.type.kind];return this.eachChild(function(l){s.push(l.serialize())}),s};var po=["Unknown","Point","LineString","Polygon"],Mt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Mt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Mt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?po[this.feature.type]:this.feature.type:null},Mt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Mt.prototype.canonicalID=function(){return this.canonical},Mt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Mt.prototype.parseColor=function(s){var l=this._parseColorCache[s];return l||(l=this._parseColorCache[s]=wn.parse(s)),l};var ro=function(s,l,u,m){this.name=s,this.type=l,this._evaluate=u,this.args=m};ro.prototype.evaluate=function(s){return this._evaluate(s,this.args)},ro.prototype.eachChild=function(s){this.args.forEach(s)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){return[this.name].concat(this.args.map(function(s){return s.serialize()}))},ro.parse=function(s,l){var u,m=s[0],y=ro.definitions[m];if(!y)return l.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0);for(var b=Array.isArray(y)?y[0]:y.type,E=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,S=E.filter(function(kt){var ot=kt[0];return!Array.isArray(ot)||ot.length===s.length-1}),k=null,M=0,P=S;M<P.length;M+=1){var O=P[M],V=O[0],$=O[1];k=new ks(l.registry,l.path,null,l.scope);for(var ee=[],Q=!1,pe=1;pe<s.length;pe++){var he=s[pe],ve=Array.isArray(V)?V[pe-1]:V.type,ye=k.parse(he,1+ee.length,ve);if(!ye){Q=!0;break}ee.push(ye)}if(!Q)if(Array.isArray(V)&&V.length!==ee.length)k.error("Expected "+V.length+" arguments, but found "+ee.length+" instead.");else{for(var Ie=0;Ie<ee.length;Ie++){var ke=Array.isArray(V)?V[Ie]:V.type,Oe=ee[Ie];k.concat(Ie+1).checkSubtype(ke,Oe.type)}if(0===k.errors.length)return new ro(m,b,$,ee)}}if(1===S.length)(u=l.errors).push.apply(u,k.errors);else{for(var Ye=(S.length?S:E).map(function(kt){var ot;return ot=kt[0],Array.isArray(ot)?"("+ot.map(On).join(", ")+")":"("+On(ot.type)+"...)"}).join(" | "),nt=[],yt=1;yt<s.length;yt++){var it=l.parse(s[yt],1+nt.length);if(!it)return null;nt.push(On(it.type))}l.error("Expected arguments of type "+Ye+", but found ("+nt.join(", ")+") instead.")}return null},ro.register=function(s,l){for(var u in ro.definitions=l,l)s[u]=ro};var Ti=function(s,l,u){this.type=ur,this.locale=u,this.caseSensitive=s,this.diacriticSensitive=l};function Nu(s,l){s[0]=Math.min(s[0],l[0]),s[1]=Math.min(s[1],l[1]),s[2]=Math.max(s[2],l[0]),s[3]=Math.max(s[3],l[1])}function Fp(s,l){return!(s[0]<=l[0]||s[2]>=l[2]||s[1]<=l[1]||s[3]>=l[3])}function Nw(s,l){var u=(180+s[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(u*y*8192),Math.round(m*y*8192)]}function je(s,l,u){return l[1]>s[1]!=u[1]>s[1]&&s[0]<(u[0]-l[0])*(s[1]-l[1])/(u[1]-l[1])+l[0]}function jr(s,l){for(var u,m,y,b,E,S,k,M=!1,P=0,O=l.length;P<O;P++)for(var V=l[P],$=0,ee=V.length;$<ee-1;$++){if((b=(u=s)[0]-(m=V[$])[0])*(k=u[1]-(y=V[$+1])[1])-(S=u[0]-y[0])*(E=u[1]-m[1])==0&&b*S<=0&&E*k<=0)return!1;je(s,V[$],V[$+1])&&(M=!M)}return M}function rf(s,l){for(var u=0;u<l.length;u++)if(jr(s,l[u]))return!0;return!1}function Ng(s,l,u,m){var y=m[0]-u[0],b=m[1]-u[1],E=(s[0]-u[0])*b-y*(s[1]-u[1]),S=(l[0]-u[0])*b-y*(l[1]-u[1]);return E>0&&S<0||E<0&&S>0}function Xy(s,l,u){for(var m=0,y=u;m<y.length;m+=1)for(var b=y[m],E=0;E<b.length-1;++E)if((O=[(P=b[E+1])[0]-(M=b[E])[0],P[1]-M[1]])[0]*(V=[(k=l)[0]-(S=s)[0],k[1]-S[1]])[1]-O[1]*V[0]!=0&&Ng(S,k,M,P)&&Ng(M,P,S,k))return!0;var S,k,M,P,O,V;return!1}function Bp(s,l){for(var u=0;u<s.length;++u)if(!jr(s[u],l))return!1;for(var m=0;m<s.length-1;++m)if(Xy(s[m],s[m+1],l))return!1;return!0}function jc(s,l){for(var u=0;u<l.length;u++)if(Bp(s,l[u]))return!0;return!1}function Hc(s,l,u){for(var m=[],y=0;y<s.length;y++){for(var b=[],E=0;E<s[y].length;E++){var S=Nw(s[y][E],u);Nu(l,S),b.push(S)}m.push(b)}return m}function $c(s,l,u){for(var m=[],y=0;y<s.length;y++){var b=Hc(s[y],l,u);m.push(b)}return m}function Fe(s,l,u,m){if(s[0]<u[0]||s[0]>u[2]){var y=.5*m,b=s[0]-u[0]>y?-m:u[0]-s[0]>y?m:0;0===b&&(b=s[0]-u[2]>y?-m:u[2]-s[0]>y?m:0),s[0]+=b}Nu(l,s)}function Ou(s,l,u,m){for(var y=8192*Math.pow(2,m.z),b=[8192*m.x,8192*m.y],E=[],S=0,k=s;S<k.length;S+=1)for(var M=0,P=k[S];M<P.length;M+=1){var O=P[M],V=[O.x+b[0],O.y+b[1]];Fe(V,l,u,y),E.push(V)}return E}function Zl(s,l,u,m){for(var y,b=8192*Math.pow(2,m.z),E=[8192*m.x,8192*m.y],S=[],k=0,M=s;k<M.length;k+=1){for(var P=[],O=0,V=M[k];O<V.length;O+=1){var $=V[O],ee=[$.x+E[0],$.y+E[1]];Nu(l,ee),P.push(ee)}S.push(P)}if(l[2]-l[0]<=b/2){(y=l)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(var Q=0,pe=S;Q<pe.length;Q+=1)for(var he=0,ve=pe[Q];he<ve.length;he+=1)Fe(ve[he],l,u,b)}return S}Ti.parse=function(s,l){if(2!==s.length)return l.error("Expected one argument.");var u=s[1];if("object"!=typeof u||Array.isArray(u))return l.error("Collator options argument must be an object.");var m=l.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Ve);if(!m)return null;var y=l.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Ve);if(!y)return null;var b=null;return u.locale&&!(b=l.parse(u.locale,1,rt))?null:new Ti(m,y,b)},Ti.prototype.evaluate=function(s){return new Kn(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)},Ti.prototype.eachChild=function(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){var s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]};var io=function(s,l){this.type=Ve,this.geojson=s,this.geometries=l};function Is(s){if(s instanceof ro&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof io)return!1;var l=!0;return s.eachChild(function(u){l&&!Is(u)&&(l=!1)}),l}function Yl(s){if(s instanceof ro&&"feature-state"===s.name)return!1;var l=!0;return s.eachChild(function(u){l&&!Yl(u)&&(l=!1)}),l}function sf(s,l){if(s instanceof ro&&l.indexOf(s.name)>=0)return!1;var u=!0;return s.eachChild(function(m){u&&!sf(m,l)&&(u=!1)}),u}io.parse=function(s,l){if(2!==s.length)return l.error("'within' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(Uc(s[1])){var u=s[1];if("FeatureCollection"===u.type)for(var m=0;m<u.features.length;++m){var y=u.features[m].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new io(u,u.features[m].geometry)}else if("Feature"===u.type){var b=u.geometry.type;if("Polygon"===b||"MultiPolygon"===b)return new io(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new io(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")},io.prototype.evaluate=function(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Hc(u.coordinates,y,b),S=Ou(l.geometry(),m,y,b);if(!Fp(m,y))return!1;for(var k=0,M=S;k<M.length;k+=1)if(!jr(M[k],E))return!1}if("MultiPolygon"===u.type){var P=$c(u.coordinates,y,b),O=Ou(l.geometry(),m,y,b);if(!Fp(m,y))return!1;for(var V=0,$=O;V<$.length;V+=1)if(!rf($[V],P))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(l,u){var m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if("Polygon"===u.type){var E=Hc(u.coordinates,y,b),S=Zl(l.geometry(),m,y,b);if(!Fp(m,y))return!1;for(var k=0,M=S;k<M.length;k+=1)if(!Bp(M[k],E))return!1}if("MultiPolygon"===u.type){var P=$c(u.coordinates,y,b),O=Zl(l.geometry(),m,y,b);if(!Fp(m,y))return!1;for(var V=0,$=O;V<$.length;V+=1)if(!jc($[V],P))return!1}return!0}(s,this.geometries)}return!1},io.prototype.eachChild=function(){},io.prototype.outputDefined=function(){return!0},io.prototype.serialize=function(){return["within",this.geojson]};var Xl=function(s,l){this.type=l.type,this.name=s,this.boundExpression=l};Xl.parse=function(s,l){if(2!==s.length||"string"!=typeof s[1])return l.error("'var' expression requires exactly one string literal argument.");var u=s[1];return l.scope.has(u)?new Xl(u,l.scope.get(u)):l.error('Unknown variable "'+u+'". Make sure "'+u+'" has been bound in an enclosing "let" expression before using it.',1)},Xl.prototype.evaluate=function(s){return this.boundExpression.evaluate(s)},Xl.prototype.eachChild=function(){},Xl.prototype.outputDefined=function(){return!1},Xl.prototype.serialize=function(){return["var",this.name]};var ks=function(s,l,u,m,y){void 0===l&&(l=[]),void 0===m&&(m=new dt),void 0===y&&(y=[]),this.registry=s,this.path=l,this.key=l.map(function(b){return"["+b+"]"}).join(""),this.scope=m,this.errors=y,this.expectedType=u};function Ql(s,l){for(var u,m=s.length-1,y=0,b=m,E=0;y<=b;)if((u=s[E=Math.floor((y+b)/2)])<=l){if(E===m||l<s[E+1])return E;y=E+1}else{if(!(u>l))throw new kr("Input is not a number.");b=E-1}return 0}ks.prototype.parse=function(s,l,u,m,y){return void 0===y&&(y={}),l?this.concat(l,u,m)._parse(s,y):this._parse(s,y)},ks.prototype._parse=function(s,l){function u(M,P,O){return"assert"===O?new fo(P,[M]):"coerce"===O?new ra(P,[M]):M}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var m=s[0];if("string"!=typeof m)return this.error("Expression name must be a string, but found "+typeof m+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var y=this.registry[m];if(y){var b=y.parse(s,this);if(!b)return null;if(this.expectedType){var E=this.expectedType,S=b.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==S.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==S.kind&&"string"!==S.kind){if(this.checkSubtype(E,S))return null}else b=u(b,E,l.typeAnnotation||"coerce");else b=u(b,E,l.typeAnnotation||"assert")}if(!(b instanceof na)&&"resolvedImage"!==b.type.kind&&function M(P){if(P instanceof Xl)return M(P.boundExpression);if(P instanceof ro&&"error"===P.name||P instanceof Ti||P instanceof io)return!1;var O=P instanceof ra||P instanceof fo,V=!0;return P.eachChild(function($){V=O?V&&M($):V&&$ instanceof na}),!!V&&Is(P)&&sf(P,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(b)){var k=new Mt;try{b=new na(b.type,b.evaluate(k))}catch(M){return this.error(M.message),null}}return b}return this.error('Unknown expression "'+m+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof s+" instead.")},ks.prototype.concat=function(s,l,u){var m="number"==typeof s?this.path.concat(s):this.path,y=u?this.scope.concat(u):this.scope;return new ks(this.registry,m,l||null,y,this.errors)},ks.prototype.error=function(s){for(var l=[],u=arguments.length-1;u-- >0;)l[u]=arguments[u+1];var m=""+this.key+l.map(function(y){return"["+y+"]"}).join("");this.errors.push(new ct(m,s))},ks.prototype.checkSubtype=function(s,l){var u=Fr(s,l);return u&&this.error(u),u};var Pa=function(s,l,u){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(var m=0,y=u;m<y.length;m+=1){var b=y[m],E=b[1];this.labels.push(b[0]),this.outputs.push(E)}};function pi(s,l,u){return s*(1-u)+l*u}Pa.parse=function(s,l){if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");var u=l.parse(s[1],1,Ne);if(!u)return null;var m=[],y=null;l.expectedType&&"value"!==l.expectedType.kind&&(y=l.expectedType);for(var b=1;b<s.length;b+=2){var E=1===b?-1/0:s[b],S=s[b+1],k=b,M=b+1;if("number"!=typeof E)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(m.length&&m[m.length-1][0]>=E)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);var P=l.parse(S,M,y);if(!P)return null;y=y||P.type,m.push([E,P])}return new Pa(y,u,m)},Pa.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;return m>=l[y-1]?u[y-1].evaluate(s):u[Ql(l,m)].evaluate(s)},Pa.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},Pa.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},Pa.prototype.serialize=function(){for(var s=["step",this.input.serialize()],l=0;l<this.labels.length;l++)l>0&&s.push(this.labels[l]),s.push(this.outputs[l].serialize());return s};var Vp=Object.freeze({__proto__:null,number:pi,color:function(s,l,u){return new wn(pi(s.r,l.r,u),pi(s.g,l.g,u),pi(s.b,l.b,u),pi(s.a,l.a,u))},array:function(s,l,u){return s.map(function(m,y){return pi(m,l[y],u)})}}),Qy=6/29*3*(6/29),Jy=Math.PI/180,Ow=180/Math.PI;function Vd(s){return s>.008856451679035631?Math.pow(s,1/3):s/Qy+4/29}function af(s){return s>6/29?s*s*s:Qy*(s-4/29)}function zp(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Up(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function jp(s){var l=Up(s.r),u=Up(s.g),m=Up(s.b),y=Vd((.4124564*l+.3575761*u+.1804375*m)/.95047),b=Vd((.2126729*l+.7151522*u+.072175*m)/1);return{l:116*b-16,a:500*(y-b),b:200*(b-Vd((.0193339*l+.119192*u+.9503041*m)/1.08883)),alpha:s.a}}function Jl(s){var l=(s.l+16)/116,u=isNaN(s.a)?l:l+s.a/500,m=isNaN(s.b)?l:l-s.b/200;return l=1*af(l),u=.95047*af(u),m=1.08883*af(m),new wn(zp(3.2404542*u-1.5371385*l-.4985314*m),zp(-.969266*u+1.8760108*l+.041556*m),zp(.0556434*u-.2040259*l+1.0572252*m),s.alpha)}function zd(s,l,u){var m=l-s;return s+u*(m>180||m<-180?m-360*Math.round(m/360):m)}var Lu={forward:jp,reverse:Jl,interpolate:function(s,l,u){return{l:pi(s.l,l.l,u),a:pi(s.a,l.a,u),b:pi(s.b,l.b,u),alpha:pi(s.alpha,l.alpha,u)}}},ss={forward:function(s){var l=jp(s),u=l.l,m=l.a,y=l.b,b=Math.atan2(y,m)*Ow;return{h:b<0?b+360:b,c:Math.sqrt(m*m+y*y),l:u,alpha:s.a}},reverse:function(s){var l=s.h*Jy,u=s.c;return Jl({l:s.l,a:Math.cos(l)*u,b:Math.sin(l)*u,alpha:s.alpha})},interpolate:function(s,l,u){return{h:zd(s.h,l.h,u),c:pi(s.c,l.c,u),l:pi(s.l,l.l,u),alpha:pi(s.alpha,l.alpha,u)}}},lf=Object.freeze({__proto__:null,lab:Lu,hcl:ss}),ln=function(s,l,u,m,y){this.type=s,this.operator=l,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(var b=0,E=y;b<E.length;b+=1){var S=E[b],k=S[1];this.labels.push(S[0]),this.outputs.push(k)}};function Og(s,l,u,m){var y=m-u,b=s-u;return 0===y?0:1===l?b/y:(Math.pow(l,b)-1)/(Math.pow(l,y)-1)}ln.interpolationFactor=function(s,l,u,m){var y=0;if("exponential"===s.name)y=Og(l,s.base,u,m);else if("linear"===s.name)y=Og(l,1,u,m);else if("cubic-bezier"===s.name){var b=s.controlPoints;y=new ze(b[0],b[1],b[2],b[3]).solve(Og(l,1,u,m))}return y},ln.parse=function(s,l){var u=s[0],m=s[1],y=s[2],b=s.slice(3);if(!Array.isArray(m)||0===m.length)return l.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){var E=m[1];if("number"!=typeof E)return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:E}}else{if("cubic-bezier"!==m[0])return l.error("Unknown interpolation type "+String(m[0]),1,0);var S=m.slice(1);if(4!==S.length||S.some(function(pe){return"number"!=typeof pe||pe<0||pe>1}))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:S}}if(s.length-1<4)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(!(y=l.parse(y,2,Ne)))return null;var k=[],M=null;"interpolate-hcl"===u||"interpolate-lab"===u?M=Jt:l.expectedType&&"value"!==l.expectedType.kind&&(M=l.expectedType);for(var P=0;P<b.length;P+=2){var O=b[P],V=b[P+1],$=P+3,ee=P+4;if("number"!=typeof O)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(k.length&&k[k.length-1][0]>=O)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);var Q=l.parse(V,ee,M);if(!Q)return null;M=M||Q.type,k.push([O,Q])}return"number"===M.kind||"color"===M.kind||"array"===M.kind&&"number"===M.itemType.kind&&"number"==typeof M.N?new ln(M,u,m,y,k):l.error("Type "+On(M)+" is not interpolatable.")},ln.prototype.evaluate=function(s){var l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(s);var m=this.input.evaluate(s);if(m<=l[0])return u[0].evaluate(s);var y=l.length;if(m>=l[y-1])return u[y-1].evaluate(s);var b=Ql(l,m),E=ln.interpolationFactor(this.interpolation,m,l[b],l[b+1]),S=u[b].evaluate(s),k=u[b+1].evaluate(s);return"interpolate"===this.operator?Vp[this.type.kind.toLowerCase()](S,k,E):"interpolate-hcl"===this.operator?ss.reverse(ss.interpolate(ss.forward(S),ss.forward(k),E)):Lu.reverse(Lu.interpolate(Lu.forward(S),Lu.forward(k),E))},ln.prototype.eachChild=function(s){s(this.input);for(var l=0,u=this.outputs;l<u.length;l+=1)s(u[l])},ln.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},ln.prototype.serialize=function(){var s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var l=[this.operator,s,this.input.serialize()],u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l};var oi=function(s,l){this.type=s,this.args=l};oi.parse=function(s,l){if(s.length<2)return l.error("Expectected at least one argument.");var u=null,m=l.expectedType;m&&"value"!==m.kind&&(u=m);for(var y=[],b=0,E=s.slice(1);b<E.length;b+=1){var S=l.parse(E[b],1+y.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,y.push(S)}var k=m&&y.some(function(M){return Fr(m,M.type)});return new oi(k?ue:u,y)},oi.prototype.evaluate=function(s){for(var l,u=null,m=0,y=0,b=this.args;y<b.length&&(m++,(u=b[y].evaluate(s))&&u instanceof Dr&&!u.available&&(l||(l=u.name),u=null,m===this.args.length&&(u=l)),null===u);y+=1);return u},oi.prototype.eachChild=function(s){this.args.forEach(s)},oi.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},oi.prototype.serialize=function(){var s=["coalesce"];return this.eachChild(function(l){s.push(l.serialize())}),s};var oo=function(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l};oo.prototype.evaluate=function(s){return this.result.evaluate(s)},oo.prototype.eachChild=function(s){for(var l=0,u=this.bindings;l<u.length;l+=1)s(u[l][1]);s(this.result)},oo.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found "+(s.length-1)+" instead.");for(var u=[],m=1;m<s.length-1;m+=2){var y=s[m];if("string"!=typeof y)return l.error("Expected string, but found "+typeof y+" instead.",m);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",m);var b=l.parse(s[m+1],m+1);if(!b)return null;u.push([y,b])}var E=l.parse(s[s.length-1],s.length-1,l.expectedType,u);return E?new oo(u,E):null},oo.prototype.outputDefined=function(){return this.result.outputDefined()},oo.prototype.serialize=function(){for(var s=["let"],l=0,u=this.bindings;l<u.length;l+=1){var m=u[l];s.push(m[0],m[1].serialize())}return s.push(this.result.serialize()),s};var Na=function(s,l,u){this.type=s,this.index=l,this.input=u};Na.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,Ne),m=l.parse(s[2],2,Cr(l.expectedType||ue));return u&&m?new Na(m.type.itemType,u,m):null},Na.prototype.evaluate=function(s){var l=this.index.evaluate(s),u=this.input.evaluate(s);if(l<0)throw new kr("Array index out of bounds: "+l+" < 0.");if(l>=u.length)throw new kr("Array index out of bounds: "+l+" > "+(u.length-1)+".");if(l!==Math.floor(l))throw new kr("Array index must be an integer, but found "+l+" instead.");return u[l]},Na.prototype.eachChild=function(s){s(this.index),s(this.input)},Na.prototype.outputDefined=function(){return!1},Na.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var $s=function(s,l){this.type=Ve,this.needle=s,this.haystack=l};$s.parse=function(s,l){if(3!==s.length)return l.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,ue);return u&&m?xn(u.type,[Ve,rt,Ne,xt,ue])?new $s(u,m):l.error("Expected first argument to be of type boolean, string, number or null, but found "+On(u.type)+" instead"):null},$s.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!u)return!1;if(!fn(l,["boolean","string","number","null"]))throw new kr("Expected first argument to be of type boolean, string, number or null, but found "+On(zi(l))+" instead.");if(!fn(u,["string","array"]))throw new kr("Expected second argument to be of type array or string, but found "+On(zi(u))+" instead.");return u.indexOf(l)>=0},$s.prototype.eachChild=function(s){s(this.needle),s(this.haystack)},$s.prototype.outputDefined=function(){return!0},$s.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var tn=function(s,l,u){this.type=Ne,this.needle=s,this.haystack=l,this.fromIndex=u};tn.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,ue);if(!u||!m)return null;if(!xn(u.type,[Ve,rt,Ne,xt,ue]))return l.error("Expected first argument to be of type boolean, string, number or null, but found "+On(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Ne);return y?new tn(u,m,y):null}return new tn(u,m)},tn.prototype.evaluate=function(s){var l=this.needle.evaluate(s),u=this.haystack.evaluate(s);if(!fn(l,["boolean","string","number","null"]))throw new kr("Expected first argument to be of type boolean, string, number or null, but found "+On(zi(l))+" instead.");if(!fn(u,["string","array"]))throw new kr("Expected second argument to be of type array or string, but found "+On(zi(u))+" instead.");if(this.fromIndex){var m=this.fromIndex.evaluate(s);return u.indexOf(l,m)}return u.indexOf(l)},tn.prototype.eachChild=function(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)},tn.prototype.outputDefined=function(){return!1},tn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Tn=function(s,l,u,m,y,b){this.inputType=s,this.type=l,this.input=u,this.cases=m,this.outputs=y,this.otherwise=b};Tn.parse=function(s,l){if(s.length<5)return l.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if(s.length%2!=1)return l.error("Expected an even number of arguments.");var u,m;l.expectedType&&"value"!==l.expectedType.kind&&(m=l.expectedType);for(var y={},b=[],E=2;E<s.length-1;E+=2){var S=s[E],k=s[E+1];Array.isArray(S)||(S=[S]);var M=l.concat(E);if(0===S.length)return M.error("Expected at least one branch label.");for(var P=0,O=S;P<O.length;P+=1){var V=O[P];if("number"!=typeof V&&"string"!=typeof V)return M.error("Branch labels must be numbers or strings.");if("number"==typeof V&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return M.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof V&&Math.floor(V)!==V)return M.error("Numeric branch labels must be integer values.");if(u){if(M.checkSubtype(u,zi(V)))return null}else u=zi(V);if(void 0!==y[String(V)])return M.error("Branch labels must be unique.");y[String(V)]=b.length}var $=l.parse(k,E,m);if(!$)return null;m=m||$.type,b.push($)}var ee=l.parse(s[1],1,ue);if(!ee)return null;var Q=l.parse(s[s.length-1],s.length-1,m);return Q?"value"!==ee.type.kind&&l.concat(1).checkSubtype(u,ee.type)?null:new Tn(u,m,ee,y,b,Q):null},Tn.prototype.evaluate=function(s){var l=this.input.evaluate(s);return(zi(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)},Tn.prototype.eachChild=function(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)},Tn.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})&&this.otherwise.outputDefined()},Tn.prototype.serialize=function(){for(var s=this,l=["match",this.input.serialize()],u=[],m={},y=0,b=Object.keys(this.cases).sort();y<b.length;y+=1){var E=b[y];void 0===(O=m[this.cases[E]])?(m[this.cases[E]]=u.length,u.push([this.cases[E],[E]])):u[O][1].push(E)}for(var S=function($){return"number"===s.inputType.kind?Number($):$},k=0,M=u;k<M.length;k+=1){var P=M[k],O=P[0],V=P[1];l.push(1===V.length?S(V[0]):V.map(S)),l.push(this.outputs[outputIndex$1].serialize())}return l.push(this.otherwise.serialize()),l};var Fu=function(s,l,u){this.type=s,this.branches=l,this.otherwise=u};Fu.parse=function(s,l){if(s.length<4)return l.error("Expected at least 3 arguments, but found only "+(s.length-1)+".");if(s.length%2!=0)return l.error("Expected an odd number of arguments.");var u;l.expectedType&&"value"!==l.expectedType.kind&&(u=l.expectedType);for(var m=[],y=1;y<s.length-1;y+=2){var b=l.parse(s[y],y,Ve);if(!b)return null;var E=l.parse(s[y+1],y+1,u);if(!E)return null;m.push([b,E]),u=u||E.type}var S=l.parse(s[s.length-1],s.length-1,u);return S?new Fu(u,m,S):null},Fu.prototype.evaluate=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];if(m[0].evaluate(s))return y.evaluate(s)}return this.otherwise.evaluate(s)},Fu.prototype.eachChild=function(s){for(var l=0,u=this.branches;l<u.length;l+=1){var m=u[l],y=m[1];s(m[0]),s(y)}s(this.otherwise)},Fu.prototype.outputDefined=function(){return this.branches.every(function(s){return s[1].outputDefined()})&&this.otherwise.outputDefined()},Fu.prototype.serialize=function(){var s=["case"];return this.eachChild(function(l){s.push(l.serialize())}),s};var ec=function(s,l,u,m){this.type=s,this.input=l,this.beginIndex=u,this.endIndex=m};function cf(s,l){return"=="===s||"!="===s?"boolean"===l.kind||"string"===l.kind||"number"===l.kind||"null"===l.kind||"value"===l.kind:"string"===l.kind||"number"===l.kind||"value"===l.kind}function yr(s,l,u,m){return 0===m.compare(l,u)}function Oa(s,l,u){var m="=="!==s&&"!="!==s;return function(){function y(b,E,S){this.type=Ve,this.lhs=b,this.rhs=E,this.collator=S,this.hasUntypedArgument="value"===b.type.kind||"value"===E.type.kind}return y.parse=function(b,E){if(3!==b.length&&4!==b.length)return E.error("Expected two or three arguments.");var S=b[0],k=E.parse(b[1],1,ue);if(!k)return null;if(!cf(S,k.type))return E.concat(1).error('"'+S+"\" comparisons are not supported for type '"+On(k.type)+"'.");var M=E.parse(b[2],2,ue);if(!M)return null;if(!cf(S,M.type))return E.concat(2).error('"'+S+"\" comparisons are not supported for type '"+On(M.type)+"'.");if(k.type.kind!==M.type.kind&&"value"!==k.type.kind&&"value"!==M.type.kind)return E.error("Cannot compare types '"+On(k.type)+"' and '"+On(M.type)+"'.");m&&("value"===k.type.kind&&"value"!==M.type.kind?k=new fo(M.type,[k]):"value"!==k.type.kind&&"value"===M.type.kind&&(M=new fo(k.type,[M])));var P=null;if(4===b.length){if("string"!==k.type.kind&&"string"!==M.type.kind&&"value"!==k.type.kind&&"value"!==M.type.kind)return E.error("Cannot use collator to compare non-string types.");if(!(P=E.parse(b[3],3,ur)))return null}return new y(k,M,P)},y.prototype.evaluate=function(b){var E=this.lhs.evaluate(b),S=this.rhs.evaluate(b);if(m&&this.hasUntypedArgument){var k=zi(E),M=zi(S);if(k.kind!==M.kind||"string"!==k.kind&&"number"!==k.kind)throw new kr('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+k.kind+", "+M.kind+") instead.")}if(this.collator&&!m&&this.hasUntypedArgument){var P=zi(E),O=zi(S);if("string"!==P.kind||"string"!==O.kind)return l(b,E,S)}return this.collator?u(b,E,S,this.collator.evaluate(b)):l(b,E,S)},y.prototype.eachChild=function(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)},y.prototype.outputDefined=function(){return!0},y.prototype.serialize=function(){var b=[s];return this.eachChild(function(E){b.push(E.serialize())}),b},y}()}ec.parse=function(s,l){if(s.length<=2||s.length>=5)return l.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1,ue),m=l.parse(s[2],2,Ne);if(!u||!m)return null;if(!xn(u.type,[Cr(ue),rt,ue]))return l.error("Expected first argument to be of type array or string, but found "+On(u.type)+" instead");if(4===s.length){var y=l.parse(s[3],3,Ne);return y?new ec(u.type,u,m,y):null}return new ec(u.type,u,m)},ec.prototype.evaluate=function(s){var l=this.input.evaluate(s),u=this.beginIndex.evaluate(s);if(!fn(l,["string","array"]))throw new kr("Expected first argument to be of type array or string, but found "+On(zi(l))+" instead.");if(this.endIndex){var m=this.endIndex.evaluate(s);return l.slice(u,m)}return l.slice(u)},ec.prototype.eachChild=function(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)},ec.prototype.outputDefined=function(){return!1},ec.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Bu=Oa("==",function(s,l,u){return l===u},yr),ev=Oa("!=",function(s,l,u){return l!==u},function(s,l,u,m){return!yr(0,l,u,m)}),tv=Oa("<",function(s,l,u){return l<u},function(s,l,u,m){return m.compare(l,u)<0}),Lg=Oa(">",function(s,l,u){return l>u},function(s,l,u,m){return m.compare(l,u)>0}),uf=Oa("<=",function(s,l,u){return l<=u},function(s,l,u,m){return m.compare(l,u)<=0}),Lw=Oa(">=",function(s,l,u){return l>=u},function(s,l,u,m){return m.compare(l,u)>=0}),tc=function(s,l,u,m,y){this.type=rt,this.number=s,this.locale=l,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=y};tc.parse=function(s,l){if(3!==s.length)return l.error("Expected two arguments.");var u=l.parse(s[1],1,Ne);if(!u)return null;var m=s[2];if("object"!=typeof m||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");var y=null;if(m.locale&&!(y=l.parse(m.locale,1,rt)))return null;var b=null;if(m.currency&&!(b=l.parse(m.currency,1,rt)))return null;var E=null;if(m["min-fraction-digits"]&&!(E=l.parse(m["min-fraction-digits"],1,Ne)))return null;var S=null;return m["max-fraction-digits"]&&!(S=l.parse(m["max-fraction-digits"],1,Ne))?null:new tc(u,y,b,E,S)},tc.prototype.evaluate=function(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))},tc.prototype.eachChild=function(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)},tc.prototype.outputDefined=function(){return!1},tc.prototype.serialize=function(){var s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]};var _l=function(s){this.type=Ne,this.input=s};_l.parse=function(s,l){if(2!==s.length)return l.error("Expected 1 argument, but found "+(s.length-1)+" instead.");var u=l.parse(s[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?l.error("Expected argument of type string or array, but found "+On(u.type)+" instead."):new _l(u):null},_l.prototype.evaluate=function(s){var l=this.input.evaluate(s);if("string"==typeof l||Array.isArray(l))return l.length;throw new kr("Expected value to be of type string or array, but found "+On(zi(l))+" instead.")},_l.prototype.eachChild=function(s){s(this.input)},_l.prototype.outputDefined=function(){return!1},_l.prototype.serialize=function(){var s=["length"];return this.eachChild(function(l){s.push(l.serialize())}),s};var Vu={"==":Bu,"!=":ev,">":Lg,"<":tv,">=":Lw,"<=":uf,array:fo,at:Na,boolean:fo,case:Fu,coalesce:oi,collator:Ti,format:os,image:Kl,in:$s,"index-of":tn,interpolate:ln,"interpolate-hcl":ln,"interpolate-lab":ln,length:_l,let:oo,literal:na,match:Tn,number:fo,"number-format":tc,object:fo,slice:ec,step:Pa,string:fo,"to-boolean":ra,"to-color":ra,"to-number":ra,"to-string":ra,var:Xl,within:io};function Fg(s,l){var u=l[0],m=l[1],y=l[2],b=l[3];u=u.evaluate(s),m=m.evaluate(s),y=y.evaluate(s);var E=b?b.evaluate(s):1,S=Pg(u,m,y,E);if(S)throw new kr(S);return new wn(u/255*E,m/255*E,y/255*E,E)}function df(s,l){return s in l}function hf(s,l){var u=l[s];return void 0===u?null:u}function Si(s){return{type:s}}function ff(s){return{result:"success",value:s}}function zu(s){return{result:"error",value:s}}function Ud(s){return"data-driven"===s["property-type"]||"cross-faded-data-driven"===s["property-type"]}function La(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function jd(s){return!!s.expression&&s.expression.interpolated}function mr(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function pf(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function Dt(s){return s}function qc(s,l,u){return void 0!==s?s:void 0!==l?l:void 0!==u?u:void 0}function X(s,l,u,m,y){return qc(typeof u===y?m[u]:void 0,s.default,l.default)}function Hd(s,l,u){if("number"!==mr(u))return qc(s.default,l.default);var m=s.stops.length;if(1===m||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[m-1][0])return s.stops[m-1][1];var y=Ql(s.stops.map(function(b){return b[0]}),u);return s.stops[y][1]}function $d(s,l,u){var m=void 0!==s.base?s.base:1;if("number"!==mr(u))return qc(s.default,l.default);var y=s.stops.length;if(1===y||u<=s.stops[0][0])return s.stops[0][1];if(u>=s.stops[y-1][0])return s.stops[y-1][1];var V,$,Q,pe,b=Ql(s.stops.map(function(O){return O[0]}),u),E=(V=m,pe=u-($=s.stops[b][0]),0===(Q=s.stops[b+1][0]-$)?0:1===V?pe/Q:(Math.pow(V,pe)-1)/(Math.pow(V,Q)-1)),S=s.stops[b][1],k=s.stops[b+1][1],M=Vp[l.type]||Dt;if(s.colorSpace&&"rgb"!==s.colorSpace){var P=lf[s.colorSpace];M=function(O,V){return P.reverse(P.interpolate(P.forward(O),P.forward(V),E))}}return"function"==typeof S.evaluate?{evaluate:function(){for(var O=[],V=arguments.length;V--;)O[V]=arguments[V];var $=S.evaluate.apply(void 0,O),ee=k.evaluate.apply(void 0,O);if(void 0!==$&&void 0!==ee)return M($,ee,E)}}:M(S,k,E)}function mf(s,l,u){return"color"===l.type?u=wn.parse(u):"formatted"===l.type?u=ii.fromString(u.toString()):"resolvedImage"===l.type?u=Dr.fromString(u.toString()):mr(u)===l.type||"enum"===l.type&&l.values[u]||(u=void 0),qc(u,s.default,l.default)}ro.register(Vu,{error:[{kind:"error"},[rt],function(s,l){throw new kr(l[0].evaluate(s))}],typeof:[rt,[ue],function(s,l){return On(zi(l[0].evaluate(s)))}],"to-rgba":[Cr(Ne,4),[Jt],function(s,l){return l[0].evaluate(s).toArray()}],rgb:[Jt,[Ne,Ne,Ne],Fg],rgba:[Jt,[Ne,Ne,Ne,Ne],Fg],has:{type:Ve,overloads:[[[rt],function(s,l){return df(l[0].evaluate(s),s.properties())}],[[rt,en],function(s,l){var u=l[1];return df(l[0].evaluate(s),u.evaluate(s))}]]},get:{type:ue,overloads:[[[rt],function(s,l){return hf(l[0].evaluate(s),s.properties())}],[[rt,en],function(s,l){var u=l[1];return hf(l[0].evaluate(s),u.evaluate(s))}]]},"feature-state":[ue,[rt],function(s,l){return hf(l[0].evaluate(s),s.featureState||{})}],properties:[en,[],function(s){return s.properties()}],"geometry-type":[rt,[],function(s){return s.geometryType()}],id:[ue,[],function(s){return s.id()}],zoom:[Ne,[],function(s){return s.globals.zoom}],"heatmap-density":[Ne,[],function(s){return s.globals.heatmapDensity||0}],"line-progress":[Ne,[],function(s){return s.globals.lineProgress||0}],accumulated:[ue,[],function(s){return void 0===s.globals.accumulated?null:s.globals.accumulated}],"+":[Ne,Si(Ne),function(s,l){for(var u=0,m=0,y=l;m<y.length;m+=1)u+=y[m].evaluate(s);return u}],"*":[Ne,Si(Ne),function(s,l){for(var u=1,m=0,y=l;m<y.length;m+=1)u*=y[m].evaluate(s);return u}],"-":{type:Ne,overloads:[[[Ne,Ne],function(s,l){var u=l[1];return l[0].evaluate(s)-u.evaluate(s)}],[[Ne],function(s,l){return-l[0].evaluate(s)}]]},"/":[Ne,[Ne,Ne],function(s,l){var u=l[1];return l[0].evaluate(s)/u.evaluate(s)}],"%":[Ne,[Ne,Ne],function(s,l){var u=l[1];return l[0].evaluate(s)%u.evaluate(s)}],ln2:[Ne,[],function(){return Math.LN2}],pi:[Ne,[],function(){return Math.PI}],e:[Ne,[],function(){return Math.E}],"^":[Ne,[Ne,Ne],function(s,l){var u=l[1];return Math.pow(l[0].evaluate(s),u.evaluate(s))}],sqrt:[Ne,[Ne],function(s,l){return Math.sqrt(l[0].evaluate(s))}],log10:[Ne,[Ne],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN10}],ln:[Ne,[Ne],function(s,l){return Math.log(l[0].evaluate(s))}],log2:[Ne,[Ne],function(s,l){return Math.log(l[0].evaluate(s))/Math.LN2}],sin:[Ne,[Ne],function(s,l){return Math.sin(l[0].evaluate(s))}],cos:[Ne,[Ne],function(s,l){return Math.cos(l[0].evaluate(s))}],tan:[Ne,[Ne],function(s,l){return Math.tan(l[0].evaluate(s))}],asin:[Ne,[Ne],function(s,l){return Math.asin(l[0].evaluate(s))}],acos:[Ne,[Ne],function(s,l){return Math.acos(l[0].evaluate(s))}],atan:[Ne,[Ne],function(s,l){return Math.atan(l[0].evaluate(s))}],min:[Ne,Si(Ne),function(s,l){return Math.min.apply(Math,l.map(function(u){return u.evaluate(s)}))}],max:[Ne,Si(Ne),function(s,l){return Math.max.apply(Math,l.map(function(u){return u.evaluate(s)}))}],abs:[Ne,[Ne],function(s,l){return Math.abs(l[0].evaluate(s))}],round:[Ne,[Ne],function(s,l){var u=l[0].evaluate(s);return u<0?-Math.round(-u):Math.round(u)}],floor:[Ne,[Ne],function(s,l){return Math.floor(l[0].evaluate(s))}],ceil:[Ne,[Ne],function(s,l){return Math.ceil(l[0].evaluate(s))}],"filter-==":[Ve,[rt,ue],function(s,l){var u=l[0],m=l[1];return s.properties()[u.value]===m.value}],"filter-id-==":[Ve,[ue],function(s,l){var u=l[0];return s.id()===u.value}],"filter-type-==":[Ve,[rt],function(s,l){var u=l[0];return s.geometryType()===u.value}],"filter-<":[Ve,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<b}],"filter-id-<":[Ve,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<y}],"filter->":[Ve,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>b}],"filter-id->":[Ve,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>y}],"filter-<=":[Ve,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y<=b}],"filter-id-<=":[Ve,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m<=y}],"filter->=":[Ve,[rt,ue],function(s,l){var u=l[0],m=l[1],y=s.properties()[u.value],b=m.value;return typeof y==typeof b&&y>=b}],"filter-id->=":[Ve,[ue],function(s,l){var u=l[0],m=s.id(),y=u.value;return typeof m==typeof y&&m>=y}],"filter-has":[Ve,[ue],function(s,l){return l[0].value in s.properties()}],"filter-has-id":[Ve,[],function(s){return null!==s.id()&&void 0!==s.id()}],"filter-type-in":[Ve,[Cr(rt)],function(s,l){return l[0].value.indexOf(s.geometryType())>=0}],"filter-id-in":[Ve,[Cr(ue)],function(s,l){return l[0].value.indexOf(s.id())>=0}],"filter-in-small":[Ve,[rt,Cr(ue)],function(s,l){var u=l[0];return l[1].value.indexOf(s.properties()[u.value])>=0}],"filter-in-large":[Ve,[rt,Cr(ue)],function(s,l){var u=l[0],m=l[1];return function(y,b,E,S){for(;E<=S;){var k=E+S>>1;if(b[k]===y)return!0;b[k]>y?S=k-1:E=k+1}return!1}(s.properties()[u.value],m.value,0,m.value.length-1)}],all:{type:Ve,overloads:[[[Ve,Ve],function(s,l){var u=l[1];return l[0].evaluate(s)&&u.evaluate(s)}],[Si(Ve),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(!m[u].evaluate(s))return!1;return!0}]]},any:{type:Ve,overloads:[[[Ve,Ve],function(s,l){var u=l[1];return l[0].evaluate(s)||u.evaluate(s)}],[Si(Ve),function(s,l){for(var u=0,m=l;u<m.length;u+=1)if(m[u].evaluate(s))return!0;return!1}]]},"!":[Ve,[Ve],function(s,l){return!l[0].evaluate(s)}],"is-supported-script":[Ve,[rt],function(s,l){var u=s.globals&&s.globals.isSupportedScript;return!u||u(l[0].evaluate(s))}],upcase:[rt,[rt],function(s,l){return l[0].evaluate(s).toUpperCase()}],downcase:[rt,[rt],function(s,l){return l[0].evaluate(s).toLowerCase()}],concat:[rt,Si(ue),function(s,l){return l.map(function(u){return Oo(u.evaluate(s))}).join("")}],"resolved-locale":[rt,[ur],function(s,l){return l[0].evaluate(s).resolvedLocale()}]});var Fa=function(s,l){var u;this.expression=s,this._warningHistory={},this._evaluator=new Mt,this._defaultValue=l?"color"===(u=l).type&&pf(u.default)?new wn(0,0,0,0):"color"===u.type?wn.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=l&&"enum"===l.type?l.values:null};function gf(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in Vu}function Ba(s,l){var y,b,u=new ks(Vu,[],l?(b={color:Jt,string:rt,number:Ne,enum:rt,boolean:Ve,formatted:jt,resolvedImage:an},"array"===(y=l).type?Cr(b[y.value]||ue,y.length):b[y.type]):void 0),m=u.parse(s,void 0,void 0,void 0,l&&"string"===l.type?{typeAnnotation:"coerce"}:void 0);return m?ff(new Fa(m,l)):zu(u.errors)}Fa.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)},Fa.prototype.evaluate=function(s,l,u,m,y,b){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null;try{var E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new kr("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(E)+" instead.");return E}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var qd=function(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent="constant"!==s&&!Yl(l.expression)};qd.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},qd.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)};var mo=function(s,l,u,m){this.kind=s,this.zoomStops=u,this._styleExpression=l,this.isStateDependent="camera"!==s&&!Yl(l.expression),this.interpolationType=m};function nc(s,l){if("error"===(s=Ba(s,l)).result)return s;var u=s.value.expression,m=Is(u);if(!m&&!Ud(l))return zu([new ct("","data expressions not supported")]);var y=sf(u,["zoom"]);if(!y&&!La(l))return zu([new ct("","zoom expressions not supported")]);var b=function E(S){var k=null;if(S instanceof oo)k=E(S.result);else if(S instanceof oi)for(var M=0,P=S.args;M<P.length&&!(k=E(P[M]));M+=1);else(S instanceof Pa||S instanceof ln)&&S.input instanceof ro&&"zoom"===S.input.name&&(k=S);return k instanceof ct||S.eachChild(function(O){var V=E(O);V instanceof ct?k=V:!k&&V?k=new ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):k&&V&&k!==V&&(k=new ct("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),k}(u);return b||y?b instanceof ct?zu([b]):b instanceof ln&&!jd(l)?zu([new ct("",'"interpolate" expressions cannot be used with this property')]):ff(b?new mo(m?"camera":"composite",s.value,b.labels,b instanceof ln?b.interpolation:void 0):new qd(m?"constant":"source",s.value)):zu([new ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}mo.prototype.evaluateWithoutErrorHandling=function(s,l,u,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(s,l,u,m,y,b)},mo.prototype.evaluate=function(s,l,u,m,y,b){return this._styleExpression.evaluate(s,l,u,m,y,b)},mo.prototype.interpolationFactor=function(s,l,u){return this.interpolationType?ln.interpolationFactor(this.interpolationType,s,l,u):0};var Uu=function(s,l){this._parameters=s,this._specification=l,Je(this,function u(m,y){var b,E,S,k="color"===y.type,M=m.stops&&"object"==typeof m.stops[0][0],P=M||!(M||void 0!==m.property),O=m.type||(jd(y)?"exponential":"interval");if(k&&((m=Je({},m)).stops&&(m.stops=m.stops.map(function(it){return[it[0],wn.parse(it[1])]})),m.default=wn.parse(m.default?m.default:y.default)),m.colorSpace&&"rgb"!==m.colorSpace&&!lf[m.colorSpace])throw new Error("Unknown color space: "+m.colorSpace);if("exponential"===O)b=$d;else if("interval"===O)b=Hd;else if("categorical"===O){b=X,E=Object.create(null);for(var V=0,$=m.stops;V<$.length;V+=1){var ee=$[V];E[ee[0]]=ee[1]}S=typeof m.stops[0][0]}else{if("identity"!==O)throw new Error('Unknown function type "'+O+'"');b=mf}if(M){for(var Q={},pe=[],he=0;he<m.stops.length;he++){var ve=m.stops[he],ye=ve[0].zoom;void 0===Q[ye]&&(Q[ye]={zoom:ye,type:m.type,property:m.property,default:m.default,stops:[]},pe.push(ye)),Q[ye].stops.push([ve[0].value,ve[1]])}for(var Ie=[],ke=0,Oe=pe;ke<Oe.length;ke+=1){var Ye=Oe[ke];Ie.push([Q[Ye].zoom,u(Q[Ye],y)])}var nt={name:"linear"};return{kind:"composite",interpolationType:nt,interpolationFactor:ln.interpolationFactor.bind(void 0,nt),zoomStops:Ie.map(function(it){return it[0]}),evaluate:function(it,kt){var ot=it.zoom;return $d({stops:Ie,base:m.base},y,ot).evaluate(ot,kt)}}}if(P){var yt="exponential"===O?{name:"exponential",base:void 0!==m.base?m.base:1}:null;return{kind:"camera",interpolationType:yt,interpolationFactor:ln.interpolationFactor.bind(void 0,yt),zoomStops:m.stops.map(function(it){return it[0]}),evaluate:function(it){return b(m,y,it.zoom,E,S)}}}return{kind:"source",evaluate:function(it,kt){var ot=kt&&kt.properties?kt.properties[m.property]:void 0;return void 0===ot?qc(m.default,y.default):b(m,y,ot,E,S)}}}(this._parameters,this._specification))};function as(s){var l=s.key,u=s.value,m=s.valueSpec||{},y=s.objectElementValidators||{},b=s.style,E=s.styleSpec,S=[],k=mr(u);if("object"!==k)return[new se(l,u,"object expected, "+k+" found")];for(var M in u){var P=M.split(".")[0],O=m[P]||m["*"],V=void 0;if(y[P])V=y[P];else if(m[P])V=Sn;else if(y["*"])V=y["*"];else{if(!m["*"]){S.push(new se(l,u[M],'unknown property "'+M+'"'));continue}V=Sn}S=S.concat(V({key:(l&&l+".")+M,value:u[M],valueSpec:O,style:b,styleSpec:E,object:u,objectKey:M},u))}for(var $ in m)y[$]||m[$].required&&void 0===m[$].default&&void 0===u[$]&&S.push(new se(l,u,'missing required property "'+$+'"'));return S}function Gd(s){var l=s.value,u=s.valueSpec,m=s.style,y=s.styleSpec,b=s.key,E=s.arrayElementValidator||Sn;if("array"!==mr(l))return[new se(b,l,"array expected, "+mr(l)+" found")];if(u.length&&l.length!==u.length)return[new se(b,l,"array length "+u.length+" expected, length "+l.length+" found")];if(u["min-length"]&&l.length<u["min-length"])return[new se(b,l,"array length at least "+u["min-length"]+" expected, length "+l.length+" found")];var S={type:u.value,values:u.values};y.$version<7&&(S.function=u.function),"object"===mr(u.value)&&(S=u.value);for(var k=[],M=0;M<l.length;M++)k=k.concat(E({array:l,arrayIndex:M,value:l[M],valueSpec:S,style:m,styleSpec:y,key:b+"["+M+"]"}));return k}function Hp(s){var l=s.key,u=s.value,m=s.valueSpec,y=mr(u);return"number"===y&&u!=u&&(y="NaN"),"number"!==y?[new se(l,u,"number expected, "+y+" found")]:"minimum"in m&&u<m.minimum?[new se(l,u,u+" is less than the minimum value "+m.minimum)]:"maximum"in m&&u>m.maximum?[new se(l,u,u+" is greater than the maximum value "+m.maximum)]:[]}function _f(s){var l,u,m,y=s.valueSpec,b=Te(s.value.type),E={},S="categorical"!==b&&void 0===s.value.property,k=!S,M="array"===mr(s.value.stops)&&"array"===mr(s.value.stops[0])&&"object"===mr(s.value.stops[0][0]),P=as({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function($){if("identity"===b)return[new se($.key,$.value,'identity function may not have a "stops" property')];var ee=[],Q=$.value;return ee=ee.concat(Gd({key:$.key,value:Q,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:O})),"array"===mr(Q)&&0===Q.length&&ee.push(new se($.key,Q,"array must have at least one stop")),ee},default:function($){return Sn({key:$.key,value:$.value,valueSpec:y,style:$.style,styleSpec:$.styleSpec})}}});return"identity"===b&&S&&P.push(new se(s.key,s.value,'missing required property "property"')),"identity"===b||s.value.stops||P.push(new se(s.key,s.value,'missing required property "stops"')),"exponential"===b&&s.valueSpec.expression&&!jd(s.valueSpec)&&P.push(new se(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(k&&!Ud(s.valueSpec)?P.push(new se(s.key,s.value,"property functions not supported")):S&&!La(s.valueSpec)&&P.push(new se(s.key,s.value,"zoom functions not supported"))),"categorical"!==b&&!M||void 0!==s.value.property||P.push(new se(s.key,s.value,'"property" property is required')),P;function O($){var ee=[],Q=$.value,pe=$.key;if("array"!==mr(Q))return[new se(pe,Q,"array expected, "+mr(Q)+" found")];if(2!==Q.length)return[new se(pe,Q,"array length 2 expected, length "+Q.length+" found")];if(M){if("object"!==mr(Q[0]))return[new se(pe,Q,"object expected, "+mr(Q[0])+" found")];if(void 0===Q[0].zoom)return[new se(pe,Q,"object stop key must have zoom")];if(void 0===Q[0].value)return[new se(pe,Q,"object stop key must have value")];if(m&&m>Te(Q[0].zoom))return[new se(pe,Q[0].zoom,"stop zoom values must appear in ascending order")];Te(Q[0].zoom)!==m&&(m=Te(Q[0].zoom),u=void 0,E={}),ee=ee.concat(as({key:pe+"[0]",value:Q[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Hp,value:V}}))}else ee=ee.concat(V({key:pe+"[0]",value:Q[0],valueSpec:{},style:$.style,styleSpec:$.styleSpec},Q));return gf($e(Q[1]))?ee.concat([new se(pe+"[1]",Q[1],"expressions are not allowed in function stops.")]):ee.concat(Sn({key:pe+"[1]",value:Q[1],valueSpec:y,style:$.style,styleSpec:$.styleSpec}))}function V($,ee){var Q=mr($.value),pe=Te($.value),he=null!==$.value?$.value:ee;if(l){if(Q!==l)return[new se($.key,he,Q+" stop domain type must match previous stop domain type "+l)]}else l=Q;if("number"!==Q&&"string"!==Q&&"boolean"!==Q)return[new se($.key,he,"stop domain value must be a number, string, or boolean")];if("number"!==Q&&"categorical"!==b){var ve="number expected, "+Q+" found";return Ud(y)&&void 0===b&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new se($.key,he,ve)]}return"categorical"!==b||"number"!==Q||isFinite(pe)&&Math.floor(pe)===pe?"categorical"!==b&&"number"===Q&&void 0!==u&&pe<u?[new se($.key,he,"stop domain values must appear in ascending order")]:(u=pe,"categorical"===b&&pe in E?[new se($.key,he,"stop domain values must be unique")]:(E[pe]=!0,[])):[new se($.key,he,"integer expected, found "+pe)]}}function Va(s){var l=("property"===s.expressionContext?nc:Ba)($e(s.value),s.valueSpec);if("error"===l.result)return l.value.map(function(m){return new se(""+s.key+m.key,s.value,m.message)});var u=l.value.expression||l.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!u.outputDefined())return[new se(s.key,s.value,'Invalid data expression for "'+s.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===s.expressionContext&&"layout"===s.propertyType&&!Yl(u))return[new se(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext&&!Yl(u))return[new se(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!sf(u,["zoom","feature-state"]))return[new se(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!Is(u))return[new se(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gc(s){var l=s.key,u=s.value,m=s.valueSpec,y=[];return Array.isArray(m.values)?-1===m.values.indexOf(Te(u))&&y.push(new se(l,u,"expected one of ["+m.values.join(", ")+"], "+JSON.stringify(u)+" found")):-1===Object.keys(m.values).indexOf(Te(u))&&y.push(new se(l,u,"expected one of ["+Object.keys(m.values).join(", ")+"], "+JSON.stringify(u)+" found")),y}function yl(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(var l=0,u=s.slice(1);l<u.length;l+=1){var m=u[l];if(!yl(m)&&"boolean"!=typeof m)return!1}return!0;default:return!0}}Uu.deserialize=function(s){return new Uu(s._parameters,s._specification)},Uu.serialize=function(s){return{_parameters:s._parameters,_specification:s._specification}};var nv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function As(s){if(null==s)return{filter:function(){return!0},needGeometry:!1};yl(s)||(s=qs(s));var l=Ba(s,nv);if("error"===l.result)throw new Error(l.value.map(function(u){return u.key+": "+u.message}).join(", "));return{filter:function(u,m,y){return l.value.evaluate(u,m,{},y)},needGeometry:function u(m){if(!Array.isArray(m))return!1;if("within"===m[0])return!0;for(var y=1;y<m.length;y++)if(u(m[y]))return!0;return!1}(s)}}function Ar(s,l){return s<l?-1:s>l?1:0}function qs(s){if(!s)return!0;var l,u=s[0];return s.length<=1?"any"!==u:"=="===u?yf(s[1],s[2],"=="):"!="===u?za(yf(s[1],s[2],"==")):"<"===u||">"===u||"<="===u||">="===u?yf(s[1],s[2],u):"any"===u?(l=s.slice(1),["any"].concat(l.map(qs))):"all"===u?["all"].concat(s.slice(1).map(qs)):"none"===u?["all"].concat(s.slice(1).map(qs).map(za)):"in"===u?vf(s[1],s.slice(2)):"!in"===u?za(vf(s[1],s.slice(2))):"has"===u?Wd(s[1]):"!has"===u?za(Wd(s[1])):"within"!==u||s}function yf(s,l,u){switch(s){case"$type":return["filter-type-"+u,l];case"$id":return["filter-id-"+u,l];default:return["filter-"+u,s,l]}}function vf(s,l){if(0===l.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(function(u){return typeof u!=typeof l[0]})?["filter-in-large",s,["literal",l.sort(Ar)]]:["filter-in-small",s,["literal",l]]}}function Wd(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function za(s){return["!",s]}function bf(s){return yl($e(s.value))?Va(Je({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(u){var m=u.value,y=u.key;if("array"!==mr(m))return[new se(y,m,"array expected, "+mr(m)+" found")];var b,E=u.styleSpec,S=[];if(m.length<1)return[new se(y,m,"filter array must have at least 1 element")];switch(S=S.concat(Gc({key:y+"[0]",value:m[0],valueSpec:E.filter_operator,style:u.style,styleSpec:u.styleSpec})),Te(m[0])){case"<":case"<=":case">":case">=":m.length>=2&&"$type"===Te(m[1])&&S.push(new se(y,m,'"$type" cannot be use with operator "'+m[0]+'"'));case"==":case"!=":3!==m.length&&S.push(new se(y,m,'filter array for operator "'+m[0]+'" must have 3 elements'));case"in":case"!in":m.length>=2&&"string"!==(b=mr(m[1]))&&S.push(new se(y+"[1]",m[1],"string expected, "+b+" found"));for(var k=2;k<m.length;k++)b=mr(m[k]),"$type"===Te(m[1])?S=S.concat(Gc({key:y+"["+k+"]",value:m[k],valueSpec:E.geometry_type,style:u.style,styleSpec:u.styleSpec})):"string"!==b&&"number"!==b&&"boolean"!==b&&S.push(new se(y+"["+k+"]",m[k],"string, number, or boolean expected, "+b+" found"));break;case"any":case"all":case"none":for(var M=1;M<m.length;M++)S=S.concat(l({key:y+"["+M+"]",value:m[M],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":b=mr(m[1]),2!==m.length?S.push(new se(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"string"!==b&&S.push(new se(y+"[1]",m[1],"string expected, "+b+" found"));break;case"within":b=mr(m[1]),2!==m.length?S.push(new se(y,m,'filter array for "'+m[0]+'" operator must have 2 elements')):"object"!==b&&S.push(new se(y+"[1]",m[1],"object expected, "+b+" found"))}return S}(s)}function wf(s,l){var u=s.key,m=s.style,y=s.styleSpec,b=s.value,E=s.objectKey,S=y[l+"_"+s.layerType];if(!S)return[];var k=E.match(/^(.*)-transition$/);if("paint"===l&&k&&S[k[1]]&&S[k[1]].transition)return Sn({key:u,value:b,valueSpec:y.transition,style:m,styleSpec:y});var M,P=s.valueSpec||S[E];if(!P)return[new se(u,b,'unknown property "'+E+'"')];if("string"===mr(b)&&Ud(P)&&!P.tokens&&(M=/^{([^}]+)}$/.exec(b)))return[new se(u,b,'"'+E+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(M[1])+" }`.")];var O=[];return"symbol"===s.layerType&&("text-field"===E&&m&&!m.glyphs&&O.push(new se(u,b,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&pf($e(b))&&"identity"===Te(b.type)&&O.push(new se(u,b,'"text-font" does not support identity functions'))),O.concat(Sn({key:s.key,value:b,valueSpec:P,style:m,styleSpec:y,expressionContext:"property",propertyType:l,propertyKey:E}))}function Wc(s){return wf(s,"paint")}function $p(s){return wf(s,"layout")}function ju(s){var l=[],u=s.value,m=s.key,y=s.style,b=s.styleSpec;u.type||u.ref||l.push(new se(m,u,'either "type" or "ref" is required'));var E,S=Te(u.type),k=Te(u.ref);if(u.id)for(var M=Te(u.id),P=0;P<s.arrayIndex;P++){var O=y.layers[P];Te(O.id)===M&&l.push(new se(m,u.id,'duplicate layer id "'+u.id+'", previously used at line '+O.id.__line__))}if("ref"in u)["type","source","source-layer","filter","layout"].forEach(function(ee){ee in u&&l.push(new se(m,u[ee],'"'+ee+'" is prohibited for ref layers'))}),y.layers.forEach(function(ee){Te(ee.id)===k&&(E=ee)}),E?E.ref?l.push(new se(m,u.ref,"ref cannot reference another ref layer")):S=Te(E.type):l.push(new se(m,u.ref,'ref layer "'+k+'" not found'));else if("background"!==S)if(u.source){var V=y.sources&&y.sources[u.source],$=V&&Te(V.type);V?"vector"===$&&"raster"===S?l.push(new se(m,u.source,'layer "'+u.id+'" requires a raster source')):"raster"===$&&"raster"!==S?l.push(new se(m,u.source,'layer "'+u.id+'" requires a vector source')):"vector"!==$||u["source-layer"]?"raster-dem"===$&&"hillshade"!==S?l.push(new se(m,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==S||!u.paint||!u.paint["line-gradient"]||"geojson"===$&&V.lineMetrics||l.push(new se(m,u,'layer "'+u.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):l.push(new se(m,u,'layer "'+u.id+'" must specify a "source-layer"')):l.push(new se(m,u.source,'source "'+u.source+'" not found'))}else l.push(new se(m,u,'missing required property "source"'));return l=l.concat(as({key:m,value:u,valueSpec:b.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Sn({key:m+".type",value:u.type,valueSpec:b.layer.type,style:s.style,styleSpec:s.styleSpec,object:u,objectKey:"type"})},filter:bf,layout:function(ee){return as({layer:u,key:ee.key,value:ee.value,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{"*":function(Q){return $p(Je({layerType:S},Q))}}})},paint:function(ee){return as({layer:u,key:ee.key,value:ee.value,style:ee.style,styleSpec:ee.styleSpec,objectElementValidators:{"*":function(Q){return Wc(Je({layerType:S},Q))}}})}}}))}function dr(s){var l=s.value,u=s.key,m=mr(l);return"string"!==m?[new se(u,l,"string expected, "+m+" found")]:[]}var Hu={promoteId:function(s){var l=s.key,u=s.value;if("string"===mr(u))return dr({key:l,value:u});var m=[];for(var y in u)m.push.apply(m,dr({key:l+"."+y,value:u[y]}));return m}};function Kc(s){var l=s.value,u=s.key,m=s.styleSpec,y=s.style;if(!l.type)return[new se(u,l,'"type" is required')];var b,E=Te(l.type);switch(E){case"vector":case"raster":case"raster-dem":return as({key:u,value:l,valueSpec:m["source_"+E.replace("-","_")],style:s.style,styleSpec:m,objectElementValidators:Hu});case"geojson":if(b=as({key:u,value:l,valueSpec:m.source_geojson,style:y,styleSpec:m,objectElementValidators:Hu}),l.cluster)for(var S in l.clusterProperties){var k=l.clusterProperties[S],M=k[0],P="string"==typeof M?[M,["accumulated"],["get",S]]:M;b.push.apply(b,Va({key:u+"."+S+".map",value:k[1],expressionContext:"cluster-map"})),b.push.apply(b,Va({key:u+"."+S+".reduce",value:P,expressionContext:"cluster-reduce"}))}return b;case"video":return as({key:u,value:l,valueSpec:m.source_video,style:y,styleSpec:m});case"image":return as({key:u,value:l,valueSpec:m.source_image,style:y,styleSpec:m});case"canvas":return[new se(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gc({key:u+".type",value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:y,styleSpec:m})}}function Ua(s){var l=s.value,u=s.styleSpec,m=u.light,y=s.style,b=[],E=mr(l);if(void 0===l)return b;if("object"!==E)return b.concat([new se("light",l,"object expected, "+E+" found")]);for(var S in l){var k=S.match(/^(.*)-transition$/);b=b.concat(k&&m[k[1]]&&m[k[1]].transition?Sn({key:S,value:l[S],valueSpec:u.transition,style:y,styleSpec:u}):m[S]?Sn({key:S,value:l[S],valueSpec:m[S],style:y,styleSpec:u}):[new se(S,l[S],'unknown property "'+S+'"')])}return b}var Zn={"*":function(){return[]},array:Gd,boolean:function(s){var l=s.value,u=s.key,m=mr(l);return"boolean"!==m?[new se(u,l,"boolean expected, "+m+" found")]:[]},number:Hp,color:function(s){var l=s.key,u=s.value,m=mr(u);return"string"!==m?[new se(l,u,"color expected, "+m+" found")]:null===Bd(u)?[new se(l,u,'color expected, "'+u+'" found')]:[]},constants:Ue,enum:Gc,filter:bf,function:_f,layer:ju,object:as,source:Kc,light:Ua,string:dr,formatted:function(s){return 0===dr(s).length?[]:Va(s)},resolvedImage:function(s){return 0===dr(s).length?[]:Va(s)}};function Sn(s){var l=s.value,u=s.valueSpec,m=s.styleSpec;return u.expression&&pf(Te(l))?_f(s):u.expression&&gf($e(l))?Va(s):u.type&&Zn[u.type]?Zn[u.type](s):as(Je({},s,{valueSpec:u.type?m[u.type]:u}))}function Yo(s){var l=s.value,u=s.key,m=dr(s);return m.length||(-1===l.indexOf("{fontstack}")&&m.push(new se(u,l,'"glyphs" url must include a "{fontstack}" token')),-1===l.indexOf("{range}")&&m.push(new se(u,l,'"glyphs" url must include a "{range}" token'))),m}function ia(s,l){void 0===l&&(l=Z);var u=[];return u=u.concat(Sn({key:"",value:s,valueSpec:l.$root,styleSpec:l,style:s,objectElementValidators:{glyphs:Yo,"*":function(){return[]}}})),s.constants&&(u=u.concat(Ue({key:"constants",value:s.constants,style:s,styleSpec:l}))),xf(u)}function xf(s){return[].concat(s).sort(function(l,u){return l.line-u.line})}function vl(s){return function(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];return xf(s.apply(this,l))}}ia.source=vl(Kc),ia.light=vl(Ua),ia.layer=vl(ju),ia.filter=vl(bf),ia.paintProperty=vl(Wc),ia.layoutProperty=vl($p);var $u=ia,qp=$u.light,rc=$u.paintProperty,Hr=$u.layoutProperty;function oa(s,l){var u=!1;if(l&&l.length)for(var m=0,y=l;m<y.length;m+=1)s.fire(new _e(new Error(y[m].message))),u=!0;return u}var Ui=Ms;function Ms(s,l,u){var m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var y=new Int32Array(this.arrayBuffer);s=y[0],this.d=(l=y[1])+2*(u=y[2]);for(var b=0;b<this.d*this.d;b++){var E=y[3+b],S=y[3+b+1];m.push(E===S?null:y.subarray(E,S))}var k=y[3+m.length+1];this.keys=y.subarray(y[3+m.length],k),this.bboxes=y.subarray(k),this.insert=this._insertReadonly}else{this.d=l+2*u;for(var M=0;M<this.d*this.d;M++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=u,this.scale=l/s,this.uid=0;var P=u/l*s;this.min=-P,this.max=s+P}Ms.prototype.insert=function(s,l,u,m,y){this._forEachCell(l,u,m,y,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(y)},Ms.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ms.prototype._insertCell=function(s,l,u,m,y,b){this.cells[y].push(b)},Ms.prototype.query=function(s,l,u,m,y){var b=this.min,E=this.max;if(s<=b&&l<=b&&E<=u&&E<=m&&!y)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(s,l,u,m,this._queryCell,S,{},y),S},Ms.prototype._queryCell=function(s,l,u,m,y,b,E,S){var k=this.cells[y];if(null!==k)for(var M=this.keys,P=this.bboxes,O=0;O<k.length;O++){var V=k[O];if(void 0===E[V]){var $=4*V;(S?S(P[$+0],P[$+1],P[$+2],P[$+3]):s<=P[$+2]&&l<=P[$+3]&&u>=P[$+0]&&m>=P[$+1])?(E[V]=!0,b.push(M[V])):E[V]=!1}}},Ms.prototype._forEachCell=function(s,l,u,m,y,b,E,S){for(var k=this._convertToCellCoord(s),M=this._convertToCellCoord(l),P=this._convertToCellCoord(u),O=this._convertToCellCoord(m),V=k;V<=P;V++)for(var $=M;$<=O;$++){var ee=this.d*$+V;if((!S||S(this._convertFromCellCoord(V),this._convertFromCellCoord($),this._convertFromCellCoord(V+1),this._convertFromCellCoord($+1)))&&y.call(this,s,l,u,m,ee,b,E,S))return}},Ms.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},Ms.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},Ms.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,l=3+this.cells.length+1+1,u=0,m=0;m<this.cells.length;m++)u+=this.cells[m].length;var y=new Int32Array(l+u+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=l,E=0;E<s.length;E++){var S=s[E];y[3+E]=b,y.set(S,b),b+=S.length}return y[3+s.length]=b,y.set(this.keys,b),y[3+s.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer};var Bg=_t.ImageData,Ii=_t.ImageBitmap,so={};function st(s,l,u){void 0===u&&(u={}),Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),so[s]={klass:l,omit:u.omit||[],shallow:u.shallow||[]}}for(var Kd in st("Object",Object),Ui.serialize=function(s,l){var u=s.toArrayBuffer();return l&&l.push(u),{buffer:u}},Ui.deserialize=function(s){return new Ui(s.buffer)},st("Grid",Ui),st("Color",wn),st("Error",Error),st("ResolvedImage",Dr),st("StylePropertyFunction",Uu),st("StyleExpression",Fa,{omit:["_evaluator"]}),st("ZoomDependentExpression",mo),st("ZoomConstantExpression",qd),st("CompoundExpression",ro,{omit:["_evaluate"]}),Vu)Vu[Kd]._classRegistryKey||st("Expression_"+Kd,Vu[Kd]);function qu(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function ic(s){return Ii&&s instanceof Ii}function Lo(s,l){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(qu(s)||ic(s))return l&&l.push(s),s;if(ArrayBuffer.isView(s)){var u=s;return l&&l.push(u.buffer),u}if(s instanceof Bg)return l&&l.push(s.data.buffer),s;if(Array.isArray(s)){for(var m=[],y=0,b=s;y<b.length;y+=1)m.push(Lo(b[y],l));return m}if("object"==typeof s){var E=s.constructor,S=E._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var k=E.serialize?E.serialize(s,l):{};if(!E.serialize){for(var M in s)if(s.hasOwnProperty(M)&&!(so[S].omit.indexOf(M)>=0)){var P=s[M];k[M]=so[S].shallow.indexOf(M)>=0?P:Lo(P,l)}s instanceof Error&&(k.message=s.message)}if(k.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==S&&(k.$name=S),k}throw new Error("can't serialize object of type "+typeof s)}function ji(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||qu(s)||ic(s)||ArrayBuffer.isView(s)||s instanceof Bg)return s;if(Array.isArray(s))return s.map(ji);if("object"==typeof s){var l=s.$name||"Object",u=so[l].klass;if(!u)throw new Error("can't deserialize unregistered class "+l);if(u.deserialize)return u.deserialize(s);for(var m=Object.create(u.prototype),y=0,b=Object.keys(s);y<b.length;y+=1){var E=b[y];if("$name"!==E){var S=s[E];m[E]=so[l].shallow.indexOf(E)>=0?S:ji(S)}}return m}throw new Error("can't deserialize object of type "+typeof s)}var go=function(){this.first=!0};go.prototype.update=function(s,l){var u=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=u,!0))};var ht={"Latin-1 Supplement":function(s){return s>=128&&s<=255},Arabic:function(s){return s>=1536&&s<=1791},"Arabic Supplement":function(s){return s>=1872&&s<=1919},"Arabic Extended-A":function(s){return s>=2208&&s<=2303},"Hangul Jamo":function(s){return s>=4352&&s<=4607},"Unified Canadian Aboriginal Syllabics":function(s){return s>=5120&&s<=5759},Khmer:function(s){return s>=6016&&s<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(s){return s>=6320&&s<=6399},"General Punctuation":function(s){return s>=8192&&s<=8303},"Letterlike Symbols":function(s){return s>=8448&&s<=8527},"Number Forms":function(s){return s>=8528&&s<=8591},"Miscellaneous Technical":function(s){return s>=8960&&s<=9215},"Control Pictures":function(s){return s>=9216&&s<=9279},"Optical Character Recognition":function(s){return s>=9280&&s<=9311},"Enclosed Alphanumerics":function(s){return s>=9312&&s<=9471},"Geometric Shapes":function(s){return s>=9632&&s<=9727},"Miscellaneous Symbols":function(s){return s>=9728&&s<=9983},"Miscellaneous Symbols and Arrows":function(s){return s>=11008&&s<=11263},"CJK Radicals Supplement":function(s){return s>=11904&&s<=12031},"Kangxi Radicals":function(s){return s>=12032&&s<=12255},"Ideographic Description Characters":function(s){return s>=12272&&s<=12287},"CJK Symbols and Punctuation":function(s){return s>=12288&&s<=12351},Hiragana:function(s){return s>=12352&&s<=12447},Katakana:function(s){return s>=12448&&s<=12543},Bopomofo:function(s){return s>=12544&&s<=12591},"Hangul Compatibility Jamo":function(s){return s>=12592&&s<=12687},Kanbun:function(s){return s>=12688&&s<=12703},"Bopomofo Extended":function(s){return s>=12704&&s<=12735},"CJK Strokes":function(s){return s>=12736&&s<=12783},"Katakana Phonetic Extensions":function(s){return s>=12784&&s<=12799},"Enclosed CJK Letters and Months":function(s){return s>=12800&&s<=13055},"CJK Compatibility":function(s){return s>=13056&&s<=13311},"CJK Unified Ideographs Extension A":function(s){return s>=13312&&s<=19903},"Yijing Hexagram Symbols":function(s){return s>=19904&&s<=19967},"CJK Unified Ideographs":function(s){return s>=19968&&s<=40959},"Yi Syllables":function(s){return s>=40960&&s<=42127},"Yi Radicals":function(s){return s>=42128&&s<=42191},"Hangul Jamo Extended-A":function(s){return s>=43360&&s<=43391},"Hangul Syllables":function(s){return s>=44032&&s<=55215},"Hangul Jamo Extended-B":function(s){return s>=55216&&s<=55295},"Private Use Area":function(s){return s>=57344&&s<=63743},"CJK Compatibility Ideographs":function(s){return s>=63744&&s<=64255},"Arabic Presentation Forms-A":function(s){return s>=64336&&s<=65023},"Vertical Forms":function(s){return s>=65040&&s<=65055},"CJK Compatibility Forms":function(s){return s>=65072&&s<=65103},"Small Form Variants":function(s){return s>=65104&&s<=65135},"Arabic Presentation Forms-B":function(s){return s>=65136&&s<=65279},"Halfwidth and Fullwidth Forms":function(s){return s>=65280&&s<=65519}};function Qr(s){for(var l=0,u=s;l<u.length;l+=1)if(Ke(u[l].charCodeAt(0)))return!0;return!1}function Ke(s){return!(746!==s&&747!==s&&(s<4352||!(ht["Bopomofo Extended"](s)||ht.Bopomofo(s)||ht["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||ht["CJK Compatibility Ideographs"](s)||ht["CJK Compatibility"](s)||ht["CJK Radicals Supplement"](s)||ht["CJK Strokes"](s)||!(!ht["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||ht["CJK Unified Ideographs Extension A"](s)||ht["CJK Unified Ideographs"](s)||ht["Enclosed CJK Letters and Months"](s)||ht["Hangul Compatibility Jamo"](s)||ht["Hangul Jamo Extended-A"](s)||ht["Hangul Jamo Extended-B"](s)||ht["Hangul Jamo"](s)||ht["Hangul Syllables"](s)||ht.Hiragana(s)||ht["Ideographic Description Characters"](s)||ht.Kanbun(s)||ht["Kangxi Radicals"](s)||ht["Katakana Phonetic Extensions"](s)||ht.Katakana(s)&&12540!==s||!(!ht["Halfwidth and Fullwidth Forms"](s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!ht["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||ht["Unified Canadian Aboriginal Syllabics"](s)||ht["Unified Canadian Aboriginal Syllabics Extended"](s)||ht["Vertical Forms"](s)||ht["Yijing Hexagram Symbols"](s)||ht["Yi Syllables"](s)||ht["Yi Radicals"](s))))}function Bt(s){return!(Ke(s)||(l=s,ht["Latin-1 Supplement"](l)&&(167===l||169===l||174===l||177===l||188===l||189===l||190===l||215===l||247===l)||ht["General Punctuation"](l)&&(8214===l||8224===l||8225===l||8240===l||8241===l||8251===l||8252===l||8258===l||8263===l||8264===l||8265===l||8273===l)||ht["Letterlike Symbols"](l)||ht["Number Forms"](l)||ht["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||9003===l||l>=9085&&l<=9114||l>=9150&&l<=9165||9167===l||l>=9169&&l<=9179||l>=9186&&l<=9215)||ht["Control Pictures"](l)&&9251!==l||ht["Optical Character Recognition"](l)||ht["Enclosed Alphanumerics"](l)||ht["Geometric Shapes"](l)||ht["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||ht["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||ht["CJK Symbols and Punctuation"](l)||ht.Katakana(l)||ht["Private Use Area"](l)||ht["CJK Compatibility Forms"](l)||ht["Small Form Variants"](l)||ht["Halfwidth and Fullwidth Forms"](l)||8734===l||8756===l||8757===l||l>=9984&&l<=10087||l>=10102&&l<=10131||65532===l||65533===l));var l}function Bn(s){return s>=1424&&s<=2303||ht["Arabic Presentation Forms-A"](s)||ht["Arabic Presentation Forms-B"](s)}function Hi(s,l){return!(!l&&Bn(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||ht.Khmer(s))}function $i(s){for(var l=0,u=s;l<u.length;l+=1)if(Bn(u[l].charCodeAt(0)))return!0;return!1}var bl=null,qi="unavailable",Mn=null,Ln=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(qi="error"),bl&&bl(s)};function ls(){nn.fire(new me("pluginStateChange",{pluginStatus:qi,pluginURL:Mn}))}var nn=new J,_o=function(){return qi},Zd=function(){if("deferred"!==qi||!Mn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi="loading",ls(),Mn&&tr({url:Mn},function(s){s?Ln(s):(qi="loaded",ls())})},nr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===qi||null!=nr.applyArabicShaping},isLoading:function(){return"loading"===qi},setState:function(s){qi=s.pluginStatus,Mn=s.pluginURL},isParsed:function(){return null!=nr.applyArabicShaping&&null!=nr.processBidirectionalText&&null!=nr.processStyledBidirectionalText},getPluginURL:function(){return Mn}},Kt=function(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new go,this.transition={})};Kt.prototype.isSupportedScript=function(s){return function(l,u){for(var m=0,y=l;m<y.length;m+=1)if(!Hi(y[m].charCodeAt(0),u))return!1;return!0}(s,nr.isLoaded())},Kt.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Kt.prototype.getCrossfadeParameters=function(){var s=this.zoom,l=s-Math.floor(s),u=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}};var Gi=function(s,l){this.property=s,this.value=l,this.expression=function(u,m){if(pf(u))return new Uu(u,m);if(gf(u)){var y=nc(u,m);if("error"===y.result)throw new Error(y.value.map(function(E){return E.key+": "+E.message}).join(", "));return y.value}var b=u;return"string"==typeof u&&"color"===m.type&&(b=wn.parse(u)),{kind:"constant",evaluate:function(){return b}}}(void 0===l?s.specification.default:l,s.specification)};Gi.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Gi.prototype.possiblyEvaluate=function(s,l,u){return this.property.possiblyEvaluate(this,s,l,u)};var Wi=function(s){this.property=s,this.value=new Gi(s,void 0)};Wi.prototype.transitioned=function(s,l){return new yo(this.property,this.value,l,Fi({},s.transition,this.transition),s.now)},Wi.prototype.untransitioned=function(){return new yo(this.property,this.value,null,{},0)};var mi=function(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)};mi.prototype.getValue=function(s){return zs(this._values[s].value.value)},mi.prototype.setValue=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Wi(this._values[s].property)),this._values[s].value=new Gi(this._values[s].property,null===l?void 0:zs(l))},mi.prototype.getTransition=function(s){return zs(this._values[s].transition)},mi.prototype.setTransition=function(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Wi(this._values[s].property)),this._values[s].transition=zs(l)||void 0},mi.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y);var b=this.getTransition(m);void 0!==b&&(s[m+"-transition"]=b)}return s},mi.prototype.transitioned=function(s,l){for(var u=new sa(this._properties),m=0,y=Object.keys(this._values);m<y.length;m+=1){var b=y[m];u._values[b]=this._values[b].transitioned(s,l._values[b])}return u},mi.prototype.untransitioned=function(){for(var s=new sa(this._properties),l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l];s._values[m]=this._values[m].untransitioned()}return s};var yo=function(s,l,u,m,y){this.property=s,this.value=l,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=u)};yo.prototype.possiblyEvaluate=function(s,l,u){var m=s.now||0,y=this.value.possiblyEvaluate(s,l,u),b=this.prior;if(b){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return b.possiblyEvaluate(s,l,u);var E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(s,l,u),y,function(S){if(S<=0)return 0;if(S>=1)return 1;var k=S*S,M=k*S;return 4*(S<.5?M:3*(S-k)+M-.75)}(E))}return y};var sa=function(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)};sa.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Rs(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m},sa.prototype.hasTransition=function(){for(var s=0,l=Object.keys(this._values);s<l.length;s+=1)if(this._values[l[s]].prior)return!0;return!1};var Xo=function(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)};Xo.prototype.getValue=function(s){return zs(this._values[s].value)},Xo.prototype.setValue=function(s,l){this._values[s]=new Gi(this._values[s].property,null===l?void 0:zs(l))},Xo.prototype.serialize=function(){for(var s={},l=0,u=Object.keys(this._values);l<u.length;l+=1){var m=u[l],y=this.getValue(m);void 0!==y&&(s[m]=y)}return s},Xo.prototype.possiblyEvaluate=function(s,l,u){for(var m=new Rs(this._properties),y=0,b=Object.keys(this._values);y<b.length;y+=1){var E=b[y];m._values[E]=this._values[E].possiblyEvaluate(s,l,u)}return m};var Qo=function(s,l,u){this.property=s,this.value=l,this.parameters=u};Qo.prototype.isConstant=function(){return"constant"===this.value.kind},Qo.prototype.constantOr=function(s){return"constant"===this.value.kind?this.value.value:s},Qo.prototype.evaluate=function(s,l,u,m){return this.property.evaluate(this.value,this.parameters,s,l,u,m)};var Rs=function(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)};Rs.prototype.get=function(s){return this._values[s]};var tt=function(s){this.specification=s};tt.prototype.possiblyEvaluate=function(s,l){return s.expression.evaluate(l)},tt.prototype.interpolate=function(s,l,u){var m=Vp[this.specification.type];return m?m(s,l,u):s};var Nt=function(s,l){this.specification=s,this.overrides=l};Nt.prototype.possiblyEvaluate=function(s,l,u,m){return new Qo(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(l,null,{},u,m)}:s.expression,l)},Nt.prototype.interpolate=function(s,l,u){if("constant"!==s.value.kind||"constant"!==l.value.kind)return s;if(void 0===s.value.value||void 0===l.value.value)return new Qo(this,{kind:"constant",value:void 0},s.parameters);var m=Vp[this.specification.type];return m?new Qo(this,{kind:"constant",value:m(s.value.value,l.value.value,u)},s.parameters):s},Nt.prototype.evaluate=function(s,l,u,m,y,b){return"constant"===s.kind?s.value:s.evaluate(l,u,m,y,b)};var gi=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m,y,b){if(void 0===u.value)return new Qo(this,{kind:"constant",value:void 0},m);if("constant"===u.expression.kind){var E=u.expression.evaluate(m,null,{},y,b),S="resolvedImage"===u.property.specification.type&&"string"!=typeof E?E.name:E,k=this._calculate(S,S,S,m);return new Qo(this,{kind:"constant",value:k},m)}if("camera"===u.expression.kind){var M=this._calculate(u.expression.evaluate({zoom:m.zoom-1}),u.expression.evaluate({zoom:m.zoom}),u.expression.evaluate({zoom:m.zoom+1}),m);return new Qo(this,{kind:"constant",value:M},m)}return new Qo(this,u.expression,m)},l.prototype.evaluate=function(u,m,y,b,E,S){if("source"===u.kind){var k=u.evaluate(m,y,b,E,S);return this._calculate(k,k,k,m)}return"composite"===u.kind?this._calculate(u.evaluate({zoom:Math.floor(m.zoom)-1},y,b),u.evaluate({zoom:Math.floor(m.zoom)},y,b),u.evaluate({zoom:Math.floor(m.zoom)+1},y,b),m):u.value},l.prototype._calculate=function(u,m,y,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:u,to:m}:{from:y,to:m}},l.prototype.interpolate=function(u){return u},l}(Nt),Ot=function(s){this.specification=s};Ot.prototype.possiblyEvaluate=function(s,l,u,m){if(void 0!==s.value){if("constant"===s.expression.kind){var y=s.expression.evaluate(l,null,{},u,m);return this._calculate(y,y,y,l)}return this._calculate(s.expression.evaluate(new Kt(Math.floor(l.zoom-1),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom),l)),s.expression.evaluate(new Kt(Math.floor(l.zoom+1),l)),l)}},Ot.prototype._calculate=function(s,l,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:u,to:l}},Ot.prototype.interpolate=function(s){return s};var aa=function(s){this.specification=s};aa.prototype.possiblyEvaluate=function(s,l,u,m){return!!s.expression.evaluate(l,null,{},u,m)},aa.prototype.interpolate=function(){return!1};var _i=function(s){for(var l in this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],s){var u=s[l];u.specification.overridable&&this.overridableProperties.push(l);var m=this.defaultPropertyValues[l]=new Gi(u,void 0),y=this.defaultTransitionablePropertyValues[l]=new Wi(u);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}};st("DataDrivenProperty",Nt),st("DataConstantProperty",tt),st("CrossFadedDataDrivenProperty",gi),st("CrossFadedProperty",Ot),st("ColorRampProperty",aa);var ki=function(s){function l(u,m){if(s.call(this),this.id=u.id,this.type=u.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==u.type&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,"background"!==u.type&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),m.layout&&(this._unevaluatedLayout=new Xo(m.layout)),m.paint)){for(var y in this._transitionablePaint=new mi(m.paint),u.paint)this.setPaintProperty(y,u.paint[y],{validate:!1});for(var b in u.layout)this.setLayoutProperty(b,u.layout[b],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Rs(m.paint)}}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},l.prototype.getLayoutProperty=function(u){return"visibility"===u?this.visibility:this._unevaluatedLayout.getValue(u)},l.prototype.setLayoutProperty=function(u,m,y){void 0===y&&(y={}),null!=m&&this._validate(Hr,"layers."+this.id+".layout."+u,u,m,y)||("visibility"!==u?this._unevaluatedLayout.setValue(u,m):this.visibility=m)},l.prototype.getPaintProperty=function(u){return Lc(u,"-transition")?this._transitionablePaint.getTransition(u.slice(0,-11)):this._transitionablePaint.getValue(u)},l.prototype.setPaintProperty=function(u,m,y){if(void 0===y&&(y={}),null!=m&&this._validate(rc,"layers."+this.id+".paint."+u,u,m,y))return!1;if(Lc(u,"-transition"))return this._transitionablePaint.setTransition(u.slice(0,-11),m||void 0),!1;var b=this._transitionablePaint._values[u],E="cross-faded-data-driven"===b.property.specification["property-type"],S=b.value.isDataDriven(),k=b.value;this._transitionablePaint.setValue(u,m),this._handleSpecialPaintPropertyUpdate(u);var M=this._transitionablePaint._values[u].value;return M.isDataDriven()||S||E||this._handleOverridablePaintPropertyUpdate(u,k,M)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!1},l.prototype.isHidden=function(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||"none"===this.visibility},l.prototype.updateTransitions=function(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)},l.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},l.prototype.recalculate=function(u,m){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,m)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,m)},l.prototype.serialize=function(){var u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),Es(u,function(m,y){return!(void 0===m||"layout"===y&&!Object.keys(m).length||"paint"===y&&!Object.keys(m).length)})},l.prototype._validate=function(u,m,y,b,E){return void 0===E&&(E={}),(!E||!1!==E.validate)&&oa(this,u.call($u,{key:m,layerType:this.type,objectKey:y,value:b,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))},l.prototype.is3D=function(){return!1},l.prototype.isTileClipped=function(){return!1},l.prototype.hasOffscreenPass=function(){return!1},l.prototype.resize=function(){},l.prototype.isStateDependent=function(){for(var u in this.paint._values){var m=this.paint.get(u);if(m instanceof Qo&&Ud(m.property.specification)&&("source"===m.value.kind||"composite"===m.value.kind)&&m.value.isStateDependent)return!0}return!1},l}(J),Ef={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},cs=function(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wt=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function En(s,l){void 0===l&&(l=1);var u=0,m=0;return{members:s.map(function(y){var b=Ef[y.type].BYTES_PER_ELEMENT,E=u=vo(u,Math.max(l,b)),S=y.components||1;return m=Math.max(m,b),u+=b*S,{name:y.name,type:y.type,components:S,offset:E}}),size:vo(u,Math.max(m,l)),alignment:l}}function vo(s,l){return Math.ceil(s/l)*l}Wt.serialize=function(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}},Wt.deserialize=function(s){var l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l},Wt.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wt.prototype.clear=function(){this.length=0},Wt.prototype.resize=function(s){this.reserve(s),this.length=s},Wt.prototype.reserve=function(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}},Wt.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Gu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.int16[b+0]=m,this.int16[b+1]=y,u},l}(Wt);Gu.prototype.bytesPerElement=4,st("StructArrayLayout2i4",Gu);var ao=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.int16[S+0]=m,this.int16[S+1]=y,this.int16[S+2]=b,this.int16[S+3]=E,u},l}(Wt);ao.prototype.bytesPerElement=8,st("StructArrayLayout4i8",ao);var Ki=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=6*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.int16[M+2]=b,this.int16[M+3]=E,this.int16[M+4]=S,this.int16[M+5]=k,u},l}(Wt);Ki.prototype.bytesPerElement=12,st("StructArrayLayout2i4i12",Ki);var us=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=4*u,P=8*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.uint8[P+4]=b,this.uint8[P+5]=E,this.uint8[P+6]=S,this.uint8[P+7]=k,u},l}(Wt);us.prototype.bytesPerElement=8,st("StructArrayLayout2i4ub8",us);var ds=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.float32[b+0]=m,this.float32[b+1]=y,u},l}(Wt);ds.prototype.bytesPerElement=8,st("StructArrayLayout2f8",ds);var oc=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,O){var V=this.length;return this.resize(V+1),this.emplace(V,u,m,y,b,E,S,k,M,P,O)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,O,V){var $=10*u;return this.uint16[$+0]=m,this.uint16[$+1]=y,this.uint16[$+2]=b,this.uint16[$+3]=E,this.uint16[$+4]=S,this.uint16[$+5]=k,this.uint16[$+6]=M,this.uint16[$+7]=P,this.uint16[$+8]=O,this.uint16[$+9]=V,u},l}(Wt);oc.prototype.bytesPerElement=20,st("StructArrayLayout10ui20",oc);var Yd=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,O,V,$){var ee=this.length;return this.resize(ee+1),this.emplace(ee,u,m,y,b,E,S,k,M,P,O,V,$)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,O,V,$,ee){var Q=12*u;return this.int16[Q+0]=m,this.int16[Q+1]=y,this.int16[Q+2]=b,this.int16[Q+3]=E,this.uint16[Q+4]=S,this.uint16[Q+5]=k,this.uint16[Q+6]=M,this.uint16[Q+7]=P,this.int16[Q+8]=O,this.int16[Q+9]=V,this.int16[Q+10]=$,this.int16[Q+11]=ee,u},l}(Wt);Yd.prototype.bytesPerElement=24,st("StructArrayLayout4i4ui4i24",Yd);var Ps=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.float32[E+0]=m,this.float32[E+1]=y,this.float32[E+2]=b,u},l}(Wt);Ps.prototype.bytesPerElement=12,st("StructArrayLayout3f12",Ps);var Cf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint32[1*u+0]=m,u},l}(Wt);Cf.prototype.bytesPerElement=4,st("StructArrayLayout1ul4",Cf);var Df=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P){var O=this.length;return this.resize(O+1),this.emplace(O,u,m,y,b,E,S,k,M,P)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,O){var V=10*u,$=5*u;return this.int16[V+0]=m,this.int16[V+1]=y,this.int16[V+2]=b,this.int16[V+3]=E,this.int16[V+4]=S,this.int16[V+5]=k,this.uint32[$+3]=M,this.uint16[V+8]=P,this.uint16[V+9]=O,u},l}(Wt);Df.prototype.bytesPerElement=20,st("StructArrayLayout6i1ul2ui20",Df);var sc=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S){var k=this.length;return this.resize(k+1),this.emplace(k,u,m,y,b,E,S)},l.prototype.emplace=function(u,m,y,b,E,S,k){var M=6*u;return this.int16[M+0]=m,this.int16[M+1]=y,this.int16[M+2]=b,this.int16[M+3]=E,this.int16[M+4]=S,this.int16[M+5]=k,u},l}(Wt);sc.prototype.bytesPerElement=12,st("StructArrayLayout2i2i2i12",sc);var Wu=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E){var S=this.length;return this.resize(S+1),this.emplace(S,u,m,y,b,E)},l.prototype.emplace=function(u,m,y,b,E,S){var k=4*u,M=8*u;return this.float32[k+0]=m,this.float32[k+1]=y,this.float32[k+2]=b,this.int16[M+6]=E,this.int16[M+7]=S,u},l}(Wt);Wu.prototype.bytesPerElement=16,st("StructArrayLayout2f1f2i16",Wu);var Vg=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=12*u,k=3*u;return this.uint8[S+0]=m,this.uint8[S+1]=y,this.float32[k+1]=b,this.float32[k+2]=E,u},l}(Wt);Vg.prototype.bytesPerElement=12,st("StructArrayLayout2ub2f12",Vg);var Gs=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.uint16[E+0]=m,this.uint16[E+1]=y,this.uint16[E+2]=b,u},l}(Wt);Gs.prototype.bytesPerElement=6,st("StructArrayLayout3ui6",Gs);var Gp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve){var ye=this.length;return this.resize(ye+1),this.emplace(ye,u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve,ye){var Ie=24*u,ke=12*u,Oe=48*u;return this.int16[Ie+0]=m,this.int16[Ie+1]=y,this.uint16[Ie+2]=b,this.uint16[Ie+3]=E,this.uint32[ke+2]=S,this.uint32[ke+3]=k,this.uint32[ke+4]=M,this.uint16[Ie+10]=P,this.uint16[Ie+11]=O,this.uint16[Ie+12]=V,this.float32[ke+7]=$,this.float32[ke+8]=ee,this.uint8[Oe+36]=Q,this.uint8[Oe+37]=pe,this.uint8[Oe+38]=he,this.uint32[ke+10]=ve,this.int16[Ie+22]=ye,u},l}(Wt);Gp.prototype.bytesPerElement=48,st("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Gp);var Ku=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve,ye,Ie,ke,Oe,Ye,nt,yt,it,kt,ot,hn){var Vt=this.length;return this.resize(Vt+1),this.emplace(Vt,u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve,ye,Ie,ke,Oe,Ye,nt,yt,it,kt,ot,hn)},l.prototype.emplace=function(u,m,y,b,E,S,k,M,P,O,V,$,ee,Q,pe,he,ve,ye,Ie,ke,Oe,Ye,nt,yt,it,kt,ot,hn,Vt){var gt=34*u,_n=17*u;return this.int16[gt+0]=m,this.int16[gt+1]=y,this.int16[gt+2]=b,this.int16[gt+3]=E,this.int16[gt+4]=S,this.int16[gt+5]=k,this.int16[gt+6]=M,this.int16[gt+7]=P,this.uint16[gt+8]=O,this.uint16[gt+9]=V,this.uint16[gt+10]=$,this.uint16[gt+11]=ee,this.uint16[gt+12]=Q,this.uint16[gt+13]=pe,this.uint16[gt+14]=he,this.uint16[gt+15]=ve,this.uint16[gt+16]=ye,this.uint16[gt+17]=Ie,this.uint16[gt+18]=ke,this.uint16[gt+19]=Oe,this.uint16[gt+20]=Ye,this.uint16[gt+21]=nt,this.uint16[gt+22]=yt,this.uint32[_n+12]=it,this.float32[_n+13]=kt,this.float32[_n+14]=ot,this.float32[_n+15]=hn,this.float32[_n+16]=Vt,u},l}(Wt);Ku.prototype.bytesPerElement=68,st("StructArrayLayout8i15ui1ul4f68",Ku);var Ws=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.float32[1*u+0]=m,u},l}(Wt);Ws.prototype.bytesPerElement=4,st("StructArrayLayout1f4",Ws);var zg=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=3*u;return this.int16[E+0]=m,this.int16[E+1]=y,this.int16[E+2]=b,u},l}(Wt);zg.prototype.bytesPerElement=6,st("StructArrayLayout3i6",zg);var Wp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y){var b=this.length;return this.resize(b+1),this.emplace(b,u,m,y)},l.prototype.emplace=function(u,m,y,b){var E=4*u;return this.uint32[2*u+0]=m,this.uint16[E+2]=y,this.uint16[E+3]=b,u},l}(Wt);Wp.prototype.bytesPerElement=8,st("StructArrayLayout1ul2ui8",Wp);var Tf=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m){var y=this.length;return this.resize(y+1),this.emplace(y,u,m)},l.prototype.emplace=function(u,m,y){var b=2*u;return this.uint16[b+0]=m,this.uint16[b+1]=y,u},l}(Wt);Tf.prototype.bytesPerElement=4,st("StructArrayLayout2ui4",Tf);var Kp=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u){var m=this.length;return this.resize(m+1),this.emplace(m,u)},l.prototype.emplace=function(u,m){return this.uint16[1*u+0]=m,u},l}(Wt);Kp.prototype.bytesPerElement=2,st("StructArrayLayout1ui2",Kp);var d=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},l.prototype.emplaceBack=function(u,m,y,b){var E=this.length;return this.resize(E+1),this.emplace(E,u,m,y,b)},l.prototype.emplace=function(u,m,y,b,E){var S=4*u;return this.float32[S+0]=m,this.float32[S+1]=y,this.float32[S+2]=b,this.float32[S+3]=E,u},l}(Wt);d.prototype.bytesPerElement=16,st("StructArrayLayout4f16",d);var p=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return u.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},u.x1.get=function(){return this._structArray.int16[this._pos2+2]},u.y1.get=function(){return this._structArray.int16[this._pos2+3]},u.x2.get=function(){return this._structArray.int16[this._pos2+4]},u.y2.get=function(){return this._structArray.int16[this._pos2+5]},u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.anchorPoint.get=function(){return new Gt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(l.prototype,u),l}(cs);p.prototype.size=20;var h=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new p(this,u)},l}(Df);st("CollisionBoxArray",h);var g=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},u.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},u.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},u.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},u.segment.get=function(){return this._structArray.uint16[this._pos2+10]},u.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},u.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},u.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},u.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},u.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},u.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},u.placedOrientation.set=function(m){this._structArray.uint8[this._pos1+37]=m},u.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},u.hidden.set=function(m){this._structArray.uint8[this._pos1+38]=m},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+10]=m},u.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(l.prototype,u),l}(cs);g.prototype.size=48;var w=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new g(this,u)},l}(Gp);st("PlacedSymbolArray",w);var C=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return u.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},u.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},u.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},u.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},u.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},u.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},u.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},u.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},u.key.get=function(){return this._structArray.uint16[this._pos2+8]},u.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},u.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},u.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},u.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},u.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},u.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},u.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},u.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},u.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},u.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},u.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},u.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},u.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},u.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},u.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},u.crossTileID.set=function(m){this._structArray.uint32[this._pos4+12]=m},u.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},u.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},u.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},u.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(l.prototype,u),l}(cs);C.prototype.size=68;var T=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new C(this,u)},l}(Ku);st("SymbolInstanceArray",T);var I=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getoffsetX=function(u){return this.float32[1*u+0]},l}(Ws);st("GlyphOffsetArray",I);var R=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.getx=function(u){return this.int16[3*u+0]},l.prototype.gety=function(u){return this.int16[3*u+1]},l.prototype.gettileUnitDistanceFromAnchor=function(u){return this.int16[3*u+2]},l}(zg);st("SymbolLineVertexArray",R);var L=function(s){function l(){s.apply(this,arguments)}s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l;var u={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return u.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},u.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},u.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(l.prototype,u),l}(cs);L.prototype.size=8;var q=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.get=function(u){return new L(this,u)},l}(Wp);st("FeatureIndexArray",q);var W=En([{name:"a_pos",components:2,type:"Int16"}],4).members,H=function(s){void 0===s&&(s=[]),this.segments=s};function oe(s,l){return 256*(s=to(Math.floor(s),0,255))+to(Math.floor(l),0,255)}H.prototype.prepareSegment=function(s,l,u,m){var y=this.segments[this.segments.length-1];return s>H.MAX_VERTEX_ARRAY_LENGTH&&fr("Max vertices per segment is "+H.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+s),(!y||y.vertexLength+s>H.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==m&&(y.sortKey=m),this.segments.push(y)),y},H.prototype.get=function(){return this.segments},H.prototype.destroy=function(){for(var s=0,l=this.segments;s<l.length;s+=1){var u=l[s];for(var m in u.vaos)u.vaos[m].destroy()}},H.simpleSegment=function(s,l,u,m){return new H([{vertexOffset:s,primitiveOffset:l,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])},H.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,st("SegmentVector",H);var ne=En([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),de=Zo(function(s){s.exports=function(l,u){var m,y,b,E,S,k,M,P;for(y=l.length-(m=3&l.length),b=u,S=3432918353,k=461845907,P=0;P<y;)M=255&l.charCodeAt(P)|(255&l.charCodeAt(++P))<<8|(255&l.charCodeAt(++P))<<16|(255&l.charCodeAt(++P))<<24,++P,b=27492+(65535&(E=5*(65535&(b=(b^=M=(65535&(M=(M=(65535&M)*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(M=0,m){case 3:M^=(255&l.charCodeAt(P+2))<<16;case 2:M^=(255&l.charCodeAt(P+1))<<8;case 1:b^=M=(65535&(M=(M=(65535&(M^=255&l.charCodeAt(P)))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*k+(((M>>>16)*k&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}}),re=Zo(function(s){s.exports=function(l,u){for(var m,y=l.length,b=u^y,E=0;y>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(E)|(255&l.charCodeAt(++E))<<8|(255&l.charCodeAt(++E))<<16|(255&l.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),y-=4,++E;switch(y){case 3:b^=(255&l.charCodeAt(E+2))<<16;case 2:b^=(255&l.charCodeAt(E+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(E)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}}),ae=de,ge=re;ae.murmur3=de,ae.murmur2=ge;var be=function(){this.ids=[],this.positions=[],this.indexed=!1};be.prototype.add=function(s,l,u,m){this.ids.push(De(s)),this.positions.push(l,u,m)},be.prototype.getPositions=function(s){for(var l=De(s),u=0,m=this.ids.length-1;u<m;){var y=u+m>>1;this.ids[y]>=l?m=y:u=y+1}for(var b=[];this.ids[u]===l;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b},be.serialize=function(s,l){var u=new Float64Array(s.ids),m=new Uint32Array(s.positions);return function y(b,E,S,k){for(;S<k;){for(var M=b[S+k>>1],P=S-1,O=k+1;;){do{P++}while(b[P]<M);do{O--}while(b[O]>M);if(P>=O)break;Me(b,P,O),Me(E,3*P,3*O),Me(E,3*P+1,3*O+1),Me(E,3*P+2,3*O+2)}O-S<k-O?(y(b,E,S,O),S=O+1):(y(b,E,O+1,k),k=O)}}(u,m,0,u.length-1),l&&l.push(u.buffer,m.buffer),{ids:u,positions:m}},be.deserialize=function(s){var l=new be;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l};var Ae=Math.pow(2,53)-1;function De(s){var l=+s;return!isNaN(l)&&l<=Ae?l:ae(String(s))}function Me(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}st("FeaturePositionMap",be);var Le=function(s,l){this.gl=s.gl,this.location=l},Qe=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))},l}(Le),qe=function(s){function l(u,m){s.call(this,u,m),this.current=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))},l}(Le),at=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))},l}(Le),Et=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))},l}(Le),It=function(s){function l(u,m){s.call(this,u,m),this.current=[0,0,0,0]}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))},l}(Le),St=function(s){function l(u,m){s.call(this,u,m),this.current=wn.transparent}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))},l}(Le),pn=new Float32Array(16),ut=function(s){function l(u,m){s.call(this,u,m),this.current=pn}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.set=function(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(var m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}},l}(Le);function Yt(s){return[oe(255*s.r,255*s.g),oe(255*s.b,255*s.a)]}var dn=function(s,l,u){this.value=s,this.uniformNames=l.map(function(m){return"u_"+m}),this.type=u};dn.prototype.setUniform=function(s,l,u){s.set(u.constantOr(this.value))},dn.prototype.getBinding=function(s,l,u){return"color"===this.type?new St(s,l):new qe(s,l)};var et=function(s,l){this.uniformNames=l.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};et.prototype.setConstantPatternPositions=function(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr},et.prototype.setUniform=function(s,l,u,m){var y="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;y&&s.set(y)},et.prototype.getBinding=function(s,l,u){return"u_pattern"===u.substr(0,9)?new It(s,l):new qe(s,l)};var zt=function(s,l,u,m){this.expression=s,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(function(y){return{name:"a_"+y,type:"Float32",components:"color"===u?2:1,offset:0}}),this.paintVertexArray=new m};zt.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.paintVertexArray.length,E=this.expression.evaluate(new Kt(0),l,{},m,[],y);this.paintVertexArray.resize(s),this._setPaintValue(b,s,E)},zt.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(s,l,y)},zt.prototype._setPaintValue=function(s,l,u){if("color"===this.type)for(var m=Yt(u),y=s;y<l;y++)this.paintVertexArray.emplace(y,m[0],m[1]);else{for(var b=s;b<l;b++)this.paintVertexArray.emplace(b,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}},zt.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var $t=function(s,l,u,m,y,b){this.expression=s,this.uniformNames=l.map(function(E){return"u_"+E+"_t"}),this.type=u,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(function(E){return{name:"a_"+E,type:"Float32",components:"color"===u?4:2,offset:0}}),this.paintVertexArray=new b};$t.prototype.populatePaintArray=function(s,l,u,m,y){var b=this.expression.evaluate(new Kt(this.zoom),l,{},m,[],y),E=this.expression.evaluate(new Kt(this.zoom+1),l,{},m,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(S,s,b,E)},$t.prototype.updatePaintArray=function(s,l,u,m){var y=this.expression.evaluate({zoom:this.zoom},u,m),b=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(s,l,y,b)},$t.prototype._setPaintValue=function(s,l,u,m){if("color"===this.type)for(var y=Yt(u),b=Yt(m),E=s;E<l;E++)this.paintVertexArray.emplace(E,y[0],y[1],b[0],b[1]);else{for(var S=s;S<l;S++)this.paintVertexArray.emplace(S,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}},$t.prototype.upload=function(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},$t.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},$t.prototype.setUniform=function(s,l){var u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=to(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);s.set(m)},$t.prototype.getBinding=function(s,l,u){return new qe(s,l)};var Ut=function(s,l,u,m,y,b){this.expression=s,this.type=l,this.useIntegerZoom=u,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y};Ut.prototype.populatePaintArray=function(s,l,u){var m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,l.patterns&&l.patterns[this.layerId],u)},Ut.prototype.updatePaintArray=function(s,l,u,m,y){this._setPaintValues(s,l,u.patterns&&u.patterns[this.layerId],y)},Ut.prototype._setPaintValues=function(s,l,u,m){if(m&&u){var y=m[u.min],b=m[u.mid],E=m[u.max];if(y&&b&&E)for(var S=s;S<l;S++)this.zoomInPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],b.pixelRatio,y.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,b.tl[0],b.tl[1],b.br[0],b.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],b.pixelRatio,E.pixelRatio)}},Ut.prototype.upload=function(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,ne.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,ne.members,this.expression.isStateDependent))},Ut.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Rt=function(s,l,u){this.binders={},this._buffers=[];var m=[];for(var y in s.paint._values)if(u(y)){var b=s.paint.get(y);if(b instanceof Qo&&Ud(b.property.specification)){var E=$r(y,s.type),S=b.value,k=b.property.specification.type,M=b.property.useIntegerZoom,P=b.property.specification["property-type"],O="cross-faded"===P||"cross-faded-data-driven"===P;if("constant"===S.kind)this.binders[y]=O?new et(S.value,E):new dn(S.value,E,k),m.push("/u_"+y);else if("source"===S.kind||O){var V=lo(y,k,"source");this.binders[y]=O?new Ut(S,k,M,l,V,s.id):new zt(S,E,k,V),m.push("/a_"+y)}else{var $=lo(y,k,"composite");this.binders[y]=new $t(S,E,k,M,l,$),m.push("/z_"+y)}}}this.cacheKey=m.sort().join("")};Rt.prototype.getMaxValue=function(s){var l=this.binders[s];return l instanceof zt||l instanceof $t?l.maxValue:0},Rt.prototype.populatePaintArrays=function(s,l,u,m,y){for(var b in this.binders){var E=this.binders[b];(E instanceof zt||E instanceof $t||E instanceof Ut)&&E.populatePaintArray(s,l,u,m,y)}},Rt.prototype.setConstantPatternPositions=function(s,l){for(var u in this.binders){var m=this.binders[u];m instanceof et&&m.setConstantPatternPositions(s,l)}},Rt.prototype.updatePaintArrays=function(s,l,u,m,y){var b=!1;for(var E in s)for(var S=0,k=l.getPositions(E);S<k.length;S+=1){var M=k[S],P=u.feature(M.index);for(var O in this.binders){var V=this.binders[O];if((V instanceof zt||V instanceof $t||V instanceof Ut)&&!0===V.expression.isStateDependent){var $=m.paint.get(O);V.expression=$.value,V.updatePaintArray(M.start,M.end,P,s[E],y),b=!0}}}return b},Rt.prototype.defines=function(){var s=[];for(var l in this.binders){var u=this.binders[l];(u instanceof dn||u instanceof et)&&s.push.apply(s,u.uniformNames.map(function(m){return"#define HAS_UNIFORM_"+m}))}return s},Rt.prototype.getBinderAttributes=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof zt||u instanceof $t)for(var m=0;m<u.paintVertexAttributes.length;m++)s.push(u.paintVertexAttributes[m].name);else if(u instanceof Ut)for(var y=0;y<ne.members.length;y++)s.push(ne.members[y].name)}return s},Rt.prototype.getBinderUniforms=function(){var s=[];for(var l in this.binders){var u=this.binders[l];if(u instanceof dn||u instanceof et||u instanceof $t)for(var m=0,y=u.uniformNames;m<y.length;m+=1)s.push(y[m])}return s},Rt.prototype.getPaintVertexBuffers=function(){return this._buffers},Rt.prototype.getUniforms=function(s,l){var u=[];for(var m in this.binders){var y=this.binders[m];if(y instanceof dn||y instanceof et||y instanceof $t)for(var b=0,E=y.uniformNames;b<E.length;b+=1){var S=E[b];if(l[S]){var k=y.getBinding(s,l[S],S);u.push({name:S,property:m,binding:k})}}}return u},Rt.prototype.setUniforms=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1){var E=b[y],S=E.name,k=E.property;this.binders[k].setUniform(E.binding,m,u.get(k),S)}},Rt.prototype.updatePaintBuffers=function(s){for(var l in this._buffers=[],this.binders){var u=this.binders[l];if(s&&u instanceof Ut){var m=2===s.fromScale?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof zt||u instanceof $t)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}},Rt.prototype.upload=function(s){for(var l in this.binders){var u=this.binders[l];(u instanceof zt||u instanceof $t||u instanceof Ut)&&u.upload(s)}this.updatePaintBuffers()},Rt.prototype.destroy=function(){for(var s in this.binders){var l=this.binders[s];(l instanceof zt||l instanceof $t||l instanceof Ut)&&l.destroy()}};var rr=function(s,l,u){void 0===u&&(u=function(){return!0}),this.programConfigurations={};for(var m=0,y=s;m<y.length;m+=1){var b=y[m];this.programConfigurations[b.id]=new Rt(b,l,u)}this.needsUpload=!1,this._featureMap=new be,this._bufferOffset=0};function $r(s,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(l+"-","").replace(/-/g,"_")]}function lo(s,l,u){var y={"line-pattern":{source:oc,composite:oc},"fill-pattern":{source:oc,composite:oc},"fill-extrusion-pattern":{source:oc,composite:oc}}[s];return y&&y[u]||{color:{source:ds,composite:d},number:{source:Ws,composite:ds}}[l][u]}rr.prototype.populatePaintArrays=function(s,l,u,m,y,b){for(var E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(s,l,m,y,b);void 0!==l.id&&this._featureMap.add(l.id,u,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0},rr.prototype.updatePaintArrays=function(s,l,u,m){for(var y=0,b=u;y<b.length;y+=1){var E=b[y];this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(s,this._featureMap,l,E,m)||this.needsUpload}},rr.prototype.get=function(s){return this.programConfigurations[s]},rr.prototype.upload=function(s){if(this.needsUpload){for(var l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}},rr.prototype.destroy=function(){for(var s in this.programConfigurations)this.programConfigurations[s].destroy()},st("ConstantBinder",dn),st("CrossFadedConstantBinder",et),st("SourceExpressionBinder",zt),st("CrossFadedCompositeBinder",Ut),st("CompositeExpressionBinder",$t),st("ProgramConfiguration",Rt,{omit:["_buffers"]}),st("ProgramConfigurationSet",rr);var yi=Math.pow(2,14)-1,vi=-yi-1;function Jr(s){for(var l=8192/s.extent,u=s.loadGeometry(),m=0;m<u.length;m++)for(var y=u[m],b=0;b<y.length;b++){var E=y[b],S=Math.round(E.x*l),k=Math.round(E.y*l);E.x=to(S,vi,yi),E.y=to(k,vi,yi),(S<E.x||S>E.x+1||k<E.y||k>E.y+1)&&fr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return u}function Fo(s,l){return{type:s.type,id:s.id,properties:s.properties,geometry:l?Jr(s):[]}}function ja(s,l,u,m,y){s.emplaceBack(2*l+(m+1)/2,2*u+(y+1)/2)}var bo=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Gu,this.indexArray=new Gs,this.segments=new H,this.programConfigurations=new rr(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function Pe(s,l){for(var u=0;u<s.length;u++)if(ca(l,s[u]))return!0;for(var m=0;m<l.length;m++)if(ca(s,l[m]))return!0;return!!Xt(s,l)}function Ht(s,l,u){return!!ca(s,l)||!!la(l,s,u)}function He(s,l){if(1===s.length)return Yc(l,s[0]);for(var u=0;u<l.length;u++)for(var m=l[u],y=0;y<m.length;y++)if(ca(s,m[y]))return!0;for(var b=0;b<s.length;b++)if(Yc(l,s[b]))return!0;for(var E=0;E<l.length;E++)if(Xt(s,l[E]))return!0;return!1}function Ze(s,l,u){if(s.length>1){if(Xt(s,l))return!0;for(var m=0;m<l.length;m++)if(la(l[m],s,u))return!0}for(var y=0;y<s.length;y++)if(la(s[y],l,u))return!0;return!1}function Xt(s,l){if(0===s.length||0===l.length)return!1;for(var u=0;u<s.length-1;u++)for(var m=s[u],y=s[u+1],b=0;b<l.length-1;b++)if(Zc(m,y,l[b],l[b+1]))return!0;return!1}function Zc(s,l,u,m){return Po(s,u,m)!==Po(l,u,m)&&Po(s,l,u)!==Po(s,l,m)}function la(s,l,u){var m=u*u;if(1===l.length)return s.distSqr(l[0])<m;for(var y=1;y<l.length;y++)if(Ns(s,l[y-1],l[y])<m)return!0;return!1}function Ns(s,l,u){var m=l.distSqr(u);if(0===m)return s.distSqr(l);var y=((s.x-l.x)*(u.x-l.x)+(s.y-l.y)*(u.y-l.y))/m;return s.distSqr(y<0?l:y>1?u:u.sub(l)._mult(y)._add(l))}function Yc(s,l){for(var u,m,y,b=!1,E=0;E<s.length;E++)for(var S=0,k=(u=s[E]).length-1;S<u.length;k=S++)(m=u[S]).y>l.y!=(y=u[k]).y>l.y&&l.x<(y.x-m.x)*(l.y-m.y)/(y.y-m.y)+m.x&&(b=!b);return b}function ca(s,l){for(var u=!1,m=0,y=s.length-1;m<s.length;y=m++){var b=s[m],E=s[y];b.y>l.y!=E.y>l.y&&l.x<(E.x-b.x)*(l.y-b.y)/(E.y-b.y)+b.x&&(u=!u)}return u}function Xc(s,l,u){var m=u[0],y=u[2];if(s.x<m.x&&l.x<m.x||s.x>y.x&&l.x>y.x||s.y<m.y&&l.y<m.y||s.y>y.y&&l.y>y.y)return!1;var b=Po(s,l,u[0]);return b!==Po(s,l,u[1])||b!==Po(s,l,u[2])||b!==Po(s,l,u[3])}function Ai(s,l,u){var m=l.paint.get(s).value;return"constant"===m.kind?m.value:u.programConfigurations.get(l.id).getMaxValue(s)}function ac(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Ks(s,l,u,m,y){if(!l[0]&&!l[1])return s;var b=Gt.convert(l)._mult(y);"viewport"===u&&b._rotate(-m);for(var E=[],S=0;S<s.length;S++)E.push(s[S].sub(b));return E}bo.prototype.populate=function(s,l,u){var m=this.layers[0],y=[],b=null,E=!1;"circle"===m.type&&(E=!(b=m.layout.get("circle-sort-key")).isConstant());for(var S=0,k=s;S<k.length;S+=1){var M=k[S],P=M.feature,O=M.id,V=M.index,$=M.sourceLayerIndex,ee=this.layers[0]._featureFilter.needGeometry,Q=Fo(P,ee);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),Q,u)){var pe=E?b.evaluate(Q,{},u):void 0,he={id:O,properties:P.properties,type:P.type,sourceLayerIndex:$,index:V,geometry:ee?Q.geometry:Jr(P),patterns:{},sortKey:pe};y.push(he)}}E&&y.sort(function(yt,it){return yt.sortKey-it.sortKey});for(var ve=0,ye=y;ve<ye.length;ve+=1){var Ie=ye[ve],ke=Ie.geometry,Oe=Ie.index,Ye=Ie.sourceLayerIndex,nt=s[Oe].feature;this.addFeature(Ie,ke,Oe,u),l.featureIndex.insert(nt,ke,Oe,Ye,this.index)}},bo.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},bo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},bo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},bo.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,W),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},bo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},bo.prototype.addFeature=function(s,l,u,m){for(var y=0,b=l;y<b.length;y+=1)for(var E=0,S=b[y];E<S.length;E+=1){var k=S[E],M=k.x,P=k.y;if(!(M<0||M>=8192||P<0||P>=8192)){var O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),V=O.vertexLength;ja(this.layoutVertexArray,M,P,-1,-1),ja(this.layoutVertexArray,M,P,1,-1),ja(this.layoutVertexArray,M,P,1,1),ja(this.layoutVertexArray,M,P,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),O.vertexLength+=4,O.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,{},m)},st("CircleBucket",bo,{omit:["layers"]});var lc=new _i({"circle-sort-key":new Nt(Z.layout_circle["circle-sort-key"])}),Mr={paint:new _i({"circle-radius":new Nt(Z.paint_circle["circle-radius"]),"circle-color":new Nt(Z.paint_circle["circle-color"]),"circle-blur":new Nt(Z.paint_circle["circle-blur"]),"circle-opacity":new Nt(Z.paint_circle["circle-opacity"]),"circle-translate":new tt(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(Z.paint_circle["circle-stroke-opacity"])}),layout:lc},Fn=typeof Float32Array<"u"?Float32Array:Array;function Br(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Zu(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],M=l[6],P=l[7],O=l[8],V=l[9],$=l[10],ee=l[11],Q=l[12],pe=l[13],he=l[14],ve=l[15],ye=u[0],Ie=u[1],ke=u[2],Oe=u[3];return s[0]=ye*m+Ie*S+ke*O+Oe*Q,s[1]=ye*y+Ie*k+ke*V+Oe*pe,s[2]=ye*b+Ie*M+ke*$+Oe*he,s[3]=ye*E+Ie*P+ke*ee+Oe*ve,s[4]=(ye=u[4])*m+(Ie=u[5])*S+(ke=u[6])*O+(Oe=u[7])*Q,s[5]=ye*y+Ie*k+ke*V+Oe*pe,s[6]=ye*b+Ie*M+ke*$+Oe*he,s[7]=ye*E+Ie*P+ke*ee+Oe*ve,s[8]=(ye=u[8])*m+(Ie=u[9])*S+(ke=u[10])*O+(Oe=u[11])*Q,s[9]=ye*y+Ie*k+ke*V+Oe*pe,s[10]=ye*b+Ie*M+ke*$+Oe*he,s[11]=ye*E+Ie*P+ke*ee+Oe*ve,s[12]=(ye=u[12])*m+(Ie=u[13])*S+(ke=u[14])*O+(Oe=u[15])*Q,s[13]=ye*y+Ie*k+ke*V+Oe*pe,s[14]=ye*b+Ie*M+ke*$+Oe*he,s[15]=ye*E+Ie*P+ke*ee+Oe*ve,s}Math.hypot||(Math.hypot=function(){for(var s=arguments,l=0,u=arguments.length;u--;)l+=s[u]*s[u];return Math.sqrt(l)});var Zi,s,wl=Zu;function Sf(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3];return s[0]=u[0]*m+u[4]*y+u[8]*b+u[12]*E,s[1]=u[1]*m+u[5]*y+u[9]*b+u[13]*E,s[2]=u[2]*m+u[6]*y+u[10]*b+u[14]*E,s[3]=u[3]*m+u[7]*y+u[11]*b+u[15]*E,s}Zi=new Fn(3),Fn!=Float32Array&&(Zi[0]=0,Zi[1]=0,Zi[2]=0),s=new Fn(4),Fn!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0);var Xd=(function(){var s=new Fn(2);Fn!=Float32Array&&(s[0]=0,s[1]=0)}(),function(s){function l(u){s.call(this,u,Mr)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new bo(u)},l.prototype.queryRadius=function(u){var m=u;return Ai("circle-radius",this,m)+Ai("circle-stroke-width",this,m)+ac(this.paint.get("circle-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,M){for(var P=Ks(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,k),O=this.paint.get("circle-radius").evaluate(m,y)+this.paint.get("circle-stroke-width").evaluate(m,y),V="map"===this.paint.get("circle-pitch-alignment"),$=V?P:function(Ye,nt){return Ye.map(function(yt){return Ug(yt,nt)})}(P,M),ee=V?O*k:O,Q=0,pe=b;Q<pe.length;Q+=1)for(var he=0,ve=pe[Q];he<ve.length;he+=1){var ye=ve[he],Ie=V?ye:Ug(ye,M),ke=ee,Oe=Sf([],[ye.x,ye.y,0,1],M);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ke*=Oe[3]/S.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ke*=S.cameraToCenterDistance/Oe[3]),Ht($,Ie,ke))return!0}return!1},l}(ki));function Ug(s,l){var u=Sf([],[s.x,s.y,0,1],l);return new Gt(u[0]/u[3],u[1]/u[3])}var Qd=function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(bo);function Qc(s,l,u,m){var y=l.width,b=l.height;if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==y*b*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(y*b*u);return s.width=y,s.height=b,s.data=m,s}function jg(s,l,u){var m=l.width,y=l.height;if(m!==s.width||y!==s.height){var b=Qc({},{width:m,height:y},u);Zp(s,b,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,m),height:Math.min(s.height,y)},u),s.width=m,s.height=y,s.data=b.data}}function Zp(s,l,u,m,y,b){if(0===y.width||0===y.height)return l;if(y.width>s.width||y.height>s.height||u.x>s.width-y.width||u.y>s.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||m.x>l.width-y.width||m.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");for(var E=s.data,S=l.data,k=0;k<y.height;k++)for(var M=((u.y+k)*s.width+u.x)*b,P=((m.y+k)*l.width+m.x)*b,O=0;O<y.width*b;O++)S[P+O]=E[M+O];return l}st("HeatmapBucket",Qd,{omit:["layers"]});var cc=function(s,l){Qc(this,s,1,l)};cc.prototype.resize=function(s){jg(this,s,1)},cc.prototype.clone=function(){return new cc({width:this.width,height:this.height},new Uint8Array(this.data))},cc.copy=function(s,l,u,m,y){Zp(s,l,u,m,y,1)};var hs=function(s,l){Qc(this,s,4,l)};hs.prototype.resize=function(s){jg(this,s,4)},hs.prototype.replace=function(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s},hs.prototype.clone=function(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))},hs.copy=function(s,l,u,m,y){Zp(s,l,u,m,y,4)},st("AlphaImage",cc),st("RGBAImage",hs);var Fw={paint:new _i({"heatmap-radius":new Nt(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new aa(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(Z.paint_heatmap["heatmap-opacity"])})};function Hg(s){var l={},u=s.resolution||256,m=s.clips?s.clips.length:1,y=s.image||new hs({width:u,height:m}),b=function(ee,Q,pe){l[s.evaluationKey]=pe;var he=s.expression.evaluate(l);y.data[ee+Q+0]=Math.floor(255*he.r/he.a),y.data[ee+Q+1]=Math.floor(255*he.g/he.a),y.data[ee+Q+2]=Math.floor(255*he.b/he.a),y.data[ee+Q+3]=Math.floor(255*he.a)};if(s.clips)for(var E=0,S=0;E<m;++E,S+=4*u)for(var k=0,M=0;k<u;k++,M+=4){var P=k/(u-1),O=s.clips[E];b(S,M,O.start*(1-P)+O.end*P)}else for(var V=0,$=0;V<u;V++,$+=4)b(0,$,V/(u-1));return y}var Bw=function(s){function l(u){s.call(this,u,Fw),this._updateColorRamp()}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new Qd(u)},l.prototype._handleSpecialPaintPropertyUpdate=function(u){"heatmap-color"===u&&this._updateColorRamp()},l.prototype._updateColorRamp=function(){this.colorRamp=Hg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},l.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},l}(ki),Vw={paint:new _i({"hillshade-illumination-direction":new tt(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(Z.paint_hillshade["hillshade-accent-color"])})},zw=function(s){function l(u){s.call(this,u,Vw)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},l}(ki),Uw=En([{name:"a_pos",components:2,type:"Int16"}],4).members,Yp=co,pT=co;function co(s,l,u){u=u||2;var m,y,b,E,S,k,M,P=l&&l.length,O=P?l[0]*u:s.length,V=Yu(s,0,O,u,!0),$=[];if(!V||V.next===V.prev)return $;if(P&&(V=function(Q,pe,he,ve){var ye,Ie,ke,Oe=[];for(ye=0,Ie=pe.length;ye<Ie;ye++)(ke=Yu(Q,pe[ye]*ve,ye<Ie-1?pe[ye+1]*ve:Q.length,ve,!1))===ke.next&&(ke.steiner=!0),Oe.push(Hw(ke));for(Oe.sort(jw),ye=0;ye<Oe.length;ye++)$g(Oe[ye],he),he=Bo(he,he.next);return he}(s,l,V,u)),s.length>80*u){m=b=s[0],y=E=s[1];for(var ee=u;ee<O;ee+=u)(S=s[ee])<m&&(m=S),(k=s[ee+1])<y&&(y=k),S>b&&(b=S),k>E&&(E=k);M=0!==(M=Math.max(b-m,E-y))?1/M:0}return Rr(V,$,u,m,y,M),$}function Yu(s,l,u,m,y){var b,E;if(y===rv(s,l,u,m)>0)for(b=l;b<u;b+=m)E=Hn(b,s[b],s[b+1],E);else for(b=u-m;b>=l;b-=m)E=Hn(b,s[b],s[b+1],E);return E&&Qp(E,E.next)&&(Xu(E),E=E.next),E}function Bo(s,l){if(!s)return s;l||(l=s);var u,m=s;do{if(u=!1,m.steiner||!Qp(m,m.next)&&0!==ir(m.prev,m,m.next))m=m.next;else{if(Xu(m),(m=l=m.prev)===m.next)break;u=!0}}while(u||m!==l);return l}function Rr(s,l,u,m,y,b,E){if(s){!E&&b&&function(P,O,V,$){var ee=P;do{null===ee.z&&(ee.z=qg(ee.x,ee.y,O,V,$)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next}while(ee!==P);ee.prevZ.nextZ=null,ee.prevZ=null,function(Q){var pe,he,ve,ye,Ie,ke,Oe,Ye,nt=1;do{for(he=Q,Q=null,Ie=null,ke=0;he;){for(ke++,ve=he,Oe=0,pe=0;pe<nt&&(Oe++,ve=ve.nextZ);pe++);for(Ye=nt;Oe>0||Ye>0&&ve;)0!==Oe&&(0===Ye||!ve||he.z<=ve.z)?(ye=he,he=he.nextZ,Oe--):(ye=ve,ve=ve.nextZ,Ye--),Ie?Ie.nextZ=ye:Q=ye,ye.prevZ=Ie,Ie=ye;he=ve}Ie.nextZ=null,nt*=2}while(ke>1)}(ee)}(s,m,y,b);for(var S,k,M=s;s.prev!==s.next;)if(S=s.prev,k=s.next,b?ua(s,m,y,b):mT(s))l.push(S.i/u),l.push(s.i/u),l.push(k.i/u),Xu(s),s=k.next,M=k.next;else if((s=k)===M){E?1===E?Rr(s=gT(Bo(s),l,u),l,u,m,y,b,2):2===E&&_T(s,l,u,m,y,b):Rr(Bo(s),l,u,m,y,b,1);break}}}function mT(s){var l=s.prev,u=s,m=s.next;if(ir(l,u,m)>=0)return!1;for(var y=s.next.next;y!==s.prev;){if(In(l.x,l.y,u.x,u.y,m.x,m.y,y.x,y.y)&&ir(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function ua(s,l,u,m){var y=s.prev,b=s,E=s.next;if(ir(y,b,E)>=0)return!1;for(var S=y.x>b.x?y.x>E.x?y.x:E.x:b.x>E.x?b.x:E.x,k=y.y>b.y?y.y>E.y?y.y:E.y:b.y>E.y?b.y:E.y,M=qg(y.x<b.x?y.x<E.x?y.x:E.x:b.x<E.x?b.x:E.x,y.y<b.y?y.y<E.y?y.y:E.y:b.y<E.y?b.y:E.y,l,u,m),P=qg(S,k,l,u,m),O=s.prevZ,V=s.nextZ;O&&O.z>=M&&V&&V.z<=P;){if(O!==s.prev&&O!==s.next&&In(y.x,y.y,b.x,b.y,E.x,E.y,O.x,O.y)&&ir(O.prev,O,O.next)>=0||(O=O.prevZ,V!==s.prev&&V!==s.next&&In(y.x,y.y,b.x,b.y,E.x,E.y,V.x,V.y)&&ir(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;O&&O.z>=M;){if(O!==s.prev&&O!==s.next&&In(y.x,y.y,b.x,b.y,E.x,E.y,O.x,O.y)&&ir(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;V&&V.z<=P;){if(V!==s.prev&&V!==s.next&&In(y.x,y.y,b.x,b.y,E.x,E.y,V.x,V.y)&&ir(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function gT(s,l,u){var m=s;do{var y=m.prev,b=m.next.next;!Qp(y,b)&&$w(y,m,m.next,b)&&Ha(y,b)&&Ha(b,y)&&(l.push(y.i/u),l.push(m.i/u),l.push(b.i/u),Xu(m),Xu(m.next),m=s=b),m=m.next}while(m!==s);return Bo(m)}function _T(s,l,u,m,y,b){var E=s;do{for(var S=E.next.next;S!==E.prev;){if(E.i!==S.i&&jn(E,S)){var k=qw(E,S);return E=Bo(E,E.next),k=Bo(k,k.next),Rr(E,l,u,m,y,b),void Rr(k,l,u,m,y,b)}S=S.next}E=E.next}while(E!==s)}function jw(s,l){return s.x-l.x}function $g(s,l){if(l=function(m,y){var b,E=y,S=m.x,k=m.y,M=-1/0;do{if(k<=E.y&&k>=E.next.y&&E.next.y!==E.y){var P=E.x+(k-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(P<=S&&P>M){if(M=P,P===S){if(k===E.y)return E;if(k===E.next.y)return E.next}b=E.x<E.next.x?E:E.next}}E=E.next}while(E!==y);if(!b)return null;if(S===M)return b;var O,V=b,$=b.x,ee=b.y,Q=1/0;E=b;do{S>=E.x&&E.x>=$&&S!==E.x&&In(k<ee?S:M,k,$,ee,k<ee?M:S,k,E.x,E.y)&&(O=Math.abs(k-E.y)/(S-E.x),Ha(E,m)&&(O<Q||O===Q&&(E.x>b.x||E.x===b.x&&Xp(b,E)))&&(b=E,Q=O)),E=E.next}while(E!==V);return b}(s,l)){var u=qw(l,s);Bo(l,l.next),Bo(u,u.next)}}function Xp(s,l){return ir(s.prev,s,l.prev)<0&&ir(l.next,s,s.next)<0}function qg(s,l,u,m,y){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-u)*y)|s<<8))|s<<4))|s<<2))|s<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-m)*y)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function Hw(s){var l=s,u=s;do{(l.x<u.x||l.x===u.x&&l.y<u.y)&&(u=l),l=l.next}while(l!==s);return u}function In(s,l,u,m,y,b,E,S){return(y-E)*(l-S)-(s-E)*(b-S)>=0&&(s-E)*(m-S)-(u-E)*(l-S)>=0&&(u-E)*(b-S)-(y-E)*(m-S)>=0}function jn(s,l){return s.next.i!==l.i&&s.prev.i!==l.i&&!function(u,m){var y=u;do{if(y.i!==u.i&&y.next.i!==u.i&&y.i!==m.i&&y.next.i!==m.i&&$w(y,y.next,u,m))return!0;y=y.next}while(y!==u);return!1}(s,l)&&(Ha(s,l)&&Ha(l,s)&&function(u,m){var y=u,b=!1,E=(u.x+m.x)/2,S=(u.y+m.y)/2;do{y.y>S!=y.next.y>S&&y.next.y!==y.y&&E<(y.next.x-y.x)*(S-y.y)/(y.next.y-y.y)+y.x&&(b=!b),y=y.next}while(y!==u);return b}(s,l)&&(ir(s.prev,s,l.prev)||ir(s,l.prev,l))||Qp(s,l)&&ir(s.prev,s,s.next)>0&&ir(l.prev,l,l.next)>0)}function ir(s,l,u){return(l.y-s.y)*(u.x-l.x)-(l.x-s.x)*(u.y-l.y)}function Qp(s,l){return s.x===l.x&&s.y===l.y}function $w(s,l,u,m){var y=Gg(ir(s,l,u)),b=Gg(ir(s,l,m)),E=Gg(ir(u,m,s)),S=Gg(ir(u,m,l));return y!==b&&E!==S||!(0!==y||!Jp(s,u,l))||!(0!==b||!Jp(s,m,l))||!(0!==E||!Jp(u,s,m))||!(0!==S||!Jp(u,l,m))}function Jp(s,l,u){return l.x<=Math.max(s.x,u.x)&&l.x>=Math.min(s.x,u.x)&&l.y<=Math.max(s.y,u.y)&&l.y>=Math.min(s.y,u.y)}function Gg(s){return s>0?1:s<0?-1:0}function Ha(s,l){return ir(s.prev,s,s.next)<0?ir(s,l,s.next)>=0&&ir(s,s.prev,l)>=0:ir(s,l,s.prev)<0||ir(s,s.next,l)<0}function qw(s,l){var u=new Wg(s.i,s.x,s.y),m=new Wg(l.i,l.x,l.y),y=s.next,b=l.prev;return s.next=l,l.prev=s,u.next=y,y.prev=u,m.next=u,u.prev=m,b.next=m,m.prev=b,m}function Hn(s,l,u,m){var y=new Wg(s,l,u);return m?(y.next=m.next,y.prev=m,m.next.prev=y,m.next=y):(y.prev=y,y.next=y),y}function Xu(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Wg(s,l,u){this.i=s,this.x=l,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rv(s,l,u,m){for(var y=0,b=l,E=u-m;b<u;b+=m)y+=(s[E]-s[b])*(s[b+1]+s[E+1]),E=b;return y}function hO(s,l,u,m,y){!function b(E,S,k,M,P){for(;M>k;){if(M-k>600){var O=M-k+1,V=S-k+1,$=Math.log(O),ee=.5*Math.exp(2*$/3),Q=.5*Math.sqrt($*ee*(O-ee)/O)*(V-O/2<0?-1:1);b(E,S,Math.max(k,Math.floor(S-V*ee/O+Q)),Math.min(M,Math.floor(S+(O-V)*ee/O+Q)),P)}var pe=E[S],he=k,ve=M;for(Jd(E,k,S),P(E[M],pe)>0&&Jd(E,k,M);he<ve;){for(Jd(E,he,ve),he++,ve--;P(E[he],pe)<0;)he++;for(;P(E[ve],pe)>0;)ve--}0===P(E[k],pe)?Jd(E,k,ve):Jd(E,++ve,M),ve<=S&&(k=ve+1),S<=ve&&(M=ve-1)}}(s,l,u||0,m||s.length-1,y||Kg)}function Jd(s,l,u){var m=s[l];s[l]=s[u],s[u]=m}function Kg(s,l){return s<l?-1:s>l?1:0}function iv(s,l){var u=s.length;if(u<=1)return[s];for(var m,y,b=[],E=0;E<u;E++){var S=Np(s[E]);0!==S&&(s[E].area=Math.abs(S),void 0===y&&(y=S<0),y===S<0?(m&&b.push(m),m=[s[E]]):m.push(s[E]))}if(m&&b.push(m),l>1)for(var k=0;k<b.length;k++)b[k].length<=l||(hO(b[k],l,1,b[k].length-1,on),b[k]=b[k].slice(0,l));return b}function on(s,l){return l.area-s.area}function ov(s,l,u){for(var m=u.patternDependencies,y=!1,b=0,E=l;b<E.length;b+=1){var S=E[b].paint.get(s+"-pattern");S.isConstant()||(y=!0);var k=S.constantOr(null);k&&(y=!0,m[k.to]=!0,m[k.from]=!0)}return y}function em(s,l,u,m,y){for(var b=y.patternDependencies,E=0,S=l;E<S.length;E+=1){var k=S[E],M=k.paint.get(s+"-pattern").value;if("constant"!==M.kind){var P=M.evaluate({zoom:m-1},u,{},y.availableImages),O=M.evaluate({zoom:m},u,{},y.availableImages),V=M.evaluate({zoom:m+1},u,{},y.availableImages);O=O&&O.name?O.name:O,V=V&&V.name?V.name:V,b[P=P&&P.name?P.name:P]=!0,b[O]=!0,b[V]=!0,u.patterns[k.id]={min:P,mid:O,max:V}}}return u}co.deviation=function(s,l,u,m){var y=l&&l.length,b=Math.abs(rv(s,0,y?l[0]*u:s.length,u));if(y)for(var E=0,S=l.length;E<S;E++)b-=Math.abs(rv(s,l[E]*u,E<S-1?l[E+1]*u:s.length,u));var k=0;for(E=0;E<m.length;E+=3){var M=m[E]*u,P=m[E+1]*u,O=m[E+2]*u;k+=Math.abs((s[M]-s[O])*(s[P+1]-s[M+1])-(s[M]-s[P])*(s[O+1]-s[M+1]))}return 0===b&&0===k?0:Math.abs((k-b)/b)},co.flatten=function(s){for(var l=s[0][0].length,u={vertices:[],holes:[],dimensions:l},m=0,y=0;y<s.length;y++){for(var b=0;b<s[y].length;b++)for(var E=0;E<l;E++)u.vertices.push(s[y][b][E]);y>0&&u.holes.push(m+=s[y-1].length)}return u},Yp.default=pT;var xl=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gu,this.indexArray=new Gs,this.indexArray2=new Tf,this.programConfigurations=new rr(s.layers,s.zoom),this.segments=new H,this.segments2=new H,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};xl.prototype.populate=function(s,l,u){this.hasPattern=ov("fill",this.layers,l);for(var m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],M=k.feature,P=k.id,O=k.index,V=k.sourceLayerIndex,$=this.layers[0]._featureFilter.needGeometry,ee=Fo(M,$);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),ee,u)){var Q=y?m.evaluate(ee,{},u,l.availableImages):void 0,pe={id:P,properties:M.properties,type:M.type,sourceLayerIndex:V,index:O,geometry:$?ee.geometry:Jr(M),patterns:{},sortKey:Q};b.push(pe)}}y&&b.sort(function(nt,yt){return nt.sortKey-yt.sortKey});for(var he=0,ve=b;he<ve.length;he+=1){var ye=ve[he],Ie=ye.geometry,ke=ye.index,Oe=ye.sourceLayerIndex;if(this.hasPattern){var Ye=em("fill",this.layers,ye,this.zoom,l);this.patternFeatures.push(Ye)}else this.addFeature(ye,Ie,ke,u,{});l.featureIndex.insert(s[ke].feature,Ie,ke,Oe,this.index)}},xl.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},xl.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},xl.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xl.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Uw),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0},xl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},xl.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=iv(l,500);b<E.length;b+=1){for(var S=E[b],k=0,M=0,P=S;M<P.length;M+=1)k+=P[M].length;for(var O=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),V=O.vertexLength,$=[],ee=[],Q=0,pe=S;Q<pe.length;Q+=1){var he=pe[Q];if(0!==he.length){he!==S[0]&&ee.push($.length/2);var ve=this.segments2.prepareSegment(he.length,this.layoutVertexArray,this.indexArray2),ye=ve.vertexLength;this.layoutVertexArray.emplaceBack(he[0].x,he[0].y),this.indexArray2.emplaceBack(ye+he.length-1,ye),$.push(he[0].x),$.push(he[0].y);for(var Ie=1;Ie<he.length;Ie++)this.layoutVertexArray.emplaceBack(he[Ie].x,he[Ie].y),this.indexArray2.emplaceBack(ye+Ie-1,ye+Ie),$.push(he[Ie].x),$.push(he[Ie].y);ve.vertexLength+=he.length,ve.primitiveLength+=he.length}}for(var ke=Yp($,ee),Oe=0;Oe<ke.length;Oe+=3)this.indexArray.emplaceBack(V+ke[Oe],V+ke[Oe+1],V+ke[Oe+2]);O.vertexLength+=k,O.primitiveLength+=ke.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},st("FillBucket",xl,{omit:["layers","patternFeatures"]});var yT=new _i({"fill-sort-key":new Nt(Z.layout_fill["fill-sort-key"])}),sv={paint:new _i({"fill-antialias":new tt(Z.paint_fill["fill-antialias"]),"fill-opacity":new Nt(Z.paint_fill["fill-opacity"]),"fill-color":new Nt(Z.paint_fill["fill-color"]),"fill-outline-color":new Nt(Z.paint_fill["fill-outline-color"]),"fill-translate":new tt(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new gi(Z.paint_fill["fill-pattern"])}),layout:yT},Gw=function(s){function l(u){s.call(this,u,sv)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m);var y=this.paint._values["fill-outline-color"];"constant"===y.value.kind&&void 0===y.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},l.prototype.createBucket=function(u){return new xl(u)},l.prototype.queryRadius=function(){return ac(this.paint.get("fill-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){return He(Ks(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,k),b)},l.prototype.isTileClipped=function(){return!0},l}(ki),Ww=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Kw=If;function If(s,l,u,m,y){this.properties={},this.extent=u,this.type=0,this._pbf=s,this._geometry=-1,this._keys=m,this._values=y,s.readFields(vT,this,l)}function vT(s,l,u){1==s?l.id=u.readVarint():2==s?function(m,y){for(var b=m.readVarint()+m.pos;m.pos<b;){var E=y._keys[m.readVarint()],S=y._values[m.readVarint()];y.properties[E]=S}}(u,l):3==s?l.type=u.readVarint():4==s&&(l._geometry=u.pos)}function Zw(s){for(var l,u,m=0,y=0,b=s.length,E=b-1;y<b;E=y++)m+=((u=s[E]).x-(l=s[y]).x)*(l.y+u.y);return m}If.types=["Unknown","Point","LineString","Polygon"],If.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var l,u=s.readVarint()+s.pos,m=1,y=0,b=0,E=0,S=[];s.pos<u;){if(y<=0){var k=s.readVarint();m=7&k,y=k>>3}if(y--,1===m||2===m)b+=s.readSVarint(),E+=s.readSVarint(),1===m&&(l&&S.push(l),l=[]),l.push(new Gt(b,E));else{if(7!==m)throw new Error("unknown command "+m);l&&l.push(l[0].clone())}}return l&&S.push(l),S},If.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var l=s.readVarint()+s.pos,u=1,m=0,y=0,b=0,E=1/0,S=-1/0,k=1/0,M=-1/0;s.pos<l;){if(m<=0){var P=s.readVarint();u=7&P,m=P>>3}if(m--,1===u||2===u)(y+=s.readSVarint())<E&&(E=y),y>S&&(S=y),(b+=s.readSVarint())<k&&(k=b),b>M&&(M=b);else if(7!==u)throw new Error("unknown command "+u)}return[E,k,S,M]},If.prototype.toGeoJSON=function(s,l,u){var m,y,b=this.extent*Math.pow(2,u),E=this.extent*s,S=this.extent*l,k=this.loadGeometry(),M=If.types[this.type];function P($){for(var ee=0;ee<$.length;ee++){var Q=$[ee];$[ee]=[360*(Q.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+S)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(m=0;m<k.length;m++)O[m]=k[m][0];P(k=O);break;case 2:for(m=0;m<k.length;m++)P(k[m]);break;case 3:for(k=function($){var ee=$.length;if(ee<=1)return[$];for(var Q,pe,he=[],ve=0;ve<ee;ve++){var ye=Zw($[ve]);0!==ye&&(void 0===pe&&(pe=ye<0),pe===ye<0?(Q&&he.push(Q),Q=[$[ve]]):Q.push($[ve]))}return Q&&he.push(Q),he}(k),m=0;m<k.length;m++)for(y=0;y<k[m].length;y++)P(k[m][y])}1===k.length?k=k[0]:M="Multi"+M;var V={type:"Feature",geometry:{type:M,coordinates:k},properties:this.properties};return"id"in this&&(V.id=this.id),V};var kf=El;function El(s,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Yw,this,l),this.length=this._features.length}function Yw(s,l,u){15===s?l.version=u.readVarint():1===s?l.name=u.readString():5===s?l.extent=u.readVarint():2===s?l._features.push(u.pos):3===s?l._keys.push(u.readString()):4===s&&l._values.push(function(m){for(var y=null,b=m.readVarint()+m.pos;m.pos<b;){var E=m.readVarint()>>3;y=1===E?m.readString():2===E?m.readFloat():3===E?m.readDouble():4===E?m.readVarint64():5===E?m.readVarint():6===E?m.readSVarint():7===E?m.readBoolean():null}return y}(u))}function bT(s,l,u){if(3===s){var m=new kf(u,u.readVarint()+u.pos);m.length&&(l[m.name]=m)}}El.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var l=this._pbf.readVarint()+this._pbf.pos;return new Kw(this._pbf,l,this.extent,this._keys,this._values)};var tm={VectorTile:function(s,l){this.layers=s.readFields(bT,{},l)},VectorTileFeature:Kw,VectorTileLayer:kf},fO=tm.VectorTileFeature.types,wo=Math.pow(2,13);function eh(s,l,u,m,y,b,E,S){s.emplaceBack(l,u,2*Math.floor(m*wo)+E,y*wo*2,b*wo*2,Math.round(S))}var uc=function(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Ki,this.indexArray=new Gs,this.programConfigurations=new rr(s.layers,s.zoom),this.segments=new H,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};function av(s,l){return s.x===l.x&&(s.x<0||s.x>8192)||s.y===l.y&&(s.y<0||s.y>8192)}uc.prototype.populate=function(s,l,u){this.features=[],this.hasPattern=ov("fill-extrusion",this.layers,l);for(var m=0,y=s;m<y.length;m+=1){var b=y[m],E=b.feature,S=b.id,k=b.index,M=b.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,O=Fo(E,P);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),O,u)){var V={id:S,sourceLayerIndex:M,index:k,geometry:P?O.geometry:Jr(E),properties:E.properties,type:E.type,patterns:{}};this.hasPattern?this.features.push(em("fill-extrusion",this.layers,V,this.zoom,l)):this.addFeature(V,V.geometry,k,u,{}),l.featureIndex.insert(E,V.geometry,k,M,this.index,!0)}}},uc.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.features;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},uc.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},uc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},uc.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},uc.prototype.upload=function(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Ww),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},uc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},uc.prototype.addFeature=function(s,l,u,m,y){for(var b=0,E=iv(l,500);b<E.length;b+=1){for(var S=E[b],k=0,M=0,P=S;M<P.length;M+=1)k+=P[M].length;for(var O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),V=0,$=S;V<$.length;V+=1){var ee=$[V];if(0!==ee.length&&!((_n=ee).every(function(rn){return rn.x<0})||_n.every(function(rn){return rn.x>8192})||_n.every(function(rn){return rn.y<0})||_n.every(function(rn){return rn.y>8192})))for(var Q=0,pe=0;pe<ee.length;pe++){var he=ee[pe];if(pe>=1){var ve=ee[pe-1];if(!av(he,ve)){O.vertexLength+4>H.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ye=he.sub(ve)._perp()._unit(),Ie=ve.dist(he);Q+Ie>32768&&(Q=0),eh(this.layoutVertexArray,he.x,he.y,ye.x,ye.y,0,0,Q),eh(this.layoutVertexArray,he.x,he.y,ye.x,ye.y,0,1,Q),eh(this.layoutVertexArray,ve.x,ve.y,ye.x,ye.y,0,0,Q+=Ie),eh(this.layoutVertexArray,ve.x,ve.y,ye.x,ye.y,0,1,Q);var ke=O.vertexLength;this.indexArray.emplaceBack(ke,ke+2,ke+1),this.indexArray.emplaceBack(ke+1,ke+2,ke+3),O.vertexLength+=4,O.primitiveLength+=2}}}}if(O.vertexLength+k>H.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray)),"Polygon"===fO[s.type]){for(var Oe=[],Ye=[],nt=O.vertexLength,yt=0,it=S;yt<it.length;yt+=1){var kt=it[yt];if(0!==kt.length){kt!==S[0]&&Ye.push(Oe.length/2);for(var ot=0;ot<kt.length;ot++){var hn=kt[ot];eh(this.layoutVertexArray,hn.x,hn.y,0,0,1,1,0),Oe.push(hn.x),Oe.push(hn.y)}}}for(var Vt=Yp(Oe,Ye),gt=0;gt<Vt.length;gt+=3)this.indexArray.emplaceBack(nt+Vt[gt],nt+Vt[gt+2],nt+Vt[gt+1]);O.primitiveLength+=Vt.length/3,O.vertexLength+=k}}var _n;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},st("FillExtrusionBucket",uc,{omit:["layers","features"]});var wT={paint:new _i({"fill-extrusion-opacity":new tt(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gi(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Af=function(s){function l(u){s.call(this,u,wT)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.createBucket=function(u){return new uc(u)},l.prototype.queryRadius=function(){return ac(this.paint.get("fill-extrusion-translate"))},l.prototype.is3D=function(){return!0},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k,M){var P=Ks(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,k),O=this.paint.get("fill-extrusion-height").evaluate(m,y),V=this.paint.get("fill-extrusion-base").evaluate(m,y),$=function(Q,pe){for(var ye=[],Ie=0,ke=Q;Ie<ke.length;Ie+=1){var Oe=ke[Ie],Ye=[Oe.x,Oe.y,0,1];Sf(Ye,Ye,pe),ye.push(new Gt(Ye[0]/Ye[3],Ye[1]/Ye[3]))}return ye}(P,M),ee=function(Q,pe,he,ve){for(var ye=[],Ie=[],ke=ve[8]*pe,Oe=ve[9]*pe,Ye=ve[10]*pe,nt=ve[11]*pe,yt=ve[8]*he,it=ve[9]*he,kt=ve[10]*he,ot=ve[11]*he,hn=0,Vt=Q;hn<Vt.length;hn+=1){for(var gt=[],_n=[],rn=0,Cn=Vt[hn];rn<Cn.length;rn+=1){var At=Cn[rn],kn=At.x,br=At.y,zr=ve[0]*kn+ve[4]*br+ve[12],Pr=ve[1]*kn+ve[5]*br+ve[13],wr=ve[2]*kn+ve[6]*br+ve[14],Gr=ve[3]*kn+ve[7]*br+ve[15],Mi=wr+Ye,Ri=Gr+nt,Uo=zr+yt,Xi=Pr+it,jo=wr+kt,ti=Gr+ot,Pi=new Gt((zr+ke)/Ri,(Pr+Oe)/Ri);Pi.z=Mi/Ri,gt.push(Pi);var bn=new Gt(Uo/ti,Xi/ti);bn.z=jo/ti,_n.push(bn)}ye.push(gt),Ie.push(_n)}return[ye,Ie]}(b,V,O,M);return function(Q,pe,he){var ve=1/0;He(he,pe)&&(ve=xT(he,pe[0]));for(var ye=0;ye<pe.length;ye++)for(var Ie=pe[ye],ke=Q[ye],Oe=0;Oe<Ie.length-1;Oe++){var Ye=Ie[Oe],nt=[Ye,Ie[Oe+1],ke[Oe+1],ke[Oe],Ye];Pe(he,nt)&&(ve=Math.min(ve,xT(he,nt)))}return ve!==1/0&&ve}(ee[0],ee[1],$)},l}(ki);function Qu(s,l){return s.x*l.x+s.y*l.y}function xT(s,l){if(1===s.length){for(var u,m=0,y=l[m++];!u||y.equals(u);)if(!(u=l[m++]))return 1/0;for(;m<l.length;m++){var b=l[m],E=s[0],S=u.sub(y),k=b.sub(y),M=E.sub(y),P=Qu(S,S),O=Qu(S,k),V=Qu(k,k),$=Qu(M,S),ee=Qu(M,k),Q=P*V-O*O,pe=(V*$-O*ee)/Q,he=(P*ee-O*$)/Q,ve=y.z*(1-pe-he)+u.z*pe+b.z*he;if(isFinite(ve))return ve}return 1/0}for(var ye=1/0,Ie=0,ke=l;Ie<ke.length;Ie+=1)ye=Math.min(ye,ke[Ie].z);return ye}var Xw=En([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,lv=En([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Qw=tm.VectorTileFeature.types,ET=Math.cos(Math.PI/180*37.5),Zg=Math.pow(2,14)/.5,xo=function(s){var l=this;this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){l.gradients[u.id]={}}),this.layoutVertexArray=new us,this.layoutVertexArray2=new ds,this.indexArray=new Gs,this.programConfigurations=new rr(s.layers,s.zoom),this.segments=new H,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};xo.prototype.populate=function(s,l,u){this.hasPattern=ov("line",this.layers,l);for(var m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),b=[],E=0,S=s;E<S.length;E+=1){var k=S[E],M=k.feature,P=k.id,O=k.index,V=k.sourceLayerIndex,$=this.layers[0]._featureFilter.needGeometry,ee=Fo(M,$);if(this.layers[0]._featureFilter.filter(new Kt(this.zoom),ee,u)){var Q=y?m.evaluate(ee,{},u):void 0,pe={id:P,properties:M.properties,type:M.type,sourceLayerIndex:V,index:O,geometry:$?ee.geometry:Jr(M),patterns:{},sortKey:Q};b.push(pe)}}y&&b.sort(function(nt,yt){return nt.sortKey-yt.sortKey});for(var he=0,ve=b;he<ve.length;he+=1){var ye=ve[he],Ie=ye.geometry,ke=ye.index,Oe=ye.sourceLayerIndex;if(this.hasPattern){var Ye=em("line",this.layers,ye,this.zoom,l);this.patternFeatures.push(Ye)}else this.addFeature(ye,Ie,ke,u,{});l.featureIndex.insert(s[ke].feature,Ie,ke,Oe,this.index)}},xo.prototype.update=function(s,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,u)},xo.prototype.addFeatures=function(s,l,u){for(var m=0,y=this.patternFeatures;m<y.length;m+=1){var b=y[m];this.addFeature(b,b.geometry,b.index,l,u)}},xo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xo.prototype.upload=function(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,lv)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Xw),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0},xo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xo.prototype.lineFeatureClips=function(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}},xo.prototype.addFeature=function(s,l,u,m,y){var b=this.layers[0].layout,E=b.get("line-join").evaluate(s,{}),S=b.get("line-cap"),k=b.get("line-miter-limit"),M=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(var P=0,O=l;P<O.length;P+=1)this.addLine(O[P],s,E,S,k,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,y,m)},xo.prototype.addLine=function(s,l,u,m,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var E=0;E<s.length-1;E++)this.totalDistance+=s[E].dist(s[E+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S="Polygon"===Qw[l.type],k=s.length;k>=2&&s[k-1].equals(s[k-2]);)k--;for(var M=0;M<k-1&&s[M].equals(s[M+1]);)M++;if(!(k<(S?3:2))){"bevel"===u&&(y=1.05);var P,O=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray),$=void 0,ee=void 0,Q=void 0,pe=void 0;this.e1=this.e2=-1,S&&(pe=s[M].sub(P=s[k-2])._unit()._perp());for(var he=M;he<k;he++)if(!(ee=he===k-1?S?s[M+1]:void 0:s[he+1])||!s[he].equals(ee)){pe&&(Q=pe),P&&($=P),P=s[he],pe=ee?ee.sub(P)._unit()._perp():Q;var ve=(Q=Q||pe).add(pe);0===ve.x&&0===ve.y||ve._unit();var ye=Q.x*pe.x+Q.y*pe.y,Ie=ve.x*pe.x+ve.y*pe.y,ke=0!==Ie?1/Ie:1/0,Oe=2*Math.sqrt(2-2*Ie),Ye=Ie<ET&&$&&ee,nt=Q.x*pe.y-Q.y*pe.x>0;if(Ye&&he>M){var yt=P.dist($);if(yt>2*O){var it=P.sub(P.sub($)._mult(O/yt)._round());this.updateDistance($,it),this.addCurrentVertex(it,Q,0,0,V),$=it}}var kt=$&&ee,ot=kt?u:S?"butt":m;if(kt&&"round"===ot&&(ke<b?ot="miter":ke<=2&&(ot="fakeround")),"miter"===ot&&ke>y&&(ot="bevel"),"bevel"===ot&&(ke>2&&(ot="flipbevel"),ke<y&&(ot="miter")),$&&this.updateDistance($,P),"miter"===ot)ve._mult(ke),this.addCurrentVertex(P,ve,0,0,V);else if("flipbevel"===ot){if(ke>100)ve=pe.mult(-1);else{var hn=ke*Q.add(pe).mag()/Q.sub(pe).mag();ve._perp()._mult(hn*(nt?-1:1))}this.addCurrentVertex(P,ve,0,0,V),this.addCurrentVertex(P,ve.mult(-1),0,0,V)}else if("bevel"===ot||"fakeround"===ot){var Vt=-Math.sqrt(ke*ke-1),gt=nt?Vt:0,_n=nt?0:Vt;if($&&this.addCurrentVertex(P,Q,gt,_n,V),"fakeround"===ot)for(var rn=Math.round(180*Oe/Math.PI/20),Cn=1;Cn<rn;Cn++){var At=Cn/rn;if(.5!==At){var kn=At-.5;At+=At*kn*(At-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*kn*kn+(.848013+ye*(.215638*ye-1.06021)))}var br=pe.sub(Q)._mult(At)._add(Q)._unit()._mult(nt?-1:1);this.addHalfVertex(P,br.x,br.y,!1,nt,0,V)}ee&&this.addCurrentVertex(P,pe,-gt,-_n,V)}else if("butt"===ot)this.addCurrentVertex(P,ve,0,0,V);else if("square"===ot){var zr=$?1:-1;this.addCurrentVertex(P,ve,zr,zr,V)}else"round"===ot&&($&&(this.addCurrentVertex(P,Q,0,0,V),this.addCurrentVertex(P,Q,1,1,V,!0)),ee&&(this.addCurrentVertex(P,pe,-1,-1,V,!0),this.addCurrentVertex(P,pe,0,0,V)));if(Ye&&he<k-1){var Pr=P.dist(ee);if(Pr>2*O){var wr=P.add(ee.sub(P)._mult(O/Pr)._round());this.updateDistance(P,wr),this.addCurrentVertex(wr,pe,0,0,V),P=wr}}}}},xo.prototype.addCurrentVertex=function(s,l,u,m,y,b){void 0===b&&(b=!1);var E=l.y*m-l.x,S=-l.y-l.x*m;this.addHalfVertex(s,l.x+l.y*u,l.y-l.x*u,b,!1,u,y),this.addHalfVertex(s,E,S,b,!0,-m,y),this.distance>Zg/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(s,l,u,m,y,b))},xo.prototype.addHalfVertex=function(s,l,u,m,y,b,E){var S=.5*(this.lineClips?this.scaledDistance*(Zg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s.x<<1)+(m?1:0),(s.y<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(0===b?0:b<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var k=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),E.primitiveLength++),y?this.e2=k:this.e1=k},xo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},xo.prototype.updateDistance=function(s,l){this.distance+=s.dist(l),this.updateScaledDistance()},st("LineBucket",xo,{omit:["layers","patternFeatures"]});var Jw=new _i({"line-cap":new tt(Z.layout_line["line-cap"]),"line-join":new Nt(Z.layout_line["line-join"]),"line-miter-limit":new tt(Z.layout_line["line-miter-limit"]),"line-round-limit":new tt(Z.layout_line["line-round-limit"]),"line-sort-key":new Nt(Z.layout_line["line-sort-key"])}),ex={paint:new _i({"line-opacity":new Nt(Z.paint_line["line-opacity"]),"line-color":new Nt(Z.paint_line["line-color"]),"line-translate":new tt(Z.paint_line["line-translate"]),"line-translate-anchor":new tt(Z.paint_line["line-translate-anchor"]),"line-width":new Nt(Z.paint_line["line-width"]),"line-gap-width":new Nt(Z.paint_line["line-gap-width"]),"line-offset":new Nt(Z.paint_line["line-offset"]),"line-blur":new Nt(Z.paint_line["line-blur"]),"line-dasharray":new Ot(Z.paint_line["line-dasharray"]),"line-pattern":new gi(Z.paint_line["line-pattern"]),"line-gradient":new aa(Z.paint_line["line-gradient"])}),layout:Jw},tx=new(function(s){function l(){s.apply(this,arguments)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.possiblyEvaluate=function(u,m){return m=new Kt(Math.floor(m.zoom),{now:m.now,fadeDuration:m.fadeDuration,zoomHistory:m.zoomHistory,transition:m.transition}),s.prototype.possiblyEvaluate.call(this,u,m)},l.prototype.evaluate=function(u,m,y,b){return m=Fi({},m,{zoom:Math.floor(m.zoom)}),s.prototype.evaluate.call(this,u,m,y,b)},l}(Nt))(ex.paint.properties["line-width"].specification);tx.useIntegerZoom=!0;var CT=function(s){function l(u){s.call(this,u,ex),this.gradientVersion=0}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype._handleSpecialPaintPropertyUpdate=function(u){"line-gradient"===u&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Pa,this.gradientVersion=(this.gradientVersion+1)%zl)},l.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},l.prototype.recalculate=function(u,m){s.prototype.recalculate.call(this,u,m),this.paint._values["line-floorwidth"]=tx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)},l.prototype.createBucket=function(u){return new xo(u)},l.prototype.queryRadius=function(u){var m=u,y=nx(Ai("line-width",this,m),Ai("line-gap-width",this,m)),b=Ai("line-offset",this,m);return y/2+Math.abs(b)+ac(this.paint.get("line-translate"))},l.prototype.queryIntersectsFeature=function(u,m,y,b,E,S,k){var M=Ks(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,k),P=k/2*nx(this.paint.get("line-width").evaluate(m,y),this.paint.get("line-gap-width").evaluate(m,y)),O=this.paint.get("line-offset").evaluate(m,y);return O&&(b=function(V,$){for(var ee=[],Q=new Gt(0,0),pe=0;pe<V.length;pe++){for(var he=V[pe],ve=[],ye=0;ye<he.length;ye++){var Ie=he[ye],ke=he[ye+1],Oe=0===ye?Q:Ie.sub(he[ye-1])._unit()._perp(),Ye=ye===he.length-1?Q:ke.sub(Ie)._unit()._perp(),nt=Oe._add(Ye)._unit();nt._mult(1/(nt.x*Ye.x+nt.y*Ye.y)),ve.push(nt._mult($)._add(Ie))}ee.push(ve)}return ee}(b,O*k)),function(V,$,ee){for(var Q=0;Q<$.length;Q++){var pe=$[Q];if(V.length>=3)for(var he=0;he<pe.length;he++)if(ca(V,pe[he]))return!0;if(Ze(V,pe,ee))return!0}return!1}(M,b,P)},l.prototype.isTileClipped=function(){return!0},l}(ki);function nx(s,l){return l>0?l+2*s:s}var rx=En([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vr=En([{name:"a_projected_pos",components:3,type:"Float32"}],4),ix=(En([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),En([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),fe=(En([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),En([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),DT=En([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vo(s,l,u){return s.sections.forEach(function(m){var y,E,S;m.text=(y=m.text,E=u,"uppercase"===(S=l.layout.get("text-transform").evaluate(E,{}))?y=y.toLocaleUpperCase():"lowercase"===S&&(y=y.toLocaleLowerCase()),nr.applyArabicShaping&&(y=nr.applyArabicShaping(y)),y)}),s}En([{name:"triangle",components:3,type:"Uint16"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),En([{type:"Float32",name:"offsetX"}]),En([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var si={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},hr=function(s,l,u,m,y){var b,E,S=8*y-m-1,k=(1<<S)-1,M=k>>1,P=-7,O=u?y-1:0,V=u?-1:1,$=s[l+O];for(O+=V,b=$&(1<<-P)-1,$>>=-P,P+=S;P>0;b=256*b+s[l+O],O+=V,P-=8);for(E=b&(1<<-P)-1,b>>=-P,P+=m;P>0;E=256*E+s[l+O],O+=V,P-=8);if(0===b)b=1-M;else{if(b===k)return E?NaN:1/0*($?-1:1);E+=Math.pow(2,m),b-=M}return($?-1:1)*E*Math.pow(2,b-m)},dc=function(s,l,u,m,y,b){var E,S,k,M=8*b-y-1,P=(1<<M)-1,O=P>>1,V=23===y?Math.pow(2,-24)-Math.pow(2,-77):0,$=m?0:b-1,ee=m?1:-1,Q=l<0||0===l&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(S=isNaN(l)?1:0,E=P):(E=Math.floor(Math.log(l)/Math.LN2),l*(k=Math.pow(2,-E))<1&&(E--,k*=2),(l+=E+O>=1?V/k:V*Math.pow(2,1-O))*k>=2&&(E++,k/=2),E+O>=P?(S=0,E=P):E+O>=1?(S=(l*k-1)*Math.pow(2,y),E+=O):(S=l*Math.pow(2,O-1)*Math.pow(2,y),E=0));y>=8;s[u+$]=255&S,$+=ee,S/=256,y-=8);for(E=E<<y|S,M+=y;M>0;s[u+$]=255&E,$+=ee,E/=256,M-=8);s[u+$-ee]|=128*Q},Jc=$n;function $n(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}$n.Varint=0,$n.Fixed64=1,$n.Bytes=2,$n.Fixed32=5;var th=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function hc(s){return s.type===$n.Bytes?s.readVarint()+s.pos:s.pos+1}function nh(s,l,u){var m=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));u.realloc(m);for(var y=u.pos-1;y>=s;y--)u.buf[y+m]=u.buf[y]}function pO(s,l){for(var u=0;u<s.length;u++)l.writeVarint(s[u])}function TT(s,l){for(var u=0;u<s.length;u++)l.writeSVarint(s[u])}function ST(s,l){for(var u=0;u<s.length;u++)l.writeFloat(s[u])}function IT(s,l){for(var u=0;u<s.length;u++)l.writeDouble(s[u])}function kT(s,l){for(var u=0;u<s.length;u++)l.writeBoolean(s[u])}function AT(s,l){for(var u=0;u<s.length;u++)l.writeFixed32(s[u])}function $a(s,l){for(var u=0;u<s.length;u++)l.writeSFixed32(s[u])}function ox(s,l){for(var u=0;u<s.length;u++)l.writeFixed64(s[u])}function MT(s,l){for(var u=0;u<s.length;u++)l.writeSFixed64(s[u])}function ed(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+16777216*s[l+3]}function Mf(s,l,u){s[u]=l,s[u+1]=l>>>8,s[u+2]=l>>>16,s[u+3]=l>>>24}function sx(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+(s[l+3]<<24)}function RT(s,l,u){1===s&&u.readMessage(PT,l)}function PT(s,l,u){if(3===s){var m=u.readMessage(NT,{}),y=m.width,b=m.height,E=m.left,S=m.top,k=m.advance;l.push({id:m.id,bitmap:new cc({width:y+6,height:b+6},m.bitmap),metrics:{width:y,height:b,left:E,top:S,advance:k}})}}function NT(s,l,u){1===s?l.id=u.readVarint():2===s?l.bitmap=u.readBytes():3===s?l.width=u.readVarint():4===s?l.height=u.readVarint():5===s?l.left=u.readSVarint():6===s?l.top=u.readSVarint():7===s&&(l.advance=u.readVarint())}function ax(s){for(var l=0,u=0,m=0,y=s;m<y.length;m+=1){var b=y[m];l+=b.w*b.h,u=Math.max(u,b.w)}s.sort(function(Q,pe){return pe.h-Q.h});for(var E=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),u),h:1/0}],S=0,k=0,M=0,P=s;M<P.length;M+=1)for(var O=P[M],V=E.length-1;V>=0;V--){var $=E[V];if(!(O.w>$.w||O.h>$.h)){if(O.x=$.x,O.y=$.y,k=Math.max(k,O.y+O.h),S=Math.max(S,O.x+O.w),O.w===$.w&&O.h===$.h){var ee=E.pop();V<E.length&&(E[V]=ee)}else O.h===$.h?($.x+=O.w,$.w-=O.w):O.w===$.w?($.y+=O.h,$.h-=O.h):(E.push({x:$.x+O.w,y:$.y,w:$.w-O.w,h:O.h}),$.y+=O.h,$.h-=O.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}$n.prototype={destroy:function(){this.buf=null},readFields:function(s,l,u){for(u=u||this.length;this.pos<u;){var m=this.readVarint(),y=m>>3,b=this.pos;this.type=7&m,s(y,l,this),this.pos===b&&this.skip(m)}return l},readMessage:function(s,l){return this.readFields(s,l,this.readVarint()+this.pos)},readFixed32:function(){var s=ed(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=sx(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=ed(this.buf,this.pos)+4294967296*ed(this.buf,this.pos+4);return this.pos+=8,s},readSFixed64:function(){var s=ed(this.buf,this.pos)+4294967296*sx(this.buf,this.pos+4);return this.pos+=8,s},readFloat:function(){var s=hr(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=hr(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var l,u,m=this.buf;return l=127&(u=m[this.pos++]),u<128?l:(l|=(127&(u=m[this.pos++]))<<7,u<128?l:(l|=(127&(u=m[this.pos++]))<<14,u<128?l:(l|=(127&(u=m[this.pos++]))<<21,u<128?l:function(y,b,E){var S,k,M=E.buf;if(S=(112&(k=M[E.pos++]))>>4,k<128||(S|=(127&(k=M[E.pos++]))<<3,k<128)||(S|=(127&(k=M[E.pos++]))<<10,k<128)||(S|=(127&(k=M[E.pos++]))<<17,k<128)||(S|=(127&(k=M[E.pos++]))<<24,k<128)||(S|=(1&(k=M[E.pos++]))<<31,k<128))return function Ju(s,l,u){return u?4294967296*l+(s>>>0):4294967296*(l>>>0)+(s>>>0)}(y,S,b);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(u=m[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,l=this.pos;return this.pos=s,s-l>=12&&th?th.decode(this.buf.subarray(l,s)):function(u,m,y){for(var b="",E=m;E<y;){var S,k,M,P=u[E],O=null,V=P>239?4:P>223?3:P>191?2:1;if(E+V>y)break;1===V?P<128&&(O=P):2===V?128==(192&(S=u[E+1]))&&(O=(31&P)<<6|63&S)<=127&&(O=null):3===V?(k=u[E+2],128==(192&(S=u[E+1]))&&128==(192&k)&&((O=(15&P)<<12|(63&S)<<6|63&k)<=2047||O>=55296&&O<=57343)&&(O=null)):4===V&&(k=u[E+2],M=u[E+3],128==(192&(S=u[E+1]))&&128==(192&k)&&128==(192&M)&&((O=(15&P)<<18|(63&S)<<12|(63&k)<<6|63&M)<=65535||O>=1114112)&&(O=null)),null===O?(O=65533,V=1):O>65535&&(O-=65536,b+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),b+=String.fromCharCode(O),E+=V}return b}(this.buf,l,s)},readBytes:function(){var s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l},readPackedVarint:function(s,l){if(this.type!==$n.Bytes)return s.push(this.readVarint(l));var u=hc(this);for(s=s||[];this.pos<u;)s.push(this.readVarint(l));return s},readPackedSVarint:function(s){if(this.type!==$n.Bytes)return s.push(this.readSVarint());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==$n.Bytes)return s.push(this.readBoolean());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==$n.Bytes)return s.push(this.readFloat());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==$n.Bytes)return s.push(this.readDouble());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==$n.Bytes)return s.push(this.readFixed32());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==$n.Bytes)return s.push(this.readSFixed32());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==$n.Bytes)return s.push(this.readFixed64());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==$n.Bytes)return s.push(this.readSFixed64());var l=hc(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed64());return s},skip:function(s){var l=7&s;if(l===$n.Varint)for(;this.buf[this.pos++]>127;);else if(l===$n.Bytes)this.pos=this.readVarint()+this.pos;else if(l===$n.Fixed32)this.pos+=4;else{if(l!==$n.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(s,l){this.writeVarint(s<<3|l)},realloc:function(s){for(var l=this.length||16;l<this.pos+s;)l*=2;if(l!==this.length){var u=new Uint8Array(l);u.set(this.buf),this.buf=u,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Mf(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Mf(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Mf(this.buf,-1&s,this.pos),Mf(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Mf(this.buf,-1&s,this.pos),Mf(this.buf,Math.floor(s*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(l,u){var m,y,b,S;if(l>=0?(m=l%4294967296|0,y=l/4294967296|0):(y=~(-l/4294967296),4294967295^(m=~(-l%4294967296))?m=m+1|0:(m=0,y=y+1|0)),l>=0x10000000000000000||l<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),b=m,(S=u).buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,b>>>=7,S.buf[S.pos++]=127&b|128,S.buf[S.pos]=127&(b>>>=7),function(b,E){var S=(7&b)<<4;E.buf[E.pos++]|=S|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(y,u)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var l=this.pos;this.pos=function(m,y,b){for(var E,S,k=0;k<y.length;k++){if((E=y.charCodeAt(k))>55295&&E<57344){if(!S){E>56319||k+1===y.length?(m[b++]=239,m[b++]=191,m[b++]=189):S=E;continue}if(E<56320){m[b++]=239,m[b++]=191,m[b++]=189,S=E;continue}E=S-55296<<10|E-56320|65536,S=null}else S&&(m[b++]=239,m[b++]=191,m[b++]=189,S=null);E<128?m[b++]=E:(E<2048?m[b++]=E>>6|192:(E<65536?m[b++]=E>>12|224:(m[b++]=E>>18|240,m[b++]=E>>12&63|128),m[b++]=E>>6&63|128),m[b++]=63&E|128)}return b}(this.buf,s,this.pos);var u=this.pos-l;u>=128&&nh(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeFloat:function(s){this.realloc(4),dc(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),dc(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var l=s.length;this.writeVarint(l),this.realloc(l);for(var u=0;u<l;u++)this.buf[this.pos++]=s[u]},writeRawMessage:function(s,l){this.pos++;var u=this.pos;s(l,this);var m=this.pos-u;m>=128&&nh(u,m,this),this.pos=u-1,this.writeVarint(m),this.pos+=m},writeMessage:function(s,l,u){this.writeTag(s,$n.Bytes),this.writeRawMessage(l,u)},writePackedVarint:function(s,l){l.length&&this.writeMessage(s,pO,l)},writePackedSVarint:function(s,l){l.length&&this.writeMessage(s,TT,l)},writePackedBoolean:function(s,l){l.length&&this.writeMessage(s,kT,l)},writePackedFloat:function(s,l){l.length&&this.writeMessage(s,ST,l)},writePackedDouble:function(s,l){l.length&&this.writeMessage(s,IT,l)},writePackedFixed32:function(s,l){l.length&&this.writeMessage(s,AT,l)},writePackedSFixed32:function(s,l){l.length&&this.writeMessage(s,$a,l)},writePackedFixed64:function(s,l){l.length&&this.writeMessage(s,ox,l)},writePackedSFixed64:function(s,l){l.length&&this.writeMessage(s,MT,l)},writeBytesField:function(s,l){this.writeTag(s,$n.Bytes),this.writeBytes(l)},writeFixed32Field:function(s,l){this.writeTag(s,$n.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(s,l){this.writeTag(s,$n.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(s,l){this.writeTag(s,$n.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(s,l){this.writeTag(s,$n.Fixed64),this.writeSFixed64(l)},writeVarintField:function(s,l){this.writeTag(s,$n.Varint),this.writeVarint(l)},writeSVarintField:function(s,l){this.writeTag(s,$n.Varint),this.writeSVarint(l)},writeStringField:function(s,l){this.writeTag(s,$n.Bytes),this.writeString(l)},writeFloatField:function(s,l){this.writeTag(s,$n.Fixed32),this.writeFloat(l)},writeDoubleField:function(s,l){this.writeTag(s,$n.Fixed64),this.writeDouble(l)},writeBooleanField:function(s,l){this.writeVarintField(s,!!l)}};var Rf=function(s,l){var u=l.pixelRatio,m=l.version,y=l.stretchX,b=l.stretchY,E=l.content;this.paddedRect=s,this.pixelRatio=u,this.stretchX=y,this.stretchY=b,this.content=E,this.version=m},td={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};td.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},td.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},td.tlbr.get=function(){return this.tl.concat(this.br)},td.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Rf.prototype,td);var Pf=function(s,l){var u={},m={};this.haveRenderCallbacks=[];var y=[];this.addImages(s,u,y),this.addImages(l,m,y);var b=ax(y),E=new hs({width:b.w||1,height:b.h||1});for(var S in s){var k=s[S],M=u[S].paddedRect;hs.copy(k.data,E,{x:0,y:0},{x:M.x+1,y:M.y+1},k.data)}for(var P in l){var O=l[P],V=m[P].paddedRect,$=V.x+1,ee=V.y+1,Q=O.data.width,pe=O.data.height;hs.copy(O.data,E,{x:0,y:0},{x:$,y:ee},O.data),hs.copy(O.data,E,{x:0,y:pe-1},{x:$,y:ee-1},{width:Q,height:1}),hs.copy(O.data,E,{x:0,y:0},{x:$,y:ee+pe},{width:Q,height:1}),hs.copy(O.data,E,{x:Q-1,y:0},{x:$-1,y:ee},{width:1,height:pe}),hs.copy(O.data,E,{x:0,y:0},{x:$+Q,y:ee},{width:1,height:pe})}this.image=E,this.iconPositions=u,this.patternPositions=m};Pf.prototype.addImages=function(s,l,u){for(var m in s){var y=s[m],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};u.push(b),l[m]=new Rf(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}},Pf.prototype.patchUpdatedImages=function(s,l){for(var u in s.dispatchRenderCallbacks(this.haveRenderCallbacks),s.updatedImages)this.patchUpdatedImage(this.iconPositions[u],s.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],s.getImage(u),l)},Pf.prototype.patchUpdatedImage=function(s,l,u){if(s&&l&&s.version!==l.version){s.version=l.version;var m=s.tl;u.update(l.data,void 0,{x:m[0],y:m[1]})}},st("ImagePosition",Rf),st("ImageAtlas",Pf);var Zs={horizontal:1,vertical:2,horizontalOnly:3},zo=function(){this.scale=1,this.fontStack="",this.imageName=null};zo.forText=function(s,l){var u=new zo;return u.scale=s||1,u.fontStack=l,u},zo.forImage=function(s){var l=new zo;return l.imageName=s,l};var Eo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Yg(s,l,u,m,y,b,E,S,k,M,P,O,V,$,ee,Q){var pe,he=Eo.fromFeature(s,y);O===Zs.vertical&&he.verticalizePunctuation();var ve=nr.processBidirectionalText,ye=nr.processStyledBidirectionalText;if(ve&&1===he.sections.length){pe=[];for(var Ie=0,ke=ve(he.toString(),uv(he,M,b,l,m,$,ee));Ie<ke.length;Ie+=1){var Oe=ke[Ie],Ye=new Eo;Ye.text=Oe,Ye.sections=he.sections;for(var nt=0;nt<Oe.length;nt++)Ye.sectionIndex.push(0);pe.push(Ye)}}else if(ye){pe=[];for(var yt=0,it=ye(he.text,he.sectionIndex,uv(he,M,b,l,m,$,ee));yt<it.length;yt+=1){var kt=it[yt],ot=new Eo;ot.text=kt[0],ot.sectionIndex=kt[1],ot.sections=he.sections,pe.push(ot)}}else pe=function(gt,_n){for(var rn=[],Cn=gt.text,At=0,kn=0,br=_n;kn<br.length;kn+=1){var zr=br[kn];rn.push(gt.substring(At,zr)),At=zr}return At<Cn.length&&rn.push(gt.substring(At,Cn.length)),rn}(he,uv(he,M,b,l,m,$,ee));var hn=[],Vt={positionedLines:hn,text:he.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:O,iconsInText:!1,verticalizable:!1};return function(gt,_n,rn,Cn,At,kn,br,zr,Pr,wr,Gr,Mi){for(var Ri=0,Uo=-17,Xi=0,jo=0,ti="right"===zr?1:"left"===zr?0:.5,Pi=0,bn=0,or=At;bn<or.length;bn+=1){var Xn=or[bn];Xn.trim();var An=Xn.getMaxScale(),Co=24*(An-1),Do={positionedGlyphs:[],lineOffset:0};gt.positionedLines[Pi]=Do;var Qn=Do.positionedGlyphs,xr=0;if(Xn.length()){for(var To=0;To<Xn.length();To++){var Vn=Xn.getSection(To),Dl=Xn.getSectionIndex(To),ps=Xn.getCharCode(To),ha=0,Ur=null,fc=null,Ga=null,cm=24,Tl=!(Pr===Zs.horizontal||!Gr&&!Ke(ps)||Gr&&(Xg[ps]||(mc=ps,ht.Arabic(mc)||ht["Arabic Supplement"](mc)||ht["Arabic Extended-A"](mc)||ht["Arabic Presentation Forms-A"](mc)||ht["Arabic Presentation Forms-B"](mc))));if(Vn.imageName){var uh=Cn[Vn.imageName];if(!uh)continue;Ga=Vn.imageName,gt.iconsInText=gt.iconsInText||!0,fc=uh.paddedRect;var pc=uh.displaySize;Vn.scale=24*Vn.scale/Mi,ha=Co+(24-pc[1]*Vn.scale),cm=(Ur={width:pc[0],height:pc[1],left:1,top:-3,advance:Tl?pc[1]:pc[0]}).advance;var dh=Tl?pc[0]*Vn.scale-24*An:pc[1]*Vn.scale-24*An;dh>0&&dh>xr&&(xr=dh)}else{var jf=rn[Vn.fontStack],hh=jf&&jf[ps];if(hh&&hh.rect)fc=hh.rect,Ur=hh.metrics;else{var Hf=_n[Vn.fontStack],a_=Hf&&Hf[ps];if(!a_)continue;Ur=a_.metrics}ha=24*(An-Vn.scale)}Tl?(gt.verticalizable=!0,Qn.push({glyph:ps,imageName:Ga,x:Ri,y:Uo+ha,vertical:Tl,scale:Vn.scale,fontStack:Vn.fontStack,sectionIndex:Dl,metrics:Ur,rect:fc}),Ri+=cm*Vn.scale+wr):(Qn.push({glyph:ps,imageName:Ga,x:Ri,y:Uo+ha,vertical:Tl,scale:Vn.scale,fontStack:Vn.fontStack,sectionIndex:Dl,metrics:Ur,rect:fc}),Ri+=Ur.advance*Vn.scale+wr)}0!==Qn.length&&(Xi=Math.max(Ri-wr,Xi),gr(Qn,0,Qn.length-1,ti,xr)),Ri=0;var $f=kn*An+xr;Do.lineOffset=Math.max(xr,Co),Uo+=$f,jo=Math.max($f,jo),++Pi}else Uo+=kn,++Pi}var mc,gc=Uo- -17,qf=dv(br),ru=qf.horizontalAlign,fh=qf.verticalAlign;(function(l_,um,Gf,dm,Wf,c_,Kf,hm,u_){var fm,Cv=(um-Gf)*Wf;fm=c_!==Kf?-hm*dm- -17:(-dm*u_+.5)*Kf;for(var pm=0,mm=l_;pm<mm.length;pm+=1)for(var ph=0,gm=mm[pm].positionedGlyphs;ph<gm.length;ph+=1){var iu=gm[ph];iu.x+=Cv,iu.y+=fm}})(gt.positionedLines,ti,ru,fh,Xi,jo,kn,gc,At.length),gt.top+=-fh*gc,gt.bottom=gt.top+gc,gt.left+=-ru*Xi,gt.right=gt.left+Xi}(Vt,l,u,m,pe,E,S,k,O,M,V,Q),!function(gt){for(var _n=0,rn=gt;_n<rn.length;_n+=1)if(0!==rn[_n].positionedGlyphs.length)return!1;return!0}(hn)&&Vt}Eo.fromFeature=function(s,l){for(var u=new Eo,m=0;m<s.sections.length;m++){var y=s.sections[m];y.image?u.addImageSection(y):u.addTextSection(y,l)}return u},Eo.prototype.length=function(){return this.text.length},Eo.prototype.getSection=function(s){return this.sections[this.sectionIndex[s]]},Eo.prototype.getSectionIndex=function(s){return this.sectionIndex[s]},Eo.prototype.getCharCode=function(s){return this.text.charCodeAt(s)},Eo.prototype.verticalizePunctuation=function(){this.text=function(s){for(var l="",u=0;u<s.length;u++){var m=s.charCodeAt(u+1)||null,y=s.charCodeAt(u-1)||null;l+=m&&Bt(m)&&!si[s[u+1]]||y&&Bt(y)&&!si[s[u-1]]||!si[s[u]]?s[u]:si[s[u]]}return l}(this.text)},Eo.prototype.trim=function(){for(var s=0,l=0;l<this.text.length&&Xg[this.text.charCodeAt(l)];l++)s++;for(var u=this.text.length,m=this.text.length-1;m>=0&&m>=s&&Xg[this.text.charCodeAt(m)];m--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)},Eo.prototype.substring=function(s,l){var u=new Eo;return u.text=this.text.substring(s,l),u.sectionIndex=this.sectionIndex.slice(s,l),u.sections=this.sections,u},Eo.prototype.toString=function(){return this.text},Eo.prototype.getMaxScale=function(){var s=this;return this.sectionIndex.reduce(function(l,u){return Math.max(l,s.sections[u].scale)},0)},Eo.prototype.addTextSection=function(s,l){this.text+=s.text,this.sections.push(zo.forText(s.scale,s.fontStack||l));for(var u=this.sections.length-1,m=0;m<s.text.length;++m)this.sectionIndex.push(u)},Eo.prototype.addImageSection=function(s){var l=s.image?s.image.name:"";if(0!==l.length){var u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(zo.forImage(l)),this.sectionIndex.push(this.sections.length-1)):fr("Reached maximum number of images 6401")}else fr("Can't add FormattedSection with an empty image.")},Eo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Xg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fs={};function cv(s,l,u,m,y,b){if(l.imageName){var E=m[l.imageName];return E?E.displaySize[0]*l.scale*24/b+y:0}var S=u[l.fontStack],k=S&&S[s];return k?k.metrics.advance*l.scale+y:0}function lx(s,l,u,m){var y=Math.pow(s-l,2);return m?s<l?y/2:2*y:y+Math.abs(u)*u}function rh(s,l,u){var m=0;return 10===s&&(m-=1e4),u&&(m+=150),40!==s&&65288!==s||(m+=50),41!==l&&65289!==l||(m+=50),m}function cx(s,l,u,m,y,b){for(var E=null,S=lx(l,u,y,b),k=0,M=m;k<M.length;k+=1){var P=M[k],O=lx(l-P.x,u,y,b)+P.badness;O<=S&&(E=P,S=O)}return{index:s,x:l,priorBreak:E,badness:S}}function uv(s,l,u,m,y,b,E){if("point"!==b)return[];if(!s)return[];for(var S,k=[],M=function(pe,he,ve,ye,Ie,ke){for(var Oe=0,Ye=0;Ye<pe.length();Ye++){var nt=pe.getSection(Ye);Oe+=cv(pe.getCharCode(Ye),nt,ye,Ie,he,ke)}return Oe/Math.max(1,Math.ceil(Oe/ve))}(s,l,u,m,y,E),P=s.text.indexOf("\u200b")>=0,O=0,V=0;V<s.length();V++){var $=s.getSection(V),ee=s.getCharCode(V);if(Xg[ee]||(O+=cv(ee,$,m,y,l,E)),V<s.length()-1){var Q=!((S=ee)<11904||!(ht["Bopomofo Extended"](S)||ht.Bopomofo(S)||ht["CJK Compatibility Forms"](S)||ht["CJK Compatibility Ideographs"](S)||ht["CJK Compatibility"](S)||ht["CJK Radicals Supplement"](S)||ht["CJK Strokes"](S)||ht["CJK Symbols and Punctuation"](S)||ht["CJK Unified Ideographs Extension A"](S)||ht["CJK Unified Ideographs"](S)||ht["Enclosed CJK Letters and Months"](S)||ht["Halfwidth and Fullwidth Forms"](S)||ht.Hiragana(S)||ht["Ideographic Description Characters"](S)||ht["Kangxi Radicals"](S)||ht["Katakana Phonetic Extensions"](S)||ht.Katakana(S)||ht["Vertical Forms"](S)||ht["Yi Radicals"](S)||ht["Yi Syllables"](S)));(fs[ee]||Q||$.imageName)&&k.push(cx(V+1,O,M,k,rh(ee,s.getCharCode(V+1),Q&&P),!1))}}return function pe(he){return he?pe(he.priorBreak).concat(he.index):[]}(cx(s.length(),O,M,k,0,!0))}function dv(s){var l=.5,u=.5;switch(s){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:l,verticalAlign:u}}function gr(s,l,u,m,y){if(m||y)for(var b=s[u],E=(s[u].x+b.metrics.advance*b.scale)*m,S=l;S<=u;S++)s[S].x-=E,s[S].y+=y}function Ct(s,l,u,m,y,b){var E,S=s.image;if(S.content){var k=S.content,M=S.pixelRatio||1;E=[k[0]/M,k[1]/M,S.displaySize[0]-k[2]/M,S.displaySize[1]-k[3]/M]}var P,O,V,$,ee=l.left*b,Q=l.right*b;"width"===u||"both"===u?($=y[0]+ee-m[3],O=y[0]+Q+m[1]):O=($=y[0]+(ee+Q-S.displaySize[0])/2)+S.displaySize[0];var pe=l.top*b,he=l.bottom*b;return"height"===u||"both"===u?(P=y[1]+pe-m[0],V=y[1]+he+m[2]):V=(P=y[1]+(pe+he-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:P,right:O,bottom:V,left:$,collisionPadding:E}}fs[10]=!0,fs[32]=!0,fs[38]=!0,fs[40]=!0,fs[41]=!0,fs[43]=!0,fs[45]=!0,fs[47]=!0,fs[173]=!0,fs[183]=!0,fs[8203]=!0,fs[8208]=!0,fs[8211]=!0,fs[8231]=!0;var Nf=function(s){function l(u,m,y,b){s.call(this,u,m),this.angle=y,void 0!==b&&(this.segment=b)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.clone=function(){return new l(this.x,this.y,this.angle,this.segment)},l}(Gt);function Qg(s,l){var u=l.expression;if("constant"===u.kind)return{kind:"constant",layoutSize:u.evaluate(new Kt(s+1))};if("source"===u.kind)return{kind:"source"};for(var m=u.zoomStops,y=u.interpolationType,b=0;b<m.length&&m[b]<=s;)b++;for(var E=b=Math.max(0,b-1);E<m.length&&m[E]<s+1;)E++;E=Math.min(m.length-1,E);var S=m[b],k=m[E];return"composite"===u.kind?{kind:"composite",minZoom:S,maxZoom:k,interpolationType:y}:{kind:"camera",minZoom:S,maxZoom:k,minSize:u.evaluate(new Kt(S)),maxSize:u.evaluate(new Kt(k)),interpolationType:y}}function nm(s,l,u){var m=l.uSize,y=u.lowerSize;return"source"===s.kind?y/128:"composite"===s.kind?pi(y/128,u.upperSize/128,l.uSizeT):m}function rm(s,l){var u=0,m=0;if("constant"===s.kind)m=s.layoutSize;else if("source"!==s.kind){var y=s.interpolationType,b=y?to(ln.interpolationFactor(y,l,s.minZoom,s.maxZoom),0,1):0;"camera"===s.kind?m=pi(s.minSize,s.maxSize,b):u=b}return{uSizeT:u,uSize:m}}st("Anchor",Nf);var hv=Object.freeze({__proto__:null,getSizeData:Qg,evaluateSizeForFeature:nm,evaluateSizeForZoom:rm,SIZE_PACK_FACTOR:128});function fv(s,l,u,m,y){if(void 0===l.segment)return!0;for(var b=l,E=l.segment+1,S=0;S>-u/2;){if(--E<0)return!1;S-=s[E].dist(b),b=s[E]}S+=s[E].dist(s[E+1]),E++;for(var k=[],M=0;S<u/2;){var P=s[E],O=s[E+1];if(!O)return!1;var V=s[E-1].angleTo(P)-P.angleTo(O);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:S,angleDelta:V}),M+=V;S-k[0].distance>m;)M-=k.shift().angleDelta;if(M>y)return!1;E++,S+=P.dist(O)}return!0}function pv(s){for(var l=0,u=0;u<s.length-1;u++)l+=s[u].dist(s[u+1]);return l}function ux(s,l,u){return s?.6*l*u:0}function ih(s,l){return Math.max(s?s.right-s.left:0,l?l.right-l.left:0)}function im(s,l,u,m,y,b){for(var E=ux(u,y,b),S=ih(u,m)*b,k=0,M=pv(s)/2,P=0;P<s.length-1;P++){var O=s[P],V=s[P+1],$=O.dist(V);if(k+$>M){var ee=(M-k)/$,Q=pi(O.x,V.x,ee),pe=pi(O.y,V.y,ee),he=new Nf(Q,pe,V.angleTo(O),P);return he._round(),!E||fv(s,he,S,E,l)?he:void 0}k+=$}}function mv(s,l,u,m,y,b,E,S,k){var M=ux(m,b,E),P=ih(m,y),O=P*E,V=0===s[0].x||s[0].x===k||0===s[0].y||s[0].y===k;return l-O<l/4&&(l=O+l/4),function $(ee,Q,pe,he,ve,ye,Ie,ke,Oe){for(var Ye=ye/2,nt=pv(ee),yt=0,it=Q-pe,kt=[],ot=0;ot<ee.length-1;ot++){for(var hn=ee[ot],Vt=ee[ot+1],gt=hn.dist(Vt),_n=Vt.angleTo(hn);it+pe<yt+gt;){var rn=((it+=pe)-yt)/gt,Cn=pi(hn.x,Vt.x,rn),At=pi(hn.y,Vt.y,rn);if(Cn>=0&&Cn<Oe&&At>=0&&At<Oe&&it-Ye>=0&&it+Ye<=nt){var kn=new Nf(Cn,At,_n,ot);kn._round(),he&&!fv(ee,kn,ye,he,ve)||kt.push(kn)}}yt+=gt}return ke||kt.length||Ie||(kt=$(ee,yt/2,pe,he,ve,ye,Ie,!0,Oe)),kt}(s,V?l/2*S%l:(P/2+2*b)*E*S%l,l,M,u,O,V,!1,k)}function gv(s,l,u,m,y){for(var b=[],E=0;E<s.length;E++)for(var S=s[E],k=void 0,M=0;M<S.length-1;M++){var P=S[M],O=S[M+1];P.x<l&&O.x<l||(P.x<l?P=new Gt(l,P.y+(l-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x<l&&(O=new Gt(l,P.y+(l-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y<u&&O.y<u||(P.y<u?P=new Gt(P.x+(u-P.y)/(O.y-P.y)*(O.x-P.x),u)._round():O.y<u&&(O=new Gt(P.x+(u-P.y)/(O.y-P.y)*(O.x-P.x),u)._round()),P.x>=m&&O.x>=m||(P.x>=m?P=new Gt(m,P.y+(m-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x>=m&&(O=new Gt(m,P.y+(m-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y>=y&&O.y>=y||(P.y>=y?P=new Gt(P.x+(y-P.y)/(O.y-P.y)*(O.x-P.x),y)._round():O.y>=y&&(O=new Gt(P.x+(y-P.y)/(O.y-P.y)*(O.x-P.x),y)._round()),k&&P.equals(k[k.length-1])||b.push(k=[P]),k.push(O)))))}return b}function OT(s,l,u,m){var y=[],b=s.image,E=b.pixelRatio,S=b.paddedRect.w-2,k=b.paddedRect.h-2,M=s.right-s.left,P=s.bottom-s.top,O=b.stretchX||[[0,S]],V=b.stretchY||[[0,k]],$=function(Cn,At){return Cn+At[1]-At[0]},ee=O.reduce($,0),Q=V.reduce($,0),pe=S-ee,he=k-Q,ve=0,ye=ee,Ie=0,ke=Q,Oe=0,Ye=pe,nt=0,yt=he;if(b.content&&m){var it=b.content;ve=Jg(O,0,it[0]),Ie=Jg(V,0,it[1]),ye=Jg(O,it[0],it[2]),ke=Jg(V,it[1],it[3]),Oe=it[0]-ve,nt=it[1]-Ie,Ye=it[2]-it[0]-ye,yt=it[3]-it[1]-ke}var kt=function(Cn,At,kn,br){var zr=_v(Cn.stretch-ve,ye,M,s.left),Pr=yv(Cn.fixed-Oe,Ye,Cn.stretch,ee),wr=_v(At.stretch-Ie,ke,P,s.top),Gr=yv(At.fixed-nt,yt,At.stretch,Q),Mi=_v(kn.stretch-ve,ye,M,s.left),Ri=yv(kn.fixed-Oe,Ye,kn.stretch,ee),Uo=_v(br.stretch-Ie,ke,P,s.top),Xi=yv(br.fixed-nt,yt,br.stretch,Q),jo=new Gt(zr,wr),ti=new Gt(Mi,wr),Pi=new Gt(Mi,Uo),bn=new Gt(zr,Uo),or=new Gt(Pr/E,Gr/E),Xn=new Gt(Ri/E,Xi/E),An=l*Math.PI/180;if(An){var Co=Math.sin(An),Do=Math.cos(An),Qn=[Do,-Co,Co,Do];jo._matMult(Qn),ti._matMult(Qn),bn._matMult(Qn),Pi._matMult(Qn)}var xr=Cn.stretch+Cn.fixed,To=At.stretch+At.fixed;return{tl:jo,tr:ti,bl:bn,br:Pi,tex:{x:b.paddedRect.x+1+xr,y:b.paddedRect.y+1+To,w:kn.stretch+kn.fixed-xr,h:br.stretch+br.fixed-To},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:or,pixelOffsetBR:Xn,minFontScaleX:Ye/E/M,minFontScaleY:yt/E/P,isSDF:u}};if(m&&(b.stretchX||b.stretchY))for(var ot=dx(O,pe,ee),hn=dx(V,he,Q),Vt=0;Vt<ot.length-1;Vt++)for(var gt=ot[Vt],_n=ot[Vt+1],rn=0;rn<hn.length-1;rn++)y.push(kt(gt,hn[rn],_n,hn[rn+1]));else y.push(kt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:k+1}));return y}function Jg(s,l,u){for(var m=0,y=0,b=s;y<b.length;y+=1){var E=b[y];m+=Math.max(l,Math.min(u,E[1]))-Math.max(l,Math.min(u,E[0]))}return m}function dx(s,l,u){for(var m=[{fixed:-1,stretch:0}],y=0,b=s;y<b.length;y+=1){var E=b[y],S=E[0],k=E[1],M=m[m.length-1];m.push({fixed:S-M.stretch,stretch:M.stretch}),m.push({fixed:S-M.stretch,stretch:M.stretch+(k-S)})}return m.push({fixed:l+1,stretch:u}),m}function _v(s,l,u,m){return s/l*u+m}function yv(s,l,u,m){return s-l*u/m}var e_=function(s,l,u,m,y,b,E,S,k,M){if(this.boxStartIndex=s.length,k){var P=b.top,O=b.bottom,V=b.collisionPadding;V&&(P-=V[1],O+=V[3]);var $=O-P;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{var ee=b.top*E-S,Q=b.bottom*E+S,pe=b.left*E-S,he=b.right*E+S,ve=b.collisionPadding;if(ve&&(pe-=ve[0]*E,ee-=ve[1]*E,he+=ve[2]*E,Q+=ve[3]*E),M){var ye=new Gt(pe,ee),Ie=new Gt(he,ee),ke=new Gt(pe,Q),Oe=new Gt(he,Q),Ye=M*Math.PI/180;ye._rotate(Ye),Ie._rotate(Ye),ke._rotate(Ye),Oe._rotate(Ye),pe=Math.min(ye.x,Ie.x,ke.x,Oe.x),he=Math.max(ye.x,Ie.x,ke.x,Oe.x),ee=Math.min(ye.y,Ie.y,ke.y,Oe.y),Q=Math.max(ye.y,Ie.y,ke.y,Oe.y)}s.emplaceBack(l.x,l.y,pe,ee,he,Q,u,m,y)}this.boxEndIndex=s.length},nd=function(s,l){if(void 0===s&&(s=[]),void 0===l&&(l=hx),this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function hx(s,l){return s<l?-1:s>l?1:0}function Of(s,l,u){void 0===l&&(l=1),void 0===u&&(u=!1);for(var m=1/0,y=1/0,b=-1/0,E=-1/0,S=s[0],k=0;k<S.length;k++){var M=S[k];(!k||M.x<m)&&(m=M.x),(!k||M.y<y)&&(y=M.y),(!k||M.x>b)&&(b=M.x),(!k||M.y>E)&&(E=M.y)}var P=Math.min(b-m,E-y),O=P/2,V=new nd([],fx);if(0===P)return new Gt(m,y);for(var $=m;$<b;$+=P)for(var ee=y;ee<E;ee+=P)V.push(new rd($+O,ee+O,O,s));for(var Q=function(ve){for(var ye=0,Ie=0,ke=0,Oe=ve[0],Ye=0,nt=Oe.length,yt=nt-1;Ye<nt;yt=Ye++){var it=Oe[Ye],kt=Oe[yt],ot=it.x*kt.y-kt.x*it.y;Ie+=(it.x+kt.x)*ot,ke+=(it.y+kt.y)*ot,ye+=3*ot}return new rd(Ie/ye,ke/ye,0,ve)}(s),pe=V.length;V.length;){var he=V.pop();(he.d>Q.d||!Q.d)&&(Q=he,u&&console.log("found best %d after %d probes",Math.round(1e4*he.d)/1e4,pe)),he.max-Q.d<=l||(V.push(new rd(he.p.x-(O=he.h/2),he.p.y-O,O,s)),V.push(new rd(he.p.x+O,he.p.y-O,O,s)),V.push(new rd(he.p.x-O,he.p.y+O,O,s)),V.push(new rd(he.p.x+O,he.p.y+O,O,s)),pe+=4)}return u&&(console.log("num probes: "+pe),console.log("best distance: "+Q.d)),Q.p}function fx(s,l){return l.max-s.max}function rd(s,l,u,m){this.p=new Gt(s,l),this.h=u,this.d=function(y,b){for(var E=!1,S=1/0,k=0;k<b.length;k++)for(var M=b[k],P=0,O=M.length,V=O-1;P<O;V=P++){var $=M[P],ee=M[V];$.y>y.y!=ee.y>y.y&&y.x<(ee.x-$.x)*(y.y-$.y)/(ee.y-$.y)+$.x&&(E=!E),S=Math.min(S,Ns(y,$,ee))}return(E?1:-1)*Math.sqrt(S)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}nd.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},nd.prototype.pop=function(){if(0!==this.length){var s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}},nd.prototype.peek=function(){return this.data[0]},nd.prototype._up=function(s){for(var l=this.data,u=this.compare,m=l[s];s>0;){var y=s-1>>1,b=l[y];if(u(m,b)>=0)break;l[s]=b,s=y}l[s]=m},nd.prototype._down=function(s){for(var l=this.data,u=this.compare,m=this.length>>1,y=l[s];s<m;){var b=1+(s<<1),E=l[b],S=b+1;if(S<this.length&&u(l[S],E)<0&&(b=S,E=l[S]),u(E,y)>=0)break;l[s]=E,s=b}l[s]=y};var oh=Number.POSITIVE_INFINITY;function px(s,l){return l[1]!==oh?function(u,m,y){var b=0,E=0;switch(m=Math.abs(m),y=Math.abs(y),u){case"top-right":case"top-left":case"top":E=y-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-y}switch(u){case"top-right":case"bottom-right":case"right":b=-m;break;case"top-left":case"bottom-left":case"left":b=m}return[b,E]}(s,l[0],l[1]):function(u,m){var y=0,b=0;m<0&&(m=0);var E=m/Math.sqrt(2);switch(u){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-m;break;case"top":b=m-7}switch(u){case"top-right":case"bottom-right":y=-E;break;case"top-left":case"bottom-left":y=E;break;case"left":y=m;break;case"right":y=-m}return[y,b]}(s,l[0])}function sh(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function t_(s,l,u,m,y,b,E,S,k,M,P,O,V,$,ee){var Q=function(Ie,ke,Oe,Ye,nt,yt,it,kt){for(var ot=Ye.layout.get("text-rotate").evaluate(yt,{})*Math.PI/180,hn=[],Vt=0,gt=ke.positionedLines;Vt<gt.length;Vt+=1)for(var _n=gt[Vt],rn=0,Cn=_n.positionedGlyphs;rn<Cn.length;rn+=1){var At=Cn[rn];if(At.rect){var kn=At.rect||{},br=4,zr=!0,Pr=1,wr=0,Gr=(nt||kt)&&At.vertical,Mi=At.metrics.advance*At.scale/2;if(kt&&ke.verticalizable&&(wr=_n.lineOffset/2-(At.imageName?-(24-At.metrics.width*At.scale)/2:24*(At.scale-1))),At.imageName){var Ri=it[At.imageName];zr=Ri.sdf,br=1/(Pr=Ri.pixelRatio)}var Uo=nt?[At.x+Mi,At.y]:[0,0],Xi=nt?[0,0]:[At.x+Mi+Oe[0],At.y+Oe[1]-wr],jo=[0,0];Gr&&(jo=Xi,Xi=[0,0]);var ti=(At.metrics.left-br)*At.scale-Mi+Xi[0],Pi=(-At.metrics.top-br)*At.scale+Xi[1],bn=ti+kn.w*At.scale/Pr,or=Pi+kn.h*At.scale/Pr,Xn=new Gt(ti,Pi),An=new Gt(bn,Pi),Co=new Gt(ti,or),Do=new Gt(bn,or);if(Gr){var Qn=new Gt(-Mi,Mi- -17),xr=-Math.PI/2,To=12-Mi,Vn=new Gt(22-To,-(At.imageName?To:0)),Dl=new(Function.prototype.bind.apply(Gt,[null].concat(jo)));Xn._rotateAround(xr,Qn)._add(Vn)._add(Dl),An._rotateAround(xr,Qn)._add(Vn)._add(Dl),Co._rotateAround(xr,Qn)._add(Vn)._add(Dl),Do._rotateAround(xr,Qn)._add(Vn)._add(Dl)}if(ot){var ps=Math.sin(ot),ha=Math.cos(ot),Ur=[ha,-ps,ps,ha];Xn._matMult(Ur),An._matMult(Ur),Co._matMult(Ur),Do._matMult(Ur)}var fc=new Gt(0,0),Ga=new Gt(0,0);hn.push({tl:Xn,tr:An,bl:Co,br:Do,tex:kn,writingMode:ke.writingMode,glyphOffset:Uo,sectionIndex:At.sectionIndex,isSDF:zr,pixelOffsetTL:fc,pixelOffsetBR:Ga,minFontScaleX:0,minFontScaleY:0})}}return hn}(0,u,S,y,b,E,m,s.allowVerticalPlacement),pe=s.textSizeData,he=null;"source"===pe.kind?(he=[128*y.layout.get("text-size").evaluate(E,{})])[0]>32640&&fr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===pe.kind&&((he=[128*$.compositeTextSizes[0].evaluate(E,{},ee),128*$.compositeTextSizes[1].evaluate(E,{},ee)])[0]>32640||he[1]>32640)&&fr(s.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),s.addSymbols(s.text,Q,he,S,b,E,M,l,k.lineStartIndex,k.lineLength,V,ee);for(var ve=0,ye=P;ve<ye.length;ve+=1)O[ye[ve]]=s.text.placedSymbolArray.length-1;return 4*Q.length}function om(s){for(var l in s)return s[l];return null}function mO(s,l,u,m){var y=s.compareText;if(l in y){for(var b=y[l],E=b.length-1;E>=0;E--)if(m.dist(b[E])<u)return!0}else y[l]=[];return y[l].push(m),!1}var mx=tm.VectorTileFeature.types,gx=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function n_(s,l,u,m,y,b,E,S,k,M,P,O,V){var $=S?Math.min(32640,Math.round(S[0])):0,ee=S?Math.min(32640,Math.round(S[1])):0;s.emplaceBack(l,u,Math.round(32*m),Math.round(32*y),b,E,($<<1)+(k?1:0),ee,16*M,16*P,256*O,256*V)}function qa(s,l,u){s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u),s.emplaceBack(l.x,l.y,u)}function LT(s){for(var l=0,u=s.sections;l<u.length;l+=1)if($i(u[l].text))return!0;return!1}var eu=function(s){this.layoutVertexArray=new Yd,this.indexArray=new Gs,this.programConfigurations=s,this.segments=new H,this.dynamicLayoutVertexArray=new Ps,this.opacityVertexArray=new Cf,this.placedSymbolArray=new w};eu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},eu.prototype.upload=function(s,l,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rx.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,vr.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,gx,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(s))},eu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},st("SymbolBuffers",eu);var ah=function(s,l,u){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new u,this.segments=new H,this.collisionVertexArray=new Vg};ah.prototype.upload=function(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,ix.members,!0)},ah.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},st("CollisionBuffers",ah);var Yn=function(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(function(b){return b.id}),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Br([]),this.placementViewportMatrix=Br([]);var l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qg(this.zoom,l["text-size"]),this.iconSizeData=Qg(this.zoom,l["icon-size"]);var u=this.layers[0].layout,m=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===u.get("symbol-placement")&&(this.writingModes=u.get("text-writing-mode").map(function(b){return Zs[b]})),this.stateDependentLayerIds=this.layers.filter(function(b){return b.isStateDependent()}).map(function(b){return b.id}),this.sourceID=s.sourceID};Yn.prototype.createArrays=function(){this.text=new eu(new rr(this.layers,this.zoom,function(s){return/^text/.test(s)})),this.icon=new eu(new rr(this.layers,this.zoom,function(s){return/^icon/.test(s)})),this.glyphOffsetArray=new I,this.lineVertexArray=new R,this.symbolInstances=new T},Yn.prototype.calculateGlyphDependencies=function(s,l,u,m,y){for(var b=0;b<s.length;b++)if(l[s.charCodeAt(b)]=!0,(u||m)&&y){var E=si[s.charAt(b)];E&&(l[E.charCodeAt(0)]=!0)}},Yn.prototype.populate=function(s,l,u){var m=this.layers[0],y=m.layout,b=y.get("text-font"),E=y.get("text-field"),S=y.get("icon-image"),k=("constant"!==E.value.kind||E.value.value instanceof ii&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),M="constant"!==S.value.kind||!!S.value.value||Object.keys(S.parameters).length>0,P=y.get("symbol-sort-key");if(this.features=[],k||M){for(var O=l.iconDependencies,V=l.glyphDependencies,$=l.availableImages,ee=new Kt(this.zoom),Q=0,pe=s;Q<pe.length;Q+=1){var he=pe[Q],ve=he.feature,ye=he.id,Ie=he.index,ke=he.sourceLayerIndex,Oe=m._featureFilter.needGeometry,Ye=Fo(ve,Oe);if(m._featureFilter.filter(ee,Ye,u)){Oe||(Ye.geometry=Jr(ve));var nt=void 0;if(k){var yt=m.getValueAndResolveTokens("text-field",Ye,u,$),it=ii.factory(yt);LT(it)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===_o()||this.hasRTLText&&nr.isParsed())&&(nt=Vo(it,m,Ye))}var kt=void 0;if(M){var ot=m.getValueAndResolveTokens("icon-image",Ye,u,$);kt=ot instanceof Dr?ot:Dr.fromString(ot)}if(nt||kt){var hn=this.sortFeaturesByKey?P.evaluate(Ye,{},u):void 0;if(this.features.push({id:ye,text:nt,icon:kt,index:Ie,sourceLayerIndex:ke,geometry:Ye.geometry,properties:ve.properties,type:mx[ve.type],sortKey:hn}),kt&&(O[kt.name]=!0),nt){var Vt=b.evaluate(Ye,{},u).join(","),gt="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Zs.vertical)>=0;for(var _n=0,rn=nt.sections;_n<rn.length;_n+=1){var Cn=rn[_n];if(Cn.image)O[Cn.image.name]=!0;else{var At=Qr(nt.toString()),kn=Cn.fontStack||Vt,br=V[kn]=V[kn]||{};this.calculateGlyphDependencies(Cn.text,br,gt,this.allowVerticalPlacement,At)}}}}}}"line"===y.get("symbol-placement")&&(this.features=function(zr){var Pr={},wr={},Gr=[],Mi=0;function Ri(Qn){Gr.push(zr[Qn]),Mi++}function Uo(Qn,xr,To){var Vn=wr[Qn];return delete wr[Qn],wr[xr]=Vn,Gr[Vn].geometry[0].pop(),Gr[Vn].geometry[0]=Gr[Vn].geometry[0].concat(To[0]),Vn}function Xi(Qn,xr,To){var Vn=Pr[xr];return delete Pr[xr],Pr[Qn]=Vn,Gr[Vn].geometry[0].shift(),Gr[Vn].geometry[0]=To[0].concat(Gr[Vn].geometry[0]),Vn}function jo(Qn,xr,To){var Vn=To?xr[0][xr[0].length-1]:xr[0][0];return Qn+":"+Vn.x+":"+Vn.y}for(var ti=0;ti<zr.length;ti++){var Pi=zr[ti],bn=Pi.geometry,or=Pi.text?Pi.text.toString():null;if(or){var Xn=jo(or,bn),An=jo(or,bn,!0);if(Xn in wr&&An in Pr&&wr[Xn]!==Pr[An]){var Co=Xi(Xn,An,bn),Do=Uo(Xn,An,Gr[Co].geometry);delete Pr[Xn],delete wr[An],wr[jo(or,Gr[Do].geometry,!0)]=Do,Gr[Co].geometry=null}else Xn in wr?Uo(Xn,An,bn):An in Pr?Xi(Xn,An,bn):(Ri(ti),Pr[Xn]=Mi-1,wr[An]=Mi-1)}else Ri(ti)}return Gr.filter(function(Qn){return Qn.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(zr,Pr){return zr.sortKey-Pr.sortKey})}},Yn.prototype.update=function(s,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,u),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,u))},Yn.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Yn.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yn.prototype.upload=function(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yn.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yn.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yn.prototype.addToLineVertexArray=function(s,l){var u=this.lineVertexArray.length;if(void 0!==s.segment){for(var m=s.dist(l[s.segment+1]),y=s.dist(l[s.segment]),b={},E=s.segment+1;E<l.length;E++)b[E]={x:l[E].x,y:l[E].y,tileUnitDistanceFromAnchor:m},E<l.length-1&&(m+=l[E+1].dist(l[E]));for(var S=s.segment||0;S>=0;S--)b[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=l[S-1].dist(l[S]));for(var k=0;k<l.length;k++){var M=b[k];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}},Yn.prototype.addSymbols=function(s,l,u,m,y,b,E,S,k,M,P,O){for(var V=s.indexArray,$=s.layoutVertexArray,ee=s.segments.prepareSegment(4*l.length,$,V,this.canOverlap?b.sortKey:void 0),Q=this.glyphOffsetArray.length,pe=ee.vertexLength,he=this.allowVerticalPlacement&&E===Zs.vertical?Math.PI/2:0,ve=b.text&&b.text.sections,ye=0;ye<l.length;ye++){var Ie=l[ye],ke=Ie.tl,Oe=Ie.tr,Ye=Ie.bl,nt=Ie.br,yt=Ie.tex,it=Ie.pixelOffsetTL,kt=Ie.pixelOffsetBR,ot=Ie.minFontScaleX,hn=Ie.minFontScaleY,Vt=Ie.glyphOffset,gt=Ie.isSDF,_n=Ie.sectionIndex,rn=ee.vertexLength,Cn=Vt[1];n_($,S.x,S.y,ke.x,Cn+ke.y,yt.x,yt.y,u,gt,it.x,it.y,ot,hn),n_($,S.x,S.y,Oe.x,Cn+Oe.y,yt.x+yt.w,yt.y,u,gt,kt.x,it.y,ot,hn),n_($,S.x,S.y,Ye.x,Cn+Ye.y,yt.x,yt.y+yt.h,u,gt,it.x,kt.y,ot,hn),n_($,S.x,S.y,nt.x,Cn+nt.y,yt.x+yt.w,yt.y+yt.h,u,gt,kt.x,kt.y,ot,hn),qa(s.dynamicLayoutVertexArray,S,he),V.emplaceBack(rn,rn+1,rn+2),V.emplaceBack(rn+1,rn+2,rn+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vt[0]),ye!==l.length-1&&_n===l[ye+1].sectionIndex||s.programConfigurations.populatePaintArrays($.length,b,b.index,{},O,ve&&ve[_n])}s.placedSymbolArray.emplaceBack(S.x,S.y,Q,this.glyphOffsetArray.length-Q,pe,k,M,S.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],E,0,!1,0,P)},Yn.prototype._addCollisionDebugVertex=function(s,l,u,m,y,b){return l.emplaceBack(0,0),s.emplaceBack(u.x,u.y,m,y,Math.round(b.x),Math.round(b.y))},Yn.prototype.addCollisionDebugVertices=function(s,l,u,m,y,b,E){var S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=S.vertexLength,M=y.layoutVertexArray,P=y.collisionVertexArray,O=E.anchorX,V=E.anchorY;this._addCollisionDebugVertex(M,P,b,O,V,new Gt(s,l)),this._addCollisionDebugVertex(M,P,b,O,V,new Gt(u,l)),this._addCollisionDebugVertex(M,P,b,O,V,new Gt(u,m)),this._addCollisionDebugVertex(M,P,b,O,V,new Gt(s,m)),S.vertexLength+=4;var $=y.indexArray;$.emplaceBack(k,k+1),$.emplaceBack(k+1,k+2),$.emplaceBack(k+2,k+3),$.emplaceBack(k+3,k),S.primitiveLength+=4},Yn.prototype.addDebugCollisionBoxes=function(s,l,u,m){for(var y=s;y<l;y++){var b=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}},Yn.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ah(sc,fe.members,Tf),this.iconCollisionBox=new ah(sc,fe.members,Tf);for(var s=0;s<this.symbolInstances.length;s++){var l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}},Yn.prototype._deserializeCollisionBoxesForSymbol=function(s,l,u,m,y,b,E,S,k){for(var M={},P=l;P<u;P++){var O=s.get(P);M.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},M.textFeatureIndex=O.featureIndex;break}for(var V=m;V<y;V++){var $=s.get(V);M.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},M.verticalTextFeatureIndex=$.featureIndex;break}for(var ee=b;ee<E;ee++){var Q=s.get(ee);M.iconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},M.iconFeatureIndex=Q.featureIndex;break}for(var pe=S;pe<k;pe++){var he=s.get(pe);M.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},M.verticalIconFeatureIndex=he.featureIndex;break}return M},Yn.prototype.deserializeCollisionBoxes=function(s){this.collisionArrays=[];for(var l=0;l<this.symbolInstances.length;l++){var u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}},Yn.prototype.hasTextData=function(){return this.text.segments.get().length>0},Yn.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Yn.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yn.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Yn.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Yn.prototype.addIndicesForPlacedSymbol=function(s,l){for(var u=s.placedSymbolArray.get(l),m=u.vertexStartIndex+4*u.numGlyphs,y=u.vertexStartIndex;y<m;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)},Yn.prototype.getSortedSymbolIndexes=function(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var l=Math.sin(s),u=Math.cos(s),m=[],y=[],b=[],E=0;E<this.symbolInstances.length;++E){b.push(E);var S=this.symbolInstances.get(E);m.push(0|Math.round(l*S.anchorX+u*S.anchorY)),y.push(S.featureIndex)}return b.sort(function(k,M){return m[k]-m[M]||y[M]-y[k]}),b},Yn.prototype.addToSortKeyRanges=function(s,l){var u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})},Yn.prototype.sortFeatures=function(s){var l=this;if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var u=0,m=this.symbolInstanceIndexes;u<m.length;u+=1){var y=this.symbolInstances.get(m[u]);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(function(b,E,S){b>=0&&S.indexOf(b)===E&&l.addIndicesForPlacedSymbol(l.text,b)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},st("SymbolBucket",Yn,{omit:["layers","collisionBoxArray","features","compareText"]}),Yn.MAX_GLYPHS=65535,Yn.addDynamicAttributes=qa;var r_=new _i({"symbol-placement":new tt(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(Z.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new tt(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(Z.layout_symbol["icon-size"]),"icon-text-fit":new tt(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(Z.layout_symbol["icon-image"]),"icon-rotate":new Nt(Z.layout_symbol["icon-rotate"]),"icon-padding":new tt(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(Z.layout_symbol["icon-offset"]),"icon-anchor":new Nt(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(Z.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(Z.layout_symbol["text-field"]),"text-font":new Nt(Z.layout_symbol["text-font"]),"text-size":new Nt(Z.layout_symbol["text-size"]),"text-max-width":new Nt(Z.layout_symbol["text-max-width"]),"text-line-height":new tt(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(Z.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(Z.layout_symbol["text-justify"]),"text-radial-offset":new Nt(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(Z.layout_symbol["text-variable-anchor"]),"text-anchor":new Nt(Z.layout_symbol["text-anchor"]),"text-max-angle":new tt(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(Z.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(Z.layout_symbol["text-rotate"]),"text-padding":new tt(Z.layout_symbol["text-padding"]),"text-keep-upright":new tt(Z.layout_symbol["text-keep-upright"]),"text-transform":new Nt(Z.layout_symbol["text-transform"]),"text-offset":new Nt(Z.layout_symbol["text-offset"]),"text-allow-overlap":new tt(Z.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new tt(Z.layout_symbol["text-ignore-placement"]),"text-optional":new tt(Z.layout_symbol["text-optional"])}),sm={paint:new _i({"icon-opacity":new Nt(Z.paint_symbol["icon-opacity"]),"icon-color":new Nt(Z.paint_symbol["icon-color"]),"icon-halo-color":new Nt(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(Z.paint_symbol["text-opacity"]),"text-color":new Nt(Z.paint_symbol["text-color"],{runtimeType:Jt,getOverride:function(s){return s.textColor},hasOverride:function(s){return!!s.textColor}}),"text-halo-color":new Nt(Z.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(Z.paint_symbol["text-halo-blur"]),"text-translate":new tt(Z.paint_symbol["text-translate"]),"text-translate-anchor":new tt(Z.paint_symbol["text-translate-anchor"])}),layout:r_},Lf=function(s){this.type=s.property.overrides?s.property.overrides.runtimeType:xt,this.defaultValue=s};Lf.prototype.evaluate=function(s){if(s.formattedSection){var l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default},Lf.prototype.eachChild=function(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)},Lf.prototype.outputDefined=function(){return!1},Lf.prototype.serialize=function(){return null},st("FormatSectionOverride",Lf,{omit:["defaultValue"]});var _x=function(s){function l(u){s.call(this,u,sm)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.recalculate=function(u,m){if(s.prototype.recalculate.call(this,u,m),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var y=this.layout.get("text-writing-mode");if(y){for(var b=[],E=0,S=y;E<S.length;E+=1){var k=S[E];b.indexOf(k)<0&&b.push(k)}this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},l.prototype.getValueAndResolveTokens=function(u,m,y,b){var k,E=this.layout.get(u).evaluate(m,{},y,b),S=this._unevaluatedLayout._values[u];return S.isDataDriven()||gf(S.value)||!E?E:(k=m.properties,E.replace(/{([^{}]+)}/g,function(P,O){return O in k?String(k[O]):""}))},l.prototype.createBucket=function(u){return new Yn(u)},l.prototype.queryRadius=function(){return 0},l.prototype.queryIntersectsFeature=function(){return!1},l.prototype._setPaintOverrides=function(){for(var u=0,m=sm.paint.overridableProperties;u<m.length;u+=1){var y=m[u];if(l.hasPaintOverride(this.layout,y)){var b,E=this.paint.get(y),S=new Lf(E),k=new Fa(S,E.property.specification);b="constant"===E.value.kind||"source"===E.value.kind?new qd("source",k):new mo("composite",k,E.value.zoomStops,E.value._interpolationType),this.paint._values[y]=new Qo(E.property,b,E.parameters)}}},l.prototype._handleOverridablePaintPropertyUpdate=function(u,m,y){return!(!this.layout||m.isDataDriven()||y.isDataDriven())&&l.hasPaintOverride(this.layout,u)},l.hasPaintOverride=function(u,m){var y=u.get("text-field"),b=sm.paint.properties[m],E=!1,S=function(P){for(var O=0,V=P;O<V.length;O+=1)if(b.overrides&&b.overrides.hasOverride(V[O]))return void(E=!0)};if("constant"===y.value.kind&&y.value.value instanceof ii)S(y.value.value.sections);else if("source"===y.value.kind){var k=function(P){E||(P instanceof na&&zi(P.value)===jt?S(P.value.sections):P instanceof os?S(P.sections):P.eachChild(k))},M=y.value;M._styleExpression&&k(M._styleExpression.expression)}return E},l}(ki),yx={paint:new _i({"background-color":new tt(Z.paint_background["background-color"]),"background-pattern":new Ot(Z.paint_background["background-pattern"]),"background-opacity":new tt(Z.paint_background["background-opacity"])})},vx=function(s){function l(u){s.call(this,u,yx)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(ki),bx={paint:new _i({"raster-opacity":new tt(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(Z.paint_raster["raster-saturation"]),"raster-contrast":new tt(Z.paint_raster["raster-contrast"]),"raster-resampling":new tt(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(Z.paint_raster["raster-fade-duration"])})},FT=function(s){function l(u){s.call(this,u,bx)}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l}(ki),i_=function(s){function l(u){s.call(this,u,{}),this.implementation=u}return s&&(l.__proto__=s),(l.prototype=Object.create(s&&s.prototype)).constructor=l,l.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},l.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},l.prototype.recalculate=function(){},l.prototype.updateTransitions=function(){},l.prototype.hasTransition=function(){},l.prototype.serialize=function(){},l.prototype.onAdd=function(u){this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},l.prototype.onRemove=function(u){this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},l}(ki),gO={circle:Xd,heatmap:Bw,hillshade:zw,fill:Gw,"fill-extrusion":Af,line:CT,symbol:_x,background:vx,raster:FT},Ff=_t.HTMLImageElement,wx=_t.HTMLCanvasElement,vv=_t.HTMLVideoElement,bv=_t.ImageData,Cl=_t.ImageBitmap,da=function(s,l,u,m){this.context=s,this.format=u,this.texture=s.gl.createTexture(),this.update(l,m)};da.prototype.update=function(s,l,u){var m=s.width,y=s.height,b=!(this.size&&this.size[0]===m&&this.size[1]===y||u),E=this.context,S=E.gl;if(this.useMipmap=!(!l||!l.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!l||!1!==l.premultiply)),b)this.size=[m,y],s instanceof Ff||s instanceof wx||s instanceof vv||s instanceof bv||Cl&&s instanceof Cl?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,s):S.texImage2D(S.TEXTURE_2D,0,this.format,m,y,0,this.format,S.UNSIGNED_BYTE,s.data);else{var k=u||{x:0,y:0},M=k.x,P=k.y;s instanceof Ff||s instanceof wx||s instanceof vv||s instanceof bv||Cl&&s instanceof Cl?S.texSubImage2D(S.TEXTURE_2D,0,M,P,S.RGBA,S.UNSIGNED_BYTE,s):S.texSubImage2D(S.TEXTURE_2D,0,M,P,m,y,S.RGBA,S.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},da.prototype.bind=function(s,l,u){var m=this.context.gl;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||s),this.filter=s),l!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,l),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,l),this.wrap=l)},da.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},da.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ai=function(s){var l=this;this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){l._triggered=!1,l._callback()})};ai.prototype.trigger=function(){var s=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){s._triggered=!1,s._callback()},0))},ai.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Bf=function(s,l,u){this.target=s,this.parent=l,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Da(["receive","process"],this),this.invoker=new ai(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Cs()?s:_t};function qr(s,l,u){var m=2*Math.PI*6378137/256/Math.pow(2,u);return[s*m-2*Math.PI*6378137/2,l*m-2*Math.PI*6378137/2]}Bf.prototype.send=function(s,l,u,m,y){var b=this;void 0===y&&(y=!1);var E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[E]=u);var S=Ta(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:s,hasCallback:!!u,targetMapId:m,mustQueue:y,sourceMapId:this.mapId,data:Lo(l,S)},S),{cancel:function(){u&&delete b.callbacks[E],b.target.postMessage({id:E,type:"<cancel>",targetMapId:m,sourceMapId:b.mapId})}}},Bf.prototype.receive=function(s){var l=s.data,u=l.id;if(u&&(!l.targetMapId||this.mapId===l.targetMapId))if("<cancel>"===l.type){delete this.tasks[u];var m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m()}else Cs()||l.mustQueue?(this.tasks[u]=l,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,l)},Bf.prototype.process=function(){if(this.taskQueue.length){var s=this.taskQueue.shift(),l=this.tasks[s];delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),l&&this.processTask(s,l)}},Bf.prototype.processTask=function(s,l){var u=this;if("<response>"===l.type){var m=this.callbacks[s];delete this.callbacks[s],m&&(l.error?m(ji(l.error)):m(null,ji(l.data)))}else{var y=!1,b=Ta(this.globalScope)?void 0:[],E=l.hasCallback?function(P,O){y=!0,delete u.cancelCallbacks[s],u.target.postMessage({id:s,type:"<response>",sourceMapId:u.mapId,error:P?Lo(P):null,data:Lo(O,b)},b)}:function(P){y=!0},S=null,k=ji(l.data);if(this.parent[l.type])S=this.parent[l.type](l.sourceMapId,k,E);else if(this.parent.getWorkerSource){var M=l.type.split(".");S=this.parent.getWorkerSource(l.sourceMapId,M[0],k.source)[M[1]](k,E)}else E(new Error("Could not find function "+l.type));!y&&S&&S.cancel&&(this.cancelCallbacks[s]=S.cancel)}},Bf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ei=function(s,l){s&&(l?this.setSouthWest(s).setNorthEast(l):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))};ei.prototype.setNorthEast=function(s){return this._ne=s instanceof Tr?new Tr(s.lng,s.lat):Tr.convert(s),this},ei.prototype.setSouthWest=function(s){return this._sw=s instanceof Tr?new Tr(s.lng,s.lat):Tr.convert(s),this},ei.prototype.extend=function(s){var l,u,m=this._sw,y=this._ne;if(s instanceof Tr)l=s,u=s;else{if(!(s instanceof ei))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(ei.convert(s)):this.extend(Tr.convert(s)):this;if(u=s._ne,!(l=s._sw)||!u)return this}return m||y?(m.lng=Math.min(l.lng,m.lng),m.lat=Math.min(l.lat,m.lat),y.lng=Math.max(u.lng,y.lng),y.lat=Math.max(u.lat,y.lat)):(this._sw=new Tr(l.lng,l.lat),this._ne=new Tr(u.lng,u.lat)),this},ei.prototype.getCenter=function(){return new Tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ei.prototype.getSouthWest=function(){return this._sw},ei.prototype.getNorthEast=function(){return this._ne},ei.prototype.getNorthWest=function(){return new Tr(this.getWest(),this.getNorth())},ei.prototype.getSouthEast=function(){return new Tr(this.getEast(),this.getSouth())},ei.prototype.getWest=function(){return this._sw.lng},ei.prototype.getSouth=function(){return this._sw.lat},ei.prototype.getEast=function(){return this._ne.lng},ei.prototype.getNorth=function(){return this._ne.lat},ei.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ei.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ei.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ei.prototype.contains=function(s){var l=Tr.convert(s),u=l.lng,m=l.lat,y=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&y},ei.convert=function(s){return!s||s instanceof ei?s:new ei(s)};var Tr=function(s,l){if(isNaN(s)||isNaN(l))throw new Error("Invalid LngLat object: ("+s+", "+l+")");if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Tr.prototype.wrap=function(){return new Tr(Su(this.lng,-180,180),this.lat)},Tr.prototype.toArray=function(){return[this.lng,this.lat]},Tr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Tr.prototype.distanceTo=function(s){var l=Math.PI/180,u=this.lat*l,m=s.lat*l,y=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((s.lng-this.lng)*l);return 6371008.8*Math.acos(Math.min(y,1))},Tr.prototype.toBounds=function(s){void 0===s&&(s=0);var l=360*s/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new ei(new Tr(this.lng-u,this.lat-l),new Tr(this.lng+u,this.lat+l))},Tr.convert=function(s){if(s instanceof Tr)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new Tr(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new Tr(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var wv=2*Math.PI*6371008.8;function Vf(s){return wv*Math.cos(s*Math.PI/180)}function xx(s){return(180+s)/360}function xv(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function o_(s,l){return s/Vf(l)}function zf(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}var id=function(s,l,u){void 0===u&&(u=0),this.x=+s,this.y=+l,this.z=+u};id.fromLngLat=function(s,l){void 0===l&&(l=0);var u=Tr.convert(s);return new id(xx(u.lng),xv(u.lat),o_(l,u.lat))},id.prototype.toLngLat=function(){return new Tr(360*this.x-180,zf(this.y))},id.prototype.toAltitude=function(){return this.z*Vf(zf(this.y))},id.prototype.meterInMercatorCoordinateUnits=function(){return 1/wv*(s=zf(this.y),1/Math.cos(s*Math.PI/180));var s};var lh=function(s,l,u){this.z=s,this.x=l,this.y=u,this.key=Uf(0,s,s,l,u)};lh.prototype.equals=function(s){return this.z===s.z&&this.x===s.x&&this.y===s.y},lh.prototype.url=function(s,l){var u,m,y,b,E,S=(m=this.y,y=this.z,b=qr(256*(u=this.x),256*(m=Math.pow(2,y)-m-1),y),E=qr(256*(u+1),256*(m+1),y),b[0]+","+b[1]+","+E[0]+","+E[1]),k=function(M,P,O){for(var V,$="",ee=M;ee>0;ee--)$+=(P&(V=1<<ee-1)?1:0)+(O&V?2:0);return $}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",k).replace("{bbox-epsg-3857}",S)},lh.prototype.getTilePoint=function(s){var l=Math.pow(2,this.z);return new Gt(8192*(s.x*l-this.x),8192*(s.y*l-this.y))},lh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Ex=function(s,l){this.wrap=s,this.canonical=l,this.key=Uf(s,l.z,l.z,l.x,l.y)},bi=function(s,l,u,m,y){this.overscaledZ=s,this.wrap=l,this.canonical=new lh(u,+m,+y),this.key=Uf(l,s,u,m,y)};function Uf(s,l,u,m,y){(s*=2)<0&&(s=-1*s-1);var b=1<<u;return(b*b*s+b*y+m).toString(36)+u.toString(36)+l.toString(36)}bi.prototype.equals=function(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)},bi.prototype.scaledTo=function(s){var l=this.canonical.z-s;return s>this.canonical.z?new bi(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bi(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)},bi.prototype.calculateScaledKey=function(s,l){var u=this.canonical.z-s;return s>this.canonical.z?Uf(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):Uf(this.wrap*+l,s,s,this.canonical.x>>u,this.canonical.y>>u)},bi.prototype.isChildOf=function(s){if(s.wrap!==this.wrap)return!1;var l=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l},bi.prototype.children=function(s){if(this.overscaledZ>=s)return[new bi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var l=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new bi(l,this.wrap,l,u,m),new bi(l,this.wrap,l,u+1,m),new bi(l,this.wrap,l,u,m+1),new bi(l,this.wrap,l,u+1,m+1)]},bi.prototype.isLessThan=function(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))},bi.prototype.wrapped=function(){return new bi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},bi.prototype.unwrapTo=function(s){return new bi(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)},bi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},bi.prototype.toUnwrapped=function(){return new Ex(this.wrap,this.canonical)},bi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},bi.prototype.getTilePoint=function(s){return this.canonical.getTilePoint(new id(s.x-this.wrap,s.y))},st("CanonicalTileID",lh),st("OverscaledTileID",bi,{omit:["posMatrix"]});var tu=function(s,l,u){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return fr('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=l.height;var m=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=u||"mapbox";for(var y=0;y<m;y++)this.data[this._idx(-1,y)]=this.data[this._idx(0,y)],this.data[this._idx(m,y)]=this.data[this._idx(m-1,y)],this.data[this._idx(y,-1)]=this.data[this._idx(y,0)],this.data[this._idx(y,m)]=this.data[this._idx(y,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)]};tu.prototype.get=function(s,l){var u=new Uint8Array(this.data.buffer),m=4*this._idx(s,l);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(u[m],u[m+1],u[m+2])},tu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},tu.prototype._idx=function(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)},tu.prototype._unpackMapbox=function(s,l,u){return(256*s*256+256*l+u)/10-1e4},tu.prototype._unpackTerrarium=function(s,l,u){return 256*s+l+u/256-32768},tu.prototype.getPixels=function(){return new hs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},tu.prototype.backfillBorder=function(s,l,u){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");var m=l*this.dim,y=l*this.dim+this.dim,b=u*this.dim,E=u*this.dim+this.dim;switch(l){case-1:m=y-1;break;case 1:y=m+1}switch(u){case-1:b=E-1;break;case 1:E=b+1}for(var S=-l*this.dim,k=-u*this.dim,M=b;M<E;M++)for(var P=m;P<y;P++)this.data[this._idx(P,M)]=s.data[this._idx(P+S,M+k)]},st("DEMData",tu);var am=function(s){this._stringToNumber={},this._numberToString=[];for(var l=0;l<s.length;l++){var u=s[l];this._stringToNumber[u]=l,this._numberToString[l]=u}};am.prototype.encode=function(s){return this._stringToNumber[s]},am.prototype.decode=function(s){return this._numberToString[s]};var s_=function(s,l,u,m,y){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=u,s._y=m,this.properties=s.properties,this.id=y},Ev={geometry:{configurable:!0}};Ev.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ev.geometry.set=function(s){this._geometry=s},s_.prototype.toJSON=function(){var s={geometry:this.geometry};for(var l in this)"_geometry"!==l&&"_vectorTileFeature"!==l&&(s[l]=this[l]);return s},Object.defineProperties(s_.prototype,Ev);var lm=function(){this.state={},this.stateChanges={},this.deletedStates={}};lm.prototype.updateState=function(s,l,u){var m=String(l);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},Fi(this.stateChanges[s][m],u),null===this.deletedStates[s])for(var y in this.deletedStates[s]={},this.state[s])y!==m&&(this.deletedStates[s][y]=null);else if(this.deletedStates[s]&&null===this.deletedStates[s][m])for(var b in this.deletedStates[s][m]={},this.state[s][m])u[b]||(this.deletedStates[s][m][b]=null);else for(var E in u)this.deletedStates[s]&&this.deletedStates[s][m]&&null===this.deletedStates[s][m][E]&&delete this.deletedStates[s][m][E]},lm.prototype.removeFeatureState=function(s,l,u){if(null!==this.deletedStates[s]){var m=String(l);if(this.deletedStates[s]=this.deletedStates[s]||{},u&&void 0!==l)null!==this.deletedStates[s][m]&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][u]=null);else if(void 0!==l)if(this.stateChanges[s]&&this.stateChanges[s][m])for(u in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][u]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}},lm.prototype.getState=function(s,l){var u=String(l),m=Fi({},(this.state[s]||{})[u],(this.stateChanges[s]||{})[u]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){var y=this.deletedStates[s][l];if(null===y)return{};for(var b in y)delete m[b]}return m},lm.prototype.initializeTileState=function(s,l){s.setFeatureState(this.state,l)},lm.prototype.coalesceChanges=function(s,l){var u={};for(var m in this.stateChanges){this.state[m]=this.state[m]||{};var y={};for(var b in this.stateChanges[m])this.state[m][b]||(this.state[m][b]={}),Fi(this.state[m][b],this.stateChanges[m][b]),y[b]=this.state[m][b];u[m]=y}for(var E in this.deletedStates){this.state[E]=this.state[E]||{};var S={};if(null===this.deletedStates[E])for(var k in this.state[E])S[k]={},this.state[E][k]={};else for(var M in this.deletedStates[E]){if(null===this.deletedStates[E][M])this.state[E][M]={};else for(var P=0,O=Object.keys(this.deletedStates[E][M]);P<O.length;P+=1)delete this.state[E][M][O[P]];S[M]=this.state[E][M]}u[E]=u[E]||{},Fi(u[E],S)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(var V in s)s[V].setFeatureState(u,l)};var nu=function(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Ui(8192,16,0),this.grid3D=new Ui(8192,16,0),this.featureIndexArray=new q,this.promoteId=l};function ch(s,l,u,m,y){return Bi(s,function(b,E){var S=l instanceof Rs?l.get(E):null;return S&&S.evaluate?S.evaluate(u,m,y):S})}function Vr(s){for(var l=1/0,u=1/0,m=-1/0,y=-1/0,b=0,E=s;b<E.length;b+=1){var S=E[b];l=Math.min(l,S.x),u=Math.min(u,S.y),m=Math.max(m,S.x),y=Math.max(y,S.y)}return{minX:l,minY:u,maxX:m,maxY:y}}function Cx(s,l){return l-s}nu.prototype.insert=function(s,l,u,m,y,b){var E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,y);for(var S=b?this.grid3D:this.grid,k=0;k<l.length;k++){for(var M=l[k],P=[1/0,1/0,-1/0,-1/0],O=0;O<M.length;O++){var V=M[O];P[0]=Math.min(P[0],V.x),P[1]=Math.min(P[1],V.y),P[2]=Math.max(P[2],V.x),P[3]=Math.max(P[3],V.y)}P[0]<8192&&P[1]<8192&&P[2]>=0&&P[3]>=0&&S.insert(E,P[0],P[1],P[2],P[3])}},nu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new tm.VectorTile(new Jc(this.rawTileData)).layers,this.sourceLayerCoder=new am(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},nu.prototype.query=function(s,l,u,m){var y=this;this.loadVTLayers();for(var b=s.params||{},E=8192/s.tileSize/s.scale,S=As(b.filter),k=s.queryGeometry,M=s.queryPadding*E,P=Vr(k),O=this.grid.query(P.minX-M,P.minY-M,P.maxX+M,P.maxY+M),V=Vr(s.cameraQueryGeometry),ee=0,Q=this.grid3D.query(V.minX-M,V.minY-M,V.maxX+M,V.maxY+M,function(Ie,ke,Oe,Ye){return function(nt,yt,it,kt,ot){for(var hn=0,Vt=nt;hn<Vt.length;hn+=1){var gt=Vt[hn];if(yt<=gt.x&&it<=gt.y&&kt>=gt.x&&ot>=gt.y)return!0}var _n=[new Gt(yt,it),new Gt(yt,ot),new Gt(kt,ot),new Gt(kt,it)];if(nt.length>2)for(var rn=0,Cn=_n;rn<Cn.length;rn+=1)if(ca(nt,Cn[rn]))return!0;for(var At=0;At<nt.length-1;At++)if(Xc(nt[At],nt[At+1],_n))return!0;return!1}(s.cameraQueryGeometry,Ie-M,ke-M,Oe+M,Ye+M)});ee<Q.length;ee+=1)O.push(Q[ee]);O.sort(Cx);for(var pe,he={},ve=function(Ie){var ke=O[Ie];if(ke!==pe){pe=ke;var Oe=y.featureIndexArray.get(ke),Ye=null;y.loadMatchingFeature(he,Oe.bucketIndex,Oe.sourceLayerIndex,Oe.featureIndex,S,b.layers,b.availableImages,l,u,m,function(nt,yt,it){return Ye||(Ye=Jr(nt)),yt.queryIntersectsFeature(k,nt,it,Ye,y.z,s.transform,E,s.pixelPosMatrix)})}},ye=0;ye<O.length;ye++)ve(ye);return he},nu.prototype.loadMatchingFeature=function(s,l,u,m,y,b,E,S,k,M,P){var O=this.bucketLayerIDs[l];if(!b||function(nt,yt){for(var it=0;it<nt.length;it++)if(yt.indexOf(nt[it])>=0)return!0;return!1}(b,O)){var V=this.sourceLayerCoder.decode(u),$=this.vtLayers[V].feature(m);if(y.needGeometry){var ee=Fo($,!0);if(!y.filter(new Kt(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!y.filter(new Kt(this.tileID.overscaledZ),$))return;for(var Q=this.getId($,V),pe=0;pe<O.length;pe++){var he=O[pe];if(!(b&&b.indexOf(he)<0)){var ve=S[he];if(ve){var ye={};void 0!==Q&&M&&(ye=M.getState(ve.sourceLayer||"_geojsonTileLayer",Q));var Ie=Fi({},k[he]);Ie.paint=ch(Ie.paint,ve.paint,$,ye,E),Ie.layout=ch(Ie.layout,ve.layout,$,ye,E);var ke=!P||P($,ve,ye);if(ke){var Oe=new s_($,this.z,this.x,this.y,Q);Oe.layer=Ie;var Ye=s[he];void 0===Ye&&(Ye=s[he]=[]),Ye.push({featureIndex:m,feature:Oe,intersectionZ:ke})}}}}}},nu.prototype.lookupSymbolFeatures=function(s,l,u,m,y,b,E,S){var k={};this.loadVTLayers();for(var M=As(y),P=0,O=s;P<O.length;P+=1)this.loadMatchingFeature(k,u,m,O[P],M,b,E,S,l);return k},nu.prototype.hasLayer=function(s){for(var l=0,u=this.bucketLayerIDs;l<u.length;l+=1)for(var m=0,y=u[l];m<y.length;m+=1)if(s===y[m])return!0;return!1},nu.prototype.getId=function(s,l){var u=s.id;return this.promoteId&&"boolean"==typeof(u=s.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[l]])&&(u=Number(u)),u},st("FeatureIndex",nu,{omit:["rawTileData","sourceLayerCoder"]});var Yi=function(s,l){this.tileID=s,this.uid=ul(),this.uses=0,this.tileSize=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Yi.prototype.registerFadeDuration=function(s){var l=s+this.timeAdded;l<hl.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)},Yi.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Yi.prototype.loadVectorData=function(s,l,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){for(var m in s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(M,P){var O={};if(!P)return O;for(var V=function(){var Q=ee[$],pe=Q.layerIds.map(function(ye){return P.getLayer(ye)}).filter(Boolean);if(0!==pe.length){Q.layers=pe,Q.stateDependentLayerIds&&(Q.stateDependentLayers=Q.stateDependentLayerIds.map(function(ye){return pe.filter(function(Ie){return Ie.id===ye})[0]}));for(var he=0,ve=pe;he<ve.length;he+=1)O[ve[he].id]=Q}},$=0,ee=M;$<ee.length;$+=1)V();return O}(s.buckets,l.style),this.hasSymbolBuckets=!1,this.buckets){var y=this.buckets[m];if(y instanceof Yn){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var b in this.buckets){var E=this.buckets[b];if(E instanceof Yn&&E.hasRTLText){this.hasRTLText=!0,nr.isLoading()||nr.isLoaded()||"deferred"!==_o()||Zd();break}}for(var S in this.queryPadding=0,this.buckets){var k=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(S).queryRadius(k))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new h},Yi.prototype.unloadVectorData=function(){for(var s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Yi.prototype.getBucket=function(s){return this.buckets[s.id]},Yi.prototype.upload=function(s){for(var l in this.buckets){var u=this.buckets[l];u.uploadPending()&&u.upload(s)}var m=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new da(s,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new da(s,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)},Yi.prototype.prepare=function(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)},Yi.prototype.queryRenderedFeatures=function(s,l,u,m,y,b,E,S,k,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:M,transform:S,params:E,queryPadding:this.queryPadding*k},s,l,u):{}},Yi.prototype.querySourceFeatures=function(s,l){var u=this.latestFeatureIndex;if(u&&u.rawTileData){var m=u.loadVTLayers(),y=l?l.sourceLayer:"",b=m._geojsonTileLayer||m[y];if(b)for(var E=As(l&&l.filter),S=this.tileID.canonical,k=S.z,M=S.x,P=S.y,O={z:k,x:M,y:P},V=0;V<b.length;V++){var $=b.feature(V);if(E.needGeometry){var ee=Fo($,!0);if(!E.filter(new Kt(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!E.filter(new Kt(this.tileID.overscaledZ),$))continue;var Q=u.getId($,y),pe=new s_($,k,M,P,Q);pe.tile=O,s.push(pe)}}},Yi.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Yi.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Yi.prototype.setExpiryData=function(s){var l=this.expirationTime;if(s.cacheControl){var u=jl(s.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){var m=Date.now(),y=!1;if(this.expirationTime>m)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{var b=this.expirationTime-l;b?this.expirationTime=m+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Yi.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Yi.prototype.setFeatureState=function(s,l){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(s).length){var u=this.latestFeatureIndex.loadVTLayers();for(var m in this.buckets)if(l.style.hasLayer(m)){var y=this.buckets[m],b=y.layers[0].sourceLayer||"_geojsonTileLayer",E=u[b],S=s[b];if(E&&S&&0!==Object.keys(S).length){y.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});var k=l&&l.style&&l.style.getLayer(m);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}}},Yi.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Yi.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<hl.now()},Yi.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Yi.prototype.setHoldDuration=function(s){this.symbolFadeHoldUntil=hl.now()+s},Yi.prototype.setDependencies=function(s,l){for(var u={},m=0,y=l;m<y.length;m+=1)u[y[m]]=!0;this.dependencies[s]=u},Yi.prototype.hasDependency=function(s,l){for(var u=0,m=s;u<m.length;u+=1){var y=this.dependencies[m[u]];if(y)for(var b=0,E=l;b<E.length;b+=1)if(y[E[b]])return!0}return!1};var od=_t.performance,Dx=function(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},od.mark(this._marks.start)};Dx.prototype.finish=function(){od.mark(this._marks.end);var s=od.getEntriesByName(this._marks.measure);return 0===s.length&&(od.measure(this._marks.measure,this._marks.start,this._marks.end),s=od.getEntriesByName(this._marks.measure),od.clearMarks(this._marks.start),od.clearMarks(this._marks.end),od.clearMeasures(this._marks.measure)),s},v.Actor=Bf,v.AlphaImage=cc,v.CanonicalTileID=lh,v.CollisionBoxArray=h,v.Color=wn,v.DEMData=tu,v.DataConstantProperty=tt,v.DictionaryCoder=am,v.EXTENT=8192,v.ErrorEvent=_e,v.EvaluationParameters=Kt,v.Event=me,v.Evented=J,v.FeatureIndex=nu,v.FillBucket=xl,v.FillExtrusionBucket=uc,v.ImageAtlas=Pf,v.ImagePosition=Rf,v.LineBucket=xo,v.LngLat=Tr,v.LngLatBounds=ei,v.MercatorCoordinate=id,v.ONE_EM=24,v.OverscaledTileID=bi,v.Point=Gt,v.Point$1=Gt,v.Properties=_i,v.Protobuf=Jc,v.RGBAImage=hs,v.RequestManager=No,v.RequestPerformance=Dx,v.ResourceType=Pu,v.SegmentVector=H,v.SourceFeatureState=lm,v.StructArrayLayout1ui2=Kp,v.StructArrayLayout2f1f2i16=Wu,v.StructArrayLayout2i4=Gu,v.StructArrayLayout3ui6=Gs,v.StructArrayLayout4i8=ao,v.SymbolBucket=Yn,v.Texture=da,v.Tile=Yi,v.Transitionable=mi,v.Uniform1f=qe,v.Uniform1i=Qe,v.Uniform2f=at,v.Uniform3f=Et,v.Uniform4f=It,v.UniformColor=St,v.UniformMatrix4f=ut,v.UnwrappedTileID=Ex,v.ValidationError=se,v.WritingMode=Zs,v.ZoomHistory=go,v.add=function(s,l,u){return s[0]=l[0]+u[0],s[1]=l[1]+u[1],s[2]=l[2]+u[2],s},v.addDynamicAttributes=qa,v.asyncAll=function(s,l,u){if(!s.length)return u(null,[]);var m=s.length,y=new Array(s.length),b=null;s.forEach(function(E,S){l(E,function(k,M){k&&(b=k),y[S]=M,0==--m&&u(b,y)})})},v.bezier=Ro,v.bindAll=Da,v.browser=hl,v.cacheEntryPossiblyAdded=function(s){++ql>nf&&(s.getActor().send("enforceCacheSizeLimit",Mu),ql=0)},v.clamp=to,v.clearTileCache=function(s){var l=_t.caches.delete("mapbox-tiles");s&&l.catch(s).then(function(){return s()})},v.clipLine=gv,v.clone=function(s){var l=new Fn(16);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l},v.clone$1=zs,v.clone$2=function(s){var l=new Fn(3);return l[0]=s[0],l[1]=s[1],l[2]=s[2],l},v.collisionCircleLayout=DT,v.config=er,v.create=function(){var s=new Fn(16);return Fn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},v.create$1=function(){var s=new Fn(9);return Fn!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s},v.create$2=function(){var s=new Fn(4);return Fn!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},v.createCommonjsModule=Zo,v.createExpression=Ba,v.createLayout=En,v.createStyleLayer=function(s){return"custom"===s.type?new i_(s):new gO[s.type](s)},v.cross=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=u[0],S=u[1],k=u[2];return s[0]=y*k-b*S,s[1]=b*E-m*k,s[2]=m*S-y*E,s},v.deepEqual=function s(l,u){if(Array.isArray(l)){if(!Array.isArray(u)||l.length!==u.length)return!1;for(var m=0;m<l.length;m++)if(!s(l[m],u[m]))return!1;return!0}if("object"==typeof l&&null!==l&&null!==u){if("object"!=typeof u||Object.keys(l).length!==Object.keys(u).length)return!1;for(var y in l)if(!s(l[y],u[y]))return!1;return!0}return l===u},v.dot=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]},v.dot$1=function(s,l){return s[0]*l[0]+s[1]*l[1]+s[2]*l[2]+s[3]*l[3]},v.ease=Oc,v.emitValidationErrors=oa,v.endsWith=Lc,v.enforceCacheSizeLimit=function(s){Ru(),Ts&&Ts.then(function(l){l.keys().then(function(u){for(var m=0;m<u.length-s;m++)l.delete(u[m])})})},v.evaluateSizeForFeature=nm,v.evaluateSizeForZoom=rm,v.evaluateVariableOffset=px,v.evented=nn,v.extend=Fi,v.featureFilter=As,v.filterObject=Es,v.fromRotation=function(s,l){var u=Math.sin(l),m=Math.cos(l);return s[0]=m,s[1]=u,s[2]=0,s[3]=-u,s[4]=m,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},v.getAnchorAlignment=dv,v.getAnchorJustification=sh,v.getArrayBuffer=tr,v.getImage=U,v.getJSON=function(s,l){return Wl(Fi(s,{type:"json"}),l)},v.getRTLTextPluginStatus=_o,v.getReferrer=gl,v.getVideo=function(s,l){var u,m,y=_t.document.createElement("video");y.muted=!0,y.onloadstart=function(){l(null,y)};for(var b=0;b<s.length;b++){var E=_t.document.createElement("source");u=s[b],m=void 0,(m=_t.document.createElement("a")).href=u,(m.protocol!==_t.document.location.protocol||m.host!==_t.document.location.host)&&(y.crossOrigin="Anonymous"),E.src=s[b],y.appendChild(E)}return{cancel:function(){}}},v.identity=Br,v.invert=function(s,l){var u=l[0],m=l[1],y=l[2],b=l[3],E=l[4],S=l[5],k=l[6],M=l[7],P=l[8],O=l[9],V=l[10],$=l[11],ee=l[12],Q=l[13],pe=l[14],he=l[15],ve=u*S-m*E,ye=u*k-y*E,Ie=u*M-b*E,ke=m*k-y*S,Oe=m*M-b*S,Ye=y*M-b*k,nt=P*Q-O*ee,yt=P*pe-V*ee,it=P*he-$*ee,kt=O*pe-V*Q,ot=O*he-$*Q,hn=V*he-$*pe,Vt=ve*hn-ye*ot+Ie*kt+ke*it-Oe*yt+Ye*nt;return Vt?(s[0]=(S*hn-k*ot+M*kt)*(Vt=1/Vt),s[1]=(y*ot-m*hn-b*kt)*Vt,s[2]=(Q*Ye-pe*Oe+he*ke)*Vt,s[3]=(V*Oe-O*Ye-$*ke)*Vt,s[4]=(k*it-E*hn-M*yt)*Vt,s[5]=(u*hn-y*it+b*yt)*Vt,s[6]=(pe*Ie-ee*Ye-he*ye)*Vt,s[7]=(P*Ye-V*Ie+$*ye)*Vt,s[8]=(E*ot-S*it+M*nt)*Vt,s[9]=(m*it-u*ot-b*nt)*Vt,s[10]=(ee*Oe-Q*Ie+he*ve)*Vt,s[11]=(O*Ie-P*Oe-$*ve)*Vt,s[12]=(S*yt-E*kt-k*nt)*Vt,s[13]=(u*kt-m*yt+y*nt)*Vt,s[14]=(Q*ye-ee*ke-pe*ve)*Vt,s[15]=(P*ke-O*ye+V*ve)*Vt,s):null},v.isChar=ht,v.isMapboxURL=js,v.keysDifference=function(s,l){var u=[];for(var m in s)m in l||u.push(m);return u},v.makeRequest=Wl,v.mapObject=Bi,v.mercatorXfromLng=xx,v.mercatorYfromLat=xv,v.mercatorZfromAltitude=o_,v.mul=wl,v.multiply=Zu,v.mvt=tm,v.nextPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},v.normalize=function(s,l){var u=l[0],m=l[1],y=l[2],b=u*u+m*m+y*y;return b>0&&(b=1/Math.sqrt(b)),s[0]=l[0]*b,s[1]=l[1]*b,s[2]=l[2]*b,s},v.number=pi,v.offscreenCanvasSupported=Ld,v.ortho=function(s,l,u,m,y,b,E){var S=1/(l-u),k=1/(m-y),M=1/(b-E);return s[0]=-2*S,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*k,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*M,s[11]=0,s[12]=(l+u)*S,s[13]=(y+m)*k,s[14]=(E+b)*M,s[15]=1,s},v.parseGlyphPBF=function(s){return new Jc(s).readFields(RT,[])},v.pbf=Jc,v.performSymbolLayout=function(s,l,u,m,y,b,E){s.createArrays(),s.tilePixelRatio=8192/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;var S=s.layers[0].layout,k=s.layers[0]._unevaluatedLayout._values,M={};if("composite"===s.textSizeData.kind){var P=s.textSizeData,O=P.maxZoom;M.compositeTextSizes=[k["text-size"].possiblyEvaluate(new Kt(P.minZoom),E),k["text-size"].possiblyEvaluate(new Kt(O),E)]}if("composite"===s.iconSizeData.kind){var V=s.iconSizeData,$=V.maxZoom;M.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new Kt(V.minZoom),E),k["icon-size"].possiblyEvaluate(new Kt($),E)]}M.layoutTextSize=k["text-size"].possiblyEvaluate(new Kt(s.zoom+1),E),M.layoutIconSize=k["icon-size"].possiblyEvaluate(new Kt(s.zoom+1),E),M.textMaxSize=k["text-size"].possiblyEvaluate(new Kt(18));for(var ee=24*S.get("text-line-height"),Q="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),pe=S.get("text-keep-upright"),he=S.get("text-size"),ve=function(){var ke=Ie[ye],Oe=S.get("text-font").evaluate(ke,{},E).join(","),Ye=he.evaluate(ke,{},E),nt=M.layoutTextSize.evaluate(ke,{},E),yt=M.layoutIconSize.evaluate(ke,{},E),it={horizontal:{},vertical:void 0},kt=ke.text,ot=[0,0];if(kt){var hn=kt.toString(),Vt=24*S.get("text-letter-spacing").evaluate(ke,{},E),gt=function(bn){for(var or=0,Xn=bn;or<Xn.length;or+=1)if(An=Xn[or].charCodeAt(0),ht.Arabic(An)||ht["Arabic Supplement"](An)||ht["Arabic Extended-A"](An)||ht["Arabic Presentation Forms-A"](An)||ht["Arabic Presentation Forms-B"](An))return!1;var An;return!0}(hn)?Vt:0,_n=S.get("text-anchor").evaluate(ke,{},E),rn=S.get("text-variable-anchor");if(!rn){var Cn=S.get("text-radial-offset").evaluate(ke,{},E);ot=Cn?px(_n,[24*Cn,oh]):S.get("text-offset").evaluate(ke,{},E).map(function(bn){return 24*bn})}var At=Q?"center":S.get("text-justify").evaluate(ke,{},E),kn=S.get("symbol-placement"),br="point"===kn?24*S.get("text-max-width").evaluate(ke,{},E):0,zr=function(){s.allowVerticalPlacement&&Qr(hn)&&(it.vertical=Yg(kt,l,u,y,Oe,br,ee,_n,"left",gt,ot,Zs.vertical,!0,kn,nt,Ye))};if(!Q&&rn){for(var Pr="auto"===At?rn.map(function(bn){return sh(bn)}):[At],wr=!1,Gr=0;Gr<Pr.length;Gr++){var Mi=Pr[Gr];if(!it.horizontal[Mi])if(wr)it.horizontal[Mi]=it.horizontal[0];else{var Ri=Yg(kt,l,u,y,Oe,br,ee,"center",Mi,gt,ot,Zs.horizontal,!1,kn,nt,Ye);Ri&&(it.horizontal[Mi]=Ri,wr=1===Ri.positionedLines.length)}}zr()}else{"auto"===At&&(At=sh(_n));var Uo=Yg(kt,l,u,y,Oe,br,ee,_n,At,gt,ot,Zs.horizontal,!1,kn,nt,Ye);Uo&&(it.horizontal[At]=Uo),zr(),Qr(hn)&&Q&&pe&&(it.vertical=Yg(kt,l,u,y,Oe,br,ee,_n,At,gt,ot,Zs.vertical,!1,kn,nt,Ye))}}var bn,or,An,Co,Do,Xi=void 0,jo=!1;if(ke.icon&&ke.icon.name){var ti=m[ke.icon.name];ti&&(bn=y[ke.icon.name],or=S.get("icon-offset").evaluate(ke,{},E),An=dv(S.get("icon-anchor").evaluate(ke,{},E)),Xi={image:bn,top:Do=or[1]-bn.displaySize[1]*An.verticalAlign,bottom:Do+bn.displaySize[1],left:Co=or[0]-bn.displaySize[0]*An.horizontalAlign,right:Co+bn.displaySize[0]},jo=ti.sdf,void 0===s.sdfIcons?s.sdfIcons=ti.sdf:s.sdfIcons!==ti.sdf&&fr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ti.pixelRatio!==s.pixelRatio||0!==S.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}var Pi=om(it.horizontal)||it.vertical;s.iconsInText=!!Pi&&Pi.iconsInText,(Pi||Xi)&&function(bn,or,Xn,An,Co,Do,Qn,xr,To,Vn,Dl){var ps=Do.textMaxSize.evaluate(or,{});void 0===ps&&(ps=Qn);var ha,Ur=bn.layers[0].layout,fc=Ur.get("icon-offset").evaluate(or,{},Dl),Ga=om(Xn.horizontal),cm=Qn/24,Tl=bn.tilePixelRatio*cm,uh=bn.tilePixelRatio*ps/24,pc=bn.tilePixelRatio*xr,dh=bn.tilePixelRatio*Ur.get("symbol-spacing"),jf=Ur.get("text-padding")*bn.tilePixelRatio,hh=Ur.get("icon-padding")*bn.tilePixelRatio,Hf=Ur.get("text-max-angle")/180*Math.PI,a_="map"===Ur.get("text-rotation-alignment")&&"point"!==Ur.get("symbol-placement"),$f="map"===Ur.get("icon-rotation-alignment")&&"point"!==Ur.get("symbol-placement"),mc=Ur.get("symbol-placement"),gc=dh/2,qf=Ur.get("icon-text-fit");An&&"none"!==qf&&(bn.allowVerticalPlacement&&Xn.vertical&&(ha=Ct(An,Xn.vertical,qf,Ur.get("icon-text-fit-padding"),fc,cm)),Ga&&(An=Ct(An,Ga,qf,Ur.get("icon-text-fit-padding"),fc,cm)));var ru=function(h_,mh){mh.x<0||mh.x>=8192||mh.y<0||mh.y>=8192||function(Wr,Wa,BT,sd,f_,p_,Dv,ou,m_,g_,__,Tv,Tx,y_,v_,Sv,Iv,Sx,VT,su,fa,gh,Ix,yc,kx){var vm,_h,ad,Yf,yh,Xf=Wr.addToLineVertexArray(Wa,BT),zT=0,kv=0,Ax=0,Mx=0,Av=-1,vh=-1,vc={},b_=ae(""),Mv=0,Rx=0;if(void 0===ou._unevaluatedLayout.getValue("text-radial-offset")?(Mv=(vm=ou.layout.get("text-offset").evaluate(fa,{},yc).map(function(T_){return 24*T_}))[0],Rx=vm[1]):(Mv=24*ou.layout.get("text-radial-offset").evaluate(fa,{},yc),Rx=oh),Wr.allowVerticalPlacement&&sd.vertical){var UT=ou.layout.get("text-rotate").evaluate(fa,{},yc)+90;Yf=new e_(m_,Wa,g_,__,Tv,sd.vertical,Tx,y_,v_,UT),Dv&&(yh=new e_(m_,Wa,g_,__,Tv,Dv,Iv,Sx,v_,UT))}if(f_){var Px=ou.layout.get("icon-rotate").evaluate(fa,{}),Qf="none"!==ou.layout.get("icon-text-fit"),Nx=OT(f_,Px,Ix,Qf),Jf=Dv?OT(Dv,Px,Ix,Qf):void 0;ad=new e_(m_,Wa,g_,__,Tv,f_,Iv,Sx,!1,Px),zT=4*Nx.length;var w_=Wr.iconSizeData,ep=null;"source"===w_.kind?(ep=[128*ou.layout.get("icon-size").evaluate(fa,{})])[0]>32640&&fr(Wr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===w_.kind&&((ep=[128*gh.compositeIconSizes[0].evaluate(fa,{},yc),128*gh.compositeIconSizes[1].evaluate(fa,{},yc)])[0]>32640||ep[1]>32640)&&fr(Wr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Wr.addSymbols(Wr.icon,Nx,ep,su,VT,fa,!1,Wa,Xf.lineStartIndex,Xf.lineLength,-1,yc),Av=Wr.icon.placedSymbolArray.length-1,Jf&&(kv=4*Jf.length,Wr.addSymbols(Wr.icon,Jf,ep,su,VT,fa,Zs.vertical,Wa,Xf.lineStartIndex,Xf.lineLength,-1,yc),vh=Wr.icon.placedSymbolArray.length-1)}for(var x_ in sd.horizontal){var Rv=sd.horizontal[x_];if(!_h){b_=ae(Rv.text);var _O=ou.layout.get("text-rotate").evaluate(fa,{},yc);_h=new e_(m_,Wa,g_,__,Tv,Rv,Tx,y_,v_,_O)}var jT=1===Rv.positionedLines.length;if(Ax+=t_(Wr,Wa,Rv,p_,ou,v_,fa,Sv,Xf,sd.vertical?Zs.horizontal:Zs.horizontalOnly,jT?Object.keys(sd.horizontal):[x_],vc,Av,gh,yc),jT)break}sd.vertical&&(Mx+=t_(Wr,Wa,sd.vertical,p_,ou,v_,fa,Sv,Xf,Zs.vertical,["vertical"],vc,vh,gh,yc));var Ox=_h?_h.boxStartIndex:Wr.collisionBoxArray.length,HT=_h?_h.boxEndIndex:Wr.collisionBoxArray.length,Lx=Yf?Yf.boxStartIndex:Wr.collisionBoxArray.length,Pv=Yf?Yf.boxEndIndex:Wr.collisionBoxArray.length,Fx=ad?ad.boxStartIndex:Wr.collisionBoxArray.length,E_=ad?ad.boxEndIndex:Wr.collisionBoxArray.length,C_=yh?yh.boxStartIndex:Wr.collisionBoxArray.length,$T=yh?yh.boxEndIndex:Wr.collisionBoxArray.length,au=-1,D_=function(T_,Nv){return T_&&T_.circleDiameter?Math.max(T_.circleDiameter,Nv):Nv};au=D_(_h,au),au=D_(Yf,au),au=D_(ad,au);var Bx=(au=D_(yh,au))>-1?1:0;Bx&&(au*=kx/24),Wr.glyphOffsetArray.length>=Yn.MAX_GLYPHS&&fr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==fa.sortKey&&Wr.addToSortKeyRanges(Wr.symbolInstances.length,fa.sortKey),Wr.symbolInstances.emplaceBack(Wa.x,Wa.y,vc.right>=0?vc.right:-1,vc.center>=0?vc.center:-1,vc.left>=0?vc.left:-1,vc.vertical||-1,Av,vh,b_,Ox,HT,Lx,Pv,Fx,E_,C_,$T,g_,Ax,Mx,zT,kv,Bx,0,Tx,Mv,Rx,au)}(bn,mh,h_,Xn,An,Co,ha,bn.layers[0],bn.collisionBoxArray,or.index,or.sourceLayerIndex,bn.index,Tl,jf,a_,To,pc,hh,$f,fc,or,Do,Vn,Dl,Qn)};if("line"===mc)for(var fh=0,l_=gv(or.geometry,0,0,8192,8192);fh<l_.length;fh+=1)for(var um=l_[fh],Gf=0,dm=mv(um,dh,Hf,Xn.vertical||Ga,An,24,uh,bn.overscaling,8192);Gf<dm.length;Gf+=1){var Wf=dm[Gf];Ga&&mO(bn,Ga.text,gc,Wf)||ru(um,Wf)}else if("line-center"===mc)for(var c_=0,Kf=or.geometry;c_<Kf.length;c_+=1){var hm=Kf[c_];if(hm.length>1){var u_=im(hm,Hf,Xn.vertical||Ga,An,24,uh);u_&&ru(hm,u_)}}else if("Polygon"===or.type)for(var fm=0,Cv=iv(or.geometry,0);fm<Cv.length;fm+=1){var pm=Cv[fm],mm=Of(pm,16);ru(pm[0],new Nf(mm.x,mm.y,0))}else if("LineString"===or.type)for(var ph=0,gm=or.geometry;ph<gm.length;ph+=1){var iu=gm[ph];ru(iu,new Nf(iu[0].x,iu[0].y,0))}else if("Point"===or.type)for(var _m=0,d_=or.geometry;_m<d_.length;_m+=1)for(var _c=0,ym=d_[_m];_c<ym.length;_c+=1){var Zf=ym[_c];ru([Zf],new Nf(Zf.x,Zf.y,0))}}(s,ke,it,Xi,m,M,nt,yt,ot,jo,E)},ye=0,Ie=s.features;ye<Ie.length;ye+=1)ve();b&&s.generateCollisionDebugBuffers()},v.perspective=function(s,l,u,m,y){var b,E=1/Math.tan(l/2);return s[0]=E/u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=y&&y!==1/0?(s[10]=(y+m)*(b=1/(m-y)),s[14]=2*y*m*b):(s[10]=-1,s[14]=-2*m),s},v.pick=function(s,l){for(var u={},m=0;m<l.length;m++){var y=l[m];y in s&&(u[y]=s[y])}return u},v.plugin=nr,v.polygonIntersectsPolygon=Pe,v.postMapLoadEvent=Ma,v.postTurnstileEvent=Bc,v.potpack=ax,v.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],v.register=st,v.registerForPluginStateChange=function(s){return s({pluginStatus:qi,pluginURL:Mn}),nn.on("pluginStateChange",s),s},v.renderColorRamp=Hg,v.rotate=function(s,l,u){var m=l[0],y=l[1],b=l[2],E=l[3],S=Math.sin(u),k=Math.cos(u);return s[0]=m*k+b*S,s[1]=y*k+E*S,s[2]=m*-S+b*k,s[3]=y*-S+E*k,s},v.rotateX=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[4],E=l[5],S=l[6],k=l[7],M=l[8],P=l[9],O=l[10],V=l[11];return l!==s&&(s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[4]=b*y+M*m,s[5]=E*y+P*m,s[6]=S*y+O*m,s[7]=k*y+V*m,s[8]=M*y-b*m,s[9]=P*y-E*m,s[10]=O*y-S*m,s[11]=V*y-k*m,s},v.rotateZ=function(s,l,u){var m=Math.sin(u),y=Math.cos(u),b=l[0],E=l[1],S=l[2],k=l[3],M=l[4],P=l[5],O=l[6],V=l[7];return l!==s&&(s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]),s[0]=b*y+M*m,s[1]=E*y+P*m,s[2]=S*y+O*m,s[3]=k*y+V*m,s[4]=M*y-b*m,s[5]=P*y-E*m,s[6]=O*y-S*m,s[7]=V*y-k*m,s},v.scale=function(s,l,u){var m=u[0],y=u[1],b=u[2];return s[0]=l[0]*m,s[1]=l[1]*m,s[2]=l[2]*m,s[3]=l[3]*m,s[4]=l[4]*y,s[5]=l[5]*y,s[6]=l[6]*y,s[7]=l[7]*y,s[8]=l[8]*b,s[9]=l[9]*b,s[10]=l[10]*b,s[11]=l[11]*b,s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},v.scale$1=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s[3]=l[3]*u,s},v.scale$2=function(s,l,u){return s[0]=l[0]*u,s[1]=l[1]*u,s[2]=l[2]*u,s},v.setCacheLimits=function(s,l){Mu=s,nf=l},v.setRTLTextPlugin=function(s,l,u){if(void 0===u&&(u=!1),"deferred"===qi||"loading"===qi||"loaded"===qi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Mn=hl.resolveURL(s),qi="deferred",bl=l,ls(),u||Zd()},v.sphericalToCartesian=function(s){var l=s[0],u=s[1],m=s[2];return u+=90,u*=Math.PI/180,m*=Math.PI/180,{x:l*Math.cos(u)*Math.sin(m),y:l*Math.sin(u)*Math.sin(m),z:l*Math.cos(m)}},v.sqrLen=function(s){var l=s[0],u=s[1];return l*l+u*u},v.styleSpec=Z,v.sub=function(s,l,u){return s[0]=l[0]-u[0],s[1]=l[1]-u[1],s[2]=l[2]-u[2],s},v.symbolSize=hv,v.transformMat3=function(s,l,u){var m=l[0],y=l[1],b=l[2];return s[0]=m*u[0]+y*u[3]+b*u[6],s[1]=m*u[1]+y*u[4]+b*u[7],s[2]=m*u[2]+y*u[5]+b*u[8],s},v.transformMat4=Sf,v.translate=function(s,l,u){var m,y,b,E,S,k,M,P,O,V,$,ee,Q=u[0],pe=u[1],he=u[2];return l===s?(s[12]=l[0]*Q+l[4]*pe+l[8]*he+l[12],s[13]=l[1]*Q+l[5]*pe+l[9]*he+l[13],s[14]=l[2]*Q+l[6]*pe+l[10]*he+l[14],s[15]=l[3]*Q+l[7]*pe+l[11]*he+l[15]):(y=l[1],b=l[2],E=l[3],S=l[4],k=l[5],M=l[6],P=l[7],O=l[8],V=l[9],$=l[10],ee=l[11],s[0]=m=l[0],s[1]=y,s[2]=b,s[3]=E,s[4]=S,s[5]=k,s[6]=M,s[7]=P,s[8]=O,s[9]=V,s[10]=$,s[11]=ee,s[12]=m*Q+S*pe+O*he+l[12],s[13]=y*Q+k*pe+V*he+l[13],s[14]=b*Q+M*pe+$*he+l[14],s[15]=E*Q+P*pe+ee*he+l[15]),s},v.triggerPluginCompletionEvent=Ln,v.uniqueId=ul,v.validateCustomStyleLayer=function(s){var l=[],u=s.id;return void 0===u&&l.push({message:"layers."+u+': missing required property "id"'}),void 0===s.render&&l.push({message:"layers."+u+': missing required method "render"'}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&l.push({message:"layers."+u+': property "renderingMode" must be either "2d" or "3d"'}),l},v.validateLight=qp,v.validateStyle=$u,v.values=function(s){var l=[];for(var u in s)l.push(s[u]);return l},v.vectorTile=tm,v.version="1.15.3",v.warnOnce=fr,v.webpSupported=Ia,v.window=_t,v.wrap=Su}),Od(0,function(v){function Zo(F){var z=typeof F;if("number"===z||"boolean"===z||"string"===z||null==F)return JSON.stringify(F);if(Array.isArray(F)){for(var U="[",K=0,ie=F;K<ie.length;K+=1)U+=Zo(ie[K])+",";return U+"]"}for(var me=Object.keys(F).sort(),_e="{",J=0;J<me.length;J++)_e+=JSON.stringify(me[J])+":"+Zo(F[me[J]])+",";return _e+"}"}function ze(F){for(var z="",U=0,K=v.refProperties;U<K.length;U+=1)z+="/"+Zo(F[K[U]]);return z}var Tt=function(F){this.keyCache={},F&&this.replace(F)};Tt.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},Tt.prototype.update=function(F,z){for(var U=this,K=0,ie=F;K<ie.length;K+=1){var me=ie[K];this._layerConfigs[me.id]=me;var _e=this._layers[me.id]=v.createStyleLayer(me);_e._featureFilter=v.featureFilter(_e.filter),this.keyCache[me.id]&&delete this.keyCache[me.id]}for(var J=0,Z=z;J<Z.length;J+=1){var se=Z[J];delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se]}this.familiesBySource={};for(var Ue=0,Je=function(rt,Ve){for(var Jt={},en=0;en<rt.length;en++){var ue=Ve&&Ve[rt[en].id]||ze(rt[en]);Ve&&(Ve[rt[en].id]=ue);var ur=Jt[ue];ur||(ur=Jt[ue]=[]),ur.push(rt[en])}var jt=[];for(var an in Jt)jt.push(Jt[an]);return jt}(v.values(this._layerConfigs),this.keyCache);Ue<Je.length;Ue+=1){var Te=Je[Ue].map(function(rt){return U._layers[rt.id]}),$e=Te[0];if("none"!==$e.visibility){var ct=$e.source||"",dt=this.familiesBySource[ct];dt||(dt=this.familiesBySource[ct]={});var xt=$e.sourceLayer||"_geojsonTileLayer",Ne=dt[xt];Ne||(Ne=dt[xt]=[]),Ne.push(Te)}}};var Gt=function(F){var z={},U=[];for(var K in F){var ie=F[K],me=z[K]={};for(var _e in ie){var J=ie[+_e];if(J&&0!==J.bitmap.width&&0!==J.bitmap.height){var Z={x:0,y:0,w:J.bitmap.width+2,h:J.bitmap.height+2};U.push(Z),me[_e]={rect:Z,metrics:J.metrics}}}}var se=v.potpack(U),Ue=new v.AlphaImage({width:se.w||1,height:se.h||1});for(var Je in F){var Te=F[Je];for(var $e in Te){var ct=Te[+$e];if(ct&&0!==ct.bitmap.width&&0!==ct.bitmap.height){var dt=z[Je][$e].rect;v.AlphaImage.copy(ct.bitmap,Ue,{x:0,y:0},{x:dt.x+1,y:dt.y+1},ct.bitmap)}}}this.image=Ue,this.positions=z};v.register("GlyphAtlas",Gt);var cl=function(F){this.tileID=new v.OverscaledTileID(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId};function _t(F,z,U){for(var K=new v.EvaluationParameters(z),ie=0,me=F;ie<me.length;ie+=1)me[ie].recalculate(K,U)}function zl(F,z){var U=v.getArrayBuffer(F.request,function(K,ie,me,_e){K?z(K):ie&&z(null,{vectorTile:new v.vectorTile.VectorTile(new v.pbf(ie)),rawData:ie,cacheControl:me,expires:_e})});return function(){U.cancel(),z()}}cl.prototype.parse=function(F,z,U,K,ie){var me=this;this.status="parsing",this.data=F,this.collisionBoxArray=new v.CollisionBoxArray;var _e=new v.DictionaryCoder(Object.keys(F.layers).sort()),J=new v.FeatureIndex(this.tileID,this.promoteId);J.bucketLayerIDs=[];var Z,se,Ue,Je,Te={},$e={featureIndex:J,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:U},ct=z.familiesBySource[this.source];for(var dt in ct){var xt=F.layers[dt];if(xt){1===xt.version&&v.warnOnce('Vector tile source "'+this.source+'" layer "'+dt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ne=_e.encode(dt),rt=[],Ve=0;Ve<xt.length;Ve++){var Jt=xt.feature(Ve),en=J.getId(Jt,dt);rt.push({feature:Jt,id:en,index:Ve,sourceLayerIndex:Ne})}for(var ue=0,ur=ct[dt];ue<ur.length;ue+=1){var jt=ur[ue],an=jt[0];an.minzoom&&this.zoom<Math.floor(an.minzoom)||an.maxzoom&&this.zoom>=an.maxzoom||"none"!==an.visibility&&(_t(jt,this.zoom,U),(Te[an.id]=an.createBucket({index:J.bucketLayerIDs.length,layers:jt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ne,sourceID:this.source})).populate(rt,$e,this.tileID.canonical),J.bucketLayerIDs.push(jt.map(function(xn){return xn.id})))}}}var Cr=v.mapObject($e.glyphDependencies,function(xn){return Object.keys(xn).map(Number)});Object.keys(Cr).length?K.send("getGlyphs",{uid:this.uid,stacks:Cr},function(xn,fn){Z||(Z=xn,se=fn,Fr.call(me))}):se={};var On=Object.keys($e.iconDependencies);On.length?K.send("getImages",{icons:On,source:this.source,tileID:this.tileID,type:"icons"},function(xn,fn){Z||(Z=xn,Ue=fn,Fr.call(me))}):Ue={};var pt=Object.keys($e.patternDependencies);function Fr(){if(Z)return ie(Z);if(se&&Ue&&Je){var xn=new Gt(se),fn=new v.ImageAtlas(Ue,Je);for(var Bd in Te){var wn=Te[Bd];wn instanceof v.SymbolBucket?(_t(wn.layers,this.zoom,U),v.performSymbolLayout(wn,se,xn.positions,Ue,fn.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):wn.hasPattern&&(wn instanceof v.LineBucket||wn instanceof v.FillBucket||wn instanceof v.FillExtrusionBucket)&&(_t(wn.layers,this.zoom,U),wn.addFeatures($e,this.tileID.canonical,fn.patternPositions))}this.status="done",ie(null,{buckets:v.values(Te).filter(function(Kn){return!Kn.isEmpty()}),featureIndex:J,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:xn.image,imageAtlas:fn,glyphMap:this.returnDependencies?se:null,iconMap:this.returnDependencies?Ue:null,glyphPositions:this.returnDependencies?xn.positions:null})}}pt.length?K.send("getImages",{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"},function(xn,fn){Z||(Z=xn,Je=fn,Fr.call(me))}):Je={},Fr.call(this)};var Ro=function(F,z,U,K){this.actor=F,this.layerIndex=z,this.availableImages=U,this.loadVectorData=K||zl,this.loading={},this.loaded={}};Ro.prototype.loadTile=function(F,z){var U=this,K=F.uid;this.loading||(this.loading={});var ie=!!(F&&F.request&&F.request.collectResourceTiming)&&new v.RequestPerformance(F.request),me=this.loading[K]=new cl(F);me.abort=this.loadVectorData(F,function(_e,J){if(delete U.loading[K],_e||!J)return me.status="done",U.loaded[K]=me,z(_e);var Z=J.rawData,se={};J.expires&&(se.expires=J.expires),J.cacheControl&&(se.cacheControl=J.cacheControl);var Ue={};if(ie){var Je=ie.finish();Je&&(Ue.resourceTiming=JSON.parse(JSON.stringify(Je)))}me.vectorTile=J.vectorTile,me.parse(J.vectorTile,U.layerIndex,U.availableImages,U.actor,function(Te,$e){if(Te||!$e)return z(Te);z(null,v.extend({rawTileData:Z.slice(0)},$e,se,Ue))}),U.loaded=U.loaded||{},U.loaded[K]=me})},Ro.prototype.reloadTile=function(F,z){var U=this,K=this.loaded,ie=F.uid,me=this;if(K&&K[ie]){var _e=K[ie];_e.showCollisionBoxes=F.showCollisionBoxes;var J=function(Z,se){var Ue=_e.reloadCallback;Ue&&(delete _e.reloadCallback,_e.parse(_e.vectorTile,me.layerIndex,U.availableImages,me.actor,Ue)),z(Z,se)};"parsing"===_e.status?_e.reloadCallback=J:"done"===_e.status&&(_e.vectorTile?_e.parse(_e.vectorTile,this.layerIndex,this.availableImages,this.actor,J):J())}},Ro.prototype.abortTile=function(F,z){var U=this.loading,K=F.uid;U&&U[K]&&U[K].abort&&(U[K].abort(),delete U[K]),z()},Ro.prototype.removeTile=function(F,z){var U=this.loaded,K=F.uid;U&&U[K]&&delete U[K],z()};var Oc=v.window.ImageBitmap,to=function(){this.loaded={}};function Su(F,z){if(0!==F.length){Fi(F[0],z);for(var U=1;U<F.length;U++)Fi(F[U],!z)}}function Fi(F,z){for(var U=0,K=0,ie=F.length,me=ie-1;K<ie;me=K++)U+=(F[K][0]-F[me][0])*(F[me][1]+F[K][1]);U>=0!=!!z&&F.reverse()}to.prototype.loadTile=function(F,z){var U=F.uid,K=F.encoding,ie=F.rawImageData,me=Oc&&ie instanceof Oc?this.getImageData(ie):ie,_e=new v.DEMData(U,me,K);this.loaded=this.loaded||{},this.loaded[U]=_e,z(null,_e)},to.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var z=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new v.RGBAImage({width:z.width,height:z.height},z.data)},to.prototype.removeTile=function(F){var z=this.loaded,U=F.uid;z&&z[U]&&delete z[U]};var tf=v.vectorTile.VectorTileFeature.prototype.toGeoJSON,ul=function(F){this._feature=F,this.extent=v.EXTENT,this.type=F.type,this.properties=F.tags,"id"in F&&!isNaN(F.id)&&(this.id=parseInt(F.id,10))};ul.prototype.loadGeometry=function(){if(1===this._feature.type){for(var F=[],z=0,U=this._feature.geometry;z<U.length;z+=1){var K=U[z];F.push([new v.Point$1(K[0],K[1])])}return F}for(var ie=[],me=0,_e=this._feature.geometry;me<_e.length;me+=1){for(var J=[],Z=0,se=_e[me];Z<se.length;Z+=1){var Ue=se[Z];J.push(new v.Point$1(Ue[0],Ue[1]))}ie.push(J)}return ie},ul.prototype.toGeoJSON=function(F,z,U){return tf.call(this,F,z,U)};var ns=function(F){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.EXTENT,this.length=F.length,this._features=F};ns.prototype.feature=function(F){return new ul(this._features[F])};var Iu=v.vectorTile.VectorTileFeature,Da=Lc;function Lc(F,z){this.options=z||{},this.features=F,this.length=F.length}function Bi(F,z){this.id="number"==typeof F.id?F.id:void 0,this.type=F.type,this.rawGeometry=1===F.type?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=z||4096}Lc.prototype.feature=function(F){return new Bi(this.features[F],this.options.extent)},Bi.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var z=0;z<F.length;z++){for(var U=F[z],K=[],ie=0;ie<U.length;ie++)K.push(new v.Point$1(U[ie][0],U[ie][1]));this.geometry.push(K)}return this.geometry},Bi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,z=1/0,U=-1/0,K=1/0,ie=-1/0,me=0;me<F.length;me++)for(var _e=F[me],J=0;J<_e.length;J++){var Z=_e[J];z=Math.min(z,Z.x),U=Math.max(U,Z.x),K=Math.min(K,Z.y),ie=Math.max(ie,Z.y)}return[z,K,U,ie]},Bi.prototype.toGeoJSON=Iu.prototype.toGeoJSON;var Es=Ul,zs=Da;function Ul(F){var z=new v.pbf;return function(U,K){for(var ie in U.layers)K.writeMessage(3,fr,U.layers[ie])}(F,z),z.finish()}function fr(F,z){var U;z.writeVarintField(15,F.version||1),z.writeStringField(1,F.name||""),z.writeVarintField(5,F.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(U=0;U<F.length;U++)K.feature=F.feature(U),z.writeMessage(2,Po,K);var ie=K.keys;for(U=0;U<ie.length;U++)z.writeStringField(3,ie[U]);var me=K.values;for(U=0;U<me.length;U++)z.writeMessage(4,Ta,me[U])}function Po(F,z){var U=F.feature;void 0!==U.id&&z.writeVarintField(1,U.id),z.writeMessage(2,Np,F),z.writeVarintField(3,U.type),z.writeMessage(4,ku,U)}function Np(F,z){var U=F.feature,K=F.keys,ie=F.values,me=F.keycache,_e=F.valuecache;for(var J in U.properties){var Z=me[J];void 0===Z&&(K.push(J),me[J]=Z=K.length-1),z.writeVarint(Z);var se=U.properties[J],Ue=typeof se;"string"!==Ue&&"boolean"!==Ue&&"number"!==Ue&&(se=JSON.stringify(se));var Je=Ue+":"+se,Te=_e[Je];void 0===Te&&(ie.push(se),_e[Je]=Te=ie.length-1),z.writeVarint(Te)}}function Cs(F,z){return(z<<3)+(7&F)}function jl(F){return F<<1^F>>31}function ku(F,z){for(var U=F.loadGeometry(),K=F.type,ie=0,me=0,_e=U.length,J=0;J<_e;J++){var Z=U[J],se=1;1===K&&(se=Z.length),z.writeVarint(Cs(1,se));for(var Ue=3===K?Z.length-1:Z.length,Je=0;Je<Ue;Je++){1===Je&&1!==K&&z.writeVarint(Cs(2,Ue-1));var Te=Z[Je].x-ie,$e=Z[Je].y-me;z.writeVarint(jl(Te)),z.writeVarint(jl($e)),ie+=Te,me+=$e}3===K&&z.writeVarint(Cs(7,1))}}function Ta(F,z){var U=typeof F;"string"===U?z.writeStringField(1,F):"boolean"===U?z.writeBooleanField(7,F):"number"===U&&(F%1!=0?z.writeDoubleField(3,F):F<0?z.writeSVarintField(6,F):z.writeVarintField(5,F))}function Ds(F,z,U,K){no(F,U,K),no(z,2*U,2*K),no(z,2*U+1,2*K+1)}function no(F,z,U){var K=F[z];F[z]=F[U],F[U]=K}function Sa(F,z,U,K){var ie=F-U,me=z-K;return ie*ie+me*me}Es.fromVectorTileJs=Ul,Es.fromGeojsonVt=function(F,z){z=z||{};var U={};for(var K in F)U[K]=new Da(F[K].features,z),U[K].name=K,U[K].version=z.version,U[K].extent=z.extent;return Ul({layers:U})},Es.GeoJSONWrapper=zs;var Fc=function(F){return F[0]},Hl=function(F){return F[1]},dl=function(F,z,U,K,ie){void 0===z&&(z=Fc),void 0===U&&(U=Hl),void 0===K&&(K=64),void 0===ie&&(ie=Float64Array),this.nodeSize=K,this.points=F;for(var me=F.length<65536?Uint16Array:Uint32Array,_e=this.ids=new me(F.length),J=this.coords=new ie(2*F.length),Z=0;Z<F.length;Z++)_e[Z]=Z,J[2*Z]=z(F[Z]),J[2*Z+1]=U(F[Z]);!function se(Ue,Je,Te,$e,ct,dt){if(!(ct-$e<=Te)){var xt=$e+ct>>1;(function Ne(rt,Ve,Jt,en,ue,ur){for(;ue>en;){if(ue-en>600){var jt=ue-en+1,an=Jt-en+1,Cr=Math.log(jt),On=.5*Math.exp(2*Cr/3),pt=.5*Math.sqrt(Cr*On*(jt-On)/jt)*(an-jt/2<0?-1:1);Ne(rt,Ve,Jt,Math.max(en,Math.floor(Jt-an*On/jt+pt)),Math.min(ue,Math.floor(Jt+(jt-an)*On/jt+pt)),ur)}var Fr=Ve[2*Jt+ur],xn=en,fn=ue;for(Ds(rt,Ve,en,Jt),Ve[2*ue+ur]>Fr&&Ds(rt,Ve,en,ue);xn<fn;){for(Ds(rt,Ve,xn,fn),xn++,fn--;Ve[2*xn+ur]<Fr;)xn++;for(;Ve[2*fn+ur]>Fr;)fn--}Ve[2*en+ur]===Fr?Ds(rt,Ve,en,fn):Ds(rt,Ve,++fn,ue),fn<=Jt&&(en=fn+1),Jt<=fn&&(ue=fn-1)}})(Ue,Je,xt,$e,ct,dt%2),se(Ue,Je,Te,$e,xt-1,dt+1),se(Ue,Je,Te,xt+1,ct,dt+1)}}(_e,J,K,0,_e.length-1,0)};dl.prototype.range=function(F,z,U,K){return function(ie,me,_e,J,Z,se,Ue){for(var Je,Te,$e=[0,ie.length-1,0],ct=[];$e.length;){var dt=$e.pop(),xt=$e.pop(),Ne=$e.pop();if(xt-Ne<=Ue)for(var rt=Ne;rt<=xt;rt++)Te=me[2*rt+1],(Je=me[2*rt])>=_e&&Je<=Z&&Te>=J&&Te<=se&&ct.push(ie[rt]);else{var Ve=Math.floor((Ne+xt)/2);Te=me[2*Ve+1],(Je=me[2*Ve])>=_e&&Je<=Z&&Te>=J&&Te<=se&&ct.push(ie[Ve]);var Jt=(dt+1)%2;(0===dt?_e<=Je:J<=Te)&&($e.push(Ne),$e.push(Ve-1),$e.push(Jt)),(0===dt?Z>=Je:se>=Te)&&($e.push(Ve+1),$e.push(xt),$e.push(Jt))}}return ct}(this.ids,this.coords,F,z,U,K,this.nodeSize)},dl.prototype.within=function(F,z,U){return function(K,ie,me,_e,J,Z){for(var se=[0,K.length-1,0],Ue=[],Je=J*J;se.length;){var Te=se.pop(),$e=se.pop(),ct=se.pop();if($e-ct<=Z)for(var dt=ct;dt<=$e;dt++)Sa(ie[2*dt],ie[2*dt+1],me,_e)<=Je&&Ue.push(K[dt]);else{var xt=Math.floor((ct+$e)/2),Ne=ie[2*xt],rt=ie[2*xt+1];Sa(Ne,rt,me,_e)<=Je&&Ue.push(K[xt]);var Ve=(Te+1)%2;(0===Te?me-J<=Ne:_e-J<=rt)&&(se.push(ct),se.push(xt-1),se.push(Ve)),(0===Te?me+J>=Ne:_e+J>=rt)&&(se.push(xt+1),se.push($e),se.push(Ve))}}return Ue}(this.ids,this.coords,F,z,U,this.nodeSize)};var Op={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(F){return F}},Vi=function(F){this.options=ka(Object.create(Op),F),this.trees=new Array(this.options.maxZoom+1)};function hl(F,z,U,K,ie){return{x:F,y:z,zoom:1/0,id:U,parentId:-1,numPoints:K,properties:ie}}function er(F,z){var U=F.geometry.coordinates,K=U[1];return{x:Us(U[0]),y:Dn(K),zoom:1/0,index:z,parentId:-1}}function Ia(F){return{type:"Feature",id:F.id,properties:fl(F),geometry:{type:"Point",coordinates:[(K=F.x,360*(K-.5)),(z=F.y,U=(180-360*z)*Math.PI/180,360*Math.atan(Math.exp(U))/Math.PI-90)]}};var z,U,K}function fl(F){var z=F.numPoints,U=z>=1e4?Math.round(z/1e3)+"k":z>=1e3?Math.round(z/100)/10+"k":z;return ka(ka({},F.properties),{cluster:!0,cluster_id:F.id,point_count:z,point_count_abbreviated:U})}function Us(F){return F/360+.5}function Dn(F){var z=Math.sin(F*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function ka(F,z){for(var U in z)F[U]=z[U];return F}function No(F){return F.x}function js(F){return F.y}function Lp(F,z,U,K,ie,me){var _e=ie-U,J=me-K;if(0!==_e||0!==J){var Z=((F-U)*_e+(z-K)*J)/(_e*_e+J*J);Z>1?(U=ie,K=me):Z>0&&(U+=_e*Z,K+=J*Z)}return(_e=F-U)*_e+(J=z-K)*J}function ta(F,z,U,K){var ie={id:void 0===F?null:F,type:z,geometry:U,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(me){var _e=me.geometry,J=me.type;if("Point"===J||"MultiPoint"===J||"LineString"===J)pr(me,_e);else if("Polygon"===J||"MultiLineString"===J)for(var Z=0;Z<_e.length;Z++)pr(me,_e[Z]);else if("MultiPolygon"===J)for(Z=0;Z<_e.length;Z++)for(var se=0;se<_e[Z].length;se++)pr(me,_e[Z][se])}(ie),ie}function pr(F,z){for(var U=0;U<z.length;U+=3)F.minX=Math.min(F.minX,z[U]),F.minY=Math.min(F.minY,z[U+1]),F.maxX=Math.max(F.maxX,z[U]),F.maxY=Math.max(F.maxY,z[U+1])}function rs(F,z,U,K){if(z.geometry){var ie=z.geometry.coordinates,me=z.geometry.type,_e=Math.pow(U.tolerance/((1<<U.maxZoom)*U.extent),2),J=[],Z=z.id;if(U.promoteId?Z=z.properties[U.promoteId]:U.generateId&&(Z=K||0),"Point"===me)pl(ie,J);else if("MultiPoint"===me)for(var se=0;se<ie.length;se++)pl(ie[se],J);else if("LineString"===me)ml(ie,J,_e,!1);else if("MultiLineString"===me){if(U.lineMetrics){for(se=0;se<ie.length;se++)ml(ie[se],J=[],_e,!1),F.push(ta(Z,"LineString",J,z.properties));return}Wn(ie,J,_e,!1)}else if("Polygon"===me)Wn(ie,J,_e,!0);else{if("MultiPolygon"!==me){if("GeometryCollection"===me){for(se=0;se<z.geometry.geometries.length;se++)rs(F,{id:Z,geometry:z.geometry.geometries[se],properties:z.properties},U,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(se=0;se<ie.length;se++){var Ue=[];Wn(ie[se],Ue,_e,!0),J.push(Ue)}}F.push(ta(Z,me,J,z.properties))}}function pl(F,z){z.push(Ts(F[0])),z.push($l(F[1])),z.push(0)}function ml(F,z,U,K){for(var ie,me,_e=0,J=0;J<F.length;J++){var Z=Ts(F[J][0]),se=$l(F[J][1]);z.push(Z),z.push(se),z.push(0),J>0&&(_e+=K?(ie*se-Z*me)/2:Math.sqrt(Math.pow(Z-ie,2)+Math.pow(se-me,2))),ie=Z,me=se}var Ue=z.length-3;z[2]=1,function Je(Te,$e,ct,dt){for(var xt,Ne=dt,rt=ct-$e>>1,Ve=ct-$e,Jt=Te[$e],en=Te[$e+1],ue=Te[ct],ur=Te[ct+1],jt=$e+3;jt<ct;jt+=3){var an=Lp(Te[jt],Te[jt+1],Jt,en,ue,ur);if(an>Ne)xt=jt,Ne=an;else if(an===Ne){var Cr=Math.abs(jt-rt);Cr<Ve&&(xt=jt,Ve=Cr)}}Ne>dt&&(xt-$e>3&&Je(Te,$e,xt,dt),Te[xt+2]=Ne,ct-xt>3&&Je(Te,xt,ct,dt))}(z,0,Ue,U),z[Ue+2]=1,z.size=Math.abs(_e),z.start=0,z.end=z.size}function Wn(F,z,U,K){for(var ie=0;ie<F.length;ie++){var me=[];ml(F[ie],me,U,K),z.push(me)}}function Ts(F){return F/360+.5}function $l(F){var z=Math.sin(F*Math.PI/180),U=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return U<0?0:U>1?1:U}function Hs(F,z,U,K,ie,me,_e,J){if(K/=z,me>=(U/=z)&&_e<K)return F;if(_e<U||me>=K)return null;for(var Z=[],se=0;se<F.length;se++){var Ue=F[se],Je=Ue.geometry,Te=Ue.type,$e=0===ie?Ue.minX:Ue.minY,ct=0===ie?Ue.maxX:Ue.maxY;if($e>=U&&ct<K)Z.push(Ue);else if(!(ct<U||$e>=K)){var dt=[];if("Point"===Te||"MultiPoint"===Te)Aa(Je,dt,U,K,ie);else if("LineString"===Te)Bc(Je,dt,U,K,ie,!1,J.lineMetrics);else if("MultiLineString"===Te)Ma(Je,dt,U,K,ie,!1);else if("Polygon"===Te)Ma(Je,dt,U,K,ie,!0);else if("MultiPolygon"===Te)for(var xt=0;xt<Je.length;xt++){var Ne=[];Ma(Je[xt],Ne,U,K,ie,!0),Ne.length&&dt.push(Ne)}if(dt.length){if(J.lineMetrics&&"LineString"===Te){for(xt=0;xt<dt.length;xt++)Z.push(ta(Ue.id,Te,dt[xt],Ue.tags));continue}"LineString"!==Te&&"MultiLineString"!==Te||(1===dt.length?(Te="LineString",dt=dt[0]):Te="MultiLineString"),"Point"!==Te&&"MultiPoint"!==Te||(Te=3===dt.length?"Point":"MultiPoint"),Z.push(ta(Ue.id,Te,dt,Ue.tags))}}}return Z.length?Z:null}function Aa(F,z,U,K,ie){for(var me=0;me<F.length;me+=3){var _e=F[me+ie];_e>=U&&_e<=K&&(z.push(F[me]),z.push(F[me+1]),z.push(F[me+2]))}}function Bc(F,z,U,K,ie,me,_e){for(var J,Z,se=Au(F),Ue=0===ie?nf:Ru,Je=F.start,Te=0;Te<F.length-3;Te+=3){var $e=F[Te],ct=F[Te+1],dt=F[Te+2],xt=F[Te+3],Ne=F[Te+4],rt=0===ie?$e:ct,Ve=0===ie?xt:Ne,Jt=!1;_e&&(J=Math.sqrt(Math.pow($e-xt,2)+Math.pow(ct-Ne,2))),rt<U?Ve>U&&(Z=Ue(se,$e,ct,xt,Ne,U),_e&&(se.start=Je+J*Z)):rt>K?Ve<K&&(Z=Ue(se,$e,ct,xt,Ne,K),_e&&(se.start=Je+J*Z)):Mu(se,$e,ct,dt),Ve<U&&rt>=U&&(Z=Ue(se,$e,ct,xt,Ne,U),Jt=!0),Ve>K&&rt<=K&&(Z=Ue(se,$e,ct,xt,Ne,K),Jt=!0),!me&&Jt&&(_e&&(se.end=Je+J*Z),z.push(se),se=Au(F)),_e&&(Je+=J)}var en=F.length-3;$e=F[en],ct=F[en+1],dt=F[en+2],(rt=0===ie?$e:ct)>=U&&rt<=K&&Mu(se,$e,ct,dt),en=se.length-3,me&&en>=3&&(se[en]!==se[0]||se[en+1]!==se[1])&&Mu(se,se[0],se[1],se[2]),se.length&&z.push(se)}function Au(F){var z=[];return z.size=F.size,z.start=F.start,z.end=F.end,z}function Ma(F,z,U,K,ie,me){for(var _e=0;_e<F.length;_e++)Bc(F[_e],z,U,K,ie,me,!1)}function Mu(F,z,U,K){F.push(z),F.push(U),F.push(K)}function nf(F,z,U,K,ie,me){var _e=(me-z)/(K-z);return F.push(me),F.push(U+(ie-U)*_e),F.push(1),_e}function Ru(F,z,U,K,ie,me){var _e=(me-U)/(ie-U);return F.push(z+(K-z)*_e),F.push(me),F.push(1),_e}function Vc(F,z){for(var U=[],K=0;K<F.length;K++){var ie,me=F[K],_e=me.type;if("Point"===_e||"MultiPoint"===_e||"LineString"===_e)ie=Ss(me.geometry,z);else if("MultiLineString"===_e||"Polygon"===_e){ie=[];for(var J=0;J<me.geometry.length;J++)ie.push(Ss(me.geometry[J],z))}else if("MultiPolygon"===_e)for(ie=[],J=0;J<me.geometry.length;J++){for(var Z=[],se=0;se<me.geometry[J].length;se++)Z.push(Ss(me.geometry[J][se],z));ie.push(Z)}U.push(ta(me.id,_e,ie,me.tags))}return U}function Ss(F,z){var U=[];U.size=F.size,void 0!==F.start&&(U.start=F.start,U.end=F.end);for(var K=0;K<F.length;K+=3)U.push(F[K]+z,F[K+1],F[K+2]);return U}function ql(F,z){if(F.transformed)return F;var U,K,ie,me=1<<F.z,_e=F.x,J=F.y;for(U=0;U<F.features.length;U++){var Z=F.features[U],se=Z.geometry,Ue=Z.type;if(Z.geometry=[],1===Ue)for(K=0;K<se.length;K+=2)Z.geometry.push(Ld(se[K],se[K+1],z,me,_e,J));else for(K=0;K<se.length;K++){var Je=[];for(ie=0;ie<se[K].length;ie+=2)Je.push(Ld(se[K][ie],se[K][ie+1],z,me,_e,J));Z.geometry.push(Je)}}return F.transformed=!0,F}function Ld(F,z,U,K,ie,me){return[Math.round(U*(F*K-ie)),Math.round(U*(z*K-me))]}function Pu(F,z,U,K,ie){for(var me=z===ie.maxZoom?0:ie.tolerance/((1<<z)*ie.extent),_e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:U,y:K,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},J=0;J<F.length;J++){_e.numFeatures++,Fd(_e,F[J],me,ie);var Z=F[J].minX,se=F[J].minY,Ue=F[J].maxX,Je=F[J].maxY;Z<_e.minX&&(_e.minX=Z),se<_e.minY&&(_e.minY=se),Ue>_e.maxX&&(_e.maxX=Ue),Je>_e.maxY&&(_e.maxY=Je)}return _e}function Fd(F,z,U,K){var ie=z.geometry,me=z.type,_e=[];if("Point"===me||"MultiPoint"===me)for(var J=0;J<ie.length;J+=3)_e.push(ie[J]),_e.push(ie[J+1]),F.numPoints++,F.numSimplified++;else if("LineString"===me)gl(_e,ie,F,U,!1,!1);else if("MultiLineString"===me||"Polygon"===me)for(J=0;J<ie.length;J++)gl(_e,ie[J],F,U,"Polygon"===me,0===J);else if("MultiPolygon"===me)for(var Z=0;Z<ie.length;Z++){var se=ie[Z];for(J=0;J<se.length;J++)gl(_e,se[J],F,U,!0,0===J)}if(_e.length){var Ue=z.tags||null;if("LineString"===me&&K.lineMetrics){for(var Je in Ue={},z.tags)Ue[Je]=z.tags[Je];Ue.mapbox_clip_start=ie.start/ie.size,Ue.mapbox_clip_end=ie.end/ie.size}var Te={geometry:_e,type:"Polygon"===me||"MultiPolygon"===me?3:"LineString"===me||"MultiLineString"===me?2:1,tags:Ue};null!==z.id&&(Te.id=z.id),F.features.push(Te)}}function gl(F,z,U,K,ie,me){var _e=K*K;if(K>0&&z.size<(ie?_e:K))U.numPoints+=z.length/3;else{for(var J=[],Z=0;Z<z.length;Z+=3)(0===K||z[Z+2]>_e)&&(U.numSimplified++,J.push(z[Z]),J.push(z[Z+1])),U.numPoints++;ie&&function(se,Ue){for(var Je=0,Te=0,$e=se.length,ct=$e-2;Te<$e;ct=Te,Te+=2)Je+=(se[Te]-se[ct])*(se[Te+1]+se[ct+1]);if(Je>0===Ue)for(Te=0,$e=se.length;Te<$e/2;Te+=2){var dt=se[Te],xt=se[Te+1];se[Te]=se[$e-2-Te],se[Te+1]=se[$e-1-Te],se[$e-2-Te]=dt,se[$e-1-Te]=xt}}(J,me),F.push(J)}}function Gl(F,z){var U=(z=this.options=function(ie,me){for(var _e in me)ie[_e]=me[_e];return ie}(Object.create(this.options),z)).debug;if(U&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var ie,me,_e,J,Z,se,K=function(ie,me){var _e=[];if("FeatureCollection"===ie.type)for(var J=0;J<ie.features.length;J++)rs(_e,ie.features[J],me,J);else rs(_e,"Feature"===ie.type?ie:{geometry:ie},me);return _e}(F,z);this.tiles={},this.tileCoords=[],U&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ie=K,me=z,_e=me.buffer/me.extent,J=ie,Z=Hs(ie,1,-1-_e,_e,0,-1,2,me),se=Hs(ie,1,1-_e,2+_e,0,-1,2,me),(Z||se)&&(J=Hs(ie,1,-_e,1+_e,0,-1,2,me)||[],Z&&(J=Vc(Z,1).concat(J)),se&&(J=J.concat(Vc(se,-1)))),K=J).length&&this.splitTile(K,0,0,0),U&&(K.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ra(F,z,U){return 32*((1<<F)*U+z)+F}function zc(F,z){var U=F.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);var K=this._geoJSONIndex.getTile(U.z,U.x,U.y);if(!K)return z(null,null);var ie=new ns(K.features),me=Es(ie);0===me.byteOffset&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),z(null,{vectorTile:ie,rawData:me.buffer})}Vi.prototype.load=function(F){var z=this.options,U=z.log,K=z.minZoom,ie=z.maxZoom,me=z.nodeSize;U&&console.time("total time");var _e="prepare "+F.length+" points";U&&console.time(_e),this.points=F;for(var J=[],Z=0;Z<F.length;Z++)F[Z].geometry&&J.push(er(F[Z],Z));this.trees[ie+1]=new dl(J,No,js,me,Float32Array),U&&console.timeEnd(_e);for(var se=ie;se>=K;se--){var Ue=+Date.now();J=this._cluster(J,se),this.trees[se]=new dl(J,No,js,me,Float32Array),U&&console.log("z%d: %d clusters in %dms",se,J.length,+Date.now()-Ue)}return U&&console.timeEnd("total time"),this},Vi.prototype.getClusters=function(F,z){var U=((F[0]+180)%360+360)%360-180,K=Math.max(-90,Math.min(90,F[1])),ie=180===F[2]?180:((F[2]+180)%360+360)%360-180,me=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)U=-180,ie=180;else if(U>ie){var _e=this.getClusters([U,K,180,me],z),J=this.getClusters([-180,K,ie,me],z);return _e.concat(J)}for(var Z=this.trees[this._limitZoom(z)],se=[],Ue=0,Je=Z.range(Us(U),Dn(me),Us(ie),Dn(K));Ue<Je.length;Ue+=1){var Te=Z.points[Je[Ue]];se.push(Te.numPoints?Ia(Te):this.points[Te.index])}return se},Vi.prototype.getChildren=function(F){var z=this._getOriginId(F),U=this._getOriginZoom(F),K="No cluster with the specified id.",ie=this.trees[U];if(!ie)throw new Error(K);var me=ie.points[z];if(!me)throw new Error(K);for(var _e=this.options.radius/(this.options.extent*Math.pow(2,U-1)),J=[],Z=0,se=ie.within(me.x,me.y,_e);Z<se.length;Z+=1){var Ue=ie.points[se[Z]];Ue.parentId===F&&J.push(Ue.numPoints?Ia(Ue):this.points[Ue.index])}if(0===J.length)throw new Error(K);return J},Vi.prototype.getLeaves=function(F,z,U){var K=[];return this._appendLeaves(K,F,z=z||10,U=U||0,0),K},Vi.prototype.getTile=function(F,z,U){var K=this.trees[this._limitZoom(F)],ie=Math.pow(2,F),me=this.options,_e=me.radius/me.extent,J=(U-_e)/ie,Z=(U+1+_e)/ie,se={features:[]};return this._addTileFeatures(K.range((z-_e)/ie,J,(z+1+_e)/ie,Z),K.points,z,U,ie,se),0===z&&this._addTileFeatures(K.range(1-_e/ie,J,1,Z),K.points,ie,U,ie,se),z===ie-1&&this._addTileFeatures(K.range(0,J,_e/ie,Z),K.points,-1,U,ie,se),se.features.length?se:null},Vi.prototype.getClusterExpansionZoom=function(F){for(var z=this._getOriginZoom(F)-1;z<=this.options.maxZoom;){var U=this.getChildren(F);if(z++,1!==U.length)break;F=U[0].properties.cluster_id}return z},Vi.prototype._appendLeaves=function(F,z,U,K,ie){for(var me=0,_e=this.getChildren(z);me<_e.length;me+=1){var J=_e[me],Z=J.properties;if(Z&&Z.cluster?ie+Z.point_count<=K?ie+=Z.point_count:ie=this._appendLeaves(F,Z.cluster_id,U,K,ie):ie<K?ie++:F.push(J),F.length===U)break}return ie},Vi.prototype._addTileFeatures=function(F,z,U,K,ie,me){for(var _e=0,J=F;_e<J.length;_e+=1){var Z=z[J[_e]],se=Z.numPoints,Ue={type:1,geometry:[[Math.round(this.options.extent*(Z.x*ie-U)),Math.round(this.options.extent*(Z.y*ie-K))]],tags:se?fl(Z):this.points[Z.index].properties},Je=void 0;se?Je=Z.id:this.options.generateId?Je=Z.index:this.points[Z.index].id&&(Je=this.points[Z.index].id),void 0!==Je&&(Ue.id=Je),me.features.push(Ue)}},Vi.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},Vi.prototype._cluster=function(F,z){for(var U=[],K=this.options,ie=K.reduce,me=K.minPoints,_e=K.radius/(K.extent*Math.pow(2,z)),J=0;J<F.length;J++){var Z=F[J];if(!(Z.zoom<=z)){Z.zoom=z;for(var se=this.trees[z+1],Ue=se.within(Z.x,Z.y,_e),Je=Z.numPoints||1,Te=Je,$e=0,ct=Ue;$e<ct.length;$e+=1){var dt=se.points[ct[$e]];dt.zoom>z&&(Te+=dt.numPoints||1)}if(Te>=me){for(var xt=Z.x*Je,Ne=Z.y*Je,rt=ie&&Je>1?this._map(Z,!0):null,Ve=(J<<5)+(z+1)+this.points.length,Jt=0,en=Ue;Jt<en.length;Jt+=1){var ue=se.points[en[Jt]];if(!(ue.zoom<=z)){ue.zoom=z;var ur=ue.numPoints||1;xt+=ue.x*ur,Ne+=ue.y*ur,ue.parentId=Ve,ie&&(rt||(rt=this._map(Z,!0)),ie(rt,this._map(ue)))}}Z.parentId=Ve,U.push(hl(xt/Te,Ne/Te,Ve,Te,rt))}else if(U.push(Z),Te>1)for(var jt=0,an=Ue;jt<an.length;jt+=1){var Cr=se.points[an[jt]];Cr.zoom<=z||(Cr.zoom=z,U.push(Cr))}}}return U},Vi.prototype._getOriginId=function(F){return F-this.points.length>>5},Vi.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},Vi.prototype._map=function(F,z){if(F.numPoints)return z?ka({},F.properties):F.properties;var U=this.points[F.index].properties,K=this.options.map(U);return z&&K===U?ka({},K):K},Gl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gl.prototype.splitTile=function(F,z,U,K,ie,me,_e){for(var J=[F,z,U,K],Z=this.options,se=Z.debug;J.length;){K=J.pop(),U=J.pop(),z=J.pop(),F=J.pop();var Ue=1<<z,Je=Ra(z,U,K),Te=this.tiles[Je];if(!Te&&(se>1&&console.time("creation"),Te=this.tiles[Je]=Pu(F,z,U,K,Z),this.tileCoords.push({z,x:U,y:K}),se)){se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,U,K,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var $e="z"+z;this.stats[$e]=(this.stats[$e]||0)+1,this.total++}if(Te.source=F,ie){if(z===Z.maxZoom||z===ie)continue;var ct=1<<ie-z;if(U!==Math.floor(me/ct)||K!==Math.floor(_e/ct))continue}else if(z===Z.indexMaxZoom||Te.numPoints<=Z.indexMaxPoints)continue;if(Te.source=null,0!==F.length){se>1&&console.time("clipping");var dt,xt,Ne,rt,Ve,Jt,en=.5*Z.buffer/Z.extent,ue=.5-en,ur=.5+en,jt=1+en;dt=xt=Ne=rt=null,Ve=Hs(F,Ue,U-en,U+ur,0,Te.minX,Te.maxX,Z),Jt=Hs(F,Ue,U+ue,U+jt,0,Te.minX,Te.maxX,Z),F=null,Ve&&(dt=Hs(Ve,Ue,K-en,K+ur,1,Te.minY,Te.maxY,Z),xt=Hs(Ve,Ue,K+ue,K+jt,1,Te.minY,Te.maxY,Z),Ve=null),Jt&&(Ne=Hs(Jt,Ue,K-en,K+ur,1,Te.minY,Te.maxY,Z),rt=Hs(Jt,Ue,K+ue,K+jt,1,Te.minY,Te.maxY,Z),Jt=null),se>1&&console.timeEnd("clipping"),J.push(dt||[],z+1,2*U,2*K),J.push(xt||[],z+1,2*U,2*K+1),J.push(Ne||[],z+1,2*U+1,2*K),J.push(rt||[],z+1,2*U+1,2*K+1)}}},Gl.prototype.getTile=function(F,z,U){var K=this.options,ie=K.extent,me=K.debug;if(F<0||F>24)return null;var _e=1<<F,J=Ra(F,z=(z%_e+_e)%_e,U);if(this.tiles[J])return ql(this.tiles[J],ie);me>1&&console.log("drilling down to z%d-%d-%d",F,z,U);for(var Z,se=F,Ue=z,Je=U;!Z&&se>0;)se--,Ue=Math.floor(Ue/2),Je=Math.floor(Je/2),Z=this.tiles[Ra(se,Ue,Je)];return Z&&Z.source?(me>1&&console.log("found parent tile z%d-%d-%d",se,Ue,Je),me>1&&console.time("drilling down"),this.splitTile(Z.source,se,Ue,Je,F,z,U),me>1&&console.timeEnd("drilling down"),this.tiles[J]?ql(this.tiles[J],ie):null):null};var Wl=function(F){function z(U,K,ie,me){F.call(this,U,K,ie,zc),me&&(this.loadGeoJSON=me)}return F&&(z.__proto__=F),(z.prototype=Object.create(F&&F.prototype)).constructor=z,z.prototype.loadData=function(U,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=K,this._pendingLoadDataParams=U,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},z.prototype._loadData=function(){var U=this;if(this._pendingCallback&&this._pendingLoadDataParams){var K=this._pendingCallback,ie=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var me=!!(ie&&ie.request&&ie.request.collectResourceTiming)&&new v.RequestPerformance(ie.request);this.loadGeoJSON(ie,function(_e,J){if(_e||!J)return K(_e);if("object"!=typeof J)return K(new Error("Input data given to '"+ie.source+"' is not a valid GeoJSON object."));!function Te($e,ct){var dt,xt=$e&&$e.type;if("FeatureCollection"===xt)for(dt=0;dt<$e.features.length;dt++)Te($e.features[dt],ct);else if("GeometryCollection"===xt)for(dt=0;dt<$e.geometries.length;dt++)Te($e.geometries[dt],ct);else if("Feature"===xt)Te($e.geometry,ct);else if("Polygon"===xt)Su($e.coordinates,ct);else if("MultiPolygon"===xt)for(dt=0;dt<$e.coordinates.length;dt++)Su($e.coordinates[dt],ct);return $e}(J,!0);try{if(ie.filter){var Z=v.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Z.result)throw new Error(Z.value.map(function(Te){return Te.key+": "+Te.message}).join(", "));var se=J.features.filter(function(Te){return Z.value.evaluate({zoom:0},Te)});J={type:"FeatureCollection",features:se}}U._geoJSONIndex=ie.cluster?new Vi(function(Te){var $e=Te.superclusterOptions,ct=Te.clusterProperties;if(!ct||!$e)return $e;for(var dt={},xt={},Ne={accumulated:null,zoom:0},rt={properties:null},Ve=Object.keys(ct),Jt=0,en=Ve;Jt<en.length;Jt+=1){var ue=en[Jt],ur=ct[ue],jt=ur[0],an=v.createExpression(ur[1]),Cr=v.createExpression("string"==typeof jt?[jt,["accumulated"],["get",ue]]:jt);dt[ue]=an.value,xt[ue]=Cr.value}return $e.map=function(On){rt.properties=On;for(var pt={},Fr=0,xn=Ve;Fr<xn.length;Fr+=1){var fn=xn[Fr];pt[fn]=dt[fn].evaluate(Ne,rt)}return pt},$e.reduce=function(On,pt){rt.properties=pt;for(var Fr=0,xn=Ve;Fr<xn.length;Fr+=1){var fn=xn[Fr];Ne.accumulated=On[fn],On[fn]=xt[fn].evaluate(Ne,rt)}},$e}(ie)).load(J.features):new Gl(Te=J,ie.geojsonVtOptions)}catch(Te){return K(Te)}var Te;U.loaded={};var Ue={};if(me){var Je=me.finish();Je&&(Ue.resourceTiming={},Ue.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Je)))}K(null,Ue)})}},z.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},z.prototype.reloadTile=function(U,K){var ie=this.loaded;return ie&&ie[U.uid]?F.prototype.reloadTile.call(this,U,K):this.loadTile(U,K)},z.prototype.loadGeoJSON=function(U,K){if(U.request)v.getJSON(U.request,K);else{if("string"!=typeof U.data)return K(new Error("Input data given to '"+U.source+"' is not a valid GeoJSON object."));try{return K(null,JSON.parse(U.data))}catch{return K(new Error("Input data given to '"+U.source+"' is not a valid GeoJSON object."))}}},z.prototype.removeSource=function(U,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()},z.prototype.getClusterExpansionZoom=function(U,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(ie){K(ie)}},z.prototype.getClusterChildren=function(U,K){try{K(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(ie){K(ie)}},z.prototype.getClusterLeaves=function(U,K){try{K(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(ie){K(ie)}},z}(Ro),tr=function(F){var z=this;this.self=F,this.actor=new v.Actor(F,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ro,geojson:Wl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(U,K){if(z.workerSourceTypes[U])throw new Error('Worker source with name "'+U+'" already registered.');z.workerSourceTypes[U]=K},this.self.registerRTLTextPlugin=function(U){if(v.plugin.isParsed())throw new Error("RTL text plugin already registered.");v.plugin.applyArabicShaping=U.applyArabicShaping,v.plugin.processBidirectionalText=U.processBidirectionalText,v.plugin.processStyledBidirectionalText=U.processStyledBidirectionalText}};return tr.prototype.setReferrer=function(F,z){this.referrer=z},tr.prototype.setImages=function(F,z,U){for(var K in this.availableImages[F]=z,this.workerSources[F]){var ie=this.workerSources[F][K];for(var me in ie)ie[me].availableImages=z}U()},tr.prototype.setLayers=function(F,z,U){this.getLayerIndex(F).replace(z),U()},tr.prototype.updateLayers=function(F,z,U){this.getLayerIndex(F).update(z.layers,z.removedIds),U()},tr.prototype.loadTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).loadTile(z,U)},tr.prototype.loadDEMTile=function(F,z,U){this.getDEMWorkerSource(F,z.source).loadTile(z,U)},tr.prototype.reloadTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).reloadTile(z,U)},tr.prototype.abortTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).abortTile(z,U)},tr.prototype.removeTile=function(F,z,U){this.getWorkerSource(F,z.type,z.source).removeTile(z,U)},tr.prototype.removeDEMTile=function(F,z){this.getDEMWorkerSource(F,z.source).removeTile(z)},tr.prototype.removeSource=function(F,z,U){if(this.workerSources[F]&&this.workerSources[F][z.type]&&this.workerSources[F][z.type][z.source]){var K=this.workerSources[F][z.type][z.source];delete this.workerSources[F][z.type][z.source],void 0!==K.removeSource?K.removeSource(z,U):U()}},tr.prototype.loadWorkerSource=function(F,z,U){try{this.self.importScripts(z.url),U()}catch(K){U(K.toString())}},tr.prototype.syncRTLPluginState=function(F,z,U){try{v.plugin.setState(z);var K=v.plugin.getPluginURL();if(v.plugin.isLoaded()&&!v.plugin.isParsed()&&null!=K){this.self.importScripts(K);var ie=v.plugin.isParsed();U(ie?void 0:new Error("RTL Text Plugin failed to import scripts from "+K),ie)}}catch(me){U(me.toString())}},tr.prototype.getAvailableImages=function(F){var z=this.availableImages[F];return z||(z=[]),z},tr.prototype.getLayerIndex=function(F){var z=this.layerIndexes[F];return z||(z=this.layerIndexes[F]=new Tt),z},tr.prototype.getWorkerSource=function(F,z,U){var K=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][z]||(this.workerSources[F][z]={}),this.workerSources[F][z][U]||(this.workerSources[F][z][U]=new this.workerSourceTypes[z]({send:function(ie,me,_e){K.actor.send(ie,me,_e,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][z][U]},tr.prototype.getDEMWorkerSource=function(F,z){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][z]||(this.demWorkerSources[F][z]=new to),this.demWorkerSources[F][z]},tr.prototype.enforceCacheSizeLimit=function(F,z){v.enforceCacheSizeLimit(z)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new tr(self)),tr}),Od(0,function(v){var Zo=v.createCommonjsModule(function(d){function p(w){return!h(w)}function h(w){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,I,R=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(R);try{I=new Worker(L),T=!0}catch{T=!1}return I&&I.terminate(),URL.revokeObjectURL(L),T}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var T=document.createElement("canvas");T.width=T.height=1;var I=T.getContext("2d");if(!I)return!1;var R=I.getImageData(0,0,1,1);return R&&R.width===T.width}()?(void 0===g[C=w&&w.failIfMajorPerformanceCaveat]&&(g[C]=function(T){var L,q,W,I=(L=T,q=document.createElement("canvas"),(W=Object.create(p.webGLContextAttributes)).failIfMajorPerformanceCaveat=L,q.probablySupportsContext?q.probablySupportsContext("webgl",W)||q.probablySupportsContext("experimental-webgl",W):q.supportsContext?q.supportsContext("webgl",W)||q.supportsContext("experimental-webgl",W):q.getContext("webgl",W)||q.getContext("experimental-webgl",W));if(!I)return!1;var R=I.createShader(I.VERTEX_SHADER);return!(!R||I.isContextLost())&&(I.shaderSource(R,"void main() {}"),I.compileShader(R),!0===I.getShaderParameter(R,I.COMPILE_STATUS))}(C)),g[C]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var C}d.exports?d.exports=p:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=p,window.mapboxgl.notSupportedReason=h);var g={};p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),ze={create:function(d,p,h){var g=v.window.document.createElement(d);return void 0!==p&&(g.className=p),h&&h.appendChild(g),g},createNS:function(d,p){return v.window.document.createElementNS(d,p)}},Tt=v.window.document&&v.window.document.documentElement.style;function Gt(d){if(!Tt)return d[0];for(var p=0;p<d.length;p++)if(d[p]in Tt)return d[p];return d[0]}var cl,_t=Gt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);ze.disableDrag=function(){Tt&&_t&&(cl=Tt[_t],Tt[_t]="none")},ze.enableDrag=function(){Tt&&_t&&(Tt[_t]=cl)};var zl=Gt(["transform","WebkitTransform"]);ze.setTransform=function(d,p){d.style[zl]=p};var Ro=!1;try{var Oc=Object.defineProperty({},"passive",{get:function(){Ro=!0}});v.window.addEventListener("test",Oc,Oc),v.window.removeEventListener("test",Oc,Oc)}catch{Ro=!1}ze.addEventListener=function(d,p,h,g){void 0===g&&(g={}),d.addEventListener(p,h,"passive"in g&&Ro?g:g.capture)},ze.removeEventListener=function(d,p,h,g){void 0===g&&(g={}),d.removeEventListener(p,h,"passive"in g&&Ro?g:g.capture)};var to=function(d){d.preventDefault(),d.stopPropagation(),v.window.removeEventListener("click",to,!0)};function Su(d){var p=d.userImage;return!!(p&&p.render&&p.render())&&(d.data.replace(new Uint8Array(p.data.buffer)),!0)}ze.suppressClick=function(){v.window.addEventListener("click",to,!0),v.window.setTimeout(function(){v.window.removeEventListener("click",to,!0)},0)},ze.mousePos=function(d,p){var h=d.getBoundingClientRect();return new v.Point(p.clientX-h.left-d.clientLeft,p.clientY-h.top-d.clientTop)},ze.touchPos=function(d,p){for(var h=d.getBoundingClientRect(),g=[],w=0;w<p.length;w++)g.push(new v.Point(p[w].clientX-h.left-d.clientLeft,p[w].clientY-h.top-d.clientTop));return g},ze.mouseButton=function(d){return void 0!==v.window.InstallTrigger&&2===d.button&&d.ctrlKey&&v.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button},ze.remove=function(d){d.parentNode&&d.parentNode.removeChild(d)};var Fi=function(d){function p(){d.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new v.RGBAImage({width:1,height:1}),this.dirty=!0}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.isLoaded=function(){return this.loaded},p.prototype.setLoaded=function(h){if(this.loaded!==h&&(this.loaded=h,h)){for(var g=0,w=this.requestors;g<w.length;g+=1){var C=w[g];this._notify(C.ids,C.callback)}this.requestors=[]}},p.prototype.getImage=function(h){return this.images[h]},p.prototype.addImage=function(h,g){this._validate(h,g)&&(this.images[h]=g)},p.prototype._validate=function(h,g){var w=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchX" value'))),w=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "stretchY" value'))),w=!1),this._validateContent(g.content,g)||(this.fire(new v.ErrorEvent(new Error('Image "'+h+'" has invalid "content" value'))),w=!1),w},p.prototype._validateStretch=function(h,g){if(!h)return!0;for(var w=0,C=0,T=h;C<T.length;C+=1){var I=T[C];if(I[0]<w||I[1]<I[0]||g<I[1])return!1;w=I[1]}return!0},p.prototype._validateContent=function(h,g){return!(h&&(4!==h.length||h[0]<0||g.data.width<h[0]||h[1]<0||g.data.height<h[1]||h[2]<0||g.data.width<h[2]||h[3]<0||g.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))},p.prototype.updateImage=function(h,g){g.version=this.images[h].version+1,this.images[h]=g,this.updatedImages[h]=!0},p.prototype.removeImage=function(h){var g=this.images[h];delete this.images[h],delete this.patterns[h],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()},p.prototype.listImages=function(){return Object.keys(this.images)},p.prototype.getImages=function(h,g){var w=!0;if(!this.isLoaded())for(var C=0,T=h;C<T.length;C+=1)this.images[T[C]]||(w=!1);this.isLoaded()||w?this._notify(h,g):this.requestors.push({ids:h,callback:g})},p.prototype._notify=function(h,g){for(var w={},C=0,T=h;C<T.length;C+=1){var I=T[C];this.images[I]||this.fire(new v.Event("styleimagemissing",{id:I}));var R=this.images[I];R?w[I]={data:R.data.clone(),pixelRatio:R.pixelRatio,sdf:R.sdf,version:R.version,stretchX:R.stretchX,stretchY:R.stretchY,content:R.content,hasRenderCallback:!(!R.userImage||!R.userImage.render)}:v.warnOnce('Image "'+I+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}g(null,w)},p.prototype.getPixelSize=function(){var h=this.atlasImage;return{width:h.width,height:h.height}},p.prototype.getPattern=function(h){var g=this.patterns[h],w=this.getImage(h);if(!w)return null;if(g&&g.position.version===w.version)return g.position;if(g)g.position.version=w.version;else{var C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},T=new v.ImagePosition(C,w);this.patterns[h]={bin:C,position:T}}return this._updatePatternAtlas(),this.patterns[h].position},p.prototype.bind=function(h){var g=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v.Texture(h,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)},p.prototype._updatePatternAtlas=function(){var h=[];for(var g in this.patterns)h.push(this.patterns[g].bin);var w=v.potpack(h),C=w.w,T=w.h,I=this.atlasImage;for(var R in I.resize({width:C||1,height:T||1}),this.patterns){var L=this.patterns[R].bin,q=L.x+1,W=L.y+1,H=this.images[R].data,oe=H.width,ne=H.height;v.RGBAImage.copy(H,I,{x:0,y:0},{x:q,y:W},{width:oe,height:ne}),v.RGBAImage.copy(H,I,{x:0,y:ne-1},{x:q,y:W-1},{width:oe,height:1}),v.RGBAImage.copy(H,I,{x:0,y:0},{x:q,y:W+ne},{width:oe,height:1}),v.RGBAImage.copy(H,I,{x:oe-1,y:0},{x:q-1,y:W},{width:1,height:ne}),v.RGBAImage.copy(H,I,{x:0,y:0},{x:q+oe,y:W},{width:1,height:ne})}this.dirty=!0},p.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},p.prototype.dispatchRenderCallbacks=function(h){for(var g=0,w=h;g<w.length;g+=1){var C=w[g];if(!this.callbackDispatchedThisFrame[C]){this.callbackDispatchedThisFrame[C]=!0;var T=this.images[C];Su(T)&&this.updateImage(C,T)}}},p}(v.Evented),tf=Iu,ul=Iu,ns=1e20;function Iu(d,p,h,g,w,C){this.fontSize=d||24,this.buffer=void 0===p?3:p,this.cutoff=g||.25,this.fontFamily=w||"sans-serif",this.fontWeight=C||"normal",this.radius=h||8;var T=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=T,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.d=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Int16Array(T),this.middle=Math.round(T/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Da(d,p,h,g,w,C,T){for(var I=0;I<p;I++){for(var R=0;R<h;R++)g[R]=d[R*p+I];for(Lc(g,w,C,T,h),R=0;R<h;R++)d[R*p+I]=w[R]}for(R=0;R<h;R++){for(I=0;I<p;I++)g[I]=d[R*p+I];for(Lc(g,w,C,T,p),I=0;I<p;I++)d[R*p+I]=Math.sqrt(w[I])}}function Lc(d,p,h,g,w){h[0]=0,g[0]=-ns,g[1]=+ns;for(var C=1,T=0;C<w;C++){for(var I=(d[C]+C*C-(d[h[T]]+h[T]*h[T]))/(2*C-2*h[T]);I<=g[T];)T--,I=(d[C]+C*C-(d[h[T]]+h[T]*h[T]))/(2*C-2*h[T]);h[++T]=C,g[T]=I,g[T+1]=+ns}for(C=0,T=0;C<w;C++){for(;g[T+1]<C;)T++;p[C]=(C-h[T])*(C-h[T])+d[h[T]]}}Iu.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var p=this.ctx.getImageData(0,0,this.size,this.size),h=new Uint8ClampedArray(this.size*this.size),g=0;g<this.size*this.size;g++){var w=p.data[4*g+3]/255;this.gridOuter[g]=1===w?0:0===w?ns:Math.pow(Math.max(0,.5-w),2),this.gridInner[g]=1===w?ns:0===w?0:Math.pow(Math.max(0,w-.5),2)}for(Da(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Da(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),g=0;g<this.size*this.size;g++)h[g]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[g]-this.gridInner[g])/this.radius+this.cutoff))));return h},tf.default=ul;var Bi=function(d,p){this.requestManager=d,this.localIdeographFontFamily=p,this.entries={}};Bi.prototype.setURL=function(d){this.url=d},Bi.prototype.getGlyphs=function(d,p){var h=this,g=[];for(var w in d)for(var C=0,T=d[w];C<T.length;C+=1)g.push({stack:w,id:T[C]});v.asyncAll(g,function(I,R){var L=I.stack,q=I.id,W=h.entries[L];W||(W=h.entries[L]={glyphs:{},requests:{},ranges:{}});var H=W.glyphs[q];if(void 0===H){if(H=h._tinySDF(W,L,q))return W.glyphs[q]=H,void R(null,{stack:L,id:q,glyph:H});var oe=Math.floor(q/256);if(256*oe>65535)R(new Error("glyphs > 65535 not supported"));else if(W.ranges[oe])R(null,{stack:L,id:q,glyph:H});else{var ne=W.requests[oe];ne||(ne=W.requests[oe]=[],Bi.loadGlyphRange(L,oe,h.url,h.requestManager,function(de,re){if(re){for(var ae in re)h._doesCharSupportLocalGlyph(+ae)||(W.glyphs[+ae]=re[+ae]);W.ranges[oe]=!0}for(var ge=0,be=ne;ge<be.length;ge+=1)(0,be[ge])(de,re);delete W.requests[oe]})),ne.push(function(de,re){de?R(de):re&&R(null,{stack:L,id:q,glyph:re[q]||null})})}}else R(null,{stack:L,id:q,glyph:H})},function(I,R){if(I)p(I);else if(R){for(var L={},q=0,W=R;q<W.length;q+=1){var H=W[q],oe=H.stack,ne=H.id,de=H.glyph;(L[oe]||(L[oe]={}))[ne]=de&&{id:de.id,bitmap:de.bitmap.clone(),metrics:de.metrics}}p(null,L)}})},Bi.prototype._doesCharSupportLocalGlyph=function(d){return!!this.localIdeographFontFamily&&(v.isChar["CJK Unified Ideographs"](d)||v.isChar["Hangul Syllables"](d)||v.isChar.Hiragana(d)||v.isChar.Katakana(d))},Bi.prototype._tinySDF=function(d,p,h){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(h)){var w=d.tinySDF;if(!w){var C="400";/bold/i.test(p)?C="900":/medium/i.test(p)?C="500":/light/i.test(p)&&(C="200"),w=d.tinySDF=new Bi.TinySDF(24,3,8,.25,g,C)}return{id:h,bitmap:new v.AlphaImage({width:30,height:30},w.draw(String.fromCharCode(h))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Bi.loadGlyphRange=function(d,p,h,g,w){var C=256*p,T=C+255,I=g.transformRequest(g.normalizeGlyphsURL(h).replace("{fontstack}",d).replace("{range}",C+"-"+T),v.ResourceType.Glyphs);v.getArrayBuffer(I,function(R,L){if(R)w(R);else if(L){for(var q={},W=0,H=v.parseGlyphPBF(L);W<H.length;W+=1){var oe=H[W];q[oe.id]=oe}w(null,q)}})},Bi.TinySDF=tf;var Es=function(){this.specification=v.styleSpec.light.position};Es.prototype.possiblyEvaluate=function(d,p){return v.sphericalToCartesian(d.expression.evaluate(p))},Es.prototype.interpolate=function(d,p,h){return{x:v.number(d.x,p.x,h),y:v.number(d.y,p.y,h),z:v.number(d.z,p.z,h)}};var zs=new v.Properties({anchor:new v.DataConstantProperty(v.styleSpec.light.anchor),position:new Es,color:new v.DataConstantProperty(v.styleSpec.light.color),intensity:new v.DataConstantProperty(v.styleSpec.light.intensity)}),Ul=function(d){function p(h){d.call(this),this._transitionable=new v.Transitionable(zs),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getLight=function(){return this._transitionable.serialize()},p.prototype.setLight=function(h,g){if(void 0===g&&(g={}),!this._validate(v.validateLight,h,g))for(var w in h){var C=h[w];v.endsWith(w,"-transition")?this._transitionable.setTransition(w.slice(0,-11),C):this._transitionable.setValue(w,C)}},p.prototype.updateTransitions=function(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)},p.prototype.hasTransition=function(){return this._transitioning.hasTransition()},p.prototype.recalculate=function(h){this.properties=this._transitioning.possiblyEvaluate(h)},p.prototype._validate=function(h,g,w){return(!w||!1!==w.validate)&&v.emitValidationErrors(this,h.call(v.validateStyle,v.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:v.styleSpec})))},p}(v.Evented),fr=function(d,p){this.width=d,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};fr.prototype.getDash=function(d,p){var h=d.join(",")+String(p);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(d,p)),this.dashEntry[h]},fr.prototype.getDashRanges=function(d,p,h){var g=[],w=d.length%2==1?-d[d.length-1]*h:0,C=d[0]*h,T=!0;g.push({left:w,right:C,isDash:T,zeroLength:0===d[0]});for(var I=d[0],R=1;R<d.length;R++){var L=d[R];g.push({left:w=I*h,right:C=(I+=L)*h,isDash:T=!T,zeroLength:0===L})}return g},fr.prototype.addRoundDash=function(d,p,h){for(var g=p/2,w=-h;w<=h;w++)for(var C=this.width*(this.nextRow+h+w),T=0,I=d[T],R=0;R<this.width;R++){R/I.right>1&&(I=d[++T]);var L=Math.abs(R-I.left),q=Math.abs(R-I.right),W=Math.min(L,q),H=void 0,oe=w/h*(g+1);if(I.isDash){var ne=g-Math.abs(oe);H=Math.sqrt(W*W+ne*ne)}else H=g-Math.sqrt(W*W+oe*oe);this.data[C+R]=Math.max(0,Math.min(255,H+128))}},fr.prototype.addRegularDash=function(d){for(var p=d.length-1;p>=0;--p){var h=d[p],g=d[p+1];h.zeroLength?d.splice(p,1):g&&g.isDash===h.isDash&&(g.left=h.left,d.splice(p,1))}var w=d[0],C=d[d.length-1];w.isDash===C.isDash&&(w.left=C.left-this.width,C.right=w.right+this.width);for(var T=this.width*this.nextRow,I=0,R=d[I],L=0;L<this.width;L++){L/R.right>1&&(R=d[++I]);var q=Math.abs(L-R.left),W=Math.abs(L-R.right),H=Math.min(q,W);this.data[T+L]=Math.max(0,Math.min(255,(R.isDash?H:-H)+128))}},fr.prototype.addDash=function(d,p){var h=p?7:0,g=2*h+1;if(this.nextRow+g>this.height)return v.warnOnce("LineAtlas out of space"),null;for(var w=0,C=0;C<d.length;C++)w+=d[C];if(0!==w){var T=this.width/w,I=this.getDashRanges(d,this.width,T);p?this.addRoundDash(I,T,h):this.addRegularDash(I)}var R={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:w};return this.nextRow+=g,this.dirty=!0,R},fr.prototype.bind=function(d){var p=d.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))};var Po=function d(p,h){this.workerPool=p,this.actors=[],this.currentActor=0,this.id=v.uniqueId();for(var g=this.workerPool.acquire(this.id),w=0;w<g.length;w++){var C=new d.Actor(g[w],h,this.id);C.name="Worker "+w,this.actors.push(C)}};function Np(d,p,h){var g=function(w,C){if(w)return h(w);if(C){var T=v.pick(v.extend(C,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(T.vectorLayers=C.vector_layers,T.vectorLayerIds=T.vectorLayers.map(function(I){return I.id})),T.tiles=p.canonicalizeTileset(T,d.url),h(null,T)}};return d.url?v.getJSON(p.transformRequest(p.normalizeSourceURL(d.url),v.ResourceType.Source),g):v.browser.frame(function(){return g(null,d)})}Po.prototype.broadcast=function(d,p,h){v.asyncAll(this.actors,function(g,w){g.send(d,p,w)},h=h||function(){})},Po.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Po.prototype.remove=function(){this.actors.forEach(function(d){d.remove()}),this.actors=[],this.workerPool.release(this.id)},Po.Actor=v.Actor;var Cs=function(d,p,h){this.bounds=v.LngLatBounds.convert(this.validateBounds(d)),this.minzoom=p||0,this.maxzoom=h||24};Cs.prototype.validateBounds=function(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]},Cs.prototype.contains=function(d){var p=Math.pow(2,d.z),h=Math.floor(v.mercatorXfromLng(this.bounds.getWest())*p),g=Math.floor(v.mercatorYfromLat(this.bounds.getNorth())*p),w=Math.ceil(v.mercatorXfromLng(this.bounds.getEast())*p),C=Math.ceil(v.mercatorYfromLat(this.bounds.getSouth())*p);return d.x>=h&&d.x<w&&d.y>=g&&d.y<C};var jl=function(d){function p(h,g,w,C){if(d.call(this),this.id=h,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,v.extend(this,v.pick(g,["url","scheme","tileSize","promoteId"])),this._options=v.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Np(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new Cs(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles,h.map._requestManager._customAccessToken),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken,h.map._requestManager._customAccessToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setSourceProperty=function(h){this._tileJSONRequest&&this._tileJSONRequest.cancel(),h(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},p.prototype.setTiles=function(h){var g=this;return this.setSourceProperty(function(){g._options.tiles=h}),this},p.prototype.setUrl=function(h){var g=this;return this.setSourceProperty(function(){g.url=h,g._options.url=h}),this},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),C={request:this.map._requestManager.transformRequest(w,v.ResourceType.Tile),uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function T(I,R){return delete h.request,h.aborted?g(null):I&&404!==I.status?g(I):(R&&R.resourceTiming&&(h.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&h.setExpiryData(R),h.loadVectorData(R,this.map.painter),v.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state?"loading"===h.state?h.reloadCallback=g:h.request=h.actor.send("reloadTile",C,T.bind(this)):(h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",C,T.bind(this)))},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.unloadTile=function(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id},void 0)},p.prototype.hasTransition=function(){return!1},p}(v.Evented),ku=function(d){function p(h,g,w,C){d.call(this),this.id=h,this.dispatcher=w,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=v.extend({type:"raster"},g),v.extend(this,v.pick(g,["url","scheme","tileSize"]))}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Np(this._options,this.map._requestManager,function(g,w){h._tileJSONRequest=null,h._loaded=!0,g?h.fire(new v.ErrorEvent(g)):w&&(v.extend(h,w),w.bounds&&(h.tileBounds=new Cs(w.bounds,h.minzoom,h.maxzoom)),v.postTurnstileEvent(w.tiles),v.postMapLoadEvent(w.tiles,h.map._getMapId(),h.map._requestManager._skuToken),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})),h.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})))})},p.prototype.loaded=function(){return this._loaded},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},p.prototype.serialize=function(){return v.extend({},this._options)},p.prototype.hasTile=function(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)},p.prototype.loadTile=function(h,g){var w=this,C=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);h.request=v.getImage(this.map._requestManager.transformRequest(C,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){w.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var R=w.map.painter.context,L=R.gl;h.texture=w.map.painter.getTileTexture(I.width),h.texture?h.texture.update(I,{useMipmap:!0}):(h.texture=new v.Texture(R,I,L.RGBA,{useMipmap:!0}),h.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),R.extTextureFilterAnisotropic&&L.texParameterf(L.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax)),h.state="loaded",v.cacheEntryPossiblyAdded(w.dispatcher),g(null)}})},p.prototype.abortTile=function(h,g){h.request&&(h.request.cancel(),delete h.request),g()},p.prototype.unloadTile=function(h,g){h.texture&&this.map.painter.saveTileTexture(h.texture),g()},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Ta=function(d){function p(h,g,w,C){d.call(this,h,g,w,C),this.type="raster-dem",this.maxzoom=22,this._options=v.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},p.prototype.loadTile=function(h,g){var w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function C(T,I){T&&(h.state="errored",g(T)),I&&(h.dem=I,h.needsHillshadePrepare=!0,h.state="loaded",g(null))}h.request=v.getImage(this.map._requestManager.transformRequest(w,v.ResourceType.Tile),function(T,I){if(delete h.request,h.aborted)h.state="unloaded",g(null);else if(T)h.state="errored",g(T);else if(I){this.map._refreshExpiredTiles&&h.setExpiryData(I),delete I.cacheControl,delete I.expires;var R=v.window.ImageBitmap&&I instanceof v.window.ImageBitmap&&v.offscreenCanvasSupported()?I:v.browser.getImageData(I,1),L={uid:h.uid,coord:h.tileID,source:this.id,rawImageData:R,encoding:this.encoding};h.actor&&"expired"!==h.state||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",L,C.bind(this)))}}.bind(this)),h.neighboringTiles=this._getNeighboringTiles(h.tileID)},p.prototype._getNeighboringTiles=function(h){var g=h.canonical,w=Math.pow(2,g.z),C=(g.x-1+w)%w,T=0===g.x?h.wrap-1:h.wrap,I=(g.x+1+w)%w,R=g.x+1===w?h.wrap+1:h.wrap,L={};return L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y).key]={backfilled:!1},g.y>0&&(L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y-1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y-1).key]={backfilled:!1}),g.y+1<w&&(L[new v.OverscaledTileID(h.overscaledZ,T,g.z,C,g.y+1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,h.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},L[new v.OverscaledTileID(h.overscaledZ,R,g.z,I,g.y+1).key]={backfilled:!1}),L},p.prototype.unloadTile=function(h){h.demTexture&&this.map.painter.saveTileTexture(h.demTexture),h.fbo&&(h.fbo.destroy(),delete h.fbo),h.dem&&delete h.dem,delete h.neighboringTiles,h.state="unloaded",h.actor&&h.actor.send("removeDEMTile",{uid:h.uid,source:this.id})},p}(ku),Ds=function(d){function p(h,g,w,C){d.call(this),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=w.getActor(),this.setEventedParent(C),this._data=g.data,this._options=v.extend({},g),this._collectResourceTiming=g.collectResourceTiming,this._resourceTiming=[],void 0!==g.maxzoom&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;var T=v.EXTENT/this.tileSize;this.workerOptions=v.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(void 0!==g.buffer?g.buffer:128)*T,tolerance:(void 0!==g.tolerance?g.tolerance:.375)*T,extent:v.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:void 0!==g.clusterMaxZoom?Math.min(g.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:v.EXTENT,radius:(g.clusterRadius||50)*T,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)h.fire(new v.ErrorEvent(g));else{var w={dataType:"source",sourceDataType:"metadata"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(w.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new v.Event("data",w))}})},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setData=function(h){var g=this;return this._data=h,this.fire(new v.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(w){if(w)g.fire(new v.ErrorEvent(w));else{var C={dataType:"source",sourceDataType:"content"};g._collectResourceTiming&&g._resourceTiming&&g._resourceTiming.length>0&&(C.resourceTiming=g._resourceTiming,g._resourceTiming=[]),g.fire(new v.Event("data",C))}}),this},p.prototype.getClusterExpansionZoom=function(h,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id},g),this},p.prototype.getClusterChildren=function(h,g){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id},g),this},p.prototype.getClusterLeaves=function(h,g,w,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:h,limit:g,offset:w},C),this},p.prototype._updateWorkerData=function(h){var g=this;this._loaded=!1;var w=v.extend({},this.workerOptions),C=this._data;"string"==typeof C?(w.request=this.map._requestManager.transformRequest(v.browser.resolveURL(C),v.ResourceType.Source),w.request.collectResourceTiming=this._collectResourceTiming):w.data=JSON.stringify(C),this.actor.send(this.type+".loadData",w,function(T,I){g._removed||I&&I.abandoned||(g._loaded=!0,I&&I.resourceTiming&&I.resourceTiming[g.id]&&(g._resourceTiming=I.resourceTiming[g.id].slice(0)),g.actor.send(g.type+".coalesce",{source:w.source},null),h(T))})},p.prototype.loaded=function(){return this._loaded},p.prototype.loadTile=function(h,g){var w=this,C=h.actor?"reloadTile":"loadTile";h.actor=this.actor,h.request=this.actor.send(C,{type:this.type,uid:h.uid,tileID:h.tileID,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:v.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(T,I){return delete h.request,h.unloadVectorData(),h.aborted?g(null):T?g(T):(h.loadVectorData(I,w.map.painter,"reloadTile"===C),g(null))})},p.prototype.abortTile=function(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0},p.prototype.unloadTile=function(h){h.unloadVectorData(),this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})},p.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},p.prototype.serialize=function(){return v.extend({},this._options,{type:this.type,data:this._data})},p.prototype.hasTransition=function(){return!1},p}(v.Evented),no=v.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Sa=function(d){function p(h,g,w,C){d.call(this),this.id=h,this.dispatcher=w,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(h,g){var w=this;this._loaded=!1,this.fire(new v.Event("dataloading",{dataType:"source"})),this.url=this.options.url,v.getImage(this.map._requestManager.transformRequest(this.url,v.ResourceType.Image),function(C,T){w._loaded=!0,C?w.fire(new v.ErrorEvent(C)):T&&(w.image=T,h&&(w.coordinates=h),g&&g(),w._finishLoading())})},p.prototype.loaded=function(){return this._loaded},p.prototype.updateImage=function(h){var g=this;return this.image&&h.url?(this.options.url=h.url,this.load(h.coordinates,function(){g.texture=null}),this):this},p.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"metadata"})))},p.prototype.onAdd=function(h){this.map=h,this.load()},p.prototype.setCoordinates=function(h){var g=this;this.coordinates=h;var w=h.map(v.MercatorCoordinate.fromLngLat);this.tileID=function(T){for(var I=1/0,R=1/0,L=-1/0,q=-1/0,W=0,H=T;W<H.length;W+=1){var oe=H[W];I=Math.min(I,oe.x),R=Math.min(R,oe.y),L=Math.max(L,oe.x),q=Math.max(q,oe.y)}var ne=Math.max(L-I,q-R),de=Math.max(0,Math.floor(-Math.log(ne)/Math.LN2)),re=Math.pow(2,de);return new v.CanonicalTileID(de,Math.floor((I+L)/2*re),Math.floor((R+q)/2*re))}(w),this.minzoom=this.maxzoom=this.tileID.z;var C=w.map(function(T){return g.tileID.getTilePoint(T)._round()});return this._boundsArray=new v.StructArrayLayout4i8,this._boundsArray.emplaceBack(C[0].x,C[0].y,0,0),this._boundsArray.emplaceBack(C[1].x,C[1].y,v.EXTENT,0),this._boundsArray.emplaceBack(C[3].x,C[3].y,0,v.EXTENT),this._boundsArray.emplaceBack(C[2].x,C[2].y,v.EXTENT,v.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new v.Event("data",{dataType:"source",sourceDataType:"content"})),this},p.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v.Texture(h,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var C=this.tiles[w];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture)}}},p.prototype.loadTile=function(h,g){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},g(null)):(h.state="errored",g(null))},p.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return!1},p}(v.Evented),Fc=function(d){function p(h,g,w,C){d.call(this,h,g,w,C),this.roundZoom=!0,this.type="video",this.options=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){var h=this;this._loaded=!1;var g=this.options;this.urls=[];for(var w=0,C=g.urls;w<C.length;w+=1)this.urls.push(this.map._requestManager.transformRequest(C[w],v.ResourceType.Source).url);v.getVideo(this.urls,function(T,I){h._loaded=!0,T?h.fire(new v.ErrorEvent(T)):I&&(h.video=I,h.video.loop=!0,h.video.addEventListener("playing",function(){h.map.triggerRepaint()}),h.map&&h.video.play(),h._finishLoading())})},p.prototype.pause=function(){this.video&&this.video.pause()},p.prototype.play=function(){this.video&&this.video.play()},p.prototype.seek=function(h){if(this.video){var g=this.video.seekable;h<g.start(0)||h>g.end(0)?this.fire(new v.ErrorEvent(new v.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+g.start(0)+" and "+g.end(0)+"-second mark."))):this.video.currentTime=h}},p.prototype.getVideo=function(){return this.video},p.prototype.onAdd=function(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},p.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var h=this.map.painter.context,g=h.gl;for(var w in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new v.Texture(h,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE)),this.tiles){var C=this.tiles[w];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this.video&&!this.video.paused},p}(Sa),Hl=function(d){function p(h,g,w,C){d.call(this,h,g,w,C),g.coordinates?Array.isArray(g.coordinates)&&4===g.coordinates.length&&!g.coordinates.some(function(T){return!Array.isArray(T)||2!==T.length||T.some(function(I){return"number"!=typeof I})})||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "coordinates"'))),g.animate&&"boolean"!=typeof g.animate&&this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'optional "animate" property must be a boolean value'))),g.canvas?"string"==typeof g.canvas||g.canvas instanceof v.window.HTMLCanvasElement||this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new v.ErrorEvent(new v.ValidationError("sources."+h,null,'missing required property "canvas"'))),this.options=g,this.animate=void 0===g.animate||g.animate}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof v.window.HTMLCanvasElement?this.options.canvas:v.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new v.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},p.prototype.getCanvas=function(){return this.canvas},p.prototype.onAdd=function(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()},p.prototype.onRemove=function(){this.pause()},p.prototype.prepare=function(){var h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var g=this.map.painter.context,w=g.gl;for(var C in this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=v.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(h||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v.Texture(g,this.canvas,w.RGBA,{premultiply:!0}),this.tiles){var T=this.tiles[C];"loaded"!==T.state&&(T.state="loaded",T.texture=this.texture)}}},p.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},p.prototype.hasTransition=function(){return this._playing},p.prototype._hasInvalidDimensions=function(){for(var h=0,g=[this.canvas.width,this.canvas.height];h<g.length;h+=1){var w=g[h];if(isNaN(w)||w<=0)return!0}return!1},p}(Sa),dl={vector:jl,raster:ku,"raster-dem":Ta,geojson:Ds,video:Fc,image:Sa,canvas:Hl};function Op(d,p){var h=v.identity([]);return v.translate(h,h,[1,1,0]),v.scale(h,h,[.5*d.width,.5*d.height,1]),v.multiply(h,h,d.calculatePosMatrix(p.toUnwrapped()))}function Vi(d,p,h,g,w,C){var T=function(de,re,ae){if(de)for(var ge=0,be=de;ge<be.length;ge+=1){var Ae=re[be[ge]];if(Ae&&Ae.source===ae&&"fill-extrusion"===Ae.type)return!0}else for(var De in re){var Me=re[De];if(Me.source===ae&&"fill-extrusion"===Me.type)return!0}return!1}(w&&w.layers,p,d.id),I=C.maxPitchScaleFactor(),R=d.tilesIn(g,I,T);R.sort(hl);for(var L=[],q=0,W=R;q<W.length;q+=1){var H=W[q];L.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(p,h,d._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,w,C,I,Op(d.transform,H.tileID))})}var oe=function(de){for(var re={},ae={},ge=0,be=de;ge<be.length;ge+=1){var Ae=be[ge],De=Ae.queryResults,Me=Ae.wrappedTileID,Le=ae[Me]=ae[Me]||{};for(var Qe in De)for(var qe=De[Qe],at=Le[Qe]=Le[Qe]||{},Et=re[Qe]=re[Qe]||[],It=0,St=qe;It<St.length;It+=1){var pn=St[It];at[pn.featureIndex]||(at[pn.featureIndex]=!0,Et.push(pn))}}return re}(L);for(var ne in oe)oe[ne].forEach(function(de){var re=de.feature,ae=d.getFeatureState(re.layer["source-layer"],re.id);re.source=re.layer.source,re.layer["source-layer"]&&(re.sourceLayer=re.layer["source-layer"]),re.state=ae});return oe}function hl(d,p){var h=d.tileID,g=p.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}var er=function(d,p){this.max=d,this.onRemove=p,this.reset()};er.prototype.reset=function(){for(var d in this.data)for(var p=0,h=this.data[d];p<h.length;p+=1){var g=h[p];g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value)}return this.data={},this.order=[],this},er.prototype.add=function(d,p,h){var g=this,w=d.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);var C={value:p,timeout:void 0};if(void 0!==h&&(C.timeout=setTimeout(function(){g.remove(d,C)},h)),this.data[w].push(C),this.order.push(w),this.order.length>this.max){var T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this},er.prototype.has=function(d){return d.wrapped().key in this.data},er.prototype.getAndRemove=function(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null},er.prototype._getAndRemoveByKey=function(d){var p=this.data[d].shift();return p.timeout&&clearTimeout(p.timeout),0===this.data[d].length&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),p.value},er.prototype.getByKey=function(d){var p=this.data[d];return p?p[0].value:null},er.prototype.get=function(d){return this.has(d)?this.data[d.wrapped().key][0].value:null},er.prototype.remove=function(d,p){if(!this.has(d))return this;var h=d.wrapped().key,g=void 0===p?0:this.data[h].indexOf(p),w=this.data[h][g];return this.data[h].splice(g,1),w.timeout&&clearTimeout(w.timeout),0===this.data[h].length&&delete this.data[h],this.onRemove(w.value),this.order.splice(this.order.indexOf(h),1),this},er.prototype.setMaxSize=function(d){for(this.max=d;this.order.length>this.max;){var p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this},er.prototype.filter=function(d){var p=[];for(var h in this.data)for(var g=0,w=this.data[h];g<w.length;g+=1){var C=w[g];d(C.value)||p.push(C)}for(var T=0,I=p;T<I.length;T+=1){var R=I[T];this.remove(R.value.tileID,R)}};var Ia=function(d,p,h){this.context=d;var g=d.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Ia.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ia.prototype.updateData=function(d){var p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)},Ia.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var fl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Us=function(d,p,h,g){this.length=p.length,this.attributes=h,this.itemSize=p.bytesPerElement,this.dynamicDraw=g,this.context=d;var w=d.gl;this.buffer=w.createBuffer(),d.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer};Us.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Us.prototype.updateData=function(d){var p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,d.arrayBuffer)},Us.prototype.enableAttributes=function(d,p){for(var h=0;h<this.attributes.length;h++){var g=p.attributes[this.attributes[h].name];void 0!==g&&d.enableVertexAttribArray(g)}},Us.prototype.setVertexAttribPointers=function(d,p,h){for(var g=0;g<this.attributes.length;g++){var w=this.attributes[g],C=p.attributes[w.name];void 0!==C&&d.vertexAttribPointer(C,w.components,d[fl[w.type]],!1,this.itemSize,w.offset+this.itemSize*(h||0))}},Us.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Dn=function(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Dn.prototype.get=function(){return this.current},Dn.prototype.set=function(d){},Dn.prototype.getDefault=function(){return this.default},Dn.prototype.setDefault=function(){this.set(this.default)};var ka=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(Dn),No=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 1},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)},p}(Dn),js=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)},p}(Dn),Lp=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return[!0,!0,!0,!0]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(Dn),ta=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)},p}(Dn),pr=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 255},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)},p}(Dn),rs=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},p.prototype.set=function(h){var g=this.current;(h.func!==g.func||h.ref!==g.ref||h.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)},p}(Dn),pl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)},p}(Dn),ml=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=h,this.dirty=!1}},p}(Dn),Wn=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return[0,1]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)},p}(Dn),Ts=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=h,this.dirty=!1}},p}(Dn),$l=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.LESS},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)},p}(Dn),Hs=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.BLEND):g.disable(g.BLEND),this.current=h,this.dirty=!1}},p}(Dn),Aa=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[h.ONE,h.ZERO]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)},p}(Dn),Bc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return v.Color.transparent},p.prototype.set=function(h){var g=this.current;(h.r!==g.r||h.g!==g.g||h.b!==g.b||h.a!==g.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)},p}(Dn),Au=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.FUNC_ADD},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)},p}(Dn),Ma=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;h?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=h,this.dirty=!1}},p}(Dn),Mu=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.BACK},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)},p}(Dn),nf=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.CCW},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)},p}(Dn),Ru=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)},p}(Dn),Vc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return this.gl.TEXTURE0},p.prototype.set=function(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)},p}(Dn),Ss=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){var h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]},p.prototype.set=function(h){var g=this.current;(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)},p}(Dn),ql=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,h),this.current=h,this.dirty=!1}},p}(Dn),Ld=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(Dn),Pu=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindTexture(g.TEXTURE_2D,h),this.current=h,this.dirty=!1}},p}(Dn),Fd=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}},p}(Dn),gl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){var g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1},p}(Dn),Gl=function(d){function p(h){d.call(this,h),this.vao=h.extVertexArrayObject}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p.prototype.set=function(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)},p}(Dn),Ra=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return 4},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}},p}(Dn),zc=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}},p}(Dn),Wl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return!1},p.prototype.set=function(h){if(h!==this.current||this.dirty){var g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}},p}(Dn),tr=function(d){function p(h,g){d.call(this,h),this.context=h,this.parent=g}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getDefault=function(){return null},p}(Dn),F=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.setDirty=function(){this.dirty=!0},p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}},p}(tr),z=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.set=function(h){if(h!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,h),this.current=h,this.dirty=!1}},p}(tr),U=function(d,p,h,g){this.context=d,this.width=p,this.height=h;var w=this.framebuffer=d.gl.createFramebuffer();this.colorAttachment=new F(d,w),g&&(this.depthAttachment=new z(d,w))};U.prototype.destroy=function(){var d=this.context.gl,p=this.colorAttachment.get();if(p&&d.deleteTexture(p),this.depthAttachment){var h=this.depthAttachment.get();h&&d.deleteRenderbuffer(h)}d.deleteFramebuffer(this.framebuffer)};var K=function(d,p,h){this.func=d,this.mask=p,this.range=h};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var ie=function(d,p,h,g,w,C){this.test=d,this.ref=p,this.mask=h,this.fail=g,this.depthFail=w,this.pass=C};ie.disabled=new ie({func:519,mask:0},0,0,7680,7680,7680);var me=function(d,p,h){this.blendFunction=d,this.blendColor=p,this.mask=h};me.disabled=new me(me.Replace=[1,0],v.Color.transparent,[!1,!1,!1,!1]),me.unblended=new me(me.Replace,v.Color.transparent,[!0,!0,!0,!0]),me.alphaBlended=new me([1,771],v.Color.transparent,[!0,!0,!0,!0]);var _e=function(d,p,h){this.enable=d,this.mode=p,this.frontFace=h};_e.disabled=new _e(!1,1029,2305),_e.backCCW=new _e(!0,1029,2305);var J=function(d){this.gl=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ka(this),this.clearDepth=new No(this),this.clearStencil=new js(this),this.colorMask=new Lp(this),this.depthMask=new ta(this),this.stencilMask=new pr(this),this.stencilFunc=new rs(this),this.stencilOp=new pl(this),this.stencilTest=new ml(this),this.depthRange=new Wn(this),this.depthTest=new Ts(this),this.depthFunc=new $l(this),this.blend=new Hs(this),this.blendFunc=new Aa(this),this.blendColor=new Bc(this),this.blendEquation=new Au(this),this.cullFace=new Ma(this),this.cullFaceSide=new Mu(this),this.frontFace=new nf(this),this.program=new Ru(this),this.activeTexture=new Vc(this),this.viewport=new Ss(this),this.bindFramebuffer=new ql(this),this.bindRenderbuffer=new Ld(this),this.bindTexture=new Pu(this),this.bindVertexBuffer=new Fd(this),this.bindElementBuffer=new gl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Gl(this),this.pixelStoreUnpack=new Ra(this),this.pixelStoreUnpackPremultiplyAlpha=new zc(this),this.pixelStoreUnpackFlipY=new Wl(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=d.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(d.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=d.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=d.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE)};J.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},J.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},J.prototype.createIndexBuffer=function(d,p){return new Ia(this,d,p)},J.prototype.createVertexBuffer=function(d,p,h){return new Us(this,d,p,h)},J.prototype.createRenderbuffer=function(d,p,h){var g=this.gl,w=g.createRenderbuffer();return this.bindRenderbuffer.set(w),g.renderbufferStorage(g.RENDERBUFFER,d,p,h),this.bindRenderbuffer.set(null),w},J.prototype.createFramebuffer=function(d,p,h){return new U(this,d,p,h)},J.prototype.clear=function(d){var p=d.color,h=d.depth,g=this.gl,w=0;p&&(w|=g.COLOR_BUFFER_BIT,this.clearColor.set(p),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(w|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g.clear(w)},J.prototype.setCullFace=function(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))},J.prototype.setDepthMode=function(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)},J.prototype.setStencilMode=function(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)},J.prototype.setColorMode=function(d){v.deepEqual(d.blendFunction,me.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)},J.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Z=function(d){function p(h,g,w){var C=this;d.call(this),this.id=h,this.dispatcher=w,this.on("data",function(T){"source"===T.dataType&&"metadata"===T.sourceDataType&&(C._sourceLoaded=!0),C._sourceLoaded&&!C._paused&&"source"===T.dataType&&"content"===T.sourceDataType&&(C.reload(),C.transform&&C.update(C.transform))}),this.on("error",function(){C._sourceErrored=!0}),this._source=function(T,I,R,L){var q=new dl[I.type](T,I,R,L);if(q.id!==T)throw new Error("Expected Source id to be "+T+" instead of "+q.id);return v.bindAll(["load","abort","unload","serialize","prepare"],q),q}(h,g,w,this),this._tiles={},this._cache=new er(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new v.SourceFeatureState}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.onAdd=function(h){this.map=h,this._maxTileCacheSize=h?h._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(h)},p.prototype.onRemove=function(h){this._source&&this._source.onRemove&&this._source.onRemove(h)},p.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var h in this._tiles){var g=this._tiles[h];if("loaded"!==g.state&&"errored"!==g.state)return!1}return!0},p.prototype.getSource=function(){return this._source},p.prototype.pause=function(){this._paused=!0},p.prototype.resume=function(){if(this._paused){var h=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,h&&this.reload(),this.transform&&this.update(this.transform)}},p.prototype._loadTile=function(h,g){return this._source.loadTile(h,g)},p.prototype._unloadTile=function(h){if(this._source.unloadTile)return this._source.unloadTile(h,function(){})},p.prototype._abortTile=function(h){if(this._source.abortTile)return this._source.abortTile(h,function(){})},p.prototype.serialize=function(){return this._source.serialize()},p.prototype.prepare=function(h){for(var g in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var w=this._tiles[g];w.upload(h),w.prepare(this.map.style.imageManager)}},p.prototype.getIds=function(){return v.values(this._tiles).map(function(h){return h.tileID}).sort(se).map(function(h){return h.key})},p.prototype.getRenderableIds=function(h){var g=this,w=[];for(var C in this._tiles)this._isIdRenderable(C,h)&&w.push(this._tiles[C]);return h?w.sort(function(T,I){var R=T.tileID,L=I.tileID,q=new v.Point(R.canonical.x,R.canonical.y)._rotate(g.transform.angle),W=new v.Point(L.canonical.x,L.canonical.y)._rotate(g.transform.angle);return R.overscaledZ-L.overscaledZ||W.y-q.y||W.x-q.x}).map(function(T){return T.tileID.key}):w.map(function(T){return T.tileID}).sort(se).map(function(T){return T.key})},p.prototype.hasRenderableParent=function(h){var g=this.findLoadedParent(h,0);return!!g&&this._isIdRenderable(g.tileID.key)},p.prototype._isIdRenderable=function(h,g){return this._tiles[h]&&this._tiles[h].hasData()&&!this._coveredTiles[h]&&(g||!this._tiles[h].holdingForFade())},p.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var h in this._cache.reset(),this._tiles)"errored"!==this._tiles[h].state&&this._reloadTile(h,"reloading")},p.prototype._reloadTile=function(h,g){var w=this._tiles[h];w&&("loading"!==w.state&&(w.state=g),this._loadTile(w,this._tileLoaded.bind(this,w,h,g)))},p.prototype._tileLoaded=function(h,g,w,C){if(C)return h.state="errored",void(404!==C.status?this._source.fire(new v.ErrorEvent(C,{tile:h})):this.update(this.transform));h.timeAdded=v.browser.now(),"expired"===w&&(h.refreshedUponExpiration=!0),this._setTileReloadTimer(g,h),"raster-dem"===this.getSource().type&&h.dem&&this._backfillDEM(h),this._state.initializeTileState(h,this.map?this.map.painter:null),this._source.fire(new v.Event("data",{dataType:"source",tile:h,coord:h.tileID}))},p.prototype._backfillDEM=function(h){for(var g=this.getRenderableIds(),w=0;w<g.length;w++){var C=g[w];if(h.neighboringTiles&&h.neighboringTiles[C]){var T=this.getTileByID(C);I(h,T),I(T,h)}}function I(R,L){R.needsHillshadePrepare=!0;var q=L.tileID.canonical.x-R.tileID.canonical.x,W=L.tileID.canonical.y-R.tileID.canonical.y,H=Math.pow(2,R.tileID.canonical.z),oe=L.tileID.key;0===q&&0===W||Math.abs(W)>1||(Math.abs(q)>1&&(1===Math.abs(q+H)?q+=H:1===Math.abs(q-H)&&(q-=H)),L.dem&&R.dem&&(R.dem.backfillBorder(L.dem,q,W),R.neighboringTiles&&R.neighboringTiles[oe]&&(R.neighboringTiles[oe].backfilled=!0)))}},p.prototype.getTile=function(h){return this.getTileByID(h.key)},p.prototype.getTileByID=function(h){return this._tiles[h]},p.prototype._retainLoadedChildren=function(h,g,w,C){for(var T in this._tiles){var I=this._tiles[T];if(!(C[T]||!I.hasData()||I.tileID.overscaledZ<=g||I.tileID.overscaledZ>w)){for(var R=I.tileID;I&&I.tileID.overscaledZ>g+1;){var L=I.tileID.scaledTo(I.tileID.overscaledZ-1);(I=this._tiles[L.key])&&I.hasData()&&(R=L)}for(var q=R;q.overscaledZ>g;)if(h[(q=q.scaledTo(q.overscaledZ-1)).key]){C[R.key]=R;break}}}},p.prototype.findLoadedParent=function(h,g){if(h.key in this._loadedParentTiles){var w=this._loadedParentTiles[h.key];return w&&w.tileID.overscaledZ>=g?w:null}for(var C=h.overscaledZ-1;C>=g;C--){var T=h.scaledTo(C),I=this._getLoadedTile(T);if(I)return I}},p.prototype._getLoadedTile=function(h){var g=this._tiles[h.key];return g&&g.hasData()?g:this._cache.getByKey(h.wrapped().key)},p.prototype.updateCacheSize=function(h){var g=Math.ceil(h.width/this._source.tileSize)+1,w=Math.ceil(h.height/this._source.tileSize)+1,C=Math.floor(g*w*5),T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(T)},p.prototype.handleWrapJump=function(h){var g=Math.round((h-(void 0===this._prevLng?h:this._prevLng))/360);if(this._prevLng=h,g){var w={};for(var C in this._tiles){var T=this._tiles[C];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+g),w[T.tileID.key]=T}for(var I in this._tiles=w,this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(var R in this._tiles)this._setTileReloadTimer(R,this._tiles[R])}},p.prototype.update=function(h){var g=this;if(this.transform=h,this._sourceLoaded&&!this._paused){var w;this.updateCacheSize(h),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?w=h.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Le){return new v.OverscaledTileID(Le.canonical.z,Le.wrap,Le.canonical.z,Le.canonical.x,Le.canonical.y)}):(w=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(w=w.filter(function(Le){return g._source.hasTile(Le)}))):w=[];var C=h.coveringZoomLevel(this._source),T=Math.max(C-p.maxOverzooming,this._source.minzoom),I=Math.max(C+p.maxUnderzooming,this._source.minzoom),R=this._updateRetainedTiles(w,C);if(Ue(this._source.type)){for(var L={},q={},W=0,H=Object.keys(R);W<H.length;W+=1){var oe=H[W],ne=R[oe],de=this._tiles[oe];if(de&&!(de.fadeEndTime&&de.fadeEndTime<=v.browser.now())){var re=this.findLoadedParent(ne,T);re&&(this._addTile(re.tileID),L[re.tileID.key]=re.tileID),q[oe]=ne}}for(var ae in this._retainLoadedChildren(q,C,I,R),L)R[ae]||(this._coveredTiles[ae]=!0,R[ae]=L[ae])}for(var ge in R)this._tiles[ge].clearFadeHold();for(var be=0,Ae=v.keysDifference(this._tiles,R);be<Ae.length;be+=1){var De=Ae[be],Me=this._tiles[De];Me.hasSymbolBuckets&&!Me.holdingForFade()?Me.setHoldDuration(this.map._fadeDuration):Me.hasSymbolBuckets&&!Me.symbolFadeFinished()||this._removeTile(De)}this._updateLoadedParentTileCache()}},p.prototype.releaseSymbolFadeTiles=function(){for(var h in this._tiles)this._tiles[h].holdingForFade()&&this._removeTile(h)},p.prototype._updateRetainedTiles=function(h,g){for(var w={},C={},T=Math.max(g-p.maxOverzooming,this._source.minzoom),I=Math.max(g+p.maxUnderzooming,this._source.minzoom),R={},L=0,q=h;L<q.length;L+=1){var W=q[L],H=this._addTile(W);w[W.key]=W,H.hasData()||g<this._source.maxzoom&&(R[W.key]=W)}this._retainLoadedChildren(R,g,I,w);for(var oe=0,ne=h;oe<ne.length;oe+=1){var de=ne[oe],re=this._tiles[de.key];if(!re.hasData()){if(g+1>this._source.maxzoom){var ae=de.children(this._source.maxzoom)[0],ge=this.getTile(ae);if(ge&&ge.hasData()){w[ae.key]=ae;continue}}else{var be=de.children(this._source.maxzoom);if(w[be[0].key]&&w[be[1].key]&&w[be[2].key]&&w[be[3].key])continue}for(var Ae=re.wasRequested(),De=de.overscaledZ-1;De>=T;--De){var Me=de.scaledTo(De);if(C[Me.key]||(C[Me.key]=!0,!(re=this.getTile(Me))&&Ae&&(re=this._addTile(Me)),re&&(w[Me.key]=Me,Ae=re.wasRequested(),re.hasData())))break}}}return w},p.prototype._updateLoadedParentTileCache=function(){for(var h in this._loadedParentTiles={},this._tiles){for(var g=[],w=void 0,C=this._tiles[h].tileID;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){w=this._loadedParentTiles[C.key];break}g.push(C.key);var T=C.scaledTo(C.overscaledZ-1);if(w=this._getLoadedTile(T))break;C=T}for(var I=0,R=g;I<R.length;I+=1)this._loadedParentTiles[R[I]]=w}},p.prototype._addTile=function(h){var g=this._tiles[h.key];if(g)return g;(g=this._cache.getAndRemove(h))&&(this._setTileReloadTimer(h.key,g),g.tileID=h,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[h.key]&&(clearTimeout(this._cacheTimers[h.key]),delete this._cacheTimers[h.key],this._setTileReloadTimer(h.key,g)));var w=!!g;return w||(g=new v.Tile(h,this._source.tileSize*h.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,h.key,g.state))),g?(g.uses++,this._tiles[h.key]=g,w||this._source.fire(new v.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null},p.prototype._setTileReloadTimer=function(h,g){var w=this;h in this._timers&&(clearTimeout(this._timers[h]),delete this._timers[h]);var C=g.getExpiryTimeout();C&&(this._timers[h]=setTimeout(function(){w._reloadTile(h,"expired"),delete w._timers[h]},C))},p.prototype._removeTile=function(h){var g=this._tiles[h];g&&(g.uses--,delete this._tiles[h],this._timers[h]&&(clearTimeout(this._timers[h]),delete this._timers[h]),g.uses>0||(g.hasData()&&"reloading"!==g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))},p.prototype.clearTiles=function(){for(var h in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(h);this._cache.reset()},p.prototype.tilesIn=function(h,g,w){var C=this,T=[],I=this.transform;if(!I)return T;for(var R=w?I.getCameraQueryGeometry(h):h,L=h.map(function(De){return I.pointCoordinate(De)}),q=R.map(function(De){return I.pointCoordinate(De)}),W=this.getIds(),H=1/0,oe=1/0,ne=-1/0,de=-1/0,re=0,ae=q;re<ae.length;re+=1){var ge=ae[re];H=Math.min(H,ge.x),oe=Math.min(oe,ge.y),ne=Math.max(ne,ge.x),de=Math.max(de,ge.y)}for(var be=function(De){var Me=C._tiles[W[De]];if(!Me.holdingForFade()){var Le=Me.tileID,Qe=Math.pow(2,I.zoom-Me.tileID.overscaledZ),qe=g*Me.queryPadding*v.EXTENT/Me.tileSize/Qe,at=[Le.getTilePoint(new v.MercatorCoordinate(H,oe)),Le.getTilePoint(new v.MercatorCoordinate(ne,de))];if(at[0].x-qe<v.EXTENT&&at[0].y-qe<v.EXTENT&&at[1].x+qe>=0&&at[1].y+qe>=0){var Et=L.map(function(St){return Le.getTilePoint(St)}),It=q.map(function(St){return Le.getTilePoint(St)});T.push({tile:Me,tileID:Le,queryGeometry:Et,cameraQueryGeometry:It,scale:Qe})}}},Ae=0;Ae<W.length;Ae++)be(Ae);return T},p.prototype.getVisibleCoordinates=function(h){for(var g=this,w=this.getRenderableIds(h).map(function(R){return g._tiles[R].tileID}),C=0,T=w;C<T.length;C+=1){var I=T[C];I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped())}return w},p.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ue(this._source.type))for(var h in this._tiles){var g=this._tiles[h];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=v.browser.now())return!0}return!1},p.prototype.setFeatureState=function(h,g,w){this._state.updateState(h=h||"_geojsonTileLayer",g,w)},p.prototype.removeFeatureState=function(h,g,w){this._state.removeFeatureState(h=h||"_geojsonTileLayer",g,w)},p.prototype.getFeatureState=function(h,g){return this._state.getState(h=h||"_geojsonTileLayer",g)},p.prototype.setDependencies=function(h,g,w){var C=this._tiles[h];C&&C.setDependencies(g,w)},p.prototype.reloadTilesForDependencies=function(h,g){for(var w in this._tiles)this._tiles[w].hasDependency(h,g)&&this._reloadTile(w,"reloading");this._cache.filter(function(C){return!C.hasDependency(h,g)})},p}(v.Evented);function se(d,p){var h=Math.abs(2*d.wrap)-+(d.wrap<0),g=Math.abs(2*p.wrap)-+(p.wrap<0);return d.overscaledZ-p.overscaledZ||g-h||p.canonical.y-d.canonical.y||p.canonical.x-d.canonical.x}function Ue(d){return"raster"===d||"image"===d||"video"===d}function Je(){return new v.window.Worker(Kp.workerUrl)}Z.maxOverzooming=10,Z.maxUnderzooming=3;var Te="mapboxgl_preloaded_worker_pool",$e=function(){this.active={}};$e.prototype.acquire=function(d){if(!this.workers)for(this.workers=[];this.workers.length<$e.workerCount;)this.workers.push(new Je);return this.active[d]=!0,this.workers.slice()},$e.prototype.release=function(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(function(p){p.terminate()}),this.workers=null)},$e.prototype.isPreloaded=function(){return!!this.active[Te]},$e.prototype.numActive=function(){return Object.keys(this.active).length};var ct,dt=Math.floor(v.browser.hardwareConcurrency/2);function xt(){return ct||(ct=new $e),ct}function Ne(d,p){var h={};for(var g in d)"ref"!==g&&(h[g]=d[g]);return v.refProperties.forEach(function(w){w in p&&(h[w]=p[w])}),h}function rt(d){d=d.slice();for(var p=Object.create(null),h=0;h<d.length;h++)p[d[h].id]=d[h];for(var g=0;g<d.length;g++)"ref"in d[g]&&(d[g]=Ne(d[g],p[d[g].ref]));return d}$e.workerCount=Math.max(Math.min(dt,6),1);var Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Jt(d,p,h){h.push({command:Ve.addSource,args:[d,p[d]]})}function en(d,p,h){p.push({command:Ve.removeSource,args:[d]}),h[d]=!0}function ue(d,p,h,g){en(d,h,g),Jt(d,p,h)}function ur(d,p,h){var g;for(g in d[h])if(d[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],p[h][g]))return!1;for(g in p[h])if(p[h].hasOwnProperty(g)&&"data"!==g&&!v.deepEqual(d[h][g],p[h][g]))return!1;return!0}function jt(d,p,h,g,w,C){var T;for(T in p=p||{},d=d||{})d.hasOwnProperty(T)&&(v.deepEqual(d[T],p[T])||h.push({command:C,args:[g,T,p[T],w]}));for(T in p)p.hasOwnProperty(T)&&!d.hasOwnProperty(T)&&(v.deepEqual(d[T],p[T])||h.push({command:C,args:[g,T,p[T],w]}))}function an(d){return d.id}function Cr(d,p){return d[p.id]=p,d}var On=function(d,p){this.reset(d,p)};On.prototype.reset=function(d,p){this.points=d||[],this._distances=[0];for(var h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding},On.prototype.lerp=function(d){if(1===this.points.length)return this.points[0];d=v.clamp(d,0,1);for(var p=1,h=this._distances[p],g=d*this.paddedLength+this.padding;h<g&&p<this._distances.length;)h=this._distances[++p];var w=p-1,C=this._distances[w],T=h-C,I=T>0?(g-C)/T:0;return this.points[w].mult(1-I).add(this.points[p].mult(I))};var pt=function(d,p,h){var g=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(d/h),this.yCellCount=Math.ceil(p/h);for(var C=0;C<this.xCellCount*this.yCellCount;C++)g.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=p,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0};function Fr(d,p,h,g,w){var C=v.create();return p?(v.scale(C,C,[1/w,1/w,1]),h||v.rotateZ(C,C,g.angle)):v.multiply(C,g.labelPlaneMatrix,d),C}function xn(d,p,h,g,w){if(p){var C=v.clone(d);return v.scale(C,C,[w,w,1]),h||v.rotateZ(C,C,-g.angle),C}return g.glCoordMatrix}function fn(d,p){var h=[d.x,d.y,0,1];na(h,h,p);var g=h[3];return{point:new v.Point(h[0]/g,h[1]/g),signedDistanceFromCamera:g}}function Bd(d,p){return.5+d/p*.5}function wn(d,p){var h=d[0]/d[3],g=d[1]/d[3];return h>=-p[0]&&h<=p[0]&&g>=-p[1]&&g<=p[1]}function Kn(d,p,h,g,w,C,T,I){var R=g?d.textSizeData:d.iconSizeData,L=v.evaluateSizeForZoom(R,h.transform.zoom),q=[256/h.width*2+1,256/h.height*2+1],W=g?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;W.clear();for(var H=d.lineVertexArray,oe=g?d.text.placedSymbolArray:d.icon.placedSymbolArray,ne=h.transform.width/h.transform.height,de=!1,re=0;re<oe.length;re++){var ae=oe.get(re);if(ae.hidden||ae.writingMode===v.WritingMode.vertical&&!de)Oo(ae.numGlyphs,W);else{de=!1;var ge=[ae.anchorX,ae.anchorY,0,1];if(v.transformMat4(ge,ge,p),wn(ge,q)){var be=Bd(h.transform.cameraToCenterDistance,ge[3]),Ae=v.evaluateSizeForFeature(R,L,ae),De=T?Ae/be:Ae*be,Me=new v.Point(ae.anchorX,ae.anchorY),Le=fn(Me,w).point,Qe={},qe=Dr(ae,De,!1,I,p,w,C,d.glyphOffsetArray,H,W,Le,Me,Qe,ne);de=qe.useVertical,(qe.notEnoughRoom||de||qe.needsFlipping&&Dr(ae,De,!0,I,p,w,C,d.glyphOffsetArray,H,W,Le,Me,Qe,ne).notEnoughRoom)&&Oo(ae.numGlyphs,W)}else Oo(ae.numGlyphs,W)}}g?d.text.dynamicLayoutVertexBuffer.updateData(W):d.icon.dynamicLayoutVertexBuffer.updateData(W)}function mn(d,p,h,g,w,C,T,I,R,L,q){var W=I.glyphStartIndex+I.numGlyphs,H=I.lineStartIndex,oe=I.lineStartIndex+I.lineLength,ne=p.getoffsetX(I.glyphStartIndex),de=p.getoffsetX(W-1),re=Uc(d*ne,h,g,w,C,T,I.segment,H,oe,R,L,q);if(!re)return null;var ae=Uc(d*de,h,g,w,C,T,I.segment,H,oe,R,L,q);return ae?{first:re,last:ae}:null}function ii(d,p,h,g){return d===v.WritingMode.horizontal&&Math.abs(h.y-p.y)>Math.abs(h.x-p.x)*g?{useVertical:!0}:(d===v.WritingMode.vertical?p.y<h.y:p.x>h.x)?{needsFlipping:!0}:null}function Dr(d,p,h,g,w,C,T,I,R,L,q,W,H,oe){var ne,de=p/24,re=d.lineOffsetX*de,ae=d.lineOffsetY*de;if(d.numGlyphs>1){var ge=d.glyphStartIndex+d.numGlyphs,be=d.lineStartIndex,Ae=d.lineStartIndex+d.lineLength,De=mn(de,I,re,ae,h,q,W,d,R,C,H);if(!De)return{notEnoughRoom:!0};var Me=fn(De.first.point,T).point,Le=fn(De.last.point,T).point;if(g&&!h){var Qe=ii(d.writingMode,Me,Le,oe);if(Qe)return Qe}ne=[De.first];for(var qe=d.glyphStartIndex+1;qe<ge-1;qe++)ne.push(Uc(de*I.getoffsetX(qe),re,ae,h,q,W,d.segment,be,Ae,R,C,H));ne.push(De.last)}else{if(g&&!h){var at=fn(W,w).point,Et=d.lineStartIndex+d.segment+1,It=new v.Point(R.getx(Et),R.gety(Et)),St=fn(It,w),pn=St.signedDistanceFromCamera>0?St.point:Pg(W,It,at,1,w),ut=ii(d.writingMode,at,pn,oe);if(ut)return ut}var Yt=Uc(de*I.getoffsetX(d.glyphStartIndex),re,ae,h,q,W,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,R,C,H);if(!Yt)return{notEnoughRoom:!0};ne=[Yt]}for(var dn=0,et=ne;dn<et.length;dn+=1){var zt=et[dn];v.addDynamicAttributes(L,zt.point,zt.angle)}return{}}function Pg(d,p,h,g,w){var C=fn(d.add(d.sub(p)._unit()),w).point,T=h.sub(C);return h.add(T._mult(g/T.mag()))}function Uc(d,p,h,g,w,C,T,I,R,L,q,W){var H=g?d-p:d+p,oe=H>0?1:-1,ne=0;g&&(oe*=-1,ne=Math.PI),oe<0&&(ne+=Math.PI);for(var de=oe>0?I+T:I+T+1,re=w,ae=w,ge=0,be=0,Ae=Math.abs(H),De=[];ge+be<=Ae;){if((de+=oe)<I||de>=R)return null;if(ae=re,De.push(re),void 0===(re=W[de])){var Me=new v.Point(L.getx(de),L.gety(de)),Le=fn(Me,q);if(Le.signedDistanceFromCamera>0)re=W[de]=Le.point;else{var Qe=de-oe;re=Pg(0===ge?C:new v.Point(L.getx(Qe),L.gety(Qe)),Me,ae,Ae-ge+1,q)}}ge+=be,be=ae.dist(re)}var qe=(Ae-ge)/be,at=re.sub(ae),Et=at.mult(qe)._add(ae);Et._add(at._unit()._perp()._mult(h*oe));var It=ne+Math.atan2(re.y-ae.y,re.x-ae.x);return De.push(Et),{point:Et,angle:It,path:De}}pt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pt.prototype.insert=function(d,p,h,g,w){this._forEachCell(p,h,g,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(w)},pt.prototype.insertCircle=function(d,p,h,g){this._forEachCell(p-g,h-g,p+g,h+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(p),this.circles.push(h),this.circles.push(g)},pt.prototype._insertBoxCell=function(d,p,h,g,w,C){this.boxCells[w].push(C)},pt.prototype._insertCircleCell=function(d,p,h,g,w,C){this.circleCells[w].push(C)},pt.prototype._query=function(d,p,h,g,w,C){if(h<0||d>this.width||g<0||p>this.height)return!w&&[];var T=[];if(d<=0&&p<=0&&this.width<=h&&this.height<=g){if(w)return!0;for(var I=0;I<this.boxKeys.length;I++)T.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(var R=0;R<this.circleKeys.length;R++){var L=this.circles[3*R],q=this.circles[3*R+1],W=this.circles[3*R+2];T.push({key:this.circleKeys[R],x1:L-W,y1:q-W,x2:L+W,y2:q+W})}return C?T.filter(C):T}return this._forEachCell(d,p,h,g,this._queryCell,T,{hitTest:w,seenUids:{box:{},circle:{}}},C),w?T.length>0:T},pt.prototype._queryCircle=function(d,p,h,g,w){var C=d-h,T=d+h,I=p-h,R=p+h;if(T<0||C>this.width||R<0||I>this.height)return!g&&[];var L=[];return this._forEachCell(C,I,T,R,this._queryCellCircle,L,{hitTest:g,circle:{x:d,y:p,radius:h},seenUids:{box:{},circle:{}}},w),g?L.length>0:L},pt.prototype.query=function(d,p,h,g,w){return this._query(d,p,h,g,!1,w)},pt.prototype.hitTest=function(d,p,h,g,w){return this._query(d,p,h,g,!0,w)},pt.prototype.hitTestCircle=function(d,p,h,g){return this._queryCircle(d,p,h,!0,g)},pt.prototype._queryCell=function(d,p,h,g,w,C,T,I){var R=T.seenUids,L=this.boxCells[w];if(null!==L)for(var q=this.bboxes,W=0,H=L;W<H.length;W+=1){var oe=H[W];if(!R.box[oe]){R.box[oe]=!0;var ne=4*oe;if(d<=q[ne+2]&&p<=q[ne+3]&&h>=q[ne+0]&&g>=q[ne+1]&&(!I||I(this.boxKeys[oe]))){if(T.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[oe],x1:q[ne],y1:q[ne+1],x2:q[ne+2],y2:q[ne+3]})}}}var de=this.circleCells[w];if(null!==de)for(var re=this.circles,ae=0,ge=de;ae<ge.length;ae+=1){var be=ge[ae];if(!R.circle[be]){R.circle[be]=!0;var Ae=3*be;if(this._circleAndRectCollide(re[Ae],re[Ae+1],re[Ae+2],d,p,h,g)&&(!I||I(this.circleKeys[be]))){if(T.hitTest)return C.push(!0),!0;var De=re[Ae],Me=re[Ae+1],Le=re[Ae+2];C.push({key:this.circleKeys[be],x1:De-Le,y1:Me-Le,x2:De+Le,y2:Me+Le})}}}},pt.prototype._queryCellCircle=function(d,p,h,g,w,C,T,I){var R=T.circle,L=T.seenUids,q=this.boxCells[w];if(null!==q)for(var W=this.bboxes,H=0,oe=q;H<oe.length;H+=1){var ne=oe[H];if(!L.box[ne]){L.box[ne]=!0;var de=4*ne;if(this._circleAndRectCollide(R.x,R.y,R.radius,W[de+0],W[de+1],W[de+2],W[de+3])&&(!I||I(this.boxKeys[ne])))return C.push(!0),!0}}var re=this.circleCells[w];if(null!==re)for(var ae=this.circles,ge=0,be=re;ge<be.length;ge+=1){var Ae=be[ge];if(!L.circle[Ae]){L.circle[Ae]=!0;var De=3*Ae;if(this._circlesCollide(ae[De],ae[De+1],ae[De+2],R.x,R.y,R.radius)&&(!I||I(this.circleKeys[Ae])))return C.push(!0),!0}}},pt.prototype._forEachCell=function(d,p,h,g,w,C,T,I){for(var R=this._convertToXCellCoord(d),L=this._convertToYCellCoord(p),q=this._convertToXCellCoord(h),W=this._convertToYCellCoord(g),H=R;H<=q;H++)for(var oe=L;oe<=W;oe++)if(w.call(this,d,p,h,g,this.xCellCount*oe+H,C,T,I))return},pt.prototype._convertToXCellCoord=function(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))},pt.prototype._convertToYCellCoord=function(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))},pt.prototype._circlesCollide=function(d,p,h,g,w,C){var T=g-d,I=w-p,R=h+C;return R*R>T*T+I*I},pt.prototype._circleAndRectCollide=function(d,p,h,g,w,C,T){var I=(C-g)/2,R=Math.abs(d-(g+I));if(R>I+h)return!1;var L=(T-w)/2,q=Math.abs(p-(w+L));if(q>L+h)return!1;if(R<=I||q<=L)return!0;var W=R-I,H=q-L;return W*W+H*H<=h*h};var zi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Oo(d,p){for(var h=0;h<d;h++){var g=p.length;p.resize(g+4),p.float32.set(zi,3*g)}}function na(d,p,h){var g=p[0],w=p[1];return d[0]=h[0]*g+h[4]*w+h[12],d[1]=h[1]*g+h[5]*w+h[13],d[3]=h[3]*g+h[7]*w+h[15],d}var kr=function(d,p,h){void 0===p&&(p=new pt(d.width+200,d.height+200,25)),void 0===h&&(h=new pt(d.width+200,d.height+200,25)),this.transform=d,this.grid=p,this.ignoredGrid=h,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+100,this.screenBottomBoundary=d.height+100,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200};function is(d,p,h){return p*(v.EXTENT/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}kr.prototype.placeCollisionBox=function(d,p,h,g,w){var C=this.projectAndGetPerspectiveRatio(g,d.anchorPointX,d.anchorPointY),T=h*C.perspectiveRatio,I=d.x1*T+C.point.x,R=d.y1*T+C.point.y,L=d.x2*T+C.point.x,q=d.y2*T+C.point.y;return!this.isInsideGrid(I,R,L,q)||!p&&this.grid.hitTest(I,R,L,q,w)?{box:[],offscreen:!1}:{box:[I,R,L,q],offscreen:this.isOffscreen(I,R,L,q)}},kr.prototype.placeCollisionCircles=function(d,p,h,g,w,C,T,I,R,L,q,W,H){var oe=[],ne=new v.Point(p.anchorX,p.anchorY),de=fn(ne,C),re=Bd(this.transform.cameraToCenterDistance,de.signedDistanceFromCamera),ae=(L?w/re:w*re)/v.ONE_EM,ge=fn(ne,T).point,be=mn(ae,g,p.lineOffsetX*ae,p.lineOffsetY*ae,!1,ge,ne,p,h,T,{}),Ae=!1,De=!1,Me=!0;if(be){for(var Le=.5*W*re+H,Qe=new v.Point(-100,-100),qe=new v.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new On,Et=be.first,It=be.last,St=[],pn=Et.path.length-1;pn>=1;pn--)St.push(Et.path[pn]);for(var ut=1;ut<It.path.length;ut++)St.push(It.path[ut]);var Yt=2.5*Le;if(I){var dn=St.map(function(He){return fn(He,I)});St=dn.some(function(He){return He.signedDistanceFromCamera<=0})?[]:dn.map(function(He){return He.point})}var et=[];if(St.length>0){for(var zt=St[0].clone(),$t=St[0].clone(),Ut=1;Ut<St.length;Ut++)zt.x=Math.min(zt.x,St[Ut].x),zt.y=Math.min(zt.y,St[Ut].y),$t.x=Math.max($t.x,St[Ut].x),$t.y=Math.max($t.y,St[Ut].y);et=zt.x>=Qe.x&&$t.x<=qe.x&&zt.y>=Qe.y&&$t.y<=qe.y?[St]:$t.x<Qe.x||zt.x>qe.x||$t.y<Qe.y||zt.y>qe.y?[]:v.clipLine([St],Qe.x,Qe.y,qe.x,qe.y)}for(var Rt=0,rr=et;Rt<rr.length;Rt+=1){var $r;at.reset(rr[Rt],.25*Le),$r=at.length<=.5*Le?1:Math.ceil(at.paddedLength/Yt)+1;for(var lo=0;lo<$r;lo++){var yi=lo/Math.max($r-1,1),vi=at.lerp(yi),Jr=vi.x+100,Fo=vi.y+100;oe.push(Jr,Fo,Le,0);var ja=Jr-Le,bo=Fo-Le,Pe=Jr+Le,Ht=Fo+Le;if(Me=Me&&this.isOffscreen(ja,bo,Pe,Ht),De=De||this.isInsideGrid(ja,bo,Pe,Ht),!d&&this.grid.hitTestCircle(Jr,Fo,Le,q)&&(Ae=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!R&&Ae||!De?[]:oe,offscreen:Me,collisionDetected:Ae}},kr.prototype.queryRenderedSymbols=function(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var p=[],h=1/0,g=1/0,w=-1/0,C=-1/0,T=0,I=d;T<I.length;T+=1){var R=I[T],L=new v.Point(R.x+100,R.y+100);h=Math.min(h,L.x),g=Math.min(g,L.y),w=Math.max(w,L.x),C=Math.max(C,L.y),p.push(L)}for(var q={},W={},H=0,oe=this.grid.query(h,g,w,C).concat(this.ignoredGrid.query(h,g,w,C));H<oe.length;H+=1){var ne=oe[H],de=ne.key;if(void 0===q[de.bucketInstanceId]&&(q[de.bucketInstanceId]={}),!q[de.bucketInstanceId][de.featureIndex]){var re=[new v.Point(ne.x1,ne.y1),new v.Point(ne.x2,ne.y1),new v.Point(ne.x2,ne.y2),new v.Point(ne.x1,ne.y2)];v.polygonIntersectsPolygon(p,re)&&(q[de.bucketInstanceId][de.featureIndex]=!0,void 0===W[de.bucketInstanceId]&&(W[de.bucketInstanceId]=[]),W[de.bucketInstanceId].push(de.featureIndex))}}return W},kr.prototype.insertCollisionBox=function(d,p,h,g,w){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:w},d[0],d[1],d[2],d[3])},kr.prototype.insertCollisionCircles=function(d,p,h,g,w){for(var C=p?this.ignoredGrid:this.grid,T={bucketInstanceId:h,featureIndex:g,collisionGroupID:w},I=0;I<d.length;I+=4)C.insertCircle(T,d[I],d[I+1],d[I+2])},kr.prototype.projectAndGetPerspectiveRatio=function(d,p,h){var g=[p,h,0,1];return na(g,g,d),{point:new v.Point((g[0]/g[3]+1)/2*this.transform.width+100,(-g[1]/g[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}},kr.prototype.isOffscreen=function(d,p,h,g){return h<100||d>=this.screenRightBoundary||g<100||p>this.screenBottomBoundary},kr.prototype.isInsideGrid=function(d,p,h,g){return h>=0&&d<this.gridRightBoundary&&g>=0&&p<this.gridBottomBoundary},kr.prototype.getViewportMatrix=function(){var d=v.identity([]);return v.translate(d,d,[-100,-100,0]),d};var fo=function(d,p,h,g){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?p:-p))):g&&h?1:0,this.placed=h};fo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var os=function(d,p,h,g,w){this.text=new fo(d?d.text:null,p,h,w),this.icon=new fo(d?d.icon:null,p,g,w)};os.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Kl=function(d,p,h){this.text=d,this.icon=p,this.skipFade=h},Yy=function(){this.invProjMatrix=v.create(),this.viewportMatrix=v.create(),this.circles=[]},ra=function(d,p,h,g,w){this.bucketInstanceId=d,this.featureIndex=p,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=w},po=function(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}};function Mt(d,p,h,g,w){var C=v.getAnchorAlignment(d),T=-(C.horizontalAlign-.5)*p,I=-(C.verticalAlign-.5)*h,R=v.evaluateVariableOffset(d,g);return new v.Point(T+R[0]*w,I+R[1]*w)}function ro(d,p,h,g,w,C){var T=d.x1,I=d.x2,R=d.y1,L=d.y2,q=d.anchorPointX,W=d.anchorPointY,H=new v.Point(p,h);return g&&H._rotate(w?C:-C),{x1:T+H.x,y1:R+H.y,x2:I+H.x,y2:L+H.y,anchorPointX:q,anchorPointY:W}}po.prototype.get=function(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){var p=++this.maxGroupID;this.collisionGroups[d]={ID:p,predicate:function(h){return h.collisionGroupID===p}}}return this.collisionGroups[d]};var Ti=function(d,p,h,g){this.transform=d.clone(),this.collisionIndex=new kr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new po(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}};function Nu(d,p,h,g,w){d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0),d.emplaceBack(p?1:0,h?1:0,g||0,w||0)}Ti.prototype.getBucketParts=function(d,p,h,g){var w=h.getBucket(p),C=h.latestFeatureIndex;if(w&&C&&p.id===w.layerIds[0]){var T=h.collisionBoxArray,I=w.layers[0].layout,R=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),L=h.tileSize/v.EXTENT,q=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),W="map"===I.get("text-pitch-alignment"),H="map"===I.get("text-rotation-alignment"),oe=is(h,1,this.transform.zoom),ne=Fr(q,W,H,this.transform,oe),de=null;if(W){var re=xn(q,W,H,this.transform,oe);de=v.multiply([],this.transform.labelPlaneMatrix,re)}this.retainedQueryData[w.bucketInstanceId]=new ra(w.bucketInstanceId,C,w.sourceLayerIndex,w.index,h.tileID);var ae={bucket:w,layout:I,posMatrix:q,textLabelPlaneMatrix:ne,labelToScreenMatrix:de,scale:R,textPixelRatio:L,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:v.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(g)for(var ge=0,be=w.sortKeyRanges;ge<be.length;ge+=1){var Ae=be[ge];d.push({sortKey:Ae.sortKey,symbolInstanceStart:Ae.symbolInstanceStart,symbolInstanceEnd:Ae.symbolInstanceEnd,parameters:ae})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:ae})}},Ti.prototype.attemptAnchorPlacement=function(d,p,h,g,w,C,T,I,R,L,q,W,H,oe,ne){var de,re=[W.textOffset0,W.textOffset1],ae=Mt(d,h,g,re,w),ge=this.collisionIndex.placeCollisionBox(ro(p,ae.x,ae.y,C,T,this.transform.angle),q,I,R,L.predicate);if(!ne||0!==this.collisionIndex.placeCollisionBox(ro(ne,ae.x,ae.y,C,T,this.transform.angle),q,I,R,L.predicate).box.length)return ge.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(de=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:re,width:h,height:g,anchor:d,textBoxScale:w,prevAnchor:de},this.markUsedJustification(H,d,W,oe),H.allowVerticalPlacement&&(this.markUsedOrientation(H,oe,W),this.placedOrientations[W.crossTileID]=oe),{shift:ae,placedGlyphBoxes:ge}):void 0},Ti.prototype.placeLayerBucketPart=function(d,p,h){var g=this,w=d.parameters,C=w.bucket,T=w.layout,I=w.posMatrix,R=w.textLabelPlaneMatrix,L=w.labelToScreenMatrix,q=w.textPixelRatio,W=w.holdingForFade,H=w.collisionBoxArray,oe=w.partiallyEvaluatedTextSize,ne=w.collisionGroup,de=T.get("text-optional"),re=T.get("icon-optional"),ae=T.get("text-allow-overlap"),ge=T.get("icon-allow-overlap"),be="map"===T.get("text-rotation-alignment"),Ae="map"===T.get("text-pitch-alignment"),De="none"!==T.get("icon-text-fit"),Me="viewport-y"===T.get("symbol-z-order"),Le=ae&&(ge||!C.hasIconData()||re),Qe=ge&&(ae||!C.hasTextData()||de);!C.collisionArrays&&H&&C.deserializeCollisionBoxes(H);var qe=function(ut,Yt){if(!p[ut.crossTileID])if(W)g.placements[ut.crossTileID]=new Kl(!1,!1,!1);else{var dn,et=!1,zt=!1,$t=!0,Ut=null,Rt={box:null,offscreen:null},rr={box:null,offscreen:null},$r=null,lo=null,yi=0,vi=0,Jr=0;Yt.textFeatureIndex?yi=Yt.textFeatureIndex:ut.useRuntimeCollisionCircles&&(yi=ut.featureIndex),Yt.verticalTextFeatureIndex&&(vi=Yt.verticalTextFeatureIndex);var Fo=Yt.textBox;if(Fo){var ja=function(Mr){var Fn=v.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Mr&&g.prevPlacement){var Br=g.prevPlacement.placedOrientations[ut.crossTileID];Br&&(g.placedOrientations[ut.crossTileID]=Br,g.markUsedOrientation(C,Fn=Br,ut))}return Fn},bo=function(Mr,Fn){if(C.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Yt.verticalTextBox)for(var Br=0,Zu=C.writingModes;Br<Zu.length&&(Zu[Br]===v.WritingMode.vertical?(Rt=Fn(),rr=Rt):Rt=Mr(),!(Rt&&Rt.box&&Rt.box.length));Br+=1);else Rt=Mr()};if(T.get("text-variable-anchor")){var Pe=T.get("text-variable-anchor");if(g.prevPlacement&&g.prevPlacement.variableOffsets[ut.crossTileID]){var Ht=g.prevPlacement.variableOffsets[ut.crossTileID];Pe.indexOf(Ht.anchor)>0&&(Pe=Pe.filter(function(Mr){return Mr!==Ht.anchor})).unshift(Ht.anchor)}var He=function(Mr,Fn,Br){for(var Zu=Mr.x2-Mr.x1,Zi=Mr.y2-Mr.y1,wl=ut.textBoxScale,Sf=De&&!ge?Fn:null,Xd={box:[],offscreen:!1},Ug=ae?2*Pe.length:Pe.length,Qd=0;Qd<Ug;++Qd){var Qc=g.attemptAnchorPlacement(Pe[Qd%Pe.length],Mr,Zu,Zi,wl,be,Ae,q,I,ne,Qd>=Pe.length,ut,C,Br,Sf);if(Qc&&(Xd=Qc.placedGlyphBoxes)&&Xd.box&&Xd.box.length){et=!0,Ut=Qc.shift;break}}return Xd};bo(function(){return He(Fo,Yt.iconBox,v.WritingMode.horizontal)},function(){var Mr=Yt.verticalTextBox;return C.allowVerticalPlacement&&!(Rt&&Rt.box&&Rt.box.length)&&ut.numVerticalGlyphVertices>0&&Mr?He(Mr,Yt.verticalIconBox,v.WritingMode.vertical):{box:null,offscreen:null}}),Rt&&(et=Rt.box,$t=Rt.offscreen);var Ze=ja(Rt&&Rt.box);if(!et&&g.prevPlacement){var Xt=g.prevPlacement.variableOffsets[ut.crossTileID];Xt&&(g.variableOffsets[ut.crossTileID]=Xt,g.markUsedJustification(C,Xt.anchor,ut,Ze))}}else{var Zc=function(Mr,Fn){var Br=g.collisionIndex.placeCollisionBox(Mr,ae,q,I,ne.predicate);return Br&&Br.box&&Br.box.length&&(g.markUsedOrientation(C,Fn,ut),g.placedOrientations[ut.crossTileID]=Fn),Br};bo(function(){return Zc(Fo,v.WritingMode.horizontal)},function(){var Mr=Yt.verticalTextBox;return C.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Mr?Zc(Mr,v.WritingMode.vertical):{box:null,offscreen:null}}),ja(Rt&&Rt.box&&Rt.box.length)}}if(et=(dn=Rt)&&dn.box&&dn.box.length>0,$t=dn&&dn.offscreen,ut.useRuntimeCollisionCircles){var la=C.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),Ns=v.evaluateSizeForFeature(C.textSizeData,oe,la),Yc=T.get("text-padding");$r=g.collisionIndex.placeCollisionCircles(ae,la,C.lineVertexArray,C.glyphOffsetArray,Ns,I,R,L,h,Ae,ne.predicate,ut.collisionCircleDiameter,Yc),et=ae||$r.circles.length>0&&!$r.collisionDetected,$t=$t&&$r.offscreen}if(Yt.iconFeatureIndex&&(Jr=Yt.iconFeatureIndex),Yt.iconBox){var ca=function(Mr){var Fn=De&&Ut?ro(Mr,Ut.x,Ut.y,be,Ae,g.transform.angle):Mr;return g.collisionIndex.placeCollisionBox(Fn,ge,q,I,ne.predicate)};zt=rr&&rr.box&&rr.box.length&&Yt.verticalIconBox?(lo=ca(Yt.verticalIconBox)).box.length>0:(lo=ca(Yt.iconBox)).box.length>0,$t=$t&&lo.offscreen}var Xc=de||0===ut.numHorizontalGlyphVertices&&0===ut.numVerticalGlyphVertices,Ai=re||0===ut.numIconVertices;if(Xc||Ai?Ai?Xc||(zt=zt&&et):et=zt&&et:zt=et=zt&&et,et&&dn&&dn.box&&g.collisionIndex.insertCollisionBox(dn.box,T.get("text-ignore-placement"),C.bucketInstanceId,rr&&rr.box&&vi?vi:yi,ne.ID),zt&&lo&&g.collisionIndex.insertCollisionBox(lo.box,T.get("icon-ignore-placement"),C.bucketInstanceId,Jr,ne.ID),$r&&(et&&g.collisionIndex.insertCollisionCircles($r.circles,T.get("text-ignore-placement"),C.bucketInstanceId,yi,ne.ID),h)){var ac=C.bucketInstanceId,Ks=g.collisionCircleArrays[ac];void 0===Ks&&(Ks=g.collisionCircleArrays[ac]=new Yy);for(var lc=0;lc<$r.circles.length;lc+=4)Ks.circles.push($r.circles[lc+0]),Ks.circles.push($r.circles[lc+1]),Ks.circles.push($r.circles[lc+2]),Ks.circles.push($r.collisionDetected?1:0)}g.placements[ut.crossTileID]=new Kl(et||Le,zt||Qe,$t||C.justReloaded),p[ut.crossTileID]=!0}};if(Me)for(var at=C.getSortedSymbolIndexes(this.transform.angle),Et=at.length-1;Et>=0;--Et){var It=at[Et];qe(C.symbolInstances.get(It),C.collisionArrays[It])}else for(var St=d.symbolInstanceStart;St<d.symbolInstanceEnd;St++)qe(C.symbolInstances.get(St),C.collisionArrays[St]);if(h&&C.bucketInstanceId in this.collisionCircleArrays){var pn=this.collisionCircleArrays[C.bucketInstanceId];v.invert(pn.invProjMatrix,I),pn.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1},Ti.prototype.markUsedJustification=function(d,p,h,g){var w;w=g===v.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[v.getAnchorJustification(p)];for(var C=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];C<T.length;C+=1){var I=T[C];I>=0&&(d.text.placedSymbolArray.get(I).crossTileID=w>=0&&I!==w?0:h.crossTileID)}},Ti.prototype.markUsedOrientation=function(d,p,h){for(var g=p===v.WritingMode.horizontal||p===v.WritingMode.horizontalOnly?p:0,w=p===v.WritingMode.vertical?p:0,C=0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];C<T.length;C+=1)d.text.placedSymbolArray.get(T[C]).placedOrientation=g;h.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=w)},Ti.prototype.commit=function(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var p=this.prevPlacement,h=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;var g=p?p.symbolFadeChange(d):1,w=p?p.opacities:{},C=p?p.variableOffsets:{},T=p?p.placedOrientations:{};for(var I in this.placements){var R=this.placements[I],L=w[I];L?(this.opacities[I]=new os(L,g,R.text,R.icon),h=h||R.text!==L.text.placed||R.icon!==L.icon.placed):(this.opacities[I]=new os(null,g,R.text,R.icon,R.skipFade),h=h||R.text||R.icon)}for(var q in w){var W=w[q];if(!this.opacities[q]){var H=new os(W,g,!1,!1);H.isHidden()||(this.opacities[q]=H,h=h||W.text.placed||W.icon.placed)}}for(var oe in C)this.variableOffsets[oe]||!this.opacities[oe]||this.opacities[oe].isHidden()||(this.variableOffsets[oe]=C[oe]);for(var ne in T)this.placedOrientations[ne]||!this.opacities[ne]||this.opacities[ne].isHidden()||(this.placedOrientations[ne]=T[ne]);h?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:d)},Ti.prototype.updateLayerOpacities=function(d,p){for(var h={},g=0,w=p;g<w.length;g+=1){var C=w[g],T=C.getBucket(d);T&&C.latestFeatureIndex&&d.id===T.layerIds[0]&&this.updateBucketOpacities(T,h,C.collisionBoxArray)}},Ti.prototype.updateBucketOpacities=function(d,p,h){var g=this;d.hasTextData()&&d.text.opacityVertexArray.clear(),d.hasIconData()&&d.icon.opacityVertexArray.clear(),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var w=d.layers[0].layout,C=new os(null,0,!1,!1,!0),T=w.get("text-allow-overlap"),I=w.get("icon-allow-overlap"),R=w.get("text-variable-anchor"),L="map"===w.get("text-rotation-alignment"),q="map"===w.get("text-pitch-alignment"),W="none"!==w.get("icon-text-fit"),H=new os(null,0,T&&(I||!d.hasIconData()||w.get("icon-optional")),I&&(T||!d.hasTextData()||w.get("text-optional")),!0);!d.collisionArrays&&h&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(h);for(var oe=function(ae,ge,be){for(var Ae=0;Ae<ge/4;Ae++)ae.opacityVertexArray.emplaceBack(be)},ne=function(ae){var ge=d.symbolInstances.get(ae),be=ge.numHorizontalGlyphVertices,Ae=ge.numVerticalGlyphVertices,De=ge.crossTileID,Me=g.opacities[De];p[De]?Me=C:Me||(g.opacities[De]=Me=H),p[De]=!0;var Le=ge.numIconVertices>0,Qe=g.placedOrientations[ge.crossTileID],qe=Qe===v.WritingMode.vertical,at=Qe===v.WritingMode.horizontal||Qe===v.WritingMode.horizontalOnly;if(be>0||Ae>0){var Et=Bp(Me.text);oe(d.text,be,qe?jc:Et),oe(d.text,Ae,at?jc:Et);var It=Me.text.isHidden();[ge.rightJustifiedTextSymbolIndex,ge.centerJustifiedTextSymbolIndex,ge.leftJustifiedTextSymbolIndex].forEach(function(Rt){Rt>=0&&(d.text.placedSymbolArray.get(Rt).hidden=It||qe?1:0)}),ge.verticalPlacedTextSymbolIndex>=0&&(d.text.placedSymbolArray.get(ge.verticalPlacedTextSymbolIndex).hidden=It||at?1:0);var St=g.variableOffsets[ge.crossTileID];St&&g.markUsedJustification(d,St.anchor,ge,Qe);var pn=g.placedOrientations[ge.crossTileID];pn&&(g.markUsedJustification(d,"left",ge,pn),g.markUsedOrientation(d,pn,ge))}if(Le){var ut=Bp(Me.icon),Yt=!(W&&ge.verticalPlacedIconSymbolIndex&&qe);ge.placedIconSymbolIndex>=0&&(oe(d.icon,ge.numIconVertices,Yt?ut:jc),d.icon.placedSymbolArray.get(ge.placedIconSymbolIndex).hidden=Me.icon.isHidden()),ge.verticalPlacedIconSymbolIndex>=0&&(oe(d.icon,ge.numVerticalIconVertices,Yt?jc:ut),d.icon.placedSymbolArray.get(ge.verticalPlacedIconSymbolIndex).hidden=Me.icon.isHidden())}if(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData()){var dn=d.collisionArrays[ae];if(dn){var et=new v.Point(0,0);if(dn.textBox||dn.verticalTextBox){var zt=!0;if(R){var $t=g.variableOffsets[De];$t?(et=Mt($t.anchor,$t.width,$t.height,$t.textOffset,$t.textBoxScale),L&&et._rotate(q?g.transform.angle:-g.transform.angle)):zt=!1}dn.textBox&&Nu(d.textCollisionBox.collisionVertexArray,Me.text.placed,!zt||qe,et.x,et.y),dn.verticalTextBox&&Nu(d.textCollisionBox.collisionVertexArray,Me.text.placed,!zt||at,et.x,et.y)}var Ut=!(at||!dn.verticalIconBox);dn.iconBox&&Nu(d.iconCollisionBox.collisionVertexArray,Me.icon.placed,Ut,W?et.x:0,W?et.y:0),dn.verticalIconBox&&Nu(d.iconCollisionBox.collisionVertexArray,Me.icon.placed,!Ut,W?et.x:0,W?et.y:0)}}},de=0;de<d.symbolInstances.length;de++)ne(de);if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.bucketInstanceId in this.collisionCircleArrays){var re=this.collisionCircleArrays[d.bucketInstanceId];d.placementInvProjMatrix=re.invProjMatrix,d.placementViewportMatrix=re.viewportMatrix,d.collisionCircleArray=re.circles,delete this.collisionCircleArrays[d.bucketInstanceId]}},Ti.prototype.symbolFadeChange=function(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ti.prototype.zoomAdjustment=function(d){return Math.max(0,(this.transform.zoom-d)/1.5)},Ti.prototype.hasTransitions=function(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration},Ti.prototype.stillRecent=function(d,p){var h=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*h>d},Ti.prototype.setStale=function(){this.stale=!0};var Fp=Math.pow(2,25),Nw=Math.pow(2,24),je=Math.pow(2,17),jr=Math.pow(2,16),rf=Math.pow(2,9),Ng=Math.pow(2,8),Xy=Math.pow(2,1);function Bp(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;var p=d.placed?1:0,h=Math.floor(127*d.opacity);return h*Fp+p*Nw+h*je+p*jr+h*rf+p*Ng+h*Xy+p}var jc=0,Hc=function(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&!d.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Hc.prototype.continuePlacement=function(d,p,h,g,w){for(var C=this._bucketParts;this._currentTileIndex<d.length;)if(p.getBucketParts(C,g,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort(function(T,I){return T.sortKey-I.sortKey}));this._currentPartIndex<C.length;)if(p.placeLayerBucketPart(C[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,w())return!0;return!1};var $c=function(d,p,h,g,w,C,T){this.placement=new Ti(d,w,C,T),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1};$c.prototype.isDone=function(){return this._done},$c.prototype.continuePlacement=function(d,p,h){for(var g=this,w=v.browser.now(),C=function(){var R=v.browser.now()-w;return!g._forceFullPlacement&&R>2};this._currentPlacementIndex>=0;){var T=p[d[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=I)&&(!T.maxzoom||T.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Hc(T)),this._inProgressLayer.continuePlacement(h[T.source],this.placement,this._showCollisionBoxes,T,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$c.prototype.commit=function(d){return this.placement.commit(d),this.placement};var Fe=512/v.EXTENT/2,Ou=function(d,p,h){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(var g=0;g<p.length;g++){var w=p.get(g),C=w.key;this.indexedSymbolInstances[C]||(this.indexedSymbolInstances[C]=[]),this.indexedSymbolInstances[C].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,d)})}};Ou.prototype.getScaledCoordinates=function(d,p){var h=Fe/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*v.EXTENT+d.anchorX)*h),y:Math.floor((p.canonical.y*v.EXTENT+d.anchorY)*h)}},Ou.prototype.findMatches=function(d,p,h){for(var g=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),w=0;w<d.length;w++){var C=d.get(w);if(!C.crossTileID){var T=this.indexedSymbolInstances[C.key];if(T)for(var I=this.getScaledCoordinates(C,p),R=0,L=T;R<L.length;R+=1){var q=L[R];if(Math.abs(q.coord.x-I.x)<=g&&Math.abs(q.coord.y-I.y)<=g&&!h[q.crossTileID]){h[q.crossTileID]=!0,C.crossTileID=q.crossTileID;break}}}}};var Zl=function(){this.maxCrossTileID=0};Zl.prototype.generate=function(){return++this.maxCrossTileID};var io=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};io.prototype.handleWrapJump=function(d){var p=Math.round((d-this.lng)/360);if(0!==p)for(var h in this.indexes){var g=this.indexes[h],w={};for(var C in g){var T=g[C];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+p),w[T.tileID.key]=T}this.indexes[h]=w}this.lng=d},io.prototype.addBucket=function(d,p,h){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(var g=0;g<p.symbolInstances.length;g++)p.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var w=this.usedCrossTileIDs[d.overscaledZ];for(var C in this.indexes){var T=this.indexes[C];if(Number(C)>d.overscaledZ)for(var I in T){var R=T[I];R.tileID.isChildOf(d)&&R.findMatches(p.symbolInstances,d,w)}else{var L=T[d.scaledTo(Number(C)).key];L&&L.findMatches(p.symbolInstances,d,w)}}for(var q=0;q<p.symbolInstances.length;q++){var W=p.symbolInstances.get(q);W.crossTileID||(W.crossTileID=h.generate(),w[W.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new Ou(d,p.symbolInstances,p.bucketInstanceId),!0},io.prototype.removeBucketCrossTileIDs=function(d,p){for(var h in p.indexedSymbolInstances)for(var g=0,w=p.indexedSymbolInstances[h];g<w.length;g+=1)delete this.usedCrossTileIDs[d][w[g].crossTileID]},io.prototype.removeStaleBuckets=function(d){var p=!1;for(var h in this.indexes){var g=this.indexes[h];for(var w in g)d[g[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,g[w]),delete g[w],p=!0)}return p};var Is=function(){this.layerIndexes={},this.crossTileIDs=new Zl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Is.prototype.addLayer=function(d,p,h){var g=this.layerIndexes[d.id];void 0===g&&(g=this.layerIndexes[d.id]=new io);var w=!1,C={};g.handleWrapJump(h);for(var T=0,I=p;T<I.length;T+=1){var R=I[T],L=R.getBucket(d);L&&d.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(R.tileID,L,this.crossTileIDs)&&(w=!0),C[L.bucketInstanceId]=!0)}return g.removeStaleBuckets(C)&&(w=!0),w},Is.prototype.pruneUnusedLayers=function(d){var p={};for(var h in d.forEach(function(g){p[g]=!0}),this.layerIndexes)p[h]||delete this.layerIndexes[h]};var Yl=function(d,p){return v.emitValidationErrors(d,p&&p.filter(function(h){return"source.canvas"!==h.identifier}))},sf=v.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Xl=v.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),ks=function(){var d={},p=v.styleSpec.$version;for(var h in v.styleSpec.$root){var g,w=v.styleSpec.$root[h];w.required&&null!=(g="version"===h?p:"array"===w.type?[]:{})&&(d[h]=g)}return d}(),Ql=function(d){function p(h,g){var w=this;void 0===g&&(g={}),d.call(this),this.map=h,this.dispatcher=new Po(xt(),this),this.imageManager=new Fi,this.imageManager.setEventedParent(this),this.glyphManager=new Bi(h._requestManager,g.localIdeographFontFamily),this.lineAtlas=new fr(256,512),this.crossTileSymbolIndex=new Is,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new v.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",v.getReferrer());var C=this;this._rtlTextPluginCallback=p.registerForPluginStateChange(function(T){C.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},function(I,R){if(v.triggerPluginCompletionEvent(I),R&&R.every(function(q){return q}))for(var L in C.sourceCaches)C.sourceCaches[L].reload()})}),this.on("data",function(T){if("source"===T.dataType&&"metadata"===T.sourceDataType){var I=w.sourceCaches[T.sourceId];if(I){var R=I.getSource();if(R&&R.vectorLayerIds)for(var L in w._layers){var q=w._layers[L];q.source===R.id&&w._validateLayer(q)}}}})}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.loadURL=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"}));var C="boolean"==typeof g.validate?g.validate:!v.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,g.accessToken);var T=this.map._requestManager.transformRequest(h,v.ResourceType.Style);this._request=v.getJSON(T,function(I,R){w._request=null,I?w.fire(new v.ErrorEvent(I)):R&&w._load(R,C)})},p.prototype.loadJSON=function(h,g){var w=this;void 0===g&&(g={}),this.fire(new v.Event("dataloading",{dataType:"style"})),this._request=v.browser.frame(function(){w._request=null,w._load(h,!1!==g.validate)})},p.prototype.loadEmpty=function(){this.fire(new v.Event("dataloading",{dataType:"style"})),this._load(ks,!1)},p.prototype._load=function(h,g){if(!g||!Yl(this,v.validateStyle(h))){for(var w in this._loaded=!0,this.stylesheet=h,h.sources)this.addSource(w,h.sources[w],{validate:!1});h.sprite?this._loadSprite(h.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(h.glyphs);var C=rt(this.stylesheet.layers);this._order=C.map(function(L){return L.id}),this._layers={},this._serializedLayers={};for(var T=0,I=C;T<I.length;T+=1){var R=I[T];(R=v.createStyleLayer(R)).setEventedParent(this,{layer:{id:R.id}}),this._layers[R.id]=R,this._serializedLayers[R.id]=R.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ul(this.stylesheet.light),this.fire(new v.Event("data",{dataType:"style"})),this.fire(new v.Event("style.load"))}},p.prototype._loadSprite=function(h){var g=this;this._spriteRequest=function(w,C,T){var I,R,L,q=v.browser.devicePixelRatio>1?"@2x":"",W=v.getJSON(C.transformRequest(C.normalizeSpriteURL(w,q,".json"),v.ResourceType.SpriteJSON),function(ne,de){W=null,L||(L=ne,I=de,oe())}),H=v.getImage(C.transformRequest(C.normalizeSpriteURL(w,q,".png"),v.ResourceType.SpriteImage),function(ne,de){H=null,L||(L=ne,R=de,oe())});function oe(){if(L)T(L);else if(I&&R){var ne=v.browser.getImageData(R),de={};for(var re in I){var ae=I[re],ge=ae.width,be=ae.height,Ae=ae.x,De=ae.y,Me=ae.sdf,Le=ae.pixelRatio,Qe=ae.stretchX,qe=ae.stretchY,at=ae.content,Et=new v.RGBAImage({width:ge,height:be});v.RGBAImage.copy(ne,Et,{x:Ae,y:De},{x:0,y:0},{width:ge,height:be}),de[re]={data:Et,pixelRatio:Le,sdf:Me,stretchX:Qe,stretchY:qe,content:at}}T(null,de)}}return{cancel:function(){W&&(W.cancel(),W=null),H&&(H.cancel(),H=null)}}}(h,this.map._requestManager,function(w,C){if(g._spriteRequest=null,w)g.fire(new v.ErrorEvent(w));else if(C)for(var T in C)g.imageManager.addImage(T,C[T]);g.imageManager.setLoaded(!0),g._availableImages=g.imageManager.listImages(),g.dispatcher.broadcast("setImages",g._availableImages),g.fire(new v.Event("data",{dataType:"style"}))})},p.prototype._validateLayer=function(h){var g=this.sourceCaches[h.source];if(g){var w=h.sourceLayer;if(w){var C=g.getSource();("geojson"===C.type||C.vectorLayerIds&&-1===C.vectorLayerIds.indexOf(w))&&this.fire(new v.ErrorEvent(new Error('Source layer "'+w+'" does not exist on source "'+C.id+'" as specified by style layer "'+h.id+'"')))}}},p.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var h in this.sourceCaches)if(!this.sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()},p.prototype._serializeLayers=function(h){for(var g=[],w=0,C=h;w<C.length;w+=1){var T=this._layers[C[w]];"custom"!==T.type&&g.push(T.serialize())}return g},p.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(var g in this._layers)if(this._layers[g].hasTransition())return!0;return!1},p.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},p.prototype.update=function(h){if(this._loaded){var g=this._changed;if(this._changed){var w=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);for(var T in(w.length||C.length)&&this._updateWorkerLayers(w,C),this._updatedSources){var I=this._updatedSources[T];"reload"===I?this._reloadSource(T):"clear"===I&&this._clearSource(T)}for(var R in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[R].updateTransitions(h);this.light.updateTransitions(h),this._resetUpdates()}var L={};for(var q in this.sourceCaches){var W=this.sourceCaches[q];L[q]=W.used,W.used=!1}for(var H=0,oe=this._order;H<oe.length;H+=1){var ne=this._layers[oe[H]];ne.recalculate(h,this._availableImages),!ne.isHidden(h.zoom)&&ne.source&&(this.sourceCaches[ne.source].used=!0)}for(var de in L){var re=this.sourceCaches[de];L[de]!==re.used&&re.fire(new v.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:de}))}this.light.recalculate(h),this.z=h.zoom,g&&this.fire(new v.Event("data",{dataType:"style"}))}},p.prototype._updateTilesForChangedImages=function(){var h=Object.keys(this._changedImages);if(h.length){for(var g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}},p.prototype._updateWorkerLayers=function(h,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:g})},p.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},p.prototype.setState=function(h){var g=this;if(this._checkLoaded(),Yl(this,v.validateStyle(h)))return!1;(h=v.clone$1(h)).layers=rt(h.layers);var w=function(T,I){if(!T)return[{command:Ve.setStyle,args:[I]}];var R=[];try{if(!v.deepEqual(T.version,I.version))return[{command:Ve.setStyle,args:[I]}];v.deepEqual(T.center,I.center)||R.push({command:Ve.setCenter,args:[I.center]}),v.deepEqual(T.zoom,I.zoom)||R.push({command:Ve.setZoom,args:[I.zoom]}),v.deepEqual(T.bearing,I.bearing)||R.push({command:Ve.setBearing,args:[I.bearing]}),v.deepEqual(T.pitch,I.pitch)||R.push({command:Ve.setPitch,args:[I.pitch]}),v.deepEqual(T.sprite,I.sprite)||R.push({command:Ve.setSprite,args:[I.sprite]}),v.deepEqual(T.glyphs,I.glyphs)||R.push({command:Ve.setGlyphs,args:[I.glyphs]}),v.deepEqual(T.transition,I.transition)||R.push({command:Ve.setTransition,args:[I.transition]}),v.deepEqual(T.light,I.light)||R.push({command:Ve.setLight,args:[I.light]});var L={},q=[];!function(H,oe,ne,de){var re;for(re in oe=oe||{},H=H||{})H.hasOwnProperty(re)&&(oe.hasOwnProperty(re)||en(re,ne,de));for(re in oe)oe.hasOwnProperty(re)&&(H.hasOwnProperty(re)?v.deepEqual(H[re],oe[re])||("geojson"===H[re].type&&"geojson"===oe[re].type&&ur(H,oe,re)?ne.push({command:Ve.setGeoJSONSourceData,args:[re,oe[re].data]}):ue(re,oe,ne,de)):Jt(re,oe,ne))}(T.sources,I.sources,q,L);var W=[];T.layers&&T.layers.forEach(function(H){L[H.source]?R.push({command:Ve.removeLayer,args:[H.id]}):W.push(H)}),R=R.concat(q),function(H,oe,ne){oe=oe||[];var de,re,ae,ge,be,Ae,De,Me=(H=H||[]).map(an),Le=oe.map(an),Qe=H.reduce(Cr,{}),qe=oe.reduce(Cr,{}),at=Me.slice(),Et=Object.create(null);for(de=0,re=0;de<Me.length;de++)qe.hasOwnProperty(ae=Me[de])?re++:(ne.push({command:Ve.removeLayer,args:[ae]}),at.splice(at.indexOf(ae,re),1));for(de=0,re=0;de<Le.length;de++)at[at.length-1-de]!==(ae=Le[Le.length-1-de])&&(Qe.hasOwnProperty(ae)?(ne.push({command:Ve.removeLayer,args:[ae]}),at.splice(at.lastIndexOf(ae,at.length-re),1)):re++,ne.push({command:Ve.addLayer,args:[qe[ae],Ae=at[at.length-de]]}),at.splice(at.length-de,0,ae),Et[ae]=!0);for(de=0;de<Le.length;de++)if(ge=Qe[ae=Le[de]],be=qe[ae],!Et[ae]&&!v.deepEqual(ge,be))if(v.deepEqual(ge.source,be.source)&&v.deepEqual(ge["source-layer"],be["source-layer"])&&v.deepEqual(ge.type,be.type)){for(De in jt(ge.layout,be.layout,ne,ae,null,Ve.setLayoutProperty),jt(ge.paint,be.paint,ne,ae,null,Ve.setPaintProperty),v.deepEqual(ge.filter,be.filter)||ne.push({command:Ve.setFilter,args:[ae,be.filter]}),v.deepEqual(ge.minzoom,be.minzoom)&&v.deepEqual(ge.maxzoom,be.maxzoom)||ne.push({command:Ve.setLayerZoomRange,args:[ae,be.minzoom,be.maxzoom]}),ge)ge.hasOwnProperty(De)&&"layout"!==De&&"paint"!==De&&"filter"!==De&&"metadata"!==De&&"minzoom"!==De&&"maxzoom"!==De&&(0===De.indexOf("paint.")?jt(ge[De],be[De],ne,ae,De.slice(6),Ve.setPaintProperty):v.deepEqual(ge[De],be[De])||ne.push({command:Ve.setLayerProperty,args:[ae,De,be[De]]}));for(De in be)be.hasOwnProperty(De)&&!ge.hasOwnProperty(De)&&"layout"!==De&&"paint"!==De&&"filter"!==De&&"metadata"!==De&&"minzoom"!==De&&"maxzoom"!==De&&(0===De.indexOf("paint.")?jt(ge[De],be[De],ne,ae,De.slice(6),Ve.setPaintProperty):v.deepEqual(ge[De],be[De])||ne.push({command:Ve.setLayerProperty,args:[ae,De,be[De]]}))}else ne.push({command:Ve.removeLayer,args:[ae]}),Ae=at[at.lastIndexOf(ae)+1],ne.push({command:Ve.addLayer,args:[be,Ae]})}(W,I.layers,R)}catch(H){console.warn("Unable to compute style diff:",H),R=[{command:Ve.setStyle,args:[I]}]}return R}(this.serialize(),h).filter(function(T){return!(T.command in Xl)});if(0===w.length)return!1;var C=w.filter(function(T){return!(T.command in sf)});if(C.length>0)throw new Error("Unimplemented: "+C.map(function(T){return T.command}).join(", ")+".");return w.forEach(function(T){"setTransition"!==T.command&&g[T.command].apply(g,T.args)}),this.stylesheet=h,!0},p.prototype.addImage=function(h,g){if(this.getImage(h))return this.fire(new v.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(h,g),this._afterImageUpdated(h)},p.prototype.updateImage=function(h,g){this.imageManager.updateImage(h,g)},p.prototype.getImage=function(h){return this.imageManager.getImage(h)},p.prototype.removeImage=function(h){if(!this.getImage(h))return this.fire(new v.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(h),this._afterImageUpdated(h)},p.prototype._afterImageUpdated=function(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new v.Event("data",{dataType:"style"}))},p.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},p.prototype.addSource=function(h,g,w){var C=this;if(void 0===w&&(w={}),this._checkLoaded(),void 0!==this.sourceCaches[h])throw new Error("There is already a source with this ID");if(!g.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(g).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(v.validateStyle.source,"sources."+h,g,null,w))){this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);var T=this.sourceCaches[h]=new Z(h,g,this.dispatcher);T.style=this,T.setEventedParent(this,function(){return{isSourceLoaded:C.loaded(),source:T.serialize(),sourceId:h}}),T.onAdd(this.map),this._changed=!0}},p.prototype.removeSource=function(h){if(this._checkLoaded(),void 0===this.sourceCaches[h])throw new Error("There is no source with this ID");for(var g in this._layers)if(this._layers[g].source===h)return this.fire(new v.ErrorEvent(new Error('Source "'+h+'" cannot be removed while layer "'+g+'" is using it.')));var w=this.sourceCaches[h];delete this.sourceCaches[h],delete this._updatedSources[h],w.fire(new v.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:h})),w.setEventedParent(null),w.clearTiles(),w.onRemove&&w.onRemove(this.map),this._changed=!0},p.prototype.setGeoJSONSourceData=function(h,g){this._checkLoaded(),this.sourceCaches[h].getSource().setData(g),this._changed=!0},p.prototype.getSource=function(h){return this.sourceCaches[h]&&this.sourceCaches[h].getSource()},p.prototype.addLayer=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var C=h.id;if(this.getLayer(C))this.fire(new v.ErrorEvent(new Error('Layer with id "'+C+'" already exists on this map')));else{var T;if("custom"===h.type){if(Yl(this,v.validateCustomStyleLayer(h)))return;T=v.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(C,h.source),h=v.clone$1(h),h=v.extend(h,{source:C})),this._validate(v.validateStyle.layer,"layers."+C,h,{arrayIndex:-1},w))return;T=v.createStyleLayer(h),this._validateLayer(T),T.setEventedParent(this,{layer:{id:C}}),this._serializedLayers[T.id]=T.serialize()}var I=g?this._order.indexOf(g):this._order.length;if(g&&-1===I)this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.')));else{if(this._order.splice(I,0,C),this._layerOrderChanged=!0,this._layers[C]=T,this._removedLayers[C]&&T.source&&"custom"!==T.type){var R=this._removedLayers[C];delete this._removedLayers[C],R.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map)}}},p.prototype.moveLayer=function(h,g){if(this._checkLoaded(),this._changed=!0,this._layers[h]){if(h!==g){var w=this._order.indexOf(h);this._order.splice(w,1);var C=g?this._order.indexOf(g):this._order.length;g&&-1===C?this.fire(new v.ErrorEvent(new Error('Layer with id "'+g+'" does not exist on this map.'))):(this._order.splice(C,0,h),this._layerOrderChanged=!0)}}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be moved.")))},p.prototype.removeLayer=function(h){this._checkLoaded();var g=this._layers[h];if(g){g.setEventedParent(null);var w=this._order.indexOf(h);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=g,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],g.onRemove&&g.onRemove(this.map)}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be removed.")))},p.prototype.getLayer=function(h){return this._layers[h]},p.prototype.hasLayer=function(h){return h in this._layers},p.prototype.setLayerZoomRange=function(h,g,w){this._checkLoaded();var C=this.getLayer(h);C?C.minzoom===g&&C.maxzoom===w||(null!=g&&(C.minzoom=g),null!=w&&(C.maxzoom=w),this._updateLayer(C)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot have zoom extent.")))},p.prototype.setFilter=function(h,g,w){void 0===w&&(w={}),this._checkLoaded();var C=this.getLayer(h);if(C){if(!v.deepEqual(C.filter,g))return null==g?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(v.validateStyle.filter,"layers."+C.id+".filter",g,null,w)||(C.filter=v.clone$1(g),this._updateLayer(C)))}else this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be filtered.")))},p.prototype.getFilter=function(h){return v.clone$1(this.getLayer(h).filter)},p.prototype.setLayoutProperty=function(h,g,w,C){void 0===C&&(C={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getLayoutProperty(g),w)||(T.setLayoutProperty(g,w,C),this._updateLayer(T)):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getLayoutProperty=function(h,g){var w=this.getLayer(h);if(w)return w.getLayoutProperty(g);this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style.")))},p.prototype.setPaintProperty=function(h,g,w,C){void 0===C&&(C={}),this._checkLoaded();var T=this.getLayer(h);T?v.deepEqual(T.getPaintProperty(g),w)||(T.setPaintProperty(g,w,C)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new v.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be styled.")))},p.prototype.getPaintProperty=function(h,g){return this.getLayer(h).getPaintProperty(g)},p.prototype.setFeatureState=function(h,g){this._checkLoaded();var w=h.source,C=h.sourceLayer,T=this.sourceCaches[w];if(void 0!==T){var I=T.getSource().type;"geojson"===I&&C?this.fire(new v.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==I||C?(void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),T.setFeatureState(C,h.id,g)):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},p.prototype.removeFeatureState=function(h,g){this._checkLoaded();var w=h.source,C=this.sourceCaches[w];if(void 0!==C){var T=C.getSource().type,I="vector"===T?h.sourceLayer:void 0;"vector"!==T||I?g&&"string"!=typeof h.id&&"number"!=typeof h.id?this.fire(new v.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(I,h.id,g):this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+w+"' does not exist in the map's style.")))},p.prototype.getFeatureState=function(h){this._checkLoaded();var g=h.source,w=h.sourceLayer,C=this.sourceCaches[g];if(void 0!==C){if("vector"!==C.getSource().type||w)return void 0===h.id&&this.fire(new v.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(w,h.id);this.fire(new v.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new v.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},p.prototype.getTransition=function(){return v.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},p.prototype.serialize=function(){return v.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:v.mapObject(this.sourceCaches,function(h){return h.serialize()}),layers:this._serializeLayers(this._order)},function(h){return void 0!==h})},p.prototype._updateLayer=function(h){this._updatedLayers[h.id]=!0,h.source&&!this._updatedSources[h.source]&&"raster"!==this.sourceCaches[h.source].getSource().type&&(this._updatedSources[h.source]="reload",this.sourceCaches[h.source].pause()),this._changed=!0},p.prototype._flattenAndSortRenderedFeatures=function(h){for(var g=this,w=function(Qe){return"fill-extrusion"===g._layers[Qe].type},C={},T=[],I=this._order.length-1;I>=0;I--){var R=this._order[I];if(w(R)){C[R]=I;for(var L=0,q=h;L<q.length;L+=1){var W=q[L][R];if(W)for(var H=0,oe=W;H<oe.length;H+=1)T.push(oe[H])}}}T.sort(function(Qe,qe){return qe.intersectionZ-Qe.intersectionZ});for(var ne=[],de=this._order.length-1;de>=0;de--){var re=this._order[de];if(w(re))for(var ae=T.length-1;ae>=0;ae--){var ge=T[ae].feature;if(C[ge.layer.id]<de)break;ne.push(ge),T.pop()}else for(var be=0,Ae=h;be<Ae.length;be+=1){var De=Ae[be][re];if(De)for(var Me=0,Le=De;Me<Le.length;Me+=1)ne.push(Le[Me].feature)}}return ne},p.prototype.queryRenderedFeatures=function(h,g,w){g&&g.filter&&this._validate(v.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);var C={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new v.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var T=0,I=g.layers;T<I.length;T+=1){var R=I[T],L=this._layers[R];if(!L)return this.fire(new v.ErrorEvent(new Error("The layer '"+R+"' does not exist in the map's style and cannot be queried for features."))),[];C[L.source]=!0}}var q=[];for(var W in g.availableImages=this._availableImages,this.sourceCaches)g.layers&&!C[W]||q.push(Vi(this.sourceCaches[W],this._layers,this._serializedLayers,h,g,w));return this.placement&&q.push(function(H,oe,ne,de,re,ae,ge){for(var be={},Ae=ae.queryRenderedSymbols(de),De=[],Me=0,Le=Object.keys(Ae).map(Number);Me<Le.length;Me+=1)De.push(ge[Le[Me]]);De.sort(hl);for(var Qe=function(){var St=at[qe],pn=St.featureIndex.lookupSymbolFeatures(Ae[St.bucketInstanceId],oe,St.bucketIndex,St.sourceLayerIndex,re.filter,re.layers,re.availableImages,H);for(var ut in pn){var Yt=be[ut]=be[ut]||[],dn=pn[ut];dn.sort(function($t,Ut){var Rt=St.featureSortOrder;if(Rt){var rr=Rt.indexOf($t.featureIndex);return Rt.indexOf(Ut.featureIndex)-rr}return Ut.featureIndex-$t.featureIndex});for(var et=0,zt=dn;et<zt.length;et+=1)Yt.push(zt[et])}},qe=0,at=De;qe<at.length;qe+=1)Qe();var Et=function(St){be[St].forEach(function(pn){var ut=pn.feature,Yt=ne[H[St].source].getFeatureState(ut.layer["source-layer"],ut.id);ut.source=ut.layer.source,ut.layer["source-layer"]&&(ut.sourceLayer=ut.layer["source-layer"]),ut.state=Yt})};for(var It in be)Et(It);return be}(this._layers,this._serializedLayers,this.sourceCaches,h,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(q)},p.prototype.querySourceFeatures=function(h,g){g&&g.filter&&this._validate(v.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);var w=this.sourceCaches[h];return w?function(C,T){for(var I=C.getRenderableIds().map(function(oe){return C.getTileByID(oe)}),R=[],L={},q=0;q<I.length;q++){var W=I[q],H=W.tileID.canonical.key;L[H]||(L[H]=!0,W.querySourceFeatures(R,T))}return R}(w,g):[]},p.prototype.addSourceType=function(h,g,w){return p.getSourceType(h)?w(new Error('A source type called "'+h+'" already exists.')):(p.setSourceType(h,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:g.workerSourceURL},w):w(null,null))},p.prototype.getLight=function(){return this.light.getLight()},p.prototype.setLight=function(h,g){void 0===g&&(g={}),this._checkLoaded();var w=this.light.getLight(),C=!1;for(var T in h)if(!v.deepEqual(h[T],w[T])){C=!0;break}if(C){var I={now:v.browser.now(),transition:v.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(h,g),this.light.updateTransitions(I)}},p.prototype._validate=function(h,g,w,C,T){return void 0===T&&(T={}),(!T||!1!==T.validate)&&Yl(this,h.call(v.validateStyle,v.extend({key:g,style:this.serialize(),value:w,styleSpec:v.styleSpec},C)))},p.prototype._remove=function(){for(var h in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),v.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[h].setEventedParent(null);for(var g in this.sourceCaches)this.sourceCaches[g].clearTiles(),this.sourceCaches[g].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},p.prototype._clearSource=function(h){this.sourceCaches[h].clearTiles()},p.prototype._reloadSource=function(h){this.sourceCaches[h].resume(),this.sourceCaches[h].reload()},p.prototype._updateSources=function(h){for(var g in this.sourceCaches)this.sourceCaches[g].update(h)},p.prototype._generateCollisionBoxes=function(){for(var h in this.sourceCaches)this._reloadSource(h)},p.prototype._updatePlacement=function(h,g,w,C,T){void 0===T&&(T=!1);for(var I=!1,R=!1,L={},q=0,W=this._order;q<W.length;q+=1){var H=this._layers[W[q]];if("symbol"===H.type){if(!L[H.source]){var oe=this.sourceCaches[H.source];L[H.source]=oe.getRenderableIds(!0).map(function(ge){return oe.getTileByID(ge)}).sort(function(ge,be){return be.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(be.tileID)?-1:1)})}var ne=this.crossTileSymbolIndex.addLayer(H,L[H.source],h.center.lng);I=I||ne}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((T=T||this._layerOrderChanged||0===w)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.browser.now(),h.zoom))&&(this.pauseablePlacement=new $c(h,this._order,T,g,w,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.browser.now()),R=!0),I&&this.pauseablePlacement.placement.setStale()),R||I)for(var de=0,re=this._order;de<re.length;de+=1){var ae=this._layers[re[de]];"symbol"===ae.type&&this.placement.updateLayerOpacities(ae,L[ae.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.browser.now())},p.prototype._releaseSymbolFadeTiles=function(){for(var h in this.sourceCaches)this.sourceCaches[h].releaseSymbolFadeTiles()},p.prototype.getImages=function(h,g,w){this.imageManager.getImages(g.icons,w),this._updateTilesForChangedImages();var C=this.sourceCaches[g.source];C&&C.setDependencies(g.tileID.key,g.type,g.icons)},p.prototype.getGlyphs=function(h,g,w){this.glyphManager.getGlyphs(g.stacks,w)},p.prototype.getResource=function(h,g,w){return v.makeRequest(g,w)},p}(v.Evented);Ql.getSourceType=function(d){return dl[d]},Ql.setSourceType=function(d,p){dl[d]=p},Ql.registerForPluginStateChange=v.registerForPluginStateChange;var Pa=v.createLayout([{name:"a_pos",type:"Int16",components:2}]),pi=yr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Vp=yr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qy=yr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Jy=yr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ow=yr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Vd=yr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),af=yr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),zp=yr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Up=yr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),jp=yr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Jl=yr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),zd=yr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Lu=yr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ss=yr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),lf=yr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),ln=yr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Og=yr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),oi=yr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),oo=yr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Na=yr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),$s=yr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),tn=yr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),Tn=yr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Fu=yr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),ec=yr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),cf=yr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function yr(d,p){var h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=p.match(/attribute ([\w]+) ([\w]+)/g),w=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=C?C.concat(w):w,I={};return{fragmentSource:d=d.replace(h,function(R,L,q,W,H){return I[H]=!0,"define"===L?"\n#ifndef HAS_UNIFORM_u_"+H+"\nvarying "+q+" "+W+" "+H+";\n#else\nuniform "+q+" "+W+" u_"+H+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+H+"\n    "+q+" "+W+" "+H+" = u_"+H+";\n#endif\n"}),vertexSource:p=p.replace(h,function(R,L,q,W,H){var oe="float"===W?"vec2":"vec4",ne=H.match(/color/)?"color":oe;return I[H]?"define"===L?"\n#ifndef HAS_UNIFORM_u_"+H+"\nuniform lowp float u_"+H+"_t;\nattribute "+q+" "+oe+" a_"+H+";\nvarying "+q+" "+W+" "+H+";\n#else\nuniform "+q+" "+W+" u_"+H+";\n#endif\n":"vec4"===ne?"\n#ifndef HAS_UNIFORM_u_"+H+"\n    "+H+" = a_"+H+";\n#else\n    "+q+" "+W+" "+H+" = u_"+H+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+H+"\n    "+H+" = unpack_mix_"+ne+"(a_"+H+", u_"+H+"_t);\n#else\n    "+q+" "+W+" "+H+" = u_"+H+";\n#endif\n":"define"===L?"\n#ifndef HAS_UNIFORM_u_"+H+"\nuniform lowp float u_"+H+"_t;\nattribute "+q+" "+oe+" a_"+H+";\n#else\nuniform "+q+" "+W+" u_"+H+";\n#endif\n":"vec4"===ne?"\n#ifndef HAS_UNIFORM_u_"+H+"\n    "+q+" "+W+" "+H+" = a_"+H+";\n#else\n    "+q+" "+W+" "+H+" = u_"+H+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+H+"\n    "+q+" "+W+" "+H+" = unpack_mix_"+ne+"(a_"+H+", u_"+H+"_t);\n#else\n    "+q+" "+W+" "+H+" = u_"+H+";\n#endif\n"}),staticAttributes:g,staticUniforms:T}}var Oa=Object.freeze({__proto__:null,prelude:pi,background:Vp,backgroundPattern:Qy,circle:Jy,clippingMask:Ow,heatmap:Vd,heatmapTexture:af,collisionBox:zp,collisionCircle:Up,debug:jp,fill:Jl,fillOutline:zd,fillOutlinePattern:Lu,fillPattern:ss,fillExtrusion:lf,fillExtrusionPattern:ln,hillshadePrepare:Og,hillshade:oi,line:oo,lineGradient:Na,linePattern:$s,lineSDF:tn,raster:Tn,symbolIcon:Fu,symbolSDF:ec,symbolTextAndIcon:cf}),Bu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ev(d){for(var p=[],h=0;h<d.length;h++)if(null!==d[h]){var g=d[h].split(" ");p.push(g.pop())}return p}Bu.prototype.bind=function(d,p,h,g,w,C,T,I){this.context=d;for(var R=this.boundPaintVertexBuffers.length!==g.length,L=0;!R&&L<g.length;L++)this.boundPaintVertexBuffers[L]!==g[L]&&(R=!0);d.extVertexArrayObject&&this.vao&&this.boundProgram===p&&this.boundLayoutVertexBuffer===h&&!R&&this.boundIndexBuffer===w&&this.boundVertexOffset===C&&this.boundDynamicVertexBuffer===T&&this.boundDynamicVertexBuffer2===I?(d.bindVertexArrayOES.set(this.vao),T&&T.bind(),w&&w.dynamicDraw&&w.bind(),I&&I.bind()):this.freshBind(p,h,g,w,C,T,I)},Bu.prototype.freshBind=function(d,p,h,g,w,C,T){var I,R=d.numAttributes,L=this.context,q=L.gl;if(L.extVertexArrayObject)this.vao&&this.destroy(),this.vao=L.extVertexArrayObject.createVertexArrayOES(),L.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=d,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=g,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=C,this.boundDynamicVertexBuffer2=T;else{I=L.currentNumAttributes||0;for(var W=R;W<I;W++)q.disableVertexAttribArray(W)}p.enableAttributes(q,d);for(var H=0,oe=h;H<oe.length;H+=1)oe[H].enableAttributes(q,d);C&&C.enableAttributes(q,d),T&&T.enableAttributes(q,d),p.bind(),p.setVertexAttribPointers(q,d,w);for(var ne=0,de=h;ne<de.length;ne+=1){var re=de[ne];re.bind(),re.setVertexAttribPointers(q,d,w)}C&&(C.bind(),C.setVertexAttribPointers(q,d,w)),g&&g.bind(),T&&(T.bind(),T.setVertexAttribPointers(q,d,w)),L.currentNumAttributes=R},Bu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var tv=function(d,p,h,g,w,C){var T=d.gl;this.program=T.createProgram();for(var I=ev(h.staticAttributes),R=g?g.getBinderAttributes():[],L=I.concat(R),q=h.staticUniforms?ev(h.staticUniforms):[],W=g?g.getBinderUniforms():[],H=[],oe=0,ne=q.concat(W);oe<ne.length;oe+=1){var de=ne[oe];H.indexOf(de)<0&&H.push(de)}var re=g?g.defines():[];C&&re.push("#define OVERDRAW_INSPECTOR;");var ae=re.concat(pi.fragmentSource,h.fragmentSource).join("\n"),ge=re.concat(pi.vertexSource,h.vertexSource).join("\n"),be=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(be,ae),T.compileShader(be),T.attachShader(this.program,be);var Ae=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Ae,ge),T.compileShader(Ae),T.attachShader(this.program,Ae),this.attributes={};var De={};this.numAttributes=L.length;for(var Me=0;Me<this.numAttributes;Me++)L[Me]&&(T.bindAttribLocation(this.program,Me,L[Me]),this.attributes[L[Me]]=Me);T.linkProgram(this.program),T.deleteShader(Ae),T.deleteShader(be);for(var Le=0;Le<H.length;Le++){var Qe=H[Le];if(Qe&&!De[Qe]){var qe=T.getUniformLocation(this.program,Qe);qe&&(De[Qe]=qe)}}this.fixedUniforms=w(d,De),this.binderUniforms=g?g.getUniforms(d,De):[]}}};function Lg(d,p,h){var g=1/is(h,1,p.transform.tileZoom),w=Math.pow(2,h.tileID.overscaledZ),C=h.tileSize*Math.pow(2,p.transform.tileZoom)/w,T=C*(h.tileID.canonical.x+h.tileID.wrap*w),I=C*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[T>>16,I>>16],u_pixel_coord_lower:[65535&T,65535&I]}}tv.prototype.draw=function(d,p,h,g,w,C,T,I,R,L,q,W,H,oe,ne,de){var re,ae=d.gl;if(!this.failedToCreate){for(var ge in d.program.set(this.program),d.setDepthMode(h),d.setStencilMode(g),d.setColorMode(w),d.setCullFace(C),this.fixedUniforms)this.fixedUniforms[ge].set(T[ge]);oe&&oe.setUniforms(d,this.binderUniforms,W,{zoom:H});for(var be=(re={},re[ae.LINES]=2,re[ae.TRIANGLES]=3,re[ae.LINE_STRIP]=1,re)[p],Ae=0,De=q.get();Ae<De.length;Ae+=1){var Me=De[Ae],Le=Me.vaos||(Me.vaos={});(Le[I]||(Le[I]=new Bu)).bind(d,this,R,oe?oe.getPaintVertexBuffers():[],L,Me.vertexOffset,ne,de),ae.drawElements(p,Me.primitiveLength*be,ae.UNSIGNED_SHORT,Me.primitiveOffset*be*2)}}};var uf=function(d,p,h,g){var w=p.style.light,C=w.properties.get("position"),T=[C.x,C.y,C.z],I=v.create$1();"viewport"===w.properties.get("anchor")&&v.fromRotation(I,-p.transform.angle),v.transformMat3(T,T,I);var R=w.properties.get("color");return{u_matrix:d,u_lightpos:T,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+h,u_opacity:g}},Lw=function(d,p,h,g,w,C,T){return v.extend(uf(d,p,h,g),Lg(C,p,T),{u_height_factor:-Math.pow(2,w.overscaledZ)/T.tileSize/8})},tc=function(d){return{u_matrix:d}},_l=function(d,p,h,g){return v.extend(tc(d),Lg(h,p,g))},Vu=function(d,p){return{u_matrix:d,u_world:p}},Fg=function(d,p,h,g,w){return v.extend(_l(d,p,h,g),{u_world:w})},df=function(d,p,h,g){var w,C,T=d.transform;if("map"===g.paint.get("circle-pitch-alignment")){var I=is(h,1,T.zoom);w=!0,C=[I,I]}else w=!1,C=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+("map"===g.paint.get("circle-pitch-scale")),u_matrix:d.translatePosMatrix(p.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:v.browser.devicePixelRatio,u_extrude_scale:C}},hf=function(d,p,h){var g=is(h,1,p.zoom),w=Math.pow(2,p.zoom-h.tileID.overscaledZ),C=h.tileID.overscaleFactor();return{u_matrix:d,u_camera_to_center_distance:p.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[p.pixelsToGLUnits[0]/(g*w),p.pixelsToGLUnits[1]/(g*w)],u_overscale_factor:C}},Si=function(d,p,h){return{u_matrix:d,u_inv_matrix:p,u_camera_to_center_distance:h.cameraToCenterDistance,u_viewport_size:[h.width,h.height]}},ff=function(d,p,h){return void 0===h&&(h=1),{u_matrix:d,u_color:p,u_overlay:0,u_overlay_scale:h}},zu=function(d){return{u_matrix:d}},Ud=function(d,p,h,g){return{u_matrix:d,u_extrude_scale:is(p,1,h),u_intensity:g}},La=function(d,p,h){var g=d.transform;return{u_matrix:qc(d,p,h),u_ratio:1/is(p,1,g.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},jd=function(d,p,h,g){return v.extend(La(d,p,h),{u_image:0,u_image_height:g})},mr=function(d,p,h,g){var w=d.transform,C=Dt(p,w);return{u_matrix:qc(d,p,h),u_texsize:p.imageAtlasTexture.size,u_ratio:1/is(p,1,w.zoom),u_device_pixel_ratio:v.browser.devicePixelRatio,u_image:0,u_scale:[C,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},pf=function(d,p,h,g,w){var C=d.lineAtlas,T=Dt(p,d.transform),I="round"===h.layout.get("line-cap"),R=C.getDash(g.from,I),L=C.getDash(g.to,I),q=R.width*w.fromScale,W=L.width*w.toScale;return v.extend(La(d,p,h),{u_patternscale_a:[T/q,-R.height/2],u_patternscale_b:[T/W,-L.height/2],u_sdfgamma:C.width/(256*Math.min(q,W)*v.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:L.y,u_mix:w.t})};function Dt(d,p){return 1/is(d,1,p.tileZoom)}function qc(d,p,h){return d.translatePosMatrix(p.tileID.posMatrix,p,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}var X=function(d,p,h,g,w){return{u_matrix:d,u_tl_parent:p,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(T=w.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(C=w.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:Hd(w.paint.get("raster-hue-rotate"))};var C,T};function Hd(d){d*=Math.PI/180;var p=Math.sin(d),h=Math.cos(d);return[(2*h+1)/3,(-Math.sqrt(3)*p-h+1)/3,(Math.sqrt(3)*p-h+1)/3]}var $d,mf=function(d,p,h,g,w,C,T,I,R,L){var q=w.transform;return{u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:p?p.uSizeT:0,u_size:p?p.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:q.width/q.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:T,u_coord_matrix:I,u_is_text:+R,u_pitch_with_map:+g,u_texsize:L,u_texture:0}},Fa=function(d,p,h,g,w,C,T,I,R,L,q){var W=w.transform;return v.extend(mf(d,p,h,g,w,C,T,I,R,L),{u_gamma_scale:g?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:v.browser.devicePixelRatio,u_is_halo:+q})},gf=function(d,p,h,g,w,C,T,I,R,L){return v.extend(Fa(d,p,h,g,w,C,T,I,!0,R,!0),{u_texsize_icon:L,u_texture_icon:1})},Ba=function(d,p,h){return{u_matrix:d,u_opacity:p,u_color:h}},qd=function(d,p,h,g,w,C){return v.extend((I=C,L=w,q=(R=h).imageManager.getPattern((T=g).from.toString()),W=R.imageManager.getPattern(T.to.toString()),oe=(H=R.imageManager.getPixelSize()).width,ne=H.height,de=Math.pow(2,L.tileID.overscaledZ),ae=(re=L.tileSize*Math.pow(2,R.transform.tileZoom)/de)*(L.tileID.canonical.x+L.tileID.wrap*de),ge=re*L.tileID.canonical.y,{u_image:0,u_pattern_tl_a:q.tl,u_pattern_br_a:q.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[oe,ne],u_mix:I.t,u_pattern_size_a:q.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/is(L,1,R.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ge>>16],u_pixel_coord_lower:[65535&ae,65535&ge]}),{u_matrix:d,u_opacity:p});var T,I,R,L,q,W,H,oe,ne,de,re,ae,ge},mo={fillExtrusion:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_lightpos:new v.Uniform3f(d,p.u_lightpos),u_lightintensity:new v.Uniform1f(d,p.u_lightintensity),u_lightcolor:new v.Uniform3f(d,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,p.u_vertical_gradient),u_opacity:new v.Uniform1f(d,p.u_opacity)}},fillExtrusionPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_lightpos:new v.Uniform3f(d,p.u_lightpos),u_lightintensity:new v.Uniform1f(d,p.u_lightintensity),u_lightcolor:new v.Uniform3f(d,p.u_lightcolor),u_vertical_gradient:new v.Uniform1f(d,p.u_vertical_gradient),u_height_factor:new v.Uniform1f(d,p.u_height_factor),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade),u_opacity:new v.Uniform1f(d,p.u_opacity)}},fill:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},fillPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},fillOutline:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world)}},fillOutlinePattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world),u_image:new v.Uniform1i(d,p.u_image),u_texsize:new v.Uniform2f(d,p.u_texsize),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},circle:function(d,p){return{u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_scale_with_map:new v.Uniform1i(d,p.u_scale_with_map),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_extrude_scale:new v.Uniform2f(d,p.u_extrude_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},collisionBox:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pixels_to_tile_units:new v.Uniform1f(d,p.u_pixels_to_tile_units),u_extrude_scale:new v.Uniform2f(d,p.u_extrude_scale),u_overscale_factor:new v.Uniform1f(d,p.u_overscale_factor)}},collisionCircle:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_inv_matrix:new v.UniformMatrix4f(d,p.u_inv_matrix),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_viewport_size:new v.Uniform2f(d,p.u_viewport_size)}},debug:function(d,p){return{u_color:new v.UniformColor(d,p.u_color),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_overlay:new v.Uniform1i(d,p.u_overlay),u_overlay_scale:new v.Uniform1f(d,p.u_overlay_scale)}},clippingMask:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},heatmap:function(d,p){return{u_extrude_scale:new v.Uniform1f(d,p.u_extrude_scale),u_intensity:new v.Uniform1f(d,p.u_intensity),u_matrix:new v.UniformMatrix4f(d,p.u_matrix)}},heatmapTexture:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_world:new v.Uniform2f(d,p.u_world),u_image:new v.Uniform1i(d,p.u_image),u_color_ramp:new v.Uniform1i(d,p.u_color_ramp),u_opacity:new v.Uniform1f(d,p.u_opacity)}},hillshade:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_latrange:new v.Uniform2f(d,p.u_latrange),u_light:new v.Uniform2f(d,p.u_light),u_shadow:new v.UniformColor(d,p.u_shadow),u_highlight:new v.UniformColor(d,p.u_highlight),u_accent:new v.UniformColor(d,p.u_accent)}},hillshadePrepare:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_image:new v.Uniform1i(d,p.u_image),u_dimension:new v.Uniform2f(d,p.u_dimension),u_zoom:new v.Uniform1f(d,p.u_zoom),u_unpack:new v.Uniform4f(d,p.u_unpack)}},line:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels)}},lineGradient:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_image:new v.Uniform1i(d,p.u_image),u_image_height:new v.Uniform1f(d,p.u_image_height)}},linePattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_texsize:new v.Uniform2f(d,p.u_texsize),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_image:new v.Uniform1i(d,p.u_image),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_scale:new v.Uniform3f(d,p.u_scale),u_fade:new v.Uniform1f(d,p.u_fade)}},lineSDF:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_ratio:new v.Uniform1f(d,p.u_ratio),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_units_to_pixels:new v.Uniform2f(d,p.u_units_to_pixels),u_patternscale_a:new v.Uniform2f(d,p.u_patternscale_a),u_patternscale_b:new v.Uniform2f(d,p.u_patternscale_b),u_sdfgamma:new v.Uniform1f(d,p.u_sdfgamma),u_image:new v.Uniform1i(d,p.u_image),u_tex_y_a:new v.Uniform1f(d,p.u_tex_y_a),u_tex_y_b:new v.Uniform1f(d,p.u_tex_y_b),u_mix:new v.Uniform1f(d,p.u_mix)}},raster:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_tl_parent:new v.Uniform2f(d,p.u_tl_parent),u_scale_parent:new v.Uniform1f(d,p.u_scale_parent),u_buffer_scale:new v.Uniform1f(d,p.u_buffer_scale),u_fade_t:new v.Uniform1f(d,p.u_fade_t),u_opacity:new v.Uniform1f(d,p.u_opacity),u_image0:new v.Uniform1i(d,p.u_image0),u_image1:new v.Uniform1i(d,p.u_image1),u_brightness_low:new v.Uniform1f(d,p.u_brightness_low),u_brightness_high:new v.Uniform1f(d,p.u_brightness_high),u_saturation_factor:new v.Uniform1f(d,p.u_saturation_factor),u_contrast_factor:new v.Uniform1f(d,p.u_contrast_factor),u_spin_weights:new v.Uniform3f(d,p.u_spin_weights)}},symbolIcon:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texture:new v.Uniform1i(d,p.u_texture)}},symbolSDF:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texture:new v.Uniform1i(d,p.u_texture),u_gamma_scale:new v.Uniform1f(d,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,p.u_is_halo)}},symbolTextAndIcon:function(d,p){return{u_is_size_zoom_constant:new v.Uniform1i(d,p.u_is_size_zoom_constant),u_is_size_feature_constant:new v.Uniform1i(d,p.u_is_size_feature_constant),u_size_t:new v.Uniform1f(d,p.u_size_t),u_size:new v.Uniform1f(d,p.u_size),u_camera_to_center_distance:new v.Uniform1f(d,p.u_camera_to_center_distance),u_pitch:new v.Uniform1f(d,p.u_pitch),u_rotate_symbol:new v.Uniform1i(d,p.u_rotate_symbol),u_aspect_ratio:new v.Uniform1f(d,p.u_aspect_ratio),u_fade_change:new v.Uniform1f(d,p.u_fade_change),u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_label_plane_matrix:new v.UniformMatrix4f(d,p.u_label_plane_matrix),u_coord_matrix:new v.UniformMatrix4f(d,p.u_coord_matrix),u_is_text:new v.Uniform1i(d,p.u_is_text),u_pitch_with_map:new v.Uniform1i(d,p.u_pitch_with_map),u_texsize:new v.Uniform2f(d,p.u_texsize),u_texsize_icon:new v.Uniform2f(d,p.u_texsize_icon),u_texture:new v.Uniform1i(d,p.u_texture),u_texture_icon:new v.Uniform1i(d,p.u_texture_icon),u_gamma_scale:new v.Uniform1f(d,p.u_gamma_scale),u_device_pixel_ratio:new v.Uniform1f(d,p.u_device_pixel_ratio),u_is_halo:new v.Uniform1i(d,p.u_is_halo)}},background:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_opacity:new v.Uniform1f(d,p.u_opacity),u_color:new v.UniformColor(d,p.u_color)}},backgroundPattern:function(d,p){return{u_matrix:new v.UniformMatrix4f(d,p.u_matrix),u_opacity:new v.Uniform1f(d,p.u_opacity),u_image:new v.Uniform1i(d,p.u_image),u_pattern_tl_a:new v.Uniform2f(d,p.u_pattern_tl_a),u_pattern_br_a:new v.Uniform2f(d,p.u_pattern_br_a),u_pattern_tl_b:new v.Uniform2f(d,p.u_pattern_tl_b),u_pattern_br_b:new v.Uniform2f(d,p.u_pattern_br_b),u_texsize:new v.Uniform2f(d,p.u_texsize),u_mix:new v.Uniform1f(d,p.u_mix),u_pattern_size_a:new v.Uniform2f(d,p.u_pattern_size_a),u_pattern_size_b:new v.Uniform2f(d,p.u_pattern_size_b),u_scale_a:new v.Uniform1f(d,p.u_scale_a),u_scale_b:new v.Uniform1f(d,p.u_scale_b),u_pixel_coord_upper:new v.Uniform2f(d,p.u_pixel_coord_upper),u_pixel_coord_lower:new v.Uniform2f(d,p.u_pixel_coord_lower),u_tile_units_to_pixels:new v.Uniform1f(d,p.u_tile_units_to_pixels)}}};function nc(d,p,h,g,w,C,T){for(var I=d.context,R=I.gl,L=d.useProgram("collisionBox"),q=[],W=0,H=0,oe=0;oe<g.length;oe++){var ne=g[oe],de=p.getTile(ne),re=de.getBucket(h);if(re){var ae=ne.posMatrix;0===w[0]&&0===w[1]||(ae=d.translatePosMatrix(ne.posMatrix,de,w,C));var ge=T?re.textCollisionBox:re.iconCollisionBox,be=re.collisionCircleArray;if(be.length>0){var Ae=v.create(),De=ae;v.mul(Ae,re.placementInvProjMatrix,d.transform.glCoordMatrix),v.mul(Ae,Ae,re.placementViewportMatrix),q.push({circleArray:be,circleOffset:H,transform:De,invTransform:Ae}),H=W+=be.length/4}ge&&L.draw(I,R.LINES,K.disabled,ie.disabled,d.colorModeForRenderPass(),_e.disabled,hf(ae,d.transform,de),h.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,d.transform.zoom,null,null,ge.collisionVertexBuffer)}}if(T&&q.length){var Me=d.useProgram("collisionCircle"),Le=new v.StructArrayLayout2f1f2i16;Le.resize(4*W),Le._trim();for(var Qe=0,qe=0,at=q;qe<at.length;qe+=1)for(var Et=at[qe],It=0;It<Et.circleArray.length/4;It++){var St=4*It,pn=Et.circleArray[St+0],ut=Et.circleArray[St+1],Yt=Et.circleArray[St+2],dn=Et.circleArray[St+3];Le.emplace(Qe++,pn,ut,Yt,dn,0),Le.emplace(Qe++,pn,ut,Yt,dn,1),Le.emplace(Qe++,pn,ut,Yt,dn,2),Le.emplace(Qe++,pn,ut,Yt,dn,3)}(!$d||$d.length<2*W)&&($d=function($r){var lo=2*$r,yi=new v.StructArrayLayout3ui6;yi.resize(lo),yi._trim();for(var vi=0;vi<lo;vi++){var Jr=6*vi;yi.uint16[Jr+0]=4*vi+0,yi.uint16[Jr+1]=4*vi+1,yi.uint16[Jr+2]=4*vi+2,yi.uint16[Jr+3]=4*vi+2,yi.uint16[Jr+4]=4*vi+3,yi.uint16[Jr+5]=4*vi+0}return yi}(W));for(var et=I.createIndexBuffer($d,!0),zt=I.createVertexBuffer(Le,v.collisionCircleLayout.members,!0),$t=0,Ut=q;$t<Ut.length;$t+=1){var Rt=Ut[$t],rr=Si(Rt.transform,Rt.invTransform,d.transform);Me.draw(I,R.TRIANGLES,K.disabled,ie.disabled,d.colorModeForRenderPass(),_e.disabled,rr,h.id,zt,et,v.SegmentVector.simpleSegment(0,2*Rt.circleOffset,Rt.circleArray.length,Rt.circleArray.length/2),null,d.transform.zoom,null,null,null)}zt.destroy(),et.destroy()}}var Uu=v.identity(new Float32Array(16));function as(d,p,h,g,w,C){var T=v.getAnchorAlignment(d),I=-(T.horizontalAlign-.5)*p,R=-(T.verticalAlign-.5)*h,L=v.evaluateVariableOffset(d,g);return new v.Point((I/w+L[0])*C,(R/w+L[1])*C)}function Gd(d,p,h,g,w,C,T,I,R,L,q){var W=d.text.placedSymbolArray,H=d.text.dynamicLayoutVertexArray,oe=d.icon.dynamicLayoutVertexArray,ne={};H.clear();for(var de=0;de<W.length;de++){var re=W.get(de),ae=re.hidden||!re.crossTileID||d.allowVerticalPlacement&&!re.placedOrientation?null:g[re.crossTileID];if(ae){var ge=new v.Point(re.anchorX,re.anchorY),be=fn(ge,h?I:T),Ae=Bd(C.cameraToCenterDistance,be.signedDistanceFromCamera),De=w.evaluateSizeForFeature(d.textSizeData,L,re)*Ae/v.ONE_EM;h&&(De*=d.tilePixelRatio/R);for(var Me=as(ae.anchor,ae.width,ae.height,ae.textOffset,ae.textBoxScale,De),Le=h?fn(ge.add(Me),T).point:be.point.add(p?Me.rotate(-C.angle):Me),Qe=d.allowVerticalPlacement&&re.placedOrientation===v.WritingMode.vertical?Math.PI/2:0,qe=0;qe<re.numGlyphs;qe++)v.addDynamicAttributes(H,Le,Qe);q&&re.associatedIconIndex>=0&&(ne[re.associatedIconIndex]={shiftedAnchor:Le,angle:Qe})}else Oo(re.numGlyphs,H)}if(q){oe.clear();for(var at=d.icon.placedSymbolArray,Et=0;Et<at.length;Et++){var It=at.get(Et);if(It.hidden)Oo(It.numGlyphs,oe);else{var St=ne[Et];if(St)for(var pn=0;pn<It.numGlyphs;pn++)v.addDynamicAttributes(oe,St.shiftedAnchor,St.angle);else Oo(It.numGlyphs,oe)}}d.icon.dynamicLayoutVertexBuffer.updateData(oe)}d.text.dynamicLayoutVertexBuffer.updateData(H)}function Hp(d,p,h){return h.iconsInText&&p?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function _f(d,p,h,g,w,C,T,I,R,L,q,W){for(var H=d.context,oe=H.gl,ne=d.transform,de="map"===I,re="map"===R,ae=de&&"point"!==h.layout.get("symbol-placement"),ge=de&&!re&&!ae,be=!h.layout.get("symbol-sort-key").isConstant(),Ae=!1,De=d.depthModeForSublayer(0,K.ReadOnly),Me=h.layout.get("text-variable-anchor"),Le=[],Qe=0,qe=g;Qe<qe.length;Qe+=1){var at=qe[Qe],Et=p.getTile(at),It=Et.getBucket(h);if(It){var St=w?It.text:It.icon;if(St&&St.segments.get().length){var pn=St.programConfigurations.get(h.id),ut=w||It.sdfIcons,Yt=w?It.textSizeData:It.iconSizeData,dn=re||0!==ne.pitch,et=d.useProgram(Hp(ut,w,It),pn),zt=v.evaluateSizeForZoom(Yt,ne.zoom),$t=void 0,Ut=[0,0],Rt=void 0,rr=void 0,$r=null,lo=void 0;if(w)Rt=Et.glyphAtlasTexture,rr=oe.LINEAR,$t=Et.glyphAtlasTexture.size,It.iconsInText&&(Ut=Et.imageAtlasTexture.size,$r=Et.imageAtlasTexture,lo=dn||d.options.rotating||d.options.zooming||"composite"===Yt.kind||"camera"===Yt.kind?oe.LINEAR:oe.NEAREST);else{var yi=1!==h.layout.get("icon-size").constantOr(0)||It.iconsNeedLinear;Rt=Et.imageAtlasTexture,rr=ut||d.options.rotating||d.options.zooming||yi||dn?oe.LINEAR:oe.NEAREST,$t=Et.imageAtlasTexture.size}var vi=is(Et,1,d.transform.zoom),Jr=Fr(at.posMatrix,re,de,d.transform,vi),Fo=xn(at.posMatrix,re,de,d.transform,vi),ja=Me&&It.hasTextData(),bo="none"!==h.layout.get("icon-text-fit")&&ja&&It.hasIconData();ae&&Kn(It,at.posMatrix,d,w,Jr,Fo,re,L);var Pe=d.translatePosMatrix(at.posMatrix,Et,C,T),Ht=ae||w&&Me||bo?Uu:Jr,He=d.translatePosMatrix(Fo,Et,C,T,!0),Ze=ut&&0!==h.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1),Xt={program:et,buffers:St,uniformValues:ut?It.iconsInText?gf(Yt.kind,zt,ge,re,d,Pe,Ht,He,$t,Ut):Fa(Yt.kind,zt,ge,re,d,Pe,Ht,He,w,$t,!0):mf(Yt.kind,zt,ge,re,d,Pe,Ht,He,w,$t),atlasTexture:Rt,atlasTextureIcon:$r,atlasInterpolation:rr,atlasInterpolationIcon:lo,isSDF:ut,hasHalo:Ze};if(be&&It.canOverlap){Ae=!0;for(var Zc=0,la=St.segments.get();Zc<la.length;Zc+=1){var Ns=la[Zc];Le.push({segments:new v.SegmentVector([Ns]),sortKey:Ns.sortKey,state:Xt})}}else Le.push({segments:St.segments,sortKey:0,state:Xt})}}}Ae&&Le.sort(function(Ks,lc){return Ks.sortKey-lc.sortKey});for(var Yc=0,ca=Le;Yc<ca.length;Yc+=1){var Xc=ca[Yc],Ai=Xc.state;if(H.activeTexture.set(oe.TEXTURE0),Ai.atlasTexture.bind(Ai.atlasInterpolation,oe.CLAMP_TO_EDGE),Ai.atlasTextureIcon&&(H.activeTexture.set(oe.TEXTURE1),Ai.atlasTextureIcon&&Ai.atlasTextureIcon.bind(Ai.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),Ai.isSDF){var ac=Ai.uniformValues;Ai.hasHalo&&(ac.u_is_halo=1,Va(Ai.buffers,Xc.segments,h,d,Ai.program,De,q,W,ac)),ac.u_is_halo=0}Va(Ai.buffers,Xc.segments,h,d,Ai.program,De,q,W,Ai.uniformValues)}}function Va(d,p,h,g,w,C,T,I,R){var L=g.context;w.draw(L,L.gl.TRIANGLES,C,T,I,_e.disabled,R,h.id,d.layoutVertexBuffer,d.indexBuffer,p,h.paint,g.transform.zoom,d.programConfigurations.get(h.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Gc(d,p,h,g,w,C,T){var I,R,L,q,W,H=d.context.gl,oe=h.paint.get("fill-pattern"),ne=oe&&oe.constantOr(1),de=h.getCrossfadeParameters();T?(R=ne&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",I=H.LINES):(R=ne?"fillPattern":"fill",I=H.TRIANGLES);for(var re=0,ae=g;re<ae.length;re+=1){var ge=ae[re],be=p.getTile(ge);if(!ne||be.patternsLoaded()){var Ae=be.getBucket(h);if(Ae){var De=Ae.programConfigurations.get(h.id),Me=d.useProgram(R,De);ne&&(d.context.activeTexture.set(H.TEXTURE0),be.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),De.updatePaintBuffers(de));var Le=oe.constantOr(null);if(Le&&be.imageAtlas){var Qe=be.imageAtlas,qe=Qe.patternPositions[Le.to.toString()],at=Qe.patternPositions[Le.from.toString()];qe&&at&&De.setConstantPatternPositions(qe,at)}var Et=d.translatePosMatrix(ge.posMatrix,be,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(T){q=Ae.indexBuffer2,W=Ae.segments2;var It=[H.drawingBufferWidth,H.drawingBufferHeight];L="fillOutlinePattern"===R&&ne?Fg(Et,d,de,be,It):Vu(Et,It)}else q=Ae.indexBuffer,W=Ae.segments,L=ne?_l(Et,d,de,be):tc(Et);Me.draw(d.context,I,w,d.stencilModeForClipping(ge),C,_e.disabled,L,h.id,Ae.layoutVertexBuffer,q,W,h.paint,d.transform.zoom,De)}}}}function yl(d,p,h,g,w,C,T){for(var I=d.context,R=I.gl,L=h.paint.get("fill-extrusion-pattern"),q=L.constantOr(1),W=h.getCrossfadeParameters(),H=h.paint.get("fill-extrusion-opacity"),oe=0,ne=g;oe<ne.length;oe+=1){var de=ne[oe],re=p.getTile(de),ae=re.getBucket(h);if(ae){var ge=ae.programConfigurations.get(h.id),be=d.useProgram(q?"fillExtrusionPattern":"fillExtrusion",ge);q&&(d.context.activeTexture.set(R.TEXTURE0),re.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ge.updatePaintBuffers(W));var Ae=L.constantOr(null);if(Ae&&re.imageAtlas){var De=re.imageAtlas,Me=De.patternPositions[Ae.to.toString()],Le=De.patternPositions[Ae.from.toString()];Me&&Le&&ge.setConstantPatternPositions(Me,Le)}var Qe=d.translatePosMatrix(de.posMatrix,re,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),qe=h.paint.get("fill-extrusion-vertical-gradient"),at=q?Lw(Qe,d,qe,H,de,W,re):uf(Qe,d,qe,H);be.draw(I,I.gl.TRIANGLES,w,C,T,_e.backCCW,at,h.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,h.paint,d.transform.zoom,ge)}}}function nv(d,p,h,g,w,C){var T=d.context,I=T.gl,R=p.fbo;if(R){var L=d.useProgram("hillshade");T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get());var q=function(W,H,oe){var ne=oe.paint.get("hillshade-shadow-color"),de=oe.paint.get("hillshade-highlight-color"),re=oe.paint.get("hillshade-accent-color"),ae=oe.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===oe.paint.get("hillshade-illumination-anchor")&&(ae-=W.transform.angle);var ge,be,Ae,De=!W.options.moving;return{u_matrix:W.transform.calculatePosMatrix(H.tileID.toUnwrapped(),De),u_image:0,u_latrange:(ge=H.tileID,be=Math.pow(2,ge.canonical.z),Ae=ge.canonical.y,[new v.MercatorCoordinate(0,Ae/be).toLngLat().lat,new v.MercatorCoordinate(0,(Ae+1)/be).toLngLat().lat]),u_light:[oe.paint.get("hillshade-exaggeration"),ae],u_shadow:ne,u_highlight:de,u_accent:re}}(d,p,h);L.draw(T,I.TRIANGLES,g,w,C,_e.disabled,q,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}}function As(d,p,h,g,w,C){var de,re,ae,ge,T=d.context,I=T.gl,R=p.dem;if(R&&R.data){var L=R.dim,q=R.stride,W=R.getPixels();if(T.activeTexture.set(I.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),p.demTexture=p.demTexture||d.getTileTexture(q),p.demTexture){var H=p.demTexture;H.update(W,{premultiply:!1}),H.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else p.demTexture=new v.Texture(T,W,I.RGBA,{premultiply:!1}),p.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);T.activeTexture.set(I.TEXTURE0);var oe=p.fbo;if(!oe){var ne=new v.Texture(T,{width:L,height:L,data:null},I.RGBA);ne.bind(I.LINEAR,I.CLAMP_TO_EDGE),(oe=p.fbo=T.createFramebuffer(L,L,!0)).colorAttachment.set(ne.texture)}T.bindFramebuffer.set(oe.framebuffer),T.viewport.set([0,0,L,L]),d.useProgram("hillshadePrepare").draw(T,I.TRIANGLES,g,w,C,_e.disabled,(de=p.tileID,ae=(re=R).stride,ge=v.create(),v.ortho(ge,0,v.EXTENT,-v.EXTENT,0,0,1),v.translate(ge,ge,[0,-v.EXTENT,0]),{u_matrix:ge,u_image:1,u_dimension:[ae,ae],u_zoom:de.overscaledZ,u_unpack:re.getUnpackVector()}),h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments),p.needsHillshadePrepare=!1}}function Ar(d,p,h,g,w){var C=g.paint.get("raster-fade-duration");if(C>0){var T=v.browser.now(),I=(T-d.timeAdded)/C,R=p?(T-p.timeAdded)/C:-1,L=h.getSource(),q=w.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),W=!p||Math.abs(p.tileID.overscaledZ-q)>Math.abs(d.tileID.overscaledZ-q),H=W&&d.refreshedUponExpiration?1:v.clamp(W?I:1-R,0,1);return d.refreshedUponExpiration&&I>=1&&(d.refreshedUponExpiration=!1),p?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}var qs=new v.Color(1,0,0,1),yf=new v.Color(0,1,0,1),vf=new v.Color(0,0,1,1),Wd=new v.Color(1,0,1,1),za=new v.Color(0,1,1,1);function bf(d,p,h,g){Wc(d,0,p+h/2,d.transform.width,h,g)}function wf(d,p,h,g){Wc(d,p-h/2,0,h,d.transform.height,g)}function Wc(d,p,h,g,w,C){var T=d.context,I=T.gl;I.enable(I.SCISSOR_TEST),I.scissor(p*v.browser.devicePixelRatio,h*v.browser.devicePixelRatio,g*v.browser.devicePixelRatio,w*v.browser.devicePixelRatio),T.clear({color:C}),I.disable(I.SCISSOR_TEST)}function $p(d,p,h){var g=d.context,w=g.gl,C=h.posMatrix,T=d.useProgram("debug"),I=K.disabled,R=ie.disabled,L=d.colorModeForRenderPass();g.activeTexture.set(w.TEXTURE0),d.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T.draw(g,w.LINE_STRIP,I,R,L,_e.disabled,ff(C,v.Color.red),"$debug",d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments);var q=p.getTileByID(h.key).latestRawTileData,W=Math.floor((q&&q.byteLength||0)/1024),H=p.getTile(h).tileSize,oe=512/Math.min(H,512)*(h.overscaledZ/d.transform.zoom)*.5,ne=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(ne+=" => "+h.overscaledZ),function(de,re){de.initDebugOverlayCanvas();var ae=de.debugOverlayCanvas,ge=de.context.gl,be=de.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,ae.width,ae.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(re,5,5),be.strokeText(re,5,5),de.debugOverlayTexture.update(ae),de.debugOverlayTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE)}(d,ne+" "+W+"kb"),T.draw(g,w.TRIANGLES,I,R,me.alphaBlended,_e.disabled,ff(C,v.Color.transparent,oe),"$debug",d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments)}var ju={symbol:function(d,p,h,g,w){if("translucent"===d.renderPass){var C=ie.disabled,T=d.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,R,L,q,W,H,oe){for(var ne=R.transform,de="map"===W,re="map"===H,ae=0,ge=I;ae<ge.length;ae+=1){var be=ge[ae],Ae=q.getTile(be),De=Ae.getBucket(L);if(De&&De.text&&De.text.segments.get().length){var Me=v.evaluateSizeForZoom(De.textSizeData,ne.zoom),Le=is(Ae,1,R.transform.zoom),Qe=Fr(be.posMatrix,re,de,R.transform,Le),qe="none"!==L.layout.get("icon-text-fit")&&De.hasIconData();if(Me){var at=Math.pow(2,ne.zoom-Ae.tileID.overscaledZ);Gd(De,de,re,oe,v.symbolSize,ne,Qe,be.posMatrix,at,Me,qe)}}}}(g,d,h,p,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w),0!==h.paint.get("icon-opacity").constantOr(1)&&_f(d,p,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,T),0!==h.paint.get("text-opacity").constantOr(1)&&_f(d,p,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,T),p.map.showCollisionBoxes&&(nc(d,p,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),nc(d,p,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))}},circle:function(d,p,h,g){if("translucent"===d.renderPass){var w=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),T=h.paint.get("circle-stroke-opacity"),I=!h.layout.get("circle-sort-key").isConstant();if(0!==w.constantOr(1)||0!==C.constantOr(1)&&0!==T.constantOr(1)){for(var R=d.context,L=R.gl,q=d.depthModeForSublayer(0,K.ReadOnly),W=ie.disabled,H=d.colorModeForRenderPass(),oe=[],ne=0;ne<g.length;ne++){var de=g[ne],re=p.getTile(de),ae=re.getBucket(h);if(ae){var ge=ae.programConfigurations.get(h.id),be={programConfiguration:ge,program:d.useProgram("circle",ge),layoutVertexBuffer:ae.layoutVertexBuffer,indexBuffer:ae.indexBuffer,uniformValues:df(d,de,re,h)};if(I)for(var Ae=0,De=ae.segments.get();Ae<De.length;Ae+=1){var Me=De[Ae];oe.push({segments:new v.SegmentVector([Me]),sortKey:Me.sortKey,state:be})}else oe.push({segments:ae.segments,sortKey:0,state:be})}}I&&oe.sort(function(Et,It){return Et.sortKey-It.sortKey});for(var Le=0,Qe=oe;Le<Qe.length;Le+=1){var qe=Qe[Le],at=qe.state;at.program.draw(R,L.TRIANGLES,q,W,H,_e.disabled,at.uniformValues,h.id,at.layoutVertexBuffer,at.indexBuffer,qe.segments,h.paint,d.transform.zoom,at.programConfiguration)}}}},heatmap:function(d,p,h,g){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){var w=d.context,C=w.gl,T=ie.disabled,I=new me([C.ONE,C.ONE],v.Color.transparent,[!0,!0,!0,!0]);(function(oe,ne,de){var re=oe.gl;oe.activeTexture.set(re.TEXTURE1),oe.viewport.set([0,0,ne.width/4,ne.height/4]);var be,Ae,De,Me,Le,ae=de.heatmapFbo;if(ae)re.bindTexture(re.TEXTURE_2D,ae.colorAttachment.get()),oe.bindFramebuffer.set(ae.framebuffer);else{var ge=re.createTexture();re.bindTexture(re.TEXTURE_2D,ge),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.LINEAR),De=ge,Me=ae=de.heatmapFbo=oe.createFramebuffer(ne.width/4,ne.height/4,!1),(Le=(be=oe).gl).texImage2D(Le.TEXTURE_2D,0,Le.RGBA,(Ae=ne).width/4,Ae.height/4,0,Le.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:Le.UNSIGNED_BYTE,null),Me.colorAttachment.set(De)}})(w,d,h),w.clear({color:v.Color.transparent});for(var R=0;R<g.length;R++){var L=g[R];if(!p.hasRenderableParent(L)){var q=p.getTile(L),W=q.getBucket(h);if(W){var H=W.programConfigurations.get(h.id);d.useProgram("heatmap",H).draw(w,C.TRIANGLES,K.disabled,T,I,_e.disabled,Ud(L.posMatrix,q,d.transform.zoom,h.paint.get("heatmap-intensity")),h.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,h.paint,d.transform.zoom,H)}}}w.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(oe,ne){var de=oe.context,re=de.gl,ae=ne.heatmapFbo;if(ae){de.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,ae.colorAttachment.get()),de.activeTexture.set(re.TEXTURE1);var ge=ne.colorRampTexture;ge||(ge=ne.colorRampTexture=new v.Texture(de,ne.colorRamp,re.RGBA)),ge.bind(re.LINEAR,re.CLAMP_TO_EDGE),oe.useProgram("heatmapTexture").draw(de,re.TRIANGLES,K.disabled,ie.disabled,oe.colorModeForRenderPass(),_e.disabled,function(be,Ae){var Le=v.create();v.ortho(Le,0,be.width,be.height,0,0,1);var Qe=be.context.gl;return{u_matrix:Le,u_world:[Qe.drawingBufferWidth,Qe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ae.paint.get("heatmap-opacity")}}(oe,ne),ne.id,oe.viewportBuffer,oe.quadTriangleIndexBuffer,oe.viewportSegments,ne.paint,oe.transform.zoom)}}(d,h))},line:function(d,p,h,g){if("translucent"===d.renderPass){var w=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(0!==w.constantOr(1)&&0!==C.constantOr(1))for(var T=d.depthModeForSublayer(0,K.ReadOnly),I=d.colorModeForRenderPass(),R=h.paint.get("line-dasharray"),L=h.paint.get("line-pattern"),q=L.constantOr(1),W=h.paint.get("line-gradient"),H=h.getCrossfadeParameters(),oe=q?"linePattern":R?"lineSDF":W?"lineGradient":"line",ne=d.context,de=ne.gl,re=!0,ae=0,ge=g;ae<ge.length;ae+=1){var be=ge[ae],Ae=p.getTile(be);if(!q||Ae.patternsLoaded()){var De=Ae.getBucket(h);if(De){var Me=De.programConfigurations.get(h.id),Le=d.context.program.get(),Qe=d.useProgram(oe,Me),qe=re||Qe.program!==Le,at=L.constantOr(null);if(at&&Ae.imageAtlas){var Et=Ae.imageAtlas,It=Et.patternPositions[at.to.toString()],St=Et.patternPositions[at.from.toString()];It&&St&&Me.setConstantPatternPositions(It,St)}var pn=q?mr(d,Ae,h,H):R?pf(d,Ae,h,R,H):W?jd(d,Ae,h,De.lineClipsArray.length):La(d,Ae,h);if(q)ne.activeTexture.set(de.TEXTURE0),Ae.imageAtlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Me.updatePaintBuffers(H);else if(R&&(qe||d.lineAtlas.dirty))ne.activeTexture.set(de.TEXTURE0),d.lineAtlas.bind(ne);else if(W){var ut=De.gradients[h.id],Yt=ut.texture;if(h.gradientVersion!==ut.version){var dn=256;if(h.stepInterpolant){var et=p.getSource().maxzoom,zt=be.canonical.z===et?Math.ceil(1<<d.transform.maxZoom-be.canonical.z):1;dn=v.clamp(v.nextPowerOfTwo(De.maxLineLength/v.EXTENT*1024*zt),256,ne.maxTextureSize)}ut.gradient=v.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:dn,image:ut.gradient||void 0,clips:De.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new v.Texture(ne,ut.gradient,de.RGBA),ut.version=h.gradientVersion,Yt=ut.texture}ne.activeTexture.set(de.TEXTURE0),Yt.bind(h.stepInterpolant?de.NEAREST:de.LINEAR,de.CLAMP_TO_EDGE)}Qe.draw(ne,de.TRIANGLES,T,d.stencilModeForClipping(be),I,_e.disabled,pn,h.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,h.paint,d.transform.zoom,Me,De.layoutVertexBuffer2),re=!1}}}}},fill:function(d,p,h,g){var w=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(0!==C.constantOr(1)){var T=d.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),R=d.opaquePassEnabledForLayer()&&!I.constantOr(1)&&1===w.constantOr(v.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(d.renderPass===R){var L=d.depthModeForSublayer(1,"opaque"===d.renderPass?K.ReadWrite:K.ReadOnly);Gc(d,p,h,g,L,T,!1)}if("translucent"===d.renderPass&&h.paint.get("fill-antialias")){var q=d.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);Gc(d,p,h,g,q,T,!0)}}},"fill-extrusion":function(d,p,h,g){var w=h.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===d.renderPass){var C=new K(d.context.gl.LEQUAL,K.ReadWrite,d.depthRangeFor3D);if(1!==w||h.paint.get("fill-extrusion-pattern").constantOr(1))yl(d,p,h,g,C,ie.disabled,me.disabled),yl(d,p,h,g,C,d.stencilModeFor3D(),d.colorModeForRenderPass());else{var T=d.colorModeForRenderPass();yl(d,p,h,g,C,ie.disabled,T)}}},hillshade:function(d,p,h,g){if("offscreen"===d.renderPass||"translucent"===d.renderPass){for(var w=d.context,C=d.depthModeForSublayer(0,K.ReadOnly),T=d.colorModeForRenderPass(),I="translucent"===d.renderPass?d.stencilConfigForOverlap(g):[{},g],R=I[0],L=0,q=I[1];L<q.length;L+=1){var W=q[L],H=p.getTile(W);H.needsHillshadePrepare&&"offscreen"===d.renderPass?As(d,H,h,C,ie.disabled,T):"translucent"===d.renderPass&&nv(d,H,h,C,R[W.overscaledZ],T)}w.viewport.set([0,0,d.width,d.height])}},raster:function(d,p,h,g){if("translucent"===d.renderPass&&0!==h.paint.get("raster-opacity")&&g.length)for(var w=d.context,C=w.gl,T=p.getSource(),I=d.useProgram("raster"),R=d.colorModeForRenderPass(),L=T instanceof Sa?[{},g]:d.stencilConfigForOverlap(g),q=L[0],W=L[1],H=W[W.length-1].overscaledZ,oe=!d.options.moving,ne=0,de=W;ne<de.length;ne+=1){var re=de[ne],ae=d.depthModeForSublayer(re.overscaledZ-H,1===h.paint.get("raster-opacity")?K.ReadWrite:K.ReadOnly,C.LESS),ge=p.getTile(re),be=d.transform.calculatePosMatrix(re.toUnwrapped(),oe);ge.registerFadeDuration(h.paint.get("raster-fade-duration"));var Ae=p.findLoadedParent(re,0),De=Ar(ge,Ae,p,h,d.transform),Me=void 0,Le=void 0,Qe="nearest"===h.paint.get("raster-resampling")?C.NEAREST:C.LINEAR;w.activeTexture.set(C.TEXTURE0),ge.texture.bind(Qe,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(C.TEXTURE1),Ae?(Ae.texture.bind(Qe,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,Ae.tileID.overscaledZ-ge.tileID.overscaledZ),Le=[ge.tileID.canonical.x*Me%1,ge.tileID.canonical.y*Me%1]):ge.texture.bind(Qe,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST);var qe=X(be,Le||[0,0],Me||1,De,h);T instanceof Sa?I.draw(w,C.TRIANGLES,ae,ie.disabled,R,_e.disabled,qe,h.id,T.boundsBuffer,d.quadTriangleIndexBuffer,T.boundsSegments):I.draw(w,C.TRIANGLES,ae,q[re.overscaledZ],R,_e.disabled,qe,h.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments)}},background:function(d,p,h){var g=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(0!==w){var C=d.context,T=C.gl,I=d.transform,R=I.tileSize,L=h.paint.get("background-pattern");if(!d.isPatternMissing(L)){var q=!L&&1===g.a&&1===w&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass===q){var W=ie.disabled,H=d.depthModeForSublayer(0,"opaque"===q?K.ReadWrite:K.ReadOnly),oe=d.colorModeForRenderPass(),ne=d.useProgram(L?"backgroundPattern":"background"),de=I.coveringTiles({tileSize:R});L&&(C.activeTexture.set(T.TEXTURE0),d.imageManager.bind(d.context));for(var re=h.getCrossfadeParameters(),ae=0,ge=de;ae<ge.length;ae+=1){var be=ge[ae],Ae=d.transform.calculatePosMatrix(be.toUnwrapped()),De=L?qd(Ae,w,d,L,{tileID:be,tileSize:R},re):Ba(Ae,w,g);ne.draw(C,T.TRIANGLES,H,W,oe,_e.disabled,De,h.id,d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}}}},debug:function(d,p,h){for(var g=0;g<h.length;g++)$p(d,p,h[g])},custom:function(d,p,h){var g=d.context,w=h.implementation;if("offscreen"===d.renderPass){var C=w.prerender;C&&(d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),C.call(w,g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState())}else if("translucent"===d.renderPass){d.setCustomLayerDefaults(),g.setColorMode(d.colorModeForRenderPass()),g.setStencilMode(ie.disabled);var T="3d"===w.renderingMode?new K(d.context.gl.LEQUAL,K.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,K.ReadOnly);g.setDepthMode(T),w.render(g.gl,d.transform.customLayerMatrix()),g.setDirty(),d.setBaseState(),g.bindFramebuffer.set(null)}}},dr=function(d,p){this.context=new J(d),this.transform=p,this._tileTextures={},this.setup(),this.numSublayers=Z.maxUnderzooming+Z.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Is,this.gpuTimers={}};dr.prototype.resize=function(d,p){if(this.width=d*v.browser.devicePixelRatio,this.height=p*v.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var h=0,g=this.style._order;h<g.length;h+=1)this.style._layers[g[h]].resize()},dr.prototype.setup=function(){var d=this.context,p=new v.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(v.EXTENT,0),p.emplaceBack(0,v.EXTENT),p.emplaceBack(v.EXTENT,v.EXTENT),this.tileExtentBuffer=d.createVertexBuffer(p,Pa.members),this.tileExtentSegments=v.SegmentVector.simpleSegment(0,0,4,2);var h=new v.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(v.EXTENT,0),h.emplaceBack(0,v.EXTENT),h.emplaceBack(v.EXTENT,v.EXTENT),this.debugBuffer=d.createVertexBuffer(h,Pa.members),this.debugSegments=v.SegmentVector.simpleSegment(0,0,4,5);var g=new v.StructArrayLayout4i8;g.emplaceBack(0,0,0,0),g.emplaceBack(v.EXTENT,0,v.EXTENT,0),g.emplaceBack(0,v.EXTENT,0,v.EXTENT),g.emplaceBack(v.EXTENT,v.EXTENT,v.EXTENT,v.EXTENT),this.rasterBoundsBuffer=d.createVertexBuffer(g,no.members),this.rasterBoundsSegments=v.SegmentVector.simpleSegment(0,0,4,2);var w=new v.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=d.createVertexBuffer(w,Pa.members),this.viewportSegments=v.SegmentVector.simpleSegment(0,0,4,2);var C=new v.StructArrayLayout1ui2;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=d.createIndexBuffer(C);var T=new v.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=d.createIndexBuffer(T),this.emptyTexture=new v.Texture(d,{width:1,height:1,data:new Uint8Array([0,0,0,0])},d.gl.RGBA);var I=this.context.gl;this.stencilClearMode=new ie({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)},dr.prototype.clearStencil=function(){var d=this.context,p=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var h=v.create();v.ortho(h,0,this.width,this.height,0,0,1),v.scale(h,h,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,p.TRIANGLES,K.disabled,this.stencilClearMode,me.disabled,_e.disabled,zu(h),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},dr.prototype._renderTileClippingMasks=function(d,p){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&p&&p.length){this.currentStencilSource=d.source;var h=this.context,g=h.gl;this.nextStencilID+p.length>256&&this.clearStencil(),h.setColorMode(me.disabled),h.setDepthMode(K.disabled);var w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var C=0,T=p;C<T.length;C+=1){var I=T[C],R=this._tileClippingMaskIDs[I.key]=this.nextStencilID++;w.draw(h,g.TRIANGLES,K.disabled,new ie({func:g.ALWAYS,mask:0},R,255,g.KEEP,g.KEEP,g.REPLACE),me.disabled,_e.disabled,zu(I.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},dr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var d=this.nextStencilID++,p=this.context.gl;return new ie({func:p.NOTEQUAL,mask:255},d,255,p.KEEP,p.KEEP,p.REPLACE)},dr.prototype.stencilModeForClipping=function(d){var p=this.context.gl;return new ie({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,p.KEEP,p.KEEP,p.REPLACE)},dr.prototype.stencilConfigForOverlap=function(d){var p,h=this.context.gl,g=d.sort(function(R,L){return L.overscaledZ-R.overscaledZ}),w=g[g.length-1].overscaledZ,C=g[0].overscaledZ-w+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();for(var T={},I=0;I<C;I++)T[I+w]=new ie({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=C,[T,g]}return[(p={},p[w]=ie.disabled,p),g]},dr.prototype.colorModeForRenderPass=function(){var d=this.context.gl;return this._showOverdrawInspector?new me([d.CONSTANT_COLOR,d.ONE],new v.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?me.unblended:me.alphaBlended},dr.prototype.depthModeForSublayer=function(d,p,h){if(!this.opaquePassEnabledForLayer())return K.disabled;var g=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon;return new K(h||this.context.gl.LEQUAL,p,[g,g])},dr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},dr.prototype.render=function(d,p){var h=this;this.style=d,this.options=p,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(v.browser.now()),this.imageManager.beginFrame();var g=this.style._order,w=this.style.sourceCaches;for(var C in w){var T=w[C];T.used&&T.prepare(this.context)}var I,R,L={},q={},W={};for(var H in w){var oe=w[H];L[H]=oe.getVisibleCoordinates(),q[H]=L[H].slice().reverse(),W[H]=oe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ne=0;ne<g.length;ne++)if(this.style._layers[g[ne]].is3D()){this.opaquePassCutoff=ne;break}this.renderPass="offscreen";for(var de=0,re=g;de<re.length;de+=1){var ae=this.style._layers[re[de]];if(ae.hasOffscreenPass()&&!ae.isHidden(this.transform.zoom)){var ge=q[ae.source];("custom"===ae.type||ge.length)&&this.renderLayer(this,w[ae.source],ae,ge)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?v.Color.black:v.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){var be=this.style._layers[g[this.currentLayer]],Ae=w[be.source],De=L[be.source];this._renderTileClippingMasks(be,De),this.renderLayer(this,Ae,be,De)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){var Me=this.style._layers[g[this.currentLayer]],Le=w[Me.source],Qe=("symbol"===Me.type?W:q)[Me.source];this._renderTileClippingMasks(Me,L[Me.source]),this.renderLayer(this,Le,Me,Qe)}this.options.showTileBoundaries&&(v.values(this.style._layers).forEach(function(qe){qe.source&&!qe.isHidden(h.transform.zoom)&&(qe.source!==(R&&R.id)&&(R=h.style.sourceCaches[qe.source]),(!I||I.getSource().maxzoom<R.getSource().maxzoom)&&(I=R))}),I&&ju.debug(this,I,I.getVisibleCoordinates())),this.options.showPadding&&function(qe){var at=qe.transform.padding;bf(qe,qe.transform.height-(at.top||0),3,qs),bf(qe,at.bottom||0,3,yf),wf(qe,at.left||0,3,vf),wf(qe,qe.transform.width-(at.right||0),3,Wd);var It,St,pn,ut,Et=qe.transform.centerPoint;Wc(It=qe,(St=Et.x)-1,(pn=qe.transform.height-Et.y)-10,2,20,ut=za),Wc(It,St-10,pn-1,20,2,ut)}(this),this.context.setDefault()},dr.prototype.renderLayer=function(d,p,h,g){h.isHidden(this.transform.zoom)||("background"===h.type||"custom"===h.type||g.length)&&(this.id=h.id,this.gpuTimingStart(h),ju[h.type](d,p,h,g,this.style.placement.variableOffsets),this.gpuTimingEnd())},dr.prototype.gpuTimingStart=function(d){if(this.options.gpuTiming){var p=this.context.extTimerQuery,h=this.gpuTimers[d.id];h||(h=this.gpuTimers[d.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),h.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,h.query)}},dr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var d=this.context.extTimerQuery;d.endQueryEXT(d.TIME_ELAPSED_EXT)}},dr.prototype.collectGpuTimers=function(){var d=this.gpuTimers;return this.gpuTimers={},d},dr.prototype.queryGpuTimers=function(d){var p={};for(var h in d){var g=d[h],w=this.context.extTimerQuery,C=w.getQueryObjectEXT(g.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(g.query),p[h]=C}return p},dr.prototype.translatePosMatrix=function(d,p,h,g,w){if(!h[0]&&!h[1])return d;var C=w?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(C){var T=Math.sin(C),I=Math.cos(C);h=[h[0]*I-h[1]*T,h[0]*T+h[1]*I]}var R=[w?h[0]:is(p,h[0],this.transform.zoom),w?h[1]:is(p,h[1],this.transform.zoom),0],L=new Float32Array(16);return v.translate(L,d,R),L},dr.prototype.saveTileTexture=function(d){var p=this._tileTextures[d.size[0]];p?p.push(d):this._tileTextures[d.size[0]]=[d]},dr.prototype.getTileTexture=function(d){var p=this._tileTextures[d];return p&&p.length>0?p.pop():null},dr.prototype.isPatternMissing=function(d){if(!d)return!1;if(!d.from||!d.to)return!0;var p=this.imageManager.getPattern(d.from.toString()),h=this.imageManager.getPattern(d.to.toString());return!p||!h},dr.prototype.useProgram=function(d,p){this.cache=this.cache||{};var h=""+d+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[h]||(this.cache[h]=new tv(this.context,d,Oa[d],p,mo[d],this._showOverdrawInspector)),this.cache[h]},dr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},dr.prototype.setBaseState=function(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)},dr.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=v.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},dr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Hu=function(d,p){this.points=d,this.planes=p};Hu.fromInvProjectionMatrix=function(d,p,h){var g=Math.pow(2,h),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(T){return v.transformMat4([],T,d)}).map(function(T){return v.scale$1([],T,1/T[3]/p*g)}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(T){var I=v.sub([],w[T[0]],w[T[1]]),R=v.sub([],w[T[2]],w[T[1]]),L=v.normalize([],v.cross([],I,R)),q=-v.dot(L,w[T[1]]);return L.concat(q)});return new Hu(w,C)};var Kc=function(d,p){this.min=d,this.max=p,this.center=v.scale$2([],v.add([],this.min,this.max),.5)};Kc.prototype.quadrant=function(d){for(var p=[d%2==0,d<2],h=v.clone$2(this.min),g=v.clone$2(this.max),w=0;w<p.length;w++)h[w]=p[w]?this.min[w]:this.center[w],g[w]=p[w]?this.center[w]:this.max[w];return g[2]=this.max[2],new Kc(h,g)},Kc.prototype.distanceX=function(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]},Kc.prototype.distanceY=function(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]},Kc.prototype.intersects=function(d){for(var p=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],h=!0,g=0;g<d.planes.length;g++){for(var w=d.planes[g],C=0,T=0;T<p.length;T++)C+=v.dot$1(w,p[T])>=0;if(0===C)return 0;C!==p.length&&(h=!1)}if(h)return 2;for(var I=0;I<3;I++){for(var R=Number.MAX_VALUE,L=-Number.MAX_VALUE,q=0;q<d.points.length;q++){var W=d.points[q][I]-this.min[I];R=Math.min(R,W),L=Math.max(L,W)}if(L<0||R>this.max[I]-this.min[I])return 0}return 1};var Ua=function(d,p,h,g){if(void 0===d&&(d=0),void 0===p&&(p=0),void 0===h&&(h=0),void 0===g&&(g=0),isNaN(d)||d<0||isNaN(p)||p<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=p,this.left=h,this.right=g};Ua.prototype.interpolate=function(d,p,h){return null!=p.top&&null!=d.top&&(this.top=v.number(d.top,p.top,h)),null!=p.bottom&&null!=d.bottom&&(this.bottom=v.number(d.bottom,p.bottom,h)),null!=p.left&&null!=d.left&&(this.left=v.number(d.left,p.left,h)),null!=p.right&&null!=d.right&&(this.right=v.number(d.right,p.right,h)),this},Ua.prototype.getCenter=function(d,p){var h=v.clamp((this.left+d-this.right)/2,0,d),g=v.clamp((this.top+p-this.bottom)/2,0,p);return new v.Point(h,g)},Ua.prototype.equals=function(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right},Ua.prototype.clone=function(){return new Ua(this.top,this.bottom,this.left,this.right)},Ua.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Zn=function(d,p,h,g,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===w||w,this._minZoom=d||0,this._maxZoom=p||22,this._minPitch=h??0,this._maxPitch=g??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new v.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ua,this._posMatrixCache={},this._alignedPosMatrixCache={}},Sn={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Zn.prototype.clone=function(){var d=new Zn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.tileSize=this.tileSize,d.latRange=this.latRange,d.width=this.width,d.height=this.height,d._center=this._center,d.zoom=this.zoom,d.angle=this.angle,d._fov=this._fov,d._pitch=this._pitch,d._unmodified=this._unmodified,d._edgeInsets=this._edgeInsets.clone(),d._calcMatrices(),d},Sn.minZoom.get=function(){return this._minZoom},Sn.minZoom.set=function(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))},Sn.maxZoom.get=function(){return this._maxZoom},Sn.maxZoom.set=function(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))},Sn.minPitch.get=function(){return this._minPitch},Sn.minPitch.set=function(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))},Sn.maxPitch.get=function(){return this._maxPitch},Sn.maxPitch.set=function(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))},Sn.renderWorldCopies.get=function(){return this._renderWorldCopies},Sn.renderWorldCopies.set=function(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d},Sn.worldSize.get=function(){return this.tileSize*this.scale},Sn.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Sn.size.get=function(){return new v.Point(this.width,this.height)},Sn.bearing.get=function(){return-this.angle/Math.PI*180},Sn.bearing.set=function(d){var p=-v.wrap(d,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=v.create$2(),v.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Sn.pitch.get=function(){return this._pitch/Math.PI*180},Sn.pitch.set=function(d){var p=v.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())},Sn.fov.get=function(){return this._fov/Math.PI*180},Sn.fov.set=function(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())},Sn.zoom.get=function(){return this._zoom},Sn.zoom.set=function(d){var p=Math.min(Math.max(d,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.scale=this.zoomScale(p),this.tileZoom=Math.floor(p),this.zoomFraction=p-this.tileZoom,this._constrain(),this._calcMatrices())},Sn.center.get=function(){return this._center},Sn.center.set=function(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())},Sn.padding.get=function(){return this._edgeInsets.toJSON()},Sn.padding.set=function(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())},Sn.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Zn.prototype.isPaddingEqual=function(d){return this._edgeInsets.equals(d)},Zn.prototype.interpolatePadding=function(d,p,h){this._unmodified=!1,this._edgeInsets.interpolate(d,p,h),this._constrain(),this._calcMatrices()},Zn.prototype.coveringZoomLevel=function(d){var p=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize));return Math.max(0,p)},Zn.prototype.getVisibleUnwrappedCoordinates=function(d){var p=[new v.UnwrappedTileID(0,d)];if(this._renderWorldCopies)for(var h=this.pointCoordinate(new v.Point(0,0)),g=this.pointCoordinate(new v.Point(this.width,0)),w=this.pointCoordinate(new v.Point(this.width,this.height)),C=this.pointCoordinate(new v.Point(0,this.height)),T=Math.floor(Math.min(h.x,g.x,w.x,C.x)),I=Math.floor(Math.max(h.x,g.x,w.x,C.x)),R=T-1;R<=I+1;R++)0!==R&&p.push(new v.UnwrappedTileID(R,d));return p},Zn.prototype.coveringTiles=function(d){var p=this.coveringZoomLevel(d),h=p;if(void 0!==d.minzoom&&p<d.minzoom)return[];void 0!==d.maxzoom&&p>d.maxzoom&&(p=d.maxzoom);var g=v.MercatorCoordinate.fromLngLat(this.center),w=Math.pow(2,p),C=[w*g.x,w*g.y,0],T=Hu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p),I=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(I=p);var R=function(qe){return{aabb:new Kc([qe*w,0,0],[(qe+1)*w,w,0]),zoom:0,x:0,y:0,wrap:qe,fullyVisible:!1}},L=[],q=[],W=p,H=d.reparseOverscaled?h:p;if(this._renderWorldCopies)for(var oe=1;oe<=3;oe++)L.push(R(-oe)),L.push(R(oe));for(L.push(R(0));L.length>0;){var ne=L.pop(),de=ne.x,re=ne.y,ae=ne.fullyVisible;if(!ae){var ge=ne.aabb.intersects(T);if(0===ge)continue;ae=2===ge}var be=ne.aabb.distanceX(C),Ae=ne.aabb.distanceY(C),De=Math.max(Math.abs(be),Math.abs(Ae));if(ne.zoom===W||De>3+(1<<W-ne.zoom)-2&&ne.zoom>=I)q.push({tileID:new v.OverscaledTileID(ne.zoom===W?H:ne.zoom,ne.wrap,ne.zoom,de,re),distanceSq:v.sqrLen([C[0]-.5-de,C[1]-.5-re])});else for(var Me=0;Me<4;Me++){var Le=(de<<1)+Me%2,Qe=(re<<1)+(Me>>1);L.push({aabb:ne.aabb.quadrant(Me),zoom:ne.zoom+1,x:Le,y:Qe,wrap:ne.wrap,fullyVisible:ae})}}return q.sort(function(qe,at){return qe.distanceSq-at.distanceSq}).map(function(qe){return qe.tileID})},Zn.prototype.resize=function(d,p){this.width=d,this.height=p,this.pixelsToGLUnits=[2/d,-2/p],this._constrain(),this._calcMatrices()},Sn.unmodified.get=function(){return this._unmodified},Zn.prototype.zoomScale=function(d){return Math.pow(2,d)},Zn.prototype.scaleZoom=function(d){return Math.log(d)/Math.LN2},Zn.prototype.project=function(d){var p=v.clamp(d.lat,-this.maxValidLatitude,this.maxValidLatitude);return new v.Point(v.mercatorXfromLng(d.lng)*this.worldSize,v.mercatorYfromLat(p)*this.worldSize)},Zn.prototype.unproject=function(d){return new v.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()},Sn.point.get=function(){return this.project(this.center)},Zn.prototype.setLocationAtPoint=function(d,p){var h=this.pointCoordinate(p),g=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(d),C=new v.MercatorCoordinate(w.x-(h.x-g.x),w.y-(h.y-g.y));this.center=this.coordinateLocation(C),this._renderWorldCopies&&(this.center=this.center.wrap())},Zn.prototype.locationPoint=function(d){return this.coordinatePoint(this.locationCoordinate(d))},Zn.prototype.pointLocation=function(d){return this.coordinateLocation(this.pointCoordinate(d))},Zn.prototype.locationCoordinate=function(d){return v.MercatorCoordinate.fromLngLat(d)},Zn.prototype.coordinateLocation=function(d){return d.toLngLat()},Zn.prototype.pointCoordinate=function(d){var p=[d.x,d.y,0,1],h=[d.x,d.y,1,1];v.transformMat4(p,p,this.pixelMatrixInverse),v.transformMat4(h,h,this.pixelMatrixInverse);var g=p[3],w=h[3],C=p[1]/g,T=h[1]/w,I=p[2]/g,R=h[2]/w,L=I===R?0:(0-I)/(R-I);return new v.MercatorCoordinate(v.number(p[0]/g,h[0]/w,L)/this.worldSize,v.number(C,T,L)/this.worldSize)},Zn.prototype.coordinatePoint=function(d){var p=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix),new v.Point(p[0]/p[3],p[1]/p[3])},Zn.prototype.getBounds=function(){return(new v.LngLatBounds).extend(this.pointLocation(new v.Point(0,0))).extend(this.pointLocation(new v.Point(this.width,0))).extend(this.pointLocation(new v.Point(this.width,this.height))).extend(this.pointLocation(new v.Point(0,this.height)))},Zn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new v.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Zn.prototype.setMaxBounds=function(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Zn.prototype.calculatePosMatrix=function(d,p){void 0===p&&(p=!1);var h=d.key,g=p?this._alignedPosMatrixCache:this._posMatrixCache;if(g[h])return g[h];var w=d.canonical,C=this.worldSize/this.zoomScale(w.z),T=w.x+Math.pow(2,w.z)*d.wrap,I=v.identity(new Float64Array(16));return v.translate(I,I,[T*C,w.y*C,0]),v.scale(I,I,[C/v.EXTENT,C/v.EXTENT,1]),v.multiply(I,p?this.alignedProjMatrix:this.projMatrix,I),g[h]=new Float32Array(I),g[h]},Zn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Zn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var d,p,h,g,w=-90,C=90,T=-180,I=180,R=this.size,L=this._unmodified;if(this.latRange){var q=this.latRange;w=v.mercatorYfromLat(q[1])*this.worldSize,d=(C=v.mercatorYfromLat(q[0])*this.worldSize)-w<R.y?R.y/(C-w):0}if(this.lngRange){var W=this.lngRange;T=v.mercatorXfromLng(W[0])*this.worldSize,p=(I=v.mercatorXfromLng(W[1])*this.worldSize)-T<R.x?R.x/(I-T):0}var H=this.point,oe=Math.max(p||0,d||0);if(oe)return this.center=this.unproject(new v.Point(p?(I+T)/2:H.x,d?(C+w)/2:H.y)),this.zoom+=this.scaleZoom(oe),this._unmodified=L,void(this._constraining=!1);if(this.latRange){var ne=H.y,de=R.y/2;ne-de<w&&(g=w+de),ne+de>C&&(g=C-de)}if(this.lngRange){var re=H.x,ae=R.x/2;re-ae<T&&(h=T+ae),re+ae>I&&(h=I-ae)}void 0===h&&void 0===g||(this.center=this.unproject(new v.Point(void 0!==h?h:H.x,void 0!==g?g:H.y))),this._unmodified=L,this._constraining=!1}},Zn.prototype._calcMatrices=function(){if(this.height){var d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var p=Math.PI/2+this._pitch,h=this._fov*(.5+d.y/this.height),g=Math.sin(h)*this.cameraToCenterDistance/Math.sin(v.clamp(Math.PI-p-h,.01,Math.PI-.01)),w=this.point,C=w.x,T=w.y,I=1.01*(Math.cos(Math.PI/2-this._pitch)*g+this.cameraToCenterDistance),R=this.height/50,L=new Float64Array(16);v.perspective(L,this._fov,this.width/this.height,R,I),L[8]=2*-d.x/this.width,L[9]=2*d.y/this.height,v.scale(L,L,[1,-1,1]),v.translate(L,L,[0,0,-this.cameraToCenterDistance]),v.rotateX(L,L,this._pitch),v.rotateZ(L,L,this.angle),v.translate(L,L,[-C,-T,0]),this.mercatorMatrix=v.scale([],L,[this.worldSize,this.worldSize,this.worldSize]),v.scale(L,L,[1,1,v.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=L,this.invProjMatrix=v.invert([],this.projMatrix);var q=this.width%2/2,W=this.height%2/2,H=Math.cos(this.angle),oe=Math.sin(this.angle),ne=C-Math.round(C)+H*q+oe*W,de=T-Math.round(T)+H*W+oe*q,re=new Float64Array(L);if(v.translate(re,re,[ne>.5?ne-1:ne,de>.5?de-1:de,0]),this.alignedProjMatrix=re,L=v.create(),v.scale(L,L,[this.width/2,-this.height/2,1]),v.translate(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=v.create(),v.scale(L,L,[1,-1,1]),v.translate(L,L,[-1,-1,0]),v.scale(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=v.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(L=v.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=L,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Zn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var d=this.pointCoordinate(new v.Point(0,0)),p=[d.x*this.worldSize,d.y*this.worldSize,0,1];return v.transformMat4(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance},Zn.prototype.getCameraPoint=function(){var d=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new v.Point(0,d))},Zn.prototype.getCameraQueryGeometry=function(d){var p=this.getCameraPoint();if(1===d.length)return[d[0],p];for(var h=p.x,g=p.y,w=p.x,C=p.y,T=0,I=d;T<I.length;T+=1){var R=I[T];h=Math.min(h,R.x),g=Math.min(g,R.y),w=Math.max(w,R.x),C=Math.max(C,R.y)}return[new v.Point(h,g),new v.Point(w,g),new v.Point(w,C),new v.Point(h,C),new v.Point(h,g)]},Object.defineProperties(Zn.prototype,Sn);var Yo=function(d){var p,h,g,w;this._hashName=d&&encodeURIComponent(d),v.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(p=this._updateHashUnthrottled.bind(this),h=!1,g=null,w=function(){g=null,h&&(p(),g=setTimeout(w,300),h=!1)},function(){return h=!0,g||w(),g})};Yo.prototype.addTo=function(d){return this._map=d,v.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Yo.prototype.remove=function(){return v.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Yo.prototype.getHashString=function(d){var p=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,g=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,g),C=Math.round(p.lng*w)/w,T=Math.round(p.lat*w)/w,I=this._map.getBearing(),R=this._map.getPitch(),L="";if(L+=d?"/"+C+"/"+T+"/"+h:h+"/"+T+"/"+C,(I||R)&&(L+="/"+Math.round(10*I)/10),R&&(L+="/"+Math.round(R)),this._hashName){var q=this._hashName,W=!1,H=v.window.location.hash.slice(1).split("&").map(function(oe){var ne=oe.split("=")[0];return ne===q?(W=!0,ne+"="+L):oe}).filter(function(oe){return oe});return W||H.push(q+"="+L),"#"+H.join("&")}return"#"+L},Yo.prototype._getCurrentHash=function(){var d,p=this,h=v.window.location.hash.replace("#","");return this._hashName?(h.split("&").map(function(g){return g.split("=")}).forEach(function(g){g[0]===p._hashName&&(d=g)}),(d&&d[1]||"").split("/")):h.split("/")},Yo.prototype._onHashChange=function(){var d=this._getCurrentHash();if(d.length>=3&&!d.some(function(h){return isNaN(h)})){var p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},Yo.prototype._updateHashUnthrottled=function(){var d=v.window.location.href.replace(/(#.+)?$/,this.getHashString());try{v.window.history.replaceState(v.window.history.state,null,d)}catch{}};var ia={linearity:.3,easing:v.bezier(0,0,.3,1)},xf=v.extend({deceleration:2500,maxSpeed:1400},ia),vl=v.extend({deceleration:20,maxSpeed:1400},ia),$u=v.extend({deceleration:1e3,maxSpeed:360},ia),qp=v.extend({deceleration:1e3,maxSpeed:90},ia),rc=function(d){this._map=d,this.clear()};function Hr(d,p){(!d.duration||d.duration<p.duration)&&(d.duration=p.duration,d.easing=p.easing)}function oa(d,p,h){var g=h.maxSpeed,w=h.linearity,C=h.deceleration,T=v.clamp(d*w/(p/1e3),-g,g),I=Math.abs(T)/(C*w);return{easing:h.easing,duration:1e3*I,amount:T*(I/2)}}rc.prototype.clear=function(){this._inertiaBuffer=[]},rc.prototype.record=function(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.browser.now(),settings:d})},rc.prototype._drainInertiaBuffer=function(){for(var d=this._inertiaBuffer,p=v.browser.now();d.length>0&&p-d[0].time>160;)d.shift()},rc.prototype._onMoveEnd=function(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var p={zoom:0,bearing:0,pitch:0,pan:new v.Point(0,0),pinchAround:void 0,around:void 0},h=0,g=this._inertiaBuffer;h<g.length;h+=1){var w=g[h].settings;p.zoom+=w.zoomDelta||0,p.bearing+=w.bearingDelta||0,p.pitch+=w.pitchDelta||0,w.panDelta&&p.pan._add(w.panDelta),w.around&&(p.around=w.around),w.pinchAround&&(p.pinchAround=w.pinchAround)}var C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(p.pan.mag()){var I=oa(p.pan.mag(),C,v.extend({},xf,d||{}));T.offset=p.pan.mult(I.amount/p.pan.mag()),T.center=this._map.transform.center,Hr(T,I)}if(p.zoom){var R=oa(p.zoom,C,vl);T.zoom=this._map.transform.zoom+R.amount,Hr(T,R)}if(p.bearing){var L=oa(p.bearing,C,$u);T.bearing=this._map.transform.bearing+v.clamp(L.amount,-179,179),Hr(T,L)}if(p.pitch){var q=oa(p.pitch,C,qp);T.pitch=this._map.transform.pitch+q.amount,Hr(T,q)}if(T.zoom||T.bearing){var W=void 0===p.pinchAround?p.around:p.pinchAround;T.around=W?this._map.unproject(W):this._map.getCenter()}return this.clear(),v.extend(T,{noMoveStart:!0})}};var Ui=function(d){function p(g,w,C,T){void 0===T&&(T={});var I=ze.mousePos(w.getCanvasContainer(),C),R=w.unproject(I);d.call(this,g,v.extend({point:I,lngLat:R,originalEvent:C},T)),this._defaultPrevented=!1,this.target=w}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),Ms=function(d){function p(g,w,C){var T="touchend"===g?C.changedTouches:C.touches,I=ze.touchPos(w.getCanvasContainer(),T),R=I.map(function(W){return w.unproject(W)}),L=I.reduce(function(W,H,oe,ne){return W.add(H.div(ne.length))},new v.Point(0,0)),q=w.unproject(L);d.call(this,g,{points:I,point:L,lngLats:R,lngLat:q,originalEvent:C}),this._defaultPrevented=!1}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),Bg=function(d){function p(g,w,C){d.call(this,g,{originalEvent:C}),this._defaultPrevented=!1}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={defaultPrevented:{configurable:!0}};return p.prototype.preventDefault=function(){this._defaultPrevented=!0},h.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(p.prototype,h),p}(v.Event),Ii=function(d,p){this._map=d,this._clickTolerance=p.clickTolerance};Ii.prototype.reset=function(){delete this._mousedownPos},Ii.prototype.wheel=function(d){return this._firePreventable(new Bg(d.type,this._map,d))},Ii.prototype.mousedown=function(d,p){return this._mousedownPos=p,this._firePreventable(new Ui(d.type,this._map,d))},Ii.prototype.mouseup=function(d){this._map.fire(new Ui(d.type,this._map,d))},Ii.prototype.click=function(d,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Ui(d.type,this._map,d))},Ii.prototype.dblclick=function(d){return this._firePreventable(new Ui(d.type,this._map,d))},Ii.prototype.mouseover=function(d){this._map.fire(new Ui(d.type,this._map,d))},Ii.prototype.mouseout=function(d){this._map.fire(new Ui(d.type,this._map,d))},Ii.prototype.touchstart=function(d){return this._firePreventable(new Ms(d.type,this._map,d))},Ii.prototype.touchmove=function(d){this._map.fire(new Ms(d.type,this._map,d))},Ii.prototype.touchend=function(d){this._map.fire(new Ms(d.type,this._map,d))},Ii.prototype.touchcancel=function(d){this._map.fire(new Ms(d.type,this._map,d))},Ii.prototype._firePreventable=function(d){if(this._map.fire(d),d.defaultPrevented)return{}},Ii.prototype.isEnabled=function(){return!0},Ii.prototype.isActive=function(){return!1},Ii.prototype.enable=function(){},Ii.prototype.disable=function(){};var so=function(d){this._map=d};so.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},so.prototype.mousemove=function(d){this._map.fire(new Ui(d.type,this._map,d))},so.prototype.mousedown=function(){this._delayContextMenu=!0},so.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},so.prototype.contextmenu=function(d){this._delayContextMenu?this._contextMenuEvent=d:this._map.fire(new Ui(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()},so.prototype.isEnabled=function(){return!0},so.prototype.isActive=function(){return!1},so.prototype.enable=function(){},so.prototype.disable=function(){};var st=function(d,p){this._map=d,this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=p.clickTolerance||1};function Kd(d,p){for(var h={},g=0;g<d.length;g++)h[d[g].identifier]=p[g];return h}st.prototype.isEnabled=function(){return!!this._enabled},st.prototype.isActive=function(){return!!this._active},st.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},st.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},st.prototype.mousedown=function(d,p){this.isEnabled()&&d.shiftKey&&0===d.button&&(ze.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)},st.prototype.mousemoveWindow=function(d,p){if(this._active){var h=p;if(!(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)){var g=this._startPos;this._lastPos=h,this._box||(this._box=ze.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",d));var w=Math.min(g.x,h.x),C=Math.max(g.x,h.x),T=Math.min(g.y,h.y),I=Math.max(g.y,h.y);ze.setTransform(this._box,"translate("+w+"px,"+T+"px)"),this._box.style.width=C-w+"px",this._box.style.height=I-T+"px"}}},st.prototype.mouseupWindow=function(d,p){var h=this;if(this._active&&0===d.button){var g=this._startPos,w=p;if(this.reset(),ze.suppressClick(),g.x!==w.x||g.y!==w.y)return this._map.fire(new v.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:function(C){return C.fitScreenCoordinates(g,w,h._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",d)}},st.prototype.keydown=function(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))},st.prototype.reset=function(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ze.remove(this._box),this._box=null),ze.enableDrag(),delete this._startPos,delete this._lastPos},st.prototype._fireEvent=function(d,p){return this._map.fire(new v.Event(d,{originalEvent:p}))};var qu=function(d){this.reset(),this.numTouches=d.numTouches};qu.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},qu.prototype.touchstart=function(d,p,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=d.timeStamp),h.length===this.numTouches&&(this.centroid=function(g){for(var w=new v.Point(0,0),C=0,T=g;C<T.length;C+=1)w._add(T[C]);return w.div(g.length)}(p),this.touches=Kd(h,p)))},qu.prototype.touchmove=function(d,p,h){if(!this.aborted&&this.centroid){var g=Kd(h,p);for(var w in this.touches){var C=g[w];(!C||C.dist(this.touches[w])>30)&&(this.aborted=!0)}}},qu.prototype.touchend=function(d,p,h){if((!this.centroid||d.timeStamp-this.startTime>500)&&(this.aborted=!0),0===h.length){var g=!this.aborted&&this.centroid;if(this.reset(),g)return g}};var ic=function(d){this.singleTap=new qu(d),this.numTaps=d.numTaps,this.reset()};ic.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ic.prototype.touchstart=function(d,p,h){this.singleTap.touchstart(d,p,h)},ic.prototype.touchmove=function(d,p,h){this.singleTap.touchmove(d,p,h)},ic.prototype.touchend=function(d,p,h){var g=this.singleTap.touchend(d,p,h);if(g){var w=d.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(g)<30;if(w&&C||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}};var Lo=function(){this._zoomIn=new ic({numTouches:1,numTaps:2}),this._zoomOut=new ic({numTouches:2,numTaps:1}),this.reset()};Lo.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Lo.prototype.touchstart=function(d,p,h){this._zoomIn.touchstart(d,p,h),this._zoomOut.touchstart(d,p,h)},Lo.prototype.touchmove=function(d,p,h){this._zoomIn.touchmove(d,p,h),this._zoomOut.touchmove(d,p,h)},Lo.prototype.touchend=function(d,p,h){var g=this,w=this._zoomIn.touchend(d,p,h),C=this._zoomOut.touchend(d,p,h);return w?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(w)},{originalEvent:d})}}):C?(this._active=!0,d.preventDefault(),setTimeout(function(){return g.reset()},0),{cameraAnimation:function(T){return T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(C)},{originalEvent:d})}}):void 0},Lo.prototype.touchcancel=function(){this.reset()},Lo.prototype.enable=function(){this._enabled=!0},Lo.prototype.disable=function(){this._enabled=!1,this.reset()},Lo.prototype.isEnabled=function(){return this._enabled},Lo.prototype.isActive=function(){return this._active};var ji={0:1,2:2},go=function(d){this.reset(),this._clickTolerance=d.clickTolerance||1};go.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},go.prototype._correctButton=function(d,p){return!1},go.prototype._move=function(d,p){return{}},go.prototype.mousedown=function(d,p){if(!this._lastPoint){var h=ze.mouseButton(d);this._correctButton(d,h)&&(this._lastPoint=p,this._eventButton=h)}},go.prototype.mousemoveWindow=function(d,p){var g,C,h=this._lastPoint;if(h)if(d.preventDefault(),C=ji[this._eventButton],void 0===(g=d).buttons||(g.buttons&C)!==C)this.reset();else if(this._moved||!(p.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(h,p)},go.prototype.mouseupWindow=function(d){this._lastPoint&&ze.mouseButton(d)===this._eventButton&&(this._moved&&ze.suppressClick(),this.reset())},go.prototype.enable=function(){this._enabled=!0},go.prototype.disable=function(){this._enabled=!1,this.reset()},go.prototype.isEnabled=function(){return this._enabled},go.prototype.isActive=function(){return this._active};var ht=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.mousedown=function(h,g){d.prototype.mousedown.call(this,h,g),this._lastPoint&&(this._active=!0)},p.prototype._correctButton=function(h,g){return 0===g&&!h.ctrlKey},p.prototype._move=function(h,g){return{around:g,panDelta:g.sub(h)}},p}(go),Qr=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},p.prototype._move=function(h,g){var w=.8*(g.x-h.x);if(w)return this._active=!0,{bearingDelta:w}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(go),Ke=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype._correctButton=function(h,g){return 0===g&&h.ctrlKey||2===g},p.prototype._move=function(h,g){var w=-.5*(g.y-h.y);if(w)return this._active=!0,{pitchDelta:w}},p.prototype.contextmenu=function(h){h.preventDefault()},p}(go),Bt=function(d){this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset()};Bt.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new v.Point(0,0)},Bt.prototype.touchstart=function(d,p,h){return this._calculateTransform(d,p,h)},Bt.prototype.touchmove=function(d,p,h){if(this._active&&!(h.length<this._minTouches))return d.preventDefault(),this._calculateTransform(d,p,h)},Bt.prototype.touchend=function(d,p,h){this._calculateTransform(d,p,h),this._active&&h.length<this._minTouches&&this.reset()},Bt.prototype.touchcancel=function(){this.reset()},Bt.prototype._calculateTransform=function(d,p,h){h.length>0&&(this._active=!0);var g=Kd(h,p),w=new v.Point(0,0),C=new v.Point(0,0),T=0;for(var I in g){var R=g[I],L=this._touches[I];L&&(w._add(R),C._add(R.sub(L)),T++,g[I]=R)}if(this._touches=g,!(T<this._minTouches)&&C.mag()){var q=C.div(T);if(this._sum._add(q),!(this._sum.mag()<this._clickTolerance))return{around:w.div(T),panDelta:q}}},Bt.prototype.enable=function(){this._enabled=!0},Bt.prototype.disable=function(){this._enabled=!1,this.reset()},Bt.prototype.isEnabled=function(){return this._enabled},Bt.prototype.isActive=function(){return this._active};var Bn=function(){this.reset()};function Hi(d,p,h){for(var g=0;g<d.length;g++)if(d[g].identifier===h)return p[g]}function $i(d,p){return Math.log(d/p)/Math.LN2}Bn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Bn.prototype._start=function(d){},Bn.prototype._move=function(d,p,h){return{}},Bn.prototype.touchstart=function(d,p,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([p[0],p[1]]))},Bn.prototype.touchmove=function(d,p,h){if(this._firstTwoTouches){d.preventDefault();var g=this._firstTwoTouches,w=g[1],C=Hi(h,p,g[0]),T=Hi(h,p,w);if(C&&T){var I=this._aroundCenter?null:C.add(T).div(2);return this._move([C,T],I,d)}}},Bn.prototype.touchend=function(d,p,h){if(this._firstTwoTouches){var g=this._firstTwoTouches,w=g[1],C=Hi(h,p,g[0]),T=Hi(h,p,w);C&&T||(this._active&&ze.suppressClick(),this.reset())}},Bn.prototype.touchcancel=function(){this.reset()},Bn.prototype.enable=function(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around},Bn.prototype.disable=function(){this._enabled=!1,this.reset()},Bn.prototype.isEnabled=function(){return this._enabled},Bn.prototype.isActive=function(){return this._active};var bl=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),delete this._distance,delete this._startDistance},p.prototype._start=function(h){this._startDistance=this._distance=h[0].dist(h[1])},p.prototype._move=function(h,g){var w=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs($i(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$i(this._distance,w),pinchAround:g}},p}(Bn);function qi(d,p){return 180*d.angleWith(p)/Math.PI}var Mn=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},p.prototype._start=function(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])},p.prototype._move=function(h,g){var w=this._vector;if(this._vector=h[0].sub(h[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qi(this._vector,w),pinchAround:g}},p.prototype._isBelowThreshold=function(h){this._minDiameter=Math.min(this._minDiameter,h.mag());var g=25/(Math.PI*this._minDiameter)*360,w=qi(h,this._startVector);return Math.abs(w)<g},p}(Bn);function Ln(d){return Math.abs(d.y)>Math.abs(d.x)}var ls=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.reset=function(){d.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},p.prototype._start=function(h){this._lastPoints=h,Ln(h[0].sub(h[1]))&&(this._valid=!1)},p.prototype._move=function(h,g,w){var C=h[0].sub(this._lastPoints[0]),T=h[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(C,T,w.timeStamp),this._valid)return this._lastPoints=h,this._active=!0,{pitchDelta:(C.y+T.y)/2*-.5}},p.prototype.gestureBeginsVertically=function(h,g,w){if(void 0!==this._valid)return this._valid;var C=h.mag()>=2,T=g.mag()>=2;if(C||T){if(!C||!T)return void 0===this._firstMove&&(this._firstMove=w),w-this._firstMove<100&&void 0;var I=h.y>0==g.y>0;return Ln(h)&&Ln(g)&&I}},p}(Bn),nn={panStep:100,bearingStep:15,pitchStep:10},_o=function(){var d=nn;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1};function Zd(d){return d*(2-d)}_o.prototype.reset=function(){this._active=!1},_o.prototype.keydown=function(d){var p=this;if(!(d.altKey||d.ctrlKey||d.metaKey)){var h=0,g=0,w=0,C=0,T=0;switch(d.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:d.shiftKey?g=-1:(d.preventDefault(),C=-1);break;case 39:d.shiftKey?g=1:(d.preventDefault(),C=1);break;case 38:d.shiftKey?w=1:(d.preventDefault(),T=-1);break;case 40:d.shiftKey?w=-1:(d.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:function(I){var R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:Zd,zoom:h?Math.round(R)+h*(d.shiftKey?2:1):R,bearing:I.getBearing()+g*p._bearingStep,pitch:I.getPitch()+w*p._pitchStep,offset:[-C*p._panStep,-T*p._panStep],center:I.getCenter()},{originalEvent:d})}}}},_o.prototype.enable=function(){this._enabled=!0},_o.prototype.disable=function(){this._enabled=!1,this.reset()},_o.prototype.isEnabled=function(){return this._enabled},_o.prototype.isActive=function(){return this._active},_o.prototype.disableRotation=function(){this._rotationDisabled=!0},_o.prototype.enableRotation=function(){this._rotationDisabled=!1};var nr=function(d,p){this._map=d,this._el=d.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,v.bindAll(["_onTimeout"],this)};nr.prototype.setZoomRate=function(d){this._defaultZoomRate=d},nr.prototype.setWheelZoomRate=function(d){this._wheelZoomRate=d},nr.prototype.isEnabled=function(){return!!this._enabled},nr.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},nr.prototype.isZooming=function(){return!!this._zooming},nr.prototype.enable=function(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=d&&"center"===d.around)},nr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},nr.prototype.wheel=function(d){if(this.isEnabled()){var p=d.deltaMode===v.window.WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY,h=v.browser.now(),g=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,0!==p&&p%4.000244140625==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(g*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),d.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=d,this._delta-=p,this._active||this._start(d)),d.preventDefault()}},nr.prototype._onTimeout=function(d){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},nr.prototype._start=function(d){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var p=ze.mousePos(this._el,d);this._around=v.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(p)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},nr.prototype.renderFrame=function(){var d=this;if(this._frameId&&(this._frameId=null,this.isActive())){var p=this._map.transform;if(0!==this._delta){var h="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,g=2/(1+Math.exp(-Math.abs(this._delta*h)));this._delta<0&&0!==g&&(g=1/g);var w="number"==typeof this._targetZoom?p.zoomScale(this._targetZoom):p.scale;this._targetZoom=Math.min(p.maxZoom,Math.max(p.minZoom,p.scaleZoom(w*g))),"wheel"===this._type&&(this._startZoom=p.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var C,T="number"==typeof this._targetZoom?this._targetZoom:p.zoom,I=this._startZoom,R=this._easing,L=!1;if("wheel"===this._type&&I&&R){var q=Math.min((v.browser.now()-this._lastWheelEventTime)/200,1),W=R(q);C=v.number(I,T,W),q<1?this._frameId||(this._frameId=!0):L=!0}else C=T,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(function(){d._zooming=!1,d._handler._triggerRenderFrame(),delete d._targetZoom,delete d._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:C-p.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},nr.prototype._smoothOutEasing=function(d){var p=v.ease;if(this._prevEase){var h=this._prevEase,g=(v.browser.now()-h.start)/h.duration,w=h.easing(g+.01)-h.easing(g),C=.27/Math.sqrt(w*w+1e-4)*.01,T=Math.sqrt(.0729-C*C);p=v.bezier(C,T,.25,1)}return this._prevEase={start:v.browser.now(),duration:d,easing:p},p},nr.prototype.reset=function(){this._active=!1};var Kt=function(d,p){this._clickZoom=d,this._tapZoom=p};Kt.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Kt.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Kt.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Kt.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Gi=function(){this.reset()};Gi.prototype.reset=function(){this._active=!1},Gi.prototype.dblclick=function(d,p){return d.preventDefault(),{cameraAnimation:function(h){h.easeTo({duration:300,zoom:h.getZoom()+(d.shiftKey?-1:1),around:h.unproject(p)},{originalEvent:d})}}},Gi.prototype.enable=function(){this._enabled=!0},Gi.prototype.disable=function(){this._enabled=!1,this.reset()},Gi.prototype.isEnabled=function(){return this._enabled},Gi.prototype.isActive=function(){return this._active};var Wi=function(){this._tap=new ic({numTouches:1,numTaps:1}),this.reset()};Wi.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Wi.prototype.touchstart=function(d,p,h){this._swipePoint||(this._tapTime&&d.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=p[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(d,p,h))},Wi.prototype.touchmove=function(d,p,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;var g=p[0],w=g.y-this._swipePoint.y;return this._swipePoint=g,d.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(d,p,h)},Wi.prototype.touchend=function(d,p,h){this._tapTime?this._swipePoint&&0===h.length&&this.reset():this._tap.touchend(d,p,h)&&(this._tapTime=d.timeStamp)},Wi.prototype.touchcancel=function(){this.reset()},Wi.prototype.enable=function(){this._enabled=!0},Wi.prototype.disable=function(){this._enabled=!1,this.reset()},Wi.prototype.isEnabled=function(){return this._enabled},Wi.prototype.isActive=function(){return this._active};var mi=function(d,p,h){this._el=d,this._mousePan=p,this._touchPan=h};mi.prototype.enable=function(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},mi.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")},mi.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},mi.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var yo=function(d,p,h){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=p,this._mousePitch=h};yo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},yo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},yo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},yo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var sa=function(d,p,h,g){this._el=d,this._touchZoom=p,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0};sa.prototype.enable=function(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},sa.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")},sa.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},sa.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},sa.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},sa.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Xo=function(d){return d.zoom||d.drag||d.pitch||d.rotate},Qo=function(d){function p(){d.apply(this,arguments)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p}(v.Event);function Rs(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}var tt=function(d,p){this._map=d,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rc(d),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p),v.bindAll(["handleEvent","handleWindowEvent"],this);var h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[v.window.document,"mousemove",{capture:!0}],[v.window.document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[v.window,"blur",void 0]];for(var g=0,w=this._listeners;g<w.length;g+=1){var C=w[g],T=C[0];ze.addEventListener(T,C[1],T===v.window.document?this.handleWindowEvent:this.handleEvent,C[2])}};tt.prototype.destroy=function(){for(var d=0,p=this._listeners;d<p.length;d+=1){var h=p[d],g=h[0];ze.removeEventListener(g,h[1],g===v.window.document?this.handleWindowEvent:this.handleEvent,h[2])}},tt.prototype._addDefaultHandlers=function(d){var p=this._map,h=p.getCanvasContainer();this._add("mapEvent",new Ii(p,d));var g=p.boxZoom=new st(p,d);this._add("boxZoom",g);var w=new Lo,C=new Gi;p.doubleClickZoom=new Kt(C,w),this._add("tapZoom",w),this._add("clickZoom",C);var T=new Wi;this._add("tapDragZoom",T);var I=p.touchPitch=new ls;this._add("touchPitch",I);var R=new Qr(d),L=new Ke(d);p.dragRotate=new yo(d,R,L),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);var q=new ht(d),W=new Bt(d);p.dragPan=new mi(h,q,W),this._add("mousePan",q),this._add("touchPan",W,["touchZoom","touchRotate"]);var H=new Mn,oe=new bl;p.touchZoomRotate=new sa(h,oe,H,T),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",oe,["touchPan","touchRotate"]);var ne=p.scrollZoom=new nr(p,this);this._add("scrollZoom",ne,["mousePan"]);var de=p.keyboard=new _o;this._add("keyboard",de),this._add("blockableMapEvent",new so(p));for(var re=0,ae=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];re<ae.length;re+=1){var ge=ae[re];d.interactive&&d[ge]&&p[ge].enable(d[ge])}},tt.prototype._add=function(d,p,h){this._handlers.push({handlerName:d,handler:p,allowed:h}),this._handlersById[d]=p},tt.prototype.stop=function(d){if(!this._updatingCamera){for(var p=0,h=this._handlers;p<h.length;p+=1)h[p].handler.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}},tt.prototype.isActive=function(){for(var d=0,p=this._handlers;d<p.length;d+=1)if(p[d].handler.isActive())return!0;return!1},tt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},tt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},tt.prototype.isMoving=function(){return!!Xo(this._eventsInProgress)||this.isZooming()},tt.prototype._blockedByActive=function(d,p,h){for(var g in d)if(g!==h&&(!p||p.indexOf(g)<0))return!0;return!1},tt.prototype.handleWindowEvent=function(d){this.handleEvent(d,d.type+"Window")},tt.prototype._getMapTouches=function(d){for(var p=[],h=0,g=d;h<g.length;h+=1){var w=g[h];this._el.contains(w.target)&&p.push(w)}return p},tt.prototype.handleEvent=function(d,p){if("blur"!==d.type){this._updatingCamera=!0;for(var h="renderFrame"===d.type?void 0:d,g={needsRenderFrame:!1},w={},C={},T=d.touches?this._getMapTouches(d.touches):void 0,I=T?ze.touchPos(this._el,T):ze.mousePos(this._el,d),R=0,L=this._handlers;R<L.length;R+=1){var q=L[R],W=q.handlerName,H=q.handler,oe=q.allowed;if(H.isEnabled()){var ne=void 0;this._blockedByActive(C,oe,W)?H.reset():H[p||d.type]&&(ne=H[p||d.type](d,I,T),this.mergeHandlerResult(g,w,ne,W,h),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||H.isActive())&&(C[W]=H)}}var de={};for(var re in this._previousActiveHandlers)C[re]||(de[re]=h);this._previousActiveHandlers=C,(Object.keys(de).length||Rs(g))&&(this._changes.push([g,w,de]),this._triggerRenderFrame()),(Object.keys(C).length||Rs(g))&&this._map._stop(!0),this._updatingCamera=!1;var ae=g.cameraAnimation;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))}else this.stop(!0)},tt.prototype.mergeHandlerResult=function(d,p,h,g,w){if(h){v.extend(d,h);var C={handlerName:g,originalEvent:h.originalEvent||w};void 0!==h.zoomDelta&&(p.zoom=C),void 0!==h.panDelta&&(p.drag=C),void 0!==h.pitchDelta&&(p.pitch=C),void 0!==h.bearingDelta&&(p.rotate=C)}},tt.prototype._applyChanges=function(){for(var d={},p={},h={},g=0,w=this._changes;g<w.length;g+=1){var C=w[g],T=C[0],I=C[1],R=C[2];T.panDelta&&(d.panDelta=(d.panDelta||new v.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(d.zoomDelta=(d.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(d.bearingDelta=(d.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(d.pitchDelta=(d.pitchDelta||0)+T.pitchDelta),void 0!==T.around&&(d.around=T.around),void 0!==T.pinchAround&&(d.pinchAround=T.pinchAround),T.noInertia&&(d.noInertia=T.noInertia),v.extend(p,I),v.extend(h,R)}this._updateMapTransform(d,p,h),this._changes=[]},tt.prototype._updateMapTransform=function(d,p,h){var g=this._map,w=g.transform;if(!Rs(d))return this._fireEvents(p,h,!0);var C=d.panDelta,T=d.zoomDelta,I=d.bearingDelta,R=d.pitchDelta,L=d.around,q=d.pinchAround;void 0!==q&&(L=q),g._stop(!0),L=L||g.transform.centerPoint;var W=w.pointLocation(C?L.sub(C):L);I&&(w.bearing+=I),R&&(w.pitch+=R),T&&(w.zoom+=T),w.setLocationAtPoint(W,L),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(p,h,!0)},tt.prototype._fireEvents=function(d,p,h){var g=this,w=Xo(this._eventsInProgress),C=Xo(d),T={};for(var I in d)this._eventsInProgress[I]||(T[I+"start"]=d[I].originalEvent),this._eventsInProgress[I]=d[I];for(var R in!w&&C&&this._fireEvent("movestart",C.originalEvent),T)this._fireEvent(R,T[R]);for(var L in C&&this._fireEvent("move",C.originalEvent),d)this._fireEvent(L,d[L].originalEvent);var q,W={};for(var H in this._eventsInProgress){var oe=this._eventsInProgress[H],ne=oe.handlerName,de=oe.originalEvent;this._handlersById[ne].isActive()||(delete this._eventsInProgress[H],W[H+"end"]=q=p[ne]||de)}for(var re in W)this._fireEvent(re,W[re]);var ae=Xo(this._eventsInProgress);if(h&&(w||C)&&!ae){this._updatingCamera=!0;var ge=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=function(Ae){return 0!==Ae&&-g._bearingSnap<Ae&&Ae<g._bearingSnap};ge?(be(ge.bearing||this._map.getBearing())&&(ge.bearing=0),this._map.easeTo(ge,{originalEvent:q})):(this._map.fire(new v.Event("moveend",{originalEvent:q})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},tt.prototype._fireEvent=function(d,p){this._map.fire(new v.Event(d,p?{originalEvent:p}:{}))},tt.prototype._requestFrame=function(){var d=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(p){delete d._frameId,d.handleEvent(new Qo("renderFrame",{timeStamp:p})),d._applyChanges()})},tt.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var Nt=function(d){function p(h,g){d.call(this),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=g.bearingSnap,v.bindAll(["_renderFrameCallback"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.getCenter=function(){return new v.LngLat(this.transform.center.lng,this.transform.center.lat)},p.prototype.setCenter=function(h,g){return this.jumpTo({center:h},g)},p.prototype.panBy=function(h,g,w){return h=v.Point.convert(h).mult(-1),this.panTo(this.transform.center,v.extend({offset:h},g),w)},p.prototype.panTo=function(h,g,w){return this.easeTo(v.extend({center:h},g),w)},p.prototype.getZoom=function(){return this.transform.zoom},p.prototype.setZoom=function(h,g){return this.jumpTo({zoom:h},g),this},p.prototype.zoomTo=function(h,g,w){return this.easeTo(v.extend({zoom:h},g),w)},p.prototype.zoomIn=function(h,g){return this.zoomTo(this.getZoom()+1,h,g),this},p.prototype.zoomOut=function(h,g){return this.zoomTo(this.getZoom()-1,h,g),this},p.prototype.getBearing=function(){return this.transform.bearing},p.prototype.setBearing=function(h,g){return this.jumpTo({bearing:h},g),this},p.prototype.getPadding=function(){return this.transform.padding},p.prototype.setPadding=function(h,g){return this.jumpTo({padding:h},g),this},p.prototype.rotateTo=function(h,g,w){return this.easeTo(v.extend({bearing:h},g),w)},p.prototype.resetNorth=function(h,g){return this.rotateTo(0,v.extend({duration:1e3},h),g),this},p.prototype.resetNorthPitch=function(h,g){return this.easeTo(v.extend({bearing:0,pitch:0,duration:1e3},h),g),this},p.prototype.snapToNorth=function(h,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,g):this},p.prototype.getPitch=function(){return this.transform.pitch},p.prototype.setPitch=function(h,g){return this.jumpTo({pitch:h},g),this},p.prototype.cameraForBounds=function(h,g){h=v.LngLatBounds.convert(h);var w=g&&g.bearing||0;return this._cameraForBoxAndBearing(h.getNorthWest(),h.getSouthEast(),w,g)},p.prototype._cameraForBoxAndBearing=function(h,g,w,C){var T={top:0,bottom:0,right:0,left:0};if("number"==typeof(C=v.extend({padding:T,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding){var I=C.padding;C.padding={top:I,bottom:I,right:I,left:I}}C.padding=v.extend(T,C.padding);var R=this.transform,L=R.padding,q=R.project(v.LngLat.convert(h)),W=R.project(v.LngLat.convert(g)),H=q.rotate(-w*Math.PI/180),oe=W.rotate(-w*Math.PI/180),ne=new v.Point(Math.max(H.x,oe.x),Math.max(H.y,oe.y)),de=new v.Point(Math.min(H.x,oe.x),Math.min(H.y,oe.y)),re=ne.sub(de),ae=(R.width-(L.left+L.right+C.padding.left+C.padding.right))/re.x,ge=(R.height-(L.top+L.bottom+C.padding.top+C.padding.bottom))/re.y;if(!(ge<0||ae<0)){var be=Math.min(R.scaleZoom(R.scale*Math.min(ae,ge)),C.maxZoom),Ae="number"==typeof C.offset.x?new v.Point(C.offset.x,C.offset.y):v.Point.convert(C.offset),De=new v.Point((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(w*Math.PI/180),Me=Ae.add(De).mult(R.scale/R.zoomScale(be));return{center:R.unproject(q.add(W).div(2).sub(Me)),zoom:be,bearing:w}}v.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},p.prototype.fitBounds=function(h,g,w){return this._fitInternal(this.cameraForBounds(h,g),g,w)},p.prototype.fitScreenCoordinates=function(h,g,w,C,T){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(v.Point.convert(h)),this.transform.pointLocation(v.Point.convert(g)),w,C),C,T)},p.prototype._fitInternal=function(h,g,w){return h?(delete(g=v.extend(h,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this},p.prototype.jumpTo=function(h,g){this.stop();var w=this.transform,C=!1,T=!1,I=!1;return"zoom"in h&&w.zoom!==+h.zoom&&(C=!0,w.zoom=+h.zoom),void 0!==h.center&&(w.center=v.LngLat.convert(h.center)),"bearing"in h&&w.bearing!==+h.bearing&&(T=!0,w.bearing=+h.bearing),"pitch"in h&&w.pitch!==+h.pitch&&(I=!0,w.pitch=+h.pitch),null==h.padding||w.isPaddingEqual(h.padding)||(w.padding=h.padding),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g)),C&&this.fire(new v.Event("zoomstart",g)).fire(new v.Event("zoom",g)).fire(new v.Event("zoomend",g)),T&&this.fire(new v.Event("rotatestart",g)).fire(new v.Event("rotate",g)).fire(new v.Event("rotateend",g)),I&&this.fire(new v.Event("pitchstart",g)).fire(new v.Event("pitch",g)).fire(new v.Event("pitchend",g)),this.fire(new v.Event("moveend",g))},p.prototype.easeTo=function(h,g){var w=this;this._stop(!1,h.easeId),(!1===(h=v.extend({offset:[0,0],duration:500,easing:v.ease},h)).animate||!h.essential&&v.browser.prefersReducedMotion)&&(h.duration=0);var C=this.transform,T=this.getZoom(),I=this.getBearing(),R=this.getPitch(),L=this.getPadding(),q="zoom"in h?+h.zoom:T,W="bearing"in h?this._normalizeBearing(h.bearing,I):I,H="pitch"in h?+h.pitch:R,oe="padding"in h?h.padding:C.padding,ne=v.Point.convert(h.offset),de=C.centerPoint.add(ne),re=C.pointLocation(de),ae=v.LngLat.convert(h.center||re);this._normalizeCenter(ae);var ge,be,Ae=C.project(re),De=C.project(ae).sub(Ae),Me=C.zoomScale(q-T);h.around&&(ge=v.LngLat.convert(h.around),be=C.locationPoint(ge));var Le={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||q!==T,this._rotating=this._rotating||I!==W,this._pitching=this._pitching||H!==R,this._padding=!C.isPaddingEqual(oe),this._easeId=h.easeId,this._prepareEase(g,h.noMoveStart,Le),this._ease(function(Qe){if(w._zooming&&(C.zoom=v.number(T,q,Qe)),w._rotating&&(C.bearing=v.number(I,W,Qe)),w._pitching&&(C.pitch=v.number(R,H,Qe)),w._padding&&(C.interpolatePadding(L,oe,Qe),de=C.centerPoint.add(ne)),ge)C.setLocationAtPoint(ge,be);else{var qe=C.zoomScale(C.zoom-T),at=q>T?Math.min(2,Me):Math.max(.5,Me),Et=Math.pow(at,1-Qe),It=C.unproject(Ae.add(De.mult(Qe*Et)).mult(qe));C.setLocationAtPoint(C.renderWorldCopies?It.wrap():It,de)}w._fireMoveEvents(g)},function(Qe){w._afterEase(g,Qe)},h),this},p.prototype._prepareEase=function(h,g,w){void 0===w&&(w={}),this._moving=!0,g||w.moving||this.fire(new v.Event("movestart",h)),this._zooming&&!w.zooming&&this.fire(new v.Event("zoomstart",h)),this._rotating&&!w.rotating&&this.fire(new v.Event("rotatestart",h)),this._pitching&&!w.pitching&&this.fire(new v.Event("pitchstart",h))},p.prototype._fireMoveEvents=function(h){this.fire(new v.Event("move",h)),this._zooming&&this.fire(new v.Event("zoom",h)),this._rotating&&this.fire(new v.Event("rotate",h)),this._pitching&&this.fire(new v.Event("pitch",h))},p.prototype._afterEase=function(h,g){if(!this._easeId||!g||this._easeId!==g){delete this._easeId;var w=this._zooming,C=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new v.Event("zoomend",h)),C&&this.fire(new v.Event("rotateend",h)),T&&this.fire(new v.Event("pitchend",h)),this.fire(new v.Event("moveend",h))}},p.prototype.flyTo=function(h,g){var w=this;if(!h.essential&&v.browser.prefersReducedMotion){var C=v.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(C,g)}this.stop(),h=v.extend({offset:[0,0],speed:1.2,curve:1.42,easing:v.ease},h);var T=this.transform,I=this.getZoom(),R=this.getBearing(),L=this.getPitch(),q=this.getPadding(),W="zoom"in h?v.clamp(+h.zoom,T.minZoom,T.maxZoom):I,H="bearing"in h?this._normalizeBearing(h.bearing,R):R,oe="pitch"in h?+h.pitch:L,ne="padding"in h?h.padding:T.padding,de=T.zoomScale(W-I),re=v.Point.convert(h.offset),ae=T.centerPoint.add(re),ge=T.pointLocation(ae),be=v.LngLat.convert(h.center||ge);this._normalizeCenter(be);var Ae=T.project(ge),De=T.project(be).sub(Ae),Me=h.curve,Le=Math.max(T.width,T.height),Qe=Le/de,qe=De.mag();if("minZoom"in h){var at=v.clamp(Math.min(h.minZoom,I,W),T.minZoom,T.maxZoom),Et=Le/T.zoomScale(at-I);Me=Math.sqrt(Et/qe*2)}var It=Me*Me;function St(Ut){var Rt=(Qe*Qe-Le*Le+(Ut?-1:1)*It*It*qe*qe)/(2*(Ut?Qe:Le)*It*qe);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function pn(Ut){return(Math.exp(Ut)-Math.exp(-Ut))/2}function ut(Ut){return(Math.exp(Ut)+Math.exp(-Ut))/2}var Yt=St(0),dn=function(Ut){return ut(Yt)/ut(Yt+Me*Ut)},et=function(Ut){return Le*((ut(Yt)*(pn(Rt=Yt+Me*Ut)/ut(Rt))-pn(Yt))/It)/qe;var Rt},zt=(St(1)-Yt)/Me;if(Math.abs(qe)<1e-6||!isFinite(zt)){if(Math.abs(Le-Qe)<1e-6)return this.easeTo(h,g);var $t=Qe<Le?-1:1;zt=Math.abs(Math.log(Qe/Le))/Me,et=function(){return 0},dn=function(Ut){return Math.exp($t*Me*Ut)}}return h.duration="duration"in h?+h.duration:1e3*zt/("screenSpeed"in h?+h.screenSpeed/Me:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0),this._zooming=!0,this._rotating=R!==H,this._pitching=oe!==L,this._padding=!T.isPaddingEqual(ne),this._prepareEase(g,!1),this._ease(function(Ut){var Rt=Ut*zt,rr=1/dn(Rt);T.zoom=1===Ut?W:I+T.scaleZoom(rr),w._rotating&&(T.bearing=v.number(R,H,Ut)),w._pitching&&(T.pitch=v.number(L,oe,Ut)),w._padding&&(T.interpolatePadding(q,ne,Ut),ae=T.centerPoint.add(re));var $r=1===Ut?be:T.unproject(Ae.add(De.mult(et(Rt))).mult(rr));T.setLocationAtPoint(T.renderWorldCopies?$r.wrap():$r,ae),w._fireMoveEvents(g)},function(){return w._afterEase(g)},h),this},p.prototype.isEasing=function(){return!!this._easeFrameId},p.prototype.stop=function(){return this._stop()},p.prototype._stop=function(h,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,g)}if(!h){var C=this.handlers;C&&C.stop(!1)}return this},p.prototype._ease=function(h,g,w){!1===w.animate||0===w.duration?(h(1),g()):(this._easeStart=v.browser.now(),this._easeOptions=w,this._onEaseFrame=h,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},p.prototype._renderFrameCallback=function(){var h=Math.min((v.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},p.prototype._normalizeBearing=function(h,g){h=v.wrap(h,-180,180);var w=Math.abs(h-g);return Math.abs(h-360-g)<w&&(h-=360),Math.abs(h+360-g)<w&&(h+=360),h},p.prototype._normalizeCenter=function(h){var g=this.transform;if(g.renderWorldCopies&&!g.lngRange){var w=h.lng-g.center.lng;h.lng+=w>180?-360:w<-180?360:0}},p}(v.Evented),gi=function(d){void 0===d&&(d={}),this.options=d,v.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};gi.prototype.getDefaultPosition=function(){return"bottom-right"},gi.prototype.onAdd=function(d){var p=this.options&&this.options.compact;return this._map=d,this._container=ze.create("div","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ze.create("button","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.type="button",this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ze.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("maplibregl-compact","mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},gi.prototype.onRemove=function(){ze.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},gi.prototype._setElementTitle=function(d,p){var h=this._map._getUIString("AttributionControl."+p);d.title=h,d.setAttribute("aria-label",h)},gi.prototype._toggleAttribution=function(){this._container.classList.contains("maplibregl-compact-show")||this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},gi.prototype._updateEditLink=function(){var d=this._editLink;d||(d=this._editLink=this._container.querySelector(".mapbox-improve-map"));var p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||v.config.ACCESS_TOKEN}];if(d){var h=p.reduce(function(g,w,C){return w.value&&(g+=w.key+"="+w.value+(C<p.length-1?"&":"")),g},"?");d.href=v.config.FEEDBACK_URL+"/"+h+(this._map._hash?this._map._hash.getHashString(!0):""),d.rel="noopener nofollow",this._setElementTitle(d,"MapFeedback")}},gi.prototype._updateData=function(d){!d||"metadata"!==d.sourceDataType&&"visibility"!==d.sourceDataType&&"style"!==d.dataType||(this._updateAttributions(),this._updateEditLink())},gi.prototype._updateAttributions=function(){if(this._map.style){var d=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?d=d.concat(this.options.customAttribution.map(function(I){return"string"!=typeof I?"":I})):"string"==typeof this.options.customAttribution&&d.push(this.options.customAttribution)),this._map.style.stylesheet){var p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}var h=this._map.style.sourceCaches;for(var g in h){var w=h[g];if(w.used){var C=w.getSource();C.attribution&&d.indexOf(C.attribution)<0&&d.push(C.attribution)}}d.sort(function(I,R){return I.length-R.length});var T=(d=d.filter(function(I,R){for(var L=R+1;L<d.length;L++)if(d[L].indexOf(I)>=0)return!1;return!0})).join(" | ");T!==this._attribHTML&&(this._attribHTML=T,d.length?(this._innerContainer.innerHTML=T,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._editLink=null)}},gi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("maplibregl-compact","mapboxgl-compact"):this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show")};var Ot=function(){v.bindAll(["_updateLogo"],this),v.bindAll(["_updateCompact"],this)};Ot.prototype.onAdd=function(d){this._map=d,this._container=ze.create("div","maplibregl-ctrl mapboxgl-ctrl");var p=ze.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ot.prototype.onRemove=function(){ze.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ot.prototype.getDefaultPosition=function(){return"bottom-left"},Ot.prototype._updateLogo=function(d){d&&"metadata"!==d.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Ot.prototype._logoRequired=function(){if(this._map.style){var d=this._map.style.sourceCaches;for(var p in d)if(d[p].getSource().mapbox_logo)return!0;return!1}},Ot.prototype._updateCompact=function(){var d=this._container.children;if(d.length){var p=d[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("maplibregl-compact","mapboxgl-compact"):p.classList.remove("maplibregl-compact","mapboxgl-compact")}};var aa=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};aa.prototype.add=function(d){var p=++this._id;return this._queue.push({callback:d,id:p,cancelled:!1}),p},aa.prototype.remove=function(d){for(var p=this._currentlyRunning,h=0,g=p?this._queue.concat(p):this._queue;h<g.length;h+=1){var w=g[h];if(w.id===d)return void(w.cancelled=!0)}},aa.prototype.run=function(d){void 0===d&&(d=0);var p=this._currentlyRunning=this._queue;this._queue=[];for(var h=0,g=p;h<g.length;h+=1){var w=g[h];if(!w.cancelled&&(w.callback(d),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},aa.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var _i={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ki=v.window.HTMLImageElement,Ef=v.window.HTMLElement,cs=v.window.ImageBitmap,Wt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},En=function(d){function p(g){var w=this;if(null!=(g=v.extend({},Wt,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var C=new Zn(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies);if(d.call(this,C,g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new aa,this._controls=[],this._mapId=v.uniqueId(),this._locale=v.extend({},_i,g.locale),this._clickTolerance=g.clickTolerance,this._requestManager=new v.RequestManager(g.transformRequest,g.accessToken),"string"==typeof g.container){if(this._container=v.window.document.getElementById(g.container),!this._container)throw new Error("Container '"+g.container+"' not found.")}else{if(!(g.container instanceof Ef))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),v.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return w._update(!1)}),this.on("moveend",function(){return w._update(!1)}),this.on("zoom",function(){return w._update(!0)}),void 0!==v.window&&(v.window.addEventListener("online",this._onWindowOnline,!1),v.window.addEventListener("resize",this._onWindowResize,!1),v.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new tt(this,g),this._hash=g.hash&&new Yo("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,v.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new gi({customAttribution:g.customAttribution})),this.addControl(new Ot,g.logoPosition),this.on("style.load",function(){w.transform.unmodified&&w.jumpTo(w.style.stylesheet)}),this.on("data",function(T){w._update("style"===T.dataType),w.fire(new v.Event(T.dataType+"data",T))}),this.on("dataloading",function(T){w.fire(new v.Event(T.dataType+"dataloading",T))})}d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p;var h={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return p.prototype._getMapId=function(){return this._mapId},p.prototype.addControl=function(g,w){if(void 0===w&&(w=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var C=g.onAdd(this);this._controls.push(g);var T=this._controlPositions[w];return-1!==w.indexOf("bottom")?T.insertBefore(C,T.firstChild):T.appendChild(C),this},p.prototype.removeControl=function(g){if(!g||!g.onRemove)return this.fire(new v.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var w=this._controls.indexOf(g);return w>-1&&this._controls.splice(w,1),g.onRemove(this),this},p.prototype.hasControl=function(g){return this._controls.indexOf(g)>-1},p.prototype.resize=function(g){var w=this._containerDimensions(),C=w[0],T=w[1];this._resizeCanvas(C,T),this.transform.resize(C,T),this.painter.resize(C,T);var I=!this._moving;return I&&(this.stop(),this.fire(new v.Event("movestart",g)).fire(new v.Event("move",g))),this.fire(new v.Event("resize",g)),I&&this.fire(new v.Event("moveend",g)),this},p.prototype.getBounds=function(){return this.transform.getBounds()},p.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},p.prototype.setMaxBounds=function(g){return this.transform.setMaxBounds(v.LngLatBounds.convert(g)),this._update()},p.prototype.setMinZoom=function(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},p.prototype.getMinZoom=function(){return this.transform.minZoom},p.prototype.setMaxZoom=function(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")},p.prototype.getMaxZoom=function(){return this.transform.maxZoom},p.prototype.setMinPitch=function(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},p.prototype.getMinPitch=function(){return this.transform.minPitch},p.prototype.setMaxPitch=function(g){if((g=g??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")},p.prototype.getMaxPitch=function(){return this.transform.maxPitch},p.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},p.prototype.setRenderWorldCopies=function(g){return this.transform.renderWorldCopies=g,this._update()},p.prototype.project=function(g){return this.transform.locationPoint(v.LngLat.convert(g))},p.prototype.unproject=function(g){return this.transform.pointLocation(v.Point.convert(g))},p.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},p.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},p.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},p.prototype._createDelegatedListener=function(g,w,C){var T,I=this;if("mouseenter"===g||"mouseover"===g){var R=!1;return{layer:w,listener:C,delegates:{mousemove:function(q){var W=I.getLayer(w)?I.queryRenderedFeatures(q.point,{layers:[w]}):[];W.length?R||(R=!0,C.call(I,new Ui(g,I,q.originalEvent,{features:W}))):R=!1},mouseout:function(){R=!1}}}}if("mouseleave"===g||"mouseout"===g){var L=!1;return{layer:w,listener:C,delegates:{mousemove:function(q){(I.getLayer(w)?I.queryRenderedFeatures(q.point,{layers:[w]}):[]).length?L=!0:L&&(L=!1,C.call(I,new Ui(g,I,q.originalEvent)))},mouseout:function(q){L&&(L=!1,C.call(I,new Ui(g,I,q.originalEvent)))}}}}return{layer:w,listener:C,delegates:(T={},T[g]=function(q){var W=I.getLayer(w)?I.queryRenderedFeatures(q.point,{layers:[w]}):[];W.length&&(q.features=W,C.call(I,q),delete q.features)},T)}},p.prototype.on=function(g,w,C){if(void 0===C)return d.prototype.on.call(this,g,w);var T=this._createDelegatedListener(g,w,C);for(var I in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(T),T.delegates)this.on(I,T.delegates[I]);return this},p.prototype.once=function(g,w,C){if(void 0===C)return d.prototype.once.call(this,g,w);var T=this._createDelegatedListener(g,w,C);for(var I in T.delegates)this.once(I,T.delegates[I]);return this},p.prototype.off=function(g,w,C){var T=this;return void 0===C?d.prototype.off.call(this,g,w):(this._delegatedListeners&&this._delegatedListeners[g]&&function(I){for(var R=I[g],L=0;L<R.length;L++){var q=R[L];if(q.layer===w&&q.listener===C){for(var W in q.delegates)T.off(W,q.delegates[W]);return R.splice(L,1),T}}}(this._delegatedListeners),this)},p.prototype.queryRenderedFeatures=function(g,w){if(!this.style)return[];var C;if(void 0!==w||void 0===g||g instanceof v.Point||Array.isArray(g)||(w=g,g=void 0),w=w||{},(g=g||[[0,0],[this.transform.width,this.transform.height]])instanceof v.Point||"number"==typeof g[0])C=[v.Point.convert(g)];else{var T=v.Point.convert(g[0]),I=v.Point.convert(g[1]);C=[T,new v.Point(I.x,T.y),I,new v.Point(T.x,I.y),T]}return this.style.queryRenderedFeatures(C,w,this.transform)},p.prototype.querySourceFeatures=function(g,w){return this.style.querySourceFeatures(g,w)},p.prototype.setStyle=function(g,w){return!1!==(w=v.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},w)).diff&&w.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,w),this):(this._localIdeographFontFamily=w.localIdeographFontFamily,this._updateStyle(g,w))},p.prototype.setTransformRequest=function(g){return this._requestManager.setTransformRequest(g),this},p.prototype._getUIString=function(g){var w=this._locale[g];if(null==w)throw new Error("Missing UI string '"+g+"'");return w},p.prototype._updateStyle=function(g,w){return this.style&&(this.style.setEventedParent(null),this.style._remove()),g?(this.style=new Ql(this,w||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g),this):(delete this.style,this)},p.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ql(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},p.prototype._diffStyle=function(g,w){var C=this;if("string"==typeof g){var T=this._requestManager.normalizeStyleURL(g),I=this._requestManager.transformRequest(T,v.ResourceType.Style);v.getJSON(I,function(R,L){R?C.fire(new v.ErrorEvent(R)):L&&C._updateDiff(L,w)})}else"object"==typeof g&&this._updateDiff(g,w)},p.prototype._updateDiff=function(g,w){try{this.style.setState(g)&&this._update(!0)}catch(C){v.warnOnce("Unable to perform style diff: "+(C.message||C.error||C)+".  Rebuilding the style from scratch."),this._updateStyle(g,w)}},p.prototype.getStyle=function(){if(this.style)return this.style.serialize()},p.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():v.warnOnce("There is no style added to the map.")},p.prototype.addSource=function(g,w){return this._lazyInitEmptyStyle(),this.style.addSource(g,w),this._update(!0)},p.prototype.isSourceLoaded=function(g){var w=this.style&&this.style.sourceCaches[g];if(void 0!==w)return w.loaded();this.fire(new v.ErrorEvent(new Error("There is no source with ID '"+g+"'")))},p.prototype.areTilesLoaded=function(){var g=this.style&&this.style.sourceCaches;for(var w in g){var C=g[w]._tiles;for(var T in C){var I=C[T];if("loaded"!==I.state&&"errored"!==I.state)return!1}}return!0},p.prototype.addSourceType=function(g,w,C){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,w,C)},p.prototype.removeSource=function(g){return this.style.removeSource(g),this._update(!0)},p.prototype.getSource=function(g){return this.style.getSource(g)},p.prototype.addImage=function(g,w,C){void 0===C&&(C={});var T=C.pixelRatio;void 0===T&&(T=1);var I=C.sdf;void 0===I&&(I=!1);var R=C.stretchX,L=C.stretchY,q=C.content;if(this._lazyInitEmptyStyle(),w instanceof ki||cs&&w instanceof cs){var W=v.browser.getImageData(w);this.style.addImage(g,{data:new v.RGBAImage({width:W.width,height:W.height},W.data),pixelRatio:T,stretchX:R,stretchY:L,content:q,sdf:I,version:0})}else{if(void 0===w.width||void 0===w.height)return this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var H=w;this.style.addImage(g,{data:new v.RGBAImage({width:w.width,height:w.height},new Uint8Array(w.data)),pixelRatio:T,stretchX:R,stretchY:L,content:q,sdf:I,version:0,userImage:H}),H.onAdd&&H.onAdd(this,g)}},p.prototype.updateImage=function(g,w){var C=this.style.getImage(g);if(!C)return this.fire(new v.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var T=w instanceof ki||cs&&w instanceof cs?v.browser.getImageData(w):w,I=T.width,R=T.height,L=T.data;return void 0===I||void 0===R?this.fire(new v.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):I!==C.data.width||R!==C.data.height?this.fire(new v.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(C.data.replace(L,!(w instanceof ki||cs&&w instanceof cs)),void this.style.updateImage(g,C))},p.prototype.hasImage=function(g){return g?!!this.style.getImage(g):(this.fire(new v.ErrorEvent(new Error("Missing required image id"))),!1)},p.prototype.removeImage=function(g){this.style.removeImage(g)},p.prototype.loadImage=function(g,w){v.getImage(this._requestManager.transformRequest(g,v.ResourceType.Image),w)},p.prototype.listImages=function(){return this.style.listImages()},p.prototype.addLayer=function(g,w){return this._lazyInitEmptyStyle(),this.style.addLayer(g,w),this._update(!0)},p.prototype.moveLayer=function(g,w){return this.style.moveLayer(g,w),this._update(!0)},p.prototype.removeLayer=function(g){return this.style.removeLayer(g),this._update(!0)},p.prototype.getLayer=function(g){return this.style.getLayer(g)},p.prototype.setLayerZoomRange=function(g,w,C){return this.style.setLayerZoomRange(g,w,C),this._update(!0)},p.prototype.setFilter=function(g,w,C){return void 0===C&&(C={}),this.style.setFilter(g,w,C),this._update(!0)},p.prototype.getFilter=function(g){return this.style.getFilter(g)},p.prototype.setPaintProperty=function(g,w,C,T){return void 0===T&&(T={}),this.style.setPaintProperty(g,w,C,T),this._update(!0)},p.prototype.getPaintProperty=function(g,w){return this.style.getPaintProperty(g,w)},p.prototype.setLayoutProperty=function(g,w,C,T){return void 0===T&&(T={}),this.style.setLayoutProperty(g,w,C,T),this._update(!0)},p.prototype.getLayoutProperty=function(g,w){return this.style.getLayoutProperty(g,w)},p.prototype.setLight=function(g,w){return void 0===w&&(w={}),this._lazyInitEmptyStyle(),this.style.setLight(g,w),this._update(!0)},p.prototype.getLight=function(){return this.style.getLight()},p.prototype.setFeatureState=function(g,w){return this.style.setFeatureState(g,w),this._update()},p.prototype.removeFeatureState=function(g,w){return this.style.removeFeatureState(g,w),this._update()},p.prototype.getFeatureState=function(g){return this.style.getFeatureState(g)},p.prototype.getContainer=function(){return this._container},p.prototype.getCanvasContainer=function(){return this._canvasContainer},p.prototype.getCanvas=function(){return this._canvas},p.prototype._containerDimensions=function(){var g=0,w=0;return this._container&&(g=this._container.clientWidth||400,w=this._container.clientHeight||300),[g,w]},p.prototype._setupContainer=function(){var g=this._container;g.classList.add("maplibregl-map","mapboxgl-map");var w=this._canvasContainer=ze.create("div","maplibregl-canvas-container mapboxgl-canvas-container",g);this._interactive&&w.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ze.create("canvas","maplibregl-canvas mapboxgl-canvas",w),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var C=this._containerDimensions();this._resizeCanvas(C[0],C[1]);var T=this._controlContainer=ze.create("div","maplibregl-control-container mapboxgl-control-container",g),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(R){I[R]=ze.create("div","maplibregl-ctrl-"+R+" mapboxgl-ctrl-"+R,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},p.prototype._resizeCanvas=function(g,w){var C=v.browser.devicePixelRatio||1;this._canvas.width=C*g,this._canvas.height=C*w,this._canvas.style.width=g+"px",this._canvas.style.height=w+"px"},p.prototype._setupPainter=function(){var g=v.extend({},Zo.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),w=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);w?(this.painter=new dr(w,this.transform),v.webpSupported.testSupport(w)):this.fire(new v.ErrorEvent(new Error("Failed to initialize WebGL")))},p.prototype._contextLost=function(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new v.Event("webglcontextlost",{originalEvent:g}))},p.prototype._contextRestored=function(g){this._setupPainter(),this.resize(),this._update(),this.fire(new v.Event("webglcontextrestored",{originalEvent:g}))},p.prototype._onMapScroll=function(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},p.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},p.prototype._update=function(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this},p.prototype._requestRenderFrame=function(g){return this._update(),this._renderTaskQueue.add(g)},p.prototype._cancelRenderFrame=function(g){this._renderTaskQueue.remove(g)},p.prototype._render=function(g){var w,C=this,T=0,I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(w=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,w),T=v.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),!this._removed){var R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var L=this.transform.zoom,q=v.browser.now();this.style.zoomHistory.update(L,q);var W=new v.EvaluationParameters(L,{now:q,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),H=W.crossFadingFactor();1===H&&H===this._crossFadingFactor||(R=!0,this._crossFadingFactor=H),this.style.update(W)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new v.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new v.Event("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var oe=v.browser.now()-T;I.endQueryEXT(I.TIME_ELAPSED_EXT,w),setTimeout(function(){var re=I.getQueryObjectEXT(w,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(w),C.fire(new v.Event("gpu-timing-frame",{cpuTime:oe,gpuTime:re}))},50)}if(this.listens("gpu-timing-layer")){var ne=this.painter.collectGpuTimers();setTimeout(function(){var re=C.painter.queryGpuTimers(ne);C.fire(new v.Event("gpu-timing-layer",{layerTimes:re}))},50)}var de=this._sourcesDirty||this._styleDirty||this._placementDirty;return de||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new v.Event("idle")),!this._loaded||this._fullyLoaded||de||(this._fullyLoaded=!0),this}},p.prototype.remove=function(){this._hash&&this._hash.remove();for(var g=0,w=this._controls;g<w.length;g+=1)w[g].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==v.window&&(v.window.removeEventListener("resize",this._onWindowResize,!1),v.window.removeEventListener("orientationchange",this._onWindowResize,!1),v.window.removeEventListener("online",this._onWindowOnline,!1));var C=this.painter.context.gl.getExtension("WEBGL_lose_context");C&&C.loseContext(),vo(this._canvasContainer),vo(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),this._removed=!0,this.fire(new v.Event("remove"))},p.prototype.triggerRepaint=function(){var g=this;this.style&&!this._frame&&(this._frame=v.browser.frame(function(w){g._frame=null,g._render(w)}))},p.prototype._onWindowOnline=function(){this._update()},p.prototype._onWindowResize=function(g){this._trackResize&&this.resize({originalEvent:g})._update()},h.showTileBoundaries.get=function(){return!!this._showTileBoundaries},h.showTileBoundaries.set=function(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())},h.showPadding.get=function(){return!!this._showPadding},h.showPadding.set=function(g){this._showPadding!==g&&(this._showPadding=g,this._update())},h.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},h.showCollisionBoxes.set=function(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())},h.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},h.showOverdrawInspector.set=function(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())},h.repaint.get=function(){return!!this._repaint},h.repaint.set=function(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())},h.vertices.get=function(){return!!this._vertices},h.vertices.set=function(g){this._vertices=g,this._update()},p.prototype._setCacheLimits=function(g,w){v.setCacheLimits(g,w)},h.version.get=function(){return v.version},Object.defineProperties(p.prototype,h),p}(Nt);function vo(d){d.parentNode&&d.parentNode.removeChild(d)}var Gu={showCompass:!0,showZoom:!0,visualizePitch:!1},ao=function(d){var p=this;this.options=v.extend({},Gu,d),this._container=ze.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(h){return h.preventDefault()}),this.options.showZoom&&(v.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",function(h){return p._map.zoomIn({},{originalEvent:h})}),ze.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",function(h){return p._map.zoomOut({},{originalEvent:h})}),ze.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(v.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",function(h){p.options.visualizePitch?p._map.resetNorthPitch({},{originalEvent:h}):p._map.resetNorth({},{originalEvent:h})}),this._compassIcon=ze.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ao.prototype._updateZoomButtons=function(){var d=this._map.getZoom(),p=d===this._map.getMaxZoom(),h=d===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},ao.prototype._rotateCompassArrow=function(){var d=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=d},ao.prototype.onAdd=function(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ki(this._map,this._compass,this.options.visualizePitch)),this._container},ao.prototype.onRemove=function(){ze.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ao.prototype._createButton=function(d,p){var h=ze.create("button",d,this._container);return h.type="button",h.addEventListener("click",p),h},ao.prototype._setButtonTitle=function(d,p){var h=this._map._getUIString("NavigationControl."+p);d.title=h,d.setAttribute("aria-label",h)};var Ki=function(d,p,h){void 0===h&&(h=!1),this._clickTolerance=10,this.element=p,this.mouseRotate=new Qr({clickTolerance:d.dragRotate._mouseRotate._clickTolerance}),this.map=d,h&&(this.mousePitch=new Ke({clickTolerance:d.dragRotate._mousePitch._clickTolerance})),v.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ze.addEventListener(p,"mousedown",this.mousedown),ze.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),ze.addEventListener(p,"touchmove",this.touchmove),ze.addEventListener(p,"touchend",this.touchend),ze.addEventListener(p,"touchcancel",this.reset)};function us(d,p,h){if(d=new v.LngLat(d.lng,d.lat),p){var g=new v.LngLat(d.lng-360,d.lat),w=new v.LngLat(d.lng+360,d.lat),C=h.locationPoint(d).distSqr(p);h.locationPoint(g).distSqr(p)<C?d=g:h.locationPoint(w).distSqr(p)<C&&(d=w)}for(;Math.abs(d.lng-h.center.lng)>180;){var T=h.locationPoint(d);if(T.x>=0&&T.y>=0&&T.x<=h.width&&T.y<=h.height)break;d.lng>h.center.lng?d.lng-=360:d.lng+=360}return d}Ki.prototype.down=function(d,p){this.mouseRotate.mousedown(d,p),this.mousePitch&&this.mousePitch.mousedown(d,p),ze.disableDrag()},Ki.prototype.move=function(d,p){var h=this.map,g=this.mouseRotate.mousemoveWindow(d,p);if(g&&g.bearingDelta&&h.setBearing(h.getBearing()+g.bearingDelta),this.mousePitch){var w=this.mousePitch.mousemoveWindow(d,p);w&&w.pitchDelta&&h.setPitch(h.getPitch()+w.pitchDelta)}},Ki.prototype.off=function(){var d=this.element;ze.removeEventListener(d,"mousedown",this.mousedown),ze.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),ze.removeEventListener(d,"touchmove",this.touchmove),ze.removeEventListener(d,"touchend",this.touchend),ze.removeEventListener(d,"touchcancel",this.reset),this.offTemp()},Ki.prototype.offTemp=function(){ze.enableDrag(),ze.removeEventListener(v.window,"mousemove",this.mousemove),ze.removeEventListener(v.window,"mouseup",this.mouseup)},Ki.prototype.mousedown=function(d){this.down(v.extend({},d,{ctrlKey:!0,preventDefault:function(){return d.preventDefault()}}),ze.mousePos(this.element,d)),ze.addEventListener(v.window,"mousemove",this.mousemove),ze.addEventListener(v.window,"mouseup",this.mouseup)},Ki.prototype.mousemove=function(d){this.move(d,ze.mousePos(this.element,d))},Ki.prototype.mouseup=function(d){this.mouseRotate.mouseupWindow(d),this.mousePitch&&this.mousePitch.mouseupWindow(d),this.offTemp()},Ki.prototype.touchstart=function(d){1!==d.targetTouches.length?this.reset():(this._startPos=this._lastPos=ze.touchPos(this.element,d.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return d.preventDefault()}},this._startPos))},Ki.prototype.touchmove=function(d){1!==d.targetTouches.length?this.reset():(this._lastPos=ze.touchPos(this.element,d.targetTouches)[0],this.move({preventDefault:function(){return d.preventDefault()}},this._lastPos))},Ki.prototype.touchend=function(d){0===d.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ki.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ds={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function oc(d,p,h){var g=d.classList;for(var w in ds)g.remove("maplibregl-"+h+"-anchor-"+w,"mapboxgl-"+h+"-anchor-"+w);g.add("maplibregl-"+h+"-anchor-"+p,"mapboxgl-"+h+"-anchor-"+p)}var Yd,Ps=function(d){function p(h,g){if(d.call(this),(h instanceof v.window.HTMLElement||g)&&(h=v.extend({element:h},g)),v.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&"auto"!==h.pitchAlignment?h.pitchAlignment:this._rotationAlignment,h&&h.element)this._element=h.element,this._offset=v.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=ze.create("div"),this._element.setAttribute("aria-label","Map marker");var w=ze.createNS("http://www.w3.org/2000/svg","svg");w.setAttributeNS(null,"display","block"),w.setAttributeNS(null,"height","41px"),w.setAttributeNS(null,"width","27px"),w.setAttributeNS(null,"viewBox","0 0 27 41");var C=ze.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"stroke","none"),C.setAttributeNS(null,"stroke-width","1"),C.setAttributeNS(null,"fill","none"),C.setAttributeNS(null,"fill-rule","evenodd");var T=ze.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");var I=ze.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");for(var R=0,L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];R<L.length;R+=1){var q=L[R],W=ze.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",q.rx),W.setAttributeNS(null,"ry",q.ry),I.appendChild(W)}var H=ze.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);var oe=ze.createNS("http://www.w3.org/2000/svg","path");oe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(oe);var ne=ze.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"opacity","0.25"),ne.setAttributeNS(null,"fill","#000000");var de=ze.createNS("http://www.w3.org/2000/svg","path");de.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ne.appendChild(de);var re=ze.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(6.0, 7.0)"),re.setAttributeNS(null,"fill","#FFFFFF");var ae=ze.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ge=ze.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");var be=ze.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ae.appendChild(ge),ae.appendChild(be),T.appendChild(I),T.appendChild(H),T.appendChild(ne),T.appendChild(re),T.appendChild(ae),w.appendChild(T),w.setAttributeNS(null,"height",41*this._scale+"px"),w.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(w),this._offset=v.Point.convert(h&&h.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ae){Ae.preventDefault()}),this._element.addEventListener("mousedown",function(Ae){Ae.preventDefault()}),oc(this._element,this._anchor,"marker"),this._popup=null}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.addTo=function(h){return this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._update),h.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},p.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ze.remove(this._element),this._popup&&this._popup.remove(),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},p.prototype.getElement=function(){return this._element},p.prototype.setPopup=function(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){var g=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(24.6+g)],"bottom-right":[-g,-1*(24.6+g)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},p.prototype._onKeyPress=function(h){var g=h.code,w=h.charCode||h.keyCode;"Space"!==g&&"Enter"!==g&&32!==w&&13!==w||this.togglePopup()},p.prototype._onMapClick=function(h){var g=h.originalEvent.target,w=this._element;this._popup&&(g===w||w.contains(g))&&this.togglePopup()},p.prototype.getPopup=function(){return this._popup},p.prototype.togglePopup=function(){var h=this._popup;return h?(h.isOpen()?h.remove():h.addTo(this._map),this):this},p.prototype._update=function(h){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var g="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?g="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(g="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var w="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?w="rotateX(0deg)":"map"===this._pitchAlignment&&(w="rotateX("+this._map.getPitch()+"deg)"),h&&"moveend"!==h.type||(this._pos=this._pos.round()),ze.setTransform(this._element,ds[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+w+" "+g)}},p.prototype.getOffset=function(){return this._offset},p.prototype.setOffset=function(h){return this._offset=v.Point.convert(h),this._update(),this},p.prototype._onMove=function(h){if(!this._isDragging){var g=this._clickTolerance||this._map._clickTolerance;this._isDragging=h.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=h.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new v.Event("dragstart"))),this.fire(new v.Event("drag")))},p.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new v.Event("dragend")),this._state="inactive"},p.prototype._addDragHandler=function(h){this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(this._pos).add(this._offset),this._pointerdownPos=h.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},p.prototype.setDraggable=function(h){return this._draggable=!!h,this._map&&(h?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},p.prototype.isDraggable=function(){return this._draggable},p.prototype.setRotation=function(h){return this._rotation=h||0,this._update(),this},p.prototype.getRotation=function(){return this._rotation},p.prototype.setRotationAlignment=function(h){return this._rotationAlignment=h||"auto",this._update(),this},p.prototype.getRotationAlignment=function(){return this._rotationAlignment},p.prototype.setPitchAlignment=function(h){return this._pitchAlignment=h&&"auto"!==h?h:this._rotationAlignment,this._update(),this},p.prototype.getPitchAlignment=function(){return this._pitchAlignment},p}(v.Evented),Cf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Df=0,sc=!1,Wu=function(d){function p(h){d.call(this),this.options=v.extend({},Cf,h),v.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.onAdd=function(h){var g;return this._map=h,this._container=ze.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),g=this._setupUI,void 0!==Yd?g(Yd):void 0!==v.window.navigator.permissions?v.window.navigator.permissions.query({name:"geolocation"}).then(function(w){g(Yd="denied"!==w.state)}):g(Yd=!!v.window.navigator.geolocation),this._container},p.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ze.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Df=0,sc=!1},p.prototype._isOutOfMapMaxBounds=function(h){var g=this._map.getMaxBounds(),w=h.coords;return g&&(w.longitude<g.getWest()||w.longitude>g.getEast()||w.latitude<g.getSouth()||w.latitude>g.getNorth())},p.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}},p.prototype._onSuccess=function(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new v.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(h),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("geolocate",h)),this._finish()}},p.prototype._updateCamera=function(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude),w=h.coords.accuracy,C=this._map.getBearing(),T=v.extend({bearing:C},this.options.fitBoundsOptions);this._map.fitBounds(g.toBounds(w),T,{geolocateSource:!0})},p.prototype._updateMarker=function(h){if(h){var g=new v.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(g).addTo(this._map),this._userLocationDotMarker.setLngLat(g).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},p.prototype._updateCircleRadius=function(){var h=this._map._container.clientHeight/2,g=this._map.unproject([0,h]),w=this._map.unproject([1,h]),C=g.distanceTo(w),T=Math.ceil(2*this._accuracy/C);this._circleElement.style.width=T+"px",this._circleElement.style.height=T+"px"},p.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},p.prototype._onError=function(h){if(this._map){if(this.options.trackUserLocation)if(1===h.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===h.code&&sc)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new v.Event("error",h)),this._finish()}},p.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},p.prototype._setupUI=function(h){var g=this;if(this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this._geolocateButton=ze.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ze.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===h){v.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var w=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=w,this._geolocateButton.setAttribute("aria-label",w)}else{var C=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=C,this._geolocateButton.setAttribute("aria-label",C)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ze.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ps(this._dotElement),this._circleElement=ze.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ps({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(T){T.geolocateSource||"ACTIVE_LOCK"!==g._watchState||T.originalEvent&&"resize"===T.originalEvent.type||(g._watchState="BACKGROUND",g._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),g._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),g.fire(new v.Event("trackuserlocationend")))})},p.prototype.trigger=function(){if(!this._setup)return v.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new v.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Df--,sc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new v.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new v.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Df>1?(h={maximumAge:6e5,timeout:0},sc=!0):(h=this.options.positionOptions,sc=!1),this._geolocationWatchID=v.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else v.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},p.prototype._clearWatch=function(){v.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},p}(v.Evented),Vg={maxWidth:100,unit:"metric"},Gs=function(d){this.options=v.extend({},Vg,d),v.bindAll(["_onMove","setUnit"],this)};function Gp(d,p,h){var g=h&&h.maxWidth||100,w=d._container.clientHeight/2,C=d.unproject([0,w]),T=d.unproject([g,w]),I=C.distanceTo(T);if(h&&"imperial"===h.unit){var R=3.2808*I;R>5280?Ku(p,g,R/5280,d._getUIString("ScaleControl.Miles")):Ku(p,g,R,d._getUIString("ScaleControl.Feet"))}else h&&"nautical"===h.unit?Ku(p,g,I/1852,d._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Ku(p,g,I/1e3,d._getUIString("ScaleControl.Kilometers")):Ku(p,g,I,d._getUIString("ScaleControl.Meters"))}function Ku(d,p,h,g){var w,C,T,R,L,I=(w=h,(C=Math.pow(10,(""+Math.floor(w)).length-1))*(T=(T=w/C)>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(R=T,L=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10)),Math.round(R*L)/L)));d.style.width=p*(I/h)+"px",d.innerHTML=I+"&nbsp;"+g}Gs.prototype.getDefaultPosition=function(){return"bottom-left"},Gs.prototype._onMove=function(){Gp(this._map,this._container,this.options)},Gs.prototype.onAdd=function(d){return this._map=d,this._container=ze.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Gs.prototype.onRemove=function(){ze.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Gs.prototype.setUnit=function(d){this.options.unit=d,Gp(this._map,this._container,this.options)};var Ws=function(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof v.window.HTMLElement?this._container=d.container:v.warnOnce("Full screen control 'container' must be a DOM element.")),v.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in v.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in v.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in v.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in v.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ws.prototype.onAdd=function(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=ze.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",v.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ws.prototype.onRemove=function(){ze.remove(this._controlContainer),this._map=null,v.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ws.prototype._checkFullscreenSupport=function(){return!!(v.window.document.fullscreenEnabled||v.window.document.mozFullScreenEnabled||v.window.document.msFullscreenEnabled||v.window.document.webkitFullscreenEnabled)},Ws.prototype._setupUI=function(){var d=this._fullscreenButton=ze.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ze.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",d).setAttribute("aria-hidden",!0),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),v.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ws.prototype._updateTitle=function(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d},Ws.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ws.prototype._isFullscreen=function(){return this._fullscreen},Ws.prototype._changeIcon=function(){(v.window.document.fullscreenElement||v.window.document.mozFullScreenElement||v.window.document.webkitFullscreenElement||v.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ws.prototype._onClickFullscreen=function(){this._isFullscreen()?v.window.document.exitFullscreen?v.window.document.exitFullscreen():v.window.document.mozCancelFullScreen?v.window.document.mozCancelFullScreen():v.window.document.msExitFullscreen?v.window.document.msExitFullscreen():v.window.document.webkitCancelFullScreen&&v.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var zg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Tf=function(d){function p(h){d.call(this),this.options=v.extend(Object.create(zg),h),v.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return d&&(p.__proto__=d),(p.prototype=Object.create(d&&d.prototype)).constructor=p,p.prototype.addTo=function(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new v.Event("open")),this},p.prototype.isOpen=function(){return!!this._map},p.prototype.remove=function(){return this._content&&ze.remove(this._content),this._container&&(ze.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new v.Event("close")),this},p.prototype.getLngLat=function(){return this._lngLat},p.prototype.setLngLat=function(h){return this._lngLat=v.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this},p.prototype.getElement=function(){return this._container},p.prototype.setText=function(h){return this.setDOMContent(v.window.document.createTextNode(h))},p.prototype.setHTML=function(h){var g,w=v.window.document.createDocumentFragment(),C=v.window.document.createElement("body");for(C.innerHTML=h;g=C.firstChild;)w.appendChild(g);return this.setDOMContent(w)},p.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},p.prototype.setMaxWidth=function(h){return this.options.maxWidth=h,this._update(),this},p.prototype.setDOMContent=function(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ze.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this},p.prototype.addClassName=function(h){this._container&&this._container.classList.add(h)},p.prototype.removeClassName=function(h){this._container&&this._container.classList.remove(h)},p.prototype.setOffset=function(h){return this.options.offset=h,this._update(),this},p.prototype.toggleClassName=function(h){if(this._container)return this._container.classList.toggle(h)},p.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=ze.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},p.prototype._onMouseUp=function(h){this._update(h.point)},p.prototype._onMouseMove=function(h){this._update(h.point)},p.prototype._onDrag=function(h){this._update(h.point)},p.prototype._update=function(h){var g=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=ze.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ze.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(W){return g._container.classList.add(W)}),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||h)){var w=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat),C=this.options.anchor,T=function W(H){if(H){if("number"==typeof H){var oe=Math.round(Math.sqrt(.5*Math.pow(H,2)));return{center:new v.Point(0,0),top:new v.Point(0,H),"top-left":new v.Point(oe,oe),"top-right":new v.Point(-oe,oe),bottom:new v.Point(0,-H),"bottom-left":new v.Point(oe,-oe),"bottom-right":new v.Point(-oe,-oe),left:new v.Point(H,0),right:new v.Point(-H,0)}}if(H instanceof v.Point||Array.isArray(H)){var ne=v.Point.convert(H);return{center:ne,top:ne,"top-left":ne,"top-right":ne,bottom:ne,"bottom-left":ne,"bottom-right":ne,left:ne,right:ne}}return{center:v.Point.convert(H.center||[0,0]),top:v.Point.convert(H.top||[0,0]),"top-left":v.Point.convert(H["top-left"]||[0,0]),"top-right":v.Point.convert(H["top-right"]||[0,0]),bottom:v.Point.convert(H.bottom||[0,0]),"bottom-left":v.Point.convert(H["bottom-left"]||[0,0]),"bottom-right":v.Point.convert(H["bottom-right"]||[0,0]),left:v.Point.convert(H.left||[0,0]),right:v.Point.convert(H.right||[0,0])}}return W(new v.Point(0,0))}(this.options.offset);if(!C){var I,R=this._container.offsetWidth,L=this._container.offsetHeight;I=w.y+T.bottom.y<L?["top"]:w.y>this._map.transform.height-L?["bottom"]:[],w.x<R/2?I.push("left"):w.x>this._map.transform.width-R/2&&I.push("right"),C=0===I.length?"bottom":I.join("-")}var q=w.add(T[C]).round();ze.setTransform(this._container,ds[C]+" translate("+q.x+"px,"+q.y+"px)"),oc(this._container,C,"popup")}},p.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var h=this._container.querySelector(Wp);h&&h.focus()}},p.prototype._onClose=function(){this.remove()},p}(v.Evented),Kp={version:v.version,supported:Zo,setRTLTextPlugin:v.setRTLTextPlugin,getRTLTextPluginStatus:v.getRTLTextPluginStatus,Map:En,NavigationControl:ao,GeolocateControl:Wu,AttributionControl:gi,ScaleControl:Gs,FullscreenControl:Ws,Popup:Tf,Marker:Ps,Style:Ql,LngLat:v.LngLat,LngLatBounds:v.LngLatBounds,Point:v.Point,MercatorCoordinate:v.MercatorCoordinate,Evented:v.Evented,config:v.config,prewarm:function(){xt().acquire(Te)},clearPrewarmedResources:function(){var d=ct;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Te),ct=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return v.config.ACCESS_TOKEN},set accessToken(d){v.config.ACCESS_TOKEN=d},get baseApiUrl(){return v.config.API_URL},set baseApiUrl(d){v.config.API_URL=d},get workerCount(){return $e.workerCount},set workerCount(d){$e.workerCount=d},get maxParallelImageRequests(){return v.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){v.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage:function(d){v.clearTileCache(d)},workerUrl:"",addProtocol:function(d,p){v.config.REGISTERED_PROTOCOLS[d]=p},removeProtocol:function(d){delete v.config.REGISTERED_PROTOCOLS[d]}};return Kp}),eo}()},681(Zy,ef,Nd){"use strict";let eo=null,Od=!1,v=1;const ze=Symbol("SIGNAL");function Tt(t){const n=eo;return eo=t,n}const zl={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ro(t){if(Od)throw new Error("");if(null===eo)return;eo.consumerOnSignalRead(t);const n=eo.producersTail;if(void 0!==n&&n.producer===t)return;let e;const r=eo.recomputing;if(r&&(e=void 0!==n?n.nextProducer:eo.producers,void 0!==e&&e.producer===t))return eo.producersTail=e,void(e.lastReadVersion=t.version);const i=t.consumersTail;if(void 0!==i&&i.consumer===eo&&(!r||function Cs(t,n){const e=n.producersTail;if(void 0!==e){let r=n.producers;do{if(r===t)return!0;if(r===e)break;r=r.nextProducer}while(void 0!==r)}return!1}(i,eo)))return;const o=fr(eo),a={producer:t,consumer:eo,nextProducer:e,prevConsumer:i,lastReadVersion:t.version,nextConsumer:void 0};eo.producersTail=a,void 0!==n?n.nextProducer=a:eo.producers=a,o&&zs(t,a)}function to(t){if((!fr(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==v)){if(!t.producerMustRecompute(t)&&!Bi(t))return void ul(t);t.producerRecomputeValue(t),ul(t)}}function Su(t){if(void 0===t.consumers)return;const n=Od;Od=!0;try{for(let e=t.consumers;void 0!==e;e=e.nextConsumer){const r=e.consumer;r.dirty||tf(r)}}finally{Od=n}}function Fi(){return!1!==eo?.consumerAllowSignalWrites}function tf(t){t.dirty=!0,Su(t),t.consumerMarkedDirty?.(t)}function ul(t){t.dirty=!1,t.lastCleanEpoch=v}function ns(t){return t&&function Iu(t){t.producersTail=void 0,t.recomputing=!0}(t),Tt(t)}function Da(t,n){Tt(n),t&&function Lc(t){t.recomputing=!1;const n=t.producersTail;let e=void 0!==n?n.nextProducer:t.producers;if(void 0!==e){if(fr(t))do{e=Ul(e)}while(void 0!==e);void 0!==n?n.nextProducer=void 0:t.producers=void 0}}(t)}function Bi(t){for(let n=t.producers;void 0!==n;n=n.nextProducer){const e=n.producer,r=n.lastReadVersion;if(r!==e.version||(to(e),r!==e.version))return!0}return!1}function Es(t){if(fr(t)){let n=t.producers;for(;void 0!==n;)n=Ul(n)}t.producers=void 0,t.producersTail=void 0,t.consumers=void 0,t.consumersTail=void 0}function zs(t,n){const e=t.consumersTail,r=fr(t);if(void 0!==e?(n.nextConsumer=e.nextConsumer,e.nextConsumer=n):(n.nextConsumer=void 0,t.consumers=n),n.prevConsumer=e,t.consumersTail=n,!r)for(let i=t.producers;void 0!==i;i=i.nextProducer)zs(i.producer,i)}function Ul(t){const n=t.producer,e=t.nextProducer,r=t.nextConsumer,i=t.prevConsumer;if(t.nextConsumer=void 0,t.prevConsumer=void 0,void 0!==r?r.prevConsumer=i:n.consumersTail=i,void 0!==i)i.nextConsumer=r;else if(n.consumers=r,!fr(n)){let o=n.producers;for(;void 0!==o;)o=Ul(o)}return e}function fr(t){return t.consumerIsAlwaysLive||void 0!==t.consumers}function jl(t,n){return Object.is(t,n)}const Ta=Symbol("UNSET"),Ds=Symbol("COMPUTING"),no=Symbol("ERRORED"),Sa={...zl,value:Ta,dirty:!0,error:null,equal:jl,kind:"computed",producerMustRecompute:t=>t.value===Ta||t.value===Ds,producerRecomputeValue(t){if(t.value===Ds)throw new Error("");const n=t.value;t.value=Ds;const e=ns(t);let r,i=!1;try{r=t.computation(),Tt(null),i=n!==Ta&&n!==no&&r!==no&&t.equal(n,r)}catch(o){r=no,t.error=o}finally{Da(t,e)}i?t.value=n:(t.value=r,t.version++)}};let Hl=function Fc(){throw new Error};function dl(t){Hl(t)}function hl(t,n){const e=Object.create(ka);e.value=t,void 0!==n&&(e.equal=n);const r=()=>function Ia(t){return Ro(t),t.value}(e);return r[ze]=e,[r,a=>fl(e,a),a=>function Us(t,n){Fi()||dl(t),fl(t,n(t.value))}(e,a)]}function fl(t,n){Fi()||dl(t),t.equal(t.value,n)||(t.value=n,function No(t){t.version++,function Oc(){v++}(),Su(t)}(t))}const ka={...zl,equal:jl,value:void 0,kind:"signal"},Lp={...zl,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"};function pr(t){return"function"==typeof t}function rs(t){const e=t(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const pl=rs(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function ml(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class Wn{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(pr(r))try{r()}catch(o){n=o instanceof pl?o.errors:[o]}const{_teardowns:i}=this;if(i){this._teardowns=null;for(const o of i)try{Hs(o)}catch(a){n=n??[],a instanceof pl?n=[...n,...a.errors]:n.push(a)}}if(n)throw new pl(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Hs(n);else{if(n instanceof Wn){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._teardowns=null!==(e=this._teardowns)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&ml(e,n)}remove(n){const{_teardowns:e}=this;e&&ml(e,n),n instanceof Wn&&n._removeParent(this)}}Wn.EMPTY=(()=>{const t=new Wn;return t.closed=!0,t})();const Ts=Wn.EMPTY;function $l(t){return t instanceof Wn||t&&"closed"in t&&pr(t.remove)&&pr(t.add)&&pr(t.unsubscribe)}function Hs(t){pr(t)?t():t.unsubscribe()}const Aa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Bc={setTimeout(...t){const{delegate:n}=Bc;return(n?.setTimeout||setTimeout)(...t)},clearTimeout(t){const{delegate:n}=Bc;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Au(t){Bc.setTimeout(()=>{const{onUnhandledError:n}=Aa;if(!n)throw t;n(t)})}function Ma(){}const Mu=Vc("C",void 0,void 0);function Vc(t,n,e){return{kind:t,value:n,error:e}}let Ss=null;function ql(t){if(Aa.useDeprecatedSynchronousErrorHandling){const n=!Ss;if(n&&(Ss={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:r}=Ss;if(Ss=null,e)throw r}}else t()}class Pu extends Wn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,$l(n)&&n.add(this)):this.destination=zc}static create(n,e,r){return new Fd(n,e,r)}next(n){this.isStopped?Ra(function Ru(t){return Vc("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Ra(function nf(t){return Vc("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Ra(Mu,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Fd extends Pu{constructor(n,e,r){let i;if(super(),pr(n))i=n;else if(n){let o;({next:i,error:e,complete:r}=n),this&&Aa.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe()):o=n,i=i?.bind(o),e=e?.bind(o),r=r?.bind(o)}this.destination={next:i?gl(i):Ma,error:gl(e??Gl),complete:r?gl(r):Ma}}}function gl(t,n){return(...e)=>{try{t(...e)}catch(r){Aa.useDeprecatedSynchronousErrorHandling?function Ld(t){Aa.useDeprecatedSynchronousErrorHandling&&Ss&&(Ss.errorThrown=!0,Ss.error=t)}(r):Au(r)}}}function Gl(t){throw t}function Ra(t,n){const{onStoppedNotification:e}=Aa;e&&Bc.setTimeout(()=>e(t,n))}const zc={closed:!0,next:Ma,error:Gl,complete:Ma},Wl="function"==typeof Symbol&&Symbol.observable||"@@observable";function tr(t){return t}function z(t){return 0===t.length?tr:1===t.length?t[0]:function(e){return t.reduce((r,i)=>i(r),e)}}let U=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,i){const o=function me(t){return t&&t instanceof Pu||function ie(t){return t&&pr(t.next)&&pr(t.error)&&pr(t.complete)}(t)&&$l(t)}(e)?e:new Fd(e,r,i);return ql(()=>{const{operator:a,source:c}=this;o.add(a?a.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=K(r))((i,o)=>{let a;a=this.subscribe(c=>{try{e(c)}catch(f){o(f),a?.unsubscribe()}},o,i)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[Wl](){return this}pipe(...e){return z(e)(this)}toPromise(e){return new(e=K(e))((r,i)=>{let o;this.subscribe(a=>o=a,a=>i(a),()=>r(o))})}}return t.create=n=>new t(n),t})();function K(t){var n;return null!==(n=t??Aa.Promise)&&void 0!==n?n:Promise}const _e=rs(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ue,J=(()=>{class t extends U{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Z(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new _e}next(e){ql(()=>{if(this._throwIfClosed(),!this.isStopped){const r=this.observers.slice();for(const i of r)i.next(e)}})}error(e){ql(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){ql(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:i,observers:o}=this;return r||i?Ts:(o.push(e),new Wn(()=>ml(o,e)))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:i,isStopped:o}=this;r?e.error(i):o&&e.complete()}asObservable(){const e=new U;return e.source=this,e}}return t.create=(n,e)=>new Z(n,e),t})();class Z extends J{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,n)}error(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==r?r:Ts}}class se extends J{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}function Je(){return Ue}function Te(t){const n=Ue;return Ue=t,n}const ct=Symbol("NotFound");function xt(t){return t===ct||"\u0275NotFound"===t?.name}Error;const en="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class ue extends Error{code;constructor(n,e){super(jt(n,e)),this.code=n}}function jt(t,n){return`${function ur(t){return`NG0${Math.abs(t)}`}(t)}${n?": "+n:""}`}const an=globalThis;function pt(t){for(let n in t)if(t[n]===pt)return n;throw Error("")}function Fr(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function xn(t){if("string"==typeof t)return t;if(Array.isArray(t))return`[${t.map(xn).join(", ")}]`;if(null==t)return""+t;const n=t.overriddenName||t.name;if(n)return`${n}`;const e=t.toString();if(null==e)return""+e;const r=e.indexOf("\n");return r>=0?e.slice(0,r):e}function fn(t,n){return t?n?`${t} ${n}`:t:n||""}const wn=pt({__forward_ref__:pt});function Kn(t){return t.__forward_ref__=Kn,t.toString=function(){return xn(this())},t}function mn(t){return ii(t)?t():t}function ii(t){return"function"==typeof t&&t.hasOwnProperty(wn)&&t.__forward_ref__===Kn}function je(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function jr(t){return{providers:t.providers||[],imports:t.imports||[]}}function rf(t){return function Xy(t,n){return t.hasOwnProperty(n)&&t[n]||null}(t,Hc)}function jc(t){return t&&t.hasOwnProperty($c)?t[$c]:null}const Hc=pt({\u0275prov:pt}),$c=pt({\u0275inj:pt});class Fe{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(n,e){this._desc=n,this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=je({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Vd(t){return t&&!!t.\u0275providers}const af=pt({\u0275cmp:pt}),zp=pt({\u0275dir:pt}),Up=pt({\u0275pipe:pt}),jp=pt({\u0275mod:pt}),Jl=pt({\u0275fac:pt}),zd=pt({__NG_ELEMENT_ID__:pt}),Lu=pt({__NG_ENV_ID__:pt});function ss(t){return Na(t),t[jp]||null}function ln(t){return Na(t),t[af]||null}function oi(t){return Na(t),t[zp]||null}function oo(t){return Na(t),t[Up]||null}function Na(t,n){if(null==t)throw new ue(-919,!1)}function tn(t){return"string"==typeof t?t:null==t?"":String(t)}const cf=pt({ngErrorCode:pt}),yr=pt({ngErrorMessage:pt}),Oa=pt({ngTokenPath:pt});function Bu(t,n){return _l("",-200,n)}function uf(t,n){throw new ue(-201,!1)}function _l(t,n,e){const r=new ue(n,t);return r[cf]=n,r[yr]=t,e&&(r[Oa]=e),r}let df;function hf(){return df}function Si(t){const n=df;return df=t,n}function ff(t,n,e){const r=rf(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:8&e?null:void 0!==n?n:void uf()}const La={};class mr{injector;constructor(n){this.injector=n}retrieve(n,e){const r=Hd(e)||0;try{return this.injector.get(n,8&r?null:La,r)}catch(i){if(xt(i))return i;throw i}}}function pf(t,n=0){const e=Je();if(void 0===e)throw new ue(-203,!1);if(null===e)return ff(t,void 0,n);{const r=function $d(t){return{optional:!!(8&t),host:!!(1&t),self:!!(2&t),skipSelf:!!(4&t)}}(n),i=e.retrieve(t,r);if(xt(i)){if(r.optional)return null;throw i}return i}}function Dt(t,n=0){return(hf()||pf)(mn(t),n)}function X(t,n){return Dt(t,Hd(n))}function Hd(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function mf(t){const n=[];for(let e=0;e<t.length;e++){const r=mn(t[e]);if(Array.isArray(r)){if(0===r.length)throw new ue(900,!1);let i,o=0;for(let a=0;a<r.length;a++){const c=r[a],f=gf(c);"number"==typeof f?-1===f?i=c.token:o|=f:i=c}n.push(Dt(i,o))}else n.push(Dt(r))}return n}function gf(t){return t.__NG_DI_FLAG__}function Ba(t,n){return t.hasOwnProperty(Jl)?t[Jl]:null}function nc(t,n){t.forEach(e=>Array.isArray(e)?nc(e,n):n(e))}function Uu(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function as(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Va(t,n,e){let r=yl(t,n);return r>=0?t[1|r]=e:(r=~r,function _f(t,n,e,r){let i=t.length;if(i==n)t.push(e,r);else if(1===i)t.push(r,t[0]),t[0]=e;else{for(i--,t.push(t[i-1],t[i]);i>n;)t[i]=t[i-2],i--;t[n]=e,t[n+1]=r}}(t,r,n,e)),r}function Gc(t,n){const e=yl(t,n);if(e>=0)return t[1|e]}function yl(t,n){return function nv(t,n,e){let r=0,i=t.length>>e;for(;i!==r;){const o=r+(i-r>>1),a=t[o<<e];if(n===a)return o<<e;a>n?i=o:r=o+1}return~(i<<e)}(t,n,1)}const As={},Ar=[],qs=new Fe(""),yf=new Fe("",-1),vf=new Fe("");class Wd{get(n,e=La){if(e===La){const i=_l("",-201);throw i.name="\u0275NotFound",i}return e}}function za(t){return{\u0275providers:t}}function wf(...t){return{\u0275providers:Wc(0,t),\u0275fromNgModule:!0}}function Wc(t,...n){const e=[],r=new Set;let i;const o=a=>{e.push(a)};return nc(n,a=>{const c=a;ju(c,o,[],r)&&(i||=[],i.push(c))}),void 0!==i&&$p(i,o),e}function $p(t,n){for(let e=0;e<t.length;e++){const{ngModule:r,providers:i}=t[e];Hu(i,o=>{n(o,r)})}}function ju(t,n,e,r){if(!(t=mn(t)))return!1;let i=null,o=jc(t);const a=!o&&ln(t);if(o||a){if(a&&!a.standalone)return!1;i=t}else{const f=t.ngModule;if(o=jc(f),!o)return!1;i=f}const c=r.has(i);if(a){if(c)return!1;if(r.add(i),a.dependencies){const f="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const _ of f)ju(_,n,e,r)}}else{if(!o)return!1;{if(null!=o.imports&&!c){let _;r.add(i),nc(o.imports,x=>{ju(x,n,e,r)&&(_||=[],_.push(x))}),void 0!==_&&$p(_,n)}if(!c){const _=Ba(i)||(()=>new i);n({provide:i,useFactory:_,deps:Ar},i),n({provide:vf,useValue:i,multi:!0},i),n({provide:qs,useValue:()=>Dt(i),multi:!0},i)}const f=o.providers;if(null!=f&&!c){const _=t;Hu(f,x=>{n(x,_)})}}}return i!==t&&void 0!==t.providers}function Hu(t,n){for(let e of t)Vd(e)&&(e=e.\u0275providers),Array.isArray(e)?Hu(e,n):n(e)}const Kc=pt({provide:String,useValue:pt});function Ua(t){return null!==t&&"object"==typeof t&&Kc in t}function Yo(t){return"function"==typeof t}const xf=new Fe(""),vl={},$u={};let qp;function rc(){return void 0===qp&&(qp=new Wd),qp}class Hr{}class oa extends Hr{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(n,e,r,i){super(),this.parent=e,this.source=r,this.scopes=i,Lo(n,a=>this.processProvider(a)),this.records.set(yf,st(void 0,this)),i.has("environment")&&this.records.set(Hr,st(void 0,this));const o=this.records.get(xf);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(vf,Ar,{self:!0}))}retrieve(n,e){const r=Hd(e)||0;try{return this.get(n,La,r)}catch(i){if(xt(i))return i;throw i}}destroy(){so(this),this._destroyed=!0;const n=Tt(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of e)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Tt(n)}}onDestroy(n){return so(this),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){so(this);const e=Te(this),r=Si(void 0);try{return n()}finally{Te(e),Si(r)}}get(n,e=La,r){if(so(this),n.hasOwnProperty(Lu))return n[Lu](this);const i=Hd(r),a=Te(this),c=Si(void 0);try{if(!(4&i)){let _=this.records.get(n);if(void 0===_){const x=function ic(t){return"function"==typeof t||"object"==typeof t&&"InjectionToken"===t.ngMetadataName}(n)&&rf(n);_=x&&this.injectableDefInScope(x)?st(Ui(n),vl):null,this.records.set(n,_)}if(null!=_)return this.hydrate(n,_,i)}return(2&i?rc():this.parent).get(n,e=8&i&&e===La?null:e)}catch(f){const _=function Vu(t){return t[cf]}(f);throw-200===_||-201===_?new ue(_,null):f}finally{Si(c),Te(a)}}resolveInjectorInitializers(){const n=Tt(null),e=Te(this),r=Si(void 0);try{const o=this.get(qs,Ar,{self:!0});for(const a of o)a()}finally{Te(e),Si(r),Tt(n)}}toString(){const n=[],e=this.records;for(const r of e.keys())n.push(xn(r));return`R3Injector[${n.join(", ")}]`}processProvider(n){let e=Yo(n=mn(n))?n:mn(n&&n.provide);const r=function Bg(t){return Ua(t)?st(void 0,t.useValue):st(Ii(t),vl)}(n);if(!Yo(n)&&!0===n.multi){let i=this.records.get(e);i||(i=st(void 0,vl,!0),i.factory=()=>mf(i.multi),this.records.set(e,i)),e=n,i.multi.push(n)}this.records.set(e,r)}hydrate(n,e,r){const i=Tt(null);try{if(e.value===$u)throw Bu(xn(n));return e.value===vl&&(e.value=$u,e.value=e.factory(void 0,r)),"object"==typeof e.value&&e.value&&function qu(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{Tt(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const e=mn(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Ui(t){const n=rf(t),e=null!==n?n.factory:Ba(t);if(null!==e)return e;if(t instanceof Fe)throw new ue(204,!1);if(t instanceof Function)return function Ms(t){if(t.length>0)throw new ue(204,!1);const e=function Bp(t){return(t?.[Hc]??null)||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new ue(204,!1)}function Ii(t,n,e){let r;if(Yo(t)){const i=mn(t);return Ba(i)||Ui(i)}if(Ua(t))r=()=>mn(t.useValue);else if(function Sn(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...mf(t.deps||[]));else if(function Zn(t){return!(!t||!t.useExisting)}(t))r=(i,o)=>Dt(mn(t.useExisting),void 0!==o&&8&o?8:void 0);else{const i=mn(t&&(t.useClass||t.provide));if(!function Kd(t){return!!t.deps}(t))return Ba(i)||Ui(i);r=()=>new i(...mf(t.deps))}return r}function so(t){if(t.destroyed)throw new ue(205,!1)}function st(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Lo(t,n){for(const e of t)Array.isArray(e)?Lo(e,n):e&&Vd(e)?Lo(e.\u0275providers,n):n(e)}function ji(t,n){let e;t instanceof oa?(so(t),e=t):e=new mr(t);const i=Te(e),o=Si(void 0);try{return n()}finally{Te(i),Si(o)}}function En(t){return Array.isArray(t)&&"object"==typeof t[1]}function vo(t){return Array.isArray(t)&&!0===t[1]}function Gu(t){return!!(4&t.flags)}function ao(t){return t.componentOffset>-1}function Ki(t){return!(1&~t.flags)}function us(t){return!!t.template}function ds(t){return!!(512&t[2])}function Ps(t){return!(256&~t[2])}function L(t){for(;Array.isArray(t);)t=t[0];return t}function W(t,n){return L(n[t])}function H(t,n){return L(n[t.index])}function ne(t,n){return t.data[n]}function ae(t,n){const e=n[t];return En(e)?e:e[0]}function be(t){return!(128&~t[2])}function De(t,n){return null==n?null:t[n]}function Me(t){t[17]=0}function Le(t){1024&t[2]||(t[2]|=1024,be(t)&&Et(t))}function qe(t){return!!(9216&t[2]||t[24]?.dirty)}function at(t){t[10].changeDetectionScheduler?.notify(8),64&t[2]&&(t[2]|=1024),qe(t)&&Et(t)}function Et(t){t[10].changeDetectionScheduler?.notify(0);let n=pn(t);for(;null!==n&&!(8192&n[2])&&(n[2]|=8192,be(n));)n=pn(n)}function It(t,n){if(Ps(t))throw new ue(911,!1);null===t[21]&&(t[21]=[]),t[21].push(n)}function pn(t){const n=t[3];return vo(n)?n[3]:n}function ut(t){return t[7]??=[]}function Yt(t){return t.cleanup??=[]}const et={lFrame:Vw(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Ut=!1;function $r(){et.lFrame.elementDepthCount--}function lo(){return et.bindingsEnabled}function yi(){return null!==et.skipHydrationRootTNode}function vi(t){return et.skipHydrationRootTNode===t}function bo(){et.skipHydrationRootTNode=null}function Pe(){return et.lFrame.lView}function Ht(){return et.lFrame.tView}function He(t){return et.lFrame.contextLView=t,t[8]}function Ze(t){return et.lFrame.contextLView=null,t}function Xt(){let t=Zc();for(;null!==t&&64===t.type;)t=t.parent;return t}function Zc(){return et.lFrame.currentTNode}function Ns(t,n){const e=et.lFrame;e.currentTNode=t,e.isParent=n}function Yc(){return et.lFrame.isParent}function ca(){et.lFrame.isParent=!1}function lc(){return Ut}function Mr(t){const n=Ut;return Ut=t,n}function Fn(){const t=et.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Br(){return et.lFrame.bindingIndex}function Zi(){return et.lFrame.bindingIndex++}function wl(t){const n=et.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function Ug(t,n){const e=et.lFrame;e.bindingIndex=e.bindingRootIndex=t,Qc(n)}function Qc(t){et.lFrame.currentDirectiveIndex=t}function Zp(){return et.lFrame.currentQueryIndex}function cc(t){et.lFrame.currentQueryIndex=t}function hs(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[5]:null}function Fw(t,n,e){if(4&e){let i=n,o=t;for(;!(i=i.parent,null!==i||1&e||(i=hs(o),null===i||(o=o[14],10&i.type))););if(null===i)return!1;n=i,t=o}const r=et.lFrame=Bw();return r.currentTNode=n,r.lView=t,!0}function Hg(t){const n=Bw(),e=t[1];et.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Bw(){const t=et.lFrame,n=null===t?null:t.child;return null===n?Vw(t):n}function Vw(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function zw(){const t=et.lFrame;return et.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Uw=zw;function Yp(){const t=zw();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function co(){return et.lFrame.selectedIndex}function Yu(t){et.lFrame.selectedIndex=t}function Bo(){const t=et.lFrame;return ne(t.tView,t.selectedIndex)}function Rr(){et.lFrame.currentNamespace="svg"}function ua(){!function gT(){et.lFrame.currentNamespace=null}()}let jw=!0;function $g(){return jw}function Xp(t){jw=t}function qg(t,n=null,e=null,r){const i=Hw(t,n,e,r);return i.resolveInjectorInitializers(),i}function Hw(t,n=null,e=null,r,i=new Set){const o=[e||Ar,wf(t)];return r=r||("object"==typeof t?void 0:xn(t)),new oa(o,n||rc(),r||null,i)}class In{static THROW_IF_NOT_FOUND=La;static NULL=new Wd;static create(n,e){if(Array.isArray(n))return qg({name:""},e,n,"");{const r=n.name??"";return qg({name:r},n.parent,n.providers,r)}}static \u0275prov=je({token:In,providedIn:"any",factory:()=>Dt(yf)});static __NG_ELEMENT_ID__=-1}const jn=new Fe("");let ir=(()=>class t{static __NG_ELEMENT_ID__=$w;static __NG_ENV_ID__=e=>e})();class Qp extends ir{_lView;constructor(n){super(),this._lView=n}get destroyed(){return Ps(this._lView)}onDestroy(n){const e=this._lView;return It(e,n),()=>function St(t,n){if(null===t[21])return;const e=t[21].indexOf(n);-1!==e&&t[21].splice(e,1)}(e,n)}}function $w(){return new Qp(Pe())}const Jp=!1,Gg=new Fe("");let Ha=(()=>{class t{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new se(!1);debugTaskTracker=X(Gg,{optional:!0});get hasPendingTasks(){return!this.destroyed&&this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new U(e=>{e.next(!1),e.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),this.debugTaskTracker?.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.debugTaskTracker?.remove(e),0===this.pendingTasks.size&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=je({token:t,providedIn:"root",factory:()=>new t})}return t})();const Hn=class qw extends J{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(n=!1){super(),this.__isAsync=n,function go(){return void 0!==hf()||null!=Je()}()&&(this.destroyRef=X(ir,{optional:!0})??void 0,this.pendingTasks=X(Ha,{optional:!0})??void 0)}emit(n){const e=Tt(null);try{super.next(n)}finally{Tt(e)}}subscribe(n,e,r){let i=n,o=e||(()=>null),a=r;if(n&&"object"==typeof n){const f=n;i=f.next?.bind(f),o=f.error?.bind(f),a=f.complete?.bind(f)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),a&&(a=this.wrapInTimeout(a)));const c=super.subscribe({next:i,error:o,complete:a});return n instanceof Wn&&n.add(c),c}wrapInTimeout(n){return e=>{const r=this.pendingTasks?.add();setTimeout(()=>{try{n(e)}finally{void 0!==r&&this.pendingTasks?.remove(r)}})}}};function Xu(...t){}function Wg(t){let n,e;function r(){t=Xu;try{void 0!==e&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(e),void 0!==n&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{t(),r()}),"function"==typeof requestAnimationFrame&&(e=requestAnimationFrame(()=>{t(),r()})),()=>r()}function rv(t){return queueMicrotask(()=>t()),()=>{t=Xu}}const Jd="isAngularZone",Kg=Jd+"_ID";let iv=0;class on{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Hn(!1);onMicrotaskEmpty=new Hn(!1);onStable=new Hn(!1);onError=new Hn(!1);constructor(n){const{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=Jp}=n;if(typeof Zone>"u")throw new ue(908,!1);Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!i&&r,a.shouldCoalesceRunChangeDetection=i,a.callbackScheduled=!1,a.scheduleInRootZone=o,function yT(t){const n=()=>{!function xl(t){function n(){Wg(()=>{t.callbackScheduled=!1,sv(t),t.isCheckStableRunning=!0,em(t),t.isCheckStableRunning=!1})}t.isCheckStableRunning||t.callbackScheduled||(t.callbackScheduled=!0,t.scheduleInRootZone?Zone.root.run(()=>{n()}):t._outer.run(()=>{n()}),sv(t))}(t)},e=iv++;t._inner=t._inner.fork({name:"angular",properties:{[Jd]:!0,[Kg]:e,[Kg+e]:!0},onInvokeTask:(r,i,o,a,c,f)=>{if(function If(t){return Zw(t,"__ignore_ng_zone__")}(f))return r.invokeTask(o,a,c,f);try{return Gw(t),r.invokeTask(o,a,c,f)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||t.shouldCoalesceRunChangeDetection)&&n(),Ww(t)}},onInvoke:(r,i,o,a,c,f,_)=>{try{return Gw(t),r.invoke(o,a,c,f,_)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!function vT(t){return Zw(t,"__scheduler_tick__")}(f)&&n(),Ww(t)}},onHasTask:(r,i,o,a)=>{r.hasTask(o,a),i===o&&("microTask"==a.change?(t._hasPendingMicrotasks=a.microTask,sv(t),em(t)):"macroTask"==a.change&&(t.hasPendingMacrotasks=a.macroTask))},onHandleError:(r,i,o,a)=>(r.handleError(o,a),t.runOutsideAngular(()=>t.onError.emit(a)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Jd)}static assertInAngularZone(){if(!on.isInAngularZone())throw new ue(909,!1)}static assertNotInAngularZone(){if(on.isInAngularZone())throw new ue(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,i){const o=this._inner,a=o.scheduleEventTask("NgZoneEvent: "+i,n,ov,Xu,Xu);try{return o.runTask(a,e,r)}finally{o.cancelTask(a)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}}const ov={};function em(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function sv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&!0===t.callbackScheduled)}function Gw(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Ww(t){t._nesting--,em(t)}class Kw{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Hn;onMicrotaskEmpty=new Hn;onStable=new Hn;onError=new Hn;run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,i){return n.apply(e,r)}}function Zw(t,n){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0]?.data?.[n]}class kf{_console=console;handleError(n){this._console.error("ERROR",n)}}const El=new Fe("",{factory:()=>{const t=X(on),n=X(Hr);let e;return r=>{t.runOutsideAngular(()=>{n.destroyed&&!e?setTimeout(()=>{throw r}):(e??=n.get(kf),e.handleError(r))})}}}),Yw={provide:qs,useValue:()=>{X(kf,{optional:!0})},multi:!0};function wo(t,n){const[e,r,i]=hl(t,n?.equal),o=e;return o.set=r,o.update=i,o.asReadonly=eh.bind(o),o}function eh(){const t=this[ze];if(void 0===t.readonlyFn){const n=()=>this();n[ze]=t,t.readonlyFn=n}return t.readonlyFn}let av=(()=>class t{view;node;constructor(e,r){this.view=e,this.node=r}static __NG_ELEMENT_ID__=wT})();function wT(){return new av(Pe(),Xt())}class Af{}const Qu=new Fe("",{factory:()=>!0}),Xw=new Fe("");let lv=(()=>{class t{internalPendingTasks=X(Ha);scheduler=X(Af);errorHandler=X(El);add(){const e=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(e)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(e))}}run(e){const r=this.add();e().catch(this.errorHandler).finally(r)}static \u0275prov=je({token:t,providedIn:"root",factory:()=>new t})}return t})(),Qw=(()=>{class t{static \u0275prov=je({token:t,providedIn:"root",factory:()=>new ET})}return t})();class ET{dirtyEffectCount=0;queues=new Map;add(n){this.enqueue(n),this.schedule(n)}schedule(n){n.dirty&&this.dirtyEffectCount++}remove(n){const r=this.queues.get(n.zone);r.has(n)&&(r.delete(n),n.dirty&&this.dirtyEffectCount--)}enqueue(n){const e=n.zone;this.queues.has(e)||this.queues.set(e,new Set);const r=this.queues.get(e);r.has(n)||r.add(n)}flush(){for(;this.dirtyEffectCount>0;){let n=!1;for(const[e,r]of this.queues)n||=null===e?this.flushQueue(r):e.run(()=>this.flushQueue(r));n||(this.dirtyEffectCount=0)}}flushQueue(n){let e=!1;for(const r of n)r.dirty&&(this.dirtyEffectCount--,e=!0,r.run());return e}}class Zg{[ze];constructor(n){this[ze]=n}destroy(){this[ze].destroy()}}function xo(t,n){const e=n?.injector??X(In);let i,r=!0!==n?.manualCleanup?e.get(ir):null;const o=e.get(av,null,{optional:!0}),a=e.get(Af);return null!==o?(i=function CT(t,n,e){const r=Object.create(tx);return r.view=t,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=n,r.fn=rx(r,e),t[23]??=new Set,t[23].add(r),r.consumerMarkedDirty(r),r}(o.view,a,t),r instanceof Qp&&r._lView===o.view&&(r=null)):i=function nx(t,n,e){const r=Object.create(ex);return r.fn=rx(r,t),r.scheduler=n,r.notifier=e,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}(t,e.get(Qw),a),i.injector=e,null!==r&&(i.onDestroyFns=[r.onDestroy(()=>i.destroy())]),new Zg(i)}const Jw={...Lp,cleanupFns:void 0,zone:null,onDestroyFns:null,run(){const t=Mr(!1);try{!function ta(t){if(t.dirty=!1,t.version>0&&!Bi(t))return;t.version++;const n=ns(t);try{t.cleanup(),t.fn()}finally{Da(t,n)}}(this)}finally{Mr(t)}},cleanup(){if(!this.cleanupFns?.length)return;const t=Tt(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],Tt(t)}}},ex={...Jw,consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(Es(this),null!==this.onDestroyFns)for(const t of this.onDestroyFns)t();this.cleanup(),this.scheduler.remove(this)}},tx={...Jw,consumerMarkedDirty(){this.view[2]|=8192,Et(this.view),this.notifier.notify(13)},destroy(){if(Es(this),null!==this.onDestroyFns)for(const t of this.onDestroyFns)t();this.cleanup(),this.view[23]?.delete(this)}};function rx(t,n){return()=>{n(e=>(t.cleanupFns??=[]).push(e))}}function vr(t){return function js(t){const n=Tt(null);try{return t()}finally{Tt(n)}}(t)}function ix(t,n,e,r,i,o,a){try{var c=t[o](a),f=c.value}catch(_){return void e(_)}c.done?n(f):Promise.resolve(f).then(r,i)}function fe(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(f){ix(o,r,i,a,c,"next",f)}function c(f){ix(o,r,i,a,c,"throw",f)}a(void 0)})}}function Vo(t){return n=>{if(function DT(t){return pr(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}class si extends Pu{constructor(n,e,r,i,o){super(n),this.onFinalize=o,this._next=e?function(a){try{e(a)}catch(c){n.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){n.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}function hr(t,n){return Vo((e,r)=>{let i=0;e.subscribe(new si(r,o=>{r.next(t.call(n,o,i++))}))})}function dc(t){return{toString:t}.toString()}function Pf(t,n,e,r){null!==n?n.applyValueToInputSignal(n,r):t[e]=r}class Zs{previousValue;currentValue;firstChange;constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}const zo=(()=>{const t=()=>Eo;return t.ngInherit=!0,t})();function Eo(t){return t.type.prototype.ngOnChanges&&(t.setInput=Xg),Yg}function Yg(){const t=cv(this),n=t?.current;if(n){const e=t.previous;if(e===As)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function Xg(t,n,e,r,i){const o=this.declaredInputs[r],a=cv(t)||function lx(t,n){return t[fs]=n}(t,{previous:As,current:null}),c=a.current||(a.current={}),f=a.previous,_=f[o];c[o]=new Zs(_&&_.currentValue,e,f===As),Pf(t,n,i,e)}const fs="__ngSimpleChanges__";function cv(t){return t[fs]||null}const rh=[],gr=function(t,n=null,e){for(let r=0;r<rh.length;r++)(0,rh[r])(t,n,e)};var Ct=function(t){return t[t.TemplateCreateStart=0]="TemplateCreateStart",t[t.TemplateCreateEnd=1]="TemplateCreateEnd",t[t.TemplateUpdateStart=2]="TemplateUpdateStart",t[t.TemplateUpdateEnd=3]="TemplateUpdateEnd",t[t.LifecycleHookStart=4]="LifecycleHookStart",t[t.LifecycleHookEnd=5]="LifecycleHookEnd",t[t.OutputStart=6]="OutputStart",t[t.OutputEnd=7]="OutputEnd",t[t.BootstrapApplicationStart=8]="BootstrapApplicationStart",t[t.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",t[t.BootstrapComponentStart=10]="BootstrapComponentStart",t[t.BootstrapComponentEnd=11]="BootstrapComponentEnd",t[t.ChangeDetectionStart=12]="ChangeDetectionStart",t[t.ChangeDetectionEnd=13]="ChangeDetectionEnd",t[t.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",t[t.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",t[t.AfterRenderHooksStart=16]="AfterRenderHooksStart",t[t.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",t[t.ComponentStart=18]="ComponentStart",t[t.ComponentEnd=19]="ComponentEnd",t[t.DeferBlockStateStart=20]="DeferBlockStateStart",t[t.DeferBlockStateEnd=21]="DeferBlockStateEnd",t[t.DynamicComponentStart=22]="DynamicComponentStart",t[t.DynamicComponentEnd=23]="DynamicComponentEnd",t[t.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",t[t.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",t}(Ct||{});function Qg(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:c,ngAfterViewInit:f,ngAfterViewChecked:_,ngOnDestroy:x}=o;a&&(t.contentHooks??=[]).push(-e,a),c&&((t.contentHooks??=[]).push(e,c),(t.contentCheckHooks??=[]).push(e,c)),f&&(t.viewHooks??=[]).push(-e,f),_&&((t.viewHooks??=[]).push(e,_),(t.viewCheckHooks??=[]).push(e,_)),null!=x&&(t.destroyHooks??=[]).push(e,x)}}function nm(t,n,e){fv(t,n,3,e)}function rm(t,n,e,r){(3&t[2])===e&&fv(t,n,e,r)}function hv(t,n){let e=t[2];(3&e)===n&&(e&=16383,e+=1,t[2]=e)}function fv(t,n,e,r){const o=r??-1,a=n.length-1;let c=0;for(let f=void 0!==r?65535&t[17]:0;f<a;f++)if("number"==typeof n[f+1]){if(c=n[f],null!=r&&c>=r)break}else n[f]<0&&(t[17]+=65536),(c<o||-1==o)&&(ux(t,e,n,f),t[17]=(4294901760&t[17])+f+2),f++}function pv(t,n){gr(Ct.LifecycleHookStart,t,n);const e=Tt(null);try{n.call(t)}finally{Tt(e),gr(Ct.LifecycleHookEnd,t,n)}}function ux(t,n,e,r){const i=e[r]<0,o=e[r+1],c=t[i?-e[r]:e[r]];i?t[2]>>14<t[17]>>16&&(3&t[2])===n&&(t[2]+=16384,pv(c,o)):pv(c,o)}class im{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(n,e,r,i){this.factory=n,this.name=i,this.canSeeViewProviders=e,this.injectImpl=r}}function nd(t){return 3===t||4===t||6===t}function hx(t){return 64===t.charCodeAt(0)}function Of(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){const i=n[r];"number"==typeof i?e=i:0===e||fx(t,e,i,0,-1===e||2===e?n[++r]:null)}}return t}function fx(t,n,e,r,i){let o=0,a=t.length;if(-1===n)a=-1;else for(;o<t.length;){const c=t[o++];if("number"==typeof c){if(c===n){a=-1;break}if(c>n){a=o-1;break}}}for(;o<t.length;){const c=t[o];if("number"==typeof c)break;if(c===e)return void(null!==i&&(t[o+1]=i));o++,null!==i&&o++}-1!==a&&(t.splice(a,0,n),o=a+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i)}function rd(t){return-1!==t}function oh(t){return 32767&t}function sh(t,n){let e=function px(t){return t>>16}(t),r=n;for(;e>0;)r=r[14],e--;return r}let t_=!0;function om(t){const n=t_;return t_=t,n}let n_=0;const qa={};function eu(t,n){const e=Yn(t,n);if(-1!==e)return e;const r=n[1];r.firstCreatePass&&(t.injectorIndex=n.length,ah(r.data,t),ah(n,null),ah(r.blueprint,null));const i=r_(t,n),o=t.injectorIndex;if(rd(i)){const a=oh(i),c=sh(i,n),f=c[1].data;for(let _=0;_<8;_++)n[o+_]=c[a+_]|f[a+_]}return n[o+8]=i,o}function ah(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Yn(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function r_(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,r=null,i=n;for(;null!==i;){if(r=wv(i),null===r)return-1;if(e++,i=i[14],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function sm(t,n,e){!function LT(t,n,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(zd)&&(r=e[zd]),null==r&&(r=e[zd]=n_++);const i=255&r;n.data[t+(i>>5)]|=1<<i}(t,n,e)}function _x(t,n,e){if(8&e||void 0!==t)return t;uf()}function yx(t,n,e,r){if(8&e&&void 0===r&&(r=null),!(3&e)){const i=t[9],o=Si(void 0);try{return i?i.get(n,r,8&e):ff(n,r,8&e)}finally{Si(o)}}return _x(r,0,e)}function vx(t,n,e,r=0,i){if(null!==t){if(2048&n[2]&&!(2&r)){const a=function Tr(t,n,e,r,i){let o=t,a=n;for(;null!==o&&null!==a&&2048&a[2]&&!ds(a);){const c=bx(o,a,e,2|r,qa);if(c!==qa)return c;let f=o.parent;if(!f){const _=a[20];if(_){const x=_.get(e,qa,r);if(x!==qa)return x}f=wv(a),a=a[14]}o=f}return i}(t,n,e,r,qa);if(a!==qa)return a}const o=bx(t,n,e,r,qa);if(o!==qa)return o}return yx(n,e,r,i)}function bx(t,n,e,r,i){const o=function wx(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(zd)?t[zd]:void 0;return"number"==typeof n?n>=0?255&n:Bf:n}(e);if("function"==typeof o){if(!Fw(n,t,r))return 1&r?_x(i,0,r):yx(n,e,r,i);try{let a;if(a=o(r),null!=a||8&r)return a;uf()}finally{Uw()}}else if("number"==typeof o){let a=null,c=Yn(t,n),f=-1,_=1&r?n[15][5]:null;for((-1===c||4&r)&&(f=-1===c?r_(t,n):n[c+8],-1!==f&&bv(r,!1)?(a=n[1],c=oh(f),n=sh(f,n)):c=-1);-1!==c;){const x=n[1];if(vv(o,c,x.data)){const D=FT(c,n,e,a,r,_);if(D!==qa)return D}f=n[c+8],-1!==f&&bv(r,n[1].data[c+8]===_)&&vv(o,c,n)?(a=x,c=oh(f),n=sh(f,n)):c=-1}}return i}function FT(t,n,e,r,i,o){const a=n[1],c=a.data[t+8],x=i_(c,a,e,null==r?ao(c)&&t_:r!=a&&!!(3&c.type),1&i&&o===c);return null!==x?Ff(n,a,x,c,i):qa}function i_(t,n,e,r,i){const o=t.providerIndexes,a=n.data,c=1048575&o,f=t.directiveStart,x=o>>20,A=i?c+x:t.directiveEnd;for(let N=r?c:c+x;N<A;N++){const B=a[N];if(N<f&&e===B||N>=f&&B.type===e)return N}if(i){const N=a[f];if(N&&us(N)&&N.type===e)return f}return null}function Ff(t,n,e,r,i){let o=t[e];const a=n.data;if(o instanceof im){const c=o;if(c.resolving)throw Bu();const f=om(c.canSeeViewProviders);c.resolving=!0;const D=c.injectImpl?Si(c.injectImpl):null;Fw(t,r,0);try{o=t[e]=c.factory(void 0,i,a,t,r),n.firstCreatePass&&e>=r.directiveStart&&function Nf(t,n,e){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=n.type.prototype;if(r){const a=Eo(n);(e.preOrderHooks??=[]).push(t,a),(e.preOrderCheckHooks??=[]).push(t,a)}i&&(e.preOrderHooks??=[]).push(0-t,i),o&&((e.preOrderHooks??=[]).push(t,o),(e.preOrderCheckHooks??=[]).push(t,o))}(e,a[e],n)}finally{null!==D&&Si(D),om(f),c.resolving=!1,Uw()}}return o}function vv(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function bv(t,n){return!(2&t||1&t&&n)}class ai{_tNode;_lView;constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return vx(this._tNode,this._lView,n,Hd(r),e)}}function Bf(){return new ai(Xt(),Pe())}function qr(t){return dc(()=>{const n=t.prototype.constructor,e=n[Jl]||ei(n),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const o=i[Jl]||ei(i);if(o&&o!==e)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function ei(t){return ii(t)?()=>{const n=ei(mn(t));return n&&n()}:Ba(t)}function wv(t){const n=t[1],e=n.type;return 2===e?n.declTNode:1===e?t[5]:null}function Vf(t){return function Lf(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const r=e.length;let i=0;for(;i<r;){const o=e[i];if(nd(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof e[i];)i++;else{if(o===n)return e[i+1];i+=2}}}return null}(Xt(),t)}function nu(){return ch(Xt(),Pe())}function ch(t,n){return new Vr(H(t,n))}let Vr=(()=>class t{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=nu})();function Cx(t){return t instanceof Vr?t.nativeElement:t}function Yi(){return this._results[Symbol.iterator]()}class od{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new J}constructor(n=!1){this._emitDistinctChangesOnly=n}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;const r=function mo(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function qd(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],o=n[r];if(e&&(i=e(i),o=e(o)),o!==i)return!1}return!0}(this._results,r,e))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=Yi}function m(t){return!(128&~t.flags)}var E=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(E||{});const S=new Map;let k=0;function V(t){S.delete(t[19])}const ve="__ngContext__";function ye(t,n){En(n)?(t[ve]=n[19],function P(t){S.set(t[19],t)}(n)):t[ve]=n}function rn(t){return At(t[12])}function Cn(t){return At(t[4])}function At(t){for(;null!==t&&!vo(t);)t=t[4];return t}let Co;const xr=new Fe("",{factory:()=>To}),To="ng",Dl=new Fe(""),ps=new Fe("",{providedIn:"platform",factory:()=>"unknown"}),ha=new Fe(""),Ur=new Fe("",{factory:()=>X(jn).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),hm=new Fe("",{factory:()=>!1}),gm=new Fe("");function gh(t){return!(32&~t.flags)}function bO(t,n){const e=t.contentQueries;if(null!==e){const r=Tt(null);try{for(let i=0;i<e.length;i+=2){const a=e[i+1];if(-1!==a){const c=t.data[a];cc(e[i]),c.contentQueries(2,n[a],a)}}}finally{Tt(r)}}}function GT(t,n,e){cc(0);const r=Tt(null);try{n(t,e)}finally{Tt(r)}}function WT(t,n,e){if(Gu(n)){const r=Tt(null);try{const o=n.directiveEnd;for(let a=n.directiveStart;a<o;a++){const c=t.data[a];c.contentQueries&&c.contentQueries(1,e[a],a)}}finally{Tt(r)}}}var bc=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t[t.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",t}(bc||{});let Ux,jx;function S_(t){return function CO(){if(void 0===Ux&&(Ux=null,an.trustedTypes))try{Ux=an.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Ux}()?.createHTML(t)||t}function SO(t){return function YT(){if(void 0===jx&&(jx=null,an.trustedTypes))try{jx=an.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return jx}()?.createScriptURL(t)||t}class bm{changingThisBreaksApplicationSecurity;constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${en})`}}class RW extends bm{getTypeName(){return"HTML"}}class PW extends bm{getTypeName(){return"Style"}}class NW extends bm{getTypeName(){return"Script"}}class OW extends bm{getTypeName(){return"URL"}}class LW extends bm{getTypeName(){return"ResourceURL"}}function Sl(t){return t instanceof bm?t.changingThisBreaksApplicationSecurity:t}function ld(t,n){const e=function FW(t){return t instanceof bm&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${en})`)}return e===n}class HW{inertDocumentHelper;constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(S_(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.firstChild?.remove(),e)}catch{return null}}}class $W{defaultDoc;inertDocument;constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=S_(n),e}}const GW=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Hx(t){return(t=String(t)).match(GW)?t:"unsafe:"+t}function bh(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Ov(...t){const n={};for(const e of t)for(const r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}const kO=bh("area,br,col,hr,img,wbr"),AO=bh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),MO=bh("rp,rt"),XT=Ov(kO,Ov(AO,bh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ov(MO,bh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ov(MO,AO)),QT=bh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),RO=Ov(QT,bh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),bh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),WW=bh("script,style,template");class KW{sanitizedSomething=!1;buf=[];sanitizeChildren(n){let e=n.firstChild,r=!0,i=[];for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)i.push(e),e=XW(e);else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=YW(e);if(o){e=o;break}e=i.pop()}return this.buf.join("")}startElement(n){const e=PO(n).toLowerCase();if(!XT.hasOwnProperty(e))return this.sanitizedSomething=!0,!WW.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=n.attributes;for(let i=0;i<r.length;i++){const o=r.item(i),a=o.name,c=a.toLowerCase();if(!RO.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let f=o.value;QT[c]&&(f=Hx(f)),this.buf.push(" ",a,'="',OO(f),'"')}return this.buf.push(">"),!0}endElement(n){const e=PO(n).toLowerCase();XT.hasOwnProperty(e)&&!kO.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(OO(n))}}function YW(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw NO(n);return n}function XW(t){const n=t.firstChild;if(n&&function ZW(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw NO(n);return n}function PO(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function NO(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const QW=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,JW=/([^\#-~ |!])/g;function OO(t){return t.replace(/&/g,"&amp;").replace(QW,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(JW,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let $x;function LO(t,n){let e=null;try{$x=$x||function IO(t){const n=new $W(t);return function qW(){try{return!!(new window.DOMParser).parseFromString(S_(""),"text/html")}catch{return!1}}()?new HW(n):n}(t);let r=n?String(n):"";e=$x.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=e.innerHTML,e=$x.getInertBodyElement(r)}while(r!==o);return S_((new KW).sanitizeChildren(JT(e)||e))}finally{if(e){const r=JT(e)||e;for(;r.firstChild;)r.firstChild.remove()}}}function JT(t){return"content"in t&&function e7(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}function qx(t,n,e){return t.createElement(n,e)}function wm(t,n,e,r,i){t.insertBefore(n,e,r,i)}function VO(t,n,e){t.appendChild(n,e)}function zO(t,n,e,r,i){null!==r?wm(t,n,e,r,i):VO(t,n,e)}function Lv(t,n,e,r){t.removeChild(null,n,e,r)}function jO(t,n,e){const{mergedAttrs:r,classes:i,styles:o}=e;null!==r&&function e_(t,n,e){let r=0;for(;r<e.length;){const i=e[r];if("number"==typeof i){if(0!==i)break;r++;const o=e[r++],a=e[r++],c=e[r++];t.setAttribute(n,a,c,o)}else{const o=i,a=e[++r];hx(o)?t.setProperty(n,o,a):t.setAttribute(n,o,a),r++}}}(t,n,r),null!==i&&function o7(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}(t,n,i),null!==o&&function i7(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}var Il=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Il||{});function So(t){const n=Fv();return n?n.sanitize(Il.URL,t)||"":ld(t,"URL")?Sl(t):Hx(tn(t))}function HO(t){const n=Fv();if(n)return SO(n.sanitize(Il.RESOURCE_URL,t)||"");if(ld(t,"ResourceURL"))return SO(Sl(t));throw new ue(904,!1)}const h7=new Set(["embed","frame","iframe","media","script"]),f7=new Set(["base","link","script"]);function $O(t,n,e){return function p7(t,n){return"src"===n&&h7.has(t)||"href"===n&&f7.has(t)||"xlink:href"===n&&"script"===t?HO:So}(n,e)(t)}function Fv(){const t=Pe();return t&&t[10].sanitizer}function cd(t){return t instanceof Function?t():t}function D7(t,n,e){let r=t.length;for(;;){const i=t.indexOf(n,e);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const o=n.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}e=i+1}}const ZO="ng-template";function T7(t,n,e,r){let i=0;if(r){for(;i<n.length&&"string"==typeof n[i];i+=2)if("class"===n[i]&&-1!==D7(n[i+1].toLowerCase(),e,0))return!0}else if(nS(t))return!1;if(i=n.indexOf(1,i),i>-1){let o;for(;++i<n.length&&"string"==typeof(o=n[i]);)if(o.toLowerCase()===e)return!0}return!1}function nS(t){return 4===t.type&&t.value!==ZO}function S7(t,n,e){return n===(4!==t.type||e?t.value:ZO)}function I7(t,n,e){let r=4;const i=t.attrs,o=null!==i?function M7(t){for(let n=0;n<t.length;n++)if(nd(t[n]))return n;return t.length}(i):0;let a=!1;for(let c=0;c<n.length;c++){const f=n[c];if("number"!=typeof f){if(!a)if(4&r){if(r=2|1&r,""!==f&&!S7(t,f,e)||""===f&&1===n.length){if(lu(r))return!1;a=!0}}else if(8&r){if(null===i||!T7(t,i,f,e)){if(lu(r))return!1;a=!0}}else{const _=n[++c],x=k7(f,i,nS(t),e);if(-1===x){if(lu(r))return!1;a=!0;continue}if(""!==_){let D;if(D=x>o?"":i[x+1].toLowerCase(),2&r&&_!==D){if(lu(r))return!1;a=!0}}}}else{if(!a&&!lu(r)&&!lu(f))return!1;if(a&&lu(f))continue;a=!1,r=f|1&r}}return lu(r)||a}function lu(t){return!(1&t)}function k7(t,n,e,r){if(null===n)return-1;let i=0;if(r||!e){let o=!1;for(;i<n.length;){const a=n[i];if(a===t)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){let c=n[++i];for(;"string"==typeof c;)c=n[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function R7(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const r=t[e];if("number"==typeof r)return-1;if(r===n)return e;e++}return-1}(n,t)}function YO(t,n,e=!1){for(let r=0;r<n.length;r++)if(I7(t,n[r],e))return!0;return!1}function P7(t,n){e:for(let e=0;e<n.length;e++){const r=n[e];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function XO(t,n){return t?":not("+n.trim()+")":n}function N7(t){let n=t[0],e=1,r=2,i="",o=!1;for(;e<t.length;){let a=t[e];if("string"==typeof a)if(2&r){const c=t[++e];i+="["+a+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""!==i&&!lu(a)&&(n+=XO(o,i),i=""),r=a,o=o||!lu(r);e++}return""!==i&&(n+=XO(o,i)),n}const Nr={};function rS(t,n,e,r,i,o,a,c,f,_,x){const D=27+r,A=D+i,N=function F7(t,n){const e=[];for(let r=0;r<n;r++)e.push(r<t?null:Nr);return e}(D,A),B="function"==typeof _?_():_;return N[1]={type:t,blueprint:N,template:e,queries:null,viewQuery:c,declTNode:n,data:N.slice().fill(null,D),bindingStartIndex:D,expandoStartIndex:A,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:f,consts:B,incompleteFirstPass:!1,ssrId:x}}function Wx(t,n,e,r,i,o,a,c,f,_,x){const D=n.blueprint.slice();return D[0]=i,D[2]=1228|r,(null!==_||t&&2048&t[2])&&(D[2]|=2048),Me(D),D[3]=D[14]=t,D[8]=e,D[10]=a||t&&t[10],D[11]=c||t&&t[11],D[9]=f||t&&t[9]||null,D[5]=o,D[19]=function M(){return k++}(),D[6]=x,D[20]=_,D[15]=2==n.type?t[15]:D,D}function iS(t){let n=16;return t.signals?n=4096:t.onPush&&(n=64),n}function Bv(t,n,e,r){if(0===e)return-1;const i=n.length;for(let o=0;o<e;o++)n.push(r),t.blueprint.push(r),t.data.push(null);return i}function oS(t,n){return t[12]?t[13][4]=n:t[12]=n,t[13]=n,n}function le(t=1){JO(Ht(),Pe(),co()+t,!1)}function JO(t,n,e,r){if(!r)if(3&~n[2]){const o=t.preOrderHooks;null!==o&&rm(n,o,0,e)}else{const o=t.preOrderCheckHooks;null!==o&&nm(n,o,e)}Yu(e)}var Kx=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Kx||{});function xm(t,n,e,r){const i=Tt(null);try{const[o,a,c]=t.inputs[e];let f=null;0!==(a&Kx.SignalBased)&&(f=n[o][ze]),null!==f&&void 0!==f.transformFn?r=f.transformFn(r):null!==c&&(r=c.call(n,r)),null!==t.setInput?t.setInput(n,f,r,e,o):Pf(n,f,o,r)}finally{Tt(i)}}var tp=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(tp||{});function aS(t,n){return undefined(t,n)}const Em=new Set;var lS=function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t}(lS||{});const A_=new Fe(""),rL=new Set;function Jo(t){rL.has(t)||(rL.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}let iL=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=je({token:t,providedIn:"root",factory:()=>new t})}return t})();const oL=[0,1,2,3];let $7=(()=>{class t{ngZone=X(on);scheduler=X(Af);errorHandler=X(kf,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){X(A_,{optional:!0})}execute(){const e=this.sequences.size>0;e&&gr(Ct.AfterRenderHooksStart),this.executing=!0;for(const r of oL)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[r])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>(0,i.hooks[r])(i.pipelinedValue),i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(const r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(const r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&gr(Ct.AfterRenderHooksEnd)}register(e){const{view:r}=e;void 0!==r?((r[25]??=[]).push(e),Et(r),r[2]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,r){return r?r.run(lS.AFTER_NEXT_RENDER,e):e()}static \u0275prov=je({token:t,providedIn:"root",factory:()=>new t})}return t})();class sL{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(n,e,r,i,o,a=null){this.impl=n,this.hooks=e,this.view=r,this.once=i,this.snapshot=a,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();const n=this.view?.[25];n&&(this.view[25]=n.filter(e=>e!==this))}}function cu(t,n){const e=n?.injector??X(In);return Jo("NgAfterNextRender"),function aL(t,n,e,r){const i=n.get(iL);i.impl??=n.get($7);const o=n.get(A_,null,{optional:!0}),a=!0!==e?.manualCleanup?n.get(ir):null,c=n.get(av,null,{optional:!0}),f=new sL(i.impl,function G7(t){return t instanceof Function?[void 0,void 0,t,void 0]:[t.earlyRead,t.write,t.mixedReadWrite,t.read]}(t),c?.view,r,a,o?.snapshot(null));return i.impl.register(f),f}(t,e,n,!0)}const Yx=new Fe("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:X(Hr)})});function lL(t,n,e){const r=t.get(Yx);if(Array.isArray(n))for(const i of n)r.queue.add(i),e?.detachedLeaveAnimationFns?.push(i);else r.queue.add(n),e?.detachedLeaveAnimationFns?.push(n);r.scheduler&&r.scheduler(t)}function cL(t,n,e,r){const i=t?.[26]?.enter;null!==n&&i&&i.has(e.index)&&function cS(t,n){for(const[e,r]of n)lL(t,r.animateFns)}(r,i)}function M_(t,n,e,r,i,o,a,c){if(null!=i){let f,_=!1;vo(i)?f=i:En(i)&&(_=!0,i=i[0]);const x=L(i);0===t&&null!==r?(cL(c,r,o,e),null==a?VO(n,r,x):wm(n,r,x,a||null,!0)):1===t&&null!==r?(cL(c,r,o,e),wm(n,r,x,a||null,!0)):2===t?hL(c,o,e,D=>{Lv(n,x,_,D)}):3===t&&hL(c,o,e,()=>{n.destroyNode(x)}),null!=f&&function t9(t,n,e,r,i,o,a){const c=r[7];c!==L(r)&&M_(n,t,e,o,c,i,a);for(let _=10;_<r.length;_++){const x=r[_];Jx(x[1],x,t,n,o,c)}}(n,t,e,f,o,r,a)}}function dL(t,n){n[10].changeDetectionScheduler?.notify(9),Jx(t,n,n[11],2,null,null)}function uS(t,n){const e=t[9],r=e.indexOf(n);e.splice(r,1)}function Vv(t,n){if(Ps(n))return;const e=n[11];e.destroyNode&&Jx(t,n,e,3,null,null),function Y7(t){let n=t[12];if(!n)return dS(t[1],t);for(;n;){let e=null;if(En(n))e=n[12];else{const r=n[10];r&&(e=r)}if(!e){for(;n&&!n[4]&&n!==t;)En(n)&&dS(n[1],n),n=n[3];null===n&&(n=t),En(n)&&dS(n[1],n),e=n&&n[4]}n=e}}(n)}function dS(t,n){if(Ps(n))return;const e=Tt(null);try{n[2]&=-129,n[2]|=256,n[24]&&Es(n[24]),function J7(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let r=0;r<e.length;r+=2){const i=n[e[r]];if(!(i instanceof im)){const o=e[r+1];if(Array.isArray(o))for(let a=0;a<o.length;a+=2){const c=i[o[a]],f=o[a+1];gr(Ct.LifecycleHookStart,c,f);try{f.call(c)}finally{gr(Ct.LifecycleHookEnd,c,f)}}else{gr(Ct.LifecycleHookStart,i,o);try{o.call(i)}finally{gr(Ct.LifecycleHookEnd,i,o)}}}}}(t,n),function Q7(t,n){const e=t.cleanup,r=n[7];if(null!==e)for(let a=0;a<e.length-1;a+=2)if("string"==typeof e[a]){const c=e[a+3];c>=0?r[c]():r[-c].unsubscribe(),a+=2}else e[a].call(r[e[a+1]]);null!==r&&(n[7]=null);const i=n[21];if(null!==i){n[21]=null;for(let a=0;a<i.length;a++)(0,i[a])()}const o=n[23];if(null!==o){n[23]=null;for(const a of o)a.destroy()}}(t,n),1===n[1].type&&n[11].destroy();const r=n[16];if(null!==r&&vo(n[3])){r!==n[3]&&uS(r,n);const i=n[18];null!==i&&i.detachView(t)}V(n)}finally{Tt(e)}}function hL(t,n,e,r){const i=t?.[26];if(null==i||null==i.leave||!i.leave.has(n.index))return r(!1);t&&Em.add(t[19]),lL(e,()=>{if(i.leave&&i.leave.has(n.index)){const a=i.leave.get(n.index),c=[];if(a){for(let f=0;f<a.animateFns.length;f++){const _=a.animateFns[f],{promise:x}=_();c.push(x)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(c),function X7(t,n){const e=t[26]?.running;e?e.then(()=>{t[26].running=void 0,Em.delete(t[19]),n(!0)}):n(!1)}(t,r)}else t&&Em.delete(t[19]),r(!1)},i)}function hS(t,n,e){return function fL(t,n,e){let r=n;for(;null!==r&&168&r.type;)r=(n=r).parent;if(null===r)return e[0];if(ao(r)){const{encapsulation:i}=t.data[r.directiveStart+r.componentOffset];if(i===bc.None||i===bc.Emulated)return null}return H(r,e)}(t,n.parent,e)}function pL(t,n,e){return gL(t,n,e)}let gL=function mL(t,n,e){return 40&t.type?H(t,e):null};function pS(t,n,e,r){const i=hS(t,r,n),o=n[11],c=pL(r.parent||n[5],r,n);if(null!=i)if(Array.isArray(e))for(let f=0;f<e.length;f++)zO(o,i,e[f],c,!1);else zO(o,i,e,c,!1)}function Cm(t,n){if(null!==n){const e=n.type;if(3&e)return H(n,t);if(4&e)return Qx(-1,t[n.index]);if(8&e){const r=n.child;if(null!==r)return Cm(t,r);{const i=t[n.index];return vo(i)?Qx(-1,i):L(i)}}if(128&e)return Cm(t,n.next);if(32&e)return aS(n,t)()||L(t[n.index]);{const r=yL(t,n);return null!==r?Array.isArray(r)?r[0]:Cm(pn(t[15]),r):Cm(t,n.next)}}return null}function yL(t,n){return null!==n?t[15][5].projection[n.projection]:null}function Qx(t,n){const e=10+t+1;if(e<n.length){const r=n[e],i=r[1].firstChild;if(null!==i)return Cm(r,i)}return n[7]}function mS(t,n,e,r,i,o,a){for(;null!=e;){const c=r[9];if(128===e.type){e=e.next;continue}const f=r[e.index],_=e.type;if(a&&0===n&&(f&&ye(L(f),r),e.flags|=2),!gh(e))if(8&_)mS(t,n,e.child,r,i,o,!1),M_(n,t,c,i,f,e,o,r);else if(32&_){const x=aS(e,r);let D;for(;D=x();)M_(n,t,c,i,D,e,o,r);M_(n,t,c,i,f,e,o,r)}else 16&_?vL(t,n,r,e,i,o):M_(n,t,c,i,f,e,o,r);e=a?e.projectionNext:e.next}}function Jx(t,n,e,r,i,o){mS(e,r,t.firstChild,n,i,o,!1)}function vL(t,n,e,r,i,o){const a=e[15],f=a[5].projection[r.projection];if(Array.isArray(f))for(let _=0;_<f.length;_++)M_(n,t,e[9],i,f[_],r,o,e);else{let _=f;const x=a[3];m(r)&&(_.flags|=128),mS(t,n,_,x,i,o,!0)}}function bL(t,n,e,r,i){const o=co(),a=2&r;try{Yu(-1),a&&n.length>27&&JO(t,n,27,!1),gr(a?Ct.TemplateUpdateStart:Ct.TemplateCreateStart,i,e),e(r,i)}finally{Yu(o),gr(a?Ct.TemplateUpdateEnd:Ct.TemplateCreateEnd,i,e)}}function e1(t,n,e){(function a9(t,n,e){const r=e.directiveStart,i=e.directiveEnd;ao(e)&&function B7(t,n,e){const r=H(n,t),i=function QO(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=rS(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}(e),o=t[10].rendererFactory,a=oS(t,Wx(t,i,null,iS(e),r,n,null,o.createRenderer(r,e),null,null,null));t[n.index]=a}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||eu(e,n);const o=e.initialInputs;for(let a=r;a<i;a++){const c=t.data[a],f=Ff(n,t,a,e);ye(f,n),null!==o&&d9(0,a-r,f,c,0,o),us(c)&&(ae(e.index,n)[8]=Ff(n,t,a,e))}})(t,n,e),!(64&~e.flags)&&function l9(t,n,e){const r=e.directiveStart,i=e.directiveEnd,o=e.index,a=function Qd(){return et.lFrame.currentDirectiveIndex}();try{Yu(o);for(let c=r;c<i;c++){const f=t.data[c],_=n[c];Qc(c),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&c9(f,_)}}finally{Yu(-1),Qc(a)}}(t,n,e)}function R_(t,n,e=H){const r=n.localNames;if(null!==r){let i=n.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],c=-1===a?e(n,t):t[a];t[i++]=c}}}let wL=()=>null;function t1(t,n,e,r,i,o){o1(t,n[1],n,e,r)?ao(t)&&function xL(t,n){const e=ae(n,t);16&e[2]||(e[2]|=64)}(n,t.index):(3&t.type&&(e=function s9(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(e)),gS(t,n,e,r,i,o))}function gS(t,n,e,r,i,o){if(3&t.type){const a=H(t,n);r=null!=o?o(r,t.value||"",e):r,i.setProperty(a,e,r)}}function c9(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function _S(t,n){const e=t.directiveRegistry;let r=null;if(e)for(let i=0;i<e.length;i++){const o=e[i];YO(n,o.selectors,!1)&&(r??=[],us(o)?r.unshift(o):r.push(o))}return r}function d9(t,n,e,r,i,o){const a=o[n];if(null!==a)for(let c=0;c<a.length;c+=2)xm(r,e,a[c],a[c+1])}function r1(t,n,e,r,i){const o=27+e,a=n[1],c=i(a,n,t,r,e);n[o]=c,Ns(t,!0);const f=2===t.type;return f?(jO(n[11],c,t),(0===function Rt(){return et.lFrame.elementDepthCount}()||Ki(t))&&ye(c,n),function rr(){et.lFrame.elementDepthCount++}()):ye(c,n),$g()&&(!f||!gh(t))&&pS(a,n,c,t),t}function i1(t){let n=t;return Yc()?ca():(n=n.parent,Ns(n,!1)),n}function o1(t,n,e,r,i){const o=t.inputs?.[r],a=t.hostDirectiveInputs?.[r];let c=!1;if(a)for(let f=0;f<a.length;f+=2){const _=a[f];xm(n.data[_],e[_],a[f+1],i),c=!0}if(o)for(const f of o)xm(n.data[f],e[f],r,i),c=!0;return c}function f9(t,n){const e=ae(n,t),r=e[1];!function p9(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(r,e);const i=e[0];null!==i&&null===e[6]&&(e[6]=null),gr(Ct.ComponentStart);try{s1(r,e,e[8])}finally{gr(Ct.ComponentEnd,e[8])}}function s1(t,n,e){Hg(n);try{const r=t.viewQuery;null!==r&&GT(1,r,e);const i=t.template;null!==i&&bL(t,n,i,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[18]?.finishViewCreation(t),t.staticContentQueries&&bO(t,n),t.staticViewQueries&&GT(2,t.viewQuery,e);const o=t.components;null!==o&&function m9(t,n){for(let e=0;e<n.length;e++)f9(t,n[e])}(n,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[2]&=-5,Yp()}}function P_(t,n,e,r){const i=Tt(null);try{const o=n.tView,f=Wx(t,o,e,4096&t[2]?4096:16,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);f[16]=t[n.index];const x=t[18];return null!==x&&(f[18]=x.createEmbeddedView(o)),s1(o,f,e),f}finally{Tt(i)}}function Dm(t,n){return!n||null===n.firstChild||m(t)}function zv(t,n,e,r,i=!1){for(;null!==e;){if(128===e.type){e=i?e.projectionNext:e.next;continue}const o=n[e.index];null!==o&&r.push(L(o)),vo(o)&&g9(o,r);const a=e.type;if(8&a)zv(t,n,e.child,r);else if(32&a){const c=aS(e,n);let f;for(;f=c();)r.push(f)}else if(16&a){const c=yL(n,e);if(Array.isArray(c))r.push(...c);else{const f=pn(n[15]);zv(f[1],f,c,r,!0)}}e=i?e.projectionNext:e.next}return r}function g9(t,n){for(let e=10;e<t.length;e++){const r=t[e],i=r[1].firstChild;null!==i&&zv(r[1],r,i,n)}t[7]!==t[0]&&n.push(t[7])}function DL(t){if(null!==t[25]){for(const n of t[25])n.impl.addSequence(n);t[25].length=0}}let TL=[];const b9={...zl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{Et(t.lView)},consumerOnSignalRead(){this.lView[24]=this}},x9={...zl,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let n=pn(t.lView);for(;n&&!SL(n[1]);)n=pn(n);n&&Le(n)},consumerOnSignalRead(){this.lView[24]=this}};function SL(t){return 2!==t.type}function IL(t){if(null===t[23])return;let n=!0;for(;n;){let e=!1;for(const r of t[23])r.dirty&&(e=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));n=e&&!!(8192&t[2])}}function a1(t,n=0){const r=t[10].rendererFactory;r.begin?.();try{!function C9(t,n){const e=lc();try{Mr(!0),vS(t,n);let r=0;for(;qe(t);){if(100===r)throw new ue(103,!1);r++,vS(t,1)}}finally{Mr(e)}}(t,n)}finally{r.end?.()}}function kL(t,n,e,r){if(Ps(n))return;const i=n[2];Hg(n);let c=!0,f=null,_=null;SL(t)?(_=function _9(t){return t[24]??function y9(t){const n=TL.pop()??Object.create(b9);return n.lView=t,n}(t)}(n),f=ns(_)):null===function Gt(){return eo}()?(c=!1,_=function w9(t){const n=t[24]??Object.create(x9);return n.lView=t,n}(n),f=ns(_)):n[24]&&(Es(n[24]),n[24]=null);try{Me(n),function Zu(t){return et.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&bL(t,n,e,2,r);const x=!(3&~i);if(x){const N=t.preOrderCheckHooks;null!==N&&nm(n,N,null)}else{const N=t.preOrderHooks;null!==N&&rm(n,N,0,null),hv(n,0)}if(function D9(t){for(let n=rn(t);null!==n;n=Cn(n)){if(!(2&n[2]))continue;const e=n[9];for(let r=0;r<e.length;r++)Le(e[r])}}(n),IL(n),AL(n,0),null!==t.contentQueries&&bO(t,n),x){const N=t.contentCheckHooks;null!==N&&nm(n,N)}else{const N=t.contentHooks;null!==N&&rm(n,N,1),hv(n,1)}!function S9(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const i=e[r];if(i<0)Yu(~i);else{const o=i,a=e[++r],c=e[++r];Ug(a,o);const f=n[o];gr(Ct.HostBindingsUpdateStart,f);try{c(2,f)}finally{gr(Ct.HostBindingsUpdateEnd,f)}}}}finally{Yu(-1)}}(t,n);const D=t.components;null!==D&&RL(n,D,0);const A=t.viewQuery;if(null!==A&&GT(2,A,r),x){const N=t.viewCheckHooks;null!==N&&nm(n,N)}else{const N=t.viewHooks;null!==N&&rm(n,N,2),hv(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[22]){for(const N of n[22])N();n[22]=null}DL(n),n[2]&=-73}catch(x){throw Et(n),x}finally{null!==_&&(Da(_,f),c&&function v9(t){t.lView[24]!==t&&(t.lView=null,TL.push(t))}(_)),Yp()}}function AL(t,n){for(let e=rn(t);null!==e;e=Cn(e))for(let r=10;r<e.length;r++)ML(e[r],n)}function T9(t,n,e){gr(Ct.ComponentStart);const r=ae(n,t);try{ML(r,e)}finally{gr(Ct.ComponentEnd,r[8])}}function ML(t,n){be(t)&&vS(t,n)}function vS(t,n){const r=t[1],i=t[2],o=t[24];let a=!!(0===n&&16&i);if(a||=!!(64&i&&0===n),a||=!!(1024&i),a||=!(!o?.dirty||!Bi(o)),a||=!1,o&&(o.dirty=!1),t[2]&=-9217,a)kL(r,t,r.template,t[8]);else if(8192&i){const c=Tt(null);try{IL(t),AL(t,1);const f=r.components;null!==f&&RL(t,f,1),DL(t)}finally{Tt(c)}}}function RL(t,n,e){for(let r=0;r<n.length;r++)T9(t,n[r],e)}function N_(t,n){const e=lc()?64:1088;for(t[10].changeDetectionScheduler?.notify(n);t;){t[2]|=e;const r=pn(t);if(ds(t)&&!r)return t;t=r}return null}function PL(t,n,e,r){return[t,!0,0,n,null,r,null,e,null,null]}function NL(t,n){const e=10+n;if(e<t.length)return t[e]}function O_(t,n,e,r=!0){const i=n[1];if(function I9(t,n,e,r){const i=10+r,o=e.length;r>0&&(e[i-1][4]=n),r<o-10?(n[4]=e[i],Uu(e,10+r,n)):(e.push(n),n[4]=null),n[3]=e;const a=n[16];null!==a&&e!==a&&OL(a,n);const c=n[18];null!==c&&c.insertView(t),at(n),n[2]|=128}(i,n,t,e),r){const a=Qx(e,t),c=n[11],f=c.parentNode(t[7]);null!==f&&function Z7(t,n,e,r,i,o){r[0]=i,r[5]=n,Jx(t,r,e,1,i,o)}(i,t[5],c,n,f,a)}const o=n[6];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function bS(t,n){const e=Uv(t,n);return void 0!==e&&Vv(e[1],e),e}function Uv(t,n){if(t.length<=10)return;const e=10+n,r=t[e];if(r){const i=r[16];null!==i&&i!==t&&uS(i,r),n>0&&(t[e-1][4]=r[4]);const o=as(t,10+n);!function uL(t,n){dL(t,n),n[0]=null,n[5]=null}(r[1],r);const a=o[18];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function OL(t,n){const e=t[9],r=n[3];(En(r)||n[15]!==r[3][15])&&(t[2]|=2),null===e?t[9]=[n]:e.push(n)}class jv{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){const n=this._lView,e=n[1];return zv(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return Ps(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(vo(n)){const e=n[8],r=e?e.indexOf(this):-1;r>-1&&(Uv(n,r),as(e,r))}this._attachedToViewContainer=!1}Vv(this._lView[1],this._lView)}onDestroy(n){It(this._lView,n)}markForCheck(){N_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[2]&=-129}reattach(){at(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,a1(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ue(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const n=ds(this._lView),e=this._lView[16];null!==e&&!n&&uS(e,this._lView),dL(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ue(902,!1);this._appRef=n;const e=ds(this._lView),r=this._lView[16];null!==r&&!e&&OL(r,this._lView),at(this._lView)}}let kl=(()=>class t{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=k9;constructor(e,r,i){this._declarationLView=e,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,r){return this.createEmbeddedViewImpl(e,r)}createEmbeddedViewImpl(e,r,i){const o=P_(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:r,dehydratedView:i});return new jv(o)}})();function k9(){return l1(Xt(),Pe())}function l1(t,n){return 4&t.type?new kl(n,t,ch(t,n)):null}function Tm(t,n,e,r,i){let o=t.data[n];if(null===o)o=function CS(t,n,e,r,i){const o=Zc(),a=Yc(),f=t.data[n]=function B9(t,n,e,r,i,o){let a=n?n.injectorIndex:-1,c=0;return yi()&&(c|=128),{type:e,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:c,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,e,n,r,i);return function F9(t,n,e,r){null===t.firstChild&&(t.firstChild=n),null!==e&&(r?null==e.child&&null!==n.parent&&(e.child=n):null===e.next&&(e.next=n,n.prev=e))}(t,f,o,a),f}(t,n,e,r,i),function Sf(){return et.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=r,o.attrs=i;const a=function la(){const t=et.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===a?-1:a.injectorIndex}return Ns(o,!0),o}function eF(t,n){let e=0,r=t.firstChild;if(r){const i=t.data.r;for(;e<i;){const o=r.nextSibling;Lv(n,r,!1),r=o,e++}}}let bK=class{},sF=class{};class wK{resolveComponentFactory(n){throw new ue(917,!1)}}let g1=class{static NULL=new wK};class Al{}let Ka=(()=>class t{destroyNode=null;static __NG_ELEMENT_ID__=()=>function xK(){const t=Pe(),e=ae(Xt().index,t);return(En(e)?e:t)[11]}()})(),EK=(()=>{class t{static \u0275prov=je({token:t,providedIn:"root",factory:()=>null})}return t})();const RS={};class F_{injector;parentInjector;constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){const i=this.injector.get(n,RS,r);return i!==RS||e===RS?i:this.parentInjector.get(n,e,r)}}function y1(t,n,e){let r=e?t.styles:null,i=e?t.classes:null,o=0;if(null!==n)for(let a=0;a<n.length;a++){const c=n[a];"number"==typeof c?o=c:1==o?i=fn(i,c):2==o&&(r=fn(r,c+": "+n[++a]+";"))}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=i:t.classesWithoutHost=i}function Re(t,n=0){const e=Pe();return null===e?Dt(t,n):vx(Xt(),e,mn(t),n)}function cF(t,n,e,r,i){const o=null===r?null:{"":-1},a=i(t,e);if(null!==a){let c=a,f=null,_=null;for(const x of a)if(null!==x.resolveHostDirectives){[c,f,_]=x.resolveHostDirectives(a);break}!function kK(t,n,e,r,i,o,a){const c=r.length;let f=null;for(let A=0;A<c;A++){const N=r[A];null===f&&us(N)&&(f=N,IK(t,e,A)),sm(eu(e,n),t,N.type)}(function OK(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n})(e,t.data.length,c),f?.viewProvidersResolver&&f.viewProvidersResolver(f);for(let A=0;A<c;A++){const N=r[A];N.providersResolver&&N.providersResolver(N)}let _=!1,x=!1,D=Bv(t,n,c,null);c>0&&(e.directiveToIndex=new Map);for(let A=0;A<c;A++){const N=r[A];if(e.mergedAttrs=Of(e.mergedAttrs,N.hostAttrs),MK(t,e,n,D,N),NK(D,N,i),null!==a&&a.has(N)){const[te,ce]=a.get(N);e.directiveToIndex.set(N.type,[D,te+e.directiveStart,ce+e.directiveStart])}else(null===o||!o.has(N))&&e.directiveToIndex.set(N.type,D);null!==N.contentQueries&&(e.flags|=4),(null!==N.hostBindings||null!==N.hostAttrs||0!==N.hostVars)&&(e.flags|=64);const B=N.type.prototype;!_&&(B.ngOnChanges||B.ngOnInit||B.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),_=!0),!x&&(B.ngOnChanges||B.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),x=!0),D++}!function AK(t,n,e){for(let r=n.directiveStart;r<n.directiveEnd;r++){const i=t.data[r];if(null!==e&&e.has(i)){const o=e.get(i);dF(0,n,o,r),dF(1,n,o,r),fF(n,r,!0)}else uF(0,n,i,r),uF(1,n,i,r),fF(n,r,!1)}}(t,e,o)}(t,n,e,c,o,f,_)}null!==o&&null!==r&&function SK(t,n,e){const r=t.localNames=[];for(let i=0;i<n.length;i+=2){const o=e[n[i+1]];if(null==o)throw new ue(-301,!1);r.push(n[i],o)}}(e,r,o)}function IK(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function uF(t,n,e,r){const i=0===t?e.inputs:e.outputs;for(const o in i)if(i.hasOwnProperty(o)){let a;a=0===t?n.inputs??={}:n.outputs??={},a[o]??=[],a[o].push(r),hF(n,o)}}function dF(t,n,e,r){const i=0===t?e.inputs:e.outputs;for(const o in i)if(i.hasOwnProperty(o)){const a=i[o];let c;c=0===t?n.hostDirectiveInputs??={}:n.hostDirectiveOutputs??={},c[a]??=[],c[a].push(r,o),hF(n,a)}}function hF(t,n){"class"===n?t.flags|=8:"style"===n&&(t.flags|=16)}function fF(t,n,e){const{attrs:r,inputs:i,hostDirectiveInputs:o}=t;if(null===r||!e&&null===i||e&&null===o||nS(t))return t.initialInputs??=[],void t.initialInputs.push(null);let a=null,c=0;for(;c<r.length;){const f=r[c];if(0!==f)if(5!==f){if("number"==typeof f)break;if(!e&&i.hasOwnProperty(f)){const _=i[f];for(const x of _)if(x===n){a??=[],a.push(f,r[c+1]);break}}else if(e&&o.hasOwnProperty(f)){const _=o[f];for(let x=0;x<_.length;x+=2)if(_[x]===n){a??=[],a.push(_[x+1],r[c+1]);break}}c+=2}else c+=2;else c+=4}t.initialInputs??=[],t.initialInputs.push(a)}function MK(t,n,e,r,i){t.data[r]=i;const o=i.factory||(i.factory=Ba(i.type)),a=new im(o,us(i),Re,null);t.blueprint[r]=a,e[r]=a,function RK(t,n,e,r,i){const o=i.hostBindings;if(o){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const c=~n.index;(function PK(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=c&&a.push(c),a.push(e,r,o)}}(t,n,r,Bv(t,e,i.hostVars,Nr),i)}function NK(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;us(n)&&(e[""]=t)}}function PS(t,n,e,r,i,o,a,c){const f=n[1],_=f.consts,D=Tm(f,t,e,r,De(_,a));return o&&cF(f,n,D,De(_,c),i),D.mergedAttrs=Of(D.mergedAttrs,D.attrs),null!==D.attrs&&y1(D,D.attrs,!1),null!==D.mergedAttrs&&y1(D,D.mergedAttrs,!0),null!==f.queries&&f.queries.elementStart(f,D),D}function NS(t,n){Qg(t,n),Gu(n)&&t.queries.elementEnd(n)}function ud(t,n,e){return t[n]=e}function li(t,n,e){return e!==Nr&&(!Object.is(t[n],e)&&(t[n]=e,!0))}function km(t,n,e,r){const i=li(t,n,e);return li(t,n+1,r)||i}function wh(t,n,e){return function r(i){N_(ao(t)?ae(t.index,n):n,5);const a=n[8];let c=gF(n,a,e,i),f=r.__ngNextListenerFn__;for(;f;)c=gF(n,a,f,i)&&c,f=f.__ngNextListenerFn__;return c}}function gF(t,n,e,r){const i=Tt(null);try{return gr(Ct.OutputStart,n,e),!1!==e(r)}catch(o){return function yS(t,n){const e=t[9];if(!e)return;let r;try{r=e.get(El,null)}catch{r=null}r?.(n)}(t,o),!1}finally{gr(Ct.OutputEnd,n,e),Tt(i)}}function w1(t,n,e,r,i,o,a,c){const f=Ki(t);let _=!1,x=null;if(!r&&f&&(x=function zK(t,n,e,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const a=i[o];if(a===e&&i[o+1]===r){const c=n[7],f=i[o+2];return c&&c.length>f?c[f]:null}"string"==typeof a&&(o+=2)}return null}(n,e,o,t.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=a,x.__ngLastListenerFn__=a,_=!0;else{const D=H(t,e),A=r?r(D):D,N=i.listen(A,o,c);(function VK(t){return t.startsWith("animation")||t.startsWith("transition")})(o)||_F(r?te=>r(L(te[t.index])):t.index,n,e,o,c,N,!1)}return _}function _F(t,n,e,r,i,o,a){const c=n.firstCreatePass?Yt(n):null,f=ut(e),_=f.length;f.push(i,o),c&&c.push(r,t,_,(_+1)*(a?-1:1))}function B_(t,n,e,r,i,o){const c=n[1],D=n[e][c.data[e].outputs[r]].subscribe(o);_F(t.index,c,n,i,o,D,!0)}const xh=Symbol("BINDING");class bF extends g1{ngModule;constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=ln(n);return new Jv(e,this.ngModule)}}class Jv extends sF{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function KK(t){return Object.keys(t).map(n=>{const[e,r,i]=t[n],o={propName:e,templateName:n,isSignal:0!==(r&Kx.SignalBased)};return i&&(o.transform=i),o})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function ZK(t){return Object.keys(t).map(n=>({propName:t[n],templateName:n}))}(this.componentDef.outputs),this.cachedOutputs}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function O7(t){return t.map(N7).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors??[],this.isBoundToModule=!!e}create(n,e,r,i,o,a){gr(Ct.DynamicComponentStart);const c=Tt(null);try{const f=this.componentDef,_=function eZ(t,n,e,r){const i=t?["ng-version","21.1.2"]:function L7(t){const n=[],e=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&n.push(o,t[++r]):8===i&&e.push(o);else{if(!lu(i))break;i=o}r++}return e.length&&n.push(1,...e),n}(n.selectors[0]);let o=null,a=null,c=0;if(e)for(const x of e)c+=x[xh].requiredVars,x.create&&(x.targetIdx=0,(o??=[]).push(x)),x.update&&(x.targetIdx=0,(a??=[]).push(x));if(r)for(let x=0;x<r.length;x++){const D=r[x];if("function"!=typeof D)for(const A of D.bindings){c+=A[xh].requiredVars;const N=x+1;A.create&&(A.targetIdx=N,(o??=[]).push(A)),A.update&&(A.targetIdx=N,(a??=[]).push(A))}}const f=[n];if(r)for(const x of r){const A=oi("function"==typeof x?x:x.type);f.push(A)}return rS(0,null,function tZ(t,n){return t||n?e=>{if(1&e&&t)for(const r of t)r.create();if(2&e&&n)for(const r of n)r.update()}:null}(o,a),1,c,f,null,null,null,[i],null)}(r,f,a,o),x=function YK(t,n,e){let r=n instanceof Hr?n:n?.injector;return r&&null!==t.getStandaloneInjector&&(r=t.getStandaloneInjector(r)||r),r?new F_(e,r):e}(f,i||this.ngModule,n),D=function XK(t){const n=t.get(Al,null);if(null===n)throw new ue(407,!1);return{rendererFactory:n,sanitizer:t.get(EK,null),changeDetectionScheduler:t.get(Af,null),ngReflect:!1}}(x),A=D.rendererFactory.createRenderer(null,f),N=r?function r9(t,n,e,r){const o=r.get(hm,!1)||e===bc.ShadowDom||e===bc.ExperimentalIsolatedShadowDom,a=t.selectRootElement(n,o);return function i9(t){wL(t)}(a),a}(A,r,f.encapsulation,x):function QK(t,n){const e=function JK(t){return(t.selectors[0][0]||"div").toLowerCase()}(t);return qx(n,e,"svg"===e?"svg":"math"===e?"math":null)}(f,A),B=a?.some(wF)||o?.some(we=>"function"!=typeof we&&we.bindings.some(wF)),te=Wx(null,_,null,512|iS(f),null,null,D,A,x,null,null);te[27]=N,Hg(te);let ce=null;try{const we=PS(27,te,2,"#host",()=>_.directiveRegistry,!0,0);jO(A,N,we),ye(N,te),e1(_,te,we),WT(_,we,te),NS(_,we),void 0!==e&&function rZ(t,n,e){const r=t.projection=[];for(let i=0;i<n.length;i++){const o=e[i];r.push(null!=o&&o.length?Array.from(o):null)}}(we,this.ngContentSelectors,e),ce=ae(we.index,te),te[8]=ce[8],s1(_,te,null)}catch(we){throw null!==ce&&V(ce),V(te),we}finally{gr(Ct.DynamicComponentEnd),Yp()}return new nZ(this.componentType,te,!!B)}finally{Tt(c)}}}function wF(t){const n=t[xh].kind;return"input"===n||"twoWay"===n}class nZ extends bK{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(n,e,r){super(),this._rootLView=e,this._hasInputBindings=r,this._tNode=ne(e[1],27),this.location=ch(this._tNode,e),this.instance=ae(this._tNode.index,e)[8],this.hostView=this.changeDetectorRef=new jv(e,void 0),this.componentType=n}setInput(n,e){const r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const i=this._rootLView;o1(r,i[1],i,n,e),this.previousInputValues.set(n,e),N_(ae(r.index,i),1)}get injector(){return new ai(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}let Ml=(()=>class t{static __NG_ELEMENT_ID__=iZ})();function iZ(){return CF(Xt(),Pe())}const oZ=Ml,xF=class extends oZ{_lContainer;_hostTNode;_hostLView;constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return ch(this._hostTNode,this._hostLView)}get injector(){return new ai(this._hostTNode,this._hostLView)}get parentInjector(){const n=r_(this._hostTNode,this._hostLView);if(rd(n)){const e=sh(n,this._hostLView),r=oh(n);return new ai(e[1].data[r+8],e)}return new ai(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=EF(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,r){let i,o;"number"==typeof r?i=r:null!=r&&(i=r.index,o=r.injector);const c=n.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(c,i,Dm(this._hostTNode,null)),c}createComponent(n,e,r,i,o,a,c){const f=n&&!function ed(t){return"function"==typeof t}(n);let _;if(f)_=e;else{const ce=e||{};_=ce.index,r=ce.injector,i=ce.projectableNodes,o=ce.environmentInjector||ce.ngModuleRef,a=ce.directives,c=ce.bindings}const x=f?n:new Jv(ln(n)),D=r||this.parentInjector;if(!o&&null==x.ngModule){const we=(f?D:this.parentInjector).get(Hr,null);we&&(o=we)}ln(x.componentType??{});const te=x.create(D,i,null,o,a,c);return this.insertImpl(te.hostView,_,Dm(this._hostTNode,null)),te}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,r){const i=n._lView;if(function Ae(t){return vo(t[3])}(i)){const c=this.indexOf(n);if(-1!==c)this.detach(c);else{const f=i[3],_=new xF(f,f[5],f[3]);_.detach(_.indexOf(n))}}const o=this._adjustIndex(e),a=this._lContainer;return O_(a,i,o,r),n.attachToViewContainerRef(),Uu(LS(a),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=EF(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),r=Uv(this._lContainer,e);r&&(as(LS(this._lContainer),e),Vv(r[1],r))}detach(n){const e=this._adjustIndex(n,-1),r=Uv(this._lContainer,e);return r&&null!=as(LS(this._lContainer),e)?new jv(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function EF(t){return t[8]}function LS(t){return t[8]||(t[8]=[])}function CF(t,n){let e;const r=n[t.index];return vo(r)?e=r:(e=PL(r,n,null,t),n[t.index]=e,oS(n,e)),DF(e,n,t,r),new xF(e,t,n)}let DF=function SF(t,n,e,r){if(t[7])return;let i;i=8&e.type?L(r):function sZ(t,n){const e=t[11],r=e.createComment(""),i=H(n,t),o=e.parentNode(i);return wm(e,o,r,e.nextSibling(i),!1),r}(n,e),t[7]=i};class BS{queryList;matches=null;constructor(n){this.queryList=n}clone(){return new BS(this.queryList)}setDirty(){this.queryList.setDirty()}}class VS{queries;constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const r=null!==n.contentQueries?n.contentQueries[0]:e.length,i=[];for(let o=0;o<r;o++){const a=e.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new VS(i)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==$S(n,e).matches&&this.queries[e].setDirty()}}class IF{flags;read;predicate;constructor(n,e,r=null){this.flags=e,this.read=r,this.predicate="string"==typeof n?function fZ(t){return t.split(",").map(n=>n.trim())}(n):n}}class zS{queries;constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){const i=null!==e?e.length:0,o=this.getByIndex(r).embeddedTView(n,i);o&&(o.indexInDeclarationView=r,null!==e?e.push(o):e=[o])}return null!==e?new zS(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class US{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(n,e=-1){this.metadata=n,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new US(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];this.matchTNodeWithReadOption(n,e,cZ(e,o)),this.matchTNodeWithReadOption(n,e,i_(e,n,o,!1,!1))}else r===kl?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,i_(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Vr||i===Ml||i===kl&&4&e.type)this.addMatch(e.index,-2);else{const o=i_(e,n,i,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,r)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function cZ(t,n){const e=t.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1];return null}function dZ(t,n,e,r){return-1===e?function uZ(t,n){return 11&t.type?ch(t,n):4&t.type?l1(t,n):null}(n,t):-2===e?function hZ(t,n,e){return e===Vr?ch(n,t):e===kl?l1(n,t):e===Ml?CF(n,t):void 0}(t,n,r):Ff(t,t[1],e,n)}function kF(t,n,e,r){const i=n[18].queries[r];if(null===i.matches){const o=t.data,a=e.matches,c=[];for(let f=0;null!==a&&f<a.length;f+=2){const _=a[f];c.push(_<0?null:dZ(n,o[_],a[f+1],e.metadata.read))}i.matches=c}return i.matches}function jS(t,n,e,r){const i=t.queries.getByIndex(e),o=i.matches;if(null!==o){const a=kF(t,n,i,e);for(let c=0;c<o.length;c+=2){const f=o[c];if(f>0)r.push(a[c/2]);else{const _=o[c+1],x=n[-f];for(let D=10;D<x.length;D++){const A=x[D];A[16]===A[3]&&jS(A[1],A,_,r)}if(null!==x[9]){const D=x[9];for(let A=0;A<D.length;A++){const N=D[A];jS(N[1],N,_,r)}}}}}return r}function AF(t,n,e){const r=new od(!(4&~e));return function dn(t,n,e,r){const i=ut(n);i.push(e),t.firstCreatePass&&Yt(t).push(r,i.length-1)}(t,n,r,r.destroy),(n[18]??=new VS).queries.push(new BS(r))-1}function PF(t,n,e){null===t.queries&&(t.queries=new zS),t.queries.track(new US(n,e))}function $S(t,n){return t.queries.getByIndex(n)}function NF(t,n){const e=t[1],r=$S(e,n);return r.crossesNgTemplate?jS(e,t,n,[]):kF(e,t,r,n)}let Eh=class{},zF=class{};class ZS extends Eh{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new bF(this);constructor(n,e,r,i=!0){super(),this.ngModuleType=n,this._parent=e;const o=ss(n);this._bootstrapComponents=cd(o.bootstrap),this._r3Injector=Hw(n,e,[{provide:Eh,useValue:this},{provide:g1,useValue:this.componentFactoryResolver},...r],xn(n),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class UF extends zF{moduleType;constructor(n){super(),this.moduleType=n}create(n){return new ZS(this.moduleType,n,[])}}class jF extends Eh{injector;componentFactoryResolver=new bF(this);instance=null;constructor(n){super();const e=new oa([...n.providers,{provide:Eh,useValue:this},{provide:g1,useValue:this.componentFactoryResolver}],n.parent||rc(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function x1(t,n,e=null){return new jF({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}let xZ=(()=>{class t{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const r=Wc(0,e.type),i=r.length>0?x1([r],this._injector,""):null;this.cachedInjectors.set(e,i)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=je({token:t,providedIn:"environment",factory:()=>new t(Dt(Hr))})}return t})();function _r(t){return dc(()=>{const n=$F(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===E.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:n.standalone?i=>i.get(xZ).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||bc.Emulated,styles:t.styles||Ar,_:null,schemas:t.schemas||null,tView:null,id:""};n.standalone&&Jo("NgStandalone"),qF(e);const r=t.dependencies;return e.directiveDefs=E1(r,HF),e.pipeDefs=E1(r,oo),e.id=function TZ(t){let n=0;const r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,"function"==typeof t.consts?"":t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(const o of r.join("|"))n=Math.imul(31,n)+o.charCodeAt(0)|0;return n+=2147483648,"c"+n}(e),e})}function HF(t){return ln(t)||oi(t)}function Io(t){return dc(()=>({type:t.type,bootstrap:t.bootstrap||Ar,declarations:t.declarations||Ar,imports:t.imports||Ar,exports:t.exports||Ar,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function EZ(t,n){if(null==t)return As;const e={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r];let o,a,c,f;Array.isArray(i)?(c=i[0],o=i[1],a=i[2]??o,f=i[3]||null):(o=i,a=i,c=Kx.None,f=null),e[o]=[r,c,f],n[o]=a}return e}function CZ(t){if(null==t)return As;const n={};for(const e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}function Ft(t){return dc(()=>{const n=$F(t);return qF(n),n})}function Za(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:t.standalone??!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function $F(t){const n={};return{type:t.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputConfig:t.inputs||As,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:!0===t.signals,selectors:t.selectors||Ar,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:EZ(t.inputs,n),outputs:CZ(t.outputs),debugInfo:null}}function qF(t){t.features?.forEach(n=>n(t))}function E1(t,n){return t?()=>{const e="function"==typeof t?t():t,r=[];for(const i of e){const o=n(i);null!==o&&r.push(o)}return r}:null}function qn(t){let n=function kZ(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const r=[t];for(;n;){let i;if(us(t))i=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ue(903,!1);i=n.\u0275dir}if(i){if(e){r.push(i);const a=t;a.inputs=XS(t.inputs),a.declaredInputs=XS(t.declaredInputs),a.outputs=XS(t.outputs);const c=i.hostBindings;c&&NZ(t,c);const f=i.viewQuery,_=i.contentQueries;if(f&&RZ(t,f),_&&PZ(t,_),AZ(t,i),Fr(t.outputs,i.outputs),us(i)&&i.data.animation){const x=t.data;x.animation=(x.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let a=0;a<o.length;a++){const c=o[a];c&&c.ngInherit&&c(t),c===qn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function MZ(t){let n=0,e=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=n+=i.hostVars,i.hostAttrs=Of(i.hostAttrs,e=Of(e,i.hostAttrs))}}(r)}function AZ(t,n){for(const e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;const r=n.inputs[e];void 0!==r&&(t.inputs[e]=r,t.declaredInputs[e]=n.declaredInputs[e])}}function XS(t){return t===As?{}:t===Ar?[]:t}function RZ(t,n){const e=t.viewQuery;t.viewQuery=e?(r,i)=>{n(r,i),e(r,i)}:n}function PZ(t,n){const e=t.contentQueries;t.contentQueries=e?(r,i,o)=>{n(r,i,o),e(r,i,o)}:n}function NZ(t,n){const e=t.hostBindings;t.hostBindings=e?(r,i)=>{n(r,i),e(r,i)}:n}function XF(t,n,e,r,i,o,a,c){if(e.firstCreatePass){t.mergedAttrs=Of(t.mergedAttrs,t.attrs);const x=t.tView=rS(2,t,i,o,a,e.directiveRegistry,e.pipeRegistry,null,e.schemas,e.consts,null);null!==e.queries&&(e.queries.template(e,t),x.queries=e.queries.embeddedTView(t))}c&&(t.flags|=c),Ns(t,!1);const f=JF(e,n,t,r);$g()&&pS(e,n,f,t),ye(f,n);const _=PL(f,n,f,t);n[r+27]=_,oS(n,_)}function Mm(t,n,e,r,i,o,a,c,f,_,x){const D=e+27;let A;if(n.firstCreatePass){if(A=Tm(n,D,4,a||null,c||null),null!=_){const N=De(n.consts,_);A.localNames=[];for(let B=0;B<N.length;B+=2)A.localNames.push(N[B],-1)}}else A=n.data[D];return XF(A,t,n,e,r,i,o,f),null!=_&&R_(t,A,x),A}function tb(t,n,e,r,i,o,a,c){const f=Pe(),_=Ht();return function OZ(t,n,e,r,i,o,a,c,f,_,x){const D=e+27;let A;n.firstCreatePass?(A=Tm(n,D,4,a||null,c||null),lo()&&cF(n,t,A,De(n.consts,_),_S),Qg(n,A)):A=n.data[D],XF(A,t,n,e,r,i,o,f),Ki(A)&&e1(n,t,A),null!=_&&R_(t,A,x)}(f,_,t,n,e,r,i,De(_.consts,o),void 0,a,c),tb}let JF=function eB(t,n,e,r){return Xp(!0),n[11].createComment("")};let fB=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function gB(t){return function mB(t){return"function"==typeof t&&void 0!==t[ze]}(t)&&"function"==typeof t.set}const MB=new Fe("");function sb(t){return!!t&&"function"==typeof t.then}function PB(t){return!!t&&"function"==typeof t.subscribe}const NB=new Fe("");function sI(t){return za([{provide:NB,multi:!0,useValue:t}])}let OB=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,r)=>{this.resolve=e,this.reject=r});appInits=X(NB,{optional:!0})??[];injector=X(In);constructor(){}runInitializers(){if(this.initialized)return;const e=[];for(const i of this.appInits){const o=ji(this.injector,i);if(sb(o))e.push(o);else if(PB(o)){const a=new Promise((c,f)=>{o.subscribe({complete:c,error:f})});e.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{r()}).catch(i=>{this.reject(i)}),0===e.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const aI=new Fe("");let Qa=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=X(El);afterRenderManager=X(iL);zonelessEnabled=X(Qu);rootEffectScheduler=X(Qw);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new J;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=X(Ha);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(hr(e=>!e))}constructor(){X(A_,{optional:!0})}whenStable(){let e;return new Promise(r=>{e=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{e.unsubscribe()})}_injector=X(Hr);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,r){return this.bootstrapImpl(e,r)}bootstrapImpl(e,r,i=In.NULL){return this._injector.get(on).run(()=>{gr(Ct.BootstrapComponentStart);const a=e instanceof sF;if(!this._injector.get(OB).done)throw new ue(405,"");let f;f=a?e:this._injector.get(g1).resolveComponentFactory(e),this.componentTypes.push(f.componentType);const _=function qY(t){return t.isBoundToModule}(f)?void 0:this._injector.get(Eh),D=f.create(i,[],r||f.selector,_),A=D.location.nativeElement,N=D.injector.get(MB,null);return N?.registerApplication(A),D.onDestroy(()=>{this.detachView(D.hostView),M1(this.components,D),N?.unregisterApplication(A)}),this._loadComponent(D),gr(Ct.BootstrapComponentEnd,D),D})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){gr(Ct.ChangeDetectionStart),null!==this.tracingSnapshot?this.tracingSnapshot.run(lS.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw gr(Ct.ChangeDetectionEnd),new ue(101,!1);const e=Tt(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Tt(e),this.afterTick.next(),gr(Ct.ChangeDetectionEnd)}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Al,null,{optional:!0}));let e=0;for(;0!==this.dirtyFlags&&e++<10;){gr(Ct.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{gr(Ct.ChangeDetectionSyncEnd)}}}synchronizeOnce(){16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let e=!1;if(7&this.dirtyFlags){const r=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews)(r||qe(i))&&(a1(i,r&&!this.zonelessEnabled?0:1),e=!0);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}e||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:e})=>qe(e))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;M1(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(e),this._injector.get(aI,[]).forEach(i=>i(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>M1(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ue(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function M1(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function Ys(t,n,e,r){const i=Pe();return li(i,Zi(),n)&&(Ht(),function u9(t,n,e,r,i,o){const a=H(t,n);!function n1(t,n,e,r,i,o,a){if(null==o)t.removeAttribute(n,i,e);else{const c=null==a?tn(o):a(o,r||"",i);t.setAttribute(n,i,c,e)}}(n[11],a,o,t.value,e,r,i)}(Bo(),i,t,n,e,r)),Ys}typeof document<"u"&&document;Object.keys({disabled:"disabled",disabledReasons:"disabledReasons",dirty:"dirty",errors:"errors",hidden:"hidden",invalid:"invalid",max:"max",maxLength:"maxLength",min:"min",minLength:"minLength",name:"name",pattern:"pattern",pending:"pending",readonly:"readonly",required:"required",touched:"touched"});class _Q{destroy(n){}updateValue(n,e){}swap(n,e){const r=Math.min(n,e),i=Math.max(n,e),o=this.detach(i);if(i-r>1){const a=this.detach(r);this.attach(r,o),this.attach(i,a)}else this.attach(r,o)}move(n,e){this.attach(e,this.detach(n))}}function xI(t,n,e,r,i){return t===e&&Object.is(n,r)?1:Object.is(i(t,n),i(e,r))?-1:0}function EI(t,n,e,r){return!(void 0===n||!n.has(r)||(t.attach(e,n.get(r)),n.delete(r),0))}function oV(t,n,e,r,i){if(EI(t,n,r,e(r,i)))t.updateValue(r,i);else{const o=t.create(r,i);t.attach(r,o)}}function sV(t,n,e,r){const i=new Set;for(let o=n;o<=e;o++)i.add(r(o,t.at(o)));return i}class aV{kvMap=new Map;_vMap=void 0;has(n){return this.kvMap.has(n)}delete(n){if(!this.has(n))return!1;const e=this.kvMap.get(n);return void 0!==this._vMap&&this._vMap.has(e)?(this.kvMap.set(n,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(n),!0}get(n){return this.kvMap.get(n)}set(n,e){if(this.kvMap.has(n)){let r=this.kvMap.get(n);void 0===this._vMap&&(this._vMap=new Map);const i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,e)}else this.kvMap.set(n,e)}forEach(n){for(let[e,r]of this.kvMap)if(n(r,e),void 0!==this._vMap){const i=this._vMap;for(;i.has(r);)r=i.get(r),n(r,e)}}}function vt(t,n,e,r,i,o,a,c){Jo("NgControlFlow");const f=Pe(),_=Ht();return Mm(f,_,t,n,e,r,i,De(_.consts,o),256,a,c),CI}function CI(t,n,e,r,i,o,a,c){Jo("NgControlFlow");const f=Pe(),_=Ht();return Mm(f,_,t,n,e,r,i,De(_.consts,o),512,a,c),CI}function bt(t,n){Jo("NgControlFlow");const e=Pe(),r=Zi(),i=e[r]!==Nr?e[r]:-1,o=-1!==i?j1(e,27+i):void 0;if(li(e,r,t)){const c=Tt(null);try{if(void 0!==o&&bS(o,0),-1!==t){const f=27+t,_=j1(e,f),x=TI(e[1],f),D=null;O_(_,P_(e,x,n,{dehydratedView:D}),0,Dm(x,D))}}finally{Tt(c)}}else if(void 0!==o){const c=NL(o,0);void 0!==c&&(c[8]=n)}}class vQ{lContainer;$implicit;$index;constructor(n,e,r){this.lContainer=n,this.$implicit=e,this.$index=r}get $count(){return this.lContainer.length-10}}function DI(t){return t}function Ja(t,n){return n}class bQ{hasEmptyBlock;trackByFn;liveCollection;constructor(n,e,r){this.hasEmptyBlock=n,this.trackByFn=e,this.liveCollection=r}}function sr(t,n,e,r,i,o,a,c,f,_,x,D,A){Jo("NgControlFlow");const N=Pe(),B=Ht(),te=void 0!==f,ce=Pe(),we=c?a.bind(ce[15][8]):a,Ce=new bQ(te,we);ce[27+t]=Ce,Mm(N,B,t+1,n,e,r,i,De(B.consts,o),256),te&&Mm(N,B,t+2,f,_,x,D,De(B.consts,A),512)}class wQ extends _Q{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(n,e,r){super(),this.lContainer=n,this.hostLView=e,this.templateTNode=r}get length(){return this.lContainer.length-10}at(n){return this.getLView(n)[8].$implicit}attach(n,e){const r=e[6];this.needsIndexUpdate||=n!==this.length,O_(this.lContainer,e,n,Dm(this.templateTNode,r)),function xQ(t,n){if(t.length<=10)return;const r=t[10+n],i=r?r[26]:void 0;r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0&&(function W7(t,n){const e=t.get(Yx);if(n.detachedLeaveAnimationFns){for(const r of n.detachedLeaveAnimationFns)e.queue.delete(r);n.detachedLeaveAnimationFns=void 0}}(r[9],i),Em.delete(r[19]),i.detachedLeaveAnimationFns=void 0)}(this.lContainer,n)}detach(n){return this.needsIndexUpdate||=n!==this.length-1,function EQ(t,n){if(t.length<=10)return;const r=t[10+n],i=r?r[26]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}(this.lContainer,n),function CQ(t,n){return Uv(t,n)}(this.lContainer,n)}create(n,e){return P_(this.hostLView,this.templateTNode,new vQ(this.lContainer,e,n),{dehydratedView:null})}destroy(n){Vv(n[1],n)}updateValue(n,e){this.getLView(n)[8].$implicit=e}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let n=0;n<this.length;n++)this.getLView(n)[8].$index=n}getLView(n){return function DQ(t,n){return NL(t,n)}(this.lContainer,n)}}function ar(t){const n=Tt(null),e=co();try{const r=Pe(),i=r[1],o=r[e],a=e+1,c=j1(r,a);if(void 0===o.liveCollection){const _=TI(i,a);o.liveCollection=new wQ(c,r,_)}else o.liveCollection.reset();const f=o.liveCollection;if(function yQ(t,n,e,r){let i,o,a=0,c=t.length-1;if(Array.isArray(n)){Tt(r);let _=n.length-1;for(Tt(null);a<=c&&a<=_;){const x=t.at(a),D=n[a],A=xI(a,x,a,D,e);if(0!==A){A<0&&t.updateValue(a,D),a++;continue}const N=t.at(c),B=n[_],te=xI(c,N,_,B,e);if(0!==te){te<0&&t.updateValue(c,B),c--,_--;continue}const ce=e(a,x),we=e(c,N),Ce=e(a,D);if(Object.is(Ce,we)){const We=e(_,B);Object.is(We,ce)?(t.swap(a,c),t.updateValue(c,B),_--,c--):t.move(c,a),t.updateValue(a,D),a++;continue}if(i??=new aV,o??=sV(t,a,c,e),EI(t,i,a,Ce))t.updateValue(a,D),a++,c++;else if(o.has(Ce))i.set(ce,t.detach(a)),c--;else{const We=t.create(a,n[a]);t.attach(a,We),a++,c++}}for(;a<=_;)oV(t,i,e,a,n[a]),a++}else if(null!=n){Tt(r);const _=n[Symbol.iterator]();Tt(null);let x=_.next();for(;!x.done&&a<=c;){const D=t.at(a),A=x.value,N=xI(a,D,a,A,e);if(0!==N)N<0&&t.updateValue(a,A),a++,x=_.next();else{i??=new aV,o??=sV(t,a,c,e);const B=e(a,A);if(EI(t,i,a,B))t.updateValue(a,A),a++,c++,x=_.next();else if(o.has(B)){const te=e(a,D);i.set(te,t.detach(a)),c--}else t.attach(a,t.create(a,A)),a++,c++,x=_.next()}}for(;!x.done;)oV(t,i,e,t.length,x.value),x=_.next()}for(;a<=c;)t.destroy(t.detach(c--));i?.forEach(_=>{t.destroy(_)})}(f,t,o.trackByFn,n),f.updateIndexes(),o.hasEmptyBlock){const _=Zi(),x=0===f.length;if(li(r,_,x)){const D=e+2,A=j1(r,D);if(x){const N=TI(i,D),B=null;O_(A,P_(r,N,void 0,{dehydratedView:B}),0,Dm(N,B))}else i.firstUpdatePass&&function f1(t){const n=t[6]??[],r=t[3][11],i=[];for(const o of n)void 0!==o.data.di?i.push(o):eF(o,r);t[6]=i}(A),bS(A,0)}}}finally{Tt(n)}}function j1(t,n){return t[n]}function TI(t,n){return ne(t,n)}function gn(t,n,e){const r=Pe();return li(r,Zi(),n)&&(Ht(),t1(Bo(),r,t,n,r[11],e)),gn}function SI(t,n,e,r,i){o1(n,t,e,i?"class":"style",r)}function j(t,n,e,r){const i=Pe(),o=i[1],a=t+27,c=o.firstCreatePass?PS(a,i,2,n,_S,lo(),e,r):o.data[a];if(r1(c,i,t,n,II),Ki(c)){const f=i[1];e1(f,i,c),WT(f,c,i)}return null!=r&&R_(i,c),j}function G(){const t=Ht(),e=i1(Xt());return t.firstCreatePass&&NS(t,e),vi(e)&&bo(),$r(),null!=e.classesWithoutHost&&function Jg(t){return!!(8&t.flags)}(e)&&SI(t,e,Pe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function dx(t){return!!(16&t.flags)}(e)&&SI(t,e,Pe(),e.stylesWithoutHost,!1),G}function wt(t,n,e,r){return j(t,n,e,r),G(),wt}function Zt(t,n,e,r){const i=Pe(),o=i[1],a=t+27,c=o.firstCreatePass?function pF(t,n,e,r,i,o){const a=n.consts,f=Tm(n,t,e,r,De(a,i));if(f.mergedAttrs=Of(f.mergedAttrs,f.attrs),null!=o){const _=De(a,o);f.localNames=[];for(let x=0;x<_.length;x+=2)f.localNames.push(_[x],-1)}return null!==f.attrs&&y1(f,f.attrs,!1),null!==f.mergedAttrs&&y1(f,f.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,f),f}(a,o,2,n,e,r):o.data[a];return r1(c,i,t,n,II),null!=r&&R_(i,c),Zt}function qt(){return vi(i1(Xt()))&&bo(),$r(),qt}function dd(t,n,e,r){return Zt(t,n,e,r),qt(),dd}let II=(t,n,e,r,i)=>(Xp(!0),qx(n[11],r,function _T(){return et.lFrame.currentNamespace}()));function yn(){return Pe()}function lb(t,n,e){const r=Pe();return li(r,Zi(),n)&&(Ht(),gS(Bo(),r,t,n,r[11],e)),lb}const cb=void 0;var kQ=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],cb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],cb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202fa","h:mm:ss\u202fa","h:mm:ss\u202fa z","h:mm:ss\u202fa zzzz"],["{1}, {0}",cb,cb,cb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function IQ(t){const n=Math.floor(Math.abs(t)),e=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===e?1:5}];let K_={};function pa(t){const n=function MQ(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=fV(n);if(e)return e;const r=n.split("-")[0];if(e=fV(r),e)return e;if("en"===r)return kQ;throw new ue(701,!1)}function fV(t){return t in K_||(K_[t]=an.ng&&an.ng.common&&an.ng.common.locales&&an.ng.common.locales[t]),K_[t]}var wi=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(wi||{});const $1="en-US";let pV=$1;function Ge(t,n,e){const r=Pe(),i=Ht(),o=Xt();return NI(i,r,r[11],o,t,n,e),Ge}function ma(t,n,e){const r=Pe(),i=Ht(),o=Xt();return(3&o.type||e)&&w1(o,i,r,e,r[11],t,n,wh(o,r,n)),ma}function NI(t,n,e,r,i,o,a){let c=!0,f=null;if((3&r.type||a)&&(f??=wh(r,n,o),w1(r,t,n,a,e,i,o,f)&&(c=!1)),c){const _=r.outputs?.[i],x=r.hostDirectiveOutputs?.[i];if(x&&x.length)for(let D=0;D<x.length;D+=2){const A=x[D],N=x[D+1];f??=wh(r,n,o),B_(r,n,A,N,i,f)}if(_&&_.length)for(const D of _)f??=wh(r,n,o),B_(r,n,D,i,i,f)}}function xe(t=1){return function pT(t){return(et.lFrame.contextLView=function Qe(t,n){for(;t>0;)n=n[14],t--;return n}(t,et.lFrame.contextLView))[8]}(t)}function yJ(t,n){let e=null;const r=function A7(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let i=0;i<n.length;i++){const o=n[i];if("*"!==o){if(null===r?YO(t,o,!0):P7(r,o))return i}else e=i}return e}function K1(t,n=0,e,r,i,o){const a=Pe(),c=Ht(),f=r?t+1:null;null!==f&&Mm(a,c,f,r,i,o,null,e);const _=Tm(c,27+t,16,null,e||null);null===_.projection&&(_.projection=n),ca();const D=!a[6]||yi();null===a[15][5].projection[_.projection]&&null!==f?function vJ(t,n,e){const r=27+e,i=n.data[r],o=t[r];O_(o,P_(t,i,void 0,{dehydratedView:null}),0,Dm(i,null))}(a,c,f):D&&!gh(_)&&function e9(t,n,e){vL(n[11],0,n,e,hS(t,e,n),pL(e.parent||n[5],e,n))}(c,a,_)}function OI(t,n,e,r){return function RF(t,n,e,r){const i=Ht();if(i.firstCreatePass){const o=Xt();PF(i,new IF(n,e,r),o.index),function pZ(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(i,t),!(2&~e)&&(i.staticContentQueries=!0)}return AF(i,Pe(),e)}(t,n,e,r),OI}function op(t,n,e){return function MF(t,n,e){const r=Ht();return r.firstCreatePass&&(PF(r,new IF(t,n,e),-1),!(2&~n)&&(r.staticViewQueries=!0)),AF(r,Pe(),n)}(t,n,e),op}function hd(t){const n=Pe(),e=Ht(),r=Zp();cc(r+1);const i=$S(e,r);if(t.dirty&&function ge(t){return!(4&~t[2])}(n)===!(2&~i.metadata.flags)){if(null===i.matches)t.reset([]);else{const o=NF(n,r);t.reset(o,Cx),t.notifyOnChanges()}return!0}return!1}function fd(){return function HS(t,n){return t[18].queries[n].queryList}(Pe(),Zp())}function Z1(t,n){return t<<17|n<<2}function Vm(t){return t>>17&32767}function LI(t){return 2|t}function Z_(t){return(131068&t)>>2}function FI(t,n){return-131069&t|n<<2}function BI(t){return 1|t}function LV(t,n,e,r){const i=t[e+1],o=null===n;let a=r?Vm(i):Z_(i),c=!1;for(;0!==a&&(!1===c||o);){const _=t[a+1];SJ(t[a],n)&&(c=!0,t[a+1]=r?BI(_):LI(_)),a=r?Vm(_):Z_(_)}c&&(t[e+1]=r?LI(i):BI(i))}function SJ(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&yl(t,n)>=0}const es={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function FV(t){return t.substring(es.key,es.keyEnd)}function BV(t,n){const e=es.textEnd;return e===n?-1:(n=es.keyEnd=function MJ(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,es.key=n,e),Y_(t,n,e))}function Y_(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function zm(t,n,e){return HV(t,n,e,!1),zm}function Ls(t,n){return HV(t,n,null,!0),Ls}function sp(t){!function $V(t,n,e,r){const i=Ht(),o=wl(2);i.firstUpdatePass&&GV(i,null,o,r);const a=Pe();if(e!==Nr&&li(a,o,e)){const c=i.data[co()];if(YV(c,r)&&!qV(i,o)){let f=r?c.classesWithoutHost:c.stylesWithoutHost;null!==f&&(e=fn(f,e||"")),SI(i,c,a,e,r)}else!function HJ(t,n,e,r,i,o,a,c){i===Nr&&(i=Ar);let f=0,_=0,x=0<i.length?i[0]:null,D=0<o.length?o[0]:null;for(;null!==x||null!==D;){const A=f<i.length?i[f+1]:void 0,N=_<o.length?o[_+1]:void 0;let te,B=null;x===D?(f+=2,_+=2,A!==N&&(B=D,te=N)):null===D||null!==x&&x<D?(f+=2,B=x):(_+=2,B=D,te=N),null!==B&&KV(t,n,e,r,B,te,a,c),x=f<i.length?i[f]:null,D=_<o.length?o[_]:null}}(i,c,a,a[11],a[o+1],a[o+1]=function UJ(t,n,e){if(null==e||""===e)return Ar;const r=[],i=Sl(e);if(Array.isArray(i))for(let o=0;o<i.length;o++)t(r,i[o],!0);else if(i instanceof Set)for(const o of i)t(r,o,!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&t(r,o,i[o]);else"string"==typeof i&&n(r,i);return r}(t,n,e),r,o)}}(jJ,LJ,t,!0)}function LJ(t,n){for(let e=function kJ(t){return function zV(t){es.key=0,es.keyEnd=0,es.value=0,es.valueEnd=0,es.textEnd=t.length}(t),BV(t,Y_(t,0,es.textEnd))}(n);e>=0;e=BV(n,e))Va(t,FV(n),!0)}function HV(t,n,e,r){const i=Pe(),o=Ht(),a=wl(2);o.firstUpdatePass&&GV(o,t,a,r),n!==Nr&&li(i,a,n)&&KV(o,o.data[co()],i,i[11],t,i[a+1]=function $J(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=xn(Sl(t)))),t}(n,e),r,a)}function qV(t,n){return n>=t.expandoStartIndex}function GV(t,n,e,r){const i=t.data;if(null===i[e+1]){const o=i[co()],a=qV(t,e);YV(o,r)&&null===n&&!a&&(n=!1),n=function FJ(t,n,e,r){const i=function jg(t){const n=et.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=r?n.residualClasses:n.residualStyles;if(null===i)0===(r?n.classBindings:n.styleBindings)&&(e=mb(e=VI(null,t,n,e,r),n.attrs,r),o=null);else{const a=n.directiveStylingLast;if(-1===a||t[a]!==i)if(e=VI(i,t,n,e,r),null===o){let f=function BJ(t,n,e){const r=e?n.classBindings:n.styleBindings;if(0!==Z_(r))return t[Vm(r)]}(t,n,r);void 0!==f&&Array.isArray(f)&&(f=VI(null,t,n,f[1],r),f=mb(f,n.attrs,r),function VJ(t,n,e,r){t[Vm(e?n.classBindings:n.styleBindings)]=r}(t,n,r,f))}else o=function zJ(t,n,e){let r;const i=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<i;o++)r=mb(r,t[o].hostAttrs,e);return mb(r,n.attrs,e)}(t,n,r)}return void 0!==o&&(r?n.residualClasses=o:n.residualStyles=o),e}(i,o,n,r),function DJ(t,n,e,r,i,o){let a=o?n.classBindings:n.styleBindings,c=Vm(a),f=Z_(a);t[r]=e;let x,_=!1;if(Array.isArray(e)?(x=e[1],(null===x||yl(e,x)>0)&&(_=!0)):x=e,i)if(0!==f){const A=Vm(t[c+1]);t[r+1]=Z1(A,c),0!==A&&(t[A+1]=FI(t[A+1],r)),t[c+1]=function EJ(t,n){return 131071&t|n<<17}(t[c+1],r)}else t[r+1]=Z1(c,0),0!==c&&(t[c+1]=FI(t[c+1],r)),c=r;else t[r+1]=Z1(f,0),0===c?c=r:t[f+1]=FI(t[f+1],r),f=r;_&&(t[r+1]=LI(t[r+1])),LV(t,x,r,!0),LV(t,x,r,!1),function TJ(t,n,e,r,i){const o=i?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&yl(o,n)>=0&&(e[r+1]=BI(e[r+1]))}(n,x,t,r,o),a=Z1(c,f),o?n.classBindings=a:n.styleBindings=a}(i,o,n,e,a,r)}}function VI(t,n,e,r,i){let o=null;const a=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<a&&(o=n[c],r=mb(r,o.hostAttrs,i),o!==t);)c++;return null!==t&&(e.directiveStylingLast=c),r}function mb(t,n,e){const r=e?1:2;let i=-1;if(null!==n)for(let o=0;o<n.length;o++){const a=n[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Va(t,a,!!e||n[++o]))}return void 0===t?null:t}function jJ(t,n,e){const r=String(n);""!==r&&!r.includes(" ")&&Va(t,r,e)}function KV(t,n,e,r,i,o,a,c){if(!(3&n.type))return;const f=t.data,_=f[c+1],x=function CJ(t){return!(1&~t)}(_)?ZV(f,n,e,i,Z_(_),a):void 0;Y1(x)||(Y1(o)||function xJ(t){return!(2&~t)}(_)&&(o=ZV(f,null,e,i,c,a)),function n9(t,n,e,r,i){if(n)i?t.addClass(e,r):t.removeClass(e,r);else{let o=-1===r.indexOf("-")?void 0:tp.DashCase;null==i?t.removeStyle(e,r,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=tp.Important),t.setStyle(e,r,i,o))}}(r,a,W(co(),e),i,o))}function ZV(t,n,e,r,i,o){const a=null===n;let c;for(;i>0;){const f=t[i],_=Array.isArray(f),x=_?f[1]:f,D=null===x;let A=e[i+1];A===Nr&&(A=D?Ar:void 0);let N=D?Gc(A,r):x===r?A:void 0;if(_&&!Y1(N)&&(N=Gc(f,r)),Y1(N)&&(c=N,a))return c;const B=t[i+1];i=a?Vm(B):Z_(B)}if(null!==n){let f=o?n.residualClasses:n.residualStyles;null!=f&&(c=Gc(f,r))}return c}function Y1(t){return void 0!==t}function YV(t,n){return!!(t.flags&(n?8:16))}function Y(t,n=""){const e=Pe(),r=Ht(),i=t+27,o=r.firstCreatePass?Tm(r,i,1,n,null):r.data[i],a=XV(r,e,o,n);e[i]=a,$g()&&pS(r,e,a,o),Ns(o,!1)}let XV=(t,n,e,r)=>(Xp(!0),function eS(t,n){return t.createText(n)}(n[11],r));function t3(t,n,e,r,i,o,a,c=""){const _=function b1(t,n,e,r,i){const o=km(t,n,e,r);return li(t,n+2,i)||o}(t,Br(),e,i,a);return wl(3),_?n+tn(e)+r+tn(i)+o+tn(a)+c:Nr}function Lt(t){return ci("",t),Lt}function ci(t,n,e){const r=Pe(),i=function JV(t,n,e,r=""){return li(t,Zi(),e)?n+tn(e)+r:Nr}(r,t,n,e);return i!==Nr&&Dh(r,co(),i),ci}function Ch(t,n,e,r,i){const o=Pe(),a=function e3(t,n,e,r,i,o=""){const c=km(t,Br(),e,i);return wl(2),c?n+tn(e)+r+tn(i)+o:Nr}(o,t,n,e,r,i);return a!==Nr&&Dh(o,co(),a),Ch}function X1(t,n,e,r,i,o,a){const c=Pe(),f=t3(c,t,n,e,r,i,o,a);return f!==Nr&&Dh(c,co(),f),X1}function Dh(t,n,e){const r=W(n,t);!function BO(t,n,e){t.setValue(n,e)}(t[11],r,e)}function ga(t,n,e){gB(n)&&(n=n());const r=Pe();return li(r,Zi(),n)&&(Ht(),t1(Bo(),r,t,n,r[11],e)),ga}function tl(t,n){const e=gB(t);return e&&t.set(n),e}function _a(t,n){const e=Pe(),r=Ht(),i=Xt();return NI(r,e,e[11],i,t,n),_a}function m3(t,n,e){const r=Ht();r.firstCreatePass&&g3(n,r.data,r.blueprint,us(t),e)}function g3(t,n,e,r,i){if(t=mn(t),Array.isArray(t))for(let o=0;o<t.length;o++)g3(t[o],n,e,r,i);else{const o=Ht(),a=Pe(),c=Xt();let f=Yo(t)?t:mn(t.provide);const _=Ii(t),x=1048575&c.providerIndexes,D=c.directiveStart,A=c.providerIndexes>>20;if(Yo(t)||!t.multi){const N=new im(_,i,Re,null),B=UI(f,n,i?x:x+A,D);-1===B?(sm(eu(c,a),o,f),zI(o,t,n.length),n.push(f),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(N),a.push(N)):(e[B]=N,a[B]=N)}else{const N=UI(f,n,x+A,D),B=UI(f,n,x,x+A),ce=B>=0&&e[B];if(i&&!ce||!i&&!(N>=0&&e[N])){sm(eu(c,a),o,f);const we=function aee(t,n,e,r,i){const a=new im(t,e,Re,null);return a.multi=[],a.index=n,a.componentProviders=0,_3(a,i,r&&!e),a}(i?see:oee,e.length,i,r,_);!i&&ce&&(e[B].providerFactory=we),zI(o,t,n.length,0),n.push(f),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),e.push(we),a.push(we)}else zI(o,t,N>-1?N:B,_3(e[i?B:N],_,!i&&r));!i&&r&&ce&&e[B].componentProviders++}}}function zI(t,n,e,r){const i=Yo(n),o=function ia(t){return!!t.useClass}(n);if(i||o){const f=(o?mn(n.useClass):n).prototype.ngOnDestroy;if(f){const _=t.destroyHooks||(t.destroyHooks=[]);if(!i&&n.multi){const x=_.indexOf(e);-1===x?_.push(e,[r,f]):_[x+1].push(r,f)}else _.push(e,f)}}}function _3(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function UI(t,n,e,r){for(let i=e;i<r;i++)if(n[i]===t)return i;return-1}function oee(t,n,e,r,i){return jI(this.multi,[])}function see(t,n,e,r,i){const o=this.multi;let a;if(this.providerFactory){const c=this.providerFactory.componentProviders,f=Ff(r,r[1],this.providerFactory.index,i);a=f.slice(0,c),jI(o,a);for(let _=c;_<f.length;_++)a.push(f[_])}else a=[],jI(o,a);return a}function jI(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Sr(t,n){return e=>{e.providersResolver=(r,i)=>m3(r,i?i(t):t,!1),n&&(e.viewProvidersResolver=(r,i)=>m3(r,i?i(n):n,!0))}}function E3(t,n,e,r,i,o,a,c,f){const _=n+e;return function wc(t,n,e,r,i,o){const a=km(t,n,e,r);return km(t,n+2,i,o)||a}(t,_,i,o,a,c)?ud(t,_+4,f?r.call(f,i,o,a,c):r(i,o,a,c)):function gb(t,n){const e=t[n];return e===Nr?void 0:e}(t,_+4)}function X_(t,n){const e=Ht();let r;const i=t+27;e.firstCreatePass?(r=function bee(t,n){if(n)for(let e=n.length-1;e>=0;e--){const r=n[e];if(t===r.name)return r}}(n,e.pipeRegistry),e.data[i]=r,r.onDestroy&&(e.destroyHooks??=[]).push(i,r.onDestroy)):r=e.data[i];const o=r.factory||(r.factory=Ba(r.type)),c=Si(Re);try{const f=om(!1),_=o();return om(f),function re(t,n,e,r){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=r}(e,Pe(),i,_),_}finally{Si(c)}}function Q_(t,n,e,r,i,o){const a=t+27,c=Pe(),f=function de(t,n){return t[n]}(c,a);return function _b(t,n){return t[1].data[n].pure}(c,a)?E3(c,Fn(),n,f.transform,e,r,i,o,f):f.transform(e,r,i,o)}class Jee{ngModuleFactory;componentFactories;constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let ete=(()=>{class t{compileModuleSync(e){return new UF(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),o=cd(ss(e).declarations).reduce((a,c)=>{const f=ln(c);return f&&a.push(new Jv(f)),a},[]);return new Jee(r,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),nte=(()=>{class t{applicationErrorHandler=X(El);appRef=X(Qa);taskService=X(Ha);ngZone=X(on);zonelessEnabled=X(Qu);tracing=X(A_,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Wn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Kg):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(X(Xw,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{const e=this.taskService.add();this.runningTick||(this.cleanup(),this.zonelessEnabled&&!this.appRef.includeAllTestViews)?(this.switchToMicrotaskScheduler(),this.taskService.remove(e)):this.taskService.remove(e)})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}switchToMicrotaskScheduler(){this.ngZone.runOutsideAngular(()=>{const e=this.taskService.add();this.useMicrotaskScheduler=!0,queueMicrotask(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})})}notify(e){if(!this.zonelessEnabled&&5===e)return;switch(e){case 0:case 6:case 13:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 12:this.appRef.dirtyFlags|=16;break;case 11:break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;const r=this.useMicrotaskScheduler?rv:Wg;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Kg+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.applicationErrorHandler(r)}finally{this.taskService.remove(e),this.cleanup()}}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Th=new Fe("",{factory:()=>X(Th,{optional:!0,skipSelf:!0})||function rte(){return typeof $localize<"u"&&$localize.locale||$1}()}),rE=Symbol("InputSignalNode#UNSET"),W3={...ka,transformFn:void 0,applyValueToInputSignal(t,n){fl(t,n)}};function K3(t,n){const e=Object.create(W3);function r(){if(Ro(e),e.value===rE)throw new ue(-950,null);return e.value}return e.value=t,e.transformFn=n?.transform,r[ze]=e,r}class hte{attributeName;constructor(n){this.attributeName=n}__NG_ELEMENT_ID__=()=>Vf(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}}function Z3(t,n){return K3(t,n)}const pte=(Z3.required=function fte(t){return K3(rE,t)},Z3);let gte=(()=>{class t{zone=X(on);changeDetectionScheduler=X(Af);applicationRef=X(Qa);applicationErrorHandler=X(El);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(e){this.applicationErrorHandler(e)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const _te=new Fe("",{factory:()=>!1});function J3(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}let bte=(()=>{class t{subscription=new Wn;initialized=!1;zone=X(on);pendingTasks=X(Ha);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{on.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{on.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const iE=new Fe(""),Cte=new Fe("");function vb(t){return!t.moduleRef}let ty=null;let Sh=(()=>class t{static __NG_ELEMENT_ID__=Hte})();function Hte(t){return function $te(t,n,e){if(ao(t)&&!e){const r=ae(t.index,n);return new jv(r,r)}return 175&t.type?new jv(n[15],n):null}(Xt(),Pe(),!(16&~t))}function Jte(t){const{rootComponent:n,appProviders:e,platformProviders:r,platformRef:i}=t;gr(Ct.BootstrapApplicationStart);try{const o=i?.injector??function kte(t=[]){if(ty)return ty;const n=function oz(t=[],n){return In.create({name:n,providers:[{provide:xf,useValue:"platform"},{provide:iE,useValue:new Set([()=>ty=null])},...t]})}(t);return ty=n,function $Y(){!function Op(t){Hl=t}(()=>{throw new ue(600,"")})}(),function sz(t){const n=t.get(Dl,null);ji(t,()=>{n?.forEach(e=>e())})}(n),n}(r),a=[[{provide:Af,useExisting:nte},{provide:on,useClass:Kw},{provide:Qu,useValue:!0}],Yw,...e||[]];return function tz(t){const n=vb(t)?t.r3Injector:t.moduleRef.injector,e=n.get(on);return e.run(()=>{vb(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();const r=n.get(El);let i;if(e.runOutsideAngular(()=>{i=e.onError.subscribe({next:r})}),vb(t)){const o=()=>n.destroy(),a=t.platformInjector.get(iE);a.add(o),n.onDestroy(()=>{i.unsubscribe(),a.delete(o)})}else{const o=()=>t.moduleRef.destroy(),a=t.platformInjector.get(iE);a.add(o),t.moduleRef.onDestroy(()=>{M1(t.allPlatformModules,t.moduleRef),i.unsubscribe(),a.delete(o)})}return function Tte(t,n,e){try{const r=e();return sb(r)?r.catch(i=>{throw n.runOutsideAngular(()=>t(i)),i}):r}catch(r){throw n.runOutsideAngular(()=>t(r)),r}}(r,e,()=>{const o=n.get(Ha),a=o.add(),c=n.get(OB);return c.runInitializers(),c.donePromise.then(()=>{if(function OQ(t){"string"==typeof t&&(pV=t.toLowerCase().replace(/_/g,"-"))}(n.get(Th,$1)||$1),!n.get(Cte,!0))return vb(t)?n.get(Qa):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(vb(t)){const x=n.get(Qa);return void 0!==t.rootComponent&&x.bootstrap(t.rootComponent),x}return t.moduleRef}).finally(()=>{o.remove(a)})})})}({r3Injector:new jF({providers:a,parent:o,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:o,rootComponent:n})}catch(o){return Promise.reject(o)}finally{gr(Ct.BootstrapApplicationEnd)}}function ms(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function Tz(t,n=NaN){return isNaN(parseFloat(t))||isNaN(Number(t))?n:Number(t)}function Az(t,n){const e=ln(t),r=n.elementInjector||rc();return new Jv(e).create(r,n.projectableNodes,n.hostElement,n.environmentInjector,n.directives,n.bindings)}let Mz=null;function lp(){return Mz}class _ne{}let uE=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(vne),providedIn:"platform"})}return t})();const yne=new Fe("");let vne=(()=>{class t extends uE{_location;_history;_doc=X(jn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return lp().getBaseHref(this._doc)}onPopState(e){const r=lp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=lp().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,i){this._history.pushState(e,r,i)}replaceState(e,r,i){this._history.replaceState(e,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function Rz(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const r=e.indexOf("="),[i,o]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===n)return decodeURIComponent(o)}return null}class Pz{}function Nz(t,n,e){return function AQ(t,n,e){"string"!=typeof n&&(e=n,n=t[wi.LocaleId]),n=n.toLowerCase().replace(/_/g,"-"),K_[n]=t,e&&(K_[n][wi.ExtraData]=e)}(t,n,e)}const Oz="browser";let Lz=(()=>{class t{static \u0275prov=je({token:t,providedIn:"root",factory:()=>new xne(X(jn),window)})}return t})();class xne{document;window;offset=()=>[0,0];constructor(n,e){this.document=n,this.window=e}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n,e){this.window.scrollTo({...e,left:n[0],top:n[1]})}scrollToAnchor(n,e){const r=function Ene(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const o=i.shadowRoot;if(o){const a=o.getElementById(n)||o.querySelector(`[name="${n}"]`);if(a)return a}i=r.nextNode()}}return null}(this.document,n);r&&(this.scrollToElement(r,e),r.focus())}setHistoryScrollRestoration(n){try{this.window.history.scrollRestoration=n}catch{console.warn(jt(2400,!1))}}scrollToElement(n,e){const r=n.getBoundingClientRect(),i=r.left+this.window.pageXOffset,o=r.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo({...e,left:i-a[0],top:o-a[1]})}}class Wz{_doc;constructor(n){this._doc=n}manager}let ik=(()=>{class t extends Wz{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i,o){return e.addEventListener(r,i,o),()=>this.removeEventListener(e,r,i,o)}removeEventListener(e,r,i,o){return e.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||t)(Dt(jn))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();const ok=new Fe("");let Kz=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,r){this._zone=r,e.forEach(a=>{a.manager=this});const i=e.filter(a=>!(a instanceof ik));this._plugins=i.slice().reverse();const o=e.find(a=>a instanceof ik);o&&this._plugins.push(o)}addEventListener(e,r,i,o){return this._findPluginFor(r).addEventListener(e,r,i,o)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(o=>o.supports(e)),!r)throw new ue(5101,!1);return this._eventNameToPlugin.set(e,r),r}static \u0275fac=function(r){return new(r||t)(Dt(ok),Dt(on))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();const sk="ng-app-id";function Zz(t){for(const n of t)n.remove()}function Yz(t,n){const e=n.createElement("style");return e.textContent=t,e}function ak(t,n){const e=n.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",t),e}let Xz=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,r,i,o={}){this.doc=e,this.appId=r,this.nonce=i,function Xne(t,n,e,r){const i=t.head?.querySelectorAll(`style[${sk}="${n}"],link[${sk}="${n}"]`);if(i)for(const o of i)o.removeAttribute(sk),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&e.set(o.textContent,{usage:0,elements:[o]})}(e,r,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,r){for(const i of e)this.addUsage(i,this.inline,Yz);r?.forEach(i=>this.addUsage(i,this.external,ak))}removeStyles(e,r){for(const i of e)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(e,r,i){const o=r.get(e);o?o.usage++:r.set(e,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,i(e,this.doc)))})}removeUsage(e,r){const i=r.get(e);i&&(i.usage--,i.usage<=0&&(Zz(i.elements),r.delete(e)))}ngOnDestroy(){for(const[,{elements:e}]of[...this.inline,...this.external])Zz(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(const[r,{elements:i}]of this.inline)i.push(this.addElement(e,Yz(r,this.doc)));for(const[r,{elements:i}]of this.external)i.push(this.addElement(e,ak(r,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,r){return this.nonce&&r.setAttribute("nonce",this.nonce),e.appendChild(r)}static \u0275fac=function(r){return new(r||t)(Dt(jn),Dt(xr),Dt(Ur,8),Dt(ps))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();const lk={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ck=/%COMP%/g,rre=new Fe("",{factory:()=>!0});function Jz(t,n){return n.map(e=>e.replace(ck,t))}let uk=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(e,r,i,o,a,c,f=null,_=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=a,this.ngZone=c,this.nonce=f,this.tracingService=_,this.defaultRenderer=new dk(e,a,c,this.tracingService)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(e,r);return i instanceof nU?i.applyToHost(e):i instanceof hk&&i.applyStyles(),i}getOrCreateRenderer(e,r){const i=this.rendererByCompId;let o=i.get(r.id);if(!o){const a=this.doc,c=this.ngZone,f=this.eventManager,_=this.sharedStylesHost,x=this.removeStylesOnCompDestroy,D=this.tracingService;switch(r.encapsulation){case bc.Emulated:o=new nU(f,_,r,this.appId,x,a,c,D);break;case bc.ShadowDom:return new tU(f,e,r,a,c,this.nonce,D,_);case bc.ExperimentalIsolatedShadowDom:return new tU(f,e,r,a,c,this.nonce,D);default:o=new hk(f,_,r,x,a,c,D)}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(r){return new(r||t)(Dt(Kz),Dt(Xz),Dt(xr),Dt(rre),Dt(jn),Dt(on),Dt(Ur),Dt(A_,8))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();class dk{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(n,e,r,i){this.eventManager=n,this.doc=e,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(n,e){return e?this.doc.createElementNS(lk[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(eU(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(eU(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){e.remove()}selectRootElement(n,e){let r="string"==typeof n?this.doc.querySelector(n):n;if(!r)throw new ue(-5104,!1);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,i){if(i){e=i+":"+e;const o=lk[i];o?n.setAttributeNS(o,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){const i=lk[r];i?n.removeAttributeNS(i,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,i){i&(tp.DashCase|tp.Important)?n.style.setProperty(e,r,i&tp.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&tp.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){null!=n&&(n[e]=r)}setValue(n,e){n.nodeValue=e}listen(n,e,r,i){if("string"==typeof n&&!(n=lp().getGlobalEventTarget(this.doc,n)))throw new ue(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(n,e,o)),this.eventManager.addEventListener(n,e,o,i)}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&e.preventDefault()}}}function eU(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class tU extends dk{hostEl;sharedStylesHost;shadowRoot;constructor(n,e,r,i,o,a,c,f){super(n,i,o,c),this.hostEl=e,this.sharedStylesHost=f,this.shadowRoot=e.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let _=r.styles;_=Jz(r.id,_);for(const D of _){const A=document.createElement("style");a&&A.setAttribute("nonce",a),A.textContent=D,this.shadowRoot.appendChild(A)}const x=r.getExternalStyles?.();if(x)for(const D of x){const A=ak(D,i);a&&A.setAttribute("nonce",a),this.shadowRoot.appendChild(A)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(null,e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}}class hk extends dk{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(n,e,r,i,o,a,c,f){super(n,o,a,c),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=i;let _=r.styles;this.styles=f?Jz(f,_):_,this.styleUrls=r.getExternalStyles?.(f)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&0===Em.size&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class nU extends hk{contentAttr;hostAttr;constructor(n,e,r,i,o,a,c,f){const _=i+"-"+r.id;super(n,e,r,o,a,c,f,_),this.contentAttr=function ire(t){return"_ngcontent-%COMP%".replace(ck,t)}(_),this.hostAttr=function ore(t){return"_nghost-%COMP%".replace(ck,t)}(_)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}}class fk extends _ne{supportsDOMEvents=!0;static makeCurrent(){!function gne(t){Mz??=t}(new fk)}onAndCancel(n,e,r,i){return n.addEventListener(e,r,i),()=>{n.removeEventListener(e,r,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.remove()}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function are(){return Cb=Cb||document.head.querySelector("base"),Cb?Cb.getAttribute("href"):null}();return null==e?null:function lre(t){return new URL(t,document.baseURI).pathname}(e)}resetBaseElement(){Cb=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Rz(document.cookie,n)}}let Cb=null,ure=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();const rU=["alt","control","meta","shift"],dre={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hre={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};function pk(){return(pk=fe(function*(t,n,e){return Jte({rootComponent:t,...iU(n,e)})})).apply(this,arguments)}function iU(t,n){return{platformRef:n?.platformRef,appProviders:[...bre,...t?.providers??[]],platformProviders:yre}}const yre=[{provide:ps,useValue:Oz},{provide:Dl,useValue:function mre(){fk.makeCurrent()},multi:!0},{provide:jn,useFactory:function _re(){return function Do(t){Co=t}(document),document}}],bre=[{provide:xf,useValue:"root"},{provide:kf,useFactory:function gre(){return new kf}},{provide:ok,useClass:ik,multi:!0},{provide:ok,useClass:(()=>{class t extends Wz{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,r,i,o){const a=t.parseEventName(r),c=t.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>lp().onAndCancel(e,a.domEventName,c,o))}static parseEventName(e){const r=e.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const o=t._normalizeKey(r.pop());let a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),rU.forEach(_=>{const x=r.indexOf(_);x>-1&&(r.splice(x,1),a+=_+".")}),a+=o,0!=r.length||0===o.length)return null;const f={};return f.domEventName=i,f.fullKey=a,f}static matchEventFullKeyCode(e,r){let i=dre[e.key]||e.key,o="";return r.indexOf("code.")>-1&&(i=e.code,o="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),rU.forEach(a=>{a!==i&&(0,hre[a])(e)&&(o+=a+".")}),o+=i,o===r)}static eventCallback(e,r,i){return o=>{t.matchEventFullKeyCode(o,e)&&i.runGuarded(()=>r(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static \u0275fac=function(r){return new(r||t)(Dt(jn))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})(),multi:!0},uk,Xz,Kz,{provide:Al,useExisting:uk},{provide:Pz,useClass:ure},[]];var vn=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(vn||{});const Ih="*";function oU(t){return{type:vn.Style,styles:t,offset:null}}class Db{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(n=0,e=0){this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class sU{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(n){this.players=n;let e=0,r=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++e==o&&this._onFinish()}),a.onDestroy(()=>{++r==o&&this._onDestroy()}),a.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((a,c)=>Math.max(a,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(i)})}getPosition(){const n=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function aU(t){return new ue(3e3,!1)}function Mre(t){return new ue(3002,!1)}function cp(t){switch(t.length){case 0:return new Db;case 1:return t[0];default:return new sU(t)}}function lU(t,n,e=new Map,r=new Map){const i=[],o=[];let a=-1,c=null;if(n.forEach(f=>{const _=f.get("offset"),x=_==a,D=x&&c||new Map;f.forEach((A,N)=>{let B=N,te=A;if("offset"!==N)switch(B=t.normalizePropertyName(B,i),te){case"!":te=e.get(N);break;case Ih:te=r.get(N);break;default:te=t.normalizeStyleValue(N,B,te,i)}D.set(B,te)}),x||o.push(D),c=D,a=_}),i.length)throw function jre(){return new ue(3502,!1)}();return o}function yk(t,n,e,r){switch(n){case"start":t.onStart(()=>r(e&&vk(e,"start",t)));break;case"done":t.onDone(()=>r(e&&vk(e,"done",t)));break;case"destroy":t.onDestroy(()=>r(e&&vk(e,"destroy",t)))}}function vk(t,n,e){const o=bk(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),a=t._data;return null!=a&&(o._data=a),o}function bk(t,n,e,r,i="",o=0,a){return{element:t,triggerName:n,fromState:e,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function Rl(t,n,e){let r=t.get(n);return r||t.set(n,r=e),r}function cU(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const eie=typeof document>"u"?null:document.documentElement;function wk(t){const n=t.parentNode||t.host||null;return n===eie?null:n}let jm=null,uU=!1;function dU(t,n){for(;n;){if(n===t)return!0;n=wk(n)}return!1}function hU(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const r=t.querySelector(n);return r?[r]:[]}const pU="ng-enter",xk="ng-leave",mE="ng-trigger",gE=".ng-trigger",mU="ng-animating",Ek=".ng-animating";function kh(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:Ck(parseFloat(n[1]),n[2])}function Ck(t,n){return"s"===n?1e3*t:t}function _E(t,n,e){return t.hasOwnProperty("duration")?t:function aie(t,n,e){let r,i=0,o="";if("string"==typeof t){const a=t.match(sie);if(null===a)return n.push(aU()),{duration:0,delay:0,easing:""};r=Ck(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(i=Ck(parseFloat(c),a[4]));const f=a[5];f&&(o=f)}else r=t;if(!e){let a=!1,c=n.length;r<0&&(n.push(function xre(){return new ue(3100,!1)}()),a=!0),i<0&&(n.push(function Ere(){return new ue(3101,!1)}()),a=!0),a&&n.splice(c,0,aU())}return{duration:r,delay:i,easing:o}}(t,n,e)}const sie=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i;function pd(t,n,e){n.forEach((r,i)=>{const o=Tk(i);e&&!e.has(i)&&e.set(i,t.style[o]),t.style[o]=r})}function Hm(t,n){n.forEach((e,r)=>{const i=Tk(r);t.style[i]=""})}function Tb(t){return Array.isArray(t)?1==t.length?t[0]:function wre(t,n=null){return{type:vn.Sequence,steps:t,options:n}}(t):t}const Dk=new RegExp("{{\\s*(.+?)\\s*}}","g");function gU(t){let n=[];if("string"==typeof t){let e;for(;e=Dk.exec(t);)n.push(e[1]);Dk.lastIndex=0}return n}function Sb(t,n,e){const r=`${t}`,i=r.replace(Dk,(o,a)=>{let c=n[a];return null==c&&(e.push(function Dre(){return new ue(3003,!1)}()),c=""),c.toString()});return i==r?t:i}const uie=/-+([a-z0-9])/g;function Tk(t){return t.replace(uie,(...n)=>n[1].toUpperCase())}function Pl(t,n,e){switch(n.type){case vn.Trigger:return t.visitTrigger(n,e);case vn.State:return t.visitState(n,e);case vn.Transition:return t.visitTransition(n,e);case vn.Sequence:return t.visitSequence(n,e);case vn.Group:return t.visitGroup(n,e);case vn.Animate:return t.visitAnimate(n,e);case vn.Keyframes:return t.visitKeyframes(n,e);case vn.Style:return t.visitStyle(n,e);case vn.Reference:return t.visitReference(n,e);case vn.AnimateChild:return t.visitAnimateChild(n,e);case vn.AnimateRef:return t.visitAnimateRef(n,e);case vn.Query:return t.visitQuery(n,e);case vn.Stagger:return t.visitStagger(n,e);default:throw function Tre(){return new ue(3004,!1)}()}}function Sk(t,n){return window.getComputedStyle(t)[n]}let Ik=(()=>{class t{validateStyleProperty(e){return function nie(t){jm||(jm=function rie(){return typeof document<"u"?document.body:null}()||{},uU=!!jm.style&&"WebkitAppearance"in jm.style);let n=!0;return jm.style&&!function tie(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in jm.style,!n&&uU&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in jm.style)),n}(e)}containsElement(e,r){return dU(e,r)}getParentElement(e){return wk(e)}query(e,r,i){return hU(e,r,i)}computeStyle(e,r,i){return i||""}animate(e,r,i,o,a,c=[],f){return new Db(i,o)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();class kk{static NOOP=new Ik}class Ak{}const pie=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class _U extends Ak{normalizePropertyName(n,e){return Tk(n)}normalizeStyleValue(n,e,r,i){let o="";const a=r.toString().trim();if(pie.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)o="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&i.push(function Sre(){return new ue(3005,!1)}())}return a+o}}const vE=new Set(["true","1"]),bE=new Set(["false","0"]);function yU(t,n){const e=vE.has(t)||bE.has(t),r=vE.has(n)||bE.has(n);return(i,o)=>{let a="*"==t||t==i,c="*"==n||n==o;return!a&&e&&"boolean"==typeof i&&(a=i?vE.has(t):bE.has(t)),!c&&r&&"boolean"==typeof o&&(c=o?vE.has(n):bE.has(n)),a&&c}}const yie=new RegExp("s*:selfs*,?","g");function Rk(t,n,e,r){return new vie(t).build(n,e,r)}class vie{_driver;constructor(n){this._driver=n}build(n,e,r){const i=new xie(e);return this._resetContextStyleTimingState(i),Pl(this,Tb(n),i)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let r=e.queryCount=0,i=e.depCount=0;const o=[],a=[];return"@"==n.name.charAt(0)&&e.errors.push(function Ire(){return new ue(3006,!1)}()),n.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),c.type==vn.State){const f=c,_=f.name;_.toString().split(/\s*,\s*/).forEach(x=>{f.name=x,o.push(this.visitState(f,e))}),f.name=_}else if(c.type==vn.Transition){const f=this.visitTransition(c,e);r+=f.queryCount,i+=f.depCount,a.push(f)}else e.errors.push(function kre(){return new ue(3007,!1)}())}),{type:vn.Trigger,name:n.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}visitState(n,e){const r=this.visitStyle(n.styles,e),i=n.options&&n.options.params||null;if(r.containsDynamicStyles){const o=new Set,a=i||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(f=>{gU(f).forEach(_=>{a.hasOwnProperty(_)||o.add(_)})})}),o.size&&e.errors.push(function Are(){return new ue(3008,!1)}(0,o.values()))}return{type:vn.State,name:n.name,style:r,options:i?{params:i}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const r=Pl(this,Tb(n.animation),e),i=function mie(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function gie(t,n,e){if(":"==t[0]){const f=function _ie(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return n.push(function zre(){return new ue(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof f)return void n.push(f);t=f}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Vre(){return new ue(3015,!1)}()),n;const i=r[1],o=r[2],a=r[3];n.push(yU(i,a)),"<"==o[0]&&("*"!=i||"*"!=a)&&n.push(yU(a,i))}(r,e,n)):e.push(t),e}(n.expr,e.errors);return{type:vn.Transition,matchers:i,animation:r,queryCount:e.queryCount,depCount:e.depCount,options:$m(n.options)}}visitSequence(n,e){return{type:vn.Sequence,steps:n.steps.map(r=>Pl(this,r,e)),options:$m(n.options)}}visitGroup(n,e){const r=e.currentTime;let i=0;const o=n.steps.map(a=>{e.currentTime=r;const c=Pl(this,a,e);return i=Math.max(i,e.currentTime),c});return e.currentTime=i,{type:vn.Group,steps:o,options:$m(n.options)}}visitAnimate(n,e){const r=function Cie(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return Pk(_E(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=Pk(0,0,"");return o.dynamic=!0,o.strValue=e,o}const i=_E(e,n);return Pk(i.duration,i.delay,i.easing)}(n.timings,e.errors);e.currentAnimateTimings=r;let i,o=n.styles?n.styles:oU({});if(o.type==vn.Keyframes)i=this.visitKeyframes(o,e);else{let a=n.styles,c=!1;if(!a){c=!0;const _={};r.easing&&(_.easing=r.easing),a=oU(_)}e.currentTime+=r.duration+r.delay;const f=this.visitStyle(a,e);f.isEmptyStep=c,i=f}return e.currentAnimateTimings=null,{type:vn.Animate,timings:r,style:i,options:null}}visitStyle(n,e){const r=this._makeStyleAst(n,e);return this._validateStyleAst(r,e),r}_makeStyleAst(n,e){const r=[],i=Array.isArray(n.styles)?n.styles:[n.styles];for(let c of i)"string"==typeof c?c===Ih?r.push(c):e.errors.push(Mre()):r.push(new Map(Object.entries(c)));let o=!1,a=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(a=c.get("easing"),c.delete("easing")),!o))for(let f of c.values())if(f.toString().indexOf("{{")>=0){o=!0;break}}),{type:vn.Style,styles:r,easing:a,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const r=e.currentAnimateTimings;let i=e.currentTime,o=e.currentTime;r&&o>0&&(o-=r.duration+r.delay),n.styles.forEach(a=>{"string"!=typeof a&&a.forEach((c,f)=>{const _=e.collectedStyles.get(e.currentQuerySelector),x=_.get(f);let D=!0;x&&(o!=i&&o>=x.startTime&&i<=x.endTime&&(e.errors.push(function Rre(){return new ue(3010,!1)}()),D=!1),o=x.startTime),D&&_.set(f,{startTime:o,endTime:i}),e.options&&function cie(t,n,e){const r=n.params||{},i=gU(t);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||e.push(function Cre(){return new ue(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(n,e){const r={type:vn.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Pre(){return new ue(3011,!1)}()),r;let o=0;const a=[];let c=!1,f=!1,_=0;const x=n.steps.map(we=>{const Ce=this._makeStyleAst(we,e);let We=null!=Ce.offset?Ce.offset:function Eie(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(Ce.styles),Se=0;return null!=We&&(o++,Se=Ce.offset=We),f=f||Se<0||Se>1,c=c||Se<_,_=Se,a.push(Se),Ce});f&&e.errors.push(function Nre(){return new ue(3012,!1)}()),c&&e.errors.push(function Ore(){return new ue(3200,!1)}());const D=n.steps.length;let A=0;o>0&&o<D?e.errors.push(function Lre(){return new ue(3202,!1)}()):0==o&&(A=1/(D-1));const N=D-1,B=e.currentTime,te=e.currentAnimateTimings,ce=te.duration;return x.forEach((we,Ce)=>{const We=A>0?Ce==N?1:A*Ce:a[Ce],Se=We*ce;e.currentTime=B+te.delay+Se,te.duration=Se,this._validateStyleAst(we,e),we.offset=We,r.styles.push(we)}),r}visitReference(n,e){return{type:vn.Reference,animation:Pl(this,Tb(n.animation),e),options:$m(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:vn.AnimateChild,options:$m(n.options)}}visitAnimateRef(n,e){return{type:vn.AnimateRef,animation:this.visitReference(n.animation,e),options:$m(n.options)}}visitQuery(n,e){const r=e.currentQuerySelector,i=n.options||{};e.queryCount++,e.currentQuery=n;const[o,a]=function bie(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(yie,"")),t=t.replace(/@\*/g,gE).replace(/@\w+/g,e=>gE+"-"+e.slice(1)).replace(/:animating/g,Ek),[t,n]}(n.selector);e.currentQuerySelector=r.length?r+" "+o:o,Rl(e.collectedStyles,e.currentQuerySelector,new Map);const c=Pl(this,Tb(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:vn.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:a,animation:c,originalSelector:n.selector,options:$m(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function Fre(){return new ue(3013,!1)}());const r="full"===n.timings?{duration:0,delay:0,easing:"full"}:_E(n.timings,e.errors,!0);return{type:vn.Stagger,animation:Pl(this,Tb(n.animation),e),timings:r,options:null}}}class xie{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(n){this.errors=n}}function $m(t){return t?(t={...t}).params&&(t.params=function wie(t){return t?{...t}:null}(t.params)):t={},t}function Pk(t,n,e){return{duration:t,delay:n,easing:e}}function Nk(t,n,e,r,i,o,a=null,c=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:c}}class wE{_map=new Map;get(n){return this._map.get(n)||[]}append(n,e){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const Sie=new RegExp(":enter","g"),kie=new RegExp(":leave","g");function Ok(t,n,e,r,i,o=new Map,a=new Map,c,f,_=[]){return(new Aie).buildKeyframes(t,n,e,r,i,o,a,c,f,_)}class Aie{buildKeyframes(n,e,r,i,o,a,c,f,_,x=[]){_=_||new wE;const D=new Lk(n,e,_,i,o,x,[]);D.options=f;const A=f.delay?kh(f.delay):0;D.currentTimeline.delayNextStep(A),D.currentTimeline.setStyles([a],null,D.errors,f),Pl(this,r,D);const N=D.timelines.filter(B=>B.containsAnimation());if(N.length&&c.size){let B;for(let te=N.length-1;te>=0;te--){const ce=N[te];if(ce.element===e){B=ce;break}}B&&!B.allowOnlyTimelineStyles()&&B.setStyles([c],null,D.errors,f)}return N.length?N.map(B=>B.buildKeyframes()):[Nk(e,[],[],[],0,A,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const r=e.subInstructions.get(e.element);if(r){const i=e.createSubContext(n.options),o=e.currentTimeline.currentTime,a=this._visitSubInstructions(r,i,i.options);o!=a&&e.transformIntoNewTimeline(a)}e.previousNode=n}visitAnimateRef(n,e){const r=e.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,r),this.visitReference(n.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,r){for(const i of n){const o=i?.delay;if(o){const a="number"==typeof o?o:kh(Sb(o,i?.params??{},e.errors));r.delayNextStep(a)}}}_visitSubInstructions(n,e,r){let o=e.currentTimeline.currentTime;const a=null!=r.duration?kh(r.duration):null,c=null!=r.delay?kh(r.delay):null;return 0!==a&&n.forEach(f=>{const _=e.appendInstructionToTimeline(f,a,c);o=Math.max(o,_.duration+_.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Pl(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const r=e.subContextCount;let i=e;const o=n.options;if(o&&(o.params||o.delay)&&(i=e.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){i.previousNode.type==vn.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=xE);const a=kh(o.delay);i.delayNextStep(a)}n.steps.length&&(n.steps.forEach(a=>Pl(this,a,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const r=[];let i=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?kh(n.options.delay):0;n.steps.forEach(a=>{const c=e.createSubContext(n.options);o&&c.delayNextStep(o),Pl(this,a,c),i=Math.max(i,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(a=>e.currentTimeline.mergeTimelineCollectedStyles(a)),e.transformIntoNewTimeline(i),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const r=n.strValue;return _E(e.params?Sb(r,e.params,e.errors):r,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const r=e.currentAnimateTimings=this._visitTiming(n.timings,e),i=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),i.snapshotCurrentStyles());const o=n.style;o.type==vn.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(r.duration),this.visitStyle(o,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const r=e.currentTimeline,i=e.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const o=i&&i.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(o):r.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const r=e.currentAnimateTimings,i=e.currentTimeline.duration,o=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,n.styles.forEach(f=>{c.forwardTime((f.offset||0)*o),c.setStyles(f.styles,f.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(i+o),e.previousNode=n}visitQuery(n,e){const r=e.currentTimeline.currentTime,i=n.options||{},o=i.delay?kh(i.delay):0;o&&(e.previousNode.type===vn.Style||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=xE);let a=r;const c=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=c.length;let f=null;c.forEach((_,x)=>{e.currentQueryIndex=x;const D=e.createSubContext(n.options,_);o&&D.delayNextStep(o),_===e.element&&(f=D.currentTimeline),Pl(this,n.animation,D),D.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,D.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),f&&(e.currentTimeline.mergeTimelineCollectedStyles(f),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const r=e.parentContext,i=e.currentTimeline,o=n.timings,a=Math.abs(o.duration),c=a*(e.currentQueryTotal-1);let f=a*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":f=c-f;break;case"full":f=r.currentStaggerTime}const x=e.currentTimeline;f&&x.delayNextStep(f);const D=x.currentTime;Pl(this,n.animation,e),e.previousNode=n,r.currentStaggerTime=i.currentTime-D+(i.startTime-r.currentTimeline.startTime)}}const xE={};class Lk{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=xE;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(n,e,r,i,o,a,c,f){this._driver=n,this.element=e,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=c,this.currentTimeline=f||new EE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const r=n;let i=this.options;null!=r.duration&&(i.duration=kh(r.duration)),null!=r.delay&&(i.delay=kh(r.delay));const o=r.params;if(o){let a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(c=>{(!e||!a.hasOwnProperty(c))&&(a[c]=Sb(o[c],a,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const r=n.params={};Object.keys(e).forEach(i=>{r[i]=e[i]})}}return n}createSubContext(n=null,e,r){const i=e||this.element,o=new Lk(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=xE,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,r){const i={duration:e??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},o=new Mie(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,i,n.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,r,i,o,a){let c=[];if(i&&c.push(this.element),n.length>0){n=(n=n.replace(Sie,"."+this._enterClassName)).replace(kie,"."+this._leaveClassName);let _=this._driver.query(this.element,n,1!=r);0!==r&&(_=r<0?_.slice(_.length+r,_.length):_.slice(0,r)),c.push(..._)}return!o&&0==c.length&&a.push(function Bre(){return new ue(3014,!1)}()),c}}class EE{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(n,e,r,i){this._driver=n,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=i,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new EE(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Ih),this._currentKeyframe.set(e,Ih);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,r,i){e&&this._previousKeyframe.set("easing",e);const o=i&&i.params||{},a=function Rie(t,n){const e=new Map;let r;return t.forEach(i=>{if("*"===i){r??=n.keys();for(let o of r)e.set(o,Ih)}else for(let[o,a]of i)e.set(o,a)}),e}(n,this._globalTimelineStyles);for(let[c,f]of a){const _=Sb(f,o,r);this._pendingStyles.set(c,_),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??Ih),this._updateStyle(c,_)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,r)=>{const i=this._styleSummary.get(r);(!i||e.time>i.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((c,f)=>{const _=new Map([...this._backFill,...c]);_.forEach((x,D)=>{"!"===x?n.add(D):x===Ih&&e.add(D)}),r||_.set("offset",f/this.duration),i.push(_)});const o=[...n.values()],a=[...e.values()];if(r){const c=i[0],f=new Map(c);c.set("offset",0),f.set("offset",1),i=[c,f]}return Nk(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}}class Mie extends EE{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(n,e,r,i,o,a,c=!1){super(n,e,a.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=c,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],a=r+e,c=e/a,f=new Map(n[0]);f.set("offset",0),o.push(f);const _=new Map(n[0]);_.set("offset",wU(c)),o.push(_);const x=n.length-1;for(let D=1;D<=x;D++){let A=new Map(n[D]);const N=A.get("offset");A.set("offset",wU((e+N*r)/a)),o.push(A)}r=a,e=0,i="",n=o}return Nk(this.element,n,this.preStyleProps,this.postStyleProps,r,e,i,!0)}}function wU(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}function xU(t,n,e,r,i,o,a,c,f,_,x,D,A){return{type:0,element:t,triggerName:n,isRemovalTransition:i,fromState:e,fromStyles:o,toState:r,toStyles:a,timelines:c,queriedElements:f,preStyleProps:_,postStyleProps:x,totalTime:D,errors:A}}const Fk={};class EU{_triggerName;ast;_stateStyles;constructor(n,e,r){this._triggerName=n,this.ast=e,this._stateStyles=r}match(n,e,r,i){return function Pie(t,n,e,r,i){return t.some(o=>o(n,e,r,i))}(this.ast.matchers,n,e,r,i)}buildStyles(n,e,r){let i=this._stateStyles.get("*");return void 0!==n&&(i=this._stateStyles.get(n?.toString())||i),i?i.buildStyles(e,r):new Map}build(n,e,r,i,o,a,c,f,_,x){const D=[],A=this.ast.options&&this.ast.options.params||Fk,B=this.buildStyles(r,c&&c.params||Fk,D),te=f&&f.params||Fk,ce=this.buildStyles(i,te,D),we=new Set,Ce=new Map,We=new Map,Se="void"===i,Ee={params:CU(te,A),delay:this.ast.options?.delay},Be=x?[]:Ok(n,e,this.ast.animation,o,a,B,ce,Ee,_,D);let Xe=0;return Be.forEach(mt=>{Xe=Math.max(mt.duration+mt.delay,Xe)}),D.length?xU(e,this._triggerName,r,i,Se,B,ce,[],[],Ce,We,Xe,D):(Be.forEach(mt=>{const sn=mt.element,cn=Rl(Ce,sn,new Set);mt.preStyleProps.forEach(Ci=>cn.add(Ci));const Li=Rl(We,sn,new Set);mt.postStyleProps.forEach(Ci=>Li.add(Ci)),sn!==e&&we.add(sn)}),xU(e,this._triggerName,r,i,Se,B,ce,Be,[...we.values()],Ce,We,Xe))}}function CU(t,n){const e={...n};return Object.entries(t).forEach(([r,i])=>{null!=i&&(e[r]=i)}),e}class Nie{styles;defaultParams;normalizer;constructor(n,e,r){this.styles=n,this.defaultParams=e,this.normalizer=r}buildStyles(n,e){const r=new Map,i=CU(n,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{a&&(a=Sb(a,i,e));const f=this.normalizer.normalizePropertyName(c,e);a=this.normalizer.normalizeStyleValue(c,f,a,e),r.set(c,a)})}),r}}class Lie{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(n,e,r){this.name=n,this.ast=e,this._normalizer=r,e.states.forEach(i=>{this.states.set(i.name,new Nie(i.style,i.options&&i.options.params||{},r))}),DU(this.states,"true","1"),DU(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new EU(n,i,this.states))}),this.fallbackTransition=function Fie(t,n){return new EU(t,{type:vn.Transition,animation:{type:vn.Sequence,steps:[],options:null},matchers:[(a,c)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,r,i){return this.transitionFactories.find(a=>a.match(n,e,r,i))||null}matchStyles(n,e,r){return this.fallbackTransition.buildStyles(n,e,r)}}function DU(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const Bie=new wE;class Vie{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r}register(n,e){const r=[],o=Rk(this._driver,e,r,[]);if(r.length)throw function Hre(){return new ue(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,r){const i=n.element,o=lU(this._normalizer,n.keyframes,e,r);return this._driver.animate(i,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,r={}){const i=[],o=this._animations.get(n);let a;const c=new Map;if(o?(a=Ok(this._driver,e,o,pU,xk,new Map,new Map,r,Bie,i),a.forEach(x=>{const D=Rl(c,x.element,new Map);x.postStyleProps.forEach(A=>D.set(A,null))})):(i.push(function $re(){return new ue(3300,!1)}()),a=[]),i.length)throw function qre(){return new ue(3504,!1)}();c.forEach((x,D)=>{x.forEach((A,N)=>{x.set(N,this._driver.computeStyle(D,N,Ih))})});const _=cp(a.map(x=>{const D=c.get(x.element);return this._buildPlayer(x,new Map,D)}));return this._playersById.set(n,_),_.onDestroy(()=>this.destroy(n)),this.players.push(_),_}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Gre(){return new ue(3301,!1)}();return e}listen(n,e,r,i){const o=bk(e,"","","");return yk(this._getPlayer(n),r,o,i),()=>{}}command(n,e,r,i){if("register"==r)return void this.register(n,i[0]);if("create"==r)return void this.create(n,e,i[0]||{});const o=this._getPlayer(n);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(n)}}}const TU="ng-animate-queued",Bk="ng-animate-disabled",$ie=[],SU={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},qie={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},uu="__ng_removed";class Vk{namespaceId;value;options;get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const r=n&&n.hasOwnProperty("value");if(this.value=function Zie(t){return t??null}(r?n.value:n),r){const{value:o,...a}=n;this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const r=this.options.params;Object.keys(e).forEach(i=>{null==r[i]&&(r[i]=e[i])})}}}const Ib="void",zk=new Vk(Ib);class Gie{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(n,e,r){this.id=n,this.hostElement=e,this._engine=r,this._hostClassName="ng-tns-"+n,xc(e,this._hostClassName)}listen(n,e,r,i){if(!this._triggers.has(e))throw function Wre(){return new ue(3302,!1)}();if(null==r||0==r.length)throw function Kre(){return new ue(3303,!1)}();if(!function Yie(t){return"start"==t||"done"==t}(r))throw function Zre(){return new ue(3400,!1)}();const o=Rl(this._elementListeners,n,[]),a={name:e,phase:r,callback:i};o.push(a);const c=Rl(this._engine.statesByElement,n,new Map);return c.has(e)||(xc(n,mE),xc(n,mE+"-"+e),c.set(e,zk)),()=>{this._engine.afterFlush(()=>{const f=o.indexOf(a);f>=0&&o.splice(f,1),this._triggers.has(e)||c.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function Yre(){return new ue(3401,!1)}();return e}trigger(n,e,r,i=!0){const o=this._getTrigger(e),a=new Uk(this.id,e,n);let c=this._engine.statesByElement.get(n);c||(xc(n,mE),xc(n,mE+"-"+e),this._engine.statesByElement.set(n,c=new Map));let f=c.get(e);const _=new Vk(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&f&&_.absorbOptions(f.options),c.set(e,_),f||(f=zk),_.value!==Ib&&f.value===_.value){if(!function Jie(t,n){const e=Object.keys(t),r=Object.keys(n);if(e.length!=r.length)return!1;for(let i=0;i<e.length;i++){const o=e[i];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(f.params,_.params)){const te=[],ce=o.matchStyles(f.value,f.params,te),we=o.matchStyles(_.value,_.params,te);te.length?this._engine.reportError(te):this._engine.afterFlush(()=>{Hm(n,ce),pd(n,we)})}return}const A=Rl(this._engine.playersByElement,n,[]);A.forEach(te=>{te.namespaceId==this.id&&te.triggerName==e&&te.queued&&te.destroy()});let N=o.matchTransition(f.value,_.value,n,_.params),B=!1;if(!N){if(!i)return;N=o.fallbackTransition,B=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:N,fromState:f,toState:_,player:a,isFallbackTransition:B}),B||(xc(n,TU),a.onStart(()=>{ny(n,TU)})),a.onDone(()=>{let te=this.players.indexOf(a);te>=0&&this.players.splice(te,1);const ce=this._engine.playersByElement.get(n);if(ce){let we=ce.indexOf(a);we>=0&&ce.splice(we,1)}}),this.players.push(a),A.push(a),a}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(i=>i.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const r=this._engine.driver.query(n,gE,!0);r.forEach(i=>{if(i[uu])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(a=>a.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(n,e,r,i){const o=this._engine.statesByElement.get(n),a=new Map;if(o){const c=[];if(o.forEach((f,_)=>{if(a.set(_,f.value),this._triggers.has(_)){const x=this.trigger(n,_,Ib,i);x&&c.push(x)}}),c.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,a),r&&cp(c).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(e&&r){const i=new Set;e.forEach(o=>{const a=o.name;if(i.has(a))return;i.add(a);const f=this._triggers.get(a).fallbackTransition,_=r.get(a)||zk,x=new Vk(Ib),D=new Uk(this.id,a,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:a,transition:f,fromState:_,toState:x,player:D,isFallbackTransition:!0})})}}removeNode(n,e){const r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let i=!1;if(r.totalAnimations){const o=r.players.length?r.playersByQueriedElement.get(n):[];if(o&&o.length)i=!0;else{let a=n;for(;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(n),i)r.markElementAsRemoved(this.id,n,!1,e);else{const o=n[uu];(!o||o===SU)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,e))}}insertNode(n,e){xc(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const o=r.element,a=this._elementListeners.get(o);a&&a.forEach(c=>{if(c.name==r.triggerName){const f=bk(o,r.triggerName,r.fromState.value,r.toState.value);f._data=n,yk(r.player,c.phase,f,c.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(r)}),this._queue=[],e.sort((r,i)=>{const o=r.transition.ast.depCount,a=i.transition.ast.depCount;return 0==o||0==a?o-a:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Wie{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(n,e)=>{};_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,r){this.bodyNode=n,this.driver=e,this._normalizer=r}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,e){const r=new Gie(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,e){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let a=!1,c=this.driver.getParentElement(e);for(;c;){const f=i.get(c);if(f){const _=r.indexOf(f);r.splice(_+1,0,n),a=!0;break}c=this.driver.getParentElement(c)}a||r.unshift(n)}else r.push(n);return i.set(e,n),n}register(n,e){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,e)),r}registerTrigger(n,e,r){let i=this._namespaceLookup[n];i&&i.register(e,r)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(n);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,r=this.statesByElement.get(n);if(r)for(let i of r.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&e.add(o)}return e}trigger(n,e,r,i){if(CE(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,r,i),!0}return!1}insertNode(n,e,r,i){if(!CE(e))return;const o=e[uu];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const a=this.collectedLeaveElements.indexOf(e);a>=0&&this.collectedLeaveElements.splice(a,1)}if(n){const a=this._fetchNamespace(n);a&&a.insertNode(e,r)}i&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),xc(n,Bk)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),ny(n,Bk))}removeNode(n,e,r){if(CE(e)){const i=n?this._fetchNamespace(n):null;i?i.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r);const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,r)}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,r,i,o){this.collectedLeaveElements.push(e),e[uu]={namespaceId:n,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,r,i,o){return CE(e)?this._fetchNamespace(n).listen(e,r,i,o):()=>{}}_buildInstruction(n,e,r,i,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,i,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,gE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,Ek,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return cp(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[uu];if(e&&e.setForRemoval){if(n[uu]=SU,e.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(Bk)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)xc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,n)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?cp(e).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(n){throw function Xre(){return new ue(3402,!1)}()}_flushAnimations(n,e){const r=new wE,i=[],o=new Map,a=[],c=new Map,f=new Map,_=new Map,x=new Set;this.disabledNodes.forEach(Pt=>{x.add(Pt);const Qt=this.driver.query(Pt,".ng-animate-queued",!0);for(let un=0;un<Qt.length;un++)x.add(Qt[un])});const D=this.bodyNode,A=Array.from(this.statesByElement.keys()),N=AU(A,this.collectedEnterElements),B=new Map;let te=0;N.forEach((Pt,Qt)=>{const un=pU+te++;B.set(Qt,un),Pt.forEach(cr=>xc(cr,un))});const ce=[],we=new Set,Ce=new Set;for(let Pt=0;Pt<this.collectedLeaveElements.length;Pt++){const Qt=this.collectedLeaveElements[Pt],un=Qt[uu];un&&un.setForRemoval&&(ce.push(Qt),we.add(Qt),un.hasAnimation?this.driver.query(Qt,".ng-star-inserted",!0).forEach(cr=>we.add(cr)):Ce.add(Qt))}const We=new Map,Se=AU(A,Array.from(we));Se.forEach((Pt,Qt)=>{const un=xk+te++;We.set(Qt,un),Pt.forEach(cr=>xc(cr,un))}),n.push(()=>{N.forEach((Pt,Qt)=>{const un=B.get(Qt);Pt.forEach(cr=>ny(cr,un))}),Se.forEach((Pt,Qt)=>{const un=We.get(Qt);Pt.forEach(cr=>ny(cr,un))}),ce.forEach(Pt=>{this.processLeaveNode(Pt)})});const Ee=[],Be=[];for(let Pt=this._namespaceList.length-1;Pt>=0;Pt--)this._namespaceList[Pt].drainQueuedTransitions(e).forEach(un=>{const cr=un.player,Ko=un.element;if(Ee.push(cr),this.collectedEnterElements.length){const Jn=Ko[uu];if(Jn&&Jn.setForMove){if(Jn.previousTriggersValues&&Jn.previousTriggersValues.has(un.triggerName)){const ea=Jn.previousTriggersValues.get(un.triggerName),xs=this.statesByElement.get(un.element);if(xs&&xs.has(un.triggerName)){const Rg=xs.get(un.triggerName);Rg.value=ea,xs.set(un.triggerName,Rg)}}return void cr.destroy()}}const Vl=!D||!this.driver.containsElement(D,Ko),ws=We.get(Ko),Tu=B.get(Ko),Di=this._buildInstruction(un,r,Tu,ws,Vl);if(Di.errors&&Di.errors.length)return void Be.push(Di);if(Vl)return cr.onStart(()=>Hm(Ko,Di.fromStyles)),cr.onDestroy(()=>pd(Ko,Di.toStyles)),void i.push(cr);if(un.isFallbackTransition)return cr.onStart(()=>Hm(Ko,Di.fromStyles)),cr.onDestroy(()=>pd(Ko,Di.toStyles)),void i.push(cr);const fT=[];Di.timelines.forEach(Jn=>{Jn.stretchStartingKeyframe=!0,this.disabledNodes.has(Jn.element)||fT.push(Jn)}),Di.timelines=fT,r.append(Ko,Di.timelines),a.push({instruction:Di,player:cr,element:Ko}),Di.queriedElements.forEach(Jn=>Rl(c,Jn,[]).push(cr)),Di.preStyleProps.forEach((Jn,ea)=>{if(Jn.size){let xs=f.get(ea);xs||f.set(ea,xs=new Set),Jn.forEach((Rg,dO)=>xs.add(dO))}}),Di.postStyleProps.forEach((Jn,ea)=>{let xs=_.get(ea);xs||_.set(ea,xs=new Set),Jn.forEach((Rg,dO)=>xs.add(dO))})});if(Be.length){const Pt=[];Be.forEach(Qt=>{Pt.push(function Qre(){return new ue(3505,!1)}())}),Ee.forEach(Qt=>Qt.destroy()),this.reportError(Pt)}const Xe=new Map,mt=new Map;a.forEach(Pt=>{const Qt=Pt.element;r.has(Qt)&&(mt.set(Qt,Qt),this._beforeAnimationBuild(Pt.player.namespaceId,Pt.instruction,Xe))}),i.forEach(Pt=>{const Qt=Pt.element;this._getPreviousPlayers(Qt,!1,Pt.namespaceId,Pt.triggerName,null).forEach(cr=>{Rl(Xe,Qt,[]).push(cr),cr.destroy()})});const sn=ce.filter(Pt=>RU(Pt,f,_)),cn=new Map;kU(cn,this.driver,Ce,_,Ih).forEach(Pt=>{RU(Pt,f,_)&&sn.push(Pt)});const Ci=new Map;N.forEach((Pt,Qt)=>{kU(Ci,this.driver,new Set(Pt),f,"!")}),sn.forEach(Pt=>{const Qt=cn.get(Pt),un=Ci.get(Pt);cn.set(Pt,new Map([...Qt?.entries()??[],...un?.entries()??[]]))});const ll=[],Pd=[],Rw={};a.forEach(Pt=>{const{element:Qt,player:un,instruction:cr}=Pt;if(r.has(Qt)){if(x.has(Qt))return un.onDestroy(()=>pd(Qt,cr.toStyles)),un.disabled=!0,un.overrideTotalTime(cr.totalTime),void i.push(un);let Ko=Rw;if(mt.size>1){let ws=Qt;const Tu=[];for(;ws=ws.parentNode;){const Di=mt.get(ws);if(Di){Ko=Di;break}Tu.push(ws)}Tu.forEach(Di=>mt.set(Di,Ko))}const Vl=this._buildAnimation(un.namespaceId,cr,Xe,o,Ci,cn);if(un.setRealPlayer(Vl),Ko===Rw)ll.push(un);else{const ws=this.playersByElement.get(Ko);ws&&ws.length&&(un.parentPlayer=cp(ws)),i.push(un)}}else Hm(Qt,cr.fromStyles),un.onDestroy(()=>pd(Qt,cr.toStyles)),Pd.push(un),x.has(Qt)&&i.push(un)}),Pd.forEach(Pt=>{const Qt=o.get(Pt.element);if(Qt&&Qt.length){const un=cp(Qt);Pt.setRealPlayer(un)}}),i.forEach(Pt=>{Pt.parentPlayer?Pt.syncPlayerEvents(Pt.parentPlayer):Pt.destroy()});for(let Pt=0;Pt<ce.length;Pt++){const Qt=ce[Pt],un=Qt[uu];if(ny(Qt,xk),un&&un.hasAnimation)continue;let cr=[];if(c.size){let Vl=c.get(Qt);Vl&&Vl.length&&cr.push(...Vl);let ws=this.driver.query(Qt,Ek,!0);for(let Tu=0;Tu<ws.length;Tu++){let Di=c.get(ws[Tu]);Di&&Di.length&&cr.push(...Di)}}const Ko=cr.filter(Vl=>!Vl.destroyed);Ko.length?Xie(this,Qt,Ko):this.processLeaveNode(Qt)}return ce.length=0,ll.forEach(Pt=>{this.players.push(Pt),Pt.onDone(()=>{Pt.destroy();const Qt=this.players.indexOf(Pt);this.players.splice(Qt,1)}),Pt.play()}),ll}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,r,i,o){let a=[];if(e){const c=this.playersByQueriedElement.get(n);c&&(a=c)}else{const c=this.playersByElement.get(n);if(c){const f=!o||o==Ib;c.forEach(_=>{_.queued||!f&&_.triggerName!=i||a.push(_)})}}return(r||i)&&(a=a.filter(c=>!(r&&r!=c.namespaceId||i&&i!=c.triggerName))),a}_beforeAnimationBuild(n,e,r){const o=e.element,a=e.isRemovalTransition?void 0:n,c=e.isRemovalTransition?void 0:e.triggerName;for(const f of e.timelines){const _=f.element,x=_!==o,D=Rl(r,_,[]);this._getPreviousPlayers(_,x,a,c,e.toState).forEach(N=>{const B=N.getRealPlayer();B.beforeDestroy&&B.beforeDestroy(),N.destroy(),D.push(N)})}Hm(o,e.fromStyles)}_buildAnimation(n,e,r,i,o,a){const c=e.triggerName,f=e.element,_=[],x=new Set,D=new Set,A=e.timelines.map(B=>{const te=B.element;x.add(te);const ce=te[uu];if(ce&&ce.removedBeforeQueried)return new Db(B.duration,B.delay);const we=te!==f,Ce=function Qie(t){const n=[];return MU(t,n),n}((r.get(te)||$ie).map(Xe=>Xe.getRealPlayer())).filter(Xe=>!!Xe.element&&Xe.element===te),We=o.get(te),Se=a.get(te),Ee=lU(this._normalizer,B.keyframes,We,Se),Be=this._buildPlayer(B,Ee,Ce);if(B.subTimeline&&i&&D.add(te),we){const Xe=new Uk(n,c,te);Xe.setRealPlayer(Be),_.push(Xe)}return Be});_.forEach(B=>{Rl(this.playersByQueriedElement,B.element,[]).push(B),B.onDone(()=>function Kie(t,n,e){let r=t.get(n);if(r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&t.delete(n)}return r}(this.playersByQueriedElement,B.element,B))}),x.forEach(B=>xc(B,mU));const N=cp(A);return N.onDestroy(()=>{x.forEach(B=>ny(B,mU)),pd(f,e.toStyles)}),D.forEach(B=>{Rl(i,B,[]).push(N)}),N}_buildPlayer(n,e,r){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,r):new Db(n.duration,n.delay)}}class Uk{namespaceId;triggerName;element;_player=new Db;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(n,e,r){this.namespaceId=n,this.triggerName=e,this.element=r}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,r)=>{e.forEach(i=>yk(n,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Rl(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function CE(t){return t&&1===t.nodeType}function IU(t,n){const e=t.style.display;return t.style.display=n??"none",e}function kU(t,n,e,r,i){const o=[];e.forEach(f=>o.push(IU(f)));const a=[];r.forEach((f,_)=>{const x=new Map;f.forEach(D=>{const A=n.computeStyle(_,D,i);x.set(D,A),(!A||0==A.length)&&(_[uu]=qie,a.push(_))}),t.set(_,x)});let c=0;return e.forEach(f=>IU(f,o[c++])),a}function AU(t,n){const e=new Map;if(t.forEach(c=>e.set(c,[])),0==n.length)return e;const i=new Set(n),o=new Map;function a(c){if(!c)return 1;let f=o.get(c);if(f)return f;const _=c.parentNode;return f=e.has(_)?_:i.has(_)?1:a(_),o.set(c,f),f}return n.forEach(c=>{const f=a(c);1!==f&&e.get(f).push(c)}),e}function xc(t,n){t.classList?.add(n)}function ny(t,n){t.classList?.remove(n)}function Xie(t,n,e){cp(e).onDone(()=>t.processLeaveNode(n))}function MU(t,n){for(let e=0;e<t.length;e++){const r=t[e];r instanceof sU?MU(r.players,n):n.push(r)}}function RU(t,n,e){const r=e.get(t);if(!r)return!1;let i=n.get(t);return i?r.forEach(o=>i.add(o)):n.set(t,r),e.delete(t),!0}class kb{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(n,e)=>{};constructor(n,e,r){this._driver=e,this._normalizer=r,this._transitionEngine=new Wie(n.body,e,r),this._timelineEngine=new Vie(n.body,e,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(n,e,r,i,o){const a=n+"-"+i;let c=this._triggerCache[a];if(!c){const f=[],x=Rk(this._driver,o,f,[]);if(f.length)throw function Ure(){return new ue(3404,!1)}();c=function Oie(t,n,e){return new Lie(t,n,e)}(i,x,this._normalizer),this._triggerCache[a]=c}this._transitionEngine.registerTrigger(e,i,c)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,r,i){this._transitionEngine.insertNode(n,e,r,i)}onRemove(n,e,r){this._transitionEngine.removeNode(n,e,r)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,r,i){if("@"==r.charAt(0)){const[o,a]=cU(r);this._timelineEngine.command(o,e,a,i)}else this._transitionEngine.trigger(n,e,r,i)}listen(n,e,r,i,o){if("@"==r.charAt(0)){const[a,c]=cU(r);return this._timelineEngine.listen(a,e,c,o)}return this._transitionEngine.listen(n,e,r,i,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let toe=(()=>{class t{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(e,r,i){this._element=e,this._startStyles=r,this._endStyles=i;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&pd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(pd(this._element,this._initialStyles),this._endStyles&&(pd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Hm(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Hm(this._element,this._endStyles),this._endStyles=null),pd(this._element,this._initialStyles),this._state=3)}}return t})();function jk(t){let n=null;return t.forEach((e,r)=>{(function noe(t){return"display"===t||"position"===t})(r)&&(n=n||new Map,n.set(r,e))}),n}class PU{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer=null;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(n,e,r,i){this.element=n,this.keyframes=e,this.options=r,this._specialStyles=i,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer()&&this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return this.domPlayer;this._initialized=!0;const n=this.keyframes,e=this._triggerWebAnimation(this.element,n,this.options);if(!e)return this._onFinish(),null;this.domPlayer=e,this._finalKeyframe=n.length?n[n.length-1]:new Map;const r=()=>this._onFinish();return e.addEventListener("finish",r),this.onDestroy(()=>{e.removeEventListener("finish",r)}),e}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer?.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(n,e,r){const i=this._convertKeyframesToObject(e);try{return n.animate(i,r)}catch{return null}}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){const n=this._buildPlayer();n&&(this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),n.play())}pause(){this.init(),this.domPlayer?.pause()}finish(){this.init(),this.domPlayer&&(this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish())}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer?.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){this.domPlayer||this.init(),this.domPlayer&&(this.domPlayer.currentTime=n*this.time)}getPosition(){return this.domPlayer?+(this.domPlayer.currentTime??0)/this.time:this._initialized?1:0}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&n.set(i,this._finished?r:Sk(this.element,i))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class NU{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}containsElement(n,e){return dU(n,e)}getParentElement(n){return wk(n)}query(n,e,r){return hU(n,e,r)}computeStyle(n,e,r){return Sk(n,e)}animate(n,e,r,i,o,a=[]){const f={duration:r,delay:i,fill:0==i?"both":"forwards"};o&&(f.easing=o);const _=new Map,x=a.filter(N=>N instanceof PU);(function die(t,n){return 0===t||0===n})(r,i)&&x.forEach(N=>{N.currentSnapshot.forEach((B,te)=>_.set(te,B))});let D=function lie(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}(e).map(N=>new Map(N));D=function hie(t,n,e){if(e.size&&n.length){let r=n[0],i=[];if(e.forEach((o,a)=>{r.has(a)||i.push(a),r.set(a,o)}),i.length)for(let o=1;o<n.length;o++){let a=n[o];i.forEach(c=>a.set(c,Sk(t,c)))}}return n}(n,D,_);const A=function eoe(t,n){let e=null,r=null;return Array.isArray(n)&&n.length?(e=jk(n[0]),n.length>1&&(r=jk(n[n.length-1]))):n instanceof Map&&(e=jk(n)),e||r?new toe(t,e,r):null}(n,D);return new PU(n,D,f,A)}}const OU="@.disabled";class LU{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(n,e,r,i){this.namespaceId=n,this.delegate=e,this.engine=r,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,r,i=!0){this.delegate.insertBefore(n,e,r),this.engine.onInsert(this.namespaceId,e,n,i)}removeChild(n,e,r,i){i?this.delegate.removeChild(n,e,r,i):this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,r,i){this.delegate.setAttribute(n,e,r,i)}removeAttribute(n,e,r){this.delegate.removeAttribute(n,e,r)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,r,i){this.delegate.setStyle(n,e,r,i)}removeStyle(n,e,r){this.delegate.removeStyle(n,e,r)}setProperty(n,e,r){"@"==e.charAt(0)&&e==OU?this.disableAnimations(n,!!r):this.delegate.setProperty(n,e,r)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,r,i){return this.delegate.listen(n,e,r,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class roe extends LU{factory;constructor(n,e,r,i,o){super(e,r,i,o),this.factory=n,this.namespaceId=e}setProperty(n,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==OU?this.disableAnimations(n,r=void 0===r||!!r):this.engine.process(this.namespaceId,n,e.slice(1),r):this.delegate.setProperty(n,e,r)}listen(n,e,r,i){if("@"==e.charAt(0)){const o=function ioe(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let a=e.slice(1),c="";return"@"!=a.charAt(0)&&([a,c]=function ooe(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(a)),this.engine.listen(this.namespaceId,o,a,c,f=>{this.factory.scheduleListenerCallback(f._data||-1,r,f)})}return this.delegate.listen(n,e,r,i)}}class soe{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(n,e,r){this.delegate=n,this.engine=e,this._zone=r,e.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(n,e){const i=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){const _=this._rendererCache;let x=_.get(i);return x||(x=new LU("",i,this.engine,()=>_.delete(i)),_.set(i,x)),x}const o=e.id,a=e.id+"-"+this._currentId;this._currentId++,this.engine.register(a,n);const c=_=>{Array.isArray(_)?_.forEach(c):this.engine.registerTrigger(o,a,n,_.name,_)};return e.data.animation.forEach(c),new roe(this,a,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,r){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>e(r));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),i.push([e,r])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(n){this.engine.flush(),this.delegate.componentReplaced?.(n)}}const doe=[{provide:kk,useFactory:()=>new NU},{provide:ha,useFactory:()=>"BrowserAnimations"},...[{provide:Ak,useFactory:function loe(){return new _U}},{provide:kb,useClass:(()=>{class t extends kb{constructor(e,r,i){super(e,r,i)}ngOnDestroy(){this.flush()}static \u0275fac=function(r){return new(r||t)(Dt(jn),Dt(kk),Dt(Ak))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})()},{provide:Al,useFactory:function coe(){return new soe(X(uk),X(kb),X(on))}}]];function Hk(t,n){return t?n?t.endsWith("/")?n.startsWith("/")?t+n.slice(1):t+n:n.startsWith("/")?t+n:`${t}/${n}`:t:n}function BU(t){const n=t.search(/#|\?|$/);return"/"===t[n-1]?t.slice(0,n-1)+t.slice(n):t}function Ah(t){return t&&"?"!==t[0]?`?${t}`:t}let qm=(()=>{class t{historyGo(e){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(zU),providedIn:"root"})}return t})();const VU=new Fe("");let zU=(()=>{class t extends qm{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??X(jn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Hk(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Ah(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,o){const a=this.prepareExternalUrl(i+Ah(o));this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){const a=this.prepareExternalUrl(i+Ah(o));this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||t)(Dt(uE),Dt(VU,8))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ry=(()=>{class t{_subject=new J;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._basePath=function moe(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(BU(UU(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Ah(r))}normalize(e){return t.stripTrailingSlash(function poe(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,UU(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._locationStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ah(r)),i)}replaceState(e,r="",i=null){this._locationStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ah(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Ah;static joinWithSlash=Hk;static stripTrailingSlash=BU;static \u0275fac=function(r){return new(r||t)(Dt(qm))};static \u0275prov=je({token:t,factory:()=>function foe(){return new ry(Dt(qm))}(),providedIn:"root"})}return t})();function UU(t){return t.replace(/\/index.html$/,"")}let goe=(()=>{class t extends qm{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,r){super(),this._platformLocation=e,null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){const r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=Hk(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,i,o){const a=this.prepareExternalUrl(i+Ah(o))||this._platformLocation.pathname;this._platformLocation.pushState(e,r,a)}replaceState(e,r,i,o){const a=this.prepareExternalUrl(i+Ah(o))||this._platformLocation.pathname;this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(r){return new(r||t)(Dt(uE),Dt(VU,8))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();var ya=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(ya||{}),ni=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(ni||{}),Nl=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Nl||{});function SE(t,n){return Cc(pa(t)[wi.DateFormat],n)}function IE(t,n){return Cc(pa(t)[wi.TimeFormat],n)}function kE(t,n){return Cc(pa(t)[wi.DateTimeFormat],n)}function Ec(t,n){const e=pa(t),r=e[wi.NumberSymbols][n];if(typeof r>"u"){if(12===n)return e[wi.NumberSymbols][0];if(13===n)return e[wi.NumberSymbols][1]}return r}function HU(t){if(!t[wi.ExtraData])throw new ue(2303,!1)}function Cc(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new ue(2304,!1)}function qk(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const Aoe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,AE={},Moe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function Roe(t,n,e,r){let i=function Uoe(t){if(GU(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[i,o=1,a=1]=t.split("-").map(c=>+c);return ME(i,o-1,a)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let r;if(r=t.match(Aoe))return function joe(t){const n=new Date(0);let e=0,r=0;const i=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const a=Number(t[4]||0)-e,c=Number(t[5]||0)-r,f=Number(t[6]||0),_=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,a,c,f,_),n}(r)}const n=new Date(t);if(!GU(n))throw new ue(2311,!1);return n}(t);n=Mh(e,n)||n;let c,a=[];for(;n;){if(c=Moe.exec(n),!c){a.push(n);break}{a=a.concat(c.slice(1));const x=a.pop();if(!x)break;n=x}}let f=i.getTimezoneOffset();r&&(f=qU(r,f),i=function zoe(t,n){const i=t.getTimezoneOffset();return function Voe(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,-1*(qU(n,i)-i))}(i,r));let _="";return a.forEach(x=>{const D=function Boe(t){if(Wk[t])return Wk[t];let n;switch(t){case"G":case"GG":case"GGG":n=ui(3,ni.Abbreviated);break;case"GGGG":n=ui(3,ni.Wide);break;case"GGGGG":n=ui(3,ni.Narrow);break;case"y":n=$o(0,1,0,!1,!0);break;case"yy":n=$o(0,2,0,!0,!0);break;case"yyy":n=$o(0,3,0,!1,!0);break;case"yyyy":n=$o(0,4,0,!1,!0);break;case"Y":n=OE(1);break;case"YY":n=OE(2,!0);break;case"YYY":n=OE(3);break;case"YYYY":n=OE(4);break;case"M":case"L":n=$o(1,1,1);break;case"MM":case"LL":n=$o(1,2,1);break;case"MMM":n=ui(2,ni.Abbreviated);break;case"MMMM":n=ui(2,ni.Wide);break;case"MMMMM":n=ui(2,ni.Narrow);break;case"LLL":n=ui(2,ni.Abbreviated,ya.Standalone);break;case"LLLL":n=ui(2,ni.Wide,ya.Standalone);break;case"LLLLL":n=ui(2,ni.Narrow,ya.Standalone);break;case"w":n=Gk(1);break;case"ww":n=Gk(2);break;case"W":n=Gk(1,!0);break;case"d":n=$o(2,1);break;case"dd":n=$o(2,2);break;case"c":case"cc":n=$o(7,1);break;case"ccc":n=ui(1,ni.Abbreviated,ya.Standalone);break;case"cccc":n=ui(1,ni.Wide,ya.Standalone);break;case"ccccc":n=ui(1,ni.Narrow,ya.Standalone);break;case"cccccc":n=ui(1,ni.Short,ya.Standalone);break;case"E":case"EE":case"EEE":n=ui(1,ni.Abbreviated);break;case"EEEE":n=ui(1,ni.Wide);break;case"EEEEE":n=ui(1,ni.Narrow);break;case"EEEEEE":n=ui(1,ni.Short);break;case"a":case"aa":case"aaa":n=ui(0,ni.Abbreviated);break;case"aaaa":n=ui(0,ni.Wide);break;case"aaaaa":n=ui(0,ni.Narrow);break;case"b":case"bb":case"bbb":n=ui(0,ni.Abbreviated,ya.Standalone,!0);break;case"bbbb":n=ui(0,ni.Wide,ya.Standalone,!0);break;case"bbbbb":n=ui(0,ni.Narrow,ya.Standalone,!0);break;case"B":case"BB":case"BBB":n=ui(0,ni.Abbreviated,ya.Format,!0);break;case"BBBB":n=ui(0,ni.Wide,ya.Format,!0);break;case"BBBBB":n=ui(0,ni.Narrow,ya.Format,!0);break;case"h":n=$o(3,1,-12);break;case"hh":n=$o(3,2,-12);break;case"H":n=$o(3,1);break;case"HH":n=$o(3,2);break;case"m":n=$o(4,1);break;case"mm":n=$o(4,2);break;case"s":n=$o(5,1);break;case"ss":n=$o(5,2);break;case"S":n=$o(6,1);break;case"SS":n=$o(6,2);break;case"SSS":n=$o(6,3);break;case"Z":case"ZZ":case"ZZZ":n=PE(0);break;case"ZZZZZ":n=PE(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=PE(1);break;case"OOOO":case"ZZZZ":case"zzzz":n=PE(2);break;default:return null}return Wk[t]=n,n}(x);_+=D?D(i,e,f):"''"===x?"'":x.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),_}function ME(t,n,e){const r=new Date(0);return r.setFullYear(t,n,e),r.setHours(0,0,0),r}function Mh(t,n){const e=function yoe(t){return pa(t)[wi.LocaleId]}(t);if(AE[e]??={},AE[e][n])return AE[e][n];let r="";switch(n){case"shortDate":r=SE(t,Nl.Short);break;case"mediumDate":r=SE(t,Nl.Medium);break;case"longDate":r=SE(t,Nl.Long);break;case"fullDate":r=SE(t,Nl.Full);break;case"shortTime":r=IE(t,Nl.Short);break;case"mediumTime":r=IE(t,Nl.Medium);break;case"longTime":r=IE(t,Nl.Long);break;case"fullTime":r=IE(t,Nl.Full);break;case"short":const i=Mh(t,"shortTime"),o=Mh(t,"shortDate");r=RE(kE(t,Nl.Short),[i,o]);break;case"medium":const a=Mh(t,"mediumTime"),c=Mh(t,"mediumDate");r=RE(kE(t,Nl.Medium),[a,c]);break;case"long":const f=Mh(t,"longTime"),_=Mh(t,"longDate");r=RE(kE(t,Nl.Long),[f,_]);break;case"full":const x=Mh(t,"fullTime"),D=Mh(t,"fullDate");r=RE(kE(t,Nl.Full),[x,D])}return r&&(AE[e][n]=r),r}function RE(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,r){return null!=n&&r in n?n[r]:e})),t}function du(t,n,e="-",r,i){let o="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,o=e));let a=String(t);for(;a.length<n;)a="0"+a;return r&&(a=a.slice(a.length-n)),o+a}function $o(t,n,e=0,r=!1,i=!1){return function(o,a){let c=function Noe(t,n){switch(t){case 0:return n.getFullYear();case 1:return n.getMonth();case 2:return n.getDate();case 3:return n.getHours();case 4:return n.getMinutes();case 5:return n.getSeconds();case 6:return n.getMilliseconds();case 7:return n.getDay();default:throw new ue(2301,!1)}}(t,o);if((e>0||c>-e)&&(c+=e),3===t)0===c&&-12===e&&(c=12);else if(6===t)return function Poe(t,n){return du(t,3).substring(0,n)}(c,n);const f=Ec(a,5);return du(c,n,f,r,i)}}function ui(t,n,e=ya.Format,r=!1){return function(i,o){return function Ooe(t,n,e,r,i,o){switch(e){case 2:return function woe(t,n,e){const r=pa(t),o=Cc([r[wi.MonthsFormat],r[wi.MonthsStandalone]],n);return Cc(o,e)}(n,i,r)[t.getMonth()];case 1:return function boe(t,n,e){const r=pa(t),o=Cc([r[wi.DaysFormat],r[wi.DaysStandalone]],n);return Cc(o,e)}(n,i,r)[t.getDay()];case 0:const a=t.getHours(),c=t.getMinutes();if(o){const _=function Doe(t){const n=pa(t);return HU(n),(n[wi.ExtraData][2]||[]).map(r=>"string"==typeof r?qk(r):[qk(r[0]),qk(r[1])])}(n),x=function Toe(t,n,e){const r=pa(t);HU(r);const o=Cc([r[wi.ExtraData][0],r[wi.ExtraData][1]],n)||[];return Cc(o,e)||[]}(n,i,r),D=_.findIndex(A=>{if(Array.isArray(A)){const[N,B]=A,te=a>=N.hours&&c>=N.minutes,ce=a<B.hours||a===B.hours&&c<B.minutes;if(N.hours<B.hours){if(te&&ce)return!0}else if(te||ce)return!0}else if(A.hours===a&&A.minutes===c)return!0;return!1});if(-1!==D)return x[D]}return function voe(t,n,e){const r=pa(t),o=Cc([r[wi.DayPeriodsFormat],r[wi.DayPeriodsStandalone]],n);return Cc(o,e)}(n,i,r)[a<12?0:1];case 3:return function xoe(t,n){return Cc(pa(t)[wi.Eras],n)}(n,r)[t.getFullYear()<=0?0:1];default:throw new ue(2302,!1)}}(i,o,t,n,e,r)}}function PE(t){return function(n,e,r){const i=-1*r,o=Ec(e,5),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case 0:return(i>=0?"+":"")+du(a,2,o)+du(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+du(a,1,o);case 2:return"GMT"+(i>=0?"+":"")+du(a,2,o)+":"+du(Math.abs(i%60),2,o);case 3:return 0===r?"Z":(i>=0?"+":"")+du(a,2,o)+":"+du(Math.abs(i%60),2,o);default:throw new ue(2310,!1)}}}function $U(t){const n=t.getDay(),e=0===n?-3:4-n;return ME(t.getFullYear(),t.getMonth(),t.getDate()+e)}function Gk(t,n=!1){return function(e,r){let i;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,a=e.getDate();i=1+Math.floor((a+o)/7)}else{const o=$U(e),a=function Foe(t){const n=ME(t,0,1).getDay();return ME(t,0,1+(n<=4?4:11)-n)}(o.getFullYear()),c=o.getTime()-a.getTime();i=1+Math.round(c/6048e5)}return du(i,t,Ec(r,5))}}function OE(t,n=!1){return function(e,r){return du($U(e).getFullYear(),t,Ec(r,5),n)}}const Wk={};function qU(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function GU(t){return t instanceof Date&&!isNaN(t.valueOf())}const Jk=/\s+/,YU=[];let XU=(()=>{class t{_ngEl;_renderer;initialClasses=YU;rawClass;stateMap=new Map;constructor(e,r){this._ngEl=e,this._renderer=r}set klass(e){this.initialClasses=null!=e?e.trim().split(Jk):YU}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(Jk):e}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const r of e)this._updateState(r,!0);else if(null!=e)for(const r of Object.keys(e))this._updateState(r,!!e[r]);this._applyStateDiff()}_updateState(e,r){const i=this.stateMap.get(e);void 0!==i?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const r=e[0],i=e[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(e,r){(e=e.trim()).length>0&&e.split(Jk).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||t)(Re(Vr),Re(Ka))};static \u0275dir=Ft({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return t})();const yse=new Fe(""),vse=new Fe("");let FE=(()=>{class t{locale;defaultTimezone;defaultOptions;constructor(e,r,i){this.locale=e,this.defaultTimezone=r,this.defaultOptions=i}transform(e,r,i,o){if(null==e||""===e||e!=e)return null;try{return Roe(e,r??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,i??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(a){throw function hu(t,n){return new ue(2100,!1)}()}}static \u0275fac=function(r){return new(r||t)(Re(Th,16),Re(yse,24),Re(vse,24))};static \u0275pipe=Za({name:"date",type:t,pure:!0})}return t})(),Rh=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})();function di(t,n){return function ku(t,n){const e=Object.create(Sa);e.computation=t,void 0!==n&&(e.equal=n);const r=()=>{if(to(e),Ro(e),e.value===no)throw e.error;return e.value};return r[ze]=e,r}(t,n?.equal)}function a4(t){return!!t&&(t instanceof U||pr(t.lift)&&pr(t.subscribe))}function Gm(t){return this instanceof Gm?(this.v=t,this):new Gm(t)}function $se(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function u4(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(o){e[o]=t[o]&&function(a){return new Promise(function(c,f){!function i(o,a,c,f){Promise.resolve(f).then(function(_){o({value:_,done:c})},a)}(c,f,(a=t[o](a)).done,a.value)})}}}Error,Error;const d4=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function h4(t){return pr(t?.then)}function f4(t){return pr(t[Wl])}function p4(t){return Symbol.asyncIterator&&pr(t?.[Symbol.asyncIterator])}function m4(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const g4=function Gse(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function _4(t){return pr(t?.[g4])}function y4(t){return function Hse(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=e.apply(t,n||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(A){r[A]&&(i[A]=function(N){return new Promise(function(B,te){o.push([A,N,B,te])>1||c(A,N)})})}function c(A,N){try{!function f(A){A.value instanceof Gm?Promise.resolve(A.value.v).then(_,x):D(o[0][2],A)}(r[A](N))}catch(B){D(o[0][3],B)}}function _(A){c("next",A)}function x(A){c("throw",A)}function D(A,N){A(N),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:r,done:i}=yield Gm(e.read());if(i)return yield Gm(void 0);yield yield Gm(r)}}finally{e.releaseLock()}})}function v4(t){return pr(t?.getReader)}function Dc(t){if(t instanceof U)return t;if(null!=t){if(f4(t))return function Wse(t){return new U(n=>{const e=t[Wl]();if(pr(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(d4(t))return function Kse(t){return new U(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(h4(t))return function Zse(t){return new U(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Au)})}(t);if(p4(t))return b4(t);if(_4(t))return function Yse(t){return new U(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(v4(t))return function Xse(t){return b4(y4(t))}(t)}throw m4(t)}function b4(t){return new U(n=>{(function Qse(t,n){var e,r,i,o;return function Use(t,n,e,r){return new(e||(e=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(D){a(D)}}function f(x){try{_(r.throw(x))}catch(D){a(D)}}function _(x){x.done?o(x.value):function i(o){return o instanceof e?o:new e(function(a){a(o)})}(x.value).then(c,f)}_((r=r.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=$se(t);!(r=yield e.next()).done;)if(n.next(r.value),n.closed)return}catch(a){i={error:a}}finally{try{r&&!r.done&&(o=e.return)&&(yield o.call(e))}finally{if(i)throw i.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function Ph(t,n,e,r=0,i=!1){const o=n.schedule(function(){e(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function w4(t,n=0){return Vo((e,r)=>{e.subscribe(new si(r,i=>Ph(r,t,()=>r.next(i),n),()=>Ph(r,t,()=>r.complete(),n),i=>Ph(r,t,()=>r.error(i),n)))})}function x4(t,n=0){return Vo((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function E4(t,n){if(!t)throw new Error("Iterable cannot be null");return new U(e=>{Ph(e,n,()=>{const r=t[Symbol.asyncIterator]();Ph(e,n,()=>{r.next().then(i=>{i.done?e.complete():e.next(i.value)})},0,!0)})})}function gs(t,n){return n?function iae(t,n){if(null!=t){if(f4(t))return function Jse(t,n){return Dc(t).pipe(x4(n),w4(n))}(t,n);if(d4(t))return function tae(t,n){return new U(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}(t,n);if(h4(t))return function eae(t,n){return Dc(t).pipe(x4(n),w4(n))}(t,n);if(p4(t))return E4(t,n);if(_4(t))return function nae(t,n){return new U(e=>{let r;return Ph(e,n,()=>{r=t[g4](),Ph(e,n,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(a){return void e.error(a)}o?e.complete():e.next(i)},0,!0)}),()=>pr(r?.return)&&r.return()})}(t,n);if(v4(t))return function rae(t,n){return E4(y4(t),n)}(t,n)}throw m4(t)}(t,n):Dc(t)}function C4(t){return t&&pr(t.schedule)}function sA(t){return t[t.length-1]}function D4(t){return pr(sA(t))?t.pop():void 0}function Mb(t){return C4(sA(t))?t.pop():void 0}function Rn(...t){return gs(t,Mb(t))}const{isArray:sae}=Array,{getPrototypeOf:aae,prototype:lae,keys:cae}=Object;function T4(t){if(1===t.length){const n=t[0];if(sae(n))return{args:n,keys:null};if(function uae(t){return t&&"object"==typeof t&&aae(t)===lae}(n)){const e=cae(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}const{isArray:dae}=Array;function S4(t){return hr(n=>function hae(t,n){return dae(n)?t(...n):t(n)}(t,n))}function I4(t,n){return t.reduce((e,r,i)=>(e[r]=n[i],e),{})}function aA(...t){const n=Mb(t),e=D4(t),{args:r,keys:i}=T4(t);if(0===r.length)return gs([],n);const o=new U(function fae(t,n,e=tr){return r=>{k4(n,()=>{const{length:i}=t,o=new Array(i);let a=i,c=i;for(let f=0;f<i;f++)k4(n,()=>{const _=gs(t[f],n);let x=!1;_.subscribe(new si(r,D=>{o[f]=D,x||(x=!0,c--),c||r.next(e(o.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,n,i?a=>I4(i,a):tr));return e?o.pipe(S4(e)):o}function k4(t,n,e){t?Ph(e,t,n):n()}const lA=rs(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Tc(t,n,e=1/0){return pr(n)?Tc((r,i)=>hr((o,a)=>n(r,o,i,a))(Dc(t(r,i))),e):("number"==typeof n&&(e=n),Vo((r,i)=>function pae(t,n,e,r,i,o,a,c){const f=[];let _=0,x=0,D=!1;const A=()=>{D&&!f.length&&!_&&n.complete()},N=te=>_<r?B(te):f.push(te),B=te=>{o&&n.next(te),_++;let ce=!1;Dc(e(te,x++)).subscribe(new si(n,we=>{i?.(we),o?N(we):n.next(we)},()=>{ce=!0},void 0,()=>{if(ce)try{for(_--;f.length&&_<r;){const we=f.shift();a?Ph(n,a,()=>B(we)):B(we)}A()}catch(we){n.error(we)}}))};return t.subscribe(new si(n,N,()=>{D=!0,A()})),()=>{c?.()}}(r,i,t,e)))}function oy(t=1/0){return Tc(tr,t)}function Rb(...t){return function mae(){return oy(1)}()(gs(t,Mb(t)))}function Pb(t){return new U(n=>{Dc(t()).subscribe(n)})}const va=new U(t=>t.complete());function _s(t,n){return Vo((e,r)=>{let i=0;e.subscribe(new si(r,o=>t.call(n,o,i++)&&r.next(o)))})}function Fs(t){return t<=0?()=>va:Vo((n,e)=>{let r=0;n.subscribe(new si(e,i=>{++r<=t&&(e.next(i),t<=r&&e.complete())}))})}function vae(t=bae){return Vo((n,e)=>{let r=!1;n.subscribe(new si(e,i=>{r=!0,e.next(i)},()=>r?e.complete():e.error(t())))})}function bae(){return new lA}function up(t,n){const e=arguments.length>=2;return r=>r.pipe(t?_s((i,o)=>t(i,o,r)):tr,Fs(1),e?function yae(t){return Vo((n,e)=>{let r=!1;n.subscribe(new si(e,i=>{r=!0,e.next(i)},()=>{r||e.next(t),e.complete()}))})}(n):vae(()=>new lA))}function nl(t,n){return Vo((e,r)=>{let i=null,o=0,a=!1;const c=()=>a&&!i&&r.complete();e.subscribe(new si(r,f=>{i?.unsubscribe();let _=0;const x=o++;Dc(t(f,x)).subscribe(i=new si(r,D=>r.next(n?n(f,D,x,_++):D),()=>{i=null,c()}))},()=>{a=!0,c()}))})}function sy(...t){const n=Mb(t);return Vo((e,r)=>{(n?Rb(t,e,n):Rb(t,e)).subscribe(r)})}function md(t){return Vo((n,e)=>{Dc(t).subscribe(new si(e,()=>e.complete(),Ma)),!e.closed&&n.subscribe(e)})}function BE(t,n){return pr(n)?Tc(t,n,1):Tc(t,1)}function Nh(t,n,e){const r=pr(t)||n||e?{next:t,error:n,complete:e}:t;return r?Vo((i,o)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let c=!0;i.subscribe(new si(o,f=>{var _;null===(_=r.next)||void 0===_||_.call(r,f),o.next(f)},()=>{var f;c=!1,null===(f=r.complete)||void 0===f||f.call(r),o.complete()},f=>{var _;c=!1,null===(_=r.error)||void 0===_||_.call(r,f),o.error(f)},()=>{var f,_;c&&(null===(f=r.unsubscribe)||void 0===f||f.call(r)),null===(_=r.finalize)||void 0===_||_.call(r)}))}):tr}function A4(t){return t<=0?()=>va:Vo((n,e)=>{let r=[];n.subscribe(new si(e,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)e.next(i);e.complete()},void 0,()=>{r=null}))})}function cA(t){return Vo((n,e)=>{let o,r=null,i=!1;r=n.subscribe(new si(e,void 0,void 0,a=>{o=Dc(t(a,cA(t)(n))),r?(r.unsubscribe(),r=null,o.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(e))})}function M4(t){return Vo((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}let wae=(()=>{class t{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(r){return new(r||t)(Dt(jn))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),N4=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:function(r){let i=null;return i=r?new(r||t):Dt(Dae),i},providedIn:"root"})}return t})(),Dae=(()=>{class t extends N4{_doc;constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Il.NONE:return r;case Il.HTML:return ld(r,"HTML")?Sl(r):LO(this._doc,String(r)).toString();case Il.STYLE:return ld(r,"Style")?Sl(r):r;case Il.SCRIPT:if(ld(r,"Script"))return Sl(r);throw new ue(5200,!1);case Il.URL:return ld(r,"URL")?Sl(r):Hx(String(r));case Il.RESOURCE_URL:if(ld(r,"ResourceURL"))return Sl(r);throw new ue(5201,!1);default:throw new ue(5202,!1)}}bypassSecurityTrustHtml(e){return function BW(t){return new RW(t)}(e)}bypassSecurityTrustStyle(e){return function VW(t){return new PW(t)}(e)}bypassSecurityTrustScript(e){return function zW(t){return new NW(t)}(e)}bypassSecurityTrustUrl(e){return function UW(t){return new OW(t)}(e)}bypassSecurityTrustResourceUrl(e){return function jW(t){return new LW(t)}(e)}static \u0275fac=function(r){return new(r||t)(Dt(jn))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Pn="primary",Ob=Symbol("RouteTitle");class Tae{params;constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function ay(t){return new Tae(t)}function uA(t,n,e){for(let r=0;r<t.length;r++){const i=t[r],o=n[r];if(":"===i[0])e[i.substring(1)]=o;else if(i!==o.path)return!1}return!0}function Sae(t,n,e){const r=e.path.split("/"),i=r.indexOf("**");if(-1===i){if(r.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||r.length<t.length))return null;const f={},_=t.slice(0,r.length);return uA(r,_,f)?{consumed:_,posParams:f}:null}if(i!==r.lastIndexOf("**"))return null;const o=r.slice(0,i),a=r.slice(i+1);if(o.length+a.length>t.length||"full"===e.pathMatch&&n.hasChildren()&&"**"!==e.path)return null;const c={};return uA(o,t.slice(0,o.length),c)&&uA(a,t.slice(t.length-a.length),c)?{consumed:t,posParams:c}:null}function VE(t){return new Promise((n,e)=>{t.pipe(up()).subscribe({next:r=>n(r),error:r=>e(r)})})}function gd(t,n){const e=t?dA(t):void 0,r=n?dA(n):void 0;if(!e||!r||e.length!=r.length)return!1;let i;for(let o=0;o<e.length;o++)if(i=e[o],!O4(t[i],n[i]))return!1;return!0}function dA(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function O4(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),r=[...n].sort();return e.every((i,o)=>r[o]===i)}return t===n}function Wm(t){return a4(t)?t:sb(t)?gs(Promise.resolve(t)):Rn(t)}function L4(t){return a4(t)?VE(t):Promise.resolve(t)}const Aae={exact:function B4(t,n,e){if(!Km(t.segments,n.segments)||!zE(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!t.children[r]||!B4(t.children[r],n.children[r],e))return!1;return!0},subset:V4},F4={exact:function Rae(t,n){return gd(t,n)},subset:function Pae(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>O4(t[e],n[e]))},ignored:()=>!0};function hA(t,n,e){return Aae[e.paths](t.root,n.root,e.matrixParams)&&F4[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function V4(t,n,e){return z4(t,n,n.segments,e)}function z4(t,n,e,r){if(t.segments.length>e.length){const i=t.segments.slice(0,e.length);return!(!Km(i,e)||n.hasChildren()||!zE(i,e,r))}if(t.segments.length===e.length){if(!Km(t.segments,e)||!zE(t.segments,e,r))return!1;for(const i in n.children)if(!t.children[i]||!V4(t.children[i],n.children[i],r))return!1;return!0}{const i=e.slice(0,t.segments.length),o=e.slice(t.segments.length);return!!(Km(t.segments,i)&&zE(t.segments,i,r)&&t.children[Pn])&&z4(t.children[Pn],n,o,r)}}function zE(t,n,e){return n.every((r,i)=>F4[e](t[i].parameters,r.parameters))}class _d{root;queryParams;fragment;_queryParamMap;constructor(n=new Yr([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ay(this.queryParams),this._queryParamMap}toString(){return Lae.serialize(this)}}class Yr{segments;children;parent=null;constructor(n,e){this.segments=n,this.children=e,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return UE(this)}}class Lb{path;parameters;_parameterMap;constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap??=ay(this.parameters),this._parameterMap}toString(){return H4(this)}}function Km(t,n){return t.length===n.length&&t.every((e,r)=>e.path===n[r].path)}let Fb=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>new Bb,providedIn:"root"})}return t})();class Bb{parse(n){const e=new Wae(n);return new _d(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${Vb(n.root,!0)}`,r=function Vae(t){const n=Object.entries(t).map(([e,r])=>Array.isArray(r)?r.map(i=>`${jE(e)}=${jE(i)}`).join("&"):`${jE(e)}=${jE(r)}`).filter(e=>e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${r}${"string"==typeof n.fragment?`#${function Fae(t){return encodeURI(t)}(n.fragment)}`:""}`}}const Lae=new Bb;function UE(t){return t.segments.map(n=>H4(n)).join("/")}function Vb(t,n){if(!t.hasChildren())return UE(t);if(n){const e=t.children[Pn]?Vb(t.children[Pn],!1):"",r=[];return Object.entries(t.children).forEach(([i,o])=>{i!==Pn&&r.push(`${i}:${Vb(o,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function Oae(t,n){let e=[];return Object.entries(t.children).forEach(([r,i])=>{r===Pn&&(e=e.concat(n(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==Pn&&(e=e.concat(n(i,r)))}),e}(t,(r,i)=>i===Pn?[Vb(t.children[Pn],!1)]:[`${i}:${Vb(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Pn]?`${UE(t)}/${e[0]}`:`${UE(t)}/(${e.join("//")})`}}function U4(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function jE(t){return U4(t).replace(/%3B/gi,";")}function fA(t){return U4(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function HE(t){return decodeURIComponent(t)}function j4(t){return HE(t.replace(/\+/g,"%20"))}function H4(t){return`${fA(t.path)}${function Bae(t){return Object.entries(t).map(([n,e])=>`;${fA(n)}=${fA(e)}`).join("")}(t.parameters)}`}const zae=/^[^\/()?;#]+/;function pA(t){const n=t.match(zae);return n?n[0]:""}const Uae=/^[^\/()?;=#]+/,Hae=/^[^=?&#]+/,qae=/^[^&#]+/;class Wae{url;remaining;constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yr([],{}):new Yr([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[Pn]=new Yr(n,e)),r}parseSegment(){const n=pA(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ue(4009,!1);return this.capture(n),new Lb(HE(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=function jae(t){const n=t.match(Uae);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const i=pA(this.remaining);i&&(r=i,this.capture(r))}n[HE(e)]=HE(r)}parseQueryParam(n){const e=function $ae(t){const n=t.match(Hae);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const a=function Gae(t){const n=t.match(qae);return n?n[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const i=j4(e),o=j4(r);if(n.hasOwnProperty(i)){let a=n[i];Array.isArray(a)||(a=[a],n[i]=a),a.push(o)}else n[i]=o}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=pA(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new ue(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):n&&(o=Pn);const a=this.parseChildren();e[o??Pn]=1===Object.keys(a).length&&a[Pn]?a[Pn]:new Yr([],a),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ue(4011,!1)}}function $4(t){return t.segments.length>0?new Yr([],{[Pn]:t}):t}function q4(t){const n={};for(const[r,i]of Object.entries(t.children)){const o=q4(i);if(r===Pn&&0===o.segments.length&&o.hasChildren())for(const[a,c]of Object.entries(o.children))n[a]=c;else(o.segments.length>0||o.hasChildren())&&(n[r]=o)}return function Kae(t){if(1===t.numberOfChildren&&t.children[Pn]){const n=t.children[Pn];return new Yr(t.segments.concat(n.segments),n.children)}return t}(new Yr(t.segments,n))}function Zm(t){return t instanceof _d}function G4(t){let n;const i=$4(function e(o){const a={};for(const f of o.children){const _=e(f);a[f.outlet]=_}const c=new Yr(o.url,a);return o===t&&(n=c),c}(t.root));return n??i}function W4(t,n,e,r,i){let o=t;for(;o.parent;)o=o.parent;if(0===n.length)return mA(o,o,o,e,r,i);const a=function Yae(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Y4(!0,0,t);let n=0,e=!1;const r=t.reduce((i,o,a)=>{if("object"==typeof o&&null!=o){if(o.outlets){const c={};return Object.entries(o.outlets).forEach(([f,_])=>{c[f]="string"==typeof _?_.split("/"):_}),[...i,{outlets:c}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===a?(o.split("/").forEach((c,f)=>{0==f&&"."===c||(0==f&&""===c?e=!0:".."===c?n++:""!=c&&i.push(c))}),i):[...i,o]},[]);return new Y4(e,n,r)}(n);if(a.toRoot())return mA(o,o,new Yr([],{}),e,r,i);const c=function Xae(t,n,e){if(t.isAbsolute)return new qE(n,!0,0);if(!e)return new qE(n,!1,NaN);if(null===e.parent)return new qE(e,!0,0);const r=$E(t.commands[0])?0:1;return function Qae(t,n,e){let r=t,i=n,o=e;for(;o>i;){if(o-=i,r=r.parent,!r)throw new ue(4005,!1);i=r.segments.length}return new qE(r,!1,i-o)}(e,e.segments.length-1+r,t.numberOfDoubleDots)}(a,o,t),f=c.processChildren?Ub(c.segmentGroup,c.index,a.commands):X4(c.segmentGroup,c.index,a.commands);return mA(o,c.segmentGroup,f,e,r,i)}function $E(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function zb(t){return"object"==typeof t&&null!=t&&t.outlets}function K4(t,n,e){t||="\u0275";const r=new _d;return r.queryParams={[t]:n},e.parse(e.serialize(r)).queryParams[t]}function mA(t,n,e,r,i,o){const a={};for(const[_,x]of Object.entries(r??{}))a[_]=Array.isArray(x)?x.map(D=>K4(_,D,o)):K4(_,x,o);let c;c=t===n?e:Z4(t,n,e);const f=$4(q4(c));return new _d(f,a,i)}function Z4(t,n,e){const r={};return Object.entries(t.children).forEach(([i,o])=>{r[i]=o===n?e:Z4(o,n,e)}),new Yr(t.segments,r)}class Y4{isAbsolute;numberOfDoubleDots;commands;constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&$E(r[0]))throw new ue(4003,!1);const i=r.find(zb);if(i&&i!==function kae(t){return t.length>0?t[t.length-1]:null}(r))throw new ue(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class qE{segmentGroup;processChildren;index;constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}}function X4(t,n,e){if(t??=new Yr([],{}),0===t.segments.length&&t.hasChildren())return Ub(t,n,e);const r=function ele(t,n,e){let r=0,i=n;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=e.length)return o;const a=t.segments[i],c=e[r];if(zb(c))break;const f=`${c}`,_=r<e.length-1?e[r+1]:null;if(i>0&&void 0===f)break;if(f&&_&&"object"==typeof _&&void 0===_.outlets){if(!J4(f,_,a))return o;r+=2}else{if(!J4(f,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,n,e),i=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const o=new Yr(t.segments.slice(0,r.pathIndex),{});return o.children[Pn]=new Yr(t.segments.slice(r.pathIndex),t.children),Ub(o,0,i)}return r.match&&0===i.length?new Yr(t.segments,{}):r.match&&!t.hasChildren()?gA(t,n,e):r.match?Ub(t,0,i):gA(t,n,e)}function Ub(t,n,e){if(0===e.length)return new Yr(t.segments,{});{const r=function Jae(t){return zb(t[0])?t[0].outlets:{[Pn]:t}}(e),i={};if(Object.keys(r).some(o=>o!==Pn)&&t.children[Pn]&&1===t.numberOfChildren&&0===t.children[Pn].segments.length){const o=Ub(t.children[Pn],n,e);return new Yr(t.segments,o.children)}return Object.entries(r).forEach(([o,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(i[o]=X4(t.children[o],n,a))}),Object.entries(t.children).forEach(([o,a])=>{void 0===r[o]&&(i[o]=a)}),new Yr(t.segments,i)}}function gA(t,n,e){const r=t.segments.slice(0,n);let i=0;for(;i<e.length;){const o=e[i];if(zb(o)){const f=tle(o.outlets);return new Yr(r,f)}if(0===i&&$E(e[0])){r.push(new Lb(t.segments[n].path,Q4(e[0]))),i++;continue}const a=zb(o)?o.outlets[Pn]:`${o}`,c=i<e.length-1?e[i+1]:null;a&&c&&$E(c)?(r.push(new Lb(a,Q4(c))),i+=2):(r.push(new Lb(a,{})),i++)}return new Yr(r,{})}function tle(t){const n={};return Object.entries(t).forEach(([e,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(n[e]=gA(new Yr([],{}),0,r))}),n}function Q4(t){const n={};return Object.entries(t).forEach(([e,r])=>n[e]=`${r}`),n}function J4(t,n,e){return t==e.path&&gd(n,e.parameters)}const jb="imperative";var lr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(lr||{});class yd{id;url;constructor(n,e){this.id=n,this.url=e}}class GE extends yd{type=lr.NavigationStart;navigationTrigger;restoredState;constructor(n,e,r="imperative",i=null){super(n,e),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Oh extends yd{urlAfterRedirects;type=lr.NavigationEnd;constructor(n,e,r){super(n,e),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var rl=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t[t.Aborted=4]="Aborted",t}(rl||{}),WE=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(WE||{});class hp extends yd{reason;code;type=lr.NavigationCancel;constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ly extends yd{reason;code;type=lr.NavigationSkipped;constructor(n,e,r,i){super(n,e),this.reason=r,this.code=i}}class _A extends yd{error;target;type=lr.NavigationError;constructor(n,e,r,i){super(n,e),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ej extends yd{urlAfterRedirects;state;type=lr.RoutesRecognized;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rle extends yd{urlAfterRedirects;state;type=lr.GuardsCheckStart;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ile extends yd{urlAfterRedirects;state;shouldActivate;type=lr.GuardsCheckEnd;constructor(n,e,r,i,o){super(n,e),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ole extends yd{urlAfterRedirects;state;type=lr.ResolveStart;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sle extends yd{urlAfterRedirects;state;type=lr.ResolveEnd;constructor(n,e,r,i){super(n,e),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ale{route;type=lr.RouteConfigLoadStart;constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class lle{route;type=lr.RouteConfigLoadEnd;constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class cle{snapshot;type=lr.ChildActivationStart;constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ule{snapshot;type=lr.ChildActivationEnd;constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dle{snapshot;type=lr.ActivationStart;constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hle{snapshot;type=lr.ActivationEnd;constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tj{routerEvent;position;anchor;scrollBehavior;type=lr.Scroll;constructor(n,e,r,i){this.routerEvent=n,this.position=e,this.anchor=r,this.scrollBehavior=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class yA{}class KE{url;navigationBehaviorOptions;constructor(n,e){this.url=n,this.navigationBehaviorOptions=e}}class ple{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(n){this.rootInjector=n,this.children=new Hb(this.rootInjector)}}let Hb=(()=>{class t{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,r){const i=this.getOrCreateContext(e);i.outlet=r,this.contexts.set(e,i)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new ple(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(r){return new(r||t)(Dt(Hr))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class nj{_root;constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=vA(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){const e=vA(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=bA(n,this._root);return e.length<2?[]:e[e.length-2].children.map(i=>i.value).filter(i=>i!==n)}pathFromRoot(n){return bA(n,this._root).map(e=>e.value)}}function vA(t,n){if(t===n.value)return n;for(const e of n.children){const r=vA(t,e);if(r)return r}return null}function bA(t,n){if(t===n.value)return[n];for(const e of n.children){const r=bA(t,e);if(r.length)return r.unshift(n),r}return[]}class fu{value;children;constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function cy(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class rj extends nj{snapshot;constructor(n,e){super(n),this.snapshot=e,wA(this,n)}toString(){return this.snapshot.toString()}}function ij(t,n){const e=function mle(t,n){const a=new YE([],{},{},"",{},Pn,t,null,{},n);return new oj("",new fu(a,[]))}(t,n),r=new se([new Lb("",{})]),i=new se({}),o=new se({}),a=new se({}),c=new se(""),f=new Ym(r,i,a,c,o,Pn,t,e.root);return f.snapshot=e.root,new rj(new fu(f,[]),e)}class Ym{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(n,e,r,i,o,a,c,f){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=a,this.component=c,this._futureSnapshot=f,this.title=this.dataSubject?.pipe(hr(_=>_[Ob]))??Rn(void 0),this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(hr(n=>ay(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(hr(n=>ay(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZE(t,n,e="emptyOnly"){let r;const{routeConfig:i}=t;return r=null===n||"always"!==e&&""!==i?.path&&(n.component||n.routeConfig?.loadComponent)?{params:{...t.params},data:{...t.data},resolve:{...t.data,...t._resolvedData??{}}}:{params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.data,...i?.data,...t._resolvedData}},i&&aj(i)&&(r.resolve[Ob]=i.title),r}class YE{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[Ob]}constructor(n,e,r,i,o,a,c,f,_,x){this.url=n,this.params=e,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=c,this.routeConfig=f,this._resolve=_,this._environmentInjector=x}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ay(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ay(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class oj extends nj{url;constructor(n,e){super(e),this.url=n,wA(this,e)}toString(){return sj(this._root)}}function wA(t,n){n.value._routerState=t,n.children.forEach(e=>wA(t,e))}function sj(t){const n=t.children.length>0?` { ${t.children.map(sj).join(", ")} } `:"";return`${t.value}${n}`}function xA(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,gd(n.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),gd(n.params,e.params)||t.paramsSubject.next(e.params),function Iae(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!gd(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.urlSubject.next(e.url),gd(n.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function EA(t,n){const e=gd(t.params,n.params)&&function Nae(t,n){return Km(t,n)&&t.every((e,r)=>gd(e.parameters,n[r].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||EA(t.parent,n.parent))}function aj(t){return"string"==typeof t.title||null===t.title}const gle=new Fe("");let CA=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Pn;activateEvents=new Hn;deactivateEvents=new Hn;attachEvents=new Hn;detachEvents=new Hn;routerOutletData=pte();parentContexts=X(Hb);location=X(Ml);changeDetector=X(Sh);inputBinder=X(XE,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){const{firstChange:r,previousValue:i}=e.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ue(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ue(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ue(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new ue(4013,!1);this._activatedRoute=e;const i=this.location,a=e.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,f=new _le(e,c,i.injector,this.routerOutletData);this.activated=i.createComponent(a,{index:i.length,injector:f,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[zo]})}return t})();class _le{route;childContexts;parent;outletData;constructor(n,e,r,i){this.route=n,this.childContexts=e,this.parent=r,this.outletData=i}get(n,e){return n===Ym?this.route:n===Hb?this.childContexts:n===gle?this.outletData:this.parent.get(n,e)}}const XE=new Fe("");let lj=(()=>{class t{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:r}=e,i=aA([r.queryParams,r.params,r.data]).pipe(nl(([o,a,c],f)=>(c={...o,...a,...c},0===f?Rn(c):Promise.resolve(c)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(e);const a=function mne(t){const n=ln(t);if(!n)return null;const e=new Jv(n);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(r.component);if(a)for(const{templateName:c}of a.inputs)e.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,i)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})(),cj=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){1&r&&wt(0,"router-outlet")},dependencies:[CA],encapsulation:2})}return t})();function DA(t){const n=t.children&&t.children.map(DA),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Pn&&(e.component=cj),e}function $b(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=n.value;const i=function vle(t,n,e){return n.children.map(r=>{for(const i of e.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return $b(t,r,i);return $b(t,r)})}(t,n,e);return new fu(r,i)}{if(t.shouldAttach(n.value)){const o=t.retrieve(n.value);if(null!==o){const a=o.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(c=>$b(t,c)),a}}const r=function ble(t){return new Ym(new se(t.url),new se(t.params),new se(t.queryParams),new se(t.fragment),new se(t.data),t.outlet,t.component,t)}(n.value),i=n.children.map(o=>$b(t,o));return new fu(r,i)}}class TA{redirectTo;navigationBehaviorOptions;constructor(n,e){this.redirectTo=n,this.navigationBehaviorOptions=e}}const uj="ngNavigationCancelingError";function QE(t,n){const{redirectTo:e,navigationBehaviorOptions:r}=Zm(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,i=dj(!1,rl.Redirect);return i.url=e,i.navigationBehaviorOptions=r,i}function dj(t,n){const e=new Error(`NavigationCancelingError: ${t||""}`);return e[uj]=!0,e.cancellationCode=n,e}function hj(t){return!!t&&t[uj]}class xle{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(n,e,r,i,o){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(n){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),xA(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){const i=cy(e);n.children.forEach(o=>{const a=o.value.outlet;this.deactivateRoutes(o,i[a],r),delete i[a]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(i===o)if(i.component){const a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(n,e,a.children)}else this.deactivateChildRoutes(n,e,r);else o&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=cy(n);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){const a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:c})}}deactivateRouteAndOutlet(n,e){const r=e.getContext(n.value.outlet),i=r&&n.value.component?r.children:e,o=cy(n);for(const a of Object.values(o))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,e,r){const i=cy(e);n.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new hle(o.value.snapshot))}),n.children.length&&this.forwardEvent(new ule(n.value.snapshot))}activateRoutes(n,e,r){const i=n.value,o=e?e.value:null;if(xA(i),i===o)if(i.component){const a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(n,e,a.children)}else this.activateChildRoutes(n,e,r);else if(i.component){const a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),xA(c.route.value),this.activateChildRoutes(n,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(n,null,a.children)}else this.activateChildRoutes(n,null,r)}}class fj{path;route;constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class JE{component;route;constructor(n,e){this.component=n,this.route=e}}function Ele(t,n,e){const r=t._root;return qb(r,n?n._root:null,e,[r.value])}function uy(t,n){const e=Symbol(),r=n.get(t,e);return r===e?"function"!=typeof t||function Ng(t){return null!==rf(t)}(t)?n.get(t):t:r}function qb(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=cy(n);return t.children.forEach(a=>{(function Dle(t,n,e,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,a=n?n.value:null,c=e?e.getContext(t.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){const f=function Tle(t,n,e){if("function"==typeof e)return ji(n._environmentInjector,()=>e(t,n));switch(e){case"pathParamsChange":return!Km(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Km(t.url,n.url)||!gd(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!EA(t,n)||!gd(t.queryParams,n.queryParams);default:return!EA(t,n)}}(a,o,o.routeConfig.runGuardsAndResolvers);f?i.canActivateChecks.push(new fj(r)):(o.data=a.data,o._resolvedData=a._resolvedData),qb(t,n,o.component?c?c.children:null:e,r,i),f&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new JE(c.outlet.component,a))}else a&&Gb(n,c,i),i.canActivateChecks.push(new fj(r)),qb(t,null,o.component?c?c.children:null:e,r,i)})(a,o[a.value.outlet],e,r.concat([a.value]),i),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,c])=>Gb(c,e.getContext(a),i)),i}function Gb(t,n,e){const r=cy(t),i=t.value;Object.entries(r).forEach(([o,a])=>{Gb(a,i.component?n?n.children.getContext(o):null:n,e)}),e.canDeactivateChecks.push(new JE(i.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,i))}function Wb(t){return"function"==typeof t}function pj(t){return t instanceof lA||"EmptyError"===t?.name}const eC=Symbol("INITIAL_VALUE");function dy(){return nl(t=>aA(t.map(n=>n.pipe(Fs(1),sy(eC)))).pipe(hr(n=>{for(const e of n)if(!0!==e){if(e===eC)return eC;if(!1===e||Ple(e))return e}return!0}),_s(n=>n!==eC),Fs(1)))}function Ple(t){return Zm(t)||t instanceof TA}function mj(t){return t.aborted?Rn(void 0).pipe(Fs(1)):new U(n=>{const e=()=>{n.next(),n.complete()};return t.addEventListener("abort",e),()=>t.removeEventListener("abort",e)})}function gj(t){return md(mj(t))}function _j(t){return function F(...t){return z(t)}(Nh(n=>{if("boolean"!=typeof n)throw QE(0,n)}),hr(n=>!0===n))}class Lh extends Error{segmentGroup;constructor(n){super(),this.segmentGroup=n||null,Object.setPrototypeOf(this,Lh.prototype)}}class Kb extends Error{urlTree;constructor(n){super(),this.urlTree=n,Object.setPrototypeOf(this,Kb.prototype)}}function $le(t){throw new ue(4e3,!1)}class Gle{urlSerializer;urlTree;constructor(n,e){this.urlSerializer=n,this.urlTree=e}lineralizeSegments(n,e){return fe(function*(){let r=[],i=e.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return r;if(i.numberOfChildren>1||!i.children[Pn])throw $le();i=i.children[Pn]}})()}applyRedirectCommands(n,e,r,i,o){var a=this;return fe(function*(){const c=yield function Wle(t,n,e){if("string"==typeof t)return Promise.resolve(t);const r=t,{queryParams:i,fragment:o,routeConfig:a,url:c,outlet:f,params:_,data:x,title:D,paramMap:A,queryParamMap:N}=n;return VE(Wm(ji(e,()=>r({params:_,data:x,queryParams:i,fragment:o,routeConfig:a,url:c,outlet:f,title:D,paramMap:A,queryParamMap:N}))))}(e,i,o);if(c instanceof _d)throw new Kb(c);const f=a.applyRedirectCreateUrlTree(c,a.urlSerializer.parse(c),n,r);if("/"===c[0])throw new Kb(f);return f})()}applyRedirectCreateUrlTree(n,e,r,i){const o=this.createSegmentGroup(n,e.root,r,i);return new _d(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const r={};return Object.entries(n).forEach(([i,o])=>{if("string"==typeof o&&":"===o[0]){const c=o.substring(1);r[i]=e[c]}else r[i]=o}),r}createSegmentGroup(n,e,r,i){const o=this.createSegments(n,e.segments,r,i);let a={};return Object.entries(e.children).forEach(([c,f])=>{a[c]=this.createSegmentGroup(n,f,r,i)}),new Yr(o,a)}createSegments(n,e,r,i){return e.map(o=>":"===o.path[0]?this.findPosParam(n,o,i):this.findOrReturn(o,r))}findPosParam(n,e,r){const i=r[e.path.substring(1)];if(!i)throw new ue(4001,!1);return i}findOrReturn(n,e){let r=0;for(const i of e){if(i.path===n.path)return e.splice(r),i;r++}return n}}function pu(t){return t.outlet||Pn}function Qle(t,n){const e=t.filter(r=>pu(r)===n);return e.push(...t.filter(r=>pu(r)!==n)),e}const SA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Jle(t,n,e,r,i,o){const a=yj(t,n,e);return a.matched?(r=function Kle(t,n){return t.providers&&!t._injector&&(t._injector=x1(t.providers,n,`Route: ${t.path}`)),t._injector??n}(n,r),function Hle(t,n,e,r,i){const o=n.canMatch;return o&&0!==o.length?Rn(o.map(c=>{const f=uy(c,t);return Wm(function Rle(t){return t&&Wb(t.canMatch)}(f)?f.canMatch(n,e):ji(t,()=>f(n,e))).pipe(gj(i))})).pipe(dy(),_j()):Rn(!0)}(r,n,e,0,o).pipe(hr(c=>!0===c?a:{...SA}))):Rn(a)}function yj(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...SA}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const i=(n.matcher||Sae)(e,t,n);if(!i)return{...SA};const o={};Object.entries(i.posParams??{}).forEach(([c,f])=>{o[c]=f.path});const a=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:e.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function vj(t,n,e,r){return e.length>0&&function nce(t,n,e){return e.some(r=>tC(t,n,r)&&pu(r)!==Pn)}(t,e,r)?{segmentGroup:new Yr(n,tce(r,new Yr(e,t.children))),slicedSegments:[]}:0===e.length&&function rce(t,n,e){return e.some(r=>tC(t,n,r))}(t,e,r)?{segmentGroup:new Yr(t.segments,ece(t,e,r,t.children)),slicedSegments:e}:{segmentGroup:new Yr(t.segments,t.children),slicedSegments:e}}function ece(t,n,e,r){const i={};for(const o of e)if(tC(t,n,o)&&!r[pu(o)]){const a=new Yr([],{});i[pu(o)]=a}return{...r,...i}}function tce(t,n){const e={};e[Pn]=n;for(const r of t)if(""===r.path&&pu(r)!==Pn){const i=new Yr([],{});e[pu(r)]=i}return e}function tC(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}class oce{}function IA(){return(IA=fe(function*(t,n,e,r,i,o,a="emptyOnly",c){return new lce(t,n,e,r,i,a,o,c).recognize()})).apply(this,arguments)}class lce{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(n,e,r,i,o,a,c,f){this.injector=n,this.configLoader=e,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.abortSignal=f,this.applyRedirects=new Gle(this.urlSerializer,this.urlTree)}noMatchError(n){return new ue(4002,`'${n.segmentGroup}'`)}recognize(){var n=this;return fe(function*(){const e=vj(n.urlTree.root,[],[],n.config).segmentGroup,{children:r,rootSnapshot:i}=yield n.match(e),o=new fu(i,r),a=new oj("",o),c=function Zae(t,n,e=null,r=null,i=new Bb){return W4(G4(t),n,e,r,i)}(i,[],n.urlTree.queryParams,n.urlTree.fragment);return c.queryParams=n.urlTree.queryParams,a.url=n.urlSerializer.serialize(c),{state:a,tree:c}})()}match(n){var e=this;return fe(function*(){const r=new YE([],Object.freeze({}),Object.freeze({...e.urlTree.queryParams}),e.urlTree.fragment,Object.freeze({}),Pn,e.rootComponentType,null,{},e.injector);try{return{children:yield e.processSegmentGroup(e.injector,e.config,n,Pn,r),rootSnapshot:r}}catch(i){if(i instanceof Kb)return e.urlTree=i.urlTree,e.match(i.urlTree.root);throw i instanceof Lh?e.noMatchError(i):i}})()}processSegmentGroup(n,e,r,i,o){var a=this;return fe(function*(){if(0===r.segments.length&&r.hasChildren())return a.processChildren(n,e,r,o);const c=yield a.processSegment(n,e,r,r.segments,i,!0,o);return c instanceof fu?[c]:[]})()}processChildren(n,e,r,i){var o=this;return fe(function*(){const a=[];for(const _ of Object.keys(r.children))"primary"===_?a.unshift(_):a.push(_);let c=[];for(const _ of a){const x=r.children[_],D=Qle(e,_),A=yield o.processSegmentGroup(n,D,x,_,i);c.push(...A)}const f=bj(c);return function cce(t){t.sort((n,e)=>n.value.outlet===Pn?-1:e.value.outlet===Pn?1:n.value.outlet.localeCompare(e.value.outlet))}(f),f})()}processSegment(n,e,r,i,o,a,c){var f=this;return fe(function*(){for(const _ of e)try{return yield f.processSegmentAgainstRoute(_._injector??n,e,_,r,i,o,a,c)}catch(x){if(x instanceof Lh||pj(x))continue;throw x}if(function ice(t,n,e){return 0===n.length&&!t.children[e]}(r,i,o))return new oce;throw new Lh(r)})()}processSegmentAgainstRoute(n,e,r,i,o,a,c,f){var _=this;return fe(function*(){if(pu(r)!==a&&(a===Pn||!tC(i,o,r)))throw new Lh(i);if(void 0===r.redirectTo)return _.matchSegmentAgainstRoute(n,i,r,o,a,f);if(_.allowRedirects&&c)return _.expandSegmentAgainstRouteUsingRedirect(n,i,e,r,o,a,f);throw new Lh(i)})()}expandSegmentAgainstRouteUsingRedirect(n,e,r,i,o,a,c){var f=this;return fe(function*(){const{matched:_,parameters:x,consumedSegments:D,positionalParamSegments:A,remainingSegments:N}=yj(e,i,o);if(!_)throw new Lh(e);"string"==typeof i.redirectTo&&"/"===i.redirectTo[0]&&(f.absoluteRedirectCount++,f.absoluteRedirectCount>31&&(f.allowRedirects=!1));const B=new YE(o,x,Object.freeze({...f.urlTree.queryParams}),f.urlTree.fragment,wj(i),pu(i),i.component??i._loadedComponent??null,i,xj(i),n),te=ZE(B,c,f.paramsInheritanceStrategy);if(B.params=Object.freeze(te.params),B.data=Object.freeze(te.data),f.abortSignal.aborted)throw new Error(f.abortSignal.reason);const ce=yield f.applyRedirects.applyRedirectCommands(D,i.redirectTo,A,B,n),we=yield f.applyRedirects.lineralizeSegments(i,ce);return f.processSegment(n,r,e,we.concat(N),a,!1,c)})()}matchSegmentAgainstRoute(n,e,r,i,o,a){var c=this;return fe(function*(){if(c.abortSignal.aborted)throw new Error(c.abortSignal.reason);const f=yield VE(Jle(e,r,i,n,0,c.abortSignal));if("**"===r.path&&(e.children={}),!f?.matched)throw new Lh(e);n=r._injector??n;const{routes:_}=yield c.getChildConfig(n,r,i),x=r._loadedInjector??n,{parameters:D,consumedSegments:A,remainingSegments:N}=f,B=new YE(A,D,Object.freeze({...c.urlTree.queryParams}),c.urlTree.fragment,wj(r),pu(r),r.component??r._loadedComponent??null,r,xj(r),n),te=ZE(B,a,c.paramsInheritanceStrategy);B.params=Object.freeze(te.params),B.data=Object.freeze(te.data);const{segmentGroup:ce,slicedSegments:we}=vj(e,A,N,_);if(0===we.length&&ce.hasChildren()){const Se=yield c.processChildren(x,_,ce,B);return new fu(B,Se)}if(0===_.length&&0===we.length)return new fu(B,[]);const Ce=pu(r)===o,We=yield c.processSegment(x,_,ce,we,Ce?Pn:o,!0,B);return new fu(B,We instanceof fu?[We]:[])})()}getChildConfig(n,e,r){var i=this;return fe(function*(){if(e.children)return{routes:e.children,injector:n};if(e.loadChildren){if(void 0!==e._loadedRoutes){const a=e._loadedNgModuleFactory;return a&&!e._loadedInjector&&(e._loadedInjector=a.create(n).injector),{routes:e._loadedRoutes,injector:e._loadedInjector}}if(i.abortSignal.aborted)throw new Error(i.abortSignal.reason);if(yield VE(function jle(t,n,e,r,i){const o=n.canLoad;return void 0===o||0===o.length?Rn(!0):Rn(o.map(c=>{const f=uy(c,t),x=Wm(function Ile(t){return t&&Wb(t.canLoad)}(f)?f.canLoad(n,e):ji(t,()=>f(n,e)));return i?x.pipe(gj(i)):x})).pipe(dy(),_j())}(n,e,r,0,i.abortSignal))){const a=yield i.configLoader.loadChildren(n,e);return e._loadedRoutes=a.routes,e._loadedInjector=a.injector,e._loadedNgModuleFactory=a.factory,a}throw function qle(){throw dj(!1,rl.GuardRejected)}()}return{routes:[],injector:n}})()}}function uce(t){const n=t.value.routeConfig;return n&&""===n.path}function bj(t){const n=[],e=new Set;for(const r of t){if(!uce(r)){n.push(r);continue}const i=n.find(o=>r.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...r.children),e.add(i)):n.push(r)}for(const r of e){const i=bj(r.children);n.push(new fu(r.value,i))}return n.filter(r=>!e.has(r))}function wj(t){return t.data||{}}function xj(t){return t.resolve||{}}function Ej(t){const n=t.children.map(e=>Ej(e)).flat();return[t,...n]}function Cj(t){return nl(n=>{const e=t(n);return e?gs(e).pipe(hr(()=>n)):Rn(n)})}let Dj=(()=>{class t{buildTitle(e){let r,i=e.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Pn);return r}getResolvedTitleForRoute(e){return e.data[Ob]}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(gce),providedIn:"root"})}return t})(),gce=(()=>{class t extends Dj{title;constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||t)(Dt(wae))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const hy=new Fe("",{factory:()=>({})}),Zb=new Fe("");let kA=(()=>{class t{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=X(ete);loadComponent(e,r){var i=this;return fe(function*(){if(i.componentLoaders.get(r))return i.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);i.onLoadStartListener&&i.onLoadStartListener(r);const o=fe(function*(){try{const a=yield L4(ji(e,()=>r.loadComponent())),c=yield Sj(Tj(a));return i.onLoadEndListener&&i.onLoadEndListener(r),r._loadedComponent=c,c}finally{i.componentLoaders.delete(r)}})();return i.componentLoaders.set(r,o),o})()}loadChildren(e,r){var i=this;if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=fe(function*(){try{const a=yield function _ce(t,n,e,r){return AA.apply(this,arguments)}(r,i.compiler,e,i.onLoadEndListener);return r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,a}finally{i.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function AA(){return(AA=fe(function*(t,n,e,r){const i=yield L4(ji(e,()=>t.loadChildren())),o=yield Sj(Tj(i));let a;a=o instanceof zF||Array.isArray(o)?o:yield n.compileModuleAsync(o),r&&r(t);let c,f,x;return Array.isArray(a)?f=a:(c=a.create(e).injector,x=a,f=c.get(Zb,[],{optional:!0,self:!0}).flat()),{routes:f.map(DA),injector:c,factory:x}})).apply(this,arguments)}function Tj(t){return function yce(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}function Sj(t){return MA.apply(this,arguments)}function MA(){return(MA=fe(function*(t){return t})).apply(this,arguments)}let RA=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(vce),providedIn:"root"})}return t})(),vce=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ij=new Fe(""),kj=new Fe("");function bce(t,n,e){const r=t.get(kj),i=t.get(jn);if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(_=>setTimeout(_));let o;const a=new Promise(_=>{o=_}),c=i.startViewTransition(()=>(o(),function wce(t){return new Promise(n=>{cu({read:()=>setTimeout(n)},{injector:t})})}(t)));c.updateCallbackDone.catch(_=>{}),c.ready.catch(_=>{}),c.finished.catch(_=>{});const{onViewTransitionCreated:f}=r;return f&&ji(t,()=>f({transition:c,from:n,to:e})),a}const xce=()=>{},Aj=new Fe("");let PA=(()=>{class t{currentNavigation=wo(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=wo(null);events=new J;transitionAbortWithErrorSubject=new J;configLoader=X(kA);environmentInjector=X(Hr);destroyRef=X(ir);urlSerializer=X(Fb);rootContexts=X(Hb);location=X(ry);inputBindingEnabled=null!==X(XE,{optional:!0});titleStrategy=X(Dj);options=X(hy,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=X(RA);createViewTransition=X(Ij,{optional:!0});navigationErrorHandler=X(Aj,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>Rn(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=i=>this.events.next(new lle(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new ale(i)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){const r=++this.navigationId;vr(()=>{this.transitions?.next({...e,extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r})})}setupNavigations(e){return this.transitions=new se(null),this.transitions.pipe(_s(r=>null!==r),nl(r=>{let i=!1;const o=new AbortController,a=()=>!i&&this.currentTransition?.id===r.id;return Rn(r).pipe(nl(c=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",rl.SupersededByNewNavigation),va;this.currentTransition=r;const f=this.lastSuccessfulNavigation();this.currentNavigation.set({id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:"string"==typeof c.extras.browserUrl?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:f?{...f,previousNavigation:null}:null,abort:()=>o.abort()});const _=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!_&&"reload"!==(c.extras.onSameUrlNavigation??e.onSameUrlNavigation))return this.events.next(new ly(c.id,this.urlSerializer.serialize(c.rawUrl),"",WE.IgnoredSameUrlNavigation)),c.resolve(!1),va;if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Rn(c).pipe(nl(D=>(this.events.next(new GE(D.id,this.urlSerializer.serialize(D.extractedUrl),D.source,D.restoredState)),D.id!==this.navigationId?va:Promise.resolve(D))),function dce(t,n,e,r,i,o,a){return Tc(function(){var c=fe(function*(f){const{state:_,tree:x}=yield function sce(t,n,e,r,i,o){return IA.apply(this,arguments)}(t,n,e,r,f.extractedUrl,i,o,a);return{...f,targetSnapshot:_,urlAfterRedirects:x}});return function(f){return c.apply(this,arguments)}}())}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy,o.signal),Nh(D=>{r.targetSnapshot=D.targetSnapshot,r.urlAfterRedirects=D.urlAfterRedirects,this.currentNavigation.update(N=>(N.finalUrl=D.urlAfterRedirects,N));const A=new ej(D.id,this.urlSerializer.serialize(D.extractedUrl),this.urlSerializer.serialize(D.urlAfterRedirects),D.targetSnapshot);this.events.next(A)}));if(_&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){const{id:D,extractedUrl:A,source:N,restoredState:B,extras:te}=c,ce=new GE(D,this.urlSerializer.serialize(A),N,B);this.events.next(ce);const we=ij(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=r={...c,targetSnapshot:we,urlAfterRedirects:A,extras:{...te,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.update(Ce=>(Ce.finalUrl=A,Ce)),Rn(r)}return this.events.next(new ly(c.id,this.urlSerializer.serialize(c.extractedUrl),"",WE.IgnoredByUrlHandlingStrategy)),c.resolve(!1),va}),hr(c=>{const f=new rle(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);return this.events.next(f),this.currentTransition=r={...c,guards:Ele(c.targetSnapshot,c.currentSnapshot,this.rootContexts)},r}),function Nle(t){return Tc(n=>{const{targetSnapshot:e,currentSnapshot:r,guards:{canActivateChecks:i,canDeactivateChecks:o}}=n;return 0===o.length&&0===i.length?Rn({...n,guardsResult:!0}):function Ole(t,n,e){return gs(t).pipe(Tc(r=>function Ule(t,n,e,r){const i=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return i&&0!==i.length?Rn(i.map(a=>{const c=n._environmentInjector,f=uy(a,c);return Wm(function Mle(t){return t&&Wb(t.canDeactivate)}(f)?f.canDeactivate(t,n,e,r):ji(c,()=>f(t,n,e,r))).pipe(up())})).pipe(dy()):Rn(!0)}(r.component,r.route,e,n)),up(r=>!0!==r,!0))}(o,e,r).pipe(Tc(a=>a&&function Sle(t){return"boolean"==typeof t}(a)?function Lle(t,n,e){return gs(n).pipe(BE(r=>Rb(function Ble(t,n){return null!==t&&n&&n(new cle(t)),Rn(!0)}(r.route.parent,e),function Fle(t,n){return null!==t&&n&&n(new dle(t)),Rn(!0)}(r.route,e),function zle(t,n){const e=n[n.length-1],i=n.slice(0,n.length-1).reverse().map(o=>function Cle(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(o)).filter(o=>null!==o).map(o=>Pb(()=>Rn(o.guards.map(c=>{const f=o.node._environmentInjector,_=uy(c,f);return Wm(function Ale(t){return t&&Wb(t.canActivateChild)}(_)?_.canActivateChild(e,t):ji(f,()=>_(e,t))).pipe(up())})).pipe(dy())));return Rn(i).pipe(dy())}(t,r.path),function Vle(t,n){const e=n.routeConfig?n.routeConfig.canActivate:null;if(!e||0===e.length)return Rn(!0);const r=e.map(i=>Pb(()=>{const o=n._environmentInjector,a=uy(i,o);return Wm(function kle(t){return t&&Wb(t.canActivate)}(a)?a.canActivate(n,t):ji(o,()=>a(n,t))).pipe(up())}));return Rn(r).pipe(dy())}(t,r.route))),up(r=>!0!==r,!0))}(e,i,t):Rn(a)),hr(a=>({...n,guardsResult:a})))})}(c=>this.events.next(c)),nl(c=>{if(r.guardsResult=c.guardsResult,c.guardsResult&&"boolean"!=typeof c.guardsResult)throw QE(0,c.guardsResult);const f=new ile(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);if(this.events.next(f),!a())return va;if(!c.guardsResult)return this.cancelNavigationTransition(c,"",rl.GuardRejected),va;if(0===c.guards.canActivateChecks.length)return Rn(c);const _=new ole(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);if(this.events.next(_),!a())return va;let x=!1;return Rn(c).pipe(function hce(t){return Tc(n=>{const{targetSnapshot:e,guards:{canActivateChecks:r}}=n;if(!r.length)return Rn(n);const i=new Set(r.map(c=>c.route)),o=new Set;for(const c of i)if(!o.has(c))for(const f of Ej(c))o.add(f);let a=0;return gs(o).pipe(BE(c=>i.has(c)?function fce(t,n,e){const r=t.routeConfig,i=t._resolve;return void 0!==r?.title&&!aj(r)&&(i[Ob]=r.title),Pb(()=>(t.data=ZE(t,t.parent,e).resolve,function pce(t,n,e){const r=dA(t);if(0===r.length)return Rn({});const i={};return gs(r).pipe(Tc(o=>function mce(t,n,e){const r=n._environmentInjector,i=uy(t,r);return Wm(i.resolve?i.resolve(n,e):ji(r,()=>i(n,e)))}(t[o],n,e).pipe(up(),Nh(a=>{if(a instanceof TA)throw QE(new Bb,a);i[o]=a}))),A4(1),hr(()=>i),cA(o=>pj(o)?va:function _ae(t,n){const e=pr(t)?t:()=>t,r=i=>i.error(e());return new U(n?i=>n.schedule(r,0,i):r)}(o)))}(i,t,n).pipe(hr(o=>(t._resolvedData=o,t.data={...t.data,...o},null)))))}(c,e,t):(c.data=ZE(c,c.parent,t).resolve,Rn(void 0))),Nh(()=>a++),A4(1),Tc(c=>a===o.size?Rn(n):va))})}(this.paramsInheritanceStrategy),Nh({next:()=>{x=!0;const D=new sle(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(D)},complete:()=>{x||this.cancelNavigationTransition(c,"",rl.NoDataFromResolver)}}))}),Cj(c=>{const f=x=>{const D=[];x.routeConfig?._loadedComponent?x.component=x.routeConfig?._loadedComponent:x.routeConfig?.loadComponent&&D.push(this.configLoader.loadComponent(x._environmentInjector,x.routeConfig).then(N=>{x.component=N}));for(const A of x.children)D.push(...f(A));return D},_=f(c.targetSnapshot.root);return 0===_.length?Rn(c):gs(Promise.all(_).then(()=>c))}),Cj(()=>this.afterPreactivation()),nl(()=>{const{currentSnapshot:c,targetSnapshot:f}=r,_=this.createViewTransition?.(this.environmentInjector,c.root,f.root);return _?gs(_).pipe(hr(()=>r)):Rn(r)}),Fs(1),hr(c=>{const f=function yle(t,n,e){const r=$b(t,n._root,e?e._root:void 0);return new rj(r,n)}(e.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);this.currentTransition=r=c={...c,targetRouterState:f},this.currentNavigation.update(_=>(_.targetRouterState=f,_)),this.events.next(new yA),a()&&(new xle(e.routeReuseStrategy,r.targetRouterState,r.currentRouterState,_=>this.events.next(_),this.inputBindingEnabled).activate(this.rootContexts),a()&&(i=!0,this.currentNavigation.update(_=>(_.abort=xce,_)),this.lastSuccessfulNavigation.set(vr(this.currentNavigation)),this.events.next(new Oh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)))}),md(mj(o.signal).pipe(_s(()=>!i&&!r.targetRouterState),Nh(()=>{this.cancelNavigationTransition(r,o.signal.reason+"",rl.Aborted)}))),Nh({complete:()=>{i=!0}}),md(this.transitionAbortWithErrorSubject.pipe(Nh(c=>{throw c}))),M4(()=>{o.abort(),i||this.cancelNavigationTransition(r,"",rl.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),cA(c=>{if(i=!0,this.destroyed)return r.resolve(!1),va;if(hj(c))this.events.next(new hp(r.id,this.urlSerializer.serialize(r.extractedUrl),c.message,c.cancellationCode)),function wle(t){return hj(t)&&Zm(t.url)}(c)?this.events.next(new KE(c.url,c.navigationBehaviorOptions)):r.resolve(!1);else{const f=new _A(r.id,this.urlSerializer.serialize(r.extractedUrl),c,r.targetSnapshot??void 0);try{const _=ji(this.environmentInjector,()=>this.navigationErrorHandler?.(f));if(!(_ instanceof TA))throw this.events.next(f),c;{const{message:x,cancellationCode:D}=QE(0,_);this.events.next(new hp(r.id,this.urlSerializer.serialize(r.extractedUrl),x,D)),this.events.next(new KE(_.redirectTo,_.navigationBehaviorOptions))}}catch(_){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(_)}}return va}))}))}cancelNavigationTransition(e,r,i){const o=new hp(e.id,this.urlSerializer.serialize(e.extractedUrl),r,i);this.events.next(o),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=vr(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return e.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Ece(t){return t!==jb}const Cce=new Fe("");let Dce=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(Sce),providedIn:"root"})}return t})();class Tce{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}shouldDestroyInjector(n){return!0}}let Sce=(()=>{class t extends Tce{static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Rj=(()=>{class t{urlSerializer=X(Fb);options=X(hy,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=X(ry);urlHandlingStrategy=X(RA);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new _d;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:r,targetBrowserUrl:i}){const o=void 0!==e?this.urlHandlingStrategy.merge(e,r):r,a=i??o;return a instanceof _d?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:e,finalUrl:r,initialUrl:i}){r&&e?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=e):this.rawUrlTree=i}routerState=ij(null,X(Hr));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:()=>X(Ice),providedIn:"root"})}return t})(),Ice=(()=>{class t extends Rj{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{"popstate"===r.type&&setTimeout(()=>{e(r.url,r.state,"popstate")})})}handleRouterEvent(e,r){e instanceof GE?this.updateStateMemento():e instanceof ly?this.commitTransition(r):e instanceof ej?"eager"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof yA?(this.commitTransition(r),"deferred"===this.urlUpdateStrategy&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):e instanceof hp&&!function nle(t){return t instanceof hp&&(t.code===rl.Redirect||t.code===rl.SupersededByNewNavigation)}(e)?this.restoreHistory(r):e instanceof _A?this.restoreHistory(r,!0):e instanceof Oh&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:r,id:i}){const{replaceUrl:o,state:a}=r;if(this.location.isCurrentPathEqualTo(e)||o){const c=this.browserPageId,f={...a,...this.generateNgRouterState(i,c)};this.location.replaceState(e,"",f)}else{const c={...a,...this.generateNgRouterState(i,this.browserPageId+1)};this.location.go(e,"",c)}}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.getCurrentUrlTree()===e.finalUrl&&0===o&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Pj(t,n){t.events.pipe(_s(e=>e instanceof Oh||e instanceof hp||e instanceof _A||e instanceof ly),hr(e=>e instanceof Oh||e instanceof ly?0:e instanceof hp&&(e.code===rl.Redirect||e.code===rl.SupersededByNewNavigation)?2:1),_s(e=>2!==e),Fs(1)).subscribe(()=>{n()})}const Nj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Oj={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Bs=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=X(fB);stateManager=X(Rj);options=X(hy,{optional:!0})||{};pendingTasks=X(Ha);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=X(PA);urlSerializer=X(Fb);location=X(ry);urlHandlingStrategy=X(RA);injector=X(Hr);_events=new J;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=X(Dce);injectorCleanup=X(Cce,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=X(Zb,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!X(XE,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Wn;subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,o=vr(this.navigationTransitions.currentNavigation);if(null!==i&&null!==o)if(this.stateManager.handleRouterEvent(r,o),r instanceof hp&&r.code!==rl.Redirect&&r.code!==rl.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Oh)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(r instanceof KE){const a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),f={scroll:i.extras.scroll,browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||"eager"===this.urlUpdateStrategy||Ece(i.source),...a};this.scheduleNavigation(c,jb,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function fle(t){return!(t instanceof yA||t instanceof KE)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),jb,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r,i)=>{this.navigateToSyncWithBrowser(e,i,r)})}navigateToSyncWithBrowser(e,r,i){const o={replaceUrl:!0},a=i?.navigationId?i:null;if(i){const f={...i};delete f.navigationId,delete f.\u0275routerPageId,0!==Object.keys(f).length&&(o.state=f)}const c=this.parseUrl(e);this.scheduleNavigation(c,r,a,o).catch(f=>{this.disposed||this.injector.get(El)(f)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return vr(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(DA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){const{relativeTo:i,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:f}=r,_=f?this.currentUrlTree.fragment:a;let D,x=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":x={...this.currentUrlTree.queryParams,...o};break;case"preserve":x=this.currentUrlTree.queryParams;break;default:x=o||null}null!==x&&(x=this.removeEmptyProps(x));try{D=G4(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||"/"!==e[0][0])&&(e=[]),D=this.currentUrlTree.root}return W4(D,e,x,_??null,this.urlSerializer)}navigateByUrl(e,r={skipLocationChange:!1}){const i=Zm(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,jb,null,r)}navigate(e,r={skipLocationChange:!1}){return function kce(t){for(let n=0;n<t.length;n++)if(null==t[n])throw new ue(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.console.warn(jt(4018,!1)),this.urlSerializer.parse("/")}}isActive(e,r){let i;if(i=!0===r?{...Nj}:!1===r?{...Oj}:r,Zm(e))return hA(this.currentUrlTree,e,i);const o=this.parseUrl(e);return hA(this.currentUrlTree,o,i)}removeEmptyProps(e){return Object.entries(e).reduce((r,[i,o])=>(null!=o&&(r[i]=o),r),{})}scheduleNavigation(e,r,i,o,a){if(this.disposed)return Promise.resolve(!1);let c,f,_;a?(c=a.resolve,f=a.reject,_=a.promise):_=new Promise((D,A)=>{c=D,f=A});const x=this.pendingTasks.add();return Pj(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(x))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:c,reject:f,promise:_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_.catch(D=>Promise.reject(D))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),fp=(()=>{class t{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=wo(null);get href(){return vr(this.reactiveHref)}set href(e){this.reactiveHref.set(e)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new J;applicationErrorHandler=X(El);options=X(hy,{optional:!0});constructor(e,r,i,o,a,c){this.router=e,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=a,this.locationStrategy=c,this.reactiveHref.set(X(new hte("href"),{optional:!0}));const f=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===f||"area"===f||!("object"!=typeof customElements||!customElements.get(f)?.observedAttributes?.includes?.("href")),this.isAnchorElement&&(this.setTabIndexIfNotOnNativeEl("0"),this.subscribeToNavigationEventsIfNecessary())}subscribeToNavigationEventsIfNecessary(){void 0===this.subscription&&(this.subscription=this.router.events.subscribe(e=>{e instanceof Oh&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){null==e?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=Zm(e)||Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,r,i,o,a){const c=this.urlTree;if(null===c||this.isAnchorElement&&(0!==e||r||i||o||a||"string"==typeof this.target&&"_self"!=this.target))return!0;const f={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,f)?.catch(_=>{this.applicationErrorHandler(_)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const e=this.urlTree;this.reactiveHref.set(null!==e&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e))??"":null)}applyAttributeValue(e,r){const i=this.renderer,o=this.el.nativeElement;null!==r?i.setAttribute(o,e,r):i.removeAttribute(o,e)}get urlTree(){return null===this.routerLinkInput?null:Zm(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||t)(Re(Bs),Re(Ym),Vf("tabindex"),Re(Ka),Re(Vr),Re(qm))};static \u0275dir=Ft({type:t,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){1&r&&Ge("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&r&&Ys("href",i.reactiveHref(),$O)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ms],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ms],replaceUrl:[2,"replaceUrl","replaceUrl",ms],routerLink:"routerLink"},features:[zo]})}return t})(),OA=(()=>{class t{router;element;renderer;cdr;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new Hn;link=X(fp,{optional:!0});constructor(e,r,i,o){this.router=e,this.element=r,this.renderer=i,this.cdr=o,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Oh&&this.update()})}ngAfterContentInit(){Rn(this.links.changes,Rn(null)).pipe(oy()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=gs(e).pipe(oy()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const e=this.hasActiveLinks();this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){const r=function Ace(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact?{...Nj}:{...Oj};return i=>{const o=i.urlTree;return!!o&&vr(function Mae(t,n,e){const r=t instanceof _d?t:n.parseUrl(t);return di(()=>hA(n.lastSuccessfulNavigation()?.finalUrl??new _d,r,e))}(o,e,r))}}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static \u0275fac=function(r){return new(r||t)(Re(Bs),Re(Vr),Re(Ka),Re(Sh))};static \u0275dir=Ft({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,o){if(1&r&&OI(o,fp,5),2&r){let a;hd(a=fd())&&(i.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[zo]})}return t})();class Lj{}let Mce=(()=>{class t{router;injector;preloadingStrategy;loader;subscription;constructor(e,r,i,o){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(_s(e=>e instanceof Oh),BE(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription?.unsubscribe()}processRoutes(e,r){const i=[];for(const o of r){o.providers&&!o._injector&&(o._injector=x1(o.providers,e,""));const a=o._injector??e;o._loadedNgModuleFactory&&!o._loadedInjector&&(o._loadedInjector=o._loadedNgModuleFactory.create(a).injector);const c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(c,o.children??o._loadedRoutes))}return gs(i).pipe(oy())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{if(e.destroyed)return Rn(null);let i;i=r.loadChildren&&void 0===r.canLoad?gs(this.loader.loadChildren(e,r)):Rn(null);const o=i.pipe(Tc(a=>null===a?Rn(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,r._loadedNgModuleFactory=a.factory,this.processRoutes(a.injector??e,a.routes))));return r.loadComponent&&!r._loadedComponent?gs([o,this.loader.loadComponent(e,r)]).pipe(oy()):o})}static \u0275fac=function(r){return new(r||t)(Dt(Bs),Dt(Hr),Dt(Lj),Dt(kA))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const LA=new Fe("");let Fj=(()=>{class t{options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=jb;restoredId=0;store={};urlSerializer=X(Fb);zone=X(on);viewportScroller=X(Lz);transitions=X(PA);constructor(e){this.options=e,this.options.scrollPositionRestoration||="disabled",this.options.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof GE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Oh?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof ly&&e.code===WE.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{if(!(e instanceof tj)||"manual"===e.scrollBehavior)return;const r={behavior:"instant"};e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0],r):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position,r):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(e,r){var i=this;const o=vr(this.transitions.currentNavigation)?.extras.scroll;this.zone.runOutsideAngular(fe(function*(){yield new Promise(a=>{setTimeout(a),typeof requestAnimationFrame<"u"&&requestAnimationFrame(a)}),i.zone.run(()=>{i.transitions.events.next(new tj(e,"popstate"===i.lastSource?i.store[i.restoredId]:null,r,o))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){!function lF(){throw new Error("invalid")}()};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();function Bj(){return X(Bs).routerState.root}function Sc(t,n){return{\u0275kind:t,\u0275providers:n}}function Vj(){const t=X(In);return n=>{const e=t.get(Qa);if(n!==e.components[0])return;const r=t.get(Bs),i=t.get(zj);1===t.get(FA)&&r.initialNavigation(),t.get(Uj,null,{optional:!0})?.setUpPreloading(),t.get(LA,null,{optional:!0})?.init(),r.resetRootComponentType(e.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const zj=new Fe("",{factory:()=>new J}),FA=new Fe("",{factory:()=>1}),Uj=new Fe("");function Fce(t){return Sc(0,[{provide:Uj,useExisting:Mce},{provide:Lj,useExisting:t}])}function Vce(t){return Jo("NgRouterViewTransitions"),Sc(9,[{provide:Ij,useValue:bce},{provide:kj,useValue:{skipNextTransition:!!t?.skipInitialTransition,...t}}])}const zce=[ry,{provide:Fb,useClass:Bb},Bs,Hb,{provide:Ym,useFactory:Bj},kA,[]];let Yb=(()=>{class t{constructor(){}static forRoot(e,r){return{ngModule:t,providers:[zce,[],{provide:Zb,multi:!0,useValue:e},[],r?.errorHandler?{provide:Aj,useValue:r.errorHandler}:[],{provide:hy,useValue:r||{}},r?.useHash?{provide:qm,useClass:goe}:{provide:qm,useClass:zU},{provide:LA,useFactory:()=>{const t=X(Lz),n=X(hy);return n.scrollOffset&&t.setOffset(n.scrollOffset),new Fj(n)}},r?.preloadingStrategy?Fce(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?$ce(r):[],r?.bindToComponentInputs?Sc(8,[lj,{provide:XE,useExisting:lj}]).\u0275providers:[],r?.enableViewTransitions?Vce().\u0275providers:[],[{provide:jj,useFactory:Vj},{provide:aI,multi:!0,useExisting:jj}]]}}static forChild(e){return{ngModule:t,providers:[{provide:Zb,multi:!0,useValue:e}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})();function $ce(t){return["disabled"===t.initialNavigation?Sc(3,[sI(()=>{X(Bs).setUpLocationChangeListener()}),{provide:FA,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Sc(2,[{provide:gm,useValue:!0},{provide:FA,useValue:0},sI(()=>{const n=X(In);return n.get(yne,Promise.resolve()).then(()=>new Promise(r=>{const i=n.get(Bs),o=n.get(zj);Pj(i,()=>{r(!0)}),n.get(PA).afterPreactivation=()=>(r(!0),o.closed?Rn(void 0):o),i.initialNavigation()}))})]).\u0275providers:[]]}const jj=new Fe("");class mu{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(n){n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const i=e.slice(0,r),o=e.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,r)=>{this.addHeaderEntry(r,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,r])=>{this.setHeaderEntries(e,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof mu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new mu;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof mu?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,e);const i=("a"===n.op?this.headers.get(e):void 0)||[];i.push(...r),this.headers.set(e,i);break;case"d":const o=n.value;if(o){let a=this.headers.get(e);if(!a)return;a=a.filter(c=>-1===o.indexOf(c)),0===a.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}addHeaderEntry(n,e){const r=n.toLowerCase();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(e):this.headers.set(r,[e])}setHeaderEntries(n,e){const r=(Array.isArray(e)?e:[e]).map(o=>o.toString()),i=n.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(n,i)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class Gce{map=new Map;set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}class Wce{encodeKey(n){return Hj(n)}encodeValue(n){return Hj(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const Zce=/%(\d[a-f0-9])/gi,Yce={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Hj(t){return encodeURIComponent(t).replace(Zce,(n,e)=>Yce[e]??n)}function nC(t){return`${t}`}class pp{map;encoder;updates=null;cloneFrom=null;constructor(n={}){if(this.encoder=n.encoder||new Wce,n.fromString){if(n.fromObject)throw new ue(2805,!1);this.map=function Kce(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[a,c]=-1==o?[n.decodeKey(i),""]:[n.decodeKey(i.slice(0,o)),n.decodeValue(i.slice(o+1))],f=e.get(a)||[];f.push(c),e.set(a,f)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const r=n.fromObject[e],i=Array.isArray(r)?r.map(nC):[nC(r)];this.map.set(e,i)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(r=>{const i=n[r];Array.isArray(i)?i.forEach(o=>{e.push({param:r,value:o,op:"a"})}):e.push({param:r,value:i,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new pp({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(nC(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const i=r.indexOf(nC(n.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}function $j(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function qj(t){return typeof Blob<"u"&&t instanceof Blob}function Gj(t){return typeof FormData<"u"&&t instanceof FormData}const Xb="Content-Type",Wj="text/plain",Kj="application/json",Zj=`${Kj}, ${Wj}, */*`;class Qb{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(n,e,r,i){let o;if(this.url=e,this.method=n.toUpperCase(),function Xce(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),"number"==typeof o.timeout){if(o.timeout<1||!Number.isInteger(o.timeout))throw new ue(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),o.referrerPolicy&&(this.referrerPolicy=o.referrerPolicy),this.transferCache=o.transferCache}if(this.headers??=new mu,this.context??=new Gce,this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+a}}else this.params=new pp,this.urlWithParams=e}serializeBody(){return null===this.body?null:"string"==typeof this.body||$j(this.body)||qj(this.body)||Gj(this.body)||function Qce(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)?this.body:this.body instanceof pp?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Gj(this.body)?null:qj(this.body)?this.body.type||null:$j(this.body)?null:"string"==typeof this.body?Wj:this.body instanceof pp?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?Kj:null}clone(n={}){const e=n.method||this.method,r=n.url||this.url,i=n.responseType||this.responseType,o=n.keepalive??this.keepalive,a=n.priority||this.priority,c=n.cache||this.cache,f=n.mode||this.mode,_=n.redirect||this.redirect,x=n.credentials||this.credentials,D=n.referrer||this.referrer,A=n.integrity||this.integrity,N=n.referrerPolicy||this.referrerPolicy,B=n.transferCache??this.transferCache,te=n.timeout??this.timeout,ce=void 0!==n.body?n.body:this.body,we=n.withCredentials??this.withCredentials,Ce=n.reportProgress??this.reportProgress;let We=n.headers||this.headers,Se=n.params||this.params;const Ee=n.context??this.context;return void 0!==n.setHeaders&&(We=Object.keys(n.setHeaders).reduce((Be,Xe)=>Be.set(Xe,n.setHeaders[Xe]),We)),n.setParams&&(Se=Object.keys(n.setParams).reduce((Be,Xe)=>Be.set(Xe,n.setParams[Xe]),Se)),new Qb(e,r,ce,{params:Se,headers:We,context:Ee,reportProgress:Ce,responseType:i,withCredentials:we,transferCache:B,keepalive:o,cache:c,priority:a,timeout:te,mode:f,redirect:_,credentials:x,referrer:D,integrity:A,referrerPolicy:N})}}var mp=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(mp||{});class BA{headers;status;statusText;url;ok;type;redirected;responseType;constructor(n,e=200,r="OK"){this.headers=n.headers||new mu,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||r,this.url=n.url||null,this.redirected=n.redirected,this.responseType=n.responseType,this.ok=this.status>=200&&this.status<300}}class iC extends BA{constructor(n={}){super(n)}type=mp.ResponseHeader;clone(n={}){return new iC({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Jb extends BA{body;constructor(n={}){super(n),this.body=void 0!==n.body?n.body:null}type=mp.Response;clone(n={}){return new Jb({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0,redirected:n.redirected??this.redirected,responseType:n.responseType??this.responseType})}}class Xm extends BA{name="HttpErrorResponse";message;error;ok=!1;constructor(n){super(n,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}const Xj=new Fe(""),iue=/^\)\]\}',?\n/;let Qj=(()=>{class t{xhrFactory;tracingService=X(A_,{optional:!0});constructor(e){this.xhrFactory=e}maybePropagateTrace(e){return this.tracingService?.propagate?this.tracingService.propagate(e):e}handle(e){if("JSONP"===e.method)throw new ue(-2800,!1);const r=this.xhrFactory;return Rn(null).pipe(nl(()=>new U(o=>{const a=r.build();if(a.open(e.method,e.urlWithParams),e.withCredentials&&(a.withCredentials=!0),e.headers.forEach((ce,we)=>a.setRequestHeader(ce,we.join(","))),e.headers.has("Accept")||a.setRequestHeader("Accept",Zj),!e.headers.has(Xb)){const ce=e.detectContentTypeHeader();null!==ce&&a.setRequestHeader(Xb,ce)}if(e.timeout&&(a.timeout=e.timeout),e.responseType){const ce=e.responseType.toLowerCase();a.responseType="json"!==ce?ce:"text"}const c=e.serializeBody();let f=null;const _=()=>{if(null!==f)return f;const ce=a.statusText||"OK",we=new mu(a.getAllResponseHeaders());return f=new iC({headers:we,status:a.status,statusText:ce,url:a.responseURL||e.url}),f},x=this.maybePropagateTrace(()=>{let{headers:ce,status:we,statusText:Ce,url:We}=_(),Se=null;204!==we&&(Se=typeof a.response>"u"?a.responseText:a.response),0===we&&(we=Se?200:0);let Ee=we>=200&&we<300;if("json"===e.responseType&&"string"==typeof Se){const Be=Se;Se=Se.replace(iue,"");try{Se=""!==Se?JSON.parse(Se):null}catch(Xe){Se=Be,Ee&&(Ee=!1,Se={error:Xe,text:Se})}}Ee?(o.next(new Jb({body:Se,headers:ce,status:we,statusText:Ce,url:We||void 0})),o.complete()):o.error(new Xm({error:Se,headers:ce,status:we,statusText:Ce,url:We||void 0}))}),D=this.maybePropagateTrace(ce=>{const{url:we}=_(),Ce=new Xm({error:ce,status:a.status||0,statusText:a.statusText||"Unknown Error",url:we||void 0});o.error(Ce)});let A=D;e.timeout&&(A=this.maybePropagateTrace(ce=>{const{url:we}=_(),Ce=new Xm({error:new DOMException("Request timed out","TimeoutError"),status:a.status||0,statusText:a.statusText||"Request timeout",url:we||void 0});o.error(Ce)}));let N=!1;const B=this.maybePropagateTrace(ce=>{N||(o.next(_()),N=!0);let we={type:mp.DownloadProgress,loaded:ce.loaded};ce.lengthComputable&&(we.total=ce.total),"text"===e.responseType&&a.responseText&&(we.partialText=a.responseText),o.next(we)}),te=this.maybePropagateTrace(ce=>{let we={type:mp.UploadProgress,loaded:ce.loaded};ce.lengthComputable&&(we.total=ce.total),o.next(we)});return a.addEventListener("load",x),a.addEventListener("error",D),a.addEventListener("timeout",A),a.addEventListener("abort",D),e.reportProgress&&(a.addEventListener("progress",B),null!==c&&a.upload&&a.upload.addEventListener("progress",te)),a.send(c),o.next({type:mp.Sent}),()=>{a.removeEventListener("error",D),a.removeEventListener("abort",D),a.removeEventListener("load",x),a.removeEventListener("timeout",A),e.reportProgress&&(a.removeEventListener("progress",B),null!==c&&a.upload&&a.upload.removeEventListener("progress",te)),a.readyState!==a.DONE&&a.abort()}})))}static \u0275fac=function(r){return new(r||t)(Dt(Pz))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Jj(t,n){return n(t)}const e0=new Fe("",{factory:()=>[]}),lue=new Fe(""),e5=new Fe("",{factory:()=>!0});let oC=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:function(r){let i=null;return i=r?new(r||t):Dt(Qj),i},providedIn:"root"})}return t})(),UA=(()=>{class t{backend;injector;chain=null;pendingTasks=X(lv);contributeToStability=X(e5);constructor(e,r){this.backend=e,this.injector=r}handle(e){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(e0),...this.injector.get(lue,[])]));this.chain=r.reduceRight((i,o)=>function sue(t,n,e){return(r,i)=>ji(e,()=>n(r,o=>t(o,i)))}(i,o,this.injector),Jj)}if(this.contributeToStability){const r=this.pendingTasks.add();return this.chain(e,i=>this.backend.handle(i)).pipe(M4(r))}return this.chain(e,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||t)(Dt(oC),Dt(Hr))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),jA=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:function(r){let i=null;return i=r?new(r||t):Dt(UA),i},providedIn:"root"})}return t})();function HA(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,credentials:t.credentials,transferCache:t.transferCache,timeout:t.timeout,keepalive:t.keepalive,priority:t.priority,cache:t.cache,mode:t.mode,redirect:t.redirect,integrity:t.integrity,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}let uue=(()=>{class t{handler;constructor(e){this.handler=e}request(e,r,i={}){let o;if(e instanceof Qb)o=e;else{let f,_;f=i.headers instanceof mu?i.headers:new mu(i.headers),i.params&&(_=i.params instanceof pp?i.params:new pp({fromObject:i.params})),o=new Qb(e,r,void 0!==i.body?i.body:null,{headers:f,context:i.context,params:_,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect,credentials:i.credentials,referrer:i.referrer,referrerPolicy:i.referrerPolicy,integrity:i.integrity,timeout:i.timeout})}const a=Rn(o).pipe(BE(f=>this.handler.handle(f)));if(e instanceof Qb||"events"===i.observe)return a;const c=a.pipe(_s(f=>f instanceof Jb));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(hr(f=>{if(null!==f.body&&!(f.body instanceof ArrayBuffer))throw new ue(2806,!1);return f.body}));case"blob":return c.pipe(hr(f=>{if(null!==f.body&&!(f.body instanceof Blob))throw new ue(2807,!1);return f.body}));case"text":return c.pipe(hr(f=>{if(null!==f.body&&"string"!=typeof f.body)throw new ue(2808,!1);return f.body}));default:return c.pipe(hr(f=>f.body))}case"response":return c;default:throw new ue(2809,!1)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new pp).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,i={}){return this.request("PATCH",e,HA(i,r))}post(e,r,i={}){return this.request("POST",e,HA(i,r))}put(e,r,i={}){return this.request("PUT",e,HA(i,r))}static \u0275fac=function(r){return new(r||t)(Dt(jA))};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const n5=new Fe("",{factory:()=>!0}),r5=new Fe("",{factory:()=>"XSRF-TOKEN"}),i5=new Fe("",{factory:()=>"X-XSRF-TOKEN"});let gue=(()=>{class t{cookieName=X(r5);doc=X(jn);lastCookieString="";lastToken=null;parseCount=0;getToken(){const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Rz(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),_ue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:function(r){let i=null;return i=r?new(r||t):Dt(gue),i},providedIn:"root"})}return t})();function yue(t,n){if(!X(n5)||"GET"===t.method||"HEAD"===t.method)return n(t);try{const i=X(uE).href,{origin:o}=new URL(i),{origin:a}=new URL(t.url,o);if(o!==a)return n(t)}catch{return n(t)}const e=X(_ue).getToken(),r=X(i5);return null!=e&&!t.headers.has(r)&&(t=t.clone({headers:t.headers.set(r,e)})),n(t)}const qo=void 0,s5=["fr",[["AM","PM"]],qo,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],qo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],qo,[["av. J.-C.","ap. J.-C."],qo,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}",qo,qo],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[qo,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[qo,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[qo,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[qo,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[qo,"\xa5"],KMF:[qo,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[qo,"$C"],NZD:["$NZ","$"],PHP:[qo,"\u20b1"],RHD:["$RH"],RON:[qo,"L"],RWF:[qo,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[qo,"$T"],TTD:["$TT","$"],TWD:[qo,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[qo,"$"],XPF:["FCFP"],ZMW:[qo,"Kw"]},"ltr",function bue(t){const e=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(t.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===i&&0!==e&&e%1e6==0&&0===r||!(i>=0&&i<=5)?4:5}];function a5(t){return _s((n,e)=>t<=e)}function xue(t,n){return t===n}function $A(t){return 0===t.buttons||0===t.detail}function qA(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}let GA,KA;function sC(t){if(function Iue(){if(null==GA){const t=typeof document<"u"?document.head:null;GA=!(!t||!t.createShadowRoot&&!t.attachShadow)}return GA}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function WA(){let t=typeof document<"u"&&document?document.activeElement:null;for(;t&&t.shadowRoot;){const n=t.shadowRoot.activeElement;if(n===t)break;t=n}return t}function Ol(t){return t.composedPath?t.composedPath()[0]:t.target}try{KA=typeof Intl<"u"&&Intl.v8BreakIterator}catch{KA=!1}let t0,Ll=(()=>{class t{_platformId=X(ps);isBrowser=this._platformId?function wne(t){return t===Oz}(this._platformId):"object"==typeof document&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!(!window.chrome&&!KA)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ZA(t){return function kue(){if(null==t0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>t0=!0}))}finally{t0=t0||!1}return t0}()?t:!!t.capture}function aC(t,n=0){return function Aue(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):2===arguments.length?n:0}function il(t){return t instanceof Vr?t.nativeElement:t}const Mue=new Fe("cdk-input-modality-detector-options"),Rue={ignoreKeys:[18,17,224,91,16]},YA={passive:!0,capture:!0};let Pue=(()=>{class t{_platform=X(Ll);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new se(null);_options;_lastTouchMs=0;_onKeydown=e=>{this._options?.ignoreKeys?.some(r=>r===e.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ol(e))};_onMousedown=e=>{Date.now()-this._lastTouchMs<650||(this._modality.next($A(e)?"keyboard":"mouse"),this._mostRecentTarget=Ol(e))};_onTouchstart=e=>{qA(e)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ol(e))};constructor(){const e=X(on),r=X(jn),i=X(Mue,{optional:!0});if(this._options={...Rue,...i},this.modalityDetected=this._modality.pipe(a5(1)),this.modalityChanged=this.modalityDetected.pipe(function wue(t,n=tr){return t=t??xue,Vo((e,r)=>{let i,o=!0;e.subscribe(new si(r,a=>{const c=n(a);(o||!t(i,c))&&(o=!1,i=c,r.next(a))}))})}()),this._platform.isBrowser){const o=X(Al).createRenderer(null,null);this._listenerCleanups=e.runOutsideAngular(()=>[o.listen(r,"keydown",this._onKeydown,YA),o.listen(r,"mousedown",this._onMousedown,YA),o.listen(r,"touchstart",this._onTouchstart,YA)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(e=>e())}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var lC=function(t){return t[t.IMMEDIATE=0]="IMMEDIATE",t[t.EVENTUAL=1]="EVENTUAL",t}(lC||{});const Nue=new Fe("cdk-focus-monitor-default-options"),cC=ZA({passive:!0,capture:!0});let u5=(()=>{class t{_ngZone=X(on);_platform=X(Ll);_inputModalityDetector=X(Pue);_origin=null;_lastFocusOrigin=null;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=X(jn);_stopInputModalityDetector=new J;constructor(){const e=X(Nue,{optional:!0});this._detectionMode=e?.detectionMode||lC.IMMEDIATE}_rootNodeFocusAndBlurListener=e=>{for(let i=Ol(e);i;i=i.parentElement)"focus"===e.type?this._onFocus(e,i):this._onBlur(e,i)};monitor(e,r=!1){const i=il(e);if(!this._platform.isBrowser||1!==i.nodeType)return Rn();const o=sC(i)||this._document,a=this._elementInfo.get(i);if(a)return r&&(a.checkChildren=!0),a.subject;const c={checkChildren:r,subject:new J,rootNode:o};return this._elementInfo.set(i,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(e){const r=il(e),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(e,r,i){const o=il(e);o===this._document.activeElement?this._getClosestElementsInfo(o).forEach(([c,f])=>this._originChanged(c,r,f)):(this._setOrigin(r),"function"==typeof o.focus&&o.focus(i))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getWindow(){return this._document.defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===lC.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,this._detectionMode===lC.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const i=this._elementInfo.get(r),o=Ol(e);!i||!i.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),i)}_onBlur(e,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(i,null))}_emitOrigin(e,r){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,cC),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,cC)}),this._rootNodeFocusListenerCount.set(r,i+1),1===++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(md(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,cC),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,cC),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,i){this._setClasses(e,r),this._emitOrigin(i,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((i,o)=>{(o===e||i.checkChildren&&o.contains(e))&&r.push([o,i])}),r}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:r,mostRecentModality:i}=this._inputModalityDetector;if("mouse"!==i||!r||r===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const o=e.labels;if(o)for(let a=0;a<o.length;a++)if(o[a].contains(r))return!0;return!1}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const uC=new WeakMap;let fy=(()=>{class t{_appRef;_injector=X(In);_environmentInjector=X(Hr);load(e){const r=this._appRef=this._appRef||this._injector.get(Qa);let i=uC.get(r);i||(i={loaders:new Set,refs:[]},uC.set(r,i),r.onDestroy(()=>{uC.get(r)?.refs.forEach(o=>o.destroy()),uC.delete(r)})),i.loaders.has(e)||(i.loaders.add(e),i.refs.push(Az(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Oue extends Wn{constructor(n,e){super()}schedule(n,e=0){return this}}const dC={setInterval(...t){const{delegate:n}=dC;return(n?.setInterval||setInterval)(...t)},clearInterval(t){const{delegate:n}=dC;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class XA extends Oue{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){if(this.closed)return this;this.state=n;const r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(n,e,r=0){return dC.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;dC.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let i,r=!1;try{this.work(n)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,ml(r,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const QA={now:()=>(QA.delegate||Date).now(),delegate:void 0};class n0{constructor(n,e=n0.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}}n0.now=QA.now;class JA extends n0{constructor(n,e=n0.now){super(n,e),this.actions=[],this._active=!1,this._scheduled=void 0}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}}const eM=new JA(XA),d5=eM;function r0(t){return Array.isArray(t)?t:[t]}const h5=new Set;let Jm,f5=(()=>{class t{_platform=X(Ll);_nonce=X(Ur,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Bue}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Fue(t,n){if(!h5.has(t))try{Jm||(Jm=document.createElement("style"),n&&Jm.setAttribute("nonce",n),Jm.setAttribute("type","text/css"),document.head.appendChild(Jm)),Jm.sheet&&(Jm.sheet.insertRule(`@media ${t} {body{ }}`,0),h5.add(t))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Bue(t){return{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}let p5=(()=>{class t{_mediaMatcher=X(f5);_zone=X(on);_queries=new Map;_destroySubject=new J;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return m5(r0(e)).some(i=>this._registerQuery(i).mql.matches)}observe(e){let o=aA(m5(r0(e)).map(a=>this._registerQuery(a).observable));return o=Rb(o.pipe(Fs(1)),o.pipe(a5(1),function Lue(t,n=eM){return Vo((e,r)=>{let i=null,o=null,a=null;const c=()=>{if(i){i.unsubscribe(),i=null;const _=o;o=null,r.next(_)}};function f(){const _=a+t,x=n.now();if(x<_)return i=this.schedule(void 0,_-x),void r.add(i);c()}e.subscribe(new si(r,_=>{o=_,a=n.now(),i||(i=n.schedule(f,t),r.add(i))},()=>{c(),r.complete()},void 0,()=>{o=i=null}))})}(0))),o.pipe(hr(a=>{const c={matches:!1,breakpoints:{}};return a.forEach(({matches:f,query:_})=>{c.matches=c.matches||f,c.breakpoints[_]=f}),c}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),o={observable:new U(a=>{const c=f=>this._zone.run(()=>a.next(f));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(sy(r),hr(({matches:a})=>({query:e,matches:a})),md(this._destroySubject)),mql:r};return this._queries.set(e,o),o}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function m5(t){return t.map(n=>n.split(",")).reduce((n,e)=>n.concat(e)).map(n=>n.trim())}const Vue=new Fe("MATERIAL_ANIMATIONS");let g5=null;function py(){return"enabled"!==function zue(){return X(Vue,{optional:!0})?.animationsDisabled||"NoopAnimations"===X(ha,{optional:!0})?"di-disabled":(g5??=X(f5).matchMedia("(prefers-reduced-motion)").matches,g5?"reduced-motion":"enabled")}()}var Ic=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Ic||{});class Uue{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Ic.HIDDEN;constructor(n,e,r,i=!1){this._renderer=n,this.element=e,this.config=r,this._animationForciblyDisabledThroughCss=i}fadeOut(){this._renderer.fadeOutRipple(this)}}const _5=ZA({passive:!0,capture:!0});class jue{_events=new Map;addHandler(n,e,r,i){const o=this._events.get(e);if(o){const a=o.get(r);a?a.add(i):o.set(r,new Set([i]))}else this._events.set(e,new Map([[r,new Set([i])]])),n.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,_5)})}removeHandler(n,e,r){const i=this._events.get(n);if(!i)return;const o=i.get(e);o&&(o.delete(r),0===o.size&&i.delete(e),0===i.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,_5)))}_delegateEventHandler=n=>{const e=Ol(n);e&&this._events.get(n.type)?.forEach((r,i)=>{(i===e||i.contains(e))&&r.forEach(o=>o.handleEvent(n))})}}const hC={enterDuration:225,exitDuration:150},y5=ZA({passive:!0,capture:!0}),v5=["mousedown","touchstart"],b5=["mouseup","mouseleave","touchend","touchcancel"];let $ue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}\n"],encapsulation:2,changeDetection:0})}return t})();class fC{_target;_ngZone;_platform;_containerElement;_triggerElement=null;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple=null;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect=null;static _eventManager=new jue;constructor(n,e,r,i,o){this._target=n,this._ngZone=e,this._platform=i,i.isBrowser&&(this._containerElement=il(r)),o&&o.get(fy).load($ue)}fadeInRipple(n,e,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...hC,...r.animation};r.centered&&(n=i.left+i.width/2,e=i.top+i.height/2);const a=r.radius||function que(t,n,e){const r=Math.max(Math.abs(t-e.left),Math.abs(t-e.right)),i=Math.max(Math.abs(n-e.top),Math.abs(n-e.bottom));return Math.sqrt(r*r+i*i)}(n,e,i),c=n-i.left,f=e-i.top,_=o.enterDuration,x=document.createElement("div");x.classList.add("mat-ripple-element"),x.style.left=c-a+"px",x.style.top=f-a+"px",x.style.height=2*a+"px",x.style.width=2*a+"px",null!=r.color&&(x.style.backgroundColor=r.color),x.style.transitionDuration=`${_}ms`,this._containerElement.appendChild(x);const D=window.getComputedStyle(x),N=D.transitionDuration,B="none"===D.transitionProperty||"0s"===N||"0s, 0s"===N||0===i.width&&0===i.height,te=new Uue(this,x,r,B);x.style.transform="scale3d(1, 1, 1)",te.state=Ic.FADING_IN,r.persistent||(this._mostRecentTransientRipple=te);let ce=null;return!B&&(_||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const we=()=>{ce&&(ce.fallbackTimer=null),clearTimeout(We),this._finishRippleTransition(te)},Ce=()=>this._destroyRipple(te),We=setTimeout(Ce,_+100);x.addEventListener("transitionend",we),x.addEventListener("transitioncancel",Ce),ce={onTransitionEnd:we,onTransitionCancel:Ce,fallbackTimer:We}}),this._activeRipples.set(te,ce),(B||!_)&&this._finishRippleTransition(te),te}fadeOutRipple(n){if(n.state===Ic.FADING_OUT||n.state===Ic.HIDDEN)return;const e=n.element,r={...hC,...n.config.animation};e.style.transitionDuration=`${r.exitDuration}ms`,e.style.opacity="0",n.state=Ic.FADING_OUT,(n._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const e=il(n);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,v5.forEach(r=>{fC._eventManager.addHandler(this._ngZone,r,e,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{b5.forEach(e=>{this._triggerElement.addEventListener(e,this,y5)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){n.state===Ic.FADING_IN?this._startFadeOutTransition(n):n.state===Ic.FADING_OUT&&this._destroyRipple(n)}_startFadeOutTransition(n){const e=n===this._mostRecentTransientRipple,{persistent:r}=n.config;n.state=Ic.VISIBLE,!r&&(!e||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const e=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=Ic.HIDDEN,null!==e&&(n.element.removeEventListener("transitionend",e.onTransitionEnd),n.element.removeEventListener("transitioncancel",e.onTransitionCancel),null!==e.fallbackTimer&&clearTimeout(e.fallbackTimer)),n.element.remove()}_onMousedown(n){const e=$A(n),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!qA(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=n.changedTouches;if(e)for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(n.state===Ic.VISIBLE||n.config.terminateOnPointerUp&&n.state===Ic.FADING_IN)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(v5.forEach(e=>fC._eventManager.removeHandler(e,n,this)),this._pointerUpEventsRegistered&&(b5.forEach(e=>n.removeEventListener(e,this,y5)),this._pointerUpEventsRegistered=!1))}}const Gue=new Fe("mat-ripple-global-options"),Wue={capture:!0},Kue=["focus","mousedown","mouseenter","touchstart"],tM="mat-ripple-loader-uninitialized",nM="mat-ripple-loader-class-name",w5="mat-ripple-loader-centered",pC="mat-ripple-loader-disabled";let Zue=(()=>{class t{_document=X(jn);_animationsDisabled=py();_globalRippleOptions=X(Gue,{optional:!0});_platform=X(Ll);_ngZone=X(on);_injector=X(In);_eventCleanups;_hosts=new Map;constructor(){const e=X(Al).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>Kue.map(r=>e.listen(this._document,r,this._onInteraction,Wue)))}ngOnDestroy(){const e=this._hosts.keys();for(const r of e)this.destroyRipple(r);this._eventCleanups.forEach(r=>r())}configureRipple(e,r){e.setAttribute(tM,this._globalRippleOptions?.namespace??""),(r.className||!e.hasAttribute(nM))&&e.setAttribute(nM,r.className||""),r.centered&&e.setAttribute(w5,""),r.disabled&&e.setAttribute(pC,"")}setDisabled(e,r){const i=this._hosts.get(e);i?(i.target.rippleDisabled=r,!r&&!i.hasSetUpEvents&&(i.hasSetUpEvents=!0,i.renderer.setupTriggerEvents(e))):r?e.setAttribute(pC,""):e.removeAttribute(pC)}_onInteraction=e=>{const r=Ol(e);if(r instanceof HTMLElement){const i=r.closest(`[${tM}="${this._globalRippleOptions?.namespace??""}"]`);i&&this._createRipple(i)}};_createRipple(e){if(!this._document||this._hosts.has(e))return;e.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",e.getAttribute(nM)),e.append(r);const i=this._globalRippleOptions,o=this._animationsDisabled?0:i?.animation?.enterDuration??hC.enterDuration,a=this._animationsDisabled?0:i?.animation?.exitDuration??hC.exitDuration,c={rippleDisabled:this._animationsDisabled||i?.disabled||e.hasAttribute(pC),rippleConfig:{centered:e.hasAttribute(w5),terminateOnPointerUp:i?.terminateOnPointerUp,animation:{enterDuration:o,exitDuration:a}}},f=new fC(c,this._ngZone,r,this._platform,this._injector),_=!c.rippleDisabled;_&&f.setupTriggerEvents(e),this._hosts.set(e,{target:c,renderer:f,hasSetUpEvents:_}),e.removeAttribute(tM)}destroyRipple(e){const r=this._hosts.get(e);r&&(r.renderer._removeTriggerEvents(),this._hosts.delete(e))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Yue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["structural-styles"]],decls:0,vars:0,template:function(r,i){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus-visible::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}\n'],encapsulation:2,changeDetection:0})}return t})();const Xue=new Fe("MAT_BUTTON_CONFIG");function x5(t){return null==t?void 0:Tz(t)}let Que=(()=>{class t{_elementRef=X(Vr);_ngZone=X(on);_animationsDisabled=py();_config=X(Xue,{optional:!0});_focusMonitor=X(u5);_cleanupClick;_renderer=X(Ka);_rippleLoader=X(Zue);_isAnchor;_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;tabIndex;set _tabindex(e){this.tabIndex=e}constructor(){X(fy).load(Yue);const e=this._elementRef.nativeElement;this._isAnchor="A"===e.tagName,this.disabledInteractive=this._config?.disabledInteractive??!1,this.color=this._config?.color??null,this._rippleLoader?.configureRipple(e,{className:"mat-mdc-button-ripple"})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0),this._isAnchor&&this._setupAsAnchor()}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",r){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:this._isAnchor?this.disabled||null:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}_getTabIndex(){return this._isAnchor&&this.disabled&&!this.disabledInteractive?-1:this.tabIndex}_setupAsAnchor(){this._cleanupClick=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"click",e=>{this.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}))}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,hostAttrs:[1,"mat-mdc-button-base"],hostVars:13,hostBindings:function(r,i){2&r&&(Ys("disabled",i._getDisabledAttribute())("aria-disabled",i._getAriaDisabled())("tabindex",i._getTabIndex()),sp(i.color?"mat-"+i.color:""),Ls("mat-mdc-button-disabled",i.disabled)("mat-mdc-button-disabled-interactive",i.disabledInteractive)("mat-unthemed",!i.color)("_mat-animation-noopable",i._animationsDisabled))},inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",ms],disabled:[2,"disabled","disabled",ms],ariaDisabled:[2,"aria-disabled","ariaDisabled",ms],disabledInteractive:[2,"disabledInteractive","disabledInteractive",ms],tabIndex:[2,"tabIndex","tabIndex",x5],_tabindex:[2,"tabindex","_tabindex",x5]}})}return t})(),eg=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})(),Jue=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[eg]})}return t})();const ede=["matButton",""],tde=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],nde=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],E5=new Map([["text",["mat-mdc-button"]],["filled",["mdc-button--unelevated","mat-mdc-unelevated-button"]],["elevated",["mdc-button--raised","mat-mdc-raised-button"]],["outlined",["mdc-button--outlined","mat-mdc-outlined-button"]],["tonal",["mat-tonal-button"]]]);let rde=(()=>{class t extends Que{get appearance(){return this._appearance}set appearance(e){this.setAppearance(e||this._config?.defaultAppearance||"text")}_appearance=null;constructor(){super();const e=function ide(t){return t.hasAttribute("mat-raised-button")?"elevated":t.hasAttribute("mat-stroked-button")?"outlined":t.hasAttribute("mat-flat-button")?"filled":t.hasAttribute("mat-button")?"text":null}(this._elementRef.nativeElement);e&&this.setAppearance(e)}setAppearance(e){if(e===this._appearance)return;const r=this._elementRef.nativeElement.classList,i=this._appearance?E5.get(this._appearance):null,o=E5.get(e);i&&r.remove(...i),r.add(...o),this._appearance=e}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["button","matButton",""],["a","matButton",""],["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""],["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostAttrs:[1,"mdc-button"],inputs:{appearance:[0,"matButton","appearance"]},exportAs:["matButton","matAnchor"],features:[qn],attrs:ede,ngContentSelectors:nde,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,i){1&r&&(function PV(t){const n=Pe()[15][5];if(!n.projection){const r=n.projection=function Gd(t,n){const e=[];for(let r=0;r<t;r++)e.push(n);return e}(t?t.length:1,null),i=r.slice();let o=n.child;for(;null!==o;){if(128!==o.type){const a=t?yJ(o,t):0;null!==a&&(i[a]?i[a].projectionNext=o:r[a]=o,i[a]=o)}o=o.next}}}(tde),dd(0,"span",0),K1(1),Zt(2,"span",1),K1(3,1),qt(),K1(4,2),dd(5,"span",2)(6,"span",3)),2&r&&Ls("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mat-mdc-button-base .mat-icon{min-height:fit-content;flex-shrink:0}@media(hover: none){.mat-mdc-button-base:hover>span.mat-mdc-button-persistent-ripple::before{opacity:0}}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-button-text-horizontal-padding, 12px);height:var(--mat-button-text-container-height, 40px);font-family:var(--mat-button-text-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-text-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-text-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-text-label-text-transform);font-weight:var(--mat-button-text-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mat-button-text-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mat-button-text-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-text-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-button-text-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-button-text-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-text-touch-target-size, 48px);display:var(--mat-button-text-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-filled-container-height, 40px);font-family:var(--mat-button-filled-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-filled-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-filled-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-filled-label-text-transform);font-weight:var(--mat-button-filled-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-filled-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-button-filled-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-filled-touch-target-size, 48px);display:var(--mat-button-filled-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mat-button-filled-label-text-color, var(--mat-sys-on-primary));background-color:var(--mat-button-filled-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mat-button-filled-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-filled-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-filled-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mat-button-protected-container-elevation-shadow, var(--mat-sys-level1));height:var(--mat-button-protected-container-height, 40px);font-family:var(--mat-button-protected-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-protected-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-protected-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-protected-label-text-transform);font-weight:var(--mat-button-protected-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-protected-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-button-protected-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-protected-touch-target-size, 48px);display:var(--mat-button-protected-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-raised-button:not(:disabled){color:var(--mat-button-protected-label-text-color, var(--mat-sys-primary));background-color:var(--mat-button-protected-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mat-button-protected-container-shape, var(--mat-sys-corner-full))}@media(hover: hover){.mat-mdc-raised-button:hover{box-shadow:var(--mat-button-protected-hover-container-elevation-shadow, var(--mat-sys-level2))}}.mat-mdc-raised-button:focus{box-shadow:var(--mat-button-protected-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mat-button-protected-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-protected-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-protected-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mat-button-protected-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-outlined-container-height, 40px);font-family:var(--mat-button-outlined-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-outlined-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-outlined-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-outlined-label-text-transform);font-weight:var(--mat-button-outlined-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mat-button-outlined-container-shape, var(--mat-sys-corner-full));border-width:var(--mat-button-outlined-outline-width, 1px);padding:0 var(--mat-button-outlined-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-button-outlined-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-outlined-touch-target-size, 48px);display:var(--mat-button-outlined-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-outlined-button:not(:disabled){color:var(--mat-button-outlined-label-text-color, var(--mat-sys-primary));border-color:var(--mat-button-outlined-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-outlined-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mat-button-outlined-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-tonal-container-height, 40px);font-family:var(--mat-button-tonal-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-tonal-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-tonal-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-tonal-label-text-transform);font-weight:var(--mat-button-tonal-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-tonal-horizontal-padding, 24px)}.mat-tonal-button:not(:disabled){color:var(--mat-button-tonal-label-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-button-tonal-container-color, var(--mat-sys-secondary-container))}.mat-tonal-button,.mat-tonal-button .mdc-button__ripple{border-radius:var(--mat-button-tonal-container-shape, var(--mat-sys-corner-full))}.mat-tonal-button[disabled],.mat-tonal-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-tonal-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-tonal-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-tonal-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}[dir=rtl] .mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}.mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}[dir=rtl] .mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}.mat-tonal-button .mat-ripple-element{background-color:var(--mat-button-tonal-ripple-color, color-mix(in srgb, var(--mat-sys-on-secondary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-tonal-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-tonal-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-tonal-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-tonal-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-tonal-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-tonal-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:var(--mat-button-tonal-touch-target-size, 48px);display:var(--mat-button-tonal-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button,.mat-tonal-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon,.mat-tonal-button .mdc-button__label,.mat-tonal-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator,.mat-tonal-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit}.mat-mdc-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-raised-button:focus-visible>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus-visible>.mat-focus-indicator::before,.mat-tonal-button:focus-visible>.mat-focus-indicator::before{content:"";border-radius:inherit}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable,.mat-tonal-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon,.mat-tonal-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-tonal-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}\n',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-button-base.mat-tonal-button,.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}\n"],encapsulation:2,changeDetection:0})}return t})(),sde=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[Jue,eg]})}return t})();const rM={};class gu{_appId=X(xr);static _infix=`a${Math.floor(1e5*Math.random()).toString()}`;getId(n,e=!1){return"ng"!==this._appId&&(n+=this._appId),rM.hasOwnProperty(n)||(rM[n]=0),`${n}${e?gu._infix+"-":""}${rM[n]++}`}static \u0275fac=function(e){return new(e||gu)};static \u0275prov=je({token:gu,factory:gu.\u0275fac,providedIn:"root"})}let mC,ade=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(r,i){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}\n"],encapsulation:2,changeDetection:0})}return t})();let dde=(()=>{class t{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),hde=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[dde]})}return t})(),C5=(()=>{class t{_platform=X(Ll);constructor(){}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function pde(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const r=function fde(t){try{return t.frameElement}catch{return null}}(function xde(t){return t.ownerDocument&&t.ownerDocument.defaultView||window}(e));if(r&&(-1===T5(r)||!this.isVisible(r)))return!1;let i=e.nodeName.toLowerCase(),o=T5(e);return e.hasAttribute("contenteditable")?-1!==o:!("iframe"===i||"object"===i||this._platform.WEBKIT&&this._platform.IOS&&!function bde(t){let n=t.nodeName.toLowerCase(),e="input"===n&&t.type;return"text"===e||"password"===e||"select"===n||"textarea"===n}(e))&&("audio"===i?!!e.hasAttribute("controls")&&-1!==o:"video"===i?-1!==o&&(null!==o||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,r){return function wde(t){return!function gde(t){return function yde(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function mde(t){let n=t.nodeName.toLowerCase();return"input"===n||"select"===n||"button"===n||"textarea"===n}(t)||function _de(t){return function vde(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||D5(t))}(e)&&!this.isDisabled(e)&&(r?.ignoreVisibility||this.isVisible(e))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function D5(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let n=t.getAttribute("tabindex");return!(!n||isNaN(parseInt(n,10)))}function T5(t){if(!D5(t))return null;const n=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(n)?-1:n}class Ede{_element;_checker;_ngZone;_document;_injector;_startAnchor=null;_endAnchor=null;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(n){this._enabled=n,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_enabled=!0;constructor(n,e,r,i,o=!1,a){this._element=n,this._checker=e,this._ngZone=r,this._document=i,this._injector=a,o||this.attachAnchors()}destroy(){const n=this._startAnchor,e=this._endAnchor;n&&(n.removeEventListener("focus",this.startAnchorListener),n.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(n)))})}focusFirstTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(n)))})}focusLastTabbableElementWhenReady(n){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(n)))})}_getRegionBoundary(n){const e=this._element.querySelectorAll(`[cdk-focus-region-${n}], [cdkFocusRegion${n}], [cdk-focus-${n}]`);return"start"==n?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(n){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const r=this._getFirstTabbableElement(e);return r?.focus(n),!!r}return e.focus(n),!0}return this.focusFirstTabbableElement(n)}focusFirstTabbableElement(n){const e=this._getRegionBoundary("start");return e&&e.focus(n),!!e}focusLastTabbableElement(n){const e=this._getRegionBoundary("end");return e&&e.focus(n),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=0;r<e.length;r++){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[r]):null;if(i)return i}return null}_getLastTabbableElement(n){if(this._checker.isFocusable(n)&&this._checker.isTabbable(n))return n;const e=n.children;for(let r=e.length-1;r>=0;r--){const i=e[r].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[r]):null;if(i)return i}return null}_createAnchor(){const n=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,n),n.classList.add("cdk-visually-hidden"),n.classList.add("cdk-focus-trap-anchor"),n.setAttribute("aria-hidden","true"),n}_toggleAnchorTabIndex(n,e){n?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(n){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(n,this._startAnchor),this._toggleAnchorTabIndex(n,this._endAnchor))}_executeOnStable(n){this._injector?cu(n,{injector:this._injector}):setTimeout(n)}}let Cde=(()=>{class t{_checker=X(C5);_ngZone=X(on);_document=X(jn);_injector=X(In);constructor(){X(fy).load(ade)}create(e,r=!1){return new Ede(e,this._checker,this._ngZone,this._document,r,this._injector)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Dde=new Fe("liveAnnouncerElement",{providedIn:"root",factory:()=>null}),Tde=new Fe("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Sde=0,Ide=(()=>{class t{_ngZone=X(on);_defaultOptions=X(Tde,{optional:!0});_liveElement;_document=X(jn);_sanitizer=X(N4);_previousTimeout;_currentPromise;_currentResolve;constructor(){const e=X(Dde,{optional:!0});this._liveElement=e||this._createLiveElement()}announce(e,...r){const i=this._defaultOptions;let o,a;return 1===r.length&&"number"==typeof r[0]?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=i&&i.politeness?i.politeness:"polite"),null==a&&i&&(a=i.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(c=>this._currentResolve=c)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{e&&"string"!=typeof e?function ude(t,n,e){const r=e.sanitize(Il.HTML,n);t.innerHTML=function cde(t){return function lde(){if(void 0===mC&&(mC=null,typeof window<"u")){const t=window;void 0!==t.trustedTypes&&(mC=t.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return mC}()?.createHTML(t)||t}(r||"")}(this._liveElement,e,this._sanitizer):this._liveElement.textContent=e,"number"==typeof a&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",r=this._document.getElementsByClassName(e),i=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return i.classList.add(e),i.classList.add("cdk-visually-hidden"),i.setAttribute("aria-atomic","true"),i.setAttribute("aria-live","polite"),i.id="cdk-live-announcer-"+Sde++,this._document.body.appendChild(i),i}_exposeAnnouncerToModals(e){const r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");a?-1===a.indexOf(e)&&o.setAttribute("aria-owns",a+" "+e):o.setAttribute("aria-owns",e)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var tg=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(tg||{});const S5="cdk-high-contrast-black-on-white",I5="cdk-high-contrast-white-on-black",iM="cdk-high-contrast-active";let kde=(()=>{class t{_platform=X(Ll);_hasCheckedHighContrastMode=!1;_document=X(jn);_breakpointSubscription;constructor(){this._breakpointSubscription=X(p5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return tg.NONE;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(e):null,o=(i&&i.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return tg.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return tg.BLACK_ON_WHITE}return tg.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(iM,S5,I5),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();r===tg.BLACK_ON_WHITE?e.add(iM,S5):r===tg.WHITE_ON_BLACK&&e.add(iM,I5)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ade=(()=>{class t{constructor(){X(kde)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[hde]})}return t})();class oM{_attachedHost=null;attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class o0 extends oM{component;viewContainerRef;injector;projectableNodes;constructor(n,e,r,i){super(),this.component=n,this.viewContainerRef=e,this.injector=r,this.projectableNodes=i}}class sM extends oM{templateRef;viewContainerRef;context;injector;constructor(n,e,r,i){super(),this.templateRef=n,this.viewContainerRef=e,this.context=r,this.injector=i}get origin(){return this.templateRef.elementRef}attach(n,e=this.context){return this.context=e,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class Mde extends oM{element;constructor(n){super(),this.element=n instanceof Vr?n.nativeElement:n}}class gC{_attachedPortal=null;_disposeFn=null;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof o0?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof sM?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof Mde?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Rde extends gC{outletElement;_appRef;_defaultInjector;constructor(n,e,r){super(),this.outletElement=n,this._appRef=e,this._defaultInjector=r}attachComponentPortal(n){let e;if(n.viewContainerRef){const r=n.injector||n.viewContainerRef.injector,i=r.get(Eh,null,{optional:!0})||void 0;e=n.viewContainerRef.createComponent(n.component,{index:n.viewContainerRef.length,injector:r,ngModuleRef:i,projectableNodes:n.projectableNodes||void 0}),this.setDisposeFn(()=>e.destroy())}else{const r=this._appRef,i=n.injector||this._defaultInjector||In.NULL,o=i.get(Hr,r.injector);e=Az(n.component,{elementInjector:i,environmentInjector:o,projectableNodes:n.projectableNodes||void 0}),r.attachView(e.hostView),this.setDisposeFn(()=>{r.viewCount>0&&r.detachView(e.hostView),e.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(e)),this._attachedPortal=n,e}attachTemplatePortal(n){let e=n.viewContainerRef,r=e.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=e.indexOf(r);-1!==i&&e.remove(i)}),this._attachedPortal=n,r}attachDomPortal=n=>{const e=n.element,r=this.outletElement.ownerDocument.createComment("dom-portal");e.parentNode.insertBefore(r,e),this.outletElement.appendChild(e),this._attachedPortal=n,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(e,r)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let s0=(()=>{class t extends gC{_moduleRef=X(Eh,{optional:!0});_document=X(jn);_viewContainerRef=X(Ml);_isInitialized=!1;_attachedRef=null;constructor(){super()}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}attached=new Hn;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const r=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,i=r.createComponent(e.component,{index:r.length,injector:e.injector||r.injector,projectableNodes:e.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return r!==this._viewContainerRef&&this._getRootNode().appendChild(i.hostView.rootNodes[0]),super.setDisposeFn(()=>i.destroy()),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}attachTemplatePortal(e){e.setAttachedHost(this);const r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}attachDomPortal=e=>{const r=e.element,i=this._document.createComment("dom-portal");e.setAttachedHost(this),r.parentNode.insertBefore(i,r),this._getRootNode().appendChild(r),this._attachedPortal=e,super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(r,i)})};_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[qn]})}return t})(),a0=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})();function k5(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Go(t){return null==t?"":"string"==typeof t?t:`${t}px`}const l0={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=l0;r&&(n=r.requestAnimationFrame,e=r.cancelAnimationFrame);const i=n(o=>{e=void 0,t(o)});return new Wn(()=>e?.(i))},requestAnimationFrame(...t){const{delegate:n}=l0;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=l0;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0},A5=new class Ode extends JA{flush(n){this._active=!0,this._scheduled=void 0;const{actions:e}=this;let r,i=-1;n=n||e.shift();const o=e.length;do{if(r=n.execute(n.state,n.delay))break}while(++i<o&&(n=e.shift()));if(this._active=!1,r){for(;++i<o&&(n=e.shift());)n.unsubscribe();throw r}}}(class Nde extends XA{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=l0.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(n,e,r);0===n.actions.length&&(l0.cancelAnimationFrame(e),n._scheduled=void 0)}});let aM,Lde=1;const _C={};function M5(t){return t in _C&&(delete _C[t],!0)}const Fde={setImmediate(t){const n=Lde++;return _C[n]=!0,aM||(aM=Promise.resolve()),aM.then(()=>M5(n)&&t()),n},clearImmediate(t){M5(t)}},{setImmediate:Bde,clearImmediate:Vde}=Fde,yC={setImmediate(...t){const{delegate:n}=yC;return(n?.setImmediate||Bde)(...t)},clearImmediate(t){const{delegate:n}=yC;return(n?.clearImmediate||Vde)(t)},delegate:void 0};new class Ude extends JA{flush(n){this._active=!0,this._scheduled=void 0;const{actions:e}=this;let r,i=-1;n=n||e.shift();const o=e.length;do{if(r=n.execute(n.state,n.delay))break}while(++i<o&&(n=e.shift()));if(this._active=!1,r){for(;++i<o&&(n=e.shift());)n.unsubscribe();throw r}}}(class zde extends XA{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,r=0){return null!==r&&r>0?super.requestAsyncId(n,e,r):(n.actions.push(this),n._scheduled||(n._scheduled=yC.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,r=0){if(null!=r&&r>0||null==r&&this.delay>0)return super.recycleAsyncId(n,e,r);0===n.actions.length&&(yC.clearImmediate(e),n._scheduled=void 0)}});function R5(t=0,n,e=d5){let r=-1;return null!=n&&(C4(n)?e=n:r=n),new U(i=>{let o=function $de(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let a=0;return e.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function P5(t,n=d5){return function Hde(t){return Vo((n,e)=>{let r=!1,i=null,o=null,a=!1;const c=()=>{if(o?.unsubscribe(),o=null,r){r=!1;const _=i;i=null,e.next(_)}a&&e.complete()},f=()=>{o=null,a&&e.complete()};n.subscribe(new si(e,_=>{r=!0,i=_,o||Dc(t(_)).subscribe(o=new si(e,c,f))},()=>{a=!0,(!r||!o||o.closed)&&e.complete()}))})}(()=>R5(t,n))}const qde=new Fe("cdk-dir-doc",{providedIn:"root",factory:()=>X(jn)}),Gde=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let ng,my=(()=>{class t{get value(){return this.valueSignal()}valueSignal=wo("ltr");change=new Hn;constructor(){const e=X(qde,{optional:!0});e&&this.valueSignal.set(function Wde(t){const n=t?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?Gde.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function N5(){if(null==ng){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ng=!1,ng;if(document.documentElement?.style&&"scrollBehavior"in document.documentElement.style)ng=!0;else{const t=Element.prototype.scrollTo;ng=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return ng}let bC=(()=>{class t{_ngZone=X(on);_platform=X(Ll);_renderer=X(Al).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new J;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new U(r=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));const i=e>0?this._scrolled.pipe(P5(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Rn()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(_s(o=>!o||i.indexOf(o)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((i,o)=>{this._scrollableContainsElement(o,e)&&r.push(o)}),r}_scrollableContainsElement(e,r){let i=il(r),o=e.getElementRef().nativeElement;do{if(i==o)return!0}while(i=i.parentElement);return!1}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),gy=(()=>{class t{_platform=X(Ll);_listeners;_viewportSize=null;_change=new J;_document=X(jn);constructor(){const e=X(on),r=X(Al).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){const i=o=>this._change.next(o);this._listeners=[r.listen("window","resize",i),r.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),i=e.documentElement,o=i.getBoundingClientRect();return{top:-o.top||e.body?.scrollTop||r.scrollY||i.scrollTop||0,left:-o.left||e.body?.scrollLeft||r.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(P5(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),lM=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})(),O5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[eg,lM,eg,lM]})}return t})();const L5=N5();function cM(t){return new Xde(t.get(gy),t.get(jn))}class Xde{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(n,e){this._viewportRuler=n,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=Go(-this._previousScrollPosition.left),n.style.top=Go(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,r=n.style,i=this._document.body.style,o=r.scrollBehavior||"",a=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),L5&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),L5&&(r.scrollBehavior=o,i.scrollBehavior=a)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.documentElement,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class Jde{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(n,e,r,i){this._scrollDispatcher=n,this._ngZone=e,this._viewportRuler=r,this._config=i}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(_s(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}class uM{enable(){}disable(){}attach(){}}function dM(t,n){return n.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function F5(t,n){return n.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class ehe{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(n,e,r,i){this._scrollDispatcher=n,this._viewportRuler=e,this._ngZone=r,this._config=i}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();dM(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let the=(()=>{class t{_injector=X(In);constructor(){}noop=()=>new uM;close=e=>function Qde(t,n){return new Jde(t.get(bC),t.get(on),t.get(gy),n)}(this._injector,e);block=()=>cM(this._injector);reposition=e=>function B5(t,n){return new ehe(t.get(bC),t.get(gy),t.get(on),n)}(this._injector,e);static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class hM{positionStrategy;scrollStrategy=new uM;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";disableAnimations;width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;usePopover;constructor(n){if(n){const e=Object.keys(n);for(const r of e)void 0!==n[r]&&(this[r]=n[r])}}}class nhe{connectionPair;scrollableViewProperties;constructor(n,e){this.connectionPair=n,this.scrollableViewProperties=e}}let V5=(()=>{class t{_attachedOverlays=[];_document=X(jn);_isAttached=!1;constructor(){}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),rhe=(()=>{class t extends V5{_ngZone=X(on);_renderer=X(Al).createRenderer(null,null);_cleanupKeydown;add(e){super.add(e),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=e=>{const r=this._attachedOverlays;for(let i=r.length-1;i>-1;i--)if(r[i]._keydownEvents.observers.length>0){this._ngZone.run(()=>r[i]._keydownEvents.next(e));break}};static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ihe=(()=>{class t extends V5{_platform=X(Ll);_ngZone=X(on);_renderer=X(Al).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget=null;_cleanups;add(e){if(super.add(e),!this._isAttached){const r=this._document.body,i={capture:!0},o=this._renderer;this._cleanups=this._ngZone.runOutsideAngular(()=>[o.listen(r,"pointerdown",this._pointerDownListener,i),o.listen(r,"click",this._clickListener,i),o.listen(r,"auxclick",this._clickListener,i),o.listen(r,"contextmenu",this._clickListener,i)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(e=>e()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=e=>{this._pointerDownEventTarget=Ol(e)};_clickListener=e=>{const r=Ol(e),i="click"===e.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:r;this._pointerDownEventTarget=null;const o=this._attachedOverlays.slice();for(let a=o.length-1;a>-1;a--){const c=o[a];if(c._outsidePointerEvents.observers.length<1||!c.hasAttached())continue;if(z5(c.overlayElement,r)||z5(c.overlayElement,i))break;const f=c._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>f.next(e)):f.next(e)}};static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function z5(t,n){const e=typeof ShadowRoot<"u"&&ShadowRoot;let r=n;for(;r;){if(r===t)return!0;r=e&&r instanceof ShadowRoot?r.host:r.parentNode}return!1}let U5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(r,i){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0;touch-action:manipulation}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}@media(prefers-reduced-motion){.cdk-overlay-backdrop{transition-duration:1ms}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}.cdk-overlay-popover{background:none;border:none;padding:0;outline:0;overflow:visible;position:fixed;pointer-events:none;white-space:normal;color:inherit;text-decoration:none;width:100%;height:100%;inset:auto;top:0;left:0}.cdk-overlay-popover::backdrop{display:none}.cdk-overlay-popover .cdk-overlay-backdrop{position:fixed;z-index:auto}\n"],encapsulation:2,changeDetection:0})}return t})(),fM=(()=>{class t{_platform=X(Ll);_containerElement;_document=X(jn);_styleLoader=X(fy);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||k5()){const i=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let o=0;o<i.length;o++)i[o].remove()}const r=this._document.createElement("div");r.classList.add(e),k5()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}_loadStyles(){this._styleLoader.load(U5)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class ohe{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(n,e,r,i){this._renderer=e,this._ngZone=r,this.element=n.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=e.listen(this.element,"click",i)}detach(){this._ngZone.runOutsideAngular(()=>{const n=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(n,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),n.style.pointerEvents="none",n.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}}function pM(t){return t&&1===t.nodeType}class j5{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new J;_attachments=new J;_detachments=new J;_positionStrategy;_scrollStrategy;_locationChanges=Wn.EMPTY;_backdropRef=null;_detachContentMutationObserver;_detachContentAfterRenderRef;_disposed=!1;_previousHostParent;_keydownEvents=new J;_outsidePointerEvents=new J;_afterNextRenderRef;constructor(n,e,r,i,o,a,c,f,_,x=!1,D,A){this._portalOutlet=n,this._host=e,this._pane=r,this._config=i,this._ngZone=o,this._keyboardDispatcher=a,this._document=c,this._location=f,this._outsideClickDispatcher=_,this._animationsDisabled=x,this._injector=D,this._renderer=A,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(n){if(this._disposed)return null;this._attachHost();const e=this._portalOutlet.attach(n);return this._positionStrategy?.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=cu(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._completeDetachContent(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._completeDetachContent(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){if(this._disposed)return;const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,n&&this._detachments.next(),this._detachments.complete(),this._completeDetachContent(),this._disposed=!0}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=Go(this._config.width),n.height=Go(this._config.height),n.minWidth=Go(this._config.minWidth),n.minHeight=Go(this._config.minHeight),n.maxWidth=Go(this._config.maxWidth),n.maxHeight=Go(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachHost(){if(!this._host.parentElement){const n=this._config.usePopover?this._positionStrategy?.getPopoverInsertionPoint?.():null;pM(n)?n.after(this._host):"parent"===n?.type?n.element.appendChild(this._host):this._previousHostParent?.appendChild(this._host)}if(this._config.usePopover)try{this._host.showPopover()}catch{}}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new ohe(this._document,this._renderer,this._ngZone,e=>{this._backdropClick.next(e)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._config.usePopover?this._host.prepend(this._backdropRef.element):this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(n))}):this._backdropRef.element.classList.add(n)}_updateStackingOrder(){!this._config.usePopover&&this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(n,e,r){const i=r0(e||[]).filter(o=>!!o);i.length&&(r?n.classList.add(...i):n.classList.remove(...i))}_detachContentWhenEmpty(){let n=!1;try{this._detachContentAfterRenderRef=cu(()=>{n=!0,this._detachContent()},{injector:this._injector})}catch(e){if(n)throw e;this._detachContent()}globalThis.MutationObserver&&this._pane&&(this._detachContentMutationObserver||=new globalThis.MutationObserver(()=>{this._detachContent()}),this._detachContentMutationObserver.observe(this._pane,{childList:!0}))}_detachContent(){(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),this._completeDetachContent())}_completeDetachContent(){this._detachContentAfterRenderRef?.destroy(),this._detachContentAfterRenderRef=void 0,this._detachContentMutationObserver?.disconnect()}_disposeScrollStrategy(){const n=this._scrollStrategy;n?.disable(),n?.detach?.()}}const H5="cdk-overlay-connected-position-bounding-box",she=/([A-Za-z%]+)$/;class lhe{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender=!1;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed=!1;_boundingBox=null;_lastPosition=null;_lastScrollVisibility=null;_positionChanges=new J;_resizeSubscription=Wn.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount=null;_popoverLocation="global";positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(n,e,r,i,o){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=o,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(H5),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._getContainerRect();const n=this._originRect,e=this._overlayRect,r=this._viewportRect,i=this._containerRect,o=[];let a;for(let c of this._preferredPositions){let f=this._getOriginPoint(n,i,c),_=this._getOverlayPoint(f,e,c),x=this._getOverlayFit(_,e,r,c);if(x.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(c,f);this._canFitWithFlexibleDimensions(x,_,r)?o.push({position:c,origin:f,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(f,c)}):(!a||a.overlayFit.visibleArea<x.visibleArea)&&(a={overlayFit:x,overlayPoint:_,originPoint:f,position:c,overlayRect:e})}if(o.length){let c=null,f=-1;for(const _ of o){const x=_.boundingBoxRect.width*_.boundingBoxRect.height*(_.position.weight||1);x>f&&(f=x,c=_)}return this._isPushed=!1,void this._applyPosition(c.position,c.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(a.position,a.originPoint);this._applyPosition(a.position,a.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&rg(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(H5),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;n?(this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._getContainerRect(),this._applyPosition(n,this._getOriginPoint(this._originRect,this._containerRect,n))):this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}withPopoverLocation(n){return this._popoverLocation=n,this}getPopoverInsertionPoint(){return"global"===this._popoverLocation?null:"inline"!==this._popoverLocation?this._popoverLocation:this._origin instanceof Vr?this._origin.nativeElement:pM(this._origin)?this._origin:null}_getOriginPoint(n,e,r){let i,o;if("center"==r.originX)i=n.left+n.width/2;else{const a=this._isRtl()?n.right:n.left,c=this._isRtl()?n.left:n.right;i="start"==r.originX?a:c}return e.left<0&&(i-=e.left),o="center"==r.originY?n.top+n.height/2:"top"==r.originY?n.top:n.bottom,e.top<0&&(o-=e.top),{x:i,y:o}}_getOverlayPoint(n,e,r){let i,o;return i="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,o="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:n.x+i,y:n.y+o}}_getOverlayFit(n,e,r,i){const o=q5(e);let{x:a,y:c}=n,f=this._getOffset(i,"x"),_=this._getOffset(i,"y");f&&(a+=f),_&&(c+=_);let A=0-c,N=c+o.height-r.height,B=this._subtractOverflows(o.width,0-a,a+o.width-r.width),te=this._subtractOverflows(o.height,A,N),ce=B*te;return{visibleArea:ce,isCompletelyWithinViewport:o.width*o.height===ce,fitsInViewportVertically:te===o.height,fitsInViewportHorizontally:B==o.width}}_canFitWithFlexibleDimensions(n,e,r){if(this._hasFlexibleDimensions){const i=r.bottom-e.y,o=r.right-e.x,a=$5(this._overlayRef.getConfig().minHeight),c=$5(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=a&&a<=i)&&(n.fitsInViewportHorizontally||null!=c&&c<=o)}return!1}_pushOverlayOnScreen(n,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const i=q5(e),o=this._viewportRect,a=Math.max(n.x+i.width-o.width,0),c=Math.max(n.y+i.height-o.height,0),f=Math.max(o.top-r.top-n.y,0),_=Math.max(o.left-r.left-n.x,0);let x=0,D=0;return x=i.width<=o.width?_||-a:n.x<this._getViewportMarginStart()?o.left-r.left-n.x:0,D=i.height<=o.height?f||-c:n.y<this._getViewportMarginTop()?o.top-r.top-n.y:0,this._previousPushAmount={x,y:D},{x:n.x+x,y:n.y+D}}_applyPosition(n,e){if(this._setTransformOrigin(n),this._setOverlayElementStyles(e,n),this._setBoundingBoxStyles(e,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._positionChanges.observers.length){const r=this._getScrollVisibility();if(n!==this._lastPosition||!this._lastScrollVisibility||!function che(t,n){return t===n||t.isOriginClipped===n.isOriginClipped&&t.isOriginOutsideView===n.isOriginOutsideView&&t.isOverlayClipped===n.isOverlayClipped&&t.isOverlayOutsideView===n.isOverlayOutsideView}(this._lastScrollVisibility,r)){const i=new nhe(n,r);this._positionChanges.next(i)}this._lastScrollVisibility=r}this._lastPosition=n,this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=n.overlayY;r="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let o=0;o<e.length;o++)e[o].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(n,e){const r=this._viewportRect,i=this._isRtl();let o,a,c;if("top"===e.overlayY)a=n.y,o=r.height-a+this._getViewportMarginBottom();else if("bottom"===e.overlayY)c=r.height-n.y+this._getViewportMarginTop()+this._getViewportMarginBottom(),o=r.height-c+this._getViewportMarginTop();else{const N=Math.min(r.bottom-n.y+r.top,n.y),B=this._lastBoundingBoxSize.height;o=2*N,a=n.y-N,o>B&&!this._isInitialRender&&!this._growAfterOpen&&(a=n.y-B/2)}const f="start"===e.overlayX&&!i||"end"===e.overlayX&&i;let x,D,A;if("end"===e.overlayX&&!i||"start"===e.overlayX&&i)A=r.width-n.x+this._getViewportMarginStart()+this._getViewportMarginEnd(),x=n.x-this._getViewportMarginStart();else if(f)D=n.x,x=r.right-n.x-this._getViewportMarginEnd();else{const N=Math.min(r.right-n.x+r.left,n.x),B=this._lastBoundingBoxSize.width;x=2*N,D=n.x-N,x>B&&!this._isInitialRender&&!this._growAfterOpen&&(D=n.x-B/2)}return{top:a,left:D,bottom:c,right:A,width:x,height:o}}_setBoundingBoxStyles(n,e){const r=this._calculateBoundingBoxRect(n,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right="auto",i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,a=this._overlayRef.getConfig().maxWidth;i.width=Go(r.width),i.height=Go(r.height),i.top=Go(r.top)||"auto",i.bottom=Go(r.bottom)||"auto",i.left=Go(r.left)||"auto",i.right=Go(r.right)||"auto",i.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",i.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",o&&(i.maxHeight=Go(o)),a&&(i.maxWidth=Go(a))}this._lastBoundingBoxSize=r,rg(this._boundingBox.style,i)}_resetBoundingBoxStyles(){rg(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){rg(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,e){const r={},i=this._hasExactPosition(),o=this._hasFlexibleDimensions,a=this._overlayRef.getConfig();if(i){const x=this._viewportRuler.getViewportScrollPosition();rg(r,this._getExactOverlayY(e,n,x)),rg(r,this._getExactOverlayX(e,n,x))}else r.position="static";let c="",f=this._getOffset(e,"x"),_=this._getOffset(e,"y");f&&(c+=`translateX(${f}px) `),_&&(c+=`translateY(${_}px)`),r.transform=c.trim(),a.maxHeight&&(i?r.maxHeight=Go(a.maxHeight):o&&(r.maxHeight="")),a.maxWidth&&(i?r.maxWidth=Go(a.maxWidth):o&&(r.maxWidth="")),rg(this._pane.style,r)}_getExactOverlayY(n,e,r){let i={top:"",bottom:""},o=this._getOverlayPoint(e,this._overlayRect,n);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),"bottom"===n.overlayY?i.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":i.top=Go(o.y),i}_getExactOverlayX(n,e,r){let a,i={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,n);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,r)),a=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===a?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=Go(o.x),i}_getScrollVisibility(){const n=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:F5(n,r),isOriginOutsideView:dM(n,r),isOverlayClipped:F5(e,r),isOverlayOutsideView:dM(e,r)}}_subtractOverflows(n,...e){return e.reduce((r,i)=>r-Math.max(i,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._getViewportMarginTop(),left:r.left+this._getViewportMarginStart(),right:r.left+n-this._getViewportMarginEnd(),bottom:r.top+e-this._getViewportMarginBottom(),width:n-this._getViewportMarginStart()-this._getViewportMarginEnd(),height:e-this._getViewportMarginTop()-this._getViewportMarginBottom()}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,e){return"x"===e?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&r0(n).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getViewportMarginStart(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.start??0}_getViewportMarginEnd(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.end??0}_getViewportMarginTop(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.top??0}_getViewportMarginBottom(){return"number"==typeof this._viewportMargin?this._viewportMargin:this._viewportMargin?.bottom??0}_getOriginRect(){const n=this._origin;if(n instanceof Vr)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const e=n.width||0,r=n.height||0;return{top:n.y,bottom:n.y+r,left:n.x,right:n.x+e,height:r,width:e}}_getContainerRect(){const n=this._overlayRef.getConfig().usePopover&&"global"!==this._popoverLocation,e=this._overlayContainer.getContainerElement();n&&(e.style.display="block");const r=e.getBoundingClientRect();return n&&(e.style.display=""),r}}function rg(t,n){for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function $5(t){if("number"!=typeof t&&null!=t){const[n,e]=t.split(she);return e&&"px"!==e?null:parseFloat(n)}return t||null}function q5(t){return{top:Math.floor(t.top),right:Math.floor(t.right),bottom:Math.floor(t.bottom),left:Math.floor(t.left),width:Math.floor(t.width),height:Math.floor(t.height)}}const G5="cdk-global-overlay-wrapper";function wC(t){return new uhe}class uhe{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(n){const e=n.getConfig();this._overlayRef=n,this._width&&!e.width&&n.updateSize({width:this._width}),this._height&&!e.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(G5),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:o,maxWidth:a,maxHeight:c}=r,f=!("100%"!==i&&"100vw"!==i||a&&"100%"!==a&&"100vw"!==a),_=!("100%"!==o&&"100vh"!==o||c&&"100%"!==c&&"100vh"!==c),x=this._xPosition,D=this._xOffset,A="rtl"===this._overlayRef.getConfig().direction;let N="",B="",te="";f?te="flex-start":"center"===x?(te="center",A?B=D:N=D):A?"left"===x||"end"===x?(te="flex-end",N=D):("right"===x||"start"===x)&&(te="flex-start",B=D):"left"===x||"start"===x?(te="flex-start",N=D):("right"===x||"end"===x)&&(te="flex-end",B=D),n.position=this._cssPosition,n.marginLeft=f?"0":N,n.marginTop=_?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=f?"0":B,e.justifyContent=te,e.alignItems=_?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(G5),r.justifyContent=r.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let dhe=(()=>{class t{_injector=X(In);constructor(){}global(){return wC()}flexibleConnectedTo(e){return function ahe(t,n){return new lhe(n,t.get(gy),t.get(jn),t.get(Ll),t.get(fM))}(this._injector,e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const hhe=new Fe("OVERLAY_DEFAULT_CONFIG");function mM(t,n){t.get(fy).load(U5);const e=t.get(fM),r=t.get(jn),i=t.get(gu),o=t.get(Qa),a=t.get(my),c=t.get(Ka,null,{optional:!0})||t.get(Al).createRenderer(null,null),f=new hM(n),_=t.get(hhe,null,{optional:!0})?.usePopover??!0;f.direction=f.direction||a.value,f.usePopover="showPopover"in r.body&&(n?.usePopover??_);const x=r.createElement("div"),D=r.createElement("div");x.id=i.getId("cdk-overlay-"),x.classList.add("cdk-overlay-pane"),D.appendChild(x),f.usePopover&&(D.setAttribute("popover","manual"),D.classList.add("cdk-overlay-popover"));const A=f.usePopover?f.positionStrategy?.getPopoverInsertionPoint?.():null;return pM(A)?A.after(D):"parent"===A?.type?A.element.appendChild(D):e.getContainerElement().appendChild(D),new j5(new Rde(x,o,t),D,x,f,t.get(on),t.get(rhe),r,t.get(ry),t.get(ihe),n?.disableAnimations??"NoopAnimations"===t.get(ha,null,{optional:!0}),t.get(Hr),c)}let fhe=(()=>{class t{scrollStrategies=X(the);_positionBuilder=X(dhe);_injector=X(In);constructor(){}create(e){return mM(this._injector,e)}position(){return this._positionBuilder}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),gM=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[fhe],imports:[eg,a0,O5,O5]})}return t})();function phe(t,n){if(1&t){const e=yn();j(0,"div",1)(1,"button",2),Ge("click",function(){return He(e),Ze(xe().action())}),Y(2),G()()}if(2&t){const e=xe();le(2),ci(" ",e.data.action," ")}}const mhe=["label"];function ghe(t,n){}const _he=Math.pow(2,31)-1;class _M{_overlayRef;instance;containerInstance;_afterDismissed=new J;_afterOpened=new J;_onAction=new J;_durationTimeoutId;_dismissedByAction=!1;constructor(n,e){this._overlayRef=e,this.containerInstance=n,n._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(n){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(n,_he))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const W5=new Fe("MatSnackBarData");class xC{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"}let K5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return t})(),Z5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return t})(),Y5=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return t})(),X5=(()=>{class t{snackBarRef=X(_M);data=X(W5);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(r,i){1&r&&(j(0,"div",0),Y(1),G(),vt(2,phe,3,1,"div",1)),2&r&&(le(),ci(" ",i.data.message,"\n"),le(),bt(i.hasAction?2:-1))},dependencies:[rde,K5,Z5,Y5],styles:[".mat-mdc-simple-snack-bar{display:flex}.mat-mdc-simple-snack-bar .mat-mdc-snack-bar-label{max-height:50vh;overflow:auto}\n"],encapsulation:2,changeDetection:0})}return t})();const yM="_mat-snack-bar-enter",vM="_mat-snack-bar-exit";let Q5=(()=>{class t extends gC{_ngZone=X(on);_elementRef=X(Vr);_changeDetectorRef=X(Sh);_platform=X(Ll);_animationsDisabled=py();snackBarConfig=X(xC);_document=X(jn);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=X(In);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new J;_onExit=new J;_onEnter=new J;_animationState="void";_live;_label;_role;_liveElementId=X(gu).getId("mat-snack-bar-container-live-");constructor(){super();const e=this.snackBarConfig;this._live="assertive"!==e.politeness||e.announcementMessage?"off"===e.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),r}attachTemplatePortal(e){this._assertNotAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),r}attachDomPortal=e=>{this._assertNotAttached();const r=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),r};onAnimationEnd(e){e===vM?this._completeExit():e===yM&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?cu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(yM)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(yM)},200)))}exit(){return this._destroyed?Rn(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?cu(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(vM)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(vM),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){const e=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(a=>e.classList.add(a)):e.classList.add(r)),this._exposeToModals();const i=this._label.nativeElement,o="mdc-snackbar__label";i.classList.toggle(o,!i.querySelector(`.${o}`))}_exposeToModals(){const e=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let i=0;i<r.length;i++){const o=r[i],a=o.getAttribute("aria-owns");this._trackedModals.add(o),a?-1===a.indexOf(e)&&o.setAttribute("aria-owns",a+" "+e):o.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{const r=e.getAttribute("aria-owns");if(r){const i=r.replace(this._liveElementId,"").trim();i.length>0?e.setAttribute("aria-owns",i):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;const e=this._elementRef.nativeElement,r=e.querySelector("[aria-hidden]"),i=e.querySelector("[aria-live]");if(r&&i){let o=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&r.contains(document.activeElement)&&(o=document.activeElement),r.removeAttribute("aria-hidden"),i.appendChild(r),o?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,i){if(1&r&&op(s0,7)(mhe,7),2&r){let o;hd(o=fd())&&(i._portalOutlet=o.first),hd(o=fd())&&(i._label=o.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(r,i){1&r&&Ge("animationend",function(a){return i.onAnimationEnd(a.animationName)})("animationcancel",function(a){return i.onAnimationEnd(a.animationName)}),2&r&&Ls("mat-snack-bar-container-enter","visible"===i._animationState)("mat-snack-bar-container-exit","hidden"===i._animationState)("mat-snack-bar-container-animations-enabled",!i._animationsDisabled)},features:[qn],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(j(0,"div",1)(1,"div",2,0)(3,"div",3),tb(4,ghe,0,0,"ng-template",4),G(),wt(5,"div"),G()()),2&r&&(le(5),Ys("aria-live",i._live)("role",i._role)("id",i._liveElementId))},dependencies:[s0],styles:["@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}\n"],encapsulation:2})}return t})();const yhe=new Fe("mat-snack-bar-default-options",{providedIn:"root",factory:()=>new xC});let ig=(()=>{class t{_live=X(Ide);_injector=X(In);_breakpointObserver=X(p5);_parentSnackBar=X(t,{optional:!0,skipSelf:!0});_defaultConfig=X(yhe);_animationsDisabled=py();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=X5;snackBarContainerComponent=Q5;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,r){return this._attach(e,r)}openFromTemplate(e,r){return this._attach(e,r)}open(e,r="",i){const o={...this._defaultConfig,...i};return o.data={message:e,action:r},o.announcementMessage===e&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,r){const o=In.create({parent:r&&r.viewContainerRef&&r.viewContainerRef.injector||this._injector,providers:[{provide:xC,useValue:r}]}),a=new o0(this.snackBarContainerComponent,r.viewContainerRef,o),c=e.attach(a);return c.instance.snackBarConfig=r,c.instance}_attach(e,r){const i={...new xC,...this._defaultConfig,...r},o=this._createOverlay(i),a=this._attachSnackBarContainer(o,i),c=new _M(a,o);if(e instanceof kl){const f=new sM(e,null,{$implicit:i.data,snackBarRef:c});c.instance=a.attachTemplatePortal(f)}else{const f=this._createInjector(i,c),_=new o0(e,void 0,f),x=a.attachComponentPortal(_);c.instance=x.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(md(o.detachments())).subscribe(f=>{o.overlayElement.classList.toggle(this.handsetCssClass,f.matches)}),i.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(i.announcementMessage,i.politeness)}),this._animateSnackBar(c,i),this._openedSnackBarRef=c,this._openedSnackBarRef}_animateSnackBar(e,r){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),r.duration&&r.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(r.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){const r=new hM;r.direction=e.direction;const i=wC(),o="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!o||"end"===e.horizontalPosition&&o,c=!a&&"center"!==e.horizontalPosition;return a?i.left("0"):c?i.right("0"):i.centerHorizontally(),"top"===e.verticalPosition?i.top("0"):i.bottom("0"),r.positionStrategy=i,r.disableAnimations=this._animationsDisabled,mM(this._injector,r)}_createInjector(e,r){return In.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:_M,useValue:r},{provide:W5,useValue:e.data}]})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),vhe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[ig],imports:[gM,a0,sde,X5,eg]})}return t})();function J5(t,...n){return n.length?n.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}function bhe(t,n){}class u0{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;positionStrategy;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;closeOnNavigation=!0;closeOnDestroy=!0;closeOnOverlayDetachments=!0;disableAnimations=!1;providers;container;templateContext}let e6=(()=>{class t extends gC{_elementRef=X(Vr);_focusTrapFactory=X(Cde);_config;_interactivityChecker=X(C5);_ngZone=X(on);_focusMonitor=X(u5);_renderer=X(Ka);_changeDetectorRef=X(Sh);_injector=X(In);_platform=X(Ll);_document=X(jn);_portalOutlet;_focusTrapped=new J;_focusTrap=null;_elementFocusedBeforeDialogWasOpened=null;_closeInteractionType=null;_ariaLabelledByQueue=[];_isDestroyed=!1;constructor(){super(),this._config=X(u0,{optional:!0})||new u0,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(e){this._ariaLabelledByQueue.push(e),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(e){const r=this._ariaLabelledByQueue.indexOf(e);r>-1&&(this._ariaLabelledByQueue.splice(r,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._focusTrapped.complete(),this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),r}attachTemplatePortal(e){this._portalOutlet.hasAttached();const r=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),r}attachDomPortal=e=>{this._portalOutlet.hasAttached();const r=this._portalOutlet.attachDomPortal(e);return this._contentAttached(),r};_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,r){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const i=()=>{o(),a(),e.removeAttribute("tabindex")},o=this._renderer.listen(e,"blur",i),a=this._renderer.listen(e,"mousedown",i)})),e.focus(r)}_focusByCssSelector(e,r){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,r)}_trapFocus(e){this._isDestroyed||cu(()=>{const r=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||r.focus(e);break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement(e)||this._focusDialogContainer(e);break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]',e);break;default:this._focusByCssSelector(this._config.autoFocus,e)}this._focusTrapped.next()},{injector:this._injector})}_restoreFocus(){const e=this._config.restoreFocus;let r=null;if("string"==typeof e?r=this._document.querySelector(e):"boolean"==typeof e?r=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(r=e),this._config.restoreFocus&&r&&"function"==typeof r.focus){const i=WA(),o=this._elementRef.nativeElement;(!i||i===this._document.body||i===o||o.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(r,this._closeInteractionType),this._closeInteractionType=null):r.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(e){this._elementRef.nativeElement.focus?.(e)}_containsFocus(){const e=this._elementRef.nativeElement,r=WA();return e===r||e.contains(r)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=WA()))}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["cdk-dialog-container"]],viewQuery:function(r,i){if(1&r&&op(s0,7),2&r){let o;hd(o=fd())&&(i._portalOutlet=o.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(r,i){2&r&&Ys("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[qn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(r,i){1&r&&tb(0,bhe,0,0,"ng-template",0)},dependencies:[s0],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}\n"],encapsulation:2})}return t})();class bM{overlayRef;config;componentInstance=null;componentRef=null;containerInstance;disableClose;closed=new J;backdropClick;keydownEvents;outsidePointerEvents;id;_detachSubscription;constructor(n,e){this.overlayRef=n,this.config=e,this.disableClose=e.disableClose,this.backdropClick=n.backdropClick(),this.keydownEvents=n.keydownEvents(),this.outsidePointerEvents=n.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(r=>{27===r.keyCode&&!this.disableClose&&!J5(r)&&(r.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{!this.disableClose&&this._canClose()?this.close(void 0,{focusOrigin:"mouse"}):this.containerInstance._recaptureFocus?.()}),this._detachSubscription=n.detachments().subscribe(()=>{!1!==e.closeOnOverlayDetachments&&this.close()})}close(n,e){if(this._canClose(n)){const r=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),r.next(n),r.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(n="",e=""){return this.overlayRef.updateSize({width:n,height:e}),this}addPanelClass(n){return this.overlayRef.addPanelClass(n),this}removePanelClass(n){return this.overlayRef.removePanelClass(n),this}_canClose(n){const e=this.config;return!!this.containerInstance&&(!e.closePredicate||e.closePredicate(n,e,this.componentInstance))}}const whe=new Fe("DialogScrollStrategy",{providedIn:"root",factory:()=>{const t=X(In);return()=>cM(t)}}),xhe=new Fe("DialogData"),Ehe=new Fe("DefaultDialogConfig");function Che(t){const n=wo(t),e=new Hn;return{valueSignal:n,get value(){return n()},change:e,ngOnDestroy(){e.complete()}}}let t6=(()=>{class t{_injector=X(In);_defaultOptions=X(Ehe,{optional:!0});_parentDialog=X(t,{optional:!0,skipSelf:!0});_overlayContainer=X(fM);_idGenerator=X(gu);_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new J;_afterOpenedAtThisLevel=new J;_ariaHiddenElements=new Map;_scrollStrategy=X(whe);get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}afterAllClosed=Pb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(sy(void 0)));constructor(){}open(e,r){(r={...this._defaultOptions||new u0,...r}).id=r.id||this._idGenerator.getId("cdk-dialog-"),r.id&&this.getDialogById(r.id);const o=this._getOverlayConfig(r),a=mM(this._injector,o),c=new bM(a,r),f=this._attachContainer(a,c,r);if(c.containerInstance=f,!this.openDialogs.length){const _=this._overlayContainer.getContainerElement();f._focusTrapped?f._focusTrapped.pipe(Fs(1)).subscribe(()=>{this._hideNonDialogContentFromAssistiveTechnology(_)}):this._hideNonDialogContentFromAssistiveTechnology(_)}return this._attachDialogContent(e,c,f,r),this.openDialogs.push(c),c.closed.subscribe(()=>this._removeOpenDialog(c,!0)),this.afterOpened.next(c),c}closeAll(){wM(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){wM(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),wM(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const r=new hM({positionStrategy:e.positionStrategy||wC().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation,disableAnimations:e.disableAnimations});return e.backdropClass&&(r.backdropClass=e.backdropClass),r}_attachContainer(e,r,i){const o=i.injector||i.viewContainerRef?.injector,a=[{provide:u0,useValue:i},{provide:bM,useValue:r},{provide:j5,useValue:e}];let c;i.container?"function"==typeof i.container?c=i.container:(c=i.container.type,a.push(...i.container.providers(i))):c=e6;const f=new o0(c,i.viewContainerRef,In.create({parent:o||this._injector,providers:a}));return e.attach(f).instance}_attachDialogContent(e,r,i,o){if(e instanceof kl){const a=this._createInjector(o,r,i,void 0);let c={$implicit:o.data,dialogRef:r};o.templateContext&&(c={...c,..."function"==typeof o.templateContext?o.templateContext():o.templateContext}),i.attachTemplatePortal(new sM(e,null,c,a))}else{const a=this._createInjector(o,r,i,this._injector),c=i.attachComponentPortal(new o0(e,o.viewContainerRef,a));r.componentRef=c,r.componentInstance=c.instance}}_createInjector(e,r,i,o){const a=e.injector||e.viewContainerRef?.injector,c=[{provide:xhe,useValue:e.data},{provide:bM,useValue:r}];return e.providers&&("function"==typeof e.providers?c.push(...e.providers(r,e,i)):c.push(...e.providers)),e.direction&&(!a||!a.get(my,null,{optional:!0}))&&c.push({provide:my,useValue:Che(e.direction)}),In.create({parent:a||o,providers:c})}_removeOpenDialog(e,r){const i=this.openDialogs.indexOf(e);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((o,a)=>{o?a.setAttribute("aria-hidden",o):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),r&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(e){if(e.parentElement){const r=e.parentElement.children;for(let i=r.length-1;i>-1;i--){const o=r[i];o!==e&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&!o.hasAttribute("popover")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function wM(t,n){let e=t.length;for(;e--;)n(t[e])}let Dhe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[t6],imports:[gM,a0,Ade,a0]})}return t})();class n6 extends J{constructor(n=1/0,e=1/0,r=QA){super(),this._bufferSize=n,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,e)}next(n){const{isStopped:e,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:a}=this;e||(r.push(n),!i&&r.push(o.now()+a)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(n),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let a=0;a<o.length&&!n.closed;a+=r?1:2)n.next(o[a]);return this._checkFinalizedStatuses(n),e}_trimBuffer(){const{_bufferSize:n,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*n;if(n<1/0&&o<r.length&&r.splice(0,r.length-o),!i){const a=e.now();let c=0;for(let f=1;f<r.length&&r[f]<=a;f+=2)c=f;c&&r.splice(0,c+1)}}}function EC(...t){const n=Mb(t),e=function oae(t,n){return"number"==typeof sA(t)?t.pop():n}(t,1/0),r=t;return r.length?1===r.length?Dc(r[0]):oy(e)(gs(r,n)):va}function The(t,n){}class r6{viewContainerRef;injector;id;role="dialog";panelClass="";hasBackdrop=!0;backdropClass="";disableClose=!1;closePredicate;width="";height="";minWidth;minHeight;maxWidth;maxHeight;position;data=null;direction;ariaDescribedBy=null;ariaLabelledBy=null;ariaLabel=null;ariaModal=!1;autoFocus="first-tabbable";restoreFocus=!0;delayFocusTrap=!0;scrollStrategy;closeOnNavigation=!0;enterAnimationDuration;exitAnimationDuration}const xM="mdc-dialog--open",i6="mdc-dialog--opening",o6="mdc-dialog--closing";let s6=(()=>{class t extends e6{_animationStateChanged=new Hn;_animationsEnabled=!py();_actionSectionCount=0;_hostElement=this._elementRef.nativeElement;_enterAnimationDuration=this._animationsEnabled?l6(this._config.enterAnimationDuration)??150:0;_exitAnimationDuration=this._animationsEnabled?l6(this._config.exitAnimationDuration)??75:0;_animationTimer=null;_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(a6,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(i6,xM)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(xM),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(xM),this._animationsEnabled?(this._hostElement.style.setProperty(a6,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(o6)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(e){this._actionSectionCount+=e,this._changeDetectorRef.markForCheck()}_finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)};_finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})};_clearAnimationClasses(){this._hostElement.classList.remove(i6,o6)}_waitForAnimationToComplete(e,r){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(r,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(e):e()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}attachComponentPortal(e){const r=super.attachComponentPortal(e);return r.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),r}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275cmp=_r({type:t,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(r,i){2&r&&(lb("id",i._config.id),Ys("aria-modal",i._config.ariaModal)("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledByQueue[0])("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),Ls("_mat-animation-noopable",!i._animationsEnabled)("mat-mdc-dialog-container-with-actions",i._actionSectionCount>0))},features:[qn],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1),tb(2,The,0,0,"ng-template",2),G()())},dependencies:[s0],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 560px);min-width:var(--mat-dialog-container-min-width, 280px)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, calc(100vw - 32px))}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, none);border-radius:var(--mat-dialog-container-shape, var(--mat-sys-corner-extra-large, 4px));background-color:var(--mat-dialog-container-color, var(--mat-sys-surface, white))}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 6px 24px 13px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mat-dialog-subhead-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-dialog-subhead-font, var(--mat-sys-headline-small-font, inherit));line-height:var(--mat-dialog-subhead-line-height, var(--mat-sys-headline-small-line-height, 1.5rem));font-size:var(--mat-dialog-subhead-size, var(--mat-sys-headline-small-size, 1rem));font-weight:var(--mat-dialog-subhead-weight, var(--mat-sys-headline-small-weight, 400));letter-spacing:var(--mat-dialog-subhead-tracking, var(--mat-sys-headline-small-tracking, 0.03125em))}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mat-dialog-supporting-text-color, var(--mat-sys-on-surface-variant, rgba(0, 0, 0, 0.6)));font-family:var(--mat-dialog-supporting-text-font, var(--mat-sys-body-medium-font, inherit));line-height:var(--mat-dialog-supporting-text-line-height, var(--mat-sys-body-medium-line-height, 1.5rem));font-size:var(--mat-dialog-supporting-text-size, var(--mat-sys-body-medium-size, 1rem));font-weight:var(--mat-dialog-supporting-text-weight, var(--mat-sys-body-medium-weight, 400));letter-spacing:var(--mat-dialog-supporting-text-tracking, var(--mat-sys-body-medium-tracking, 0.03125em))}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px 0)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;box-sizing:border-box;min-height:52px;margin:0;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 16px 24px);justify-content:var(--mat-dialog-actions-alignment, flex-end)}@media(forced-colors: active){.mat-mdc-dialog-actions{border-top-color:CanvasText}}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}\n'],encapsulation:2})}return t})();const a6="--mat-dialog-transition-duration";function l6(t){return null==t?null:"number"==typeof t?t:t.endsWith("ms")?aC(t.substring(0,t.length-2)):t.endsWith("s")?1e3*aC(t.substring(0,t.length-1)):"0"===t?0:null}var CC=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(CC||{});class og{_ref;_config;_containerInstance;componentInstance;componentRef=null;disableClose;id;_afterOpened=new n6(1);_beforeClosed=new n6(1);_result;_closeFallbackTimeout;_state=CC.OPEN;_closeInteractionType;constructor(n,e,r){this._ref=n,this._config=e,this._containerInstance=r,this.disableClose=e.disableClose,this.id=n.id,n.addPanelClass("mat-mdc-dialog-panel"),r._animationStateChanged.pipe(_s(i=>"opened"===i.state),Fs(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),r._animationStateChanged.pipe(_s(i=>"closed"===i.state),Fs(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),n.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),EC(this.backdropClick(),this.keydownEvents().pipe(_s(i=>27===i.keyCode&&!this.disableClose&&!J5(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),function c6(t,n,e){return t._closeInteractionType=n,t.close(e)}(this,"keydown"===i.type?"keyboard":"mouse"))})}close(n){const e=this._config.closePredicate;e&&!e(n,this._config,this.componentInstance)||(this._result=n,this._containerInstance._animationStateChanged.pipe(_s(r=>"closing"===r.state),Fs(1)).subscribe(r=>{this._beforeClosed.next(n),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),r.totalTime+100)}),this._state=CC.CLOSING,this._containerInstance._startExitAnimation())}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(n){let e=this._ref.config.positionStrategy;return n&&(n.left||n.right)?n.left?e.left(n.left):e.right(n.right):e.centerHorizontally(),n&&(n.top||n.bottom)?n.top?e.top(n.top):e.bottom(n.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(n="",e=""){return this._ref.updateSize(n,e),this}addPanelClass(n){return this._ref.addPanelClass(n),this}removePanelClass(n){return this._ref.removePanelClass(n),this}getState(){return this._state}_finishDialogClose(){this._state=CC.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const DC=new Fe("MatMdcDialogData"),khe=new Fe("mat-mdc-dialog-default-options"),Ahe=new Fe("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{const t=X(In);return()=>cM(t)}});let sg=(()=>{class t{_defaultOptions=X(khe,{optional:!0});_scrollStrategy=X(Ahe);_parentDialog=X(t,{optional:!0,skipSelf:!0});_idGenerator=X(gu);_injector=X(In);_dialog=X(t6);_animationsDisabled=py();_openDialogsAtThisLevel=[];_afterAllClosedAtThisLevel=new J;_afterOpenedAtThisLevel=new J;dialogConfigClass=r6;_dialogRefConstructor;_dialogContainerType;_dialogDataToken;get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}afterAllClosed=Pb(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(sy(void 0)));constructor(){this._dialogRefConstructor=og,this._dialogContainerType=s6,this._dialogDataToken=DC}open(e,r){let i;(r={...this._defaultOptions||new r6,...r}).id=r.id||this._idGenerator.getId("mat-mdc-dialog-"),r.scrollStrategy=r.scrollStrategy||this._scrollStrategy();const o=this._dialog.open(e,{...r,positionStrategy:wC().centerHorizontally().centerVertically(),disableClose:!0,closePredicate:void 0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,disableAnimations:this._animationsDisabled||"0"===r.enterAnimationDuration?.toLocaleString()||"0"===r.exitAnimationDuration?.toString(),container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:r},{provide:u0,useValue:r}]},templateContext:()=>({dialogRef:i}),providers:(a,c,f)=>(i=new this._dialogRefConstructor(a,r,f),i.updatePosition(r?.position),[{provide:this._dialogContainerType,useValue:f},{provide:this._dialogDataToken,useValue:c.data},{provide:this._dialogRefConstructor,useValue:i}])});return i.componentRef=o.componentRef,i.componentInstance=o.componentInstance,this.openDialogs.push(i),this.afterOpened.next(i),i.afterClosed().subscribe(()=>{const a=this.openDialogs.indexOf(i);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(r=>r.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let r=e.length;for(;r--;)e[r].close()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),h6=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[sg],imports:[Dhe,gM,a0,eg]})}return t})();const _p=new U(Ma),EM="Service workers are disabled or not supported by this browser";class TC{serviceWorker;worker;registration;events;constructor(n,e){if(this.serviceWorker=n,n){let r=null;const i=new J;this.worker=new U(_=>(null!==r&&_.next(r),i.subscribe(x=>_.next(x))));const o=()=>{const{controller:_}=n;null!==_&&(r=_,i.next(r))};n.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(nl(()=>n.getRegistration().then(_=>{if(!_)throw new ue(5601,!1);return _})));const a=new J;this.events=a.asObservable();const c=_=>{const{data:x}=_;x?.type&&a.next(x)};n.addEventListener("message",c),e?.get(Qa,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",o),n.removeEventListener("message",c)})}else this.worker=this.events=this.registration=new U(r=>r.error(new ue(5601,!1)))}postMessage(n,e){return new Promise(r=>{this.worker.pipe(Fs(1)).subscribe(i=>{i.postMessage({action:n,...e}),r()})})}postMessageWithOperation(n,e,r){const i=this.waitForOperationCompleted(r),o=this.postMessage(n,e);return Promise.all([o,i]).then(([,a])=>a)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?r=>r.type===n:r=>n.includes(r.type),this.events.pipe(_s(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(Fs(1))}waitForOperationCompleted(n){return new Promise((e,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(_s(i=>i.nonce===n),Fs(1),hr(i=>{if(void 0!==i.result)return i.result;throw new Error(i.error)})).subscribe({next:e,error:r})})}get isEnabled(){return!!this.serviceWorker}}let f6=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new J;constructor(e){if(this.sw=e,!e.isEnabled)return this.messages=_p,this.notificationClicks=_p,this.notificationCloses=_p,this.pushSubscriptionChanges=_p,void(this.subscription=_p);this.messages=this.sw.eventsOfType("PUSH").pipe(hr(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(hr(i=>i.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(hr(i=>i.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(hr(i=>i.data)),this.pushManager=this.sw.registration.pipe(hr(i=>i.pushManager));const r=this.pushManager.pipe(nl(i=>i.getSubscription()));this.subscription=new U(i=>{const o=r.subscribe(i),a=this.subscriptionChanges.subscribe(i);return()=>{o.unsubscribe(),a.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(EM));const r={userVisibleOnly:!0};let i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a);return r.applicationServerKey=o,new Promise((a,c)=>{this.pushManager.pipe(nl(f=>f.subscribe(r)),Fs(1)).subscribe({next:f=>{this.subscriptionChanges.next(f),a(f)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(EM));const e=r=>{if(null===r)throw new ue(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new ue(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(Fs(1),nl(e)).subscribe({next:r,error:i})})}decodeBase64(e){return atob(e)}static \u0275fac=function(r){return new(r||t)(Dt(TC))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})(),CM=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=_p,void(this.unrecoverable=_p);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(EM));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;const e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new ue(5601,!1));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(r){return new(r||t)(Dt(TC))};static \u0275prov=je({token:t,factory:t.\u0275fac})}return t})();const p6=new Fe("");function Ohe(){const t=X(DM);if(!("serviceWorker"in navigator)||!1===t.enabled)return;const n=X(p6),e=X(on),r=X(Qa);e.runOutsideAngular(()=>{const i=navigator.serviceWorker,o=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",o),r.onDestroy(()=>{i.removeEventListener("controllerchange",o)})}),e.runOutsideAngular(()=>{let i;const{registrationStrategy:o}=t;if("function"==typeof o)i=new Promise(a=>o().subscribe(()=>a()));else{const[a,...c]=(o||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=m6(+c[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),m6(+c[0])]);break;default:throw new ue(5600,!1)}}i.then(()=>{r.destroyed||navigator.serviceWorker.register(n,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(a=>console.error(jt(5604,!1)))})})}function m6(t){return new Promise(n=>setTimeout(n,t))}function Lhe(){const t=X(DM),n=X(In);return new TC(!1!==t.enabled?navigator.serviceWorker:void 0,n)}class DM{enabled;updateViaCache;type;scope;registrationStrategy}function Fhe(t,n={}){return za([f6,CM,{provide:p6,useValue:t},{provide:DM,useValue:n},{provide:TC,useFactory:Lhe},sI(Ohe)])}let Bhe=(()=>{class t{static register(e,r={}){return{ngModule:t,providers:[Fhe(e,r)]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[f6,CM]})}return t})();const lt=function(t,n){if(!t)throw _y(n)},_y=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},g6=function(t){const n=[];let e=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?n[e++]=i:i<2048?(n[e++]=i>>6|192,n[e++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),n[e++]=i>>18|240,n[e++]=i>>12&63|128,n[e++]=i>>6&63|128,n[e++]=63&i|128):(n[e++]=i>>12|224,n[e++]=i>>6&63|128,n[e++]=63&i|128)}return n},SM={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,n){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,f=i+2<t.length,_=f?t[i+2]:0;let A=(15&c)<<2|_>>6,N=63&_;f||(N=64,a||(A=64)),r.push(e[o>>2],e[(3&o)<<4|c>>4],e[A],e[N])}return r.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(g6(t),n)},decodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(t):function(t){const n=[];let e=0,r=0;for(;e<t.length;){const i=t[e++];if(i<128)n[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[e++];n[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const f=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536;n[r++]=String.fromCharCode(55296+(f>>10)),n[r++]=String.fromCharCode(56320+(1023&f))}else{const o=t[e++],a=t[e++];n[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return n.join("")}(this.decodeStringToByteArray(t,n))},decodeStringToByteArray(t,n){this.init_();const e=n?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=e[t.charAt(i++)],c=i<t.length?e[t.charAt(i)]:0;++i;const _=i<t.length?e[t.charAt(i)]:64;++i;const D=i<t.length?e[t.charAt(i)]:64;if(++i,null==o||null==c||null==_||null==D)throw new zhe;r.push(o<<2|c>>4),64!==_&&(r.push(c<<4&240|_>>2),64!==D&&r.push(_<<6&192|D))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zhe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _6=function(t){const n=g6(t);return SM.encodeByteArray(n,!0)},SC=function(t){return _6(t).replace(/\./g,"")},IC=function(t){try{return SM.decodeString(t,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};function Uhe(t){return y6(void 0,t)}function y6(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(const e in n)!n.hasOwnProperty(e)||!jhe(e)||(t[e]=y6(t[e],n[e]));return t}function jhe(t){return"__proto__"!==t}const kC=()=>{try{return function Hhe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const n=t&&IC(t[1]);return n&&JSON.parse(n)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},v6=t=>{var n,e;return null===(e=null===(n=kC())||void 0===n?void 0:n.emulatorHosts)||void 0===e?void 0:e[t]},b6=t=>{const n=v6(t);if(!n)return;const e=n.lastIndexOf(":");if(e<=0||e+1===n.length)throw new Error(`Invalid host ${n} with no separate hostname and port!`);const r=parseInt(n.substring(e+1),10);return"["===n[0]?[n.substring(1,e-1),r]:[n.substring(0,e),r]},w6=()=>{var t;return null===(t=kC())||void 0===t?void 0:t.config},x6=t=>{var n;return null===(n=kC())||void 0===n?void 0:n[`_${t}`]};class yy{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e})}wrapCallback(n){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof n&&(this.promise.catch(()=>{}),1===n.length?n(e):n(e,r))}}}function E6(t,n){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=n||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[SC(JSON.stringify({alg:"none",type:"JWT"})),SC(JSON.stringify(a)),""].join(".")}function Vs(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function IM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vs())}function C6(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class Bh extends Error{constructor(n,e,r){super(e),this.code=n,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Bh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d0.prototype.create)}}class d0{constructor(n,e,r){this.service=n,this.serviceName=e,this.errors=r}create(n,...e){const r=e[0]||{},i=`${this.service}/${n}`,o=this.errors[n],a=o?function tfe(t,n){return t.replace(nfe,(e,r)=>{const i=n[r];return null!=i?String(i):`<${r}?>`})}(o,r):"Error";return new Bh(i,`${this.serviceName}: ${a} (${i}).`,r)}}const nfe=/\{\$([^}]+)}/g;function h0(t){return JSON.parse(t)}function ts(t){return JSON.stringify(t)}const AC=function(t){let n={},e={},r={},i="";try{const o=t.split(".");n=h0(IC(o[0])||""),e=h0(IC(o[1])||""),i=o[2],r=e.d||{},delete e.d}catch{}return{header:n,claims:e,data:r,signature:i}};function bd(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function vy(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]}function kM(t){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n))return!1;return!0}function MC(t,n,e){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=n.call(e,t[i],i,t));return r}function RC(t,n){if(t===n)return!0;const e=Object.keys(t),r=Object.keys(n);for(const i of e){if(!r.includes(i))return!1;const o=t[i],a=n[i];if(D6(o)&&D6(a)){if(!RC(o,a))return!1}else if(o!==a)return!1}for(const i of r)if(!e.includes(i))return!1;return!0}function D6(t){return null!==t&&"object"==typeof t}function by(t){const n=[];for(const[e,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{n.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):n.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return n.length?"&"+n.join("&"):""}class ofe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(n,e){e||(e=0);const r=this.W_;if("string"==typeof n)for(let D=0;D<16;D++)r[D]=n.charCodeAt(e)<<24|n.charCodeAt(e+1)<<16|n.charCodeAt(e+2)<<8|n.charCodeAt(e+3),e+=4;else for(let D=0;D<16;D++)r[D]=n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3],e+=4;for(let D=16;D<80;D++){const A=r[D-3]^r[D-8]^r[D-14]^r[D-16];r[D]=4294967295&(A<<1|A>>>31)}let _,x,i=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],f=this.chain_[4];for(let D=0;D<80;D++){D<40?D<20?(_=c^o&(a^c),x=1518500249):(_=o^a^c,x=1859775393):D<60?(_=o&a|c&(o|a),x=2400959708):(_=o^a^c,x=3395469782);const A=(i<<5|i>>>27)+_+f+x+r[D]&4294967295;f=c,c=a,a=4294967295&(o<<30|o>>>2),o=i,i=A}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295}update(n,e){if(null==n)return;void 0===e&&(e=n.length);const r=e-this.blockSize;let i=0;const o=this.buf_;let a=this.inbuf_;for(;i<e;){if(0===a)for(;i<=r;)this.compress_(n,i),i+=this.blockSize;if("string"==typeof n){for(;i<e;)if(o[a]=n.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}else for(;i<e;)if(o[a]=n[i],++a,++i,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=e}digest(){const n=[];let e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)n[r]=this.chain_[i]>>o&255,++r;return n}}class afe{constructor(n,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{n(this)}).catch(r=>{this.error(r)})}next(n){this.forEachObserver(e=>{e.next(n)})}error(n){this.forEachObserver(e=>{e.error(n)}),this.close(n)}complete(){this.forEachObserver(n=>{n.complete()}),this.close()}subscribe(n,e,r){let i;if(void 0===n&&void 0===e&&void 0===r)throw new Error("Missing Observer.");i=function lfe(t,n){if("object"!=typeof t||null===t)return!1;for(const e of n)if(e in t&&"function"==typeof t[e])return!0;return!1}(n,["next","error","complete"])?n:{next:n,error:e,complete:r},void 0===i.next&&(i.next=AM),void 0===i.error&&(i.error=AM),void 0===i.complete&&(i.complete=AM);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(n){void 0===this.observers||void 0===this.observers[n]||(delete this.observers[n],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(n){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,n)}sendOne(n,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[n])try{e(this.observers[n])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(n){this.finalized||(this.finalized=!0,void 0!==n&&(this.finalError=n),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AM(){}function ag(t,n){return`${t} failed: ${n} argument `}const PC=function(t){let n=0;for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);r<128?n++:r<2048?n+=2:r>=55296&&r<=56319?(n+=4,e++):n+=3}return n};function Ao(t){return t&&t._delegate?t._delegate:t}class yp{constructor(n,e,r){this.name=n,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}const lg="[DEFAULT]";class mfe{constructor(n,e){this.name=n,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const e=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(e)){const r=new yy;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(n){var e;const r=this.normalizeInstanceIdentifier(n?.identifier),i=null!==(e=n?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,this.shouldAutoInitialize()){if(function _fe(t){return"EAGER"===t.instantiationMode}(n))try{this.getOrInitializeService({instanceIdentifier:lg})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(n=lg){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}delete(){var n=this;return fe(function*(){const e=Array.from(n.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(n=lg){return this.instances.has(n)}getOptions(n=lg){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:e={}}=n,r=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[o,a]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(o)&&a.resolve(i);return i}onInit(n,e){var r;const i=this.normalizeInstanceIdentifier(e),o=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;o.add(n),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&n(a,i),()=>{o.delete(n)}}invokeOnInitCallbacks(n,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(n,e)}catch{}}getOrInitializeService({instanceIdentifier:n,options:e={}}){let r=this.instances.get(n);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===lg?void 0:t),options:e}),this.instances.set(n,r),this.instancesOptions.set(n,e),this.invokeOnInitCallbacks(r,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,r)}catch{}var t;return r||null}normalizeInstanceIdentifier(n=lg){return this.component?this.component.multipleInstances?n:lg:n}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class yfe{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const e=this.getProvider(n.name);if(e.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);e.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const e=new mfe(n,this);return this.providers.set(n,e),e}getProviders(){return Array.from(this.providers.values())}}const MM=[];var Xr=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(Xr||{});const T6={debug:Xr.DEBUG,verbose:Xr.VERBOSE,info:Xr.INFO,warn:Xr.WARN,error:Xr.ERROR,silent:Xr.SILENT},vfe=Xr.INFO,bfe={[Xr.DEBUG]:"log",[Xr.VERBOSE]:"log",[Xr.INFO]:"info",[Xr.WARN]:"warn",[Xr.ERROR]:"error"},wfe=(t,n,...e)=>{if(n<t.logLevel)return;const r=(new Date).toISOString(),i=bfe[n];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`);console[i](`[${r}]  ${t.name}:`,...e)};class RM{constructor(n){this.name=n,this._logLevel=vfe,this._logHandler=wfe,this._userLogHandler=null,MM.push(this)}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in Xr))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel="string"==typeof n?T6[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if("function"!=typeof n)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,Xr.DEBUG,...n),this._logHandler(this,Xr.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,Xr.VERBOSE,...n),this._logHandler(this,Xr.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,Xr.INFO,...n),this._logHandler(this,Xr.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,Xr.WARN,...n),this._logHandler(this,Xr.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,Xr.ERROR,...n),this._logHandler(this,Xr.ERROR,...n)}}let S6,I6;const k6=new WeakMap,PM=new WeakMap,A6=new WeakMap,NM=new WeakMap,OM=new WeakMap;let LM={get(t,n,e){if(t instanceof IDBTransaction){if("done"===n)return PM.get(t);if("objectStoreNames"===n)return t.objectStoreNames||A6.get(t);if("store"===n)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return vp(t[n])},set:(t,n,e)=>(t[n]=e,!0),has:(t,n)=>t instanceof IDBTransaction&&("done"===n||"store"===n)||n in t};function kfe(t){return"function"==typeof t?function Ife(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Cfe(){return I6||(I6=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...n){return t.apply(FM(this),n),vp(k6.get(this))}:function(...n){return vp(t.apply(FM(this),n))}:function(n,...e){const r=t.call(FM(this),n,...e);return A6.set(r,n.sort?n.sort():[n]),vp(r)}}(t):(t instanceof IDBTransaction&&function Tfe(t){if(PM.has(t))return;const n=new Promise((e,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{e(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});PM.set(t,n)}(t),((t,n)=>n.some(e=>t instanceof e))(t,function Efe(){return S6||(S6=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,LM):t)}function vp(t){if(t instanceof IDBRequest)return function Dfe(t){const n=new Promise((e,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{e(vp(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return n.then(e=>{e instanceof IDBCursor&&k6.set(e,t)}).catch(()=>{}),OM.set(n,t),n}(t);if(NM.has(t))return NM.get(t);const n=kfe(t);return n!==t&&(NM.set(t,n),OM.set(n,t)),n}const FM=t=>OM.get(t),Mfe=["get","getKey","getAll","getAllKeys","count"],Rfe=["put","add","delete","clear"],BM=new Map;function M6(t,n){if(!(t instanceof IDBDatabase)||n in t||"string"!=typeof n)return;if(BM.get(n))return BM.get(n);const e=n.replace(/FromIndex$/,""),r=n!==e,i=Rfe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Mfe.includes(e))return;const o=function(){var a=fe(function*(c,...f){const _=this.transaction(c,i?"readwrite":"readonly");let x=_.store;return r&&(x=x.index(f.shift())),(yield Promise.all([x[e](...f),i&&_.done]))[0]});return function(f){return a.apply(this,arguments)}}();return BM.set(n,o),o}!function Sfe(t){LM=t(LM)}(t=>({...t,get:(n,e,r)=>M6(n,e)||t.get(n,e,r),has:(n,e)=>!!M6(n,e)||t.has(n,e)}));class Pfe{constructor(n){this.container=n}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Nfe(t){const n=t.getComponent();return"VERSION"===n?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const NC="@firebase/app",VM="0.10.13",Vh=new RM("@firebase/app"),Ofe="@firebase/app-compat",Lfe="@firebase/analytics-compat",Ffe="@firebase/analytics",Bfe="@firebase/app-check-compat",Vfe="@firebase/app-check",zfe="@firebase/auth",Ufe="@firebase/auth-compat",jfe="@firebase/database",Hfe="@firebase/data-connect",$fe="@firebase/database-compat",qfe="@firebase/functions",Gfe="@firebase/functions-compat",Wfe="@firebase/installations",Kfe="@firebase/installations-compat",Zfe="@firebase/messaging",Yfe="@firebase/messaging-compat",Xfe="@firebase/performance",Qfe="@firebase/performance-compat",Jfe="@firebase/remote-config",epe="@firebase/remote-config-compat",tpe="@firebase/storage",npe="@firebase/storage-compat",rpe="@firebase/firestore",ipe="@firebase/vertexai-preview",ope="@firebase/firestore-compat",spe="firebase",OC="[DEFAULT]",lpe={[NC]:"fire-core",[Ofe]:"fire-core-compat",[Ffe]:"fire-analytics",[Lfe]:"fire-analytics-compat",[Vfe]:"fire-app-check",[Bfe]:"fire-app-check-compat",[zfe]:"fire-auth",[Ufe]:"fire-auth-compat",[jfe]:"fire-rtdb",[Hfe]:"fire-data-connect",[$fe]:"fire-rtdb-compat",[qfe]:"fire-fn",[Gfe]:"fire-fn-compat",[Wfe]:"fire-iid",[Kfe]:"fire-iid-compat",[Zfe]:"fire-fcm",[Yfe]:"fire-fcm-compat",[Xfe]:"fire-perf",[Qfe]:"fire-perf-compat",[Jfe]:"fire-rc",[epe]:"fire-rc-compat",[tpe]:"fire-gcs",[npe]:"fire-gcs-compat",[rpe]:"fire-fst",[ope]:"fire-fst-compat",[ipe]:"fire-vertex","fire-js":"fire-js",[spe]:"fire-js-all"},cg=new Map,f0=new Map,p0=new Map;function R6(t,n){try{t.container.addComponent(n)}catch(e){Vh.debug(`Component ${n.name} failed to register with FirebaseApp ${t.name}`,e)}}function ug(t){const n=t.name;if(p0.has(n))return Vh.debug(`There were multiple attempts to register component ${n}.`),!1;p0.set(n,t);for(const e of cg.values())R6(e,t);for(const e of f0.values())R6(e,t);return!0}function m0(t,n){const e=t.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),t.container.getProvider(n)}function zh(t){return void 0!==t.settings}const kc=new d0("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class P6{constructor(n,e,r){this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(n){this.checkDestroyed(),this._automaticDataCollectionEnabled=n}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(n){this._isDeleted=n}checkDestroyed(){if(this.isDeleted)throw kc.create("app-deleted",{appName:this._name})}}const dg="10.14.1";function N6(t,n={}){let e=t;"object"!=typeof n&&(n={name:n});const r=Object.assign({name:OC,automaticDataCollectionEnabled:!1},n),i=r.name;if("string"!=typeof i||!i)throw kc.create("bad-app-name",{appName:String(i)});if(e||(e=w6()),!e)throw kc.create("no-options");const o=cg.get(i);if(o){if(RC(e,o.options)&&RC(r,o.config))return o;throw kc.create("duplicate-app",{appName:i})}const a=new yfe(i);for(const f of p0.values())a.addComponent(f);const c=new P6(e,r,a);return cg.set(i,c),c}function zM(t=OC){const n=cg.get(t);if(!n&&t===OC&&w6())return N6();if(!n)throw kc.create("no-app",{appName:t});return n}function _u(t,n,e){var r;let i=null!==(r=lpe[t])&&void 0!==r?r:t;e&&(i+=`-${e}`);const o=i.match(/\s|\//),a=n.match(/\s|\//);if(o||a){const c=[`Unable to register library "${i}" with version "${n}":`];return o&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&c.push("and"),a&&c.push(`version name "${n}" contains illegal characters (whitespace or "/")`),void Vh.warn(c.join(" "))}ug(new yp(`${i}-version`,()=>({library:i,version:n}),"VERSION"))}const g0="firebase-heartbeat-store";let jM=null;function O6(){return jM||(jM=function Afe(t,n,{blocked:e,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(t,n),c=vp(a);return r&&a.addEventListener("upgradeneeded",f=>{r(vp(a.result),f.oldVersion,f.newVersion,vp(a.transaction),f)}),e&&a.addEventListener("blocked",f=>e(f.oldVersion,f.newVersion,f)),c.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",_=>i(_.oldVersion,_.newVersion,_))}).catch(()=>{}),c}("firebase-heartbeat-database",1,{upgrade:(t,n)=>{if(0===n)try{t.createObjectStore(g0)}catch(e){console.warn(e)}}}).catch(t=>{throw kc.create("idb-open",{originalErrorMessage:t.message})})),jM}function HM(){return(HM=fe(function*(t){try{const e=(yield O6()).transaction(g0),r=yield e.objectStore(g0).get(F6(t));return yield e.done,r}catch(n){if(n instanceof Bh)Vh.warn(n.message);else{const e=kc.create("idb-get",{originalErrorMessage:n?.message});Vh.warn(e.message)}}})).apply(this,arguments)}function L6(t,n){return $M.apply(this,arguments)}function $M(){return($M=fe(function*(t,n){try{const r=(yield O6()).transaction(g0,"readwrite");yield r.objectStore(g0).put(n,F6(t)),yield r.done}catch(e){if(e instanceof Bh)Vh.warn(e.message);else{const r=kc.create("idb-set",{originalErrorMessage:e?.message});Vh.warn(r.message)}}})).apply(this,arguments)}function F6(t){return`${t.name}!${t.options.appId}`}class ype{constructor(n){this.container=n,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new bpe(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var n=this;return fe(function*(){var e,r;try{const o=n.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=B6();return null==(null===(e=n._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(n._heartbeatsCache=yield n._heartbeatsCachePromise,null==(null===(r=n._heartbeatsCache)||void 0===r?void 0:r.heartbeats))||n._heartbeatsCache.lastSentHeartbeatDate===a||n._heartbeatsCache.heartbeats.some(c=>c.date===a)?void 0:(n._heartbeatsCache.heartbeats.push({date:a,agent:o}),n._heartbeatsCache.heartbeats=n._heartbeatsCache.heartbeats.filter(c=>{const f=new Date(c.date).valueOf();return Date.now()-f<=2592e6}),n._storage.overwrite(n._heartbeatsCache))}catch(i){Vh.warn(i)}})()}getHeartbeatsHeader(){var n=this;return fe(function*(){var e;try{if(null===n._heartbeatsCache&&(yield n._heartbeatsCachePromise),null==(null===(e=n._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===n._heartbeatsCache.heartbeats.length)return"";const r=B6(),{heartbeatsToSend:i,unsentEntries:o}=function vpe(t,n=1024){const e=[];let r=t.slice();for(const i of t){const o=e.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),V6(e)>n){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),V6(e)>n){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(n._heartbeatsCache.heartbeats),a=SC(JSON.stringify({version:2,heartbeats:i}));return n._heartbeatsCache.lastSentHeartbeatDate=r,o.length>0?(n._heartbeatsCache.heartbeats=o,yield n._storage.overwrite(n._heartbeatsCache)):(n._heartbeatsCache.heartbeats=[],n._storage.overwrite(n._heartbeatsCache)),a}catch(r){return Vh.warn(r),""}})()}}function B6(){return(new Date).toISOString().substring(0,10)}class bpe{constructor(n){this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return fe(function*(){return!!function Qhe(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function Jhe(){return new Promise((t,n)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{var o;n((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(e){n(e)}})}().then(()=>!0).catch(()=>!1)})()}read(){var n=this;return fe(function*(){if(yield n._canUseIndexedDBPromise){const r=yield function mpe(t){return HM.apply(this,arguments)}(n.app);return r?.heartbeats?r:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(n){var e=this;return fe(function*(){var r;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return L6(e.app,{lastSentHeartbeatDate:null!==(r=n.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:n.heartbeats})}})()}add(n){var e=this;return fe(function*(){var r;if(yield e._canUseIndexedDBPromise){const o=yield e.read();return L6(e.app,{lastSentHeartbeatDate:null!==(r=n.lastSentHeartbeatDate)&&void 0!==r?r:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...n.heartbeats]})}})()}}function V6(t){return SC(JSON.stringify({version:2,heartbeats:t})).length}function LC(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]])}return e}!function wpe(t){ug(new yp("platform-logger",n=>new Pfe(n),"PRIVATE")),ug(new yp("heartbeat",n=>new ype(n),"PRIVATE")),_u(NC,VM,t),_u(NC,VM,"esm2017"),_u("fire-js","")}(""),_u("firebase","10.14.1","app"),"function"==typeof SuppressedError&&SuppressedError;const Qpe=function U6(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},j6=new d0("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),FC=new RM("@firebase/auth");function BC(t,...n){FC.logLevel<=Xr.ERROR&&FC.error(`Auth (${dg}): ${t}`,...n)}function ol(t,...n){throw XM(t,...n)}function ba(t,...n){return XM(t,...n)}function YM(t,n,e){const r=Object.assign(Object.assign({},Qpe()),{[n]:e});return new d0("auth","Firebase",r).create(n,{appName:t.name})}function ys(t){return YM(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XM(t,...n){if("string"!=typeof t){const e=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(e,...r)}return j6.create(t,...n)}function ft(t,n,...e){if(!t)throw XM(n,...e)}function wd(t){const n="INTERNAL ASSERTION FAILED: "+t;throw BC(n),new Error(n)}function Uh(t,n){t||wd(n)}function y0(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function H6(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function eme(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function QM(){return"http:"===H6()||"https:"===H6()}()||function Yhe(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class v0{constructor(n,e){this.shortDelay=n,this.longDelay=e,Uh(e>n,"Short delay should be less than long delay!"),this.isMobile=IM()||C6()}get(){return eme()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function JM(t,n){Uh(t.emulator,"Emulator should always be set here");const{url:e}=t.emulator;return n?`${e}${n.startsWith("/")?n.slice(1):n}`:e}class $6{static initialize(n,e,r){this.fetchImpl=n,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void wd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void wd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void wd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nme={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},rme=new v0(3e4,6e4);function xi(t,n){return t.tenantId&&!n.tenantId?Object.assign(Object.assign({},n),{tenantId:t.tenantId}):n}function Ei(t,n,e,r){return eR.apply(this,arguments)}function eR(){return(eR=fe(function*(t,n,e,r,i={}){return q6(t,i,fe(function*(){let o={},a={};r&&("GET"===n?a=r:o={body:JSON.stringify(r)});const c=by(Object.assign({key:t.config.apiKey},a)).slice(1),f=yield t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const _=Object.assign({method:n,headers:f},o);return function Zhe(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}()||(_.referrerPolicy="no-referrer"),$6.fetch()(G6(t,t.config.apiHost,e,c),_)}))})).apply(this,arguments)}function q6(t,n,e){return tR.apply(this,arguments)}function tR(){return(tR=fe(function*(t,n,e){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},nme),n);try{const i=new ome(t),o=yield Promise.race([e(),i.promise]);i.clearNetworkTimeout();const a=yield o.json();if("needConfirmation"in a)throw b0(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[f,_]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===f)throw b0(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===f)throw b0(t,"email-already-in-use",a);if("USER_DISABLED"===f)throw b0(t,"user-disabled",a);const x=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw YM(t,x,_);ol(t,x)}}catch(i){if(i instanceof Bh)throw i;ol(t,"network-request-failed",{message:String(i)})}})).apply(this,arguments)}function jh(t,n,e,r){return nR.apply(this,arguments)}function nR(){return(nR=fe(function*(t,n,e,r,i={}){const o=yield Ei(t,n,e,r,i);return"mfaPendingCredential"in o&&ol(t,"multi-factor-auth-required",{_serverResponse:o}),o})).apply(this,arguments)}function G6(t,n,e,r){const i=`${n}${e}?${r}`;return t.config.emulator?JM(t.config,i):`${t.config.apiScheme}://${i}`}class ome{constructor(n){this.auth=n,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(ba(this.auth,"network-request-failed")),rme.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function b0(t,n,e){const r={appName:t.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const i=ba(t,n,r);return i.customData._tokenResponse=e,i}function oR(){return(oR=fe(function*(t,n){return Ei(t,"POST","/v1/accounts:delete",n)})).apply(this,arguments)}function X6(t,n){return aR.apply(this,arguments)}function aR(){return(aR=fe(function*(t,n){return Ei(t,"POST","/v1/accounts:lookup",n)})).apply(this,arguments)}function w0(t){if(t)try{const n=new Date(Number(t));if(!isNaN(n.getTime()))return n.toUTCString()}catch{}}function lR(){return(lR=fe(function*(t,n=!1){const e=Ao(t),r=yield e.getIdToken(n),i=VC(r);ft(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:w0(cR(i.auth_time)),issuedAtTime:w0(cR(i.iat)),expirationTime:w0(cR(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})).apply(this,arguments)}function cR(t){return 1e3*Number(t)}function VC(t){const[n,e,r]=t.split(".");if(void 0===n||void 0===e||void 0===r)return BC("JWT malformed, contained fewer than 3 sections"),null;try{const i=IC(e);return i?JSON.parse(i):(BC("Failed to decode base64 JWT payload"),null)}catch(i){return BC("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Q6(t){const n=VC(t);return ft(n,"internal-error"),ft(typeof n.exp<"u","internal-error"),ft(typeof n.iat<"u","internal-error"),Number(n.exp)-Number(n.iat)}function Hh(t,n){return uR.apply(this,arguments)}function uR(){return(uR=fe(function*(t,n,e=!1){if(e)return n;try{return yield n}catch(r){throw r instanceof Bh&&function ume({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})).apply(this,arguments)}class dme{constructor(n){this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(n){var e;if(n){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const i=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(n=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(n);this.timerId=setTimeout(fe(function*(){yield e.iteration()}),r)}iteration(){var n=this;return fe(function*(){try{yield n.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&n.schedule(!0))}n.schedule()})()}}class dR{constructor(n,e){this.createdAt=n,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=w0(this.lastLoginAt),this.creationTime=w0(this.createdAt)}_copy(n){this.createdAt=n.createdAt,this.lastLoginAt=n.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function x0(t){return hR.apply(this,arguments)}function hR(){return(hR=fe(function*(t){var n;const e=t.auth,r=yield t.getIdToken(),i=yield Hh(t,X6(e,{idToken:r}));ft(i?.users.length,e,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const a=null!==(n=o.providerUserInfo)&&void 0!==n&&n.length?J6(o.providerUserInfo):[],c=function fme(t,n){return[...t.filter(r=>!n.some(i=>i.providerId===r.providerId)),...n]}(t.providerData,a),x=!!t.isAnonymous&&!(t.email&&o.passwordHash||c?.length),D={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new dR(o.createdAt,o.lastLoginAt),isAnonymous:x};Object.assign(t,D)})).apply(this,arguments)}function fR(){return(fR=fe(function*(t){const n=Ao(t);yield x0(n),yield n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)})).apply(this,arguments)}function J6(t){return t.map(n=>{var{providerId:e}=n,r=LC(n,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function pR(){return(pR=fe(function*(t,n){const e=yield q6(t,{},fe(function*(){const r=by({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=G6(t,i,"/v1/token",`key=${o}`),c=yield t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",$6.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}})).apply(this,arguments)}function mR(){return(mR=fe(function*(t,n){return Ei(t,"POST","/v2/accounts:revokeToken",xi(t,n))})).apply(this,arguments)}class xy{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(n){ft(n.idToken,"internal-error"),ft(typeof n.idToken<"u","internal-error"),ft(typeof n.refreshToken<"u","internal-error");const e="expiresIn"in n&&typeof n.expiresIn<"u"?Number(n.expiresIn):Q6(n.idToken);this.updateTokensAndExpiration(n.idToken,n.refreshToken,e)}updateFromIdToken(n){ft(0!==n.length,"internal-error");const e=Q6(n);this.updateTokensAndExpiration(n,null,e)}getToken(n){var e=this;return fe(function*(r,i=!1){return i||!e.accessToken||e.isExpired?(ft(e.refreshToken,r,"user-token-expired"),e.refreshToken?(yield e.refresh(r,e.refreshToken),e.accessToken):null):e.accessToken}).apply(this,arguments)}clearRefreshToken(){this.refreshToken=null}refresh(n,e){var r=this;return fe(function*(){const{accessToken:i,refreshToken:o,expiresIn:a}=yield function pme(t,n){return pR.apply(this,arguments)}(n,e);r.updateTokensAndExpiration(i,o,Number(a))})()}updateTokensAndExpiration(n,e,r){this.refreshToken=e||null,this.accessToken=n||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(n,e){const{refreshToken:r,accessToken:i,expirationTime:o}=e,a=new xy;return r&&(ft("string"==typeof r,"internal-error",{appName:n}),a.refreshToken=r),i&&(ft("string"==typeof i,"internal-error",{appName:n}),a.accessToken=i),o&&(ft("number"==typeof o,"internal-error",{appName:n}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(n){this.accessToken=n.accessToken,this.refreshToken=n.refreshToken,this.expirationTime=n.expirationTime}_clone(){return Object.assign(new xy,this.toJSON())}_performRefresh(){return wd("not implemented")}}function bp(t,n){ft("string"==typeof t||typeof t>"u","internal-error",{appName:n})}class $h{constructor(n){var{uid:e,auth:r,stsTokenManager:i}=n,o=LC(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new dme(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new dR(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(n){var e=this;return fe(function*(){const r=yield Hh(e,e.stsTokenManager.getToken(e.auth,n));return ft(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(n){return function cme(t){return lR.apply(this,arguments)}(this,n)}reload(){return function hme(t){return fR.apply(this,arguments)}(this)}_assign(n){this!==n&&(ft(this.uid===n.uid,this.auth,"internal-error"),this.displayName=n.displayName,this.photoURL=n.photoURL,this.email=n.email,this.emailVerified=n.emailVerified,this.phoneNumber=n.phoneNumber,this.isAnonymous=n.isAnonymous,this.tenantId=n.tenantId,this.providerData=n.providerData.map(e=>Object.assign({},e)),this.metadata._copy(n.metadata),this.stsTokenManager._assign(n.stsTokenManager))}_clone(n){const e=new $h(Object.assign(Object.assign({},this),{auth:n,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(n){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=n,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(n){this.reloadListener?this.reloadListener(n):this.reloadUserInfo=n}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(n){var e=this;return fe(function*(r,i=!1){let o=!1;r.idToken&&r.idToken!==e.stsTokenManager.accessToken&&(e.stsTokenManager.updateFromServerResponse(r),o=!0),i&&(yield x0(e)),yield e.auth._persistUserIfCurrent(e),o&&e.auth._notifyListenersIfCurrent(e)}).apply(this,arguments)}delete(){var n=this;return fe(function*(){if(zh(n.auth.app))return Promise.reject(ys(n.auth));const e=yield n.getIdToken();return yield Hh(n,function ame(t,n){return oR.apply(this,arguments)}(n.auth,{idToken:e})),n.stsTokenManager.clearRefreshToken(),n.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(n=>Object.assign({},n)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(n,e){var r,i,o,a,c,f,_,x;const D=null!==(r=e.displayName)&&void 0!==r?r:void 0,A=null!==(i=e.email)&&void 0!==i?i:void 0,N=null!==(o=e.phoneNumber)&&void 0!==o?o:void 0,B=null!==(a=e.photoURL)&&void 0!==a?a:void 0,te=null!==(c=e.tenantId)&&void 0!==c?c:void 0,ce=null!==(f=e._redirectEventId)&&void 0!==f?f:void 0,we=null!==(_=e.createdAt)&&void 0!==_?_:void 0,Ce=null!==(x=e.lastLoginAt)&&void 0!==x?x:void 0,{uid:We,emailVerified:Se,isAnonymous:Ee,providerData:Be,stsTokenManager:Xe}=e;ft(We&&Xe,n,"internal-error");const mt=xy.fromJSON(this.name,Xe);ft("string"==typeof We,n,"internal-error"),bp(D,n.name),bp(A,n.name),ft("boolean"==typeof Se,n,"internal-error"),ft("boolean"==typeof Ee,n,"internal-error"),bp(N,n.name),bp(B,n.name),bp(te,n.name),bp(ce,n.name),bp(we,n.name),bp(Ce,n.name);const sn=new $h({uid:We,auth:n,email:A,emailVerified:Se,displayName:D,isAnonymous:Ee,photoURL:B,phoneNumber:N,tenantId:te,stsTokenManager:mt,createdAt:we,lastLoginAt:Ce});return Be&&Array.isArray(Be)&&(sn.providerData=Be.map(cn=>Object.assign({},cn))),ce&&(sn._redirectEventId=ce),sn}static _fromIdTokenResponse(n,e){return fe(function*(r,i,o=!1){const a=new xy;a.updateFromServerResponse(i);const c=new $h({uid:i.localId,auth:r,stsTokenManager:a,isAnonymous:o});return yield x0(c),c}).apply(this,arguments)}static _fromGetAccountInfoResponse(n,e,r){return fe(function*(){const i=e.users[0];ft(void 0!==i.localId,"internal-error");const o=void 0!==i.providerUserInfo?J6(i.providerUserInfo):[],a=!(i.email&&i.passwordHash||o?.length),c=new xy;c.updateFromIdToken(r);const f=new $h({uid:i.localId,auth:n,stsTokenManager:c,isAnonymous:a}),_={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new dR(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||o?.length)};return Object.assign(f,_),f})()}}const e8=new Map;function qh(t){Uh(t instanceof Function,"Expected a class definition");let n=e8.get(t);return n?(Uh(n instanceof t,"Instance stored in cache mismatched with class"),n):(n=new t,e8.set(t,n),n)}const t8=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return fe(function*(){return!0})()}_set(e,r){var i=this;return fe(function*(){i.storage[e]=r})()}_get(e){var r=this;return fe(function*(){const i=r.storage[e];return void 0===i?null:i})()}_remove(e){var r=this;return fe(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return t.type="NONE",t})();function zC(t,n,e){return`firebase:${t}:${n}:${e}`}class Ey{constructor(n,e,r){this.persistence=n,this.auth=e,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=zC(this.userKey,i.apiKey,o),this.fullPersistenceKey=zC("persistence",i.apiKey,o),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(n){return this.persistence._set(this.fullUserKey,n.toJSON())}getCurrentUser(){var n=this;return fe(function*(){const e=yield n.persistence._get(n.fullUserKey);return e?$h._fromJSON(n.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(n){var e=this;return fe(function*(){if(e.persistence===n)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=n,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(n,e){return fe(function*(r,i,o="authUser"){if(!i.length)return new Ey(qh(t8),r,o);const a=(yield Promise.all(i.map(function(){var D=fe(function*(A){if(yield A._isAvailable())return A});return function(A){return D.apply(this,arguments)}}()))).filter(D=>D);let c=a[0]||qh(t8);const f=zC(o,r.config.apiKey,r.name);let _=null;for(const D of i)try{const A=yield D._get(f);if(A){const N=$h._fromJSON(r,A);D!==c&&(_=N),c=D;break}}catch{}const x=a.filter(D=>D._shouldAllowMigration);return c._shouldAllowMigration&&x.length?(c=x[0],_&&(yield c._set(f,_.toJSON())),yield Promise.all(i.map(function(){var D=fe(function*(A){if(A!==c)try{yield A._remove(f)}catch{}});return function(A){return D.apply(this,arguments)}}())),new Ey(c,r,o)):new Ey(c,r,o)}).apply(this,arguments)}}function n8(t){const n=t.toLowerCase();if(n.includes("opera/")||n.includes("opr/")||n.includes("opios/"))return"Opera";if(s8(n))return"IEMobile";if(n.includes("msie")||n.includes("trident/"))return"IE";if(n.includes("edge/"))return"Edge";if(r8(n))return"Firefox";if(n.includes("silk/"))return"Silk";if(l8(n))return"Blackberry";if(c8(n))return"Webos";if(i8(n))return"Safari";if((n.includes("chrome/")||o8(n))&&!n.includes("edge/"))return"Chrome";if(a8(n))return"Android";{const r=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function r8(t=Vs()){return/firefox\//i.test(t)}function i8(t=Vs()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function o8(t=Vs()){return/crios\//i.test(t)}function s8(t=Vs()){return/iemobile/i.test(t)}function a8(t=Vs()){return/android/i.test(t)}function l8(t=Vs()){return/blackberry/i.test(t)}function c8(t=Vs()){return/webos/i.test(t)}function gR(t=Vs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function u8(t=Vs()){return gR(t)||a8(t)||c8(t)||l8(t)||/windows phone/i.test(t)||s8(t)}function d8(t,n=[]){let e;switch(t){case"Browser":e=n8(Vs());break;case"Worker":e=`${n8(Vs())}-${t}`;break;default:e=t}const r=n.length?n.join(","):"FirebaseCore-web";return`${e}/JsCore/${dg}/${r}`}class yme{constructor(n){this.auth=n,this.queue=[]}pushCallback(n,e){const r=o=>new Promise((a,c)=>{try{a(n(o))}catch(f){c(f)}});r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(n){var e=this;return fe(function*(){if(e.auth.currentUser===n)return;const r=[];try{for(const i of e.queue)yield i(n),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const o of r)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}function _R(){return(_R=fe(function*(t,n={}){return Ei(t,"GET","/v2/passwordPolicy",xi(t,n))})).apply(this,arguments)}class wme{constructor(n){var e,r,i,o;const a=n.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=a.minPasswordLength)&&void 0!==e?e:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=n.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(r=n.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(o=n.forceUpgradeOnSignin)&&void 0!==o&&o,this.schemaVersion=n.schemaVersion}validatePassword(n){var e,r,i,o,a,c;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(n,f),this.validatePasswordCharacterOptions(n,f),f.isValid&&(f.isValid=null===(e=f.meetsMinPasswordLength)||void 0===e||e),f.isValid&&(f.isValid=null===(r=f.meetsMaxPasswordLength)||void 0===r||r),f.isValid&&(f.isValid=null===(i=f.containsLowercaseLetter)||void 0===i||i),f.isValid&&(f.isValid=null===(o=f.containsUppercaseLetter)||void 0===o||o),f.isValid&&(f.isValid=null===(a=f.containsNumericCharacter)||void 0===a||a),f.isValid&&(f.isValid=null===(c=f.containsNonAlphanumericCharacter)||void 0===c||c),f}validatePasswordLengthOptions(n,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=n.length>=r),i&&(e.meetsMaxPasswordLength=n.length<=i)}validatePasswordCharacterOptions(n,e){let r;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<n.length;i++)r=n.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(n,e,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(n.containsLowercaseLetter||(n.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(n.containsUppercaseLetter||(n.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(n.containsNumericCharacter||(n.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(n.containsNonAlphanumericCharacter||(n.containsNonAlphanumericCharacter=o))}}class xme{constructor(n,e,r,i){this.app=n,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new h8(this),this.idTokenSubscription=new h8(this),this.beforeStateQueue=new yme(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j6,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(n,e){var r=this;return e&&(this._popupRedirectResolver=qh(e)),this._initializationPromise=this.queue(fe(function*(){var i,o;if(!r._deleted&&(r.persistenceManager=yield Ey.create(r,n),!r._deleted)){if(null!==(i=r._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var n=this;return fe(function*(){if(n._deleted)return;const e=yield n.assertedPersistence.getCurrentUser();if(n.currentUser||e){if(n.currentUser&&e&&n.currentUser.uid===e.uid)return n._currentUser._assign(e),void(yield n.currentUser.getIdToken());yield n._updateCurrentUser(e,!0)}})()}initializeCurrentUserFromIdToken(n){var e=this;return fe(function*(){try{const r=yield X6(e,{idToken:n}),i=yield $h._fromGetAccountInfoResponse(e,r,n);yield e.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield e.directlySetCurrentUser(null)}})()}initializeCurrentUser(n){var e=this;return fe(function*(){var r;if(zh(e.app)){const c=e.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>e.initializeCurrentUserFromIdToken(c).then(f,f))}):e.directlySetCurrentUser(null)}const i=yield e.assertedPersistence.getCurrentUser();let o=i,a=!1;if(n&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,f=o?._redirectEventId,_=yield e.tryRedirectSignIn(n);(!c||c===f)&&_?.user&&(o=_.user,a=!0)}if(!o)return e.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{yield e.beforeStateQueue.runMiddleware(o)}catch(c){o=i,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return o?e.reloadAndSetCurrentUserOrClear(o):e.directlySetCurrentUser(null)}return ft(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===o._redirectEventId?e.directlySetCurrentUser(o):e.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(n){var e=this;return fe(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,n,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(n){var e=this;return fe(function*(){try{yield x0(n)}catch(r){if("auth/network-request-failed"!==r?.code)return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(n)})()}useDeviceLanguage(){this.languageCode=function tme(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}_delete(){var n=this;return fe(function*(){n._deleted=!0})()}updateCurrentUser(n){var e=this;return fe(function*(){if(zh(e.app))return Promise.reject(ys(e));const r=n?Ao(n):null;return r&&ft(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(n){var e=this;return fe(function*(r,i=!1){if(!e._deleted)return r&&ft(e.tenantId===r.tenantId,e,"tenant-id-mismatch"),i||(yield e.beforeStateQueue.runMiddleware(r)),e.queue(fe(function*(){yield e.directlySetCurrentUser(r),e.notifyAuthListeners()}))}).apply(this,arguments)}signOut(){var n=this;return fe(function*(){return zh(n.app)?Promise.reject(ys(n)):(yield n.beforeStateQueue.runMiddleware(null),(n.redirectPersistenceManager||n._popupRedirectResolver)&&(yield n._setRedirectUser(null)),n._updateCurrentUser(null,!0))})()}setPersistence(n){var e=this;return zh(this.app)?Promise.reject(ys(this)):this.queue(fe(function*(){yield e.assertedPersistence.setPersistence(qh(n))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(n){var e=this;return fe(function*(){e._getPasswordPolicyInternal()||(yield e._updatePasswordPolicy());const r=e._getPasswordPolicyInternal();return r.schemaVersion!==e.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(e._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(n)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var n=this;return fe(function*(){const e=yield function vme(t){return _R.apply(this,arguments)}(n),r=new wme(e);null===n.tenantId?n._projectPasswordPolicy=r:n._tenantPasswordPolicies[n.tenantId]=r})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(n){this._errorFactory=new d0("auth","Firebase",n())}onAuthStateChanged(n,e,r){return this.registerStateListener(this.authStateSubscription,n,e,r)}beforeAuthStateChanged(n,e){return this.beforeStateQueue.pushCallback(n,e)}onIdTokenChanged(n,e,r){return this.registerStateListener(this.idTokenSubscription,n,e,r)}authStateReady(){return new Promise((n,e)=>{if(this.currentUser)n();else{const r=this.onAuthStateChanged(()=>{r(),n()},e)}})}revokeAccessToken(n){var e=this;return fe(function*(){if(e.currentUser){const r=yield e.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:n,idToken:r};null!=e.tenantId&&(i.tenantId=e.tenantId),yield function mme(t,n){return mR.apply(this,arguments)}(e,i)}})()}toJSON(){var n;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(n=this._currentUser)||void 0===n?void 0:n.toJSON()}}_setRedirectUser(n,e){var r=this;return fe(function*(){const i=yield r.getOrInitRedirectPersistenceManager(e);return null===n?i.removeCurrentUser():i.setCurrentUser(n)})()}getOrInitRedirectPersistenceManager(n){var e=this;return fe(function*(){if(!e.redirectPersistenceManager){const r=n&&qh(n)||e._popupRedirectResolver;ft(r,e,"argument-error"),e.redirectPersistenceManager=yield Ey.create(e,[qh(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(n){var e=this;return fe(function*(){var r,i;return e._isInitialized&&(yield e.queue(fe(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===n?e._currentUser:(null===(i=e.redirectUser)||void 0===i?void 0:i._redirectEventId)===n?e.redirectUser:null})()}_persistUserIfCurrent(n){var e=this;return fe(function*(){if(n===e.currentUser)return e.queue(fe(function*(){return e.directlySetCurrentUser(n)}))})()}_notifyListenersIfCurrent(n){n===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(n=this.currentUser)||void 0===n?void 0:n.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(n,e,r,i){if(this._deleted)return()=>{};const o="function"==typeof e?e:e.next.bind(e);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),"function"==typeof e){const f=n.addObserver(e,r,i);return()=>{a=!0,f()}}{const f=n.addObserver(e);return()=>{a=!0,f()}}}directlySetCurrentUser(n){var e=this;return fe(function*(){e.currentUser&&e.currentUser!==n&&e._currentUser._stopProactiveRefresh(),n&&e.isProactiveRefreshEnabled&&n._startProactiveRefresh(),e.currentUser=n,n?yield e.assertedPersistence.setCurrentUser(n):yield e.assertedPersistence.removeCurrentUser()})()}queue(n){return this.operations=this.operations.then(n,n),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(n){!n||this.frameworks.includes(n)||(this.frameworks.push(n),this.frameworks.sort(),this.clientVersion=d8(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var n=this;return fe(function*(){var e;const r={"X-Client-Version":n.clientVersion};n.app.options.appId&&(r["X-Firebase-gmpid"]=n.app.options.appId);const i=yield null===(e=n.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();i&&(r["X-Firebase-Client"]=i);const o=yield n._getAppCheckToken();return o&&(r["X-Firebase-AppCheck"]=o),r})()}_getAppCheckToken(){var n=this;return fe(function*(){var e;const r=yield null===(e=n.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken();return r?.error&&function Jpe(t,...n){FC.logLevel<=Xr.WARN&&FC.warn(`Auth (${dg}): ${t}`,...n)}(`Error while retrieving App Check token: ${r.error}`),r?.token})()}}function Mo(t){return Ao(t)}class h8{constructor(n){this.auth=n,this.observer=null,this.addObserver=function sfe(t,n){const e=new afe(t,n);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let E0={loadJS:()=>fe(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function f8(t){return`__${t}${Math.floor(1e6*Math.random())}`}function g8(t){const n=t.indexOf(":");return n<0?"":t.substr(0,n+1)}function _8(t){if(!t)return null;const n=Number(t);return isNaN(n)?null:n}class D0{constructor(n,e){this.providerId=n,this.signInMethod=e}toJSON(){return wd("not implemented")}_getIdTokenResponse(n){return wd("not implemented")}_linkToIdToken(n,e){return wd("not implemented")}_getReauthenticationResolver(n){return wd("not implemented")}}function Gh(t,n){return OR.apply(this,arguments)}function OR(){return(OR=fe(function*(t,n){return jh(t,"POST","/v1/accounts:signInWithIdp",xi(t,n))})).apply(this,arguments)}class Cy extends D0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(n){const e=new Cy(n.providerId,n.signInMethod);return n.idToken||n.accessToken?(n.idToken&&(e.idToken=n.idToken),n.accessToken&&(e.accessToken=n.accessToken),n.nonce&&!n.pendingToken&&(e.nonce=n.nonce),n.pendingToken&&(e.pendingToken=n.pendingToken)):n.oauthToken&&n.oauthTokenSecret?(e.accessToken=n.oauthToken,e.secret=n.oauthTokenSecret):ol("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(n){const e="string"==typeof n?JSON.parse(n):n,{providerId:r,signInMethod:i}=e,o=LC(e,["providerId","signInMethod"]);if(!r||!i)return null;const a=new Cy(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(n){return Gh(n,this.buildRequest())}_linkToIdToken(n,e){const r=this.buildRequest();return r.idToken=e,Gh(n,r)}_getReauthenticationResolver(n){const e=this.buildRequest();return e.autoCreate=!1,Gh(n,e)}buildRequest(){const n={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)n.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),n.postBody=by(e)}return n}}class Wh{constructor(n){this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(n){this.defaultLanguageCode=n}setCustomParameters(n){return this.customParameters=n,this}getCustomParameters(){return this.customParameters}}class b8 extends Wh{constructor(){super(...arguments),this.scopes=[]}addScope(n){return this.scopes.includes(n)||this.scopes.push(n),this}getScopes(){return[...this.scopes]}}let w8=(()=>{class t extends b8{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Cy._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return t.credentialFromTaggedObject(e)}static credentialFromError(e){return t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:i}=e;if(!r&&!i)return null;try{return t.credential(r,i)}catch{return null}}}return t.GOOGLE_SIGN_IN_METHOD="google.com",t.PROVIDER_ID="google.com",t})();class Ac{constructor(n){this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}static _fromIdTokenResponse(n,e,r){return fe(function*(i,o,a,c=!1){const f=yield $h._fromIdTokenResponse(i,a,c),_=E8(a);return new Ac({user:f,providerId:_,_tokenResponse:a,operationType:o})}).apply(this,arguments)}static _forOperation(n,e,r){return fe(function*(){yield n._updateTokensIfNecessary(r,!0);const i=E8(r);return new Ac({user:n,providerId:i,_tokenResponse:r,operationType:e})})()}}function E8(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class $C extends Bh{constructor(n,e,r,i){var o;super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,$C.prototype),this.customData={appName:n.name,tenantId:null!==(o=n.tenantId)&&void 0!==o?o:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(n,e,r,i){return new $C(n,e,r,i)}}function C8(t,n,e,r){return("reauthenticate"===n?e._getReauthenticationResolver(t):e._getIdTokenResponse(t)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?$C._fromErrorAndOperation(t,o,n,r):o})}function $R(t,n){return qR.apply(this,arguments)}function qR(){return(qR=fe(function*(t,n,e=!1){const r=yield Hh(t,n._linkToIdToken(t.auth,yield t.getIdToken()),e);return Ac._forOperation(t,"link",r)})).apply(this,arguments)}function T8(t,n){return WR.apply(this,arguments)}function WR(){return(WR=fe(function*(t,n,e=!1){const{auth:r}=t;if(zh(r.app))return Promise.reject(ys(r));const i="reauthenticate";try{const o=yield Hh(t,C8(r,i,n,t),e);ft(o.idToken,r,"internal-error");const a=VC(o.idToken);ft(a,r,"internal-error");const{sub:c}=a;return ft(t.uid===c,r,"user-mismatch"),Ac._forOperation(t,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&ol(r,"user-mismatch"),o}})).apply(this,arguments)}function S8(t,n){return KR.apply(this,arguments)}function KR(){return(KR=fe(function*(t,n,e=!1){if(zh(t.app))return Promise.reject(ys(t));const r="signIn",i=yield C8(t,r,n),o=yield Ac._fromIdTokenResponse(t,r,i);return e||(yield t._updateCurrentUser(o.user)),o})).apply(this,arguments)}function WC(t,n,e,r){return Ao(t).onAuthStateChanged(n,e,r)}const KC="__sak";class A8{constructor(n,e){this.storageRetriever=n,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(KC,"1"),this.storage.removeItem(KC),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(n,e){return this.storage.setItem(n,JSON.stringify(e)),Promise.resolve()}_get(n){const e=this.storage.getItem(n);return Promise.resolve(e?JSON.parse(e):null)}_remove(n){return this.storage.removeItem(n),Promise.resolve()}get storage(){return this.storageRetriever()}}const wge=(()=>{class t extends A8{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=u8(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),o=this.localCache[r];i!==o&&e(r,o,i)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,f,_)=>{this.notifyListeners(c,_)});const i=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);!function _me(){return function Xhe(){const t=Vs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}()||a===e.newValue||e.newValue===e.oldValue?o():setTimeout(o,10)}notifyListeners(e,r){this.localCache[e]=r;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var i=()=>super._set,o=this;return fe(function*(){yield i().call(o,e,r),o.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,i=this;return fe(function*(){const o=yield r().call(i,e);return i.localCache[e]=JSON.stringify(o),o})()}_remove(e){var r=()=>super._remove,i=this;return fe(function*(){yield r().call(i,e),delete i.localCache[e]})()}}return t.type="LOCAL",t})(),M8=(()=>{class t extends A8{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return t.type="SESSION",t})();let Ege=(()=>{class t{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const i=new t(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return fe(function*(){const i=e,{eventId:o,eventType:a,data:c}=i.data,f=r.handlersMap[a];if(!f?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:a});const _=Array.from(f).map(function(){var D=fe(function*(A){return A(i.origin,c)});return function(A){return D.apply(this,arguments)}}()),x=yield function xge(t){return Promise.all(t.map(function(){var n=fe(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return n.apply(this,arguments)}}()))}(_);i.ports[0].postMessage({status:"done",eventId:o,eventType:a,response:x})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return t.receivers=[],t})();function ZC(t="",n=10){let e="";for(let r=0;r<n;r++)e+=Math.floor(10*Math.random());return t+e}class Cge{constructor(n){this.target=n,this.handlers=new Set}removeMessageHandler(n){n.messageChannel&&(n.messageChannel.port1.removeEventListener("message",n.onMessage),n.messageChannel.port1.close()),this.handlers.delete(n)}_send(n,e){var r=this;return fe(function*(i,o,a=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let f,_;return new Promise((x,D)=>{const A=ZC("",20);c.port1.start();const N=setTimeout(()=>{D(new Error("unsupported_event"))},a);_={messageChannel:c,onMessage(B){const te=B;if(te.data.eventId===A)switch(te.data.status){case"ack":clearTimeout(N),f=setTimeout(()=>{D(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),x(te.data.response);break;default:clearTimeout(N),clearTimeout(f),D(new Error("invalid_response"))}}},r.handlers.add(_),c.port1.addEventListener("message",_.onMessage),r.target.postMessage({eventType:i,eventId:A,data:o},[c.port2])}).finally(()=>{_&&r.removeMessageHandler(_)})}).apply(this,arguments)}}function Wo(){return window}function DP(){return typeof Wo().WorkerGlobalScope<"u"&&"function"==typeof Wo().importScripts}function TP(){return(TP=fe(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const R8="firebaseLocalStorageDb",YC="firebaseLocalStorage",P8="fbase_key";class k0{constructor(n){this.request=n}toPromise(){return new Promise((n,e)=>{this.request.addEventListener("success",()=>{n(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function XC(t,n){return t.transaction([YC],n?"readwrite":"readonly").objectStore(YC)}function SP(){const t=indexedDB.open(R8,1);return new Promise((n,e)=>{t.addEventListener("error",()=>{e(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(YC,{keyPath:P8})}catch(i){e(i)}}),t.addEventListener("success",fe(function*(){const r=t.result;r.objectStoreNames.contains(YC)?n(r):(r.close(),yield function Age(){const t=indexedDB.deleteDatabase(R8);return new k0(t).toPromise()}(),n(yield SP()))}))})}function N8(t,n,e){return IP.apply(this,arguments)}function IP(){return(IP=fe(function*(t,n,e){const r=XC(t,!0).put({[P8]:n,value:e});return new k0(r).toPromise()})).apply(this,arguments)}function kP(){return(kP=fe(function*(t,n){const e=XC(t,!1).get(n),r=yield new k0(e).toPromise();return void 0===r?null:r.value})).apply(this,arguments)}function O8(t,n){const e=XC(t,!0).delete(n);return new k0(e).toPromise()}const Nge=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return fe(function*(){return e.db||(e.db=yield SP()),e.db})()}_withRetries(e){var r=this;return fe(function*(){let i=0;for(;;)try{const o=yield r._openDb();return yield e(o)}catch(o){if(i++>3)throw o;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return fe(function*(){return DP()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return fe(function*(){e.receiver=Ege._getInstance(function Ige(){return DP()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=fe(function*(i,o){return{keyProcessed:(yield e._poll()).includes(o.key)}});return function(i,o){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=fe(function*(i,o){return["keyChanged"]});return function(i,o){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return fe(function*(){var r,i;if(e.activeServiceWorker=yield function Tge(){return TP.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new Cge(e.activeServiceWorker);const o=yield e.sender._send("ping",{},800);o&&null!==(r=o[0])&&void 0!==r&&r.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return fe(function*(){if(r.sender&&r.activeServiceWorker&&function Sge(){var t;return(null===(t=navigator?.serviceWorker)||void 0===t?void 0:t.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return fe(function*(){try{if(!indexedDB)return!1;const e=yield SP();return yield N8(e,KC,"1"),yield O8(e,KC),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return fe(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var i=this;return fe(function*(){return i._withPendingWrite(fe(function*(){return yield i._withRetries(o=>N8(o,e,r)),i.localCache[e]=r,i.notifyServiceWorker(e)}))})()}_get(e){var r=this;return fe(function*(){const i=yield r._withRetries(o=>function Mge(t,n){return kP.apply(this,arguments)}(o,e));return r.localCache[e]=i,i})()}_remove(e){var r=this;return fe(function*(){return r._withPendingWrite(fe(function*(){return yield r._withRetries(i=>O8(i,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return fe(function*(){const r=yield e._withRetries(a=>{const c=XC(a,!1).getAll();return new k0(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const i=[],o=new Set;if(0!==r.length)for(const{fbase_key:a,value:c}of r)o.add(a),JSON.stringify(e.localCache[a])!==JSON.stringify(c)&&(e.notifyListeners(a,c),i.push(a));for(const a of Object.keys(e.localCache))e.localCache[a]&&!o.has(a)&&(e.notifyListeners(a,null),i.push(a));return i})()}notifyListeners(e,r){this.localCache[e]=r;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(fe(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return t.type="LOCAL",t})();function fg(t,n){return n?qh(n):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}f8("rcb"),new v0(3e4,6e4);class BP extends D0{constructor(n){super("custom","custom"),this.params=n}_getIdTokenResponse(n){return Gh(n,this._buildIdpRequest())}_linkToIdToken(n,e){return Gh(n,this._buildIdpRequest(e))}_getReauthenticationResolver(n){return Gh(n,this._buildIdpRequest())}_buildIdpRequest(n){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return n&&(e.idToken=n),e}}function Zge(t){return S8(t.auth,new BP(t),t.bypassAuthState)}function Yge(t){const{auth:n,user:e}=t;return ft(e,n,"internal-error"),T8(e,new BP(t),t.bypassAuthState)}function Xge(t){return VP.apply(this,arguments)}function VP(){return(VP=fe(function*(t){const{auth:n,user:e}=t;return ft(e,n,"internal-error"),$R(e,new BP(t),t.bypassAuthState)})).apply(this,arguments)}class F8{constructor(n,e,r,i,o=!1){this.auth=n,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var n=this;return new Promise(function(){var e=fe(function*(r,i){n.pendingPromise={resolve:r,reject:i};try{n.eventManager=yield n.resolver._initialize(n.auth),yield n.onExecution(),n.eventManager.registerConsumer(n)}catch(o){n.reject(o)}});return function(r,i){return e.apply(this,arguments)}}())}onAuthEvent(n){var e=this;return fe(function*(){const{urlResponse:r,sessionId:i,postBody:o,tenantId:a,error:c,type:f}=n;if(c)return void e.reject(c);const _={auth:e.auth,requestUri:r,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(f)(_))}catch(x){e.reject(x)}})()}onError(n){this.reject(n)}getIdpTask(n){switch(n){case"signInViaPopup":case"signInViaRedirect":return Zge;case"linkViaPopup":case"linkViaRedirect":return Xge;case"reauthViaPopup":case"reauthViaRedirect":return Yge;default:ol(this.auth,"internal-error")}}resolve(n){Uh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(n),this.unregisterAndCleanUp()}reject(n){Uh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(n),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Qge=new v0(2e3,1e4);function zP(){return(zP=fe(function*(t,n,e){if(zh(t.app))return Promise.reject(ba(t,"operation-not-supported-in-this-environment"));const r=Mo(t);!function wy(t,n,e){if(!(n instanceof e))throw e.name!==n.constructor.name&&ol(t,"argument-error"),YM(t,"argument-error",`Type of ${n.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,n,Wh);const i=fg(r,e);return new HP(r,"signInViaPopup",n,i).executeNotNull()})).apply(this,arguments)}let HP=(()=>{class t extends F8{constructor(e,r,i,o,a){super(e,r,o,a),this.provider=i,this.authWindow=null,this.pollId=null,t.currentPopupAction&&t.currentPopupAction.cancel(),t.currentPopupAction=this}executeNotNull(){var e=this;return fe(function*(){const r=yield e.execute();return ft(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return fe(function*(){Uh(1===e.filter.length,"Popup operations only handle one event");const r=ZC();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(i=>{e.reject(i)}),e.resolver._isIframeWebStorageSupported(e.auth,i=>{i||e.reject(ba(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ba(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,t.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,i;this.pollId=null!==(i=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ba(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(e,Qge.get())};e()}}return t.currentPopupAction=null,t})();const A0=new Map;class t_e extends F8{constructor(n,e,r=!1){super(n,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var n=()=>super.execute,e=this;return fe(function*(){let r=A0.get(e.auth._key());if(!r){try{const o=(yield function n_e(t,n){return $P.apply(this,arguments)}(e.resolver,e.auth))?yield n().call(e):null;r=()=>Promise.resolve(o)}catch(i){r=()=>Promise.reject(i)}A0.set(e.auth._key(),r)}return e.bypassAuthState||A0.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(n){var e=()=>super.onAuthEvent,r=this;return fe(function*(){if("signInViaRedirect"===n.type)return e().call(r,n);if("unknown"!==n.type){if(n.eventId){const i=yield r.auth._redirectUserForId(n.eventId);if(i)return r.user=i,e().call(r,n);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return fe(function*(){})()}cleanUp(){}}function $P(){return($P=fe(function*(t,n){const e=function V8(t){return zC("pendingRedirect",t.config.apiKey,t.name)}(n),r=function B8(t){return qh(t._redirectPersistence)}(t);if(!(yield r._isAvailable()))return!1;const i="true"===(yield r._get(e));return yield r._remove(e),i})).apply(this,arguments)}function r_e(t,n){A0.set(t._key(),n)}function z8(t,n){return XP.apply(this,arguments)}function XP(){return(XP=fe(function*(t,n,e=!1){if(zh(t.app))return Promise.reject(ys(t));const r=Mo(t),i=fg(r,n),a=yield new t_e(r,i,e).execute();return a&&!e&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,n)),a})).apply(this,arguments)}class l_e{constructor(n){this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(n){this.consumers.add(n),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,n)&&(this.sendToConsumer(this.queuedRedirectEvent,n),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(n){this.consumers.delete(n)}onEvent(n){if(this.hasEventBeenHandled(n))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(n,r)&&(e=!0,this.sendToConsumer(n,r),this.saveEventToCache(n))}),this.hasHandledPotentialRedirect||!function c_e(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return H8(t);default:return!1}}(n)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=n,e=!0)),e}sendToConsumer(n,e){var r;if(n.error&&!H8(n)){const i=(null===(r=n.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(ba(this.auth,i))}else e.onAuthEvent(n)}isEventForConsumer(n,e){const r=null===e.eventId||!!n.eventId&&n.eventId===e.eventId;return e.filter.includes(n.type)&&r}hasEventBeenHandled(n){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(j8(n))}saveEventToCache(n){this.cachedEventUids.add(j8(n)),this.lastProcessedEventTime=Date.now()}}function j8(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(n=>n).join("-")}function H8({type:t,error:n}){return"unknown"===t&&"auth/no-auth-event"===n?.code}function JP(){return(JP=fe(function*(t,n={}){return Ei(t,"GET","/v1/projects",n)})).apply(this,arguments)}const d_e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h_e=/^https?/;function e2(){return e2=fe(function*(t){if(t.config.emulator)return;const{authorizedDomains:n}=yield function u_e(t){return JP.apply(this,arguments)}(t);for(const e of n)try{if(p_e(e))return}catch{}ol(t,"unauthorized-domain")}),e2.apply(this,arguments)}function p_e(t){const n=y0(),{protocol:e,hostname:r}=new URL(n);if(t.startsWith("chrome-extension://")){const a=new URL(t);return""===a.hostname&&""===r?"chrome-extension:"===e&&t.replace("chrome-extension://","")===n.replace("chrome-extension://",""):"chrome-extension:"===e&&a.hostname===r}if(!h_e.test(e))return!1;if(d_e.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const m_e=new v0(3e4,6e4);function $8(){const t=Wo().___jsl;if(t?.H)for(const n of Object.keys(t.H))if(t.H[n].r=t.H[n].r||[],t.H[n].L=t.H[n].L||[],t.H[n].r=[...t.H[n].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function g_e(t){return new Promise((n,e)=>{var r,i,o;function a(){$8(),gapi.load("gapi.iframes",{callback:()=>{n(gapi.iframes.getContext())},ontimeout:()=>{$8(),e(ba(t,"network-request-failed"))},timeout:m_e.get()})}if(null!==(i=null===(r=Wo().gapi)||void 0===r?void 0:r.iframes)&&void 0!==i&&i.Iframe)n(gapi.iframes.getContext());else{if(null===(o=Wo().gapi)||void 0===o||!o.load){const c=f8("iframefcb");return Wo()[c]=()=>{gapi.load?a():e(ba(t,"network-request-failed"))},function yR(t){return E0.loadJS(t)}(`${function Tme(){return E0.gapiScript}()}?onload=${c}`).catch(f=>e(f))}a()}}).catch(n=>{throw JC=null,n})}let JC=null;const y_e=new v0(5e3,15e3),w_e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},x_e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E_e(t){const n=t.config;ft(n.authDomain,t,"auth-domain-config-required");const e=n.emulator?JM(n,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,r={apiKey:n.apiKey,appName:t.name,v:dg},i=x_e.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${e}?${by(r).slice(1)}`}function t2(){return t2=fe(function*(t){const n=yield function __e(t){return JC=JC||g_e(t),JC}(t),e=Wo().gapi;return ft(e,t,"internal-error"),n.open({where:document.body,url:E_e(t),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:w_e,dontclear:!0},r=>new Promise(function(){var i=fe(function*(o,a){yield r.restyle({setHideOnLeave:!1});const c=ba(t,"network-request-failed"),f=Wo().setTimeout(()=>{a(c)},y_e.get());function _(){Wo().clearTimeout(f),o(r)}r.ping(_).then(_,()=>{a(c)})});return function(o,a){return i.apply(this,arguments)}}()))}),t2.apply(this,arguments)}const D_e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class q8{constructor(n){this.window=n,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const N_e=encodeURIComponent("fac");function G8(t,n,e,r,i,o){return n2.apply(this,arguments)}function n2(){return(n2=fe(function*(t,n,e,r,i,o){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:e,redirectUrl:r,v:dg,eventId:i};if(n instanceof Wh){n.setDefaultLanguage(t.languageCode),a.providerId=n.providerId||"",kM(n.getCustomParameters())||(a.customParameters=JSON.stringify(n.getCustomParameters()));for(const[x,D]of Object.entries(o||{}))a[x]=D}if(n instanceof b8){const x=n.getScopes().filter(D=>""!==D);x.length>0&&(a.scopes=x.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const x of Object.keys(c))void 0===c[x]&&delete c[x];const f=yield t._getAppCheckToken(),_=f?`#${N_e}=${encodeURIComponent(f)}`:"";return`${function O_e({config:t}){return t.emulator?JM(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${by(c).slice(1)}${_}`})).apply(this,arguments)}const r2="webStorageSupport",F_e=class L_e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M8,this._completeRedirectFn=z8,this._overrideRedirectResult=r_e}_openPopup(n,e,r,i){var o=this;return fe(function*(){var a;Uh(null===(a=o.eventManagers[n._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");const c=yield G8(n,e,r,y0(),i);return function A_e(t,n,e,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const f=Object.assign(Object.assign({},D_e),{width:r.toString(),height:i.toString(),top:o,left:a}),_=Vs().toLowerCase();e&&(c=o8(_)?"_blank":e),r8(_)&&(n=n||"http://localhost",f.scrollbars="yes");const x=Object.entries(f).reduce((A,[N,B])=>`${A}${N}=${B},`,"");if(function gme(t=Vs()){var n;return gR(t)&&!(null===(n=window.navigator)||void 0===n||!n.standalone)}(_)&&"_self"!==c)return function M_e(t,n){const e=document.createElement("a");e.href=t,e.target=n;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(n||"",c),new q8(null);const D=window.open(n||"",c,x);ft(D,t,"popup-blocked");try{D.focus()}catch{}return new q8(D)}(n,c,ZC())})()}_openRedirect(n,e,r,i){var o=this;return fe(function*(){return yield o._originValidation(n),function Dge(t){Wo().location.href=t}(yield G8(n,e,r,y0(),i)),new Promise(()=>{})})()}_initialize(n){const e=n._key();if(this.eventManagers[e]){const{manager:i,promise:o}=this.eventManagers[e];return i?Promise.resolve(i):(Uh(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(n);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(n){var e=this;return fe(function*(){const r=yield function C_e(t){return t2.apply(this,arguments)}(n),i=new l_e(n);return r.register("authEvent",o=>(ft(o?.authEvent,n,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[n._key()]={manager:i},e.iframes[n._key()]=r,i})()}_isIframeWebStorageSupported(n,e){this.iframes[n._key()].send(r2,{type:r2},i=>{var o;const a=null===(o=i?.[0])||void 0===o?void 0:o[r2];void 0!==a&&e(!!a),ol(n,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(n){const e=n._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function f_e(t){return e2.apply(this,arguments)}(n)),this.originValidationPromises[e]}get _shouldInitProactively(){return u8()||i8()||gR()}};var Y8="@firebase/auth";class B_e{constructor(n){this.auth=n,this.internalListeners=new Map}getUid(){var n;return this.assertAuthConfigured(),(null===(n=this.auth.currentUser)||void 0===n?void 0:n.uid)||null}getToken(n){var e=this;return fe(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(n)}:null})()}addAuthTokenListener(n){if(this.assertAuthConfigured(),this.internalListeners.has(n))return;const e=this.auth.onIdTokenChanged(r=>{n(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(n,e),this.updateProactiveRefresh()}removeAuthTokenListener(n){this.assertAuthConfigured();const e=this.internalListeners.get(n);e&&(this.internalListeners.delete(n),e(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const U_e=x6("authIdTokenMaxAge")||300;let Q8=null;const j_e=t=>function(){var n=fe(function*(e){const r=e&&(yield e.getIdTokenResult()),i=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>U_e)return;const o=r?.token;Q8!==o&&(Q8=o,yield fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(e){return n.apply(this,arguments)}}();(function Eme(t){E0=t})({loadJS:t=>new Promise((n,e)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=n,r.onerror=i=>{const o=ba("internal-error");o.customData=i,e(o)},r.type="text/javascript",r.charset="UTF-8",function $_e(){var t,n;return null!==(n=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==n?n:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function z_e(t){ug(new yp("auth",(n,{options:e})=>{const r=n.getProvider("app").getImmediate(),i=n.getProvider("heartbeat"),o=n.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;ft(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:d8(t)},_=new xme(r,i,o,f);return function Mme(t,n){const e=n?.persistence||[],r=(Array.isArray(e)?e:[e]).map(qh);n?.errorMap&&t._updateErrorMap(n.errorMap),t._initializeWithPersistence(r,n?.popupRedirectResolver)}(_,e),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,r)=>{n.getProvider("auth-internal").initialize()})),ug(new yp("auth-internal",n=>{const e=Mo(n.getProvider("auth").getImmediate());return new B_e(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),_u(Y8,"1.7.9",function V_e(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(t)),_u(Y8,"1.7.9","esm2017")}("Browser");const J8="@firebase/database";let o2="";class q_e{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,e){null==e?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),ts(e))}get(n){const e=this.domStorage_.getItem(this.prefixedName_(n));return null==e?null:h0(e)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}}class G_e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,e){null==e?delete this.cache_[n]:this.cache_[n]=e}get(n){return bd(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}}const nH=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const n=window[t];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new q_e(n)}}catch{}return new G_e},pg=nH("localStorage"),s2=nH("sessionStorage"),Ty=new RM("@firebase/database"),rH=function(){let t=1;return function(){return t++}}(),iH=function(t){const n=function(t){const n=[];let e=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const o=i-55296;r++,lt(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?n[e++]=i:i<2048?(n[e++]=i>>6|192,n[e++]=63&i|128):i<65536?(n[e++]=i>>12|224,n[e++]=i>>6&63|128,n[e++]=63&i|128):(n[e++]=i>>18|240,n[e++]=i>>12&63|128,n[e++]=i>>6&63|128,n[e++]=63&i|128)}return n}(t),e=new ofe;e.update(n);const r=e.digest();return SM.encodeByteArray(r)},M0=function(...t){let n="";for(let e=0;e<t.length;e++){const r=t[e];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?n+=M0.apply(null,r):n+="object"==typeof r?ts(r):r,n+=" "}return n};let mg=null,oH=!0;const vs=function(...t){if(!0===oH&&(oH=!1,null===mg&&!0===s2.get("logging_enabled")&&function(t,n){lt(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Ty.logLevel=Xr.VERBOSE,mg=Ty.log.bind(Ty),n&&s2.set("logging_enabled",!0)):"function"==typeof t?mg=t:(mg=null,s2.remove("logging_enabled"))}(!0)),mg){const n=M0.apply(null,t);mg(n)}},R0=function(t){return function(...n){vs(t,...n)}},a2=function(...t){const n="FIREBASE INTERNAL ERROR: "+M0(...t);Ty.error(n)},xd=function(...t){const n=`FIREBASE FATAL ERROR: ${M0(...t)}`;throw Ty.error(n),new Error(n)},Xs=function(...t){const n="FIREBASE WARNING: "+M0(...t);Ty.warn(n)},tD=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},wp="[MIN_NAME]",Kh="[MAX_NAME]",gg=function(t,n){if(t===n)return 0;if(t===wp||n===Kh)return-1;if(n===wp||t===Kh)return 1;{const e=cH(t),r=cH(n);return null!==e?null!==r?e-r===0?t.length-n.length:e-r:-1:null!==r?1:t<n?-1:1}},Z_e=function(t,n){return t===n?0:t<n?-1:1},P0=function(t,n){if(n&&t in n)return n[t];throw new Error("Missing required key ("+t+") in object: "+ts(n))},l2=function(t){if("object"!=typeof t||null===t)return ts(t);const n=[];for(const r in t)n.push(r);n.sort();let e="{";for(let r=0;r<n.length;r++)0!==r&&(e+=","),e+=ts(n[r]),e+=":",e+=l2(t[n[r]]);return e+="}",e},aH=function(t,n){const e=t.length;if(e<=n)return[t];const r=[];for(let i=0;i<e;i+=n)r.push(t.substring(i,i+n>e?e:i+n));return r};function bs(t,n){for(const e in t)t.hasOwnProperty(e)&&n(e,t[e])}const lH=function(t){lt(!tD(t),"Invalid JSON number");const r=1023;let i,o,a,c,f;0===t?(o=0,a=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(c=Math.min(Math.floor(Math.log(t)/Math.LN2),r),o=c+r,a=Math.round(t*Math.pow(2,52-c)-Math.pow(2,52))):(o=0,a=Math.round(t/Math.pow(2,-1074))));const _=[];for(f=52;f;f-=1)_.push(a%2?1:0),a=Math.floor(a/2);for(f=11;f;f-=1)_.push(o%2?1:0),o=Math.floor(o/2);_.push(i?1:0),_.reverse();const x=_.join("");let D="";for(f=0;f<64;f+=8){let A=parseInt(x.substr(f,8),2).toString(16);1===A.length&&(A="0"+A),D+=A}return D.toLowerCase()},J_e=new RegExp("^-?(0*)\\d{1,10}$"),cH=function(t){if(J_e.test(t)){const n=Number(t);if(n>=-2147483648&&n<=2147483647)return n}return null},Sy=function(t){try{t()}catch(n){setTimeout(()=>{throw Xs("Exception was thrown by user callback.",n.stack||""),n},Math.floor(0))}},N0=function(t,n){const e=setTimeout(t,n);return"number"==typeof e&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):"object"==typeof e&&e.unref&&e.unref(),e};class rye{constructor(n,e){this.appName_=n,this.appCheckProvider=e,this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(r=>this.appCheck=r)}getToken(n){return this.appCheck?this.appCheck.getToken(n):new Promise((e,r)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(e,r):e(null)},0)})}addTokenChangeListener(n){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(r=>r.addTokenListener(n))}notifyForInvalidToken(){Xs(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class iye{constructor(n,e,r){this.appName_=n,this.firebaseOptions_=e,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(e=>e&&"auth/token-not-initialized"===e.code?(vs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,r)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(e,r):e(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(e=>e.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(e=>e.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';n+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xs(n)}}let O0=(()=>{class t{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const pH=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,_H="websocket",yH="long_polling";class u2{constructor(n,e,r,i,o=!1,a="",c=!1,f=!1){this.secure=e,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=c,this.isUsingEmulator=f,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pg.get("host:"+n)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&pg.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function vH(t,n,e){let r;if(lt("string"==typeof n,"typeof type must == string"),lt("object"==typeof e,"typeof params must == object"),n===_H)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(n!==yH)throw new Error("Unknown connection type: "+n);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function oye(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(e.ns=t.namespace);const i=[];return bs(e,(o,a)=>{i.push(o+"="+a)}),r+i.join("&")}class sye{constructor(){this.counters_={}}incrementCounter(n,e=1){bd(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=e}get(){return Uhe(this.counters_)}}const d2={},h2={};function f2(t){const n=t.toString();return d2[n]||(d2[n]=new sye),d2[n]}class lye{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,e){this.closeAfterResponse=n,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,e){for(this.pendingResponses[n]=e;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Sy(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class xp{constructor(n,e,r,i,o,a,c){this.connId=n,this.repoInfo=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=a,this.lastSessionId=c,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=R0(n),this.stats_=f2(e),this.urlFn=f=>(this.appCheckToken&&(f.ac=this.appCheckToken),vH(e,yH,f))}open(n,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new lye(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{let n=!1;const e=function(){document.body?n||(n=!0,t()):setTimeout(e,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&e()}),window.attachEvent("onload",e))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new p2((...o)=>{const[a,c,f,_,x]=o;if(this.incrementIncomingBytes_(o),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=c,this.password=f;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);c?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(c,()=>{this.onClosed_()})):this.onClosed_()}},(...o)=>{const[a,c]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,c)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&pH.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){xp.forceAllow_=!0}static forceDisallow(){xp.forceDisallow_=!0}static isAvailable(){return!(!xp.forceAllow_&&(xp.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){const e=ts(n);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const r=_6(e),i=aH(r,1840);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(n,e){this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=n,r.pw=e,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){const e=ts(n).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class p2{constructor(n,e,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=rH(),window["pLPCommand"+this.uniqueCallbackIdentifier]=n,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=p2.createIFrame_();let o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(c){vs("frame writing exception"),c.stack&&vs(c.stack),vs(c)}}}static createIFrame_(){const n=document.createElement("iframe");if(n.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(n);try{n.contentWindow.document||vs("No IE domain setting required")}catch{const r=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,e){for(this.myID=n,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const n={};n.id=this.myID,n.pw=this.myPW,n.ser=this.currentSerial;let e=this.urlFn(n),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const a=this.pendingSegs.shift();r=r+"&seg"+i+"="+a.seg+"&ts"+i+"="+a.ts+"&d"+i+"="+a.d,i++}return e+=r,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(n,e,r){this.pendingSegs.push({seg:n,ts:e,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(n,e){this.outstandingRequests.add(e);const r=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(n,()=>{clearTimeout(i),r()})}addTag(n,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=n,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=()=>{vs("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let rD=null;typeof MozWebSocket<"u"?rD=MozWebSocket:typeof WebSocket<"u"&&(rD=WebSocket);let Iy=(()=>{class t{constructor(e,r,i,o,a,c,f){this.connId=e,this.applicationId=i,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=R0(this.connId),this.stats_=f2(r),this.connURL=t.connectionURL_(r,c,f,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,i,o,a){const c={v:"5"};return typeof location<"u"&&location.hostname&&pH.test(location.hostname)&&(c.r="f"),r&&(c.s=r),i&&(c.ls=i),o&&(c.ac=o),a&&(c.p=a),vH(e,_H,c)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pg.set("previous_websocket_failure",!0);try{let i;0,this.mySock=new rD(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const o=i.message||i.data;return o&&this.log_(o),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&null!==rD&&!t.forceDisallow_}static previouslyFailed(){return pg.isInMemoryStorage||!0===pg.get("previous_websocket_failure")}markConnectionHealthy(){pg.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=h0(r);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(lt(null===this.frames,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const r=ts(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=aH(r,16384);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),TH=(()=>{class t{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[xp,Iy]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const r=Iy&&Iy.isAvailable();let i=r&&!Iy.previouslyFailed();if(e.webSocketOnly&&(r||Xs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Iy];else{const o=this.transports_=[];for(const a of t.ALL_TRANSPORTS)a&&a.isAvailable()&&o.push(a);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class PH{constructor(n,e,r,i,o,a,c,f,_,x){this.id=n,this.repoInfo_=e,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=a,this.onReady_=c,this.onDisconnect_=f,this.onKill_=_,this.lastSessionId=x,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=R0("c:"+this.id+":"),this.transportManager_=new TH(e),this.log_("Connection created"),this.start_()}start_(){const n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,r)},Math.floor(0));const i=n.healthyTimeout||0;i>0&&(this.healthyTimeout_=N0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return e=>{n===this.conn_?this.onConnectionLost_(e):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return e=>{2!==this.state_&&(n===this.rx_?this.onPrimaryMessageReceived_(e):n===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(n){this.sendData_({t:"d",d:n})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if("t"in n){const e=n.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){const e=P0("t",n),r=P0("d",n);if("c"===e)this.onSecondaryControl_(r);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){const e=P0("t",n),r=P0("d",n);"c"===e?this.onControl_(r):"d"===e&&this.onDataMessage_(r)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){const e=P0("t",n);if("d"in n){const r=n.d;if("h"===e){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(r):"r"===e?this.onReset_(r):"e"===e?a2("Server Error: "+r):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):a2("Unknown control packet command: "+e)}}onHandshake_(n){const e=n.ts,r=n.v,i=n.h;this.sessionId=n.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==r&&Xs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,r),N0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,e){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):N0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,n||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(n)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class NH{put(n,e,r,i){}merge(n,e,r,i){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,e,r){}onDisconnectMerge(n,e,r){}onDisconnectCancel(n,e){}reportStats(n){}}class OH{constructor(n){this.allowedEvents_=n,this.listeners_={},lt(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...e){if(Array.isArray(this.listeners_[n])){const r=[...this.listeners_[n]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)}}on(n,e,r){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:e,context:r});const i=this.getInitialEvent(n);i&&e.apply(r,i)}off(n,e,r){this.validateEventType_(n);const i=this.listeners_[n]||[];for(let o=0;o<i.length;o++)if(i[o].callback===e&&(!r||r===i[o].context))return void i.splice(o,1)}validateEventType_(n){lt(this.allowedEvents_.find(e=>e===n),"Unknown event: "+n)}}class iD extends OH{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!IM()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new iD}getInitialEvent(n){return lt("online"===n,"Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}}class Or{constructor(n,e){if(void 0===e){this.pieces_=n.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=e}toString(){let n="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(n+="/"+this.pieces_[e]);return n||"/"}}function Er(){return new Or("")}function zn(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ep(t){return t.pieces_.length-t.pieceNum_}function ri(t){let n=t.pieceNum_;return n<t.pieces_.length&&n++,new Or(t.pieces_,n)}function g2(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function L0(t,n=0){return t.pieces_.slice(t.pieceNum_+n)}function BH(t){if(t.pieceNum_>=t.pieces_.length)return null;const n=[];for(let e=t.pieceNum_;e<t.pieces_.length-1;e++)n.push(t.pieces_[e]);return new Or(n,0)}function Ni(t,n){const e=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)e.push(t.pieces_[r]);if(n instanceof Or)for(let r=n.pieceNum_;r<n.pieces_.length;r++)e.push(n.pieces_[r]);else{const r=n.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&e.push(r[i])}return new Or(e,0)}function Un(t){return t.pieceNum_>=t.pieces_.length}function wa(t,n){const e=zn(t),r=zn(n);if(null===e)return n;if(e===r)return wa(ri(t),ri(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")}function Aye(t,n){const e=L0(t,0),r=L0(n,0);for(let i=0;i<e.length&&i<r.length;i++){const o=gg(e[i],r[i]);if(0!==o)return o}return e.length===r.length?0:e.length<r.length?-1:1}function _2(t,n){if(Ep(t)!==Ep(n))return!1;for(let e=t.pieceNum_,r=n.pieceNum_;e<=t.pieces_.length;e++,r++)if(t.pieces_[e]!==n.pieces_[r])return!1;return!0}function Mc(t,n){let e=t.pieceNum_,r=n.pieceNum_;if(Ep(t)>Ep(n))return!1;for(;e<t.pieces_.length;){if(t.pieces_[e]!==n.pieces_[r])return!1;++e,++r}return!0}class Mye{constructor(n,e){this.errorPrefix_=e,this.parts_=L0(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=PC(this.parts_[r]);VH(this)}}function VH(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+_g(t))}function _g(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class y2 extends OH{constructor(){let n,e;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",n="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",n="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",n="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const r=!document[n];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new y2}getInitialEvent(n){return lt("visible"===n,"Unknown event type: "+n),[this.visible_]}}const F0=1e3;let sD,yg=(()=>{class t extends NH{constructor(e,r,i,o,a,c,f,_){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=c,this.appCheckTokenProvider_=f,this.authOverride_=_,this.id=t.nextPersistentConnectionId_++,this.log_=R0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=F0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,_)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");y2.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&iD.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,i){const o=++this.requestNumber_,a={r:o,a:e,b:r};this.log_(ts(a)),lt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),i&&(this.requestCBHash_[o]=i)}get(e){this.initConnection_();const r=new yy,o={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const f=c.d;"ok"===c.s?r.resolve(f):r.reject(f)}};return this.outstandingGets_.push(o),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(e,r,i,o){this.initConnection_();const a=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+a),this.listens.has(c)||this.listens.set(c,new Map),lt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),lt(!this.listens.get(c).has(a),"listen() called twice for same path/queryId.");const f={onComplete:o,hashFn:r,query:e,tag:i};this.listens.get(c).set(a,f),this.connected_&&this.sendListen_(f)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(e){const r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);const a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,f=>{const _=f.d,x=f.s;t.warnOnListenWarnings_(_,r),(this.listens.get(i)&&this.listens.get(i).get(o))===e&&(this.log_("listen response",f),"ok"!==x&&this.removeListen_(i,o),e.onComplete&&e.onComplete(x,_))})}static warnOnListenWarnings_(e,r){if(e&&"object"==typeof e&&bd(e,"w")){const i=vy(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',a=r._path.toString();Xs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(t){const n=AC(t).claims;return"object"==typeof n&&!0===n.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=function(t){const e=AC(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{const a=o.s,c=o.d||"error";this.authToken_===e&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,i=e.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(e,r){const i=e._path.toString(),o=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),lt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,e._queryObject,r)}sendUnlisten_(e,r,i,o){this.log_("Unlisten on "+e+" for "+r);const a={p:e};o&&(a.q=i,a.t=o),this.sendRequest("n",a)}onDisconnectPut(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:i})}onDisconnectMerge(e,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:i})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,i,o){const a={p:r,d:i};this.log_("onDisconnect "+e,a),this.sendRequest(e,a,c=>{o&&setTimeout(()=>{o(c.s,c.d)},Math.floor(0))})}put(e,r,i,o){this.putInternal("p",e,r,i,o)}merge(e,r,i,o){this.putInternal("m",e,r,i,o)}putInternal(e,r,i,o,a){this.initConnection_();const c={p:r,d:i};void 0!==a&&(c.h=a),this.outstandingPuts_.push({action:e,request:c,onComplete:o}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,o=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,i,a=>{this.log_(r+" response",a),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ts(e));const r=e.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),"d"===e?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===e?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===e?this.onListenRevoked_(r.p,r.q):"ac"===e?this.onAuthRevoked_(r.s,r.d):"apc"===e?this.onAppCheckRevoked_(r.s,r.d):"sd"===e?this.onSecurityDebugPacket_(r):a2("Unrecognized action received from server: "+ts(e)+"\nAre you using the latest client?")}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){lt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=F0,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=F0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=F0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var e=this;return fe(function*(){if(e.shouldReconnect_()){e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null;const r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),o=e.onRealtimeDisconnect_.bind(e),a=e.id+":"+t.nextConnectionId_++,c=e.lastSessionId;let f=!1,_=null;const x=function(){_?_.close():(f=!0,o())};e.realtime_={close:x,sendRequest:function(N){lt(_,"sendRequest call when we're not connected not allowed."),_.sendRequest(N)}};const A=e.forceTokenRefresh_;e.forceTokenRefresh_=!1;try{const[N,B]=yield Promise.all([e.authTokenProvider_.getToken(A),e.appCheckTokenProvider_.getToken(A)]);f?vs("getToken() completed but was canceled"):(vs("getToken() completed. Creating connection."),e.authToken_=N&&N.accessToken,e.appCheckToken_=B&&B.token,_=new PH(a,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,o,te=>{Xs(te+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},c))}catch(N){e.log_("Failed to get token: "+N),f||(e.repoInfo_.nodeAdmin&&Xs(N),x())}}})()}interrupt(e){vs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){vs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],kM(this.interruptReasons_)&&(this.reconnectDelay_=F0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let i;i=r?r.map(a=>l2(a)).join("$"):"default";const o=this.removeListen_(e,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(e,r){const i=new Or(e).toString();let o;if(this.listens.has(i)){const a=this.listens.get(i);o=a.get(r),a.delete(r),0===a.size&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(e,r){vs("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){vs("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+o2.replace(/\./g,"-")]=1,IM()?e["framework.cordova"]=1:C6()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=iD.getInstance().currentlyOnline();return kM(this.interruptReasons_)&&e}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class Gn{constructor(n,e){this.name=n,this.node=e}static Wrap(n,e){return new Gn(n,e)}}class oD{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,e){const r=new Gn(wp,n),i=new Gn(wp,e);return 0!==this.compare(r,i)}minPost(){return Gn.MIN}}class jH extends oD{static get __EMPTY_NODE(){return sD}static set __EMPTY_NODE(n){sD=n}compare(n,e){return gg(n.name,e.name)}isDefinedOn(n){throw _y("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,e){return!1}minPost(){return Gn.MIN}maxPost(){return new Gn(Kh,sD)}makePost(n,e){return lt("string"==typeof n,"KeyIndex indexValue must always be a string."),new Gn(n,sD)}toString(){return".key"}}const Ed=new jH;class aD{constructor(n,e,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!n.isEmpty();)if(a=e?r(n.key,e):1,i&&(a*=-1),a<0)n=this.isReverse_?n.left:n.right;else{if(0===a){this.nodeStack_.push(n);break}this.nodeStack_.push(n),n=this.isReverse_?n.right:n.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,n=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}}let b2,yu=(()=>{class t{constructor(e,r,i,o,a){this.key=e,this.value=r,this.color=i??t.RED,this.left=o??sl.EMPTY_NODE,this.right=a??sl.EMPTY_NODE}copy(e,r,i,o,a){return new t(e??this.key,r??this.value,i??this.color,o??this.left,a??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,i){let o=this;const a=i(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,r,i),null):0===a?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return sl.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let i,o;if(i=this,r(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(e,i.key)){if(i.right.isEmpty())return sl.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class sl{constructor(n,e=sl.EMPTY_NODE){this.comparator_=n,this.root_=e}insert(n,e){return new sl(this.comparator_,this.root_.insert(n,e,this.comparator_).copy(null,null,yu.BLACK,null,null))}remove(n){return new sl(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,yu.BLACK,null,null))}get(n){let e,r=this.root_;for(;!r.isEmpty();){if(e=this.comparator_(n,r.key),0===e)return r.value;e<0?r=r.left:e>0&&(r=r.right)}return null}getPredecessorKey(n){let e,r=this.root_,i=null;for(;!r.isEmpty();){if(e=this.comparator_(n,r.key),0===e){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}e<0?r=r.left:e>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new aD(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,e){return new aD(this.root_,n,this.comparator_,!1,e)}getReverseIteratorFrom(n,e){return new aD(this.root_,n,this.comparator_,!0,e)}getReverseIterator(n){return new aD(this.root_,null,this.comparator_,!0,n)}}function Vye(t,n){return gg(t.name,n.name)}function v2(t,n){return gg(t,n)}sl.EMPTY_NODE=new class Bye{copy(n,e,r,i,o){return this}insert(n,e,r){return new yu(n,e,null)}remove(n,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const HH=function(t){return"number"==typeof t?"number:"+lH(t):"string:"+t},$H=function(t){if(t.isLeafNode()){const n=t.val();lt("string"==typeof n||"number"==typeof n||"object"==typeof n&&bd(n,".sv"),"Priority must be a string or number.")}else lt(t===b2||t.isEmpty(),"priority of unexpected type.");lt(t===b2||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let qH,GH,WH,ky=(()=>{class t{constructor(e,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,lt(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),$H(this.priorityNode_)}static set __childrenNodeConstructor(e){qH=e}static get __childrenNodeConstructor(){return qH}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new t(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Un(e)?this:".priority"===zn(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return".priority"===e?this.updatePriority(r):r.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const i=zn(e);return null===i?r:r.isEmpty()&&".priority"!==i?this:(lt(".priority"!==i||1===Ep(e),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(ri(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+HH(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",e+="number"===r?lH(this.value_):this.value_,this.lazyHash_=iH(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(lt(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,i=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(r),a=t.VALUE_TYPE_ORDER.indexOf(i);return lt(o>=0,"Unknown leaf type: "+r),lt(a>=0,"Unknown leaf type: "+i),o===a?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const hi=new class Hye extends oD{compare(n,e){const r=n.node.getPriority(),i=e.node.getPriority(),o=r.compareTo(i);return 0===o?gg(n.name,e.name):o}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,e){return!n.getPriority().equals(e.getPriority())}minPost(){return Gn.MIN}maxPost(){return new Gn(Kh,new ky("[PRIORITY-POST]",WH))}makePost(n,e){const r=GH(n);return new Gn(e,new ky("[PRIORITY-POST]",r))}toString(){return".priority"}},$ye=Math.log(2);class qye{constructor(n){this.count=parseInt(Math.log(n+1)/$ye,10),this.current_=this.count-1;const i=(()=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=n+1&i}nextBitIsOne(){const n=!(this.bits_&1<<this.current_);return this.current_--,n}}const lD=function(t,n,e,r){t.sort(n);const i=function(f,_){const x=_-f;let D,A;if(0===x)return null;if(1===x)return D=t[f],A=e?e(D):D,new yu(A,D.node,yu.BLACK,null,null);{const N=parseInt(x/2,10)+f,B=i(f,N),te=i(N+1,_);return D=t[N],A=e?e(D):D,new yu(A,D.node,yu.BLACK,B,te)}},c=function(f){let _=null,x=null,D=t.length;const A=function(B,te){const ce=D-B,we=D;D-=B;const Ce=i(ce+1,we),We=t[ce],Se=e?e(We):We;N(new yu(Se,We.node,te,null,Ce))},N=function(B){_?(_.left=B,_=B):(x=B,_=B)};for(let B=0;B<f.count;++B){const te=f.nextBitIsOne(),ce=Math.pow(2,f.count-(B+1));te?A(ce,yu.BLACK):(A(ce,yu.BLACK),A(ce,yu.RED))}return x}(new qye(t.length));return new sl(r||n,c)};let w2;const Ay={};class Zh{constructor(n,e){this.indexes_=n,this.indexSet_=e}static get Default(){return lt(Ay&&hi,"ChildrenNode.ts has not been loaded"),w2=w2||new Zh({".priority":Ay},{".priority":hi}),w2}get(n){const e=vy(this.indexes_,n);if(!e)throw new Error("No index defined for "+n);return e instanceof sl?e:null}hasIndex(n){return bd(this.indexSet_,n.toString())}addIndex(n,e){lt(n!==Ed,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const o=e.getIterator(Gn.Wrap);let c,a=o.getNext();for(;a;)i=i||n.isDefinedOn(a.node),r.push(a),a=o.getNext();c=i?lD(r,n.getCompare()):Ay;const f=n.toString(),_=Object.assign({},this.indexSet_);_[f]=n;const x=Object.assign({},this.indexes_);return x[f]=c,new Zh(x,_)}addToIndexes(n,e){const r=MC(this.indexes_,(i,o)=>{const a=vy(this.indexSet_,o);if(lt(a,"Missing index implementation for "+o),i===Ay){if(a.isDefinedOn(n.node)){const c=[],f=e.getIterator(Gn.Wrap);let _=f.getNext();for(;_;)_.name!==n.name&&c.push(_),_=f.getNext();return c.push(n),lD(c,a.getCompare())}return Ay}{const c=e.get(n.name);let f=i;return c&&(f=f.remove(new Gn(n.name,c))),f.insert(n,n.node)}});return new Zh(r,this.indexSet_)}removeFromIndexes(n,e){const r=MC(this.indexes_,i=>{if(i===Ay)return i;{const o=e.get(n.name);return o?i.remove(new Gn(n.name,o)):i}});return new Zh(r,this.indexSet_)}}let B0,Nn=(()=>{class t{constructor(e,r,i){this.children_=e,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&$H(this.priorityNode_),this.children_.isEmpty()&&lt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return B0||(B0=new t(new sl(v2),null,Zh.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||B0}updatePriority(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const r=this.children_.get(e);return null===r?B0:r}}getChild(e){const r=zn(e);return null===r?this:this.getImmediateChild(r).getChild(ri(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,r){if(lt(r,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(r);{const i=new Gn(e,r);let o,a;r.isEmpty()?(o=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(e,r),a=this.indexMap_.addToIndexes(i,this.children_));const c=o.isEmpty()?B0:this.priorityNode_;return new t(o,c,a)}}updateChild(e,r){const i=zn(e);if(null===i)return r;{lt(".priority"!==zn(e)||1===Ep(e),".priority must be the last token in a path");const o=this.getImmediateChild(i).updateChild(ri(e),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let i=0,o=0,a=!0;if(this.forEachChild(hi,(c,f)=>{r[c]=f.val(e),i++,a&&t.INTEGER_REGEXP_.test(c)?o=Math.max(o,Number(c)):a=!1}),!e&&a&&o<2*i){const c=[];for(const f in r)c[f]=r[f];return c}return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+HH(this.getPriority().val())+":"),this.forEachChild(hi,(r,i)=>{const o=i.hash();""!==o&&(e+=":"+r+":"+o)}),this.lazyHash_=""===e?"":iH(e)}return this.lazyHash_}getPredecessorChildName(e,r,i){const o=this.resolveIndex_(i);if(o){const a=o.getPredecessorKey(new Gn(e,r));return a?a.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new Gn(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new Gn(r,this.children_.get(r)):null}forEachChild(e,r){const i=this.resolveIndex_(e);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(e,o=>o);{const o=this.children_.getIteratorFrom(e.name,Gn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,e)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(e,o=>o);{const o=this.children_.getReverseIteratorFrom(e.name,Gn.Wrap);let a=o.peek();for(;null!=a&&r.compare(a,e)>0;)o.getNext(),a=o.peek();return o}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===V0?-1:0}withIndex(e){if(e===Ed||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===Ed||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(hi),o=r.getIterator(hi);let a=i.getNext(),c=o.getNext();for(;a&&c;){if(a.name!==c.name||!a.node.equals(c.node))return!1;a=i.getNext(),c=o.getNext()}return null===a&&null===c}return!1}return!1}}resolveIndex_(e){return e===Ed?null:this.indexMap_.get(e.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const V0=new class Gye extends Nn{constructor(){super(new sl(v2),Nn.EMPTY_NODE,Zh.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return Nn.EMPTY_NODE}isEmpty(){return!1}};function Qi(t,n=null){if(null===t)return Nn.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),lt(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+typeof n),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new ky(t,Qi(n));if(t instanceof Array){let e=Nn.EMPTY_NODE;return bs(t,(r,i)=>{if(bd(t,r)&&"."!==r.substring(0,1)){const o=Qi(i);(o.isLeafNode()||!o.isEmpty())&&(e=e.updateImmediateChild(r,o))}}),e.updatePriority(Qi(n))}{const e=[];let r=!1;if(bs(t,(a,c)=>{if("."!==a.substring(0,1)){const f=Qi(c);f.isEmpty()||(r=r||!f.getPriority().isEmpty(),e.push(new Gn(a,f)))}}),0===e.length)return Nn.EMPTY_NODE;const o=lD(e,Vye,a=>a.name,v2);if(r){const a=lD(e,hi.getCompare());return new Nn(o,Qi(n),new Zh({".priority":a},{".priority":hi}))}return new Nn(o,Qi(n),Zh.Default)}}Object.defineProperties(Gn,{MIN:{value:new Gn(wp,Nn.EMPTY_NODE)},MAX:{value:new Gn(Kh,V0)}}),jH.__EMPTY_NODE=Nn.EMPTY_NODE,ky.__childrenNodeConstructor=Nn,function zye(t){b2=t}(V0),function jye(t){WH=t}(V0),function Uye(t){GH=t}(Qi);class x2 extends oD{constructor(n){super(),this.indexPath_=n,lt(!Un(n)&&".priority"!==zn(n),"Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,e){const r=this.extractChild(n.node),i=this.extractChild(e.node),o=r.compareTo(i);return 0===o?gg(n.name,e.name):o}makePost(n,e){const r=Qi(n),i=Nn.EMPTY_NODE.updateChild(this.indexPath_,r);return new Gn(e,i)}maxPost(){const n=Nn.EMPTY_NODE.updateChild(this.indexPath_,V0);return new Gn(Kh,n)}toString(){return L0(this.indexPath_,0).join("/")}}const E2=new class Kye extends oD{compare(n,e){const r=n.node.compareTo(e.node);return 0===r?gg(n.name,e.name):r}isDefinedOn(n){return!0}indexedValueChanged(n,e){return!n.equals(e)}minPost(){return Gn.MIN}maxPost(){return Gn.MAX}makePost(n,e){const r=Qi(n);return new Gn(e,r)}toString(){return".value"}};function KH(t){return{type:"value",snapshotNode:t}}function My(t,n){return{type:"child_added",snapshotNode:n,childName:t}}function z0(t,n){return{type:"child_removed",snapshotNode:n,childName:t}}function U0(t,n,e){return{type:"child_changed",snapshotNode:n,childName:t,oldSnap:e}}class C2{constructor(n){this.index_=n}updateChild(n,e,r,i,o,a){lt(n.isIndexed(this.index_),"A node must be indexed if only a child is updated");const c=n.getImmediateChild(e);return c.getChild(i).equals(r.getChild(i))&&c.isEmpty()===r.isEmpty()||(null!=a&&(r.isEmpty()?n.hasChild(e)?a.trackChildChange(z0(e,c)):lt(n.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?a.trackChildChange(My(e,r)):a.trackChildChange(U0(e,r,c))),n.isLeafNode()&&r.isEmpty())?n:n.updateImmediateChild(e,r).withIndex(this.index_)}updateFullNode(n,e,r){return null!=r&&(n.isLeafNode()||n.forEachChild(hi,(i,o)=>{e.hasChild(i)||r.trackChildChange(z0(i,o))}),e.isLeafNode()||e.forEachChild(hi,(i,o)=>{if(n.hasChild(i)){const a=n.getImmediateChild(i);a.equals(o)||r.trackChildChange(U0(i,o,a))}else r.trackChildChange(My(i,o))})),e.withIndex(this.index_)}updatePriority(n,e){return n.isEmpty()?Nn.EMPTY_NODE:n.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class j0{constructor(n){this.indexedFilter_=new C2(n.getIndex()),this.index_=n.getIndex(),this.startPost_=j0.getStartPost_(n),this.endPost_=j0.getEndPost_(n),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(n){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),n)<=0:this.index_.compare(this.getStartPost(),n)<0,r=this.endIsInclusive_?this.index_.compare(n,this.getEndPost())<=0:this.index_.compare(n,this.getEndPost())<0;return e&&r}updateChild(n,e,r,i,o,a){return this.matches(new Gn(e,r))||(r=Nn.EMPTY_NODE),this.indexedFilter_.updateChild(n,e,r,i,o,a)}updateFullNode(n,e,r){e.isLeafNode()&&(e=Nn.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(Nn.EMPTY_NODE);const o=this;return e.forEachChild(hi,(a,c)=>{o.matches(new Gn(a,c))||(i=i.updateImmediateChild(a,Nn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(n,i,r)}updatePriority(n,e){return n}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(n){if(n.hasStart()){const e=n.getIndexStartName();return n.getIndex().makePost(n.getIndexStartValue(),e)}return n.getIndex().minPost()}static getEndPost_(n){if(n.hasEnd()){const e=n.getIndexEndName();return n.getIndex().makePost(n.getIndexEndValue(),e)}return n.getIndex().maxPost()}}class Yye{constructor(n){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=e=>{const r=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new j0(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft(),this.startIsInclusive_=!n.startAfterSet_,this.endIsInclusive_=!n.endBeforeSet_}updateChild(n,e,r,i,o,a){return this.rangedFilter_.matches(new Gn(e,r))||(r=Nn.EMPTY_NODE),n.getImmediateChild(e).equals(r)?n:n.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(n,e,r,i,o,a):this.fullLimitUpdateChild_(n,e,r,o,a)}updateFullNode(n,e,r){let i;if(e.isLeafNode()||e.isEmpty())i=Nn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let o;i=Nn.EMPTY_NODE.withIndex(this.index_),o=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const c=o.getNext();if(this.withinDirectionalStart(c)){if(!this.withinDirectionalEnd(c))break;i=i.updateImmediateChild(c.name,c.node),a++}}}else{let o;i=e.withIndex(this.index_),i=i.updatePriority(Nn.EMPTY_NODE),o=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let a=0;for(;o.hasNext();){const c=o.getNext();a<this.limit_&&this.withinDirectionalStart(c)&&this.withinDirectionalEnd(c)?a++:i=i.updateImmediateChild(c.name,Nn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(n,i,r)}updatePriority(n,e){return n}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(n,e,r,i,o){let a;if(this.reverse_){const D=this.index_.getCompare();a=(A,N)=>D(N,A)}else a=this.index_.getCompare();const c=n;lt(c.numChildren()===this.limit_,"");const f=new Gn(e,r),_=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),x=this.rangedFilter_.matches(f);if(c.hasChild(e)){const D=c.getImmediateChild(e);let A=i.getChildAfterChild(this.index_,_,this.reverse_);for(;null!=A&&(A.name===e||c.hasChild(A.name));)A=i.getChildAfterChild(this.index_,A,this.reverse_);const N=null==A?1:a(A,f);if(x&&!r.isEmpty()&&N>=0)return o?.trackChildChange(U0(e,r,D)),c.updateImmediateChild(e,r);{o?.trackChildChange(z0(e,D));const te=c.updateImmediateChild(e,Nn.EMPTY_NODE);return null!=A&&this.rangedFilter_.matches(A)?(o?.trackChildChange(My(A.name,A.node)),te.updateImmediateChild(A.name,A.node)):te}}return r.isEmpty()?n:x&&a(_,f)>=0?(null!=o&&(o.trackChildChange(z0(_.name,_.node)),o.trackChildChange(My(e,r))),c.updateImmediateChild(e,r).updateImmediateChild(_.name,Nn.EMPTY_NODE)):n}}class D2{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=hi}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return lt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return lt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:wp}hasEnd(){return this.endSet_}getIndexEndValue(){return lt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return lt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Kh}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return lt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===hi}copy(){const n=new D2;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.startAfterSet_=this.startAfterSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.endBeforeSet_=this.endBeforeSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}}function ZH(t){const n={};if(t.isDefault())return n;let e;if(t.index_===hi?e="$priority":t.index_===E2?e="$value":t.index_===Ed?e="$key":(lt(t.index_ instanceof x2,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=ts(e),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";n[r]=ts(t.indexStartValue_),t.startNameSet_&&(n[r]+=","+ts(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";n[r]=ts(t.indexEndValue_),t.endNameSet_&&(n[r]+=","+ts(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_),n}function YH(t){const n={};if(t.startSet_&&(n.sp=t.indexStartValue_,t.startNameSet_&&(n.sn=t.indexStartName_),n.sin=!t.startAfterSet_),t.endSet_&&(n.ep=t.indexEndValue_,t.endNameSet_&&(n.en=t.indexEndName_),n.ein=!t.endBeforeSet_),t.limitSet_){n.l=t.limit_;let e=t.viewFrom_;""===e&&(e=t.isViewFromLeft()?"l":"r"),n.vf=e}return t.index_!==hi&&(n.i=t.index_.toString()),n}class uD extends NH{constructor(n,e,r,i){super(),this.repoInfo_=n,this.onDataUpdate_=e,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=R0("p:rest:"),this.listens_={}}reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,e){return void 0!==e?"tag$"+e:(lt(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}listen(n,e,r,i){const o=n._path.toString();this.log_("Listen called for "+o+" "+n._queryIdentifier);const a=uD.getListenId_(n,r),c={};this.listens_[a]=c;const f=ZH(n._queryParams);this.restRequest_(o+".json",f,(_,x)=>{let D=x;if(404===_&&(D=null,_=null),null===_&&this.onDataUpdate_(o,D,!1,r),vy(this.listens_,a)===c){let A;A=_?401===_?"permission_denied":"rest_error:"+_:"ok",i(A,null)}})}unlisten(n,e){const r=uD.getListenId_(n,e);delete this.listens_[r]}get(n){const e=ZH(n._queryParams),r=n._path.toString(),i=new yy;return this.restRequest_(r+".json",e,(o,a)=>{let c=a;404===o&&(c=null,o=null),null===o?(this.onDataUpdate_(r,c,!1,null),i.resolve(c)):i.reject(new Error(c))}),i.promise}refreshAuthToken(n){}restRequest_(n,e={},r){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(e.auth=i.accessToken),o&&o.token&&(e.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+by(e);this.log_("Sending REST request for "+a);const c=new XMLHttpRequest;c.onreadystatechange=()=>{if(r&&4===c.readyState){this.log_("REST Response for "+a+" received. status:",c.status,"response:",c.responseText);let f=null;if(c.status>=200&&c.status<300){try{f=h0(c.responseText)}catch{Xs("Failed to parse JSON response for "+a+": "+c.responseText)}r(null,f)}else 401!==c.status&&404!==c.status&&Xs("Got unsuccessful REST response for "+a+" Status: "+c.status),r(c.status);r=null}},c.open("GET",a,!0),c.send()})}}class nve{constructor(){this.rootNode_=Nn.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,e){this.rootNode_=this.rootNode_.updateChild(n,e)}}function dD(){return{value:null,children:new Map}}function Ry(t,n,e){if(Un(n))t.value=e,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(n,e);else{const r=zn(n);t.children.has(r)||t.children.set(r,dD()),Ry(t.children.get(r),n=ri(n),e)}}function k2(t,n,e){null!==t.value?e(n,t.value):function rve(t,n){t.children.forEach((e,r)=>{n(r,e)})}(t,(r,i)=>{k2(i,new Or(n.toString()+"/"+r),e)})}class ive{constructor(n){this.collection_=n,this.last_=null}get(){const n=this.collection_.get(),e=Object.assign({},n);return this.last_&&bs(this.last_,(r,i)=>{e[r]=e[r]-i}),this.last_=n,e}}class ave{constructor(n,e){this.server_=e,this.statsToReport_={},this.statsListener_=new ive(n);const r=1e4+2e4*Math.random();N0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const n=this.statsListener_.get(),e={};let r=!1;bs(n,(i,o)=>{o>0&&bd(this.statsToReport_,i)&&(e[i]=o,r=!0)}),r&&this.server_.reportStats(e),N0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Cd=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Cd||{});function R2(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class hD{constructor(n,e,r){this.path=n,this.affectedTree=e,this.revert=r,this.type=Cd.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(n){if(Un(this.path)){if(null!=this.affectedTree.value)return lt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new Or(n));return new hD(Er(),e,this.revert)}}return lt(zn(this.path)===n,"operationForChild called for unrelated child."),new hD(ri(this.path),this.affectedTree,this.revert)}}class H0{constructor(n,e){this.source=n,this.path=e,this.type=Cd.LISTEN_COMPLETE}operationForChild(n){return Un(this.path)?new H0(this.source,Er()):new H0(this.source,ri(this.path))}}class vg{constructor(n,e,r){this.source=n,this.path=e,this.snap=r,this.type=Cd.OVERWRITE}operationForChild(n){return Un(this.path)?new vg(this.source,Er(),this.snap.getImmediateChild(n)):new vg(this.source,ri(this.path),this.snap)}}class Py{constructor(n,e,r){this.source=n,this.path=e,this.children=r,this.type=Cd.MERGE}operationForChild(n){if(Un(this.path)){const e=this.children.subtree(new Or(n));return e.isEmpty()?null:e.value?new vg(this.source,Er(),e.value):new Py(this.source,Er(),e)}return lt(zn(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new Py(this.source,ri(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Cp{constructor(n,e,r){this.node_=n,this.fullyInitialized_=e,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(Un(n))return this.isFullyInitialized()&&!this.filtered_;const e=zn(n);return this.isCompleteForChild(e)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}}class lve{constructor(n){this.query_=n,this.index_=this.query_._queryParams.getIndex()}}function $0(t,n,e,r,i,o){const a=r.filter(c=>c.type===e);a.sort((c,f)=>function dve(t,n,e){if(null==n.childName||null==e.childName)throw _y("Should only compare child_ events.");const r=new Gn(n.childName,n.snapshotNode),i=new Gn(e.childName,e.snapshotNode);return t.index_.compare(r,i)}(t,c,f)),a.forEach(c=>{const f=function uve(t,n,e){return"value"===n.type||"child_removed"===n.type||(n.prevName=e.getPredecessorChildName(n.childName,n.snapshotNode,t.index_)),n}(t,c,o);i.forEach(_=>{_.respondsTo(c.type)&&n.push(_.createEvent(f,t.query_))})})}function fD(t,n){return{eventCache:t,serverCache:n}}function q0(t,n,e,r){return fD(new Cp(n,e,r),t.serverCache)}function QH(t,n,e,r){return fD(t.eventCache,new Cp(n,e,r))}function pD(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function bg(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let P2;class fi{constructor(n,e=(()=>(P2||(P2=new sl(Z_e)),P2))()){this.value=n,this.children=e}static fromObject(n){let e=new fi(null);return bs(n,(r,i)=>{e=e.set(new Or(r),i)}),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,e){if(null!=this.value&&e(this.value))return{path:Er(),value:this.value};if(Un(n))return null;{const r=zn(n),i=this.children.get(r);if(null!==i){const o=i.findRootMostMatchingPathAndValue(ri(n),e);return null!=o?{path:Ni(new Or(r),o.path),value:o.value}:null}return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(Un(n))return this;{const e=zn(n),r=this.children.get(e);return null!==r?r.subtree(ri(n)):new fi(null)}}set(n,e){if(Un(n))return new fi(e,this.children);{const r=zn(n),o=(this.children.get(r)||new fi(null)).set(ri(n),e),a=this.children.insert(r,o);return new fi(this.value,a)}}remove(n){if(Un(n))return this.children.isEmpty()?new fi(null):new fi(null,this.children);{const e=zn(n),r=this.children.get(e);if(r){const i=r.remove(ri(n));let o;return o=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&o.isEmpty()?new fi(null):new fi(this.value,o)}return this}}get(n){if(Un(n))return this.value;{const e=zn(n),r=this.children.get(e);return r?r.get(ri(n)):null}}setTree(n,e){if(Un(n))return e;{const r=zn(n),o=(this.children.get(r)||new fi(null)).setTree(ri(n),e);let a;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new fi(this.value,a)}}fold(n){return this.fold_(Er(),n)}fold_(n,e){const r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Ni(n,i),e)}),e(n,this.value,r)}findOnPath(n,e){return this.findOnPath_(n,Er(),e)}findOnPath_(n,e,r){const i=!!this.value&&r(e,this.value);if(i)return i;if(Un(n))return null;{const o=zn(n),a=this.children.get(o);return a?a.findOnPath_(ri(n),Ni(e,o),r):null}}foreachOnPath(n,e){return this.foreachOnPath_(n,Er(),e)}foreachOnPath_(n,e,r){if(Un(n))return this;{this.value&&r(e,this.value);const i=zn(n),o=this.children.get(i);return o?o.foreachOnPath_(ri(n),Ni(e,i),r):new fi(null)}}foreach(n){this.foreach_(Er(),n)}foreach_(n,e){this.children.inorderTraversal((r,i)=>{i.foreach_(Ni(n,r),e)}),this.value&&e(n,this.value)}foreachChild(n){this.children.inorderTraversal((e,r)=>{r.value&&n(e,r.value)})}}class vu{constructor(n){this.writeTree_=n}static empty(){return new vu(new fi(null))}}function G0(t,n,e){if(Un(n))return new vu(new fi(e));{const r=t.writeTree_.findRootMostValueAndPath(n);if(null!=r){const i=r.path;let o=r.value;const a=wa(i,n);return o=o.updateChild(a,e),new vu(t.writeTree_.set(i,o))}{const i=new fi(e),o=t.writeTree_.setTree(n,i);return new vu(o)}}}function N2(t,n,e){let r=t;return bs(e,(i,o)=>{r=G0(r,Ni(n,i),o)}),r}function JH(t,n){if(Un(n))return vu.empty();{const e=t.writeTree_.setTree(n,new fi(null));return new vu(e)}}function O2(t,n){return null!=wg(t,n)}function wg(t,n){const e=t.writeTree_.findRootMostValueAndPath(n);return null!=e?t.writeTree_.get(e.path).getChild(wa(e.path,n)):null}function e$(t){const n=[],e=t.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(hi,(r,i)=>{n.push(new Gn(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&n.push(new Gn(r,i.value))}),n}function Dp(t,n){if(Un(n))return t;{const e=wg(t,n);return new vu(null!=e?new fi(e):t.writeTree_.subtree(n))}}function L2(t){return t.writeTree_.isEmpty()}function Ny(t,n){return t$(Er(),t.writeTree_,n)}function t$(t,n,e){if(null!=n.value)return e.updateChild(t,n.value);{let r=null;return n.children.inorderTraversal((i,o)=>{".priority"===i?(lt(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):e=t$(Ni(t,i),o,e)}),!e.getChild(t).isEmpty()&&null!==r&&(e=e.updateChild(Ni(t,".priority"),r)),e}}function mD(t,n){return s$(n,t)}function _ve(t,n){if(t.snap)return Mc(t.path,n);for(const e in t.children)if(t.children.hasOwnProperty(e)&&Mc(Ni(t.path,e),n))return!0;return!1}function vve(t){return t.visible}function n$(t,n,e){let r=vu.empty();for(let i=0;i<t.length;++i){const o=t[i];if(n(o)){const a=o.path;let c;if(o.snap)Mc(e,a)?(c=wa(e,a),r=G0(r,c,o.snap)):Mc(a,e)&&(c=wa(a,e),r=G0(r,Er(),o.snap.getChild(c)));else{if(!o.children)throw _y("WriteRecord should have .snap or .children");if(Mc(e,a))c=wa(e,a),r=N2(r,c,o.children);else if(Mc(a,e))if(c=wa(a,e),Un(c))r=N2(r,Er(),o.children);else{const f=vy(o.children,zn(c));if(f){const _=f.getChild(ri(c));r=G0(r,Er(),_)}}}}}return r}function r$(t,n,e,r,i){if(r||i){const o=Dp(t.visibleWrites,n);return!i&&L2(o)?e:i||null!=e||O2(o,Er())?Ny(n$(t.allWrites,function(_){return(_.visible||i)&&(!r||!~r.indexOf(_.writeId))&&(Mc(_.path,n)||Mc(n,_.path))},n),e||Nn.EMPTY_NODE):null}{const o=wg(t.visibleWrites,n);if(null!=o)return o;{const a=Dp(t.visibleWrites,n);return L2(a)?e:null!=e||O2(a,Er())?Ny(a,e||Nn.EMPTY_NODE):null}}}function gD(t,n,e,r){return r$(t.writeTree,t.treePath,n,e,r)}function F2(t,n){return function bve(t,n,e){let r=Nn.EMPTY_NODE;const i=wg(t.visibleWrites,n);if(i)return i.isLeafNode()||i.forEachChild(hi,(o,a)=>{r=r.updateImmediateChild(o,a)}),r;if(e){const o=Dp(t.visibleWrites,n);return e.forEachChild(hi,(a,c)=>{const f=Ny(Dp(o,new Or(a)),c);r=r.updateImmediateChild(a,f)}),e$(o).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}return e$(Dp(t.visibleWrites,n)).forEach(a=>{r=r.updateImmediateChild(a.name,a.node)}),r}(t.writeTree,t.treePath,n)}function i$(t,n,e,r){return function wve(t,n,e,r,i){lt(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=Ni(n,e);if(O2(t.visibleWrites,o))return null;{const a=Dp(t.visibleWrites,o);return L2(a)?i.getChild(e):Ny(a,i.getChild(e))}}(t.writeTree,t.treePath,n,e,r)}function _D(t,n){return function Eve(t,n){return wg(t.visibleWrites,n)}(t.writeTree,Ni(t.treePath,n))}function B2(t,n,e){return function xve(t,n,e,r){const i=Ni(n,e),o=wg(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(e)?Ny(Dp(t.visibleWrites,i),r.getNode().getImmediateChild(e)):null}(t.writeTree,t.treePath,n,e)}function o$(t,n){return s$(Ni(t.treePath,n),t.writeTree)}function s$(t,n){return{treePath:t,writeTree:n}}class Sve{constructor(){this.changeMap=new Map}trackChildChange(n){const e=n.type,r=n.childName;lt("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),lt(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const o=i.type;if("child_added"===e&&"child_removed"===o)this.changeMap.set(r,U0(r,n.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===o)this.changeMap.delete(r);else if("child_removed"===e&&"child_changed"===o)this.changeMap.set(r,z0(r,i.oldSnap));else if("child_changed"===e&&"child_added"===o)this.changeMap.set(r,My(r,n.snapshotNode));else{if("child_changed"!==e||"child_changed"!==o)throw _y("Illegal combination of changes: "+n+" occurred after "+i);this.changeMap.set(r,U0(r,n.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,n)}getChanges(){return Array.from(this.changeMap.values())}}const a$=new class Ive{getCompleteChild(n){return null}getChildAfterChild(n,e,r){return null}};class V2{constructor(n,e,r=null){this.writes_=n,this.viewCache_=e,this.optCompleteServerCache_=r}getCompleteChild(n){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(n))return e.getNode().getImmediateChild(n);{const r=null!=this.optCompleteServerCache_?new Cp(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return B2(this.writes_,n,r)}}getChildAfterChild(n,e,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:bg(this.viewCache_),o=function Tve(t,n,e,r,i,o){return function Cve(t,n,e,r,i,o,a){let c;const f=Dp(t.visibleWrites,n),_=wg(f,Er());if(null!=_)c=_;else{if(null==e)return[];c=Ny(f,e)}if(c=c.withIndex(a),c.isEmpty()||c.isLeafNode())return[];{const x=[],D=a.getCompare(),A=o?c.getReverseIteratorFrom(r,a):c.getIteratorFrom(r,a);let N=A.getNext();for(;N&&x.length<i;)0!==D(N,r)&&x.push(N),N=A.getNext();return x}}(t.writeTree,t.treePath,n,e,r,i,o)}(this.writes_,i,e,1,r,n);return 0===o.length?null:o[0]}}function l$(t,n,e,r,i,o){const a=n.eventCache;if(null!=_D(r,e))return n;{let c,f;if(Un(e))if(lt(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const _=bg(n),D=F2(r,_ instanceof Nn?_:Nn.EMPTY_NODE);c=t.filter.updateFullNode(n.eventCache.getNode(),D,o)}else{const _=gD(r,bg(n));c=t.filter.updateFullNode(n.eventCache.getNode(),_,o)}else{const _=zn(e);if(".priority"===_){lt(1===Ep(e),"Can't have a priority with additional path components");const x=a.getNode();f=n.serverCache.getNode();const D=i$(r,e,x,f);c=null!=D?t.filter.updatePriority(x,D):a.getNode()}else{const x=ri(e);let D;if(a.isCompleteForChild(_)){f=n.serverCache.getNode();const A=i$(r,e,a.getNode(),f);D=null!=A?a.getNode().getImmediateChild(_).updateChild(x,A):a.getNode().getImmediateChild(_)}else D=B2(r,_,n.serverCache);c=null!=D?t.filter.updateChild(a.getNode(),_,D,x,i,o):a.getNode()}}return q0(n,c,a.isFullyInitialized()||Un(e),t.filter.filtersNodes())}}function yD(t,n,e,r,i,o,a,c){const f=n.serverCache;let _;const x=a?t.filter:t.filter.getIndexedFilter();if(Un(e))_=x.updateFullNode(f.getNode(),r,null);else if(x.filtersNodes()&&!f.isFiltered()){const N=f.getNode().updateChild(e,r);_=x.updateFullNode(f.getNode(),N,null)}else{const N=zn(e);if(!f.isCompleteForPath(e)&&Ep(e)>1)return n;const B=ri(e),ce=f.getNode().getImmediateChild(N).updateChild(B,r);_=".priority"===N?x.updatePriority(f.getNode(),ce):x.updateChild(f.getNode(),N,ce,B,a$,null)}const D=QH(n,_,f.isFullyInitialized()||Un(e),x.filtersNodes());return l$(t,D,e,i,new V2(i,D,o),c)}function z2(t,n,e,r,i,o,a){const c=n.eventCache;let f,_;const x=new V2(i,n,o);if(Un(e))_=t.filter.updateFullNode(n.eventCache.getNode(),r,a),f=q0(n,_,!0,t.filter.filtersNodes());else{const D=zn(e);if(".priority"===D)_=t.filter.updatePriority(n.eventCache.getNode(),r),f=q0(n,_,c.isFullyInitialized(),c.isFiltered());else{const A=ri(e),N=c.getNode().getImmediateChild(D);let B;if(Un(A))B=r;else{const te=x.getCompleteChild(D);B=null!=te?".priority"===g2(A)&&te.getChild(BH(A)).isEmpty()?te:te.updateChild(A,r):Nn.EMPTY_NODE}f=N.equals(B)?n:q0(n,t.filter.updateChild(c.getNode(),D,B,A,x,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return f}function c$(t,n){return t.eventCache.isCompleteForChild(n)}function u$(t,n,e){return e.foreach((r,i)=>{n=n.updateChild(r,i)}),n}function U2(t,n,e,r,i,o,a,c){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let _,f=n;_=Un(e)?r:new fi(null).setTree(e,r);const x=n.serverCache.getNode();return _.children.inorderTraversal((D,A)=>{if(x.hasChild(D)){const B=u$(0,n.serverCache.getNode().getImmediateChild(D),A);f=yD(t,f,new Or(D),B,i,o,a,c)}}),_.children.inorderTraversal((D,A)=>{const N=!n.serverCache.isCompleteForChild(D)&&null===A.value;if(!x.hasChild(D)&&!N){const te=u$(0,n.serverCache.getNode().getImmediateChild(D),A);f=yD(t,f,new Or(D),te,i,o,a,c)}}),f}class Fve{constructor(n,e){this.query_=n,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new C2(r.getIndex()),o=function Xye(t){return t.loadsAllData()?new C2(t.getIndex()):t.hasLimit()?new Yye(t):new j0(t)}(r);this.processor_=function kve(t){return{filter:t}}(o);const a=e.serverCache,c=e.eventCache,f=i.updateFullNode(Nn.EMPTY_NODE,a.getNode(),null),_=o.updateFullNode(Nn.EMPTY_NODE,c.getNode(),null),x=new Cp(f,a.isFullyInitialized(),i.filtersNodes()),D=new Cp(_,c.isFullyInitialized(),o.filtersNodes());this.viewCache_=fD(D,x),this.eventGenerator_=new lve(this.query_)}get query(){return this.query_}}function zve(t,n){const e=bg(t.viewCache_);return e&&(t.query._queryParams.loadsAllData()||!Un(n)&&!e.getImmediateChild(zn(n)).isEmpty())?e.getChild(n):null}function d$(t){return 0===t.eventRegistrations_.length}function h$(t,n,e){const r=[];if(e){lt(null==n,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(e,i);a&&r.push(a)})}if(n){let i=[];for(let o=0;o<t.eventRegistrations_.length;++o){const a=t.eventRegistrations_[o];if(a.matches(n)){if(n.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(o+1));break}}else i.push(a)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function f$(t,n,e,r){n.type===Cd.MERGE&&null!==n.source.queryId&&(lt(bg(t.viewCache_),"We should always have a full cache before handling merges"),lt(pD(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,o=function Mve(t,n,e,r,i){const o=new Sve;let a,c;if(e.type===Cd.OVERWRITE){const _=e;_.source.fromUser?a=z2(t,n,_.path,_.snap,r,i,o):(lt(_.source.fromServer,"Unknown source."),c=_.source.tagged||n.serverCache.isFiltered()&&!Un(_.path),a=yD(t,n,_.path,_.snap,r,i,c,o))}else if(e.type===Cd.MERGE){const _=e;_.source.fromUser?a=function Pve(t,n,e,r,i,o,a){let c=n;return r.foreach((f,_)=>{const x=Ni(e,f);c$(n,zn(x))&&(c=z2(t,c,x,_,i,o,a))}),r.foreach((f,_)=>{const x=Ni(e,f);c$(n,zn(x))||(c=z2(t,c,x,_,i,o,a))}),c}(t,n,_.path,_.children,r,i,o):(lt(_.source.fromServer,"Unknown source."),c=_.source.tagged||n.serverCache.isFiltered(),a=U2(t,n,_.path,_.children,r,i,c,o))}else if(e.type===Cd.ACK_USER_WRITE){const _=e;a=_.revert?function Lve(t,n,e,r,i,o){let a;if(null!=_D(r,e))return n;{const c=new V2(r,n,i),f=n.eventCache.getNode();let _;if(Un(e)||".priority"===zn(e)){let x;if(n.serverCache.isFullyInitialized())x=gD(r,bg(n));else{const D=n.serverCache.getNode();lt(D instanceof Nn,"serverChildren would be complete if leaf node"),x=F2(r,D)}_=t.filter.updateFullNode(f,x,o)}else{const x=zn(e);let D=B2(r,x,n.serverCache);null==D&&n.serverCache.isCompleteForChild(x)&&(D=f.getImmediateChild(x)),_=null!=D?t.filter.updateChild(f,x,D,ri(e),c,o):n.eventCache.getNode().hasChild(x)?t.filter.updateChild(f,x,Nn.EMPTY_NODE,ri(e),c,o):f,_.isEmpty()&&n.serverCache.isFullyInitialized()&&(a=gD(r,bg(n)),a.isLeafNode()&&(_=t.filter.updateFullNode(_,a,o)))}return a=n.serverCache.isFullyInitialized()||null!=_D(r,Er()),q0(n,_,a,t.filter.filtersNodes())}}(t,n,_.path,r,i,o):function Nve(t,n,e,r,i,o,a){if(null!=_D(i,e))return n;const c=n.serverCache.isFiltered(),f=n.serverCache;if(null!=r.value){if(Un(e)&&f.isFullyInitialized()||f.isCompleteForPath(e))return yD(t,n,e,f.getNode().getChild(e),i,o,c,a);if(Un(e)){let _=new fi(null);return f.getNode().forEachChild(Ed,(x,D)=>{_=_.set(new Or(x),D)}),U2(t,n,e,_,i,o,c,a)}return n}{let _=new fi(null);return r.foreach((x,D)=>{const A=Ni(e,x);f.isCompleteForPath(A)&&(_=_.set(x,f.getNode().getChild(A)))}),U2(t,n,e,_,i,o,c,a)}}(t,n,_.path,_.affectedTree,r,i,o)}else{if(e.type!==Cd.LISTEN_COMPLETE)throw _y("Unknown operation type: "+e.type);a=function Ove(t,n,e,r,i){const o=n.serverCache;return l$(t,QH(n,o.getNode(),o.isFullyInitialized()||Un(e),o.isFiltered()),e,r,a$,i)}(t,n,e.path,r,o)}const f=o.getChanges();return function Rve(t,n,e){const r=n.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=pD(t);(e.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&e.push(KH(pD(n)))}}(n,a,f),{viewCache:a,changes:f}}(t.processor_,i,n,e,r);return function Ave(t,n){lt(n.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),lt(n.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,o.viewCache),lt(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,p$(t,o.changes,o.viewCache.eventCache.getNode(),null)}function p$(t,n,e,r){return function cve(t,n,e,r){const i=[],o=[];return n.forEach(a=>{"child_changed"===a.type&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(function Zye(t,n){return{type:"child_moved",snapshotNode:n,childName:t}}(a.childName,a.snapshotNode))}),$0(t,i,"child_removed",n,r,e),$0(t,i,"child_added",n,r,e),$0(t,i,"child_moved",o,r,e),$0(t,i,"child_changed",n,r,e),$0(t,i,"value",n,r,e),i}(t.eventGenerator_,n,e,r?[r]:t.eventRegistrations_)}let vD,wD;class m${constructor(){this.views=new Map}}function j2(t,n,e,r){const i=n.source.queryId;if(null!==i){const o=t.views.get(i);return lt(null!=o,"SyncTree gave us an op for an invalid query."),f$(o,n,e,r)}{let o=[];for(const a of t.views.values())o=o.concat(f$(a,n,e,r));return o}}function g$(t,n,e,r,i){const a=t.views.get(n._queryIdentifier);if(!a){let c=gD(e,i?r:null),f=!1;c?f=!0:r instanceof Nn?(c=F2(e,r),f=!1):(c=Nn.EMPTY_NODE,f=!1);const _=fD(new Cp(c,f,!1),new Cp(r,i,!1));return new Fve(n,_)}return a}function _$(t){const n=[];for(const e of t.views.values())e.query._queryParams.loadsAllData()||n.push(e);return n}function Tp(t,n){let e=null;for(const r of t.views.values())e=e||zve(r,n);return e}function y$(t,n){return n._queryParams.loadsAllData()?bD(t):t.views.get(n._queryIdentifier)}function v$(t,n){return null!=y$(t,n)}function Sp(t){return null!=bD(t)}function bD(t){for(const n of t.views.values())if(n.query._queryParams.loadsAllData())return n;return null}let Yve=1;class b${constructor(n){this.listenProvider_=n,this.syncPointTree_=new fi(null),this.pendingWriteTree_=function Dve(){return{visibleWrites:vu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function H2(t,n,e,r,i){return function fve(t,n,e,r,i){lt(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:n,snap:e,writeId:r,visible:i}),i&&(t.visibleWrites=G0(t.visibleWrites,n,e)),t.lastWriteId=r}(t.pendingWriteTree_,n,e,r,i),i?Oy(t,new vg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,e)):[]}function Ip(t,n,e=!1){const r=function mve(t,n){for(let e=0;e<t.allWrites.length;e++){const r=t.allWrites[e];if(r.writeId===n)return r}return null}(t.pendingWriteTree_,n);if(function gve(t,n){const e=t.allWrites.findIndex(c=>c.writeId===n);lt(e>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[e];t.allWrites.splice(e,1);let i=r.visible,o=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const c=t.allWrites[a];c.visible&&(a>=e&&_ve(c,r.path)?i=!1:Mc(r.path,c.path)&&(o=!0)),a--}return!!i&&(o?(function yve(t){t.visibleWrites=n$(t.allWrites,vve,Er()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=JH(t.visibleWrites,r.path):bs(r.children,f=>{t.visibleWrites=JH(t.visibleWrites,Ni(r.path,f))}),!0))}(t.pendingWriteTree_,n)){let o=new fi(null);return null!=r.snap?o=o.set(Er(),!0):bs(r.children,a=>{o=o.set(new Or(a),!0)}),Oy(t,new hD(r.path,o,e))}return[]}function W0(t,n,e){return Oy(t,new vg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,e))}function xD(t,n,e,r,i=!1){const o=n._path,a=t.syncPointTree_.get(o);let c=[];if(a&&("default"===n._queryIdentifier||v$(a,n))){const f=function Wve(t,n,e,r){const i=n._queryIdentifier,o=[];let a=[];const c=Sp(t);if("default"===i)for(const[f,_]of t.views.entries())a=a.concat(h$(_,e,r)),d$(_)&&(t.views.delete(f),_.query._queryParams.loadsAllData()||o.push(_.query));else{const f=t.views.get(i);f&&(a=a.concat(h$(f,e,r)),d$(f)&&(t.views.delete(i),f.query._queryParams.loadsAllData()||o.push(f.query)))}return c&&!Sp(t)&&o.push(new(function $ve(){return lt(vD,"Reference.ts has not been loaded"),vD}())(n._repo,n._path)),{removed:o,events:a}}(a,n,e,r);(function qve(t){return 0===t.views.size})(a)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const _=f.removed;if(c=f.events,!i){const x=-1!==_.findIndex(A=>A._queryParams.loadsAllData()),D=t.syncPointTree_.findOnPath(o,(A,N)=>Sp(N));if(x&&!D){const A=t.syncPointTree_.subtree(o);if(!A.isEmpty()){const N=function rbe(t){return t.fold((n,e,r)=>{if(e&&Sp(e))return[bD(e)];{let i=[];return e&&(i=_$(e)),bs(r,(o,a)=>{i=i.concat(a)}),i}})}(A);for(let B=0;B<N.length;++B){const te=N[B],ce=te.query,we=C$(t,te);t.listenProvider_.startListening(Z0(ce),K0(t,ce),we.hashFn,we.onComplete)}}}!D&&_.length>0&&!r&&(x?t.listenProvider_.stopListening(Z0(n),null):_.forEach(A=>{const N=t.queryToTagMap.get(CD(A));t.listenProvider_.stopListening(Z0(A),N)}))}!function ibe(t,n){for(let e=0;e<n.length;++e){const r=n[e];if(!r._queryParams.loadsAllData()){const i=CD(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,_)}return c}function w$(t,n,e,r){const i=q2(t,r);if(null!=i){const o=G2(i),a=o.path,c=o.queryId,f=wa(a,n);return W2(t,a,new vg(R2(c),f,e))}return[]}function $2(t,n,e,r=!1){const i=n._path;let o=null,a=!1;t.syncPointTree_.foreachOnPath(i,(A,N)=>{const B=wa(A,i);o=o||Tp(N,B),a=a||Sp(N)});let f,c=t.syncPointTree_.get(i);c?(a=a||Sp(c),o=o||Tp(c,Er())):(c=new m$,t.syncPointTree_=t.syncPointTree_.set(i,c)),null!=o?f=!0:(f=!1,o=Nn.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((N,B)=>{const te=Tp(B,Er());te&&(o=o.updateImmediateChild(N,te))}));const _=v$(c,n);if(!_&&!n._queryParams.loadsAllData()){const A=CD(n);lt(!t.queryToTagMap.has(A),"View does not exist, but we have a tag");const N=function obe(){return Yve++}();t.queryToTagMap.set(A,N),t.tagToQueryMap.set(N,A)}let D=function Gve(t,n,e,r,i,o){const a=g$(t,n,r,i,o);return t.views.has(n._queryIdentifier)||t.views.set(n._queryIdentifier,a),function Uve(t,n){t.eventRegistrations_.push(n)}(a,e),function jve(t,n){const e=t.viewCache_.eventCache,r=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(hi,(o,a)=>{r.push(My(o,a))}),e.isFullyInitialized()&&r.push(KH(e.getNode())),p$(t,r,e.getNode(),n)}(a,e)}(c,n,e,mD(t.pendingWriteTree_,i),o,f);if(!_&&!a&&!r){const A=y$(c,n);D=D.concat(function sbe(t,n,e){const r=n._path,i=K0(t,n),o=C$(t,e),a=t.listenProvider_.startListening(Z0(n),i,o.hashFn,o.onComplete),c=t.syncPointTree_.subtree(r);if(i)lt(!Sp(c.value),"If we're adding a query, it shouldn't be shadowed");else{const f=c.fold((_,x,D)=>{if(!Un(_)&&x&&Sp(x))return[bD(x).query];{let A=[];return x&&(A=A.concat(_$(x).map(N=>N.query))),bs(D,(N,B)=>{A=A.concat(B)}),A}});for(let _=0;_<f.length;++_){const x=f[_];t.listenProvider_.stopListening(Z0(x),K0(t,x))}}return a}(t,n,A))}return D}function ED(t,n,e){const i=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(n,(a,c)=>{const _=Tp(c,wa(a,n));if(_)return _});return r$(i,n,o,e,!0)}function Oy(t,n){return x$(n,t.syncPointTree_,null,mD(t.pendingWriteTree_,Er()))}function x$(t,n,e,r){if(Un(t.path))return E$(t,n,e,r);{const i=n.get(Er());null==e&&null!=i&&(e=Tp(i,Er()));let o=[];const a=zn(t.path),c=t.operationForChild(a),f=n.children.get(a);if(f&&c){const _=e?e.getImmediateChild(a):null,x=o$(r,a);o=o.concat(x$(c,f,_,x))}return i&&(o=o.concat(j2(i,t,r,e))),o}}function E$(t,n,e,r){const i=n.get(Er());null==e&&null!=i&&(e=Tp(i,Er()));let o=[];return n.children.inorderTraversal((a,c)=>{const f=e?e.getImmediateChild(a):null,_=o$(r,a),x=t.operationForChild(a);x&&(o=o.concat(E$(x,c,f,_)))}),i&&(o=o.concat(j2(i,t,r,e))),o}function C$(t,n){const e=n.query,r=K0(t,e);return{hashFn:()=>(function Bve(t){return t.viewCache_.serverCache.getNode()}(n)||Nn.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function ebe(t,n,e){const r=q2(t,e);if(r){const i=G2(r),o=i.path,a=i.queryId,c=wa(o,n);return W2(t,o,new H0(R2(a),c))}return[]}(t,e._path,r):function Jve(t,n){return Oy(t,new H0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n))}(t,e._path);{const o=function Q_e(t,n){let e="Unknown Error";"too_big"===t?e="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?e="Client doesn't have permission to access the desired data.":"unavailable"===t&&(e="The service is unavailable");const r=new Error(t+" at "+n._path.toString()+": "+e);return r.code=t.toUpperCase(),r}(i,e);return xD(t,e,null,o)}}}}function K0(t,n){const e=CD(n);return t.queryToTagMap.get(e)}function CD(t){return t._path.toString()+"$"+t._queryIdentifier}function q2(t,n){return t.tagToQueryMap.get(n)}function G2(t){const n=t.indexOf("$");return lt(-1!==n&&n<t.length-1,"Bad queryKey."),{queryId:t.substr(n+1),path:new Or(t.substr(0,n))}}function W2(t,n,e){const r=t.syncPointTree_.get(n);return lt(r,"Missing sync point for query tag that we're tracking"),j2(r,e,mD(t.pendingWriteTree_,n),null)}function Z0(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function Zve(){return lt(wD,"Reference.ts has not been loaded"),wD}())(t._repo,t._path):t}class K2{constructor(n){this.node_=n}getImmediateChild(n){const e=this.node_.getImmediateChild(n);return new K2(e)}node(){return this.node_}}class Z2{constructor(n,e){this.syncTree_=n,this.path_=e}getImmediateChild(n){const e=Ni(this.path_,n);return new Z2(this.syncTree_,e)}node(){return ED(this.syncTree_,this.path_)}}const D$=function(t,n,e){return t&&"object"==typeof t?(lt(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?lbe(t[".sv"],n,e):"object"==typeof t[".sv"]?cbe(t[".sv"],n):void lt(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},lbe=function(t,n,e){if("timestamp"===t)return e.timestamp;lt(!1,"Unexpected server value: "+t)},cbe=function(t,n,e){t.hasOwnProperty("increment")||lt(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&lt(!1,"Unexpected increment value: "+r);const i=n.node();if(lt(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const a=i.getValue();return"number"!=typeof a?r:a+r},T$=function(t,n,e,r){return X2(n,new Z2(e,t),r)},Y2=function(t,n,e){return X2(t,new K2(n),e)};function X2(t,n,e){const r=t.getPriority().val(),i=D$(r,n.getImmediateChild(".priority"),e);let o;if(t.isLeafNode()){const a=t,c=D$(a.getValue(),n,e);return c!==a.getValue()||i!==a.getPriority().val()?new ky(c,Qi(i)):t}{const a=t;return o=a,i!==a.getPriority().val()&&(o=o.updatePriority(new ky(i))),a.forEachChild(hi,(c,f)=>{const _=X2(f,n.getImmediateChild(c),e);_!==f&&(o=o.updateImmediateChild(c,_))}),o}}class Q2{constructor(n="",e=null,r={children:{},childCount:0}){this.name=n,this.parent=e,this.node=r}}function DD(t,n){let e=n instanceof Or?n:new Or(n),r=t,i=zn(e);for(;null!==i;){const o=vy(r.node.children,i)||{children:{},childCount:0};r=new Q2(i,r,o),e=ri(e),i=zn(e)}return r}function xg(t){return t.node.value}function J2(t,n){t.node.value=n,eN(t)}function S$(t){return t.node.childCount>0}function TD(t,n){bs(t.node.children,(e,r)=>{n(new Q2(e,t,r))})}function I$(t,n,e,r){e&&!r&&n(t),TD(t,i=>{I$(i,n,!0,r)}),e&&r&&n(t)}function Y0(t){return new Or(null===t.parent?t.name:Y0(t.parent)+"/"+t.name)}function eN(t){null!==t.parent&&function hbe(t,n,e){const r=function ube(t){return void 0===xg(t)&&!S$(t)}(e),i=bd(t.node.children,n);r&&i?(delete t.node.children[n],t.node.childCount--,eN(t)):!r&&!i&&(t.node.children[n]=e.node,t.node.childCount++,eN(t))}(t.parent,t.name,t)}const fbe=/[\[\].#$\/\u0000-\u001F\u007F]/,pbe=/[\[\].#$\u0000-\u001F\u007F]/,tN=10485760,SD=function(t){return"string"==typeof t&&0!==t.length&&!fbe.test(t)},k$=function(t){return"string"==typeof t&&0!==t.length&&!pbe.test(t)},Dd=function(t,n,e,r){r&&void 0===n||Q0(ag(t,"value"),n,e)},Q0=function(t,n,e){const r=e instanceof Or?new Mye(e,t):e;if(void 0===n)throw new Error(t+"contains undefined "+_g(r));if("function"==typeof n)throw new Error(t+"contains a function "+_g(r)+" with contents = "+n.toString());if(tD(n))throw new Error(t+"contains "+n.toString()+" "+_g(r));if("string"==typeof n&&n.length>tN/3&&PC(n)>tN)throw new Error(t+"contains a string greater than "+tN+" utf8 bytes "+_g(r)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){let i=!1,o=!1;if(bs(n,(a,c)=>{if(".value"===a)i=!0;else if(".priority"!==a&&".sv"!==a&&(o=!0,!SD(a)))throw new Error(t+" contains an invalid key ("+a+") "+_g(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Rye(t,n){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(n),t.byteLength_+=PC(n),VH(t)})(r,a),Q0(t,c,r),function Pye(t){const n=t.parts_.pop();t.byteLength_-=PC(n),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&o)throw new Error(t+' contains ".value" child '+_g(r)+" in addition to actual children.")}},A$=function(t,n,e,r){if(r&&void 0===n)return;const i=ag(t,"values");if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(i+" must be an object containing the children to replace.");const o=[];bs(n,(a,c)=>{const f=new Or(a);if(Q0(i,c,Ni(e,f)),".priority"===g2(f)&&!function(t){return null===t||"string"==typeof t||"number"==typeof t&&!tD(t)||t&&"object"==typeof t&&bd(t,".sv")}(c))throw new Error(i+"contains an invalid value for '"+f.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(f)}),function(t,n){let e,r;for(e=0;e<n.length;e++){r=n[e];const o=L0(r);for(let a=0;a<o.length;a++)if((".priority"!==o[a]||a!==o.length-1)&&!SD(o[a]))throw new Error(t+"contains an invalid key ("+o[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(Aye);let i=null;for(e=0;e<n.length;e++){if(r=n[e],null!==i&&Mc(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,o)},rN=function(t,n,e,r){if(!(r&&void 0===e||k$(e)))throw new Error(ag(t,n)+'was an invalid path = "'+e+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Td=function(t,n){if(".info"===zn(n))throw new Error(t+" failed = Can't modify data under /.info/")};class ybe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ID(t,n){let e=null;for(let r=0;r<n.length;r++){const i=n[r],o=i.getPath();null!==e&&!_2(o,e.path)&&(t.eventLists_.push(e),e=null),null===e&&(e={events:[],path:o}),e.events.push(i)}e&&t.eventLists_.push(e)}function R$(t,n,e){ID(t,e),P$(t,r=>_2(r,n))}function Fl(t,n,e){ID(t,e),P$(t,r=>Mc(r,n)||Mc(n,r))}function P$(t,n){t.recursionDepth_++;let e=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(n(i.path)?(vbe(t.eventLists_[r]),t.eventLists_[r]=null):e=!1)}e&&(t.eventLists_=[]),t.recursionDepth_--}function vbe(t){for(let n=0;n<t.events.length;n++){const e=t.events[n];if(null!==e){t.events[n]=null;const r=e.getEventRunner();mg&&vs("event: "+e.toString()),Sy(r)}}}class wbe{constructor(n,e,r,i){this.repoInfo_=n,this.forceRestClient_=e,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ybe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=dD(),this.transactionQueueTree_=new Q2,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function O$(t){const e=t.infoData_.getNode(new Or(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function ew(t){return function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t}({timestamp:O$(t)})}function L$(t,n,e,r,i){t.dataUpdateCount++;const o=new Or(n);e=t.interceptServerDataCallback_?t.interceptServerDataCallback_(n,e):e;let a=[];if(i)if(r){const f=MC(e,_=>Qi(_));a=function tbe(t,n,e,r){const i=q2(t,r);if(i){const o=G2(i),a=o.path,c=o.queryId,f=wa(a,n),_=fi.fromObject(e);return W2(t,a,new Py(R2(c),f,_))}return[]}(t.serverSyncTree_,o,f,i)}else{const f=Qi(e);a=w$(t.serverSyncTree_,o,f,i)}else if(r){const f=MC(e,_=>Qi(_));a=function Qve(t,n,e){const r=fi.fromObject(e);return Oy(t,new Py({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,r))}(t.serverSyncTree_,o,f)}else{const f=Qi(e);a=W0(t.serverSyncTree_,o,f)}let c=o;a.length>0&&(c=Fy(t,o)),Fl(t.eventQueue_,c,a)}function F$(t,n){iN(t,"connected",n),!1===n&&function Tbe(t){Ly(t,"onDisconnectEvents");const n=ew(t),e=dD();k2(t.onDisconnect_,Er(),(i,o)=>{const a=T$(i,o,t.serverSyncTree_,n);Ry(e,i,a)});let r=[];k2(e,Er(),(i,o)=>{r=r.concat(W0(t.serverSyncTree_,i,o));const a=lN(t,i);Fy(t,a)}),t.onDisconnect_=dD(),Fl(t.eventQueue_,Er(),r)}(t)}function iN(t,n,e){const r=new Or("/.info/"+n),i=Qi(e);t.infoData_.updateSnapshot(r,i);const o=W0(t.infoSyncTree_,r,i);Fl(t.eventQueue_,r,o)}function kD(t){return t.nextWriteId_++}function sN(t,n,e){let r;r=".info"===zn(n._path)?xD(t.infoSyncTree_,n,e):xD(t.serverSyncTree_,n,e),R$(t.eventQueue_,n._path,r)}function Ly(t,...n){let e="";t.persistentConnection_&&(e=t.persistentConnection_.id+":"),vs(e,...n)}function kp(t,n,e,r){n&&Sy(()=>{if("ok"===e)n(null);else{const i=(e||"error").toUpperCase();let o=i;r&&(o+=": "+r);const a=new Error(o);a.code=i,n(a)}})}function aN(t,n,e){return ED(t.serverSyncTree_,n,e)||Nn.EMPTY_NODE}function AD(t,n=t.transactionQueueTree_){if(n||MD(t,n),xg(n)){const e=U$(t,n);lt(e.length>0,"Sending zero length transaction queue"),e.every(i=>0===i.status)&&function Pbe(t,n,e){const r=e.map(_=>_.currentWriteId),i=aN(t,n,r);let o=i;const a=i.hash();for(let _=0;_<e.length;_++){const x=e[_];lt(0===x.status,"tryToSendTransactionQueue_: items in queue should all be run."),x.status=1,x.retryCount++;const D=wa(n,x.path);o=o.updateChild(D,x.currentOutputSnapshotRaw)}const c=o.val(!0),f=n;t.server_.put(f.toString(),c,_=>{Ly(t,"transaction put response",{path:f.toString(),status:_});let x=[];if("ok"===_){const D=[];for(let A=0;A<e.length;A++)e[A].status=2,x=x.concat(Ip(t.serverSyncTree_,e[A].currentWriteId)),e[A].onComplete&&D.push(()=>e[A].onComplete(null,!0,e[A].currentOutputSnapshotResolved)),e[A].unwatcher();MD(t,DD(t.transactionQueueTree_,n)),AD(t,t.transactionQueueTree_),Fl(t.eventQueue_,n,x);for(let A=0;A<D.length;A++)Sy(D[A])}else{if("datastale"===_)for(let D=0;D<e.length;D++)e[D].status=3===e[D].status?4:0;else{Xs("transaction at "+f.toString()+" failed: "+_);for(let D=0;D<e.length;D++)e[D].status=4,e[D].abortReason=_}Fy(t,n)}},a)}(t,Y0(n),e)}else S$(n)&&TD(n,e=>{AD(t,e)})}function Fy(t,n){const e=z$(t,n),r=Y0(e);return function Nbe(t,n,e){if(0===n.length)return;const r=[];let i=[];const a=n.filter(c=>0===c.status).map(c=>c.currentWriteId);for(let c=0;c<n.length;c++){const f=n[c],_=wa(e,f.path);let D,x=!1;if(lt(null!==_,"rerunTransactionsUnderNode_: relativePath should not be null."),4===f.status)x=!0,D=f.abortReason,i=i.concat(Ip(t.serverSyncTree_,f.currentWriteId,!0));else if(0===f.status)if(f.retryCount>=25)x=!0,D="maxretry",i=i.concat(Ip(t.serverSyncTree_,f.currentWriteId,!0));else{const A=aN(t,f.path,a);f.currentInputSnapshot=A;const N=n[c].update(A.val());if(void 0!==N){Q0("transaction failed: Data returned ",N,f.path);let B=Qi(N);"object"==typeof N&&null!=N&&bd(N,".priority")||(B=B.updatePriority(A.getPriority()));const ce=f.currentWriteId,we=ew(t),Ce=Y2(B,A,we);f.currentOutputSnapshotRaw=B,f.currentOutputSnapshotResolved=Ce,f.currentWriteId=kD(t),a.splice(a.indexOf(ce),1),i=i.concat(H2(t.serverSyncTree_,f.path,Ce,f.currentWriteId,f.applyLocally)),i=i.concat(Ip(t.serverSyncTree_,ce,!0))}else x=!0,D="nodata",i=i.concat(Ip(t.serverSyncTree_,f.currentWriteId,!0))}Fl(t.eventQueue_,e,i),i=[],x&&(n[c].status=2,function(A){setTimeout(A,Math.floor(0))}(n[c].unwatcher),n[c].onComplete&&r.push("nodata"===D?()=>n[c].onComplete(null,!1,n[c].currentInputSnapshot):()=>n[c].onComplete(new Error(D),!1,null)))}MD(t,t.transactionQueueTree_);for(let c=0;c<r.length;c++)Sy(r[c]);AD(t,t.transactionQueueTree_)}(t,U$(t,e),r),r}function z$(t,n){let e,r=t.transactionQueueTree_;for(e=zn(n);null!==e&&void 0===xg(r);)r=DD(r,e),e=zn(n=ri(n));return r}function U$(t,n){const e=[];return j$(t,n,e),e.sort((r,i)=>r.order-i.order),e}function j$(t,n,e){const r=xg(n);if(r)for(let i=0;i<r.length;i++)e.push(r[i]);TD(n,i=>{j$(t,i,e)})}function MD(t,n){const e=xg(n);if(e){let r=0;for(let i=0;i<e.length;i++)2!==e[i].status&&(e[r]=e[i],r++);e.length=r,J2(n,e.length>0?e:void 0)}TD(n,r=>{MD(t,r)})}function lN(t,n){const e=Y0(z$(t,n)),r=DD(t.transactionQueueTree_,n);return function dbe(t,n,e){let r=e?t:t.parent;for(;null!==r;){if(n(r))return!0;r=r.parent}}(r,i=>{cN(t,i)}),cN(t,r),I$(r,i=>{cN(t,i)}),e}function cN(t,n){const e=xg(n);if(e){const r=[];let i=[],o=-1;for(let a=0;a<e.length;a++)3===e[a].status||(1===e[a].status?(lt(o===a-1,"All SENT items should be at beginning of queue."),o=a,e[a].status=3,e[a].abortReason="set"):(lt(0===e[a].status,"Unexpected transaction status in abort"),e[a].unwatcher(),i=i.concat(Ip(t.serverSyncTree_,e[a].currentWriteId,!0)),e[a].onComplete&&r.push(e[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?J2(n,void 0):e.length=o+1,Fl(t.eventQueue_,Y0(n),i);for(let a=0;a<r.length;a++)Sy(r[a])}}const uN=function(t,n){const e=Fbe(t),r=e.namespace;return"firebase.com"===e.domain&&xd(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==e.domain&&xd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Xs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new u2(e.host,e.secure,r,"ws"===e.scheme||"wss"===e.scheme,n,"",r!==e.subdomain),path:new Or(e.pathString)}},Fbe=function(t){let n="",e="",r="",i="",o="",a=!0,c="https",f=443;if("string"==typeof t){let _=t.indexOf("//");_>=0&&(c=t.substring(0,_-1),t=t.substring(_+2));let x=t.indexOf("/");-1===x&&(x=t.length);let D=t.indexOf("?");-1===D&&(D=t.length),n=t.substring(0,Math.min(x,D)),x<D&&(i=function Obe(t){let n="";const e=t.split("/");for(let r=0;r<e.length;r++)if(e[r].length>0){let i=e[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}n+="/"+i}return n}(t.substring(x,D)));const A=function Lbe(t){const n={};"?"===t.charAt(0)&&(t=t.substring(1));for(const e of t.split("&")){if(0===e.length)continue;const r=e.split("=");2===r.length?n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xs(`Invalid query segment '${e}' in query '${t}'`)}return n}(t.substring(Math.min(t.length,D)));_=n.indexOf(":"),_>=0?(a="https"===c||"wss"===c,f=parseInt(n.substring(_+1),10)):_=n.length;const N=n.slice(0,_);if("localhost"===N.toLowerCase())e="localhost";else if(N.split(".").length<=2)e=N;else{const B=n.indexOf(".");r=n.substring(0,B).toLowerCase(),e=n.substring(B+1),o=r}"ns"in A&&(o=A.ns)}return{host:n,port:f,domain:e,subdomain:r,secure:a,scheme:c,pathString:i,namespace:o}},H$="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Bbe=function(){let t=0;const n=[];return function(e){const r=e===t;let i;t=e;const o=new Array(8);for(i=7;i>=0;i--)o[i]=H$.charAt(e%64),e=Math.floor(e/64);lt(0===e,"Cannot push at time == 0");let a=o.join("");if(r){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)a+=H$.charAt(n[i]);return lt(20===a.length,"nextPushId: Length should be 20."),a}}();class $${constructor(n,e,r,i){this.eventType=n,this.eventRegistration=e,this.snapshot=r,this.prevName=i}getPath(){const n=this.snapshot.ref;return"value"===this.eventType?n._path:n.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ts(this.snapshot.exportVal())}}class q${constructor(n,e,r){this.eventRegistration=n,this.error=e,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class dN{constructor(n,e){this.snapshotCallback=n,this.cancelCallback=e}onValue(n,e){this.snapshotCallback.call(null,n,e)}onCancel(n){return lt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,n)}get hasCancelCallback(){return!!this.cancelCallback}matches(n){return this.snapshotCallback===n.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===n.snapshotCallback.userCallback&&this.snapshotCallback.context===n.snapshotCallback.context}}class Bl{constructor(n,e,r,i){this._repo=n,this._path=e,this._queryParams=r,this._orderByCalled=i}get key(){return Un(this._path)?null:g2(this._path)}get ref(){return new bu(this._repo,this._path)}get _queryIdentifier(){const n=YH(this._queryParams),e=l2(n);return"{}"===e?"default":e}get _queryObject(){return YH(this._queryParams)}isEqual(n){if(!((n=Ao(n))instanceof Bl))return!1;const e=this._repo===n._repo,r=_2(this._path,n._path);return e&&r&&this._queryIdentifier===n._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function kye(t){let n="";for(let e=t.pieceNum_;e<t.pieces_.length;e++)""!==t.pieces_[e]&&(n+="/"+encodeURIComponent(String(t.pieces_[e])));return n||"/"}(this._path)}}class bu extends Bl{constructor(n,e){super(n,e,new D2,!1)}get parent(){const n=BH(this._path);return null===n?null:new bu(this._repo,n)}get root(){let n=this;for(;null!==n.parent;)n=n.parent;return n}}class Eg{constructor(n,e,r){this._node=n,this.ref=e,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(n){const e=new Or(n),r=By(this.ref,n);return new Eg(this._node.getChild(e),r,hi)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>n(new Eg(i,By(this.ref,r),hi)))}hasChild(n){const e=new Or(n);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ir(t,n){return(t=Ao(t))._checkNotDeleted("ref"),void 0!==n?By(t._root,n):t._root}function By(t,n){return null===zn((t=Ao(t))._path)?((e=n)&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),rN("child","path",e,!1)):rN("child","path",n,!1),new bu(t._repo,Ni(t._path,n));var e}function Vy(t,n){t=Ao(t),Td("push",t._path),Dd("push",n,t._path,!0);const e=O$(t._repo),r=Bbe(e),i=By(t,r),o=By(t,r);let a;return a=null!=n?Sd(o,n).then(()=>o):Promise.resolve(o),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function Cg(t){return Td("remove",t._path),Sd(t,null)}function Sd(t,n){t=Ao(t),Td("set",t._path),Dd("set",n,t._path,!1);const e=new yy;return function oN(t,n,e,r,i){Ly(t,"set",{path:n.toString(),value:e,priority:r});const o=ew(t),a=Qi(e,r),c=ED(t.serverSyncTree_,n),f=Y2(a,c,o),_=kD(t),x=H2(t.serverSyncTree_,n,f,_,!0);ID(t.eventQueue_,x),t.server_.put(n.toString(),a.val(!0),(A,N)=>{const B="ok"===A;B||Xs("set at "+n+" failed: "+A);const te=Ip(t.serverSyncTree_,_,!B);Fl(t.eventQueue_,n,te),kp(0,i,A,N)});const D=lN(t,n);Fy(t,D),Fl(t.eventQueue_,D,[])}(t._repo,t._path,n,null,e.wrapCallback(()=>{})),e.promise}function Dg(t,n){A$("update",n,t._path,!1);const e=new yy;return function Dbe(t,n,e,r){Ly(t,"update",{path:n.toString(),value:e});let i=!0;const o=ew(t),a={};if(bs(e,(c,f)=>{i=!1,a[c]=T$(Ni(n,c),Qi(f),t.serverSyncTree_,o)}),i)vs("update() called with empty data.  Don't do anything."),kp(0,r,"ok",void 0);else{const c=kD(t),f=function Xve(t,n,e,r){!function pve(t,n,e,r){lt(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:n,children:e,writeId:r,visible:!0}),t.visibleWrites=N2(t.visibleWrites,n,e),t.lastWriteId=r}(t.pendingWriteTree_,n,e,r);const i=fi.fromObject(e);return Oy(t,new Py({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,i))}(t.serverSyncTree_,n,a,c);ID(t.eventQueue_,f),t.server_.merge(n.toString(),e,(_,x)=>{const D="ok"===_;D||Xs("update at "+n+" failed: "+_);const A=Ip(t.serverSyncTree_,c,!D),N=A.length>0?Fy(t,n):n;Fl(t.eventQueue_,N,A),kp(0,r,_,x)}),bs(e,_=>{const x=lN(t,Ni(n,_));Fy(t,x)}),Fl(t.eventQueue_,n,[])}}(t._repo,t._path,n,e.wrapCallback(()=>{})),e.promise}function tw(t){t=Ao(t);const n=new dN(()=>{}),e=new nw(n);return function Cbe(t,n,e){const r=function nbe(t,n){const e=n._path;let r=null;t.syncPointTree_.foreachOnPath(e,(_,x)=>{const D=wa(_,e);r=r||Tp(x,D)});let i=t.syncPointTree_.get(e);i?r=r||Tp(i,Er()):(i=new m$,t.syncPointTree_=t.syncPointTree_.set(e,i));const o=null!=r,a=o?new Cp(r,!0,!1):null;return function Vve(t){return pD(t.viewCache_)}(g$(i,n,mD(t.pendingWriteTree_,n._path),o?a.getNode():Nn.EMPTY_NODE,o))}(t.serverSyncTree_,n);return null!=r?Promise.resolve(r):t.server_.get(n).then(i=>{const o=Qi(i).withIndex(n._queryParams.getIndex());let a;if($2(t.serverSyncTree_,n,e,!0),n._queryParams.loadsAllData())a=W0(t.serverSyncTree_,n._path,o);else{const c=K0(t.serverSyncTree_,n);a=w$(t.serverSyncTree_,n._path,o,c)}return Fl(t.eventQueue_,n._path,a),xD(t.serverSyncTree_,n,e,null,!0),o},i=>(Ly(t,"get for query "+ts(n)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,e).then(r=>new Eg(r,new bu(t._repo,t._path),t._queryParams.getIndex()))}class nw{constructor(n){this.callbackContext=n}respondsTo(n){return"value"===n}createEvent(n,e){const r=e._queryParams.getIndex();return new $$("value",this,new Eg(n.snapshotNode,new bu(e._repo,e._path),r))}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,null)}createCancelEvent(n,e){return this.callbackContext.hasCancelCallback?new q$(this,n,e):null}matches(n){return n instanceof nw&&(!n.callbackContext||!this.callbackContext||n.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class ND{constructor(n,e){this.eventType=n,this.callbackContext=e}respondsTo(n){let e="children_added"===n?"child_added":n;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(n,e){return this.callbackContext.hasCancelCallback?new q$(this,n,e):null}createEvent(n,e){lt(null!=n.childName,"Child events should have a childName.");const r=By(new bu(e._repo,e._path),n.childName),i=e._queryParams.getIndex();return new $$(n.type,this,new Eg(n.snapshotNode,r,i),n.prevName)}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,n.prevName)}matches(n){return n instanceof ND&&this.eventType===n.eventType&&(!this.callbackContext||!n.callbackContext||this.callbackContext.matches(n.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Mp(t,n,e,r){return function rw(t,n,e,r,i){let o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){const f=e,_=(x,D)=>{sN(t._repo,t,c),f(x,D)};_.userCallback=e.userCallback,_.context=e.context,e=_}const a=new dN(e,o||void 0),c="value"===n?new nw(a):new ND(n,a);return function Abe(t,n,e){let r;r=".info"===zn(n._path)?$2(t.infoSyncTree_,n,e):$2(t.serverSyncTree_,n,e),R$(t.eventQueue_,n._path,r)}(t._repo,t,c),()=>sN(t._repo,t,c)}(t,"value",n,e,r)}function OD(t,n,e){let r=null;const i=e?new dN(e):null;"value"===n?r=new nw(i):n&&(r=new ND(n,i)),sN(t._repo,t,r)}class wu{}class Hbe extends wu{constructor(n){super(),this._limit=n,this.type="limitToLast"}_apply(n){if(n._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Bl(n._repo,n._path,function Jye(t,n){const e=t.copy();return e.limitSet_=!0,e.limit_=n,e.viewFrom_="r",e}(n._queryParams,this._limit),n._orderByCalled)}}(function Hve(t){lt(!vD,"__referenceConstructor has already been defined"),vD=t})(bu),function Kve(t){lt(!wD,"__referenceConstructor has already been defined"),wD=t}(bu);const hN={};function Z$(t,n,e,r,i){let o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||xd("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vs("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let f,_,a=uN(o,i),c=a.repoInfo;typeof process<"u"&&process.env&&(_=process.env.FIREBASE_DATABASE_EMULATOR_HOST),_?(f=!0,o=`http://${_}?ns=${c.namespace}`,a=uN(o,i),c=a.repoInfo):f=!a.repoInfo.secure;const x=i&&f?new O0(O0.OWNER):new iye(t.name,t.options,n);(function(t,n){const e=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!SD(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==e.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),k$(t)}(e))throw new Error(ag(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",a),Un(a.path)||xd("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function e0e(t,n,e,r){let i=hN[n.name];i||(i={},hN[n.name]=i);let o=i[t.toURLString()];return o&&xd("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new wbe(t,false,e,r),i[t.toURLString()]=o,o}(c,t,x,new rye(t.name,e));return new n0e(D,t)}class n0e{constructor(n,e){this._repoInternal=n,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function xbe(t,n,e){if(t.stats_=f2(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new uD(t.repoInfo_,(r,i,o,a)=>{L$(t,r,i,o,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>F$(t,!0),0);else{if(typeof e<"u"&&null!==e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ts(e)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new yg(t.repoInfo_,n,(r,i,o,a)=>{L$(t,r,i,o,a)},r=>{F$(t,r)},r=>{!function Ebe(t,n){bs(n,(e,r)=>{iN(t,e,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,e),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function aye(t,n){const e=t.toString();return h2[e]||(h2[e]=n()),h2[e]}(t.repoInfo_,()=>new ave(t.stats_,t.server_)),t.infoData_=new nve,t.infoSyncTree_=new b$({startListening:(r,i,o,a)=>{let c=[];const f=t.infoData_.getNode(r._path);return f.isEmpty()||(c=W0(t.infoSyncTree_,r._path,f),setTimeout(()=>{a("ok")},0)),c},stopListening:()=>{}}),iN(t,"connected",!1),t.serverSyncTree_=new b$({startListening:(r,i,o,a)=>(t.server_.listen(r,o,i,(c,f)=>{const _=a(c,f);Fl(t.eventQueue_,r._path,_)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new bu(this._repo,Er())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Jbe(t,n){const e=hN[n];(!e||e[t.key]!==t)&&xd(`Database ${n}(${t.repoInfo_}) has already been deleted.`),function V$(t){t.persistentConnection_&&t.persistentConnection_.interrupt("repo_interrupt")}(t),delete e[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){null===this._rootInternal&&xd("Cannot call "+n+" on a deleted database.")}}yg.prototype.simpleListen=function(t,n){this.sendRequest("q",{p:t},n)},yg.prototype.echo=function(t,n){this.sendRequest("echo",{d:t},n)},function o0e(t){(function tH(t){o2=t})(dg),ug(new yp("database",(n,{instanceIdentifier:e})=>Z$(n.getProvider("app").getImmediate(),n.getProvider("auth-internal"),n.getProvider("app-check-internal"),e),"PUBLIC").setMultipleInstances(!0)),_u(J8,"1.0.8",t),_u(J8,"1.0.8","esm2017")}();const X$="firebasestorage.googleapis.com",Q$="storageBucket";class Ji extends Bh{constructor(n,e,r=0){super(fN(n),`Firebase Storage: ${e} (${fN(n)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ji.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return fN(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Oi=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Oi||{});function fN(t){return"storage/"+t}function pN(){return new Ji(Oi.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function mN(t){return new Ji(Oi.INVALID_ARGUMENT,t)}function nq(){return new Ji(Oi.APP_DELETED,"The Firebase app was deleted.")}function iw(t,n){return new Ji(Oi.INVALID_FORMAT,"String does not match format '"+t+"': "+n)}function ow(t){throw new Ji(Oi.INTERNAL_ERROR,"Internal error: "+t)}class xa{constructor(n,e){this.bucket=n,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,e){let r;try{r=xa.makeFromUrl(n,e)}catch{return new xa(n,"")}if(""===r.path)return r;throw function _0e(t){return new Ji(Oi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(n)}static makeFromUrl(n,e){let r=null;const i="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+i+"(/(.*))?$","i");function _(Se){Se.path_=decodeURIComponent(Se.path)}const D=e.replace(/[.]/g,"\\."),We=[{regex:c,indices:{bucket:1,path:3},postModify:function o(Se){"/"===Se.path.charAt(Se.path.length-1)&&(Se.path_=Se.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${D}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:_},{regex:new RegExp(`^https?://${e===X$?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:_}];for(let Se=0;Se<We.length;Se++){const Ee=We[Se],Be=Ee.regex.exec(n);if(Be){let mt=Be[Ee.indices.path];mt||(mt=""),r=new xa(Be[Ee.indices.bucket],mt),Ee.postModify(r);break}}if(null==r)throw function g0e(t){return new Ji(Oi.INVALID_URL,"Invalid URL '"+t+"'.")}(n);return r}}class E0e{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function LD(t){return"string"==typeof t||t instanceof String}function rq(t){return gN()&&t instanceof Blob}function gN(){return typeof Blob<"u"}function _N(t,n,e,r){if(r<n)throw mN(`Invalid value for '${t}'. Expected ${n} or greater.`);if(r>e)throw mN(`Invalid value for '${t}'. Expected ${e} or less.`)}function Yh(t,n,e){let r=n;return null==e&&(r=`https://${n}`),`${e}://${r}/v0${t}`}function iq(t){const n=encodeURIComponent;let e="?";for(const r in t)t.hasOwnProperty(r)&&(e=e+(n(r)+"=")+n(t[r])+"&");return e=e.slice(0,-1),e}var zy=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(zy||{});class k0e{constructor(n,e,r,i,o,a,c,f,_,x,D,A=!0){this.url_=n,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=c,this.errorCallback_=f,this.timeout_=_,this.progressCallback_=x,this.connectionFactory_=D,this.retry=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,B)=>{this.resolve_=N,this.reject_=B,this.start_()})}start_(){const e=(r,i)=>{const o=this.resolve_,a=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(c,c.getResponse());!function T0e(t){return void 0!==t}(f)?o():o(f)}catch(f){a(f)}else if(null!==c){const f=pN();f.serverResponse=c.getErrorText(),a(this.errorCallback_?this.errorCallback_(c,f):f)}else a(i.canceled?this.appDelete_?nq():function eq(){return new Ji(Oi.CANCELED,"User canceled the upload/download.")}():function J$(){return new Ji(Oi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?e(0,new FD(!1,null,!0)):this.backoffId_=function C0e(t,n,e){let r=1,i=null,o=null,a=!1,c=0;function f(){return 2===c}let _=!1;function x(...ce){_||(_=!0,n.apply(null,ce))}function D(ce){i=setTimeout(()=>{i=null,t(N,f())},ce)}function A(){o&&clearTimeout(o)}function N(ce,...we){if(_)return void A();if(ce)return A(),void x.call(null,ce,...we);if(f()||a)return A(),void x.call(null,ce,...we);let We;r<64&&(r*=2),1===c?(c=2,We=0):We=1e3*(r+Math.random()),D(We)}let B=!1;function te(ce){B||(B=!0,A(),!_&&(null!==i?(ce||(c=2),clearTimeout(i),D(0)):ce||(c=1)))}return D(0),o=setTimeout(()=>{a=!0,te(!0)},e),te}((r,i)=>{if(i)return void r(!1,new FD(!1,null,!0));const o=this.connectionFactory_();this.pendingConnection_=o;const a=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const c=o.getErrorCode()===zy.NO_ERROR,f=o.getStatus();if(!c||function oq(t,n){const e=t>=500&&t<600,i=-1!==[408,429].indexOf(t),o=-1!==n.indexOf(t);return e||i||o}(f,this.additionalRetryCodes_)&&this.retry){const x=o.getErrorCode()===zy.ABORT;return void r(!1,new FD(!1,null,x))}const _=-1!==this.successCodes_.indexOf(f);r(!0,new FD(_,o))})},e,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,null!==this.backoffId_&&function D0e(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class FD{constructor(n,e,r){this.wasSuccessCode=n,this.connection=e,this.canceled=!!r}}function L0e(...t){const n=function O0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==n){const e=new n;for(let r=0;r<t.length;r++)e.append(t[r]);return e.getBlob()}if(gN())return new Blob(t);throw new Ji(Oi.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}class yN{constructor(n,e){this.data=n,this.contentType=e||null}}function aq(t){const n=[];for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);r<=127?n.push(r):r<=2047?n.push(192|r>>6,128|63&r):55296==(64512&r)?e<t.length-1&&56320==(64512&t.charCodeAt(e+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++e),n.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):n.push(239,191,189):56320==(64512&r)?n.push(239,191,189):n.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(n)}function lq(t,n){switch(t){case"base64":{const i=-1!==n.indexOf("-"),o=-1!==n.indexOf("_");if(i||o)throw iw(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case"base64url":{const i=-1!==n.indexOf("+"),o=-1!==n.indexOf("/");if(i||o)throw iw(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=function B0e(t){if(typeof atob>"u")throw function w0e(t){return new Ji(Oi.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(n)}catch(i){throw i.message.includes("polyfill")?i:iw(t,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class cq{constructor(n){this.base64=!1,this.contentType=null;const e=n.match(/^data:([^,]+)?,/);if(null===e)throw iw("data_url","Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;null!=r&&(this.base64=function j0e(t,n){return t.length>=n.length&&t.substring(t.length-n.length)===n}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=n.substring(n.indexOf(",")+1)}}class Xh{constructor(n,e){let r=0,i="";rq(n)?(this.data_=n,r=n.size,i=n.type):n instanceof ArrayBuffer?(e?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),r=this.data_.length):n instanceof Uint8Array&&(e?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),r=n.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(n,e){if(rq(this.data_)){const i=function F0e(t,n,e){return t.webkitSlice?t.webkitSlice(n,e):t.mozSlice?t.mozSlice(n,e):t.slice?t.slice(n,e):null}(this.data_,n,e);return null===i?null:new Xh(i)}{const r=new Uint8Array(this.data_.buffer,n,e-n);return new Xh(r,!0)}}static getBlob(...n){if(gN()){const e=n.map(r=>r instanceof Xh?r.data_:r);return new Xh(L0e.apply(null,e))}{const e=n.map(a=>LD(a)?function sq(t,n){switch(t){case"raw":return new yN(aq(n));case"base64":case"base64url":return new yN(lq(t,n));case"data_url":return new yN(function z0e(t){const n=new cq(t);return n.base64?lq("base64",n.rest):function V0e(t){let n;try{n=decodeURIComponent(t)}catch{throw iw("data_url","Malformed data URL.")}return aq(n)}(n.rest)}(n),function U0e(t){return new cq(t).contentType}(n))}throw pN()}("raw",a).data:a.data_);let r=0;e.forEach(a=>{r+=a.byteLength});const i=new Uint8Array(r);let o=0;return e.forEach(a=>{for(let c=0;c<a.length;c++)i[o++]=a[c]}),new Xh(i,!0)}}uploadData(){return this.data_}}function vN(t){let n;try{n=JSON.parse(t)}catch{return null}return function I0e(t){return"object"==typeof t&&!Array.isArray(t)}(n)?n:null}function uq(t){const n=t.lastIndexOf("/",t.length-2);return-1===n?t:t.slice(n+1)}function q0e(t,n){return n}class Ea{constructor(n,e,r,i){this.server=n,this.local=e||n,this.writable=!!r,this.xform=i||q0e}}let BD=null;function sw(){if(BD)return BD;const t=[];t.push(new Ea("bucket")),t.push(new Ea("generation")),t.push(new Ea("metageneration")),t.push(new Ea("name","fullPath",!0));const e=new Ea("name");e.xform=function n(o,a){return function G0e(t){return!LD(t)||t.length<2?t:uq(t)}(a)},t.push(e);const i=new Ea("size");return i.xform=function r(o,a){return void 0!==a?Number(a):a},t.push(i),t.push(new Ea("timeCreated")),t.push(new Ea("updated")),t.push(new Ea("md5Hash",null,!0)),t.push(new Ea("cacheControl",null,!0)),t.push(new Ea("contentDisposition",null,!0)),t.push(new Ea("contentEncoding",null,!0)),t.push(new Ea("contentLanguage",null,!0)),t.push(new Ea("contentType",null,!0)),t.push(new Ea("metadata","customMetadata",!0)),BD=t,BD}function dq(t,n,e){const r=vN(n);return null===r?null:function K0e(t,n,e){const r={type:"file"},i=e.length;for(let o=0;o<i;o++){const a=e[o];r[a.local]=a.xform(r,n[a.server])}return function W0e(t,n){Object.defineProperty(t,"ref",{get:function e(){const o=new xa(t.bucket,t.fullPath);return n._makeStorageReference(o)}})}(r,t),r}(t,r,e)}class Id{constructor(n,e,r,i){this.url=n,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function kd(t){if(!t)throw pN()}function Uy(t){return function n(e,r){let i;return i=401===e.getStatus()?e.getErrorText().includes("Firebase App Check token is invalid")?function p0e(){return new Ji(Oi.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function f0e(){return new Ji(Oi.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===e.getStatus()?function h0e(t){return new Ji(Oi.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===e.getStatus()?function m0e(t){return new Ji(Oi.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}}function aw(t){const n=Uy(t);return function e(r,i){let o=n(r,i);return 404===r.getStatus()&&(o=function d0e(t){return new Ji(Oi.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),o.serverResponse=i.serverResponse,o}}function _q(t,n,e,r,i){const o=n.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},f=function c(){let We="";for(let Se=0;Se<2;Se++)We+=Math.random().toString().slice(2);return We}();a["Content-Type"]="multipart/related; boundary="+f;const _=function gq(t,n,e){const r=Object.assign({},e);return r.fullPath=t.path,r.size=n.size(),r.contentType||(r.contentType=function iwe(t,n){return t&&t.contentType||n&&n.type()||"application/octet-stream"}(null,n)),r}(n,r,i),x=function bN(t,n){const e={},r=n.length;for(let i=0;i<r;i++){const o=n[i];o.writable&&(e[o.server]=t[o.local])}return JSON.stringify(e)}(_,e),N=Xh.getBlob("--"+f+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+x+"\r\n--"+f+"\r\nContent-Type: "+_.contentType+"\r\n\r\n",r,"\r\n--"+f+"--");if(null===N)throw function tq(){return new Ji(Oi.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const B={name:_.fullPath},te=Yh(o,t.host,t._protocol),we=t.maxUploadRetryTime,Ce=new Id(te,"POST",function VD(t,n){return function e(r,i){const o=dq(t,i,n);return kd(null!==o),o}}(t,e),we);return Ce.urlParams=B,Ce.headers=a,Ce.body=N.uploadData(),Ce.errorHandler=Uy(n),Ce}class cwe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zy.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zy.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zy.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,e,r,i){if(this.sent_)throw ow("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,n,!0),void 0!==i)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ow("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ow("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ow("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ow("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",n)}}class uwe extends cwe{initXhr(){this.xhr_.responseType="text"}}function Eu(){return new uwe}class Tg{constructor(n,e){this._service=n,this._location=e instanceof xa?e:xa.makeFromUrl(e,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,e){return new Tg(n,e)}get root(){const n=new xa(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return uq(this._location.path)}get storage(){return this._service}get parent(){const n=function H0e(t){if(0===t.length)return null;const n=t.lastIndexOf("/");return-1===n?"":t.slice(0,n)}(this._location.path);if(null===n)return null;const e=new xa(this._location.bucket,n);return new Tg(this._service,e)}_throwIfRoot(n){if(""===this._location.path)throw function x0e(t){return new Ji(Oi.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(n)}}function Ewe(t){t._throwIfRoot("getDownloadURL");const n=function twe(t,n,e){const i=Yh(n.fullServerUrl(),t.host,t._protocol),a=t.maxOperationRetryTime,c=new Id(i,"GET",function J0e(t,n){return function e(r,i){const o=dq(t,i,n);return kd(null!==o),function Z0e(t,n,e,r){const i=vN(n);if(null===i||!LD(i.downloadTokens))return null;const o=i.downloadTokens;if(0===o.length)return null;const a=encodeURIComponent;return o.split(",").map(_=>{const D=t.fullPath;return Yh("/b/"+a(t.bucket)+"/o/"+a(D),e,r)+iq({alt:"media",token:_})})[0]}(o,i,t.host,t._protocol)}}(t,e),a);return c.errorHandler=aw(n),c}(t.storage,t._location,sw());return t.storage.makeRequestWithTokens(n,Eu).then(e=>{if(null===e)throw function b0e(){return new Ji(Oi.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return e})}function Cq(t,n){if(t instanceof CN){const e=t;if(null==e._bucket)throw function y0e(){return new Ji(Oi.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Q$+"' property when initializing the app?")}();const r=new Tg(e,e._bucket);return null!=n?Cq(r,n):r}return void 0!==n?function Eq(t,n){const e=function $0e(t,n){const e=n.split("/").filter(r=>r.length>0).join("/");return 0===t.length?e:t+"/"+e}(t._location.path,n),r=new xa(t._location.bucket,e);return new Tg(t.storage,r)}(t,n):t}function Dq(t,n){const e=n?.[Q$];return null==e?null:xa.makeFromBucketSpec(e,t)}class CN{constructor(n,e,r,i,o){this.app=n,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=X$,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?xa.makeFromBucketSpec(i,this._host):Dq(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._bucket=null!=this._url?xa.makeFromBucketSpec(this._url,n):Dq(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){_N("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){_N("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){var n=this;return fe(function*(){if(n._overrideAuthToken)return n._overrideAuthToken;const e=n._authProvider.getImmediate({optional:!0});if(e){const r=yield e.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var n=this;return fe(function*(){const e=n._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new Tg(this,n)}_makeRequest(n,e,r,i,o=!0){if(this._deleted)return new E0e(nq());{const a=function N0e(t,n,e,r,i,o,a=!0){const c=iq(t.urlParams),f=t.url+c,_=Object.assign({},t.headers);return function R0e(t,n){n&&(t["X-Firebase-GMPID"]=n)}(_,n),function A0e(t,n){null!==n&&n.length>0&&(t.Authorization="Firebase "+n)}(_,e),function M0e(t,n){t["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}(_,o),function P0e(t,n){null!==n&&(t["X-Firebase-AppCheck"]=n)}(_,r),new k0e(f,t.method,_,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}(n,this._appId,r,i,e,this._firebaseVersion,o);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(n,e){var r=this;return fe(function*(){const[i,o]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(n,e,i,o).getPromise()})()}}const Tq="@firebase/storage",Iq="storage";function DN(t,n,e){return function bq(t,n,e){t._throwIfRoot("uploadBytes");const r=_q(t.storage,t._location,sw(),new Xh(n,!0),e);return t.storage.makeRequestWithTokens(r,Eu).then(i=>({metadata:i,ref:t}))}(t=Ao(t),n,e)}function TN(t){return Ewe(t=Ao(t))}function kq(t){return function Cwe(t){t._throwIfRoot("deleteObject");const n=function rwe(t,n){const r=Yh(n.fullServerUrl(),t.host,t._protocol),c=new Id(r,"DELETE",function a(f,_){},t.maxOperationRetryTime);return c.successCodes=[200,204],c.errorHandler=aw(n),c}(t.storage,t._location);return t.storage.makeRequestWithTokens(n,Eu)}(t=Ao(t))}function lw(t,n){return function Swe(t,n){if(n&&function Dwe(t){return/^[A-Za-z]+:\/\//.test(t)}(n)){if(t instanceof CN)return function Twe(t,n){return new Tg(t,n)}(t,n);throw mN("To use ref(service, url), the first argument must be a Storage instance.")}return Cq(t,n)}(t=Ao(t),n)}function Mwe(t,{instanceIdentifier:n}){const e=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new CN(e,r,i,n,dg)}!function Rwe(){ug(new yp(Iq,Mwe,"PUBLIC").setMultipleInstances(!0)),_u(Tq,"0.13.2",""),_u(Tq,"0.13.2","esm2017")}();const SN=N6({apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",authDomain:"familyapp-e83b7.firebaseapp.com",databaseURL:"https://familyapp-e83b7-default-rtdb.europe-west1.firebasedatabase.app",projectId:"familyapp-e83b7",storageBucket:"familyapp-e83b7.appspot.com",messagingSenderId:"728695329604",appId:"1:728695329604:web:c0a1ef7ebf32de4bcd7d11"}),ho=function H_e(t=zM()){const n=m0(t,"auth");if(n.isInitialized())return n.getImmediate();const e=function Ame(t,n){const e=m0(t,"auth");if(e.isInitialized()){const i=e.getImmediate();if(RC(e.getOptions(),n??{}))return i;ol(i,"already-initialized")}return e.initialize({options:n})}(t,{popupRedirectResolver:F_e,persistence:[Nge,wge,M8]}),r=x6("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const a=j_e(o.toString());(function fge(t,n,e){Ao(t).beforeAuthStateChanged(n,e)})(e,a,()=>a(e.currentUser)),function hge(t,n,e,r){Ao(t).onIdTokenChanged(n,e,r)}(e,c=>a(c))}}const i=v6("auth");return i&&function Rme(t,n,e){const r=Mo(t);ft(r._canInitEmulator,r,"emulator-config-failed"),ft(/^https?:\/\//.test(n),r,"invalid-emulator-scheme");const i=!!e?.disableWarnings,o=g8(n),{host:a,port:c}=function Pme(t){const n=g8(t),e=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:_8(r.substr(o.length+1))}}{const[o,a]=r.split(":");return{host:o,port:_8(a)}}}(n);r.config.emulator={url:`${o}//${a}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function Nme(){function t(){const n=document.createElement("p"),e=n.style;n.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",n.classList.add("firebase-emulator-warning"),document.body.appendChild(n)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(e,`http://${i}`),e}(SN),Lr=function r0e(t=zM(),n){const e=m0(t,"database").getImmediate({identifier:n});if(!e._instanceStarted){const r=b6("database");r&&function i0e(t,n,e,r={}){(t=Ao(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&xd("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&xd('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new O0(O0.OWNER);else if(r.mockUserToken){const a="string"==typeof r.mockUserToken?r.mockUserToken:E6(r.mockUserToken,t.app.options.projectId);o=new O0(a)}!function Qbe(t,n,e,r){t.repoInfo_=new u2(`${n}:${e}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,n,e,o)}(e,...r)}return e}(SN),cw=function kwe(t=zM(),n){const r=m0(t=Ao(t),Iq).getImmediate({identifier:n}),i=b6("storage");return i&&function Awe(t,n,e,r={}){!function Iwe(t,n,e,r={}){t.host=`${n}:${e}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:E6(i,t.app.options.projectId))}(t,n,e,r)}(r,...i),r}(SN);let UD=(()=>{class t{constructor(){}getUserData(){return new U(e=>WC(ho,i=>{i?tw(Ir(Lr,"/users/"+i.uid)).then(o=>{const a=o.val();e.next(a)}).catch(o=>{e.error(o)}):e.next(null)},i=>{e.error(i)},()=>{e.complete()}))}updateUserData(e,r){return Dg(Ir(Lr,`/users/${e}`),r)}deleteOldAvatar(e){return e&&e.includes("firebasestorage.googleapis.com")?kq(lw(cw,e)).catch(()=>{}):Promise.resolve()}compressImage(e,r=400,i=.7){return new Promise((o,a)=>{const c=new Image,f=new FileReader;f.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let D=c.width,A=c.height;D>r&&(A=Math.round(A*r/D),D=r),x.width=D,x.height=A,x.getContext("2d").drawImage(c,0,0,D,A),x.toBlob(B=>B?o(B):a("Compression echouee"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},f.onerror=a,f.readAsDataURL(e)})}uploadFile(e){return this.compressImage(e).then(r=>{const i=Date.now().toString();return DN(lw(cw,"/avatars/"+i+".jpg"),r,{contentType:"image/jpeg"}).then(a=>TN(a.ref))})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Ad=(()=>{class t{constructor(){this.googleToken$=new J,this.redirectReady=Promise.resolve(),this.allUsers=[]}signInWithGoogle(){var e=this;return fe(function*(){const r=new w8;r.addScope("https://www.googleapis.com/auth/calendar"),r.addScope("https://www.googleapis.com/auth/drive");const i=yield function Jge(t,n,e){return zP.apply(this,arguments)}(ho,r),o=w8.credentialFromResult(i);o?.accessToken&&e.googleToken$.next(o.accessToken);const a=i.user,c=Ir(Lr,"/users/"+a.uid),_=(yield tw(c)).val()||{},x=_.photoURL,D=_.displayName,A=x&&""!==x.trim(),N=D&&""!==D.trim(),B={email:a.email||"",uid:a.uid,displayName:N?D:a.displayName||"",photoURL:A?x:a.photoURL||""};yield Dg(c,B)})()}signOutUser(){!function pge(t){Ao(t).signOut()}(ho)}getAllUsers(){return tw(Ir(Lr,"/users")).then(e=>{const r=e.val();return this.allUsers=r?Object.keys(r).map(i=>({id:i,...r[i]})):[],this.allUsers})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Pwe=(()=>{class t{constructor(e,r){this.editProfileService=e,this.authService=r,this.userName="",this.userPhoto=""}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{e&&(this.userName=e.displayName||"",this.userPhoto=e.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg")})}onSignOut(){this.authService.signOutUser()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Re(UD),Re(Ad))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-sidebar"]],decls:24,vars:0,consts:[[1,"w-64","h-screen","bg-white/80","backdrop-blur-lg","border-r","border-warm-100","flex","flex-col","p-4","sticky","top-0"],[1,"flex","items-center","gap-3","px-3","py-4","mb-6"],[1,"font-display","font-extrabold","text-xl","text-gradient"],[1,"flex-1","space-y-1"],["routerLink","/home","routerLinkActive","bg-gradient-to-r from-family-pink/10 to-family-orange/10 text-family-pink",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/chat","routerLinkActive","bg-gradient-to-r from-family-coral/10 to-family-orange/10 text-family-coral",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/add-task","routerLinkActive","bg-gradient-to-r from-family-purple/10 to-family-lavender/10 text-family-purple",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/shopping","routerLinkActive","bg-gradient-to-r from-family-green/10 to-family-green/10 text-family-green",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/map","routerLinkActive","bg-gradient-to-r from-family-sky/10 to-family-sky/10 text-family-sky",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/calendar","routerLinkActive","bg-gradient-to-r from-family-yellow/10 to-family-orange/10 text-family-orange",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/documents","routerLinkActive","bg-gradient-to-r from-family-purple/10 to-family-lavender/10 text-family-purple",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],["routerLink","/vacances","routerLinkActive","bg-gradient-to-r from-family-coral/10 to-family-orange/10 text-family-coral",1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-600","hover:bg-warm-50","transition-all","font-medium"],[1,"border-t","border-warm-100","pt-4"],[1,"flex","items-center","gap-3","px-4","py-3","rounded-xl","text-gray-400","hover:bg-red-50","hover:text-red-400","transition-all","font-medium","w-full","text-left",3,"click"]],template:function(r,i){1&r&&(j(0,"aside",0)(1,"div",1)(2,"h1",2),Y(3,"Family App"),G()(),j(4,"nav",3)(5,"a",4),Y(6," Tableau de bord "),G(),j(7,"a",5),Y(8," Fil d'actu "),G(),j(9,"a",6),Y(10," Nouvelle tache "),G(),j(11,"a",7),Y(12," Courses "),G(),j(13,"a",8),Y(14," Carte "),G(),j(15,"a",9),Y(16," Calendrier "),G(),j(17,"a",10),Y(18," Documents "),G(),j(19,"a",11),Y(20," Vacances "),G()(),j(21,"div",12)(22,"button",13),Ge("click",function(){return i.onSignOut()}),Y(23," Deconnexion "),G()()())},dependencies:[Yb,fp,OA],encapsulation:2})}}return t})();const Nwe=()=>({exact:!1});function Owe(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"a",12),Ge("click",function(){return He(e),Ze(xe().showMore=!1)}),j(2,"span"),Y(3,"\u270f\ufe0f"),G(),Y(4," Taches "),G(),j(5,"a",13),Ge("click",function(){return He(e),Ze(xe().showMore=!1)}),j(6,"span"),Y(7,"\u{1f4c5}"),G(),Y(8," Agenda "),G(),j(9,"a",14),Ge("click",function(){return He(e),Ze(xe().showMore=!1)}),j(10,"span"),Y(11,"\u{1f4c1}"),G(),Y(12," Docs "),G(),j(13,"a",15),Ge("click",function(){return He(e),Ze(xe().showMore=!1)}),j(14,"span"),Y(15,"\u{1f3d6}\ufe0f"),G(),Y(16," Vacances "),G()()}}function Lwe(t,n){if(1&t){const e=yn();j(0,"div",16),Ge("click",function(){return He(e),Ze(xe().showMore=!1)}),G()}}let Fwe=(()=>{class t{constructor(){this.showMore=!1}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=_r({type:t,selectors:[["app-bottom-nav"]],decls:30,vars:6,consts:[[1,"fixed","bottom-0","left-0","right-0","bg-white/90","backdrop-blur-lg","border-t","border-warm-100","pb-safe","z-50"],[1,"flex","justify-around","items-center","h-16"],["routerLink","/home","routerLinkActive","text-family-pink",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90",3,"routerLinkActiveOptions"],[1,"text-lg"],[1,"text-[9px]","font-medium"],["routerLink","/chat","routerLinkActive","text-family-coral",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],["routerLink","/map","routerLinkActive","text-family-sky",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],["routerLink","/shopping","routerLinkActive","text-family-green",1,"flex","flex-col","items-center","justify-center","gap-0.5","text-gray-400","transition-all","active:scale-90"],[1,"relative"],[3,"click"],[1,"absolute","bottom-14","right-0","bg-white","rounded-2xl","shadow-lg","border","border-gray-100","p-2","min-w-[140px]","z-50"],[1,"fixed","inset-0","z-40"],["routerLink","/add-task","routerLinkActive","text-family-purple",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/calendar","routerLinkActive","text-family-orange",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/documents","routerLinkActive","text-family-purple",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],["routerLink","/vacances","routerLinkActive","text-family-coral",1,"flex","items-center","gap-3","px-3","py-2.5","rounded-xl","text-gray-600","hover:bg-gray-50","transition-all","text-sm",3,"click"],[1,"fixed","inset-0","z-40",3,"click"]],template:function(r,i){1&r&&(j(0,"nav",0)(1,"div",1)(2,"a",2)(3,"span",3),Y(4,"\u{1f3e0}"),G(),j(5,"span",4),Y(6,"Accueil"),G()(),j(7,"a",5)(8,"span",3),Y(9,"\u{1f4f1}"),G(),j(10,"span",4),Y(11,"Fil"),G()(),j(12,"a",6)(13,"span",3),Y(14,"\u{1f5fa}\ufe0f"),G(),j(15,"span",4),Y(16,"Carte"),G()(),j(17,"a",7)(18,"span",3),Y(19,"\u{1f6d2}"),G(),j(20,"span",4),Y(21,"Courses"),G()(),j(22,"div",8)(23,"button",9),Ge("click",function(){return i.showMore=!i.showMore}),j(24,"span",3),Y(25,"\u2022\u2022\u2022"),G(),j(26,"span",4),Y(27,"Plus"),G()(),vt(28,Owe,17,0,"div",10),G()()(),vt(29,Lwe,1,0,"div",11)),2&r&&(le(2),gn("routerLinkActiveOptions",function v3(t,n){const e=Fn()+t,r=Pe();return r[e]===Nr?ud(r,e,n()):function Qv(t,n){return t[n]}(r,e)}(5,Nwe)),le(21),sp(i.showMore?"flex flex-col items-center justify-center gap-0.5 text-family-pink transition-all active:scale-90":"flex flex-col items-center justify-center gap-0.5 text-gray-400 transition-all active:scale-90"),le(5),bt(i.showMore?28:-1),le(),bt(i.showMore?29:-1))},dependencies:[Yb,fp,OA,Rh],encapsulation:2})}}return t})();function Bwe(t,n){if(1&t&&(j(0,"a",0),wt(1,"img",1),j(2,"span",2),Y(3),G()()),2&t){const e=xe();le(),gn("src",e.fileUrl,So),le(2),Lt(e.user.displayName)}}let Vwe=(()=>{class t{constructor(e){this.editProfileService=e,this.user=null}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{this.user=e,this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"},e=>{console.error(e)})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Re(UD))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-user-avatar"]],decls:1,vars:1,consts:[["routerLink","/user-profile",1,"flex","items-center","gap-2","hover:opacity-80","transition-opacity"],["alt","Photo de profil","referrerpolicy","no-referrer",1,"w-9","h-9","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"font-medium","text-sm","text-gray-700","hidden","md:inline"]],template:function(r,i){1&r&&vt(0,Bwe,4,2,"a",0),2&r&&bt(i.user?0:-1)},dependencies:[Yb,fp],encapsulation:2})}}return t})(),zwe=(()=>{class t{constructor(e){this.authService=e}onSignOut(){this.authService.signOutUser()}static{this.\u0275fac=function(r){return new(r||t)(Re(Ad))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-top-bar"]],decls:9,vars:0,consts:[[1,"flex","items-center","justify-between","px-4","md:px-6","py-3","bg-white/60","backdrop-blur-sm","border-b","border-warm-100"],[1,"flex","items-center","gap-2","md:hidden"],[1,"font-display","font-bold","text-lg","text-gradient"],[1,"hidden","md:block"],[1,"flex","items-center","gap-3"],[1,"md:hidden","text-gray-400","hover:text-red-400","transition-colors","text-sm","font-medium",3,"click"]],template:function(r,i){1&r&&(j(0,"header",0)(1,"div",1)(2,"span",2),Y(3,"Family App"),G()(),wt(4,"div",3),j(5,"div",4),wt(6,"app-user-avatar"),j(7,"button",5),Ge("click",function(){return i.onSignOut()}),Y(8," Deconnexion "),G()()())},dependencies:[Vwe],encapsulation:2})}}return t})(),Aq=(()=>{class t{constructor(){this.watchId=null}startTracking(){if(!navigator.geolocation)return;const e=ho.currentUser;e&&(this.watchId=navigator.geolocation.watchPosition(r=>{Sd(Ir(Lr,`/locations/${e.uid}`),{lat:r.coords.latitude,lng:r.coords.longitude,timestamp:Date.now(),displayName:e.displayName||"",photoURL:e.photoURL||""})},()=>{},{enableHighAccuracy:!0,maximumAge:3e4,timeout:1e4}))}stopTracking(){null!==this.watchId&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null)}listenAllLocations(e){const r=Ir(Lr,"/locations");return Mp(r,o=>{e(o.val()||{})}),()=>OD(r)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Mq(t=0,n=eM){return t<0&&(t=0),R5(t,t,n)}let Uwe=(()=>{class t{constructor(e,r,i){this.swUpdate=e,this.snackBar=r,this.appRef=i}init(){this.swUpdate.isEnabled&&(Rb(this.appRef.isStable.pipe(up(o=>!0===o)),Mq(18e5)).subscribe(()=>{this.swUpdate.checkForUpdate().catch(()=>{})}),this.swUpdate.versionUpdates.pipe(_s(o=>"VERSION_READY"===o.type)).subscribe(()=>{this.showUpdateNotification()}))}showUpdateNotification(){this.snackBar.open("\u{1f680} Nouvelle version disponible !","Mettre \xe0 jour",{duration:0,horizontalPosition:"center",verticalPosition:"bottom",panelClass:["update-snackbar"]}).onAction().subscribe(()=>{this.applyUpdate()})}applyUpdate(){this.swUpdate.activateUpdate().then(()=>{window.location.reload()})}static{this.\u0275fac=function(r){return new(r||t)(Dt(CM),Dt(ig),Dt(Qa))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function jwe(t,n){1&t&&(j(0,"div",0),wt(1,"app-sidebar",1),j(2,"div",2),wt(3,"app-top-bar"),j(4,"main",3),wt(5,"router-outlet"),G(),wt(6,"app-bottom-nav",4),G()())}function Hwe(t,n){1&t&&wt(0,"router-outlet")}let $we=(()=>{class t{constructor(e,r){this.locationService=e,this.updateService=r,this.title="FamilyApp",this.isAuth=!1}ngOnInit(){this.updateService.init(),WC(ho,e=>{this.isAuth=!!e,e?this.locationService.startTracking():this.locationService.stopTracking()})}static{this.\u0275fac=function(r){return new(r||t)(Re(Aq),Re(Uwe))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"flex","h-screen"],[1,"hidden","md:flex","flex-shrink-0"],[1,"flex-1","flex","flex-col","min-h-screen","overflow-hidden"],[1,"flex-1","overflow-y-auto","p-4","md:p-6","pb-24","md:pb-6"],[1,"md:hidden"]],template:function(r,i){1&r&&vt(0,jwe,7,0,"div",0)(1,Hwe,1,0,"router-outlet"),2&r&&bt(i.isAuth?0:1)},dependencies:[CA,Pwe,Fwe,zwe],encapsulation:2})}}return t})(),Rq=(()=>{class t{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,r){this._renderer=e,this._elementRef=r}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(r){return new(r||t)(Re(Ka),Re(Vr))};static \u0275dir=Ft({type:t})}return t})(),Sg=(()=>{class t extends Rq{static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,features:[qn]})}return t})();const Md=new Fe(""),Gwe={provide:Md,useExisting:Kn(()=>IN),multi:!0};let IN=(()=>{class t extends Sg{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){1&r&&Ge("change",function(a){return i.onChange(a.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Sr([Gwe]),qn]})}return t})();const Wwe={provide:Md,useExisting:Kn(()=>Rc),multi:!0},Zwe=new Fe("");let Rc=(()=>{class t extends Rq{_compositionMode;_composing=!1;constructor(e,r,i){super(e,r),this._compositionMode=i,null==this._compositionMode&&(this._compositionMode=!function Kwe(){const t=lp()?lp().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(r){return new(r||t)(Re(Ka),Re(Vr),Re(Zwe,8))};static \u0275dir=Ft({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&Ge("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Sr([Wwe]),qn]})}return t})();function kN(t){return null==t||0===AN(t)}function AN(t){return null==t?null:Array.isArray(t)||"string"==typeof t?t.length:t instanceof Set?t.size:null}const Qs=new Fe(""),Rp=new Fe(""),Ywe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Pc{static min(n){return function Pq(t){return n=>{if(null==n.value||null==t)return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(n)}static max(n){return function Nq(t){return n=>{if(null==n.value||null==t)return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(n)}static required(n){return Oq(n)}static requiredTrue(n){return function Lq(t){return!0===t.value?null:{required:!0}}(n)}static email(n){return function Fq(t){return kN(t.value)||Ywe.test(t.value)?null:{email:!0}}(n)}static minLength(n){return function Bq(t){return n=>{const e=n.value?.length??AN(n.value);return null===e||0===e?null:e<t?{minlength:{requiredLength:t,actualLength:e}}:null}}(n)}static maxLength(n){return function Vq(t){return n=>{const e=n.value?.length??AN(n.value);return null!==e&&e>t?{maxlength:{requiredLength:t,actualLength:e}}:null}}(n)}static pattern(n){return function zq(t){if(!t)return jD;let n,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),r=>{if(kN(r.value))return null;const i=r.value;return n.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(n)}static nullValidator(n){return null}static compose(n){return Gq(n)}static composeAsync(n){return Wq(n)}}function Oq(t){return kN(t.value)?{required:!0}:null}function jD(t){return null}function Uq(t){return null!=t}function jq(t){return sb(t)?gs(t):t}function Hq(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function $q(t,n){return n.map(e=>e(t))}function qq(t){return t.map(n=>function Xwe(t){return!t.validate}(n)?n:e=>n.validate(e))}function Gq(t){if(!t)return null;const n=t.filter(Uq);return 0==n.length?null:function(e){return Hq($q(e,n))}}function MN(t){return null!=t?Gq(qq(t)):null}function Wq(t){if(!t)return null;const n=t.filter(Uq);return 0==n.length?null:function(e){return function qwe(...t){const n=D4(t),{args:e,keys:r}=T4(t),i=new U(o=>{const{length:a}=e;if(!a)return void o.complete();const c=new Array(a);let f=a,_=a;for(let x=0;x<a;x++){let D=!1;Dc(e[x]).subscribe(new si(o,A=>{D||(D=!0,_--),c[x]=A},()=>f--,void 0,()=>{(!f||!D)&&(_||o.next(r?I4(r,c):c),o.complete())}))}});return n?i.pipe(S4(n)):i}($q(e,n).map(jq)).pipe(hr(Hq))}}function RN(t){return null!=t?Wq(qq(t)):null}function Kq(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function Zq(t){return t._rawValidators}function Yq(t){return t._rawAsyncValidators}function PN(t){return t?Array.isArray(t)?t:[t]:[]}function HD(t,n){return Array.isArray(t)?t.includes(n):t===n}function Xq(t,n){const e=PN(n);return PN(t).forEach(i=>{HD(e,i)||e.push(i)}),e}function Qq(t,n){return PN(n).filter(e=>!HD(t,e))}class Jq{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=MN(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=RN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Js extends Jq{name;get formDirective(){return null}get path(){return null}}class Pp extends Jq{_parent=null;name=null;valueAccessor=null}class eG{_cd;constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let Rd=(()=>{class t extends eG{constructor(e){super(e)}static \u0275fac=function(r){return new(r||t)(Re(Pp,2))};static \u0275dir=Ft({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&Ls("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[qn]})}return t})(),uw=(()=>{class t extends eG{constructor(e){super(e)}static \u0275fac=function(r){return new(r||t)(Re(Js,10))};static \u0275dir=Ft({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&Ls("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[qn]})}return t})();const dw="VALID",qD="INVALID",Hy="PENDING",hw="DISABLED";class $y{}class rG extends $y{value;source;constructor(n,e){super(),this.value=n,this.source=e}}class LN extends $y{pristine;source;constructor(n,e){super(),this.pristine=n,this.source=e}}class FN extends $y{touched;source;constructor(n,e){super(),this.touched=n,this.source=e}}class GD extends $y{status;source;constructor(n,e){super(),this.status=n,this.source=e}}class iG extends $y{source;constructor(n){super(),this.source=n}}class BN extends $y{source;constructor(n){super(),this.source=n}}function VN(t){return(WD(t)?t.validators:t)||null}function zN(t,n){return(WD(n)?n.asyncValidators:t)||null}function WD(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}function oG(t,n,e){const r=t.controls;if(!(n?Object.keys(r):r).length)throw new ue(1e3,"");if(!r[e])throw new ue(1001,"")}function sG(t,n,e){t._forEachChild((r,i)=>{if(void 0===e[i])throw new ue(1002,"")})}class KD{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(n,e){this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return vr(this.statusReactive)}set status(n){vr(()=>this.statusReactive.set(n))}_status=di(()=>this.statusReactive());statusReactive=wo(void 0);get valid(){return this.status===dw}get invalid(){return this.status===qD}get pending(){return this.status==Hy}get disabled(){return this.status===hw}get enabled(){return this.status!==hw}errors;get pristine(){return vr(this.pristineReactive)}set pristine(n){vr(()=>this.pristineReactive.set(n))}_pristine=di(()=>this.pristineReactive());pristineReactive=wo(!0);get dirty(){return!this.pristine}get touched(){return vr(this.touchedReactive)}set touched(n){vr(()=>this.touchedReactive.set(n))}_touched=di(()=>this.touchedReactive());touchedReactive=wo(!1);get untouched(){return!this.touched}_events=new J;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(Xq(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(Xq(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(Qq(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(Qq(n,this._rawAsyncValidators))}hasValidator(n){return HD(this._rawValidators,n)}hasAsyncValidator(n){return HD(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){const e=!1===this.touched;this.touched=!0;const r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched({...n,sourceControl:r}),e&&!1!==n.emitEvent&&this._events.next(new FN(!0,r))}markAllAsDirty(n={}){this.markAsDirty({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(n))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(n))}markAsUntouched(n={}){const e=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const r=n.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,r),e&&!1!==n.emitEvent&&this._events.next(new FN(!1,r))}markAsDirty(n={}){const e=!0===this.pristine;this.pristine=!1;const r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty({...n,sourceControl:r}),e&&!1!==n.emitEvent&&this._events.next(new LN(!1,r))}markAsPristine(n={}){const e=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const r=n.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,r),e&&!1!==n.emitEvent&&this._events.next(new LN(!0,r))}markAsPending(n={}){this.status=Hy;const e=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new GD(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending({...n,sourceControl:e})}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=hw,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue();const r=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new rG(this.value,r)),this._events.next(new GD(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e},this),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=dw,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e},this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,e){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===dw||this.status===Hy)&&this._runAsyncValidator(r,n.emitEvent)}const e=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new rG(this.value,e)),this._events.next(new GD(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity({...n,sourceControl:e})}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hw:dw}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,e){if(this.asyncValidator){this.status=Hy,this._hasOwnPendingAsyncValidator={emitEvent:!1!==e,shouldHaveEmitted:!1!==n};const r=jq(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:e,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const n=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent,this,e.shouldHaveEmitted)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,i)=>r&&r._find(i),this)}getError(n,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,e,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new GD(this.status,e)),this._parent&&this._parent._updateControlsErrors(n,e,r)}_initObservables(){this.valueChanges=new Hn,this.statusChanges=new Hn}_calculateStatus(){return this._allControlsDisabled()?hw:this.errors?qD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Hy)?Hy:this._anyControlsHaveStatus(qD)?qD:dw}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,e){const r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,e),i&&this._events.next(new LN(this.pristine,e))}_updateTouched(n={},e){this.touched=this._anyControlsTouched(),this._events.next(new FN(this.touched,e)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,e)}_onDisabledChange=[];_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){WD(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function ixe(t){return Array.isArray(t)?MN(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function oxe(t){return Array.isArray(t)?RN(t):t||null}(this._rawAsyncValidators)}}class fw extends KD{constructor(n,e,r){super(VN(e),zN(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,r={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){sG(this,0,n),Object.keys(n).forEach(r=>{oG(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(r=>{const i=this.controls[r];i&&i.patchValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((r,i)=>{r.reset(n?n[i]:null,{...e,onlySelf:!0})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),!1!==e?.emitEvent&&this._events.next(new BN(this))}getRawValue(){return this._reduceChildren({},(n,e,r)=>(n[r]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&n(r,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,i)=>((r.enabled||this.disabled)&&(e[i]=r.value),e))}_reduceChildren(n,e){let r=n;return this._forEachChild((i,o)=>{r=e(r,i,o)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class aG extends fw{}const Ig=new Fe("",{factory:()=>pw}),pw="always";function ZD(t,n){return[...n.path,t]}function mw(t,n,e=pw){UN(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function axe(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&lG(t,n)})}(t,n),function cxe(t,n){const e=(r,i)=>{n.valueAccessor.writeValue(r),i&&n.viewToModelUpdate(r)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function lxe(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&lG(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function sxe(t,n){if(n.valueAccessor.setDisabledState){const e=r=>{n.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function YD(t,n,e=!0){const r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),QD(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function XD(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function UN(t,n){const e=Zq(t);null!==n.validator?t.setValidators(Kq(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const r=Yq(t);null!==n.asyncValidator?t.setAsyncValidators(Kq(r,n.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();XD(n._rawValidators,i),XD(n._rawAsyncValidators,i)}function QD(t,n){let e=!1;if(null!==t){if(null!==n.validator){const i=Zq(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.validator);o.length!==i.length&&(e=!0,t.setValidators(o))}}if(null!==n.asyncValidator){const i=Yq(t);if(Array.isArray(i)&&i.length>0){const o=i.filter(a=>a!==n.asyncValidator);o.length!==i.length&&(e=!0,t.setAsyncValidators(o))}}}const r=()=>{};return XD(n._rawValidators,r),XD(n._rawAsyncValidators,r),e}function lG(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function HN(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function $N(t,n){if(!n)return null;let e,r,i;return Array.isArray(n),n.forEach(o=>{o.constructor===Rc?e=o:function hxe(t){return Object.getPrototypeOf(t.constructor)===Sg}(o)?r=o:i=o}),i||r||e||null}function dG(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function hG(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}Promise.resolve();const _w=class extends KD{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(n=null,e,r){super(VN(e),zN(r,e)),this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),WD(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=hG(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),e.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,!1!==e?.emitEvent&&this._events.next(new BN(this))}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){dG(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){dG(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){hG(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},vxe={provide:Pp,useExisting:Kn(()=>kg)},fG=Promise.resolve();let kg=(()=>{class t extends Pp{_changeDetectorRef;callSetDisabledState;control=new _w;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Hn;constructor(e,r,i,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=$N(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),HN(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){mw(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){fG.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,i=0!==r&&ms(r);fG.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?ZD(e,this._parent):[e]}static \u0275fac=function(r){return new(r||t)(Re(Js,9),Re(Qs,10),Re(Rp,10),Re(Md,10),Re(Sh,8),Re(Ig,8))};static \u0275dir=Ft({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Sr([vxe]),qn,zo]})}return t})(),yw=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return t})();class _G extends KD{constructor(n,e,r){super(VN(e),zN(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){Array.isArray(n)?n.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,r={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,e={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,r={}){let i=this._adjustIndex(n);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){sG(this,0,n),n.forEach((r,i)=>{oG(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((r,i)=>{r.reset(n[i],{...e,onlySelf:!0})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),!1!==e?.emitEvent&&this._events.next(new BN(this))}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,r)=>{n(e,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}let nT=(()=>{class t extends Js{callSetDisabledState;get submitted(){return vr(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=di(()=>this._submittedReactive());_submittedReactive=wo(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];constructor(e,r,i){super(),this.callSetDisabledState=i,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this.onChanges(e)}ngOnDestroy(){this.onDestroy()}onChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}onDestroy(){this.form&&(QD(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get path(){return[]}addControl(e){const r=this.form.get(e.path);return mw(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){YD(e.control||null,e,!1),function fxe(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}getFormArray(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}updateModel(e,r){this.form.get(e.path).setValue(r)}onReset(){this.resetForm()}resetForm(e=void 0,r={}){this.form.reset(e,r),this._submittedReactive.set(!1)}onSubmit(e){return this.submitted=!0,function uG(t,n){t._syncPendingControls(),n.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new iG(this.control)),"dialog"===e?.target?.method}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,i=this.form.get(e.path);r!==i&&(YD(r||null,e),(t=>t instanceof _w)(i)&&(mw(i,e,this.callSetDisabledState),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);(function cG(t,n){UN(t,n)})(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function uxe(t,n){return QD(t,n)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){UN(this.form,this),this._oldForm&&QD(this._oldForm,this)}_checkFormPresent(){}static \u0275fac=function(r){return new(r||t)(Re(Qs,10),Re(Rp,10),Re(Ig,8))};static \u0275dir=Ft({type:t,features:[qn,zo]})}return t})();const qN=new Fe(""),Ixe={provide:Pp,useExisting:Kn(()=>qy)};let qy=(()=>{class t extends Pp{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new Hn;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,r,i,o,a){super(),this._ngModelWarningConfig=a,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=$N(0,o)}ngOnChanges(e){this._added||this._setUpControl(),HN(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return ZD(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||t)(Re(Js,13),Re(Qs,10),Re(Rp,10),Re(Md,10),Re(qN,8))};static \u0275dir=Ft({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Sr([Ixe]),qn,zo]})}return t})();const kxe={provide:Js,useExisting:Kn(()=>Gy)};let Gy=(()=>{class t extends nT{form=null;ngSubmit=new Hn;get control(){return this.form}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["","formGroup",""]],hostBindings:function(r,i){1&r&&Ge("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Sr([kxe]),qn]})}return t})();const Axe={provide:Md,useExisting:Kn(()=>Ag),multi:!0};function wG(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Ag=(()=>{class t extends Sg{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;appRefInjector=X(Qa).injector;destroyRef=X(ir);cdr=X(Sh);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,cu({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(e){this.cdr.markForCheck(),this.value=e;const i=wG(this._getOptionId(e),e);this.setProperty("value",i)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function Mxe(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){1&r&&Ge("change",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Sr([Axe]),qn]})}return t})(),bw=(()=>{class t{_element;_renderer;_select;id;constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(wG(this.id,e)),this._select._writeValueAfterRender())}set value(e){this._setElementValue(e),this._select&&this._select._writeValueAfterRender()}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||t)(Re(Vr),Re(Ka),Re(Ag,9))};static \u0275dir=Ft({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return t})();const Rxe={provide:Md,useExisting:Kn(()=>GN),multi:!0};function xG(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let GN=(()=>{class t extends Sg{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){let r;if(this.value=e,Array.isArray(e)){const i=e.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const i=[],o=r.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const _=this._getOptionValue(a[c].value);i.push(_)}}else{const a=r.options;for(let c=0;c<a.length;c++){const f=a[c];if(f.selected){const _=this._getOptionValue(f.value);i.push(_)}}}this.value=i,e(i)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function Pxe(t){return t.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){1&r&&Ge("change",function(a){return i.onChange(a.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Sr([Rxe]),qn]})}return t})(),ww=(()=>{class t{_element;_renderer;_select;id;_value;constructor(e,r,i){this._element=e,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(xG(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(xG(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||t)(Re(Vr),Re(Ka),Re(GN,9))};static \u0275dir=Ft({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return t})(),Mg=(()=>{class t{_validator=jD;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):jD,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,features:[zo]})}return t})();const Lxe={provide:Qs,useExisting:Kn(()=>Wy),multi:!0};let Wy=(()=>{class t extends Mg{required;inputName="required";normalizeInput=ms;createValidator=e=>Oq;enabled(e){return e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=qr(t)))(i||t)}})();static \u0275dir=Ft({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){2&r&&Ys("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Sr([Lxe]),qn]})}return t})(),RG=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({})}return t})();function PG(t){return!!t&&(void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn)}let iT=(()=>{class t{useNonNullable=!1;get nonNullable(){const e=new t;return e.useNonNullable=!0,e}group(e,r=null){const i=this._reduceControls(e);let o={};return PG(r)?o=r:null!==r&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new fw(i,o)}record(e,r=null){const i=this._reduceControls(e);return new aG(i,r)}control(e,r,i){let o={};return this.useNonNullable?(PG(r)?o=r:(o.validators=r,o.asyncValidators=i),new _w(e,{...o,nonNullable:!0})):new _w(e,r,i)}array(e,r,i){const o=e.map(a=>this._createControl(a));return new _G(o,r,i)}_reduceControls(e){const r={};return Object.keys(e).forEach(i=>{r[i]=this._createControl(e[i])}),r}_createControl(e){return e instanceof _w||e instanceof KD?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xw=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Ig,useValue:e.callSetDisabledState??pw}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[RG]})}return t})(),oT=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:qN,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:Ig,useValue:e.callSetDisabledState??pw}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({imports:[RG]})}return t})();class jxe{constructor(n,e,r,i,o,a,c){this.id=n,this.name=e,this.urg=r,this.title=i,this.descriptif=o,this.statut=a,this.createdDate=c}}let Ew=(()=>{class t{constructor(){this._tasks=wo([]),this.tasks=this._tasks.asReadonly(),this.todoTasks=di(()=>this._tasks().filter(e=>"todo"===e.statut)),this.inProgressTasks=di(()=>this._tasks().filter(e=>"inProgress"===e.statut)),this.doneTasks=di(()=>this._tasks().filter(e=>"done"===e.statut)),this.initListener()}initListener(){Mp(Ir(Lr,"/tasks"),e=>{this._tasks.set(e.val()?e.val():[])})}saveTasks(){Sd(Ir(Lr,"/tasks"),this._tasks())}generateUniqueId(){return`${Date.now()}-${Math.random().toString(36).substring(2,15)}`}createNewTask(e){e.id=this.generateUniqueId(),this._tasks.update(r=>[...r,e]),this.saveTasks()}removeTask(e){this._tasks().some(i=>i.id===e)&&(this._tasks.update(i=>i.filter(o=>o.id!==e)),this.saveTasks())}getTaskById(e){return this._tasks().find(r=>r.id===e)||null}updateTaskById(e,r){this._tasks().some(o=>o.id===e)&&(this._tasks.update(o=>o.map(a=>a.id===e?r:a)),this.saveTasks())}updateTaskStatus(e){this._tasks.update(r=>r.map(i=>i.id===e.id?e:i)),this.saveTasks()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Hxe(t,n){if(1&t&&(j(0,"option",8),Y(1),G()),2&t){const e=n.$implicit;gn("value",e.displayName||e.email),le(),Lt(e.displayName||e.email)}}let $xe=(()=>{class t{constructor(e,r,i,o,a){this.formBuilder=e,this.ts=r,this.router=i,this._snackBar=o,this.userService=a,this.allUsers=[]}ngOnInit(){this.userService.getAllUsers().then(e=>{this.allUsers=e}).catch(()=>{this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3})}),this.initForm()}initForm(){this.addTaskForm=this.formBuilder.group({name:["",[Pc.required]],urg:["",[Pc.required]],title:["",[Pc.required]],descriptif:[""]})}goBack(){this.router.navigate(["/home"])}onSubmit(){const e=this.addTaskForm.get("name")?.value,r=this.addTaskForm.get("urg")?.value,i=this.addTaskForm.get("title")?.value,o=this.addTaskForm.get("descriptif")?.value,c=(new Date).toISOString(),f=new jxe("",e,r,i,o,"Nouveau",c);this.ts.createNewTask(f),this._snackBar.open("Tache ajout\xe9e","avec succ\xe8s !!",{duration:5e3}),this.router.navigate(["/home"])}static{this.\u0275fac=function(r){return new(r||t)(Re(iT),Re(Ew),Re(Bs),Re(ig),Re(Ad))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-add-task"]],decls:40,vars:2,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","name",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","name","id","name",1,"input-fun","w-full"],["value","","disabled",""],["value","Tout le monde"],[3,"value"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","D\xe9crivez la t\xe2che...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient",3,"disabled"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1)(2,"h3",2),Y(3,"\u270f\ufe0f Ajouter une Tache"),G(),j(4,"form",3),Ge("ngSubmit",function(){return i.onSubmit()}),j(5,"div")(6,"label",4),Y(7,"Tache pour"),G(),j(8,"select",5)(9,"option",6),Y(10,"Choisir..."),G(),j(11,"option",7),Y(12,"Tout le monde"),G(),sr(13,Hxe,2,2,"option",8,Ja),G()(),j(15,"div")(16,"label",9),Y(17,"Priorite"),G(),j(18,"select",10)(19,"option",6),Y(20,"Choisir..."),G(),j(21,"option",11),Y(22,"Urgent !"),G(),j(23,"option",12),Y(24,"Relativement urgent"),G(),j(25,"option",13),Y(26,"Pas Urgent"),G()()(),j(27,"div")(28,"label",14),Y(29,"Titre"),G(),wt(30,"input",15),G(),j(31,"div")(32,"label",16),Y(33,"Descriptif"),G(),wt(34,"textarea",17),G(),j(35,"div",18)(36,"button",19),Ge("click",function(){return i.goBack()}),Y(37,"Retour"),G(),j(38,"button",20),Y(39,"Ajouter"),G()()()()()),2&r&&(le(4),gn("formGroup",i.addTaskForm),le(9),ar(i.allUsers),le(25),gn("disabled",i.addTaskForm.invalid))},dependencies:[oT,yw,bw,ww,Rc,Ag,Rd,uw,Wy,Gy,qy],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:80%;margin:20px auto;padding:10px 30px}@media only screen and (min-width:1224px){.mat-card[_ngcontent-%COMP%]{width:80%}}"]})}}return t})();function qxe(t,n){if(1&t&&(Zt(0,"p",14),Y(1),qt()),2&t){const e=xe();le(),Lt(e.errorMessage)}}let Gxe=(()=>{class t{constructor(e,r){this.authService=e,this.router=r,this.errorMessage=""}signInWithGoogle(){this.authService.signInWithGoogle().then(()=>{this.router.navigate(["/home"])},e=>{console.error("Google Sign-In error:",e);const r=e?.code||"";this.errorMessage="auth/popup-closed-by-user"===r||"auth/cancelled-popup-request"===r?"":`Erreur lors de la connexion Google (${r})`})}static{this.\u0275fac=function(r){return new(r||t)(Re(Ad),Re(Bs))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-signin"]],decls:20,vars:1,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-br","from-family-pink","via-family-coral","to-family-orange","p-4"],[1,"w-full","max-w-md"],[1,"text-center","mb-8"],[1,"text-6xl","block","mb-2"],[1,"font-display","font-extrabold","text-3xl","text-white"],[1,"text-white/80","mt-1"],[1,"bg-white","rounded-3xl","shadow-fun","p-8"],[1,"font-display","font-bold","text-xl","text-center","text-gray-800","mb-6"],[1,"w-full","flex","items-center","justify-center","gap-3","px-6","py-3","rounded-2xl","border-2","border-gray-200","bg-white","hover:bg-gray-50","transition-all","hover:shadow-md","text-gray-700","font-semibold",3,"click"],["viewBox","0 0 24 24",1,"w-5","h-5"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"],[1,"mt-4","text-red-400","text-center","text-sm"]],template:function(r,i){1&r&&(Zt(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),Y(4,"\u{1f468}\u200d\u{1f469}\u200d\u{1f467}\u200d\u{1f466}"),qt(),Zt(5,"h1",4),Y(6,"Family App"),qt(),Zt(7,"p",5),Y(8,"Votre espace famille"),qt()(),Zt(9,"div",6)(10,"h2",7),Y(11,"Connexion \u{1f44b}"),qt(),Zt(12,"button",8),ma("click",function(){return i.signInWithGoogle()}),Rr(),Zt(13,"svg",9),dd(14,"path",10)(15,"path",11)(16,"path",12)(17,"path",13),qt(),Y(18," Se connecter avec Google "),qt(),vt(19,qxe,2,1,"p",14),qt()()()),2&r&&(le(19),bt(i.errorMessage?19:-1))},styles:["mat-card[_ngcontent-%COMP%]{width:300px;margin-top:20px}"]})}}return t})();function WN(t){const n=t.cloneNode(!0),e=n.querySelectorAll("[id]"),r=t.nodeName.toLowerCase();n.removeAttribute("id");for(let i=0;i<e.length;i++)e[i].removeAttribute("id");return"canvas"===r?LG(t,n):("input"===r||"select"===r||"textarea"===r)&&OG(t,n),NG("canvas",t,n,LG),NG("input, textarea, select",t,n,OG),n}function NG(t,n,e,r){const i=n.querySelectorAll(t);if(i.length){const o=e.querySelectorAll(t);for(let a=0;a<i.length;a++)r(i[a],o[a])}}let Wxe=0;function OG(t,n){"file"!==n.type&&(n.value=t.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${Wxe++}`)}function LG(t,n){const e=n.getContext("2d");if(e)try{e.drawImage(t,0,0)}catch{}}function KN(t){const n=t.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function ZN(t,n,e){const{top:r,bottom:i,left:o,right:a}=t;return e>=r&&e<=i&&n>=o&&n<=a}function Cw(t,n,e){t.top+=n,t.bottom=t.top+t.height,t.left+=e,t.right=t.left+t.width}function FG(t,n,e,r){const{top:i,right:o,bottom:a,left:c,width:f,height:_}=t,x=f*n,D=_*n;return r>i-D&&r<a+D&&e>c-x&&e<o+x}class BG{_document;positions=new Map;constructor(n){this._document=n}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:KN(e)})})}handleScroll(n){const e=Ol(n),r=this.positions.get(e);if(!r)return null;const i=r.scrollPosition;let o,a;if(e===this._document){const _=this.getViewportScrollPosition();o=_.top,a=_.left}else o=e.scrollTop,a=e.scrollLeft;const c=i.top-o,f=i.left-a;return this.positions.forEach((_,x)=>{_.clientRect&&e!==x&&e.contains(x)&&Cw(_.clientRect,c,f)}),i.top=o,i.left=a,{top:c,left:f}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function VG(t,n){const e=t.rootNodes;if(1===e.length&&e[0].nodeType===n.ELEMENT_NODE)return e[0];const r=n.createElement("div");return e.forEach(i=>r.appendChild(i)),r}function YN(t,n,e){for(let r in n)if(n.hasOwnProperty(r)){const i=n[r];i?t.setProperty(r,i,e?.has(r)?"important":""):t.removeProperty(r)}return t}function Ky(t,n){const e=n?"":"none";YN(t.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function zG(t,n,e){YN(t.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},e)}function sT(t,n){return n&&"none"!=n?t+" "+n:t}function UG(t,n){t.style.width=`${n.width}px`,t.style.height=`${n.height}px`,t.style.transform=Dw(n.left,n.top)}function Dw(t,n){return`translate3d(${Math.round(t)}px, ${Math.round(n)}px, 0)`}const Tw={capture:!0},XN={passive:!1,capture:!0};let Zxe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275cmp=_r({type:t,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(r,i){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}\n"],encapsulation:2,changeDetection:0})}return t})(),aT=(()=>{class t{_ngZone=X(on);_document=X(jn);_styleLoader=X(fy);_renderer=X(Al).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new J;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=wo([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new J;pointerUp=new J;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,XN)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._cleanupDocumentTouchmove?.()}startDragging(e,r){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(Zxe),this._activeDragInstances.update(i=>[...i,e]),1===this._activeDragInstances().length)){const i=r.type.startsWith("touch"),o=c=>this.pointerUp.next(c),a=[["scroll",c=>this._scroll.next(c),Tw],["selectstart",this._preventDefaultWhileDragging,XN]];i?a.push(["touchend",o,Tw],["touchcancel",o,Tw]):a.push(["mouseup",o,Tw]),i||a.push(["mousemove",c=>this.pointerMove.next(c),XN]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=a.map(([c,f,_])=>this._renderer.listen(this._document,c,f,_))})}}stopDragging(e){this._activeDragInstances.update(r=>{const i=r.indexOf(e);return i>-1?(r.splice(i,1),[...r]):r}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){const r=[this._scroll];return e&&e!==this._document&&r.push(new U(i=>this._ngZone.runOutsideAngular(()=>{const o=this._renderer.listen(e,"scroll",a=>{this._activeDragInstances().length&&i.next(a)},Tw);return()=>{o()}}))),EC(...r)}registerDirectiveNode(e,r){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,r)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function jG(t){const n=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*n}function QN(t,n){return t.getPropertyValue(n).split(",").map(r=>r.trim())}const Xxe=new Set(["position"]);class Qxe{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView=null;_preview;get element(){return this._preview}constructor(n,e,r,i,o,a,c,f,_,x){this._document=n,this._rootElement=e,this._direction=r,this._initialDomRect=i,this._previewTemplate=o,this._previewClass=a,this._pickupPositionOnPage=c,this._initialTransform=f,this._zIndex=_,this._renderer=x}attach(n){this._preview=this._createPreview(),n.appendChild(this._preview),HG(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(n){this._preview.style.transform=n}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(n){this._preview.classList.add(n)}getTransitionDuration(){return function Yxe(t){const n=getComputedStyle(t),e=QN(n,"transition-property"),r=e.find(c=>"transform"===c||"all"===c);if(!r)return 0;const i=e.indexOf(r),o=QN(n,"transition-duration"),a=QN(n,"transition-delay");return jG(o[i])+jG(a[i])}(this._preview)}addEventListener(n,e){return this._renderer.listen(this._preview,n,e)}_createPreview(){const n=this._previewTemplate,e=this._previewClass,r=n?n.template:null;let i;if(r&&n){const o=n.matchSize?this._initialDomRect:null,a=n.viewContainer.createEmbeddedView(r,n.context);a.detectChanges(),i=VG(a,this._document),this._previewEmbeddedView=a,n.matchSize?UG(i,o):i.style.transform=Dw(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else i=WN(this._rootElement),UG(i,this._initialDomRect),this._initialTransform&&(i.style.transform=this._initialTransform);return YN(i.style,{"pointer-events":"none",margin:HG(i)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Xxe),Ky(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("popover","manual"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(o=>i.classList.add(o)):i.classList.add(e)),i}}function HG(t){return"showPopover"in t}const Jxe={passive:!0},$G={passive:!1},e1e={passive:!1,capture:!0},qG="cdk-drag-placeholder",GG=new Set(["position"]);function WG(t,n,e={dragStartThreshold:5,pointerDirectionChangeThreshold:5}){const r=t.get(Ka,null,{optional:!0})||t.get(Al).createRenderer(null,null);return new n1e(n,e,t.get(jn),t.get(on),t.get(gy),t.get(aT),r)}class n1e{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview=null;_previewContainer;_placeholderRef=null;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=wo(!1);_hasMoved=!1;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new J;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement=null;_rootElementTapHighlight;_pointerMoveSubscription=Wn.EMPTY;_pointerUpSubscription=Wn.EMPTY;_scrollSubscription=Wn.EMPTY;_resizeSubscription=Wn.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef=null;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){n!==this._disabled&&(this._disabled=n,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Ky(e,n)))}_disabled=!1;beforeStarted=new J;started=new J;released=new J;ended=new J;entered=new J;exited=new J;dropped=new J;moved=this._moveEvents;data;constrainPosition;constructor(n,e,r,i,o,a,c){this._config=e,this._document=r,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=a,this._renderer=c,this.withRootElement(n).withParent(e.parentDragRef||null),this._parentPositions=new BG(r),a.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(r=>il(r)),this._handles.forEach(r=>Ky(r,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(r=>{this._handles.indexOf(r)>-1&&e.add(r)}),this._disabledHandles=e,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const e=il(n);if(e!==this._rootElement){this._removeRootElementListeners();const r=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[r.listen(e,"mousedown",this._pointerDown,$G),r.listen(e,"touchstart",this._pointerDown,Jxe),r.listen(e,"dragstart",this._nativeDragStart,$G)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?il(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&function Kxe(t,n){return n.left<t.left||n.left+n.width>t.right||n.top<t.top||n.top+n.height>t.bottom}(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){const n=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect();let r=0,i=0;e.left<n.left?r=n.left-e.left:e.right>n.right&&(r=n.right-e.right),e.top<n.top?i=n.top-e.top:e.bottom>n.bottom&&(i=n.bottom-e.bottom);let c=this._activeTransform.x+r,f=this._activeTransform.y+i;this._rootElement.style.transform=Dw(c,f),this._activeTransform={x:c,y:f},this._passiveTransform={x:c,y:f}}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),Ky(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),Ky(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=n=>{if(this.beforeStarted.next(),this._handles.length){const e=this._getTargetHandle(n);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,n)}else this.disabled||this._initializeDragSequence(this._rootElement,n)};_pointerMove=n=>{const e=this._getPointerPositionOnPage(n);if(!this._hasStartedDragging()){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const c=Date.now()>=this._dragStartTime+this._getDragStartDelay(n),f=this._dropContainer;if(!c)return void this._endDragSequence(n);(!f||!f.isDragging()&&!f.isReceiving())&&(n.cancelable&&n.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(n)))}return}n.cancelable&&n.preventDefault();const r=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(r),this._dropContainer)this._updateActiveDropContainer(r,e);else{const i=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=r.x-i.x+this._passiveTransform.x,o.y=r.y-i.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:r,event:n,distance:this._getDragDistance(r),delta:this._pointerDirectionDelta})})};_pointerUp=n=>{this._endDragSequence(n)};_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){Sw(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._getShadowRoot(),r=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",r1e,e1e)}),r){const i=this._rootElement,o=i.parentNode,a=this._placeholder=this._createPlaceholderElement(),c=this._marker=this._marker||this._document.createComment("");o.insertBefore(c,i),this._initialTransform=i.style.transform||"",this._preview=new Qxe(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(o,e)),zG(i,!1,GG),this._document.body.appendChild(o.replaceChild(a,i)),this.started.next({source:this,event:n}),r.start(),this._initialContainer=r,this._initialIndex=r.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(r?r.getScrollableParents():[])}_initializeDragSequence(n,e){this._parentDragRef&&e.stopPropagation();const r=this.isDragging(),i=Sw(e),o=!i&&0!==e.button,a=this._rootElement,c=Ol(e),f=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),_=i?qA(e):$A(e);if(c&&c.draggable&&"mousedown"===e.type&&e.preventDefault(),r||o||f||_)return;if(this._handles.length){const A=a.style;this._rootElementTapHighlight=A.webkitTapHighlightColor||"",A.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(A=>this._updateOnScroll(A)),this._boundaryElement&&(this._boundaryRect=KN(this._boundaryElement));const x=this._previewTemplate;this._pickupPositionInElement=x&&x.template&&!x.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,n,e);const D=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:D.x,y:D.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(n){zG(this._rootElement,!0,GG),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,r=e.getItemIndex(this),i=this._getPointerPositionOnPage(n),o=this._getDragDistance(i),a=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:o,dropPoint:i,event:n}),this.dropped.next({item:this,currentIndex:r,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:a,distance:o,dropPoint:i,event:n}),e.drop(this,r,this._initialIndex,this._initialContainer,a,o,i,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:e},{x:r,y:i}){let o=this._initialContainer._getSiblingContainerFromPosition(this,n,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{const a=this._dropContainer.getItemIndex(this),c=this._dropContainer.getItemAtIndex(a+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(o,this._dropContainer,c),this._dropContainer=o,this._dropContainer.enter(this,n,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(r,i),this._dropContainer._sortItem(this,n,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,e):this._applyPreviewTransform(n-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const e=this._preview.getTransitionDuration();return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(r=>{const i=c=>{(!c||this._preview&&Ol(c)===this._preview.element&&"transform"===c.propertyName)&&(a(),r(),clearTimeout(o))},o=setTimeout(i,1.5*e),a=this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,e=n?n.template:null;let r;return e?(this._placeholderRef=n.viewContainer.createEmbeddedView(e,n.context),this._placeholderRef.detectChanges(),r=VG(this._placeholderRef,this._document)):r=WN(this._rootElement),r.style.pointerEvents="none",r.classList.add(qG),r}_getPointerPositionInElement(n,e,r){const i=e===this._rootElement?null:e,o=i?i.getBoundingClientRect():n,a=Sw(r)?r.targetTouches[0]:r,c=this._getViewportScrollPosition();return{x:o.left-n.left+(a.pageX-o.left-c.left),y:o.top-n.top+(a.pageY-o.top-c.top)}}_getPointerPositionOnPage(n){const e=this._getViewportScrollPosition(),r=Sw(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,i=r.pageX-e.left,o=r.pageY-e.top;if(this._ownerSVGElement){const a=this._ownerSVGElement.getScreenCTM();if(a){const c=this._ownerSVGElement.createSVGPoint();return c.x=i,c.y=o,c.matrixTransform(a.inverse())}}return{x:i,y:o}}_getConstrainedPointerPosition(n){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:r,y:i}=this.constrainPosition?this.constrainPosition(n,this,this._initialDomRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===e?i=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===e)&&(r=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:o,y:a}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,c=this._boundaryRect,{width:f,height:_}=this._getPreviewRect(),x=c.top+a,D=c.bottom-(_-a);r=KG(r,c.left+o,c.right-(f-o)),i=KG(i,x,D)}return{x:r,y:i}}_updatePointerDirectionDelta(n){const{x:e,y:r}=n,i=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,a=Math.abs(e-o.x),c=Math.abs(r-o.y);return a>this._config.pointerDirectionChangeThreshold&&(i.x=e>o.x?1:-1,o.x=e),c>this._config.pointerDirectionChangeThreshold&&(i.y=r>o.y?1:-1,o.y=r),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,Ky(this._rootElement,n))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(n=>n()),this._rootElementCleanups=void 0}_applyRootElementTransform(n,e){const r=1/this.scale,i=Dw(n*r,e*r),o=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=o.transform&&"none"!=o.transform?o.transform:""),o.transform=sT(i,this._initialTransform)}_applyPreviewTransform(n,e){const r=this._previewTemplate?.template?void 0:this._initialTransform,i=Dw(n,e);this._preview.setTransform(sT(i,r))}_getDragDistance(n){const e=this._pickupPositionOnPage;return e?{x:n.x-e.x,y:n.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:e}=this._passiveTransform;if(0===n&&0===e||this.isDragging()||!this._boundaryElement)return;const r=this._rootElement.getBoundingClientRect(),i=this._boundaryElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===r.width&&0===r.height)return;const o=i.left-r.left,a=r.right-i.right,c=i.top-r.top,f=r.bottom-i.bottom;i.width>r.width?(o>0&&(n+=o),a>0&&(n-=a)):n=0,i.height>r.height?(c>0&&(e+=c),f>0&&(e-=f)):e=0,(n!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:n})}_getDragStartDelay(n){const e=this.dragStartDelay;return"number"==typeof e?e:Sw(n)?e.touch:e?e.mouse:0}_updateOnScroll(n){const e=this._parentPositions.handleScroll(n);if(e){const r=Ol(n);this._boundaryRect&&r!==this._boundaryElement&&r.contains(this._boundaryElement)&&Cw(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=sC(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,e){const r=this._previewContainer||"global";if("parent"===r)return n;if("global"===r){const i=this._document;return e||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return il(r)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=n=>{if(this._handles.length){const e=this._getTargetHandle(n);e&&!this._disabledHandles.has(e)&&!this.disabled&&n.preventDefault()}else this.disabled||n.preventDefault()};_getTargetHandle(n){return this._handles.find(e=>n.target&&(n.target===e||e.contains(n.target)))}_conditionallyInsertAnchor(n,e,r){if(n===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){const i=this._anchor??=WN(this._placeholder);i.classList.remove(qG),i.classList.add("cdk-drag-anchor"),i.style.transform="",r?r.before(i):il(e.element).appendChild(i)}}}function KG(t,n,e){return Math.max(n,Math.min(e,t))}function Sw(t){return"t"===t.type[0]}function r1e(t){t.preventDefault()}function JN(t,n,e){const r=Iw(n,t.length-1),i=Iw(e,t.length-1);if(r===i)return;const o=t[r],a=i<r?-1:1;for(let c=r;c!==i;c+=a)t[c]=t[c+a];t[i]=o}function Iw(t,n){return Math.max(0,Math.min(n,t))}class ZG{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction="ltr";constructor(n){this._dragDropRegistry=n}_previousSwap={drag:null,delta:0,overlaps:!1};start(n){this.withItems(n)}sort(n,e,r,i){const o=this._itemPositions,a=this._getItemIndexFromPointerPosition(n,e,r,i);if(-1===a&&o.length>0)return null;const c="horizontal"===this.orientation,f=o.findIndex(ce=>ce.drag===n),_=o[a],D=_.clientRect,A=f>a?1:-1,N=this._getItemOffsetPx(o[f].clientRect,D,A),B=this._getSiblingOffsetPx(f,o,A),te=o.slice();return JN(o,f,a),o.forEach((ce,we)=>{if(te[we]===ce)return;const Ce=ce.drag===n,We=Ce?N:B,Se=Ce?n.getPlaceholderElement():ce.drag.getRootElement();ce.offset+=We;const Ee=Math.round(ce.offset*(1/ce.drag.scale));c?(Se.style.transform=sT(`translate3d(${Ee}px, 0, 0)`,ce.initialTransform),Cw(ce.clientRect,0,We)):(Se.style.transform=sT(`translate3d(0, ${Ee}px, 0)`,ce.initialTransform),Cw(ce.clientRect,We,0))}),this._previousSwap.overlaps=ZN(D,e,r),this._previousSwap.drag=_.drag,this._previousSwap.delta=c?i.x:i.y,{previousIndex:f,currentIndex:a}}enter(n,e,r,i){const o=null==i||i<0?this._getItemIndexFromPointerPosition(n,e,r):i,a=this._activeDraggables,c=a.indexOf(n),f=n.getPlaceholderElement();let _=a[o];if(_===n&&(_=a[o+1]),!_&&(null==o||-1===o||o<a.length-1)&&this._shouldEnterAsFirstChild(e,r)&&(_=a[0]),c>-1&&a.splice(c,1),_&&!this._dragDropRegistry.isDragging(_)){const x=_.getRootElement();x.parentElement.insertBefore(f,x),a.splice(o,0,n)}else this._element.appendChild(f),a.push(n);f.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables?.forEach(n=>{const e=n.getRootElement();if(e){const r=this._itemPositions.find(i=>i.drag===n)?.initialTransform;e.style.transform=r||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return this._getVisualItemPositions().findIndex(e=>e.drag===n)}getItemAtIndex(n){return this._getVisualItemPositions()[n]?.drag||null}updateOnScroll(n,e){this._itemPositions.forEach(({clientRect:r})=>{Cw(r,n,e)}),this._itemPositions.forEach(({drag:r})=>{this._dragDropRegistry.isDragging(r)&&r._sortFromLastPointerPosition()})}withElementContainer(n){this._element=n}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(e=>{const r=e.getVisibleElement();return{drag:e,offset:0,initialTransform:r.style.transform||"",clientRect:KN(r)}}).sort((e,r)=>n?e.clientRect.left-r.clientRect.left:e.clientRect.top-r.clientRect.top)}_getVisualItemPositions(){return"horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(n,e,r){const i="horizontal"===this.orientation;let o=i?e.left-n.left:e.top-n.top;return-1===r&&(o+=i?e.width-n.width:e.height-n.height),o}_getSiblingOffsetPx(n,e,r){const i="horizontal"===this.orientation,o=e[n].clientRect,a=e[n+-1*r];let c=o[i?"width":"height"]*r;if(a){const f=i?"left":"top",_=i?"right":"bottom";-1===r?c-=a.clientRect[f]-o[_]:c+=o[f]-a.clientRect[_]}return c}_shouldEnterAsFirstChild(n,e){if(!this._activeDraggables.length)return!1;const r=this._itemPositions,i="horizontal"===this.orientation;if(r[0].drag!==this._activeDraggables[0]){const a=r[r.length-1].clientRect;return i?n>=a.right:e>=a.bottom}{const a=r[0].clientRect;return i?n<=a.left:e<=a.top}}_getItemIndexFromPointerPosition(n,e,r,i){const o="horizontal"===this.orientation,a=this._itemPositions.findIndex(({drag:c,clientRect:f})=>c!==n&&((!i||c!==this._previousSwap.drag||!this._previousSwap.overlaps||(o?i.x:i.y)!==this._previousSwap.delta)&&(o?e>=Math.floor(f.left)&&e<Math.floor(f.right):r>=Math.floor(f.top)&&r<Math.floor(f.bottom))));return-1!==a&&this._sortPredicate(a,n)?a:-1}}class i1e{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(n,e){this._document=n,this._dragDropRegistry=e}start(n){const e=this._element.childNodes;this._relatedNodes=[];for(let r=0;r<e.length;r++){const i=e[r];this._relatedNodes.push([i,i.nextSibling])}this.withItems(n)}sort(n,e,r,i){const o=this._getItemIndexFromPointerPosition(n,e,r),a=this._previousSwap;if(-1===o||this._activeItems[o]===n)return null;const c=this._activeItems[o];if(a.drag===c&&a.overlaps&&a.deltaX===i.x&&a.deltaY===i.y)return null;const f=this.getItemIndex(n),_=n.getPlaceholderElement(),x=c.getRootElement();o>f?x.after(_):x.before(_),JN(this._activeItems,f,o);const D=this._getRootNode().elementFromPoint(e,r);return a.deltaX=i.x,a.deltaY=i.y,a.drag=c,a.overlaps=x===D||x.contains(D),{previousIndex:f,currentIndex:o}}enter(n,e,r,i){const o=this._activeItems.indexOf(n);o>-1&&this._activeItems.splice(o,1);let a=null==i||i<0?this._getItemIndexFromPointerPosition(n,e,r):i;-1===a&&(a=this._getClosestItemIndexToPointer(n,e,r));const c=this._activeItems[a];c&&!this._dragDropRegistry.isDragging(c)?(this._activeItems.splice(a,0,n),c.getRootElement().before(n.getPlaceholderElement())):(this._activeItems.push(n),this._element.appendChild(n.getPlaceholderElement()))}withItems(n){this._activeItems=n.slice()}withSortPredicate(n){this._sortPredicate=n}reset(){const n=this._element,e=this._previousSwap;for(let r=this._relatedNodes.length-1;r>-1;r--){const[i,o]=this._relatedNodes[r];i.parentNode===n&&i.nextSibling!==o&&(null===o?n.appendChild(i):o.parentNode===n&&n.insertBefore(i,o))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(n){return this._activeItems.indexOf(n)}getItemAtIndex(n){return this._activeItems[n]||null}updateOnScroll(){this._activeItems.forEach(n=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(n){n!==this._element&&(this._element=n,this._rootNode=void 0)}_getItemIndexFromPointerPosition(n,e,r){const i=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(r)),o=i?this._activeItems.findIndex(a=>{const c=a.getRootElement();return i===c||c.contains(i)}):-1;return-1!==o&&this._sortPredicate(o,n)?o:-1}_getRootNode(){return this._rootNode||(this._rootNode=sC(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(n,e,r){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let i=1/0,o=-1;for(let a=0;a<this._activeItems.length;a++){const c=this._activeItems[a];if(c!==n){const{x:f,y:_}=c.getRootElement().getBoundingClientRect(),x=Math.hypot(e-f,r-_);x<i&&(i=x,o=a)}}return o}}var Nc=function(t){return t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t}(Nc||{}),Ca=function(t){return t[t.NONE=0]="NONE",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t}(Ca||{});function QG(t,n){return new o1e(n,t.get(aT),t.get(jn),t.get(on),t.get(gy))}class o1e{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new J;entered=new J;exited=new J;dropped=new J;sorted=new J;receivingStarted=new J;receivingStopped=new J;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Wn.EMPTY;_verticalScrollDirection=Nc.NONE;_horizontalScrollDirection=Ca.NONE;_scrollNode;_stopScrollTimers=new J;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(n,e,r,i,o){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=o;const a=this.element=il(n);this._document=r,this.withOrientation("vertical").withElementContainer(a),e.registerDropContainer(this),this._parentPositions=new BG(r)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,e,r,i){this._draggingStarted(),null==i&&this.sortingDisabled&&(i=this._draggables.indexOf(n)),this._sortStrategy.enter(n,e,r,i),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,e,r,i,o,a,c,f={}){this._reset(),this.dropped.next({item:n,currentIndex:e,previousIndex:r,container:this,previousContainer:i,isPointerOverContainer:o,distance:a,dropPoint:c,event:f})}withItems(n){const e=this._draggables;return this._draggables=n,n.forEach(r=>r._withDropContainer(this)),this.isDragging()&&(e.filter(i=>i.isDragging()).every(i=>-1===n.indexOf(i))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._direction=n,this._sortStrategy instanceof ZG&&(this._sortStrategy.direction=n),this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){if("mixed"===n)this._sortStrategy=new i1e(this._document,this._dragDropRegistry);else{const e=new ZG(this._dragDropRegistry);e.direction=this._direction,e.orientation=n,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,r)=>this.sortPredicate(e,r,this)),this}withScrollableParents(n){const e=this._container;return this._scrollableElements=-1===n.indexOf(e)?[e,...n]:n.slice(),this}withElementContainer(n){if(n===this._container)return this;il(this.element);const r=this._scrollableElements.indexOf(this._container),i=this._scrollableElements.indexOf(n);return r>-1&&this._scrollableElements.splice(r,1),i>-1&&this._scrollableElements.splice(i,1),this._sortStrategy&&this._sortStrategy.withElementContainer(n),this._cachedShadowRoot=null,this._scrollableElements.unshift(n),this._container=n,this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}getItemAtIndex(n){return this._isDragging?this._sortStrategy.getItemAtIndex(n):this._draggables[n]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,e,r,i){if(this.sortingDisabled||!this._domRect||!FG(this._domRect,.05,e,r))return;const o=this._sortStrategy.sort(n,e,r,i);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,e){if(this.autoScrollDisabled)return;let r,i=Nc.NONE,o=Ca.NONE;if(this._parentPositions.positions.forEach((a,c)=>{c===this._document||!a.clientRect||r||FG(a.clientRect,.05,n,e)&&([i,o]=function s1e(t,n,e,r,i){const o=JG(n,i),a=eW(n,r);let c=Nc.NONE,f=Ca.NONE;if(o){const _=t.scrollTop;o===Nc.UP?_>0&&(c=Nc.UP):t.scrollHeight-_>t.clientHeight&&(c=Nc.DOWN)}if(a){const _=t.scrollLeft;"rtl"===e?a===Ca.RIGHT?_<0&&(f=Ca.RIGHT):t.scrollWidth+_>t.clientWidth&&(f=Ca.LEFT):a===Ca.LEFT?_>0&&(f=Ca.LEFT):t.scrollWidth-_>t.clientWidth&&(f=Ca.RIGHT)}return[c,f]}(c,a.clientRect,this._direction,n,e),(i||o)&&(r=c))}),!i&&!o){const{width:a,height:c}=this._viewportRuler.getViewportSize(),f={width:a,height:c,top:0,right:a,bottom:c,left:0};i=JG(f,e),o=eW(f,n),r=window}r&&(i!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||r!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=o,this._scrollNode=r,(i||o)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const n=this._container.style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Mq(0,A5).pipe(md(this._stopScrollTimers)).subscribe(()=>{const n=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===Nc.UP?n.scrollBy(0,-e):this._verticalScrollDirection===Nc.DOWN&&n.scrollBy(0,e),this._horizontalScrollDirection===Ca.LEFT?n.scrollBy(-e,0):this._horizontalScrollDirection===Ca.RIGHT&&n.scrollBy(e,0)})};_isOverContainer(n,e){return null!=this._domRect&&ZN(this._domRect,n,e)}_getSiblingContainerFromPosition(n,e,r){return this._siblings.find(i=>i._canReceive(n,e,r))}_canReceive(n,e,r){if(!this._domRect||!ZN(this._domRect,e,r)||!this.enterPredicate(n,this))return!1;const i=this._getShadowRoot().elementFromPoint(e,r);return!!i&&(i===this._container||this._container.contains(i))}_startReceiving(n,e){const r=this._activeSiblings;!r.has(n)&&e.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(r.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:e}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(n);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=sC(this._container);this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,n))}}function JG(t,n){const{top:e,bottom:r,height:i}=t,o=.05*i;return n>=e-o&&n<=e+o?Nc.UP:n>=r-o&&n<=r+o?Nc.DOWN:Nc.NONE}function eW(t,n){const{left:e,right:r,width:i}=t,o=.05*i;return n>=e-o&&n<=e+o?Ca.LEFT:n>=r-o&&n<=r+o?Ca.RIGHT:Ca.NONE}let a1e=(()=>{class t{_injector=X(In);constructor(){}createDrag(e,r){return WG(this._injector,e,r)}createDropList(e){return QG(this._injector,e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const kw=new Fe("CDK_DRAG_PARENT"),tW=new Fe("CdkDragHandle"),nW=new Fe("CDK_DRAG_CONFIG"),rW=new Fe("CdkDropList");let iW=(()=>{class t{element=X(Vr);dropContainer=X(rW,{optional:!0,skipSelf:!0});_ngZone=X(on);_viewContainerRef=X(Ml);_dir=X(my,{optional:!0});_changeDetectorRef=X(Sh);_selfHandle=X(tW,{optional:!0,self:!0});_parentDrag=X(kw,{optional:!0,skipSelf:!0});_dragDropRegistry=X(aT);_destroyed=new J;_handles=new se([]);_previewTemplate=null;_placeholderTemplate=null;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!(!this.dropContainer||!this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled=!1;constrainPosition;previewClass;previewContainer;scale=1;started=new Hn;released=new Hn;ended=new Hn;entered=new Hn;exited=new Hn;dropped=new Hn;moved=new U(e=>{const r=this._dragRef.moved.pipe(hr(i=>({source:this,pointerPosition:i.pointerPosition,event:i.event,delta:i.delta,distance:i.distance}))).subscribe(e);return()=>{r.unsubscribe()}});_injector=X(In);constructor(){const e=this.dropContainer,r=X(nW,{optional:!0});this._dragRef=WG(this._injector,this.element,{dragStartThreshold:r&&null!=r.dragStartThreshold?r.dragStartThreshold:5,pointerDirectionChangeThreshold:r&&null!=r.pointerDirectionChangeThreshold?r.pointerDirectionChangeThreshold:5,zIndex:r?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),r&&this._assignDefaults(r),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(md(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){cu(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){const r=e.rootElementSelector,i=e.freeDragPosition;r&&!r.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,i&&!i.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){const r=this._handles.getValue();r.push(e),this._handles.next(r)}_removeHandle(e){const r=this._handles.getValue(),i=r.indexOf(e);i>-1&&(r.splice(i,1),this._handles.next(r))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const e=this.element.nativeElement;let r=e;this.rootElementSelector&&(r=void 0!==e.closest?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(r||e)}_getBoundaryElement(){const e=this.boundaryElement;return e?"string"==typeof e?this.element.nativeElement.closest(e):il(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const r=this._dir,i=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,a=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay="object"==typeof i&&i?i:aC(i),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(a).withPreviewContainer(this.previewContainer||"global"),r&&e.withDirection(r.value)}}),e.beforeStarted.pipe(Fs(1)).subscribe(()=>{if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let r=this.element.nativeElement.parentElement;for(;r;){const i=this._dragDropRegistry.getDragDirectiveForNode(r);if(i){e.withParent(i._dragRef);break}r=r.parentElement}})}_handleEvents(e){e.started.subscribe(r=>{this.started.emit({source:this,event:r.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(r=>{this.released.emit({source:this,event:r.event})}),e.ended.subscribe(r=>{this.ended.emit({source:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(r=>{this.entered.emit({container:r.container.data,item:this,currentIndex:r.currentIndex})}),e.exited.subscribe(r=>{this.exited.emit({container:r.container.data,item:this})}),e.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,isPointerOverContainer:r.isPointerOverContainer,item:this,distance:r.distance,dropPoint:r.dropPoint,event:r.event})})}_assignDefaults(e){const{lockAxis:r,dragStartDelay:i,constrainPosition:o,previewClass:a,boundaryElement:c,draggingDisabled:f,rootElementSelector:_,previewContainer:x}=e;this.disabled=f??!1,this.dragStartDelay=i||0,this.lockAxis=r||null,o&&(this.constrainPosition=o),a&&(this.previewClass=a),c&&(this.boundaryElement=c),_&&(this.rootElementSelector=_),x&&(this.previewContainer=x)}_setupHandlesListener(){this._handles.pipe(Nh(e=>{const r=e.map(i=>i.element);this._selfHandle&&this.rootElementSelector&&r.push(this.element),this._dragRef.withHandles(r)}),nl(e=>EC(...e.map(r=>r._stateChanges.pipe(sy(r))))),md(this._destroyed)).subscribe(e=>{const r=this._dragRef,i=e.element.nativeElement;e.disabled?r.disableHandle(i):r.enableHandle(i)})}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(r,i){2&r&&Ls("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",ms],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Tz]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Sr([{provide:kw,useExisting:t}]),zo]})}return t})();const eO=new Fe("CdkDropListGroup");let oW=(()=>{class t{_items=new Set;disabled=!1;ngOnDestroy(){this._items.clear()}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDropListGroup",""]],inputs:{disabled:[2,"cdkDropListGroupDisabled","disabled",ms]},exportAs:["cdkDropListGroup"],features:[Sr([{provide:eO,useExisting:t}])]})}return t})(),sW=(()=>{class t{element=X(Vr);_changeDetectorRef=X(Sh);_scrollDispatcher=X(bC);_dir=X(my,{optional:!0});_group=X(eO,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new J;_scrollableParentsResolved=!1;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation="vertical";id=X(gu).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled=!1;sortingDisabled=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled=!1;autoScrollStep;elementContainerSelector=null;hasAnchor=!1;dropped=new Hn;entered=new Hn;exited=new Hn;sorted=new Hn;_unsortedItems=new Set;constructor(){const e=X(nW,{optional:!0}),r=X(In);this._dropListRef=QG(r,this.element),this._dropListRef.data=this,e&&this._assignDefaults(e),this._dropListRef.enterPredicate=(i,o)=>this.enterPredicate(i.data,o.data),this._dropListRef.sortPredicate=(i,o,a)=>this.sortPredicate(i,o.data,a.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){const r=this._latestSortedRefs.indexOf(e._dragRef);r>-1&&(this._latestSortedRefs.splice(r,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,r)=>e._dragRef.getVisibleElement().compareDocumentPosition(r._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(sy(this._dir.value),md(this._destroyed)).subscribe(r=>e.withDirection(r)),e.beforeStarted.subscribe(()=>{const r=r0(this.connectedTo).map(i=>"string"==typeof i?t._dropLists.find(a=>a.id===i):i);if(this._group&&this._group._items.forEach(i=>{-1===r.indexOf(i)&&r.push(i)}),!this._scrollableParentsResolved){const i=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(i),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){const i=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(i)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=aC(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(r.filter(i=>i&&i!==this).map(i=>i._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(r=>r._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(r=>{this.entered.emit({container:this,item:r.item.data,currentIndex:r.currentIndex})}),e.exited.subscribe(r=>{this.exited.emit({container:this,item:r.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(r=>{this.sorted.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:r.item.data})}),e.dropped.subscribe(r=>{this.dropped.emit({previousIndex:r.previousIndex,currentIndex:r.currentIndex,previousContainer:r.previousContainer.data,container:r.container.data,item:r.item.data,isPointerOverContainer:r.isPointerOverContainer,distance:r.distance,dropPoint:r.dropPoint,event:r.event}),this._changeDetectorRef.markForCheck()}),EC(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){const{lockAxis:r,draggingDisabled:i,sortingDisabled:o,listAutoScrollDisabled:a,listOrientation:c}=e;this.disabled=i??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=a??!1,this.orientation=c||"vertical",this.lockAxis=r||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(r,i){2&r&&(Ys("id",i.id),Ls("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",ms],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",ms],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",ms],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",ms]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Sr([{provide:eO,useValue:void 0},{provide:rW,useExisting:t}])]})}return t})(),h1e=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Io({type:t});static \u0275inj=jr({providers:[a1e],imports:[lM]})}return t})(),f1e=(()=>{class t{constructor(e){this.tasksService=e}transferTask(e,r,i,o){const a={...r,statut:o};this.tasksService.updateTaskStatus(a),e.splice(e.indexOf(r),1),i.push(a)}static{this.\u0275fac=function(r){return new(r||t)(Dt(Ew))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function p1e(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",n.$implicit,So)}function m1e(t,n){if(1&t&&(j(0,"div",23),sr(1,p1e,1,1,"img",26,Ja),G()),2&t){const e=xe(2);le(),ar(e.allUserAvatars)}}function g1e(t,n){if(1&t&&wt(0,"img",24),2&t){const e=xe().$implicit;gn("src",xe().userAvatars[e.name],So)}}function _1e(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"div",19),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().onEdit(i.id))}),j(2,"span",20),Y(3),G(),j(4,"h4",21),Y(5),G(),j(6,"div",22),vt(7,m1e,3,0,"div",23)(8,g1e,1,1,"img",24),j(9,"span",25),Y(10),G()()()()}if(2&t){const e=n.$implicit,r=xe();le(2),gn("ngClass",r.getUrgencyClass(e.urg)),le(),Lt(e.urg),le(2),Lt(e.title),le(2),bt(r.isForEveryone(e)?7:r.userAvatars[e.name]?8:-1),le(3),Lt(e.name)}}function y1e(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",n.$implicit,So)}function v1e(t,n){if(1&t&&(j(0,"div",23),sr(1,y1e,1,1,"img",26,Ja),G()),2&t){const e=xe(2);le(),ar(e.allUserAvatars)}}function b1e(t,n){if(1&t&&wt(0,"img",24),2&t){const e=xe().$implicit;gn("src",xe().userAvatars[e.name],So)}}function w1e(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"div",27),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().onEdit(i.id))}),j(2,"span",20),Y(3),G(),j(4,"h4",21),Y(5),G(),j(6,"div",22),vt(7,v1e,3,0,"div",23)(8,b1e,1,1,"img",24),j(9,"span",25),Y(10),G()()()()}if(2&t){const e=n.$implicit,r=xe();le(2),gn("ngClass",r.getUrgencyClass(e.urg)),le(),Lt(e.urg),le(2),Lt(e.title),le(2),bt(r.isForEveryone(e)?7:r.userAvatars[e.name]?8:-1),le(3),Lt(e.name)}}function x1e(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",n.$implicit,So)}function E1e(t,n){if(1&t&&(j(0,"div",23),sr(1,x1e,1,1,"img",26,Ja),G()),2&t){const e=xe(2);le(),ar(e.allUserAvatars)}}function C1e(t,n){if(1&t&&wt(0,"img",24),2&t){const e=xe().$implicit;gn("src",xe().userAvatars[e.name],So)}}function D1e(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"div",28),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().onEdit(i.id))}),j(2,"span",20),Y(3),G(),j(4,"h4",21),Y(5),G(),j(6,"div",22),vt(7,E1e,3,0,"div",23)(8,C1e,1,1,"img",24),j(9,"span",25),Y(10),G()()()()}if(2&t){const e=n.$implicit,r=xe();le(2),gn("ngClass",r.getUrgencyClass(e.urg)),le(),Lt(e.urg),le(2),Lt(e.title),le(2),bt(r.isForEveryone(e)?7:r.userAvatars[e.name]?8:-1),le(3),Lt(e.name)}}function T1e(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",n.$implicit,So)}function S1e(t,n){if(1&t&&(j(0,"div",23),sr(1,T1e,1,1,"img",26,Ja),G()),2&t){const e=xe(2);le(),ar(e.allUserAvatars)}}function I1e(t,n){if(1&t&&wt(0,"img",24),2&t){const e=xe().$implicit;gn("src",xe().userAvatars[e.name],So)}}function k1e(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"div",29),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().onEdit(i.id))}),j(2,"span",20),Y(3),G(),j(4,"h4",21),Y(5),G(),j(6,"div",22),vt(7,S1e,3,0,"div",23)(8,I1e,1,1,"img",24),j(9,"span",25),Y(10),G()()()()}if(2&t){const e=n.$implicit,r=xe();le(2),gn("ngClass",r.getUrgencyClass(e.urg)),le(),Lt(e.urg),le(2),Lt(e.title),le(2),bt(r.isForEveryone(e)?7:r.userAvatars[e.name]?8:-1),le(3),Lt(e.name)}}function A1e(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",n.$implicit,So)}function M1e(t,n){if(1&t&&(j(0,"div",23),sr(1,A1e,1,1,"img",26,Ja),G()),2&t){const e=xe(2);le(),ar(e.allUserAvatars)}}function R1e(t,n){if(1&t&&wt(0,"img",24),2&t){const e=xe().$implicit;gn("src",xe().userAvatars[e.name],So)}}function P1e(t,n){if(1&t){const e=yn();j(0,"div",10)(1,"div",30),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().onEdit(i.id))}),j(2,"span",20),Y(3),G(),j(4,"h4",21),Y(5),G(),j(6,"div",22),vt(7,M1e,3,0,"div",23)(8,R1e,1,1,"img",24),j(9,"span",25),Y(10),G()()()()}if(2&t){const e=n.$implicit,r=xe();le(2),gn("ngClass",r.getUrgencyClass(e.urg)),le(),Lt(e.urg),le(2),Lt(e.title),le(2),bt(r.isForEveryone(e)?7:r.userAvatars[e.name]?8:-1),le(3),Lt(e.name)}}let N1e=(()=>{class t{constructor(e,r,i,o,a){this.ts=e,this.dialog=r,this.router=i,this.kanbanService=o,this.authService=a,this.userAvatars={},this.allUserAvatars=[],this.new=[],this.en_cours=[],this.fait=[],this.bloquer=[],this.archiver=[],xo(()=>{const c=this.ts.tasks();this.new=c.filter(f=>"Nouveau"===f.statut),this.en_cours=c.filter(f=>"En cours"===f.statut),this.fait=c.filter(f=>"Fait"===f.statut),this.bloquer=c.filter(f=>"Bloque"===f.statut),this.archiver=c.filter(f=>"Archive"===f.statut)})}ngOnInit(){this.authService.getAllUsers().then(e=>{e.forEach(r=>{r.displayName&&r.photoURL&&(this.userAvatars[r.displayName]=r.photoURL,this.allUserAvatars.push(r.photoURL))})})}isForEveryone(e){return"Tout le monde"===e.name}drop(e){if(e.previousContainer===e.container)JN(e.container.data,e.previousIndex,e.currentIndex);else{const r=e.previousContainer.data[e.previousIndex],i=this.getStatusFromContainer(e.container.id);this.kanbanService.transferTask(e.previousContainer.data,r,e.container.data,i)}}getStatusFromContainer(e){switch(e){case"newContainer":default:return"Nouveau";case"inProgressContainer":return"En cours";case"doneContainer":return"Fait";case"bloqueContainer":return"Bloque";case"archiveContainer":return"Archive"}}getUrgencyClass(e){switch(e){case"Urgent":return"flex h-6 items-center rounded-full bg-red-100 px-3 text-xs font-semibold text-red-600";case"Relativement urgent":return"flex h-6 items-center rounded-full bg-yellow-100 px-3 text-xs font-semibold text-yellow-600";case"Pas urgent":return"flex h-6 items-center rounded-full bg-green-100 px-3 text-xs font-semibold text-green-600";default:return"flex h-6 items-center rounded-full bg-gray-100 px-3 text-xs font-semibold text-gray-600"}}onEdit(e){this.router.navigate(["/task/edit",e])}static{this.\u0275fac=function(r){return new(r||t)(Re(Ew),Re(sg),Re(Bs),Re(f1e),Re(Ad))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-kanban"]],decls:50,vars:10,consts:[["cdkDropListGroup","",1,"flex","flex-col"],[1,"flex","flex-grow","space-x-4","overflow-x-auto","pb-4"],[1,"flex","w-64","flex-shrink-0","flex-col"],[1,"flex","items-center","px-2","mb-3"],[1,"font-display","font-bold","text-gray-700"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-sky/20","text-xs","font-bold","text-family-sky"],["routerLink","/add-task",1,"ml-auto","text-family-pink","hover:text-family-coral","transition-colors"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v12m6-6H6"],["id","newContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag",""],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-orange/20","text-xs","font-bold","text-family-orange"],["id","inProgressContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-green/20","text-xs","font-bold","text-family-green"],["id","doneContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-red-100","text-xs","font-bold","text-red-500"],["id","bloqueContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"ml-2","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-family-purple/20","text-xs","font-bold","text-family-purple"],["id","archiveContainer","cdkDropList","",1,"flex-1","space-y-3","min-h-[60px]",3,"cdkDropListDropped","cdkDropListData"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-sky","hover:shadow-card-hover","transition-shadow",3,"click"],[3,"ngClass"],[1,"mt-2","text-sm","font-semibold","text-gray-700"],[1,"flex","items-center","gap-1.5","mt-1"],[1,"flex","-space-x-1.5"],["referrerpolicy","no-referrer",1,"w-5","h-5","rounded-full","object-cover",3,"src"],[1,"text-xs","text-gray-400"],["referrerpolicy","no-referrer",1,"w-5","h-5","rounded-full","object-cover","ring-1","ring-white",3,"src"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-orange","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-green","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-red-400","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"card-fun","p-4","cursor-pointer","border-l-4","border-family-purple","hover:shadow-card-hover","transition-shadow",3,"click"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),Y(5,"\u{1f195} Nouveau"),G(),j(6,"span",5),Y(7),G(),j(8,"button",6),Rr(),j(9,"svg",7),wt(10,"path",8),G()()(),ua(),j(11,"div",9),Ge("cdkDropListDropped",function(a){return i.drop(a)}),sr(12,_1e,11,5,"div",10,Ja),G()(),j(14,"div",2)(15,"div",3)(16,"span",4),Y(17,"\u{1f504} En cours"),G(),j(18,"span",11),Y(19),G()(),j(20,"div",12),Ge("cdkDropListDropped",function(a){return i.drop(a)}),sr(21,w1e,11,5,"div",10,Ja),G()(),j(23,"div",2)(24,"div",3)(25,"span",4),Y(26,"\u2705 Fait"),G(),j(27,"span",13),Y(28),G()(),j(29,"div",14),Ge("cdkDropListDropped",function(a){return i.drop(a)}),sr(30,D1e,11,5,"div",10,Ja),G()(),j(32,"div",2)(33,"div",3)(34,"span",4),Y(35,"\u{1f6ab} Bloque"),G(),j(36,"span",15),Y(37),G()(),j(38,"div",16),Ge("cdkDropListDropped",function(a){return i.drop(a)}),sr(39,k1e,11,5,"div",10,Ja),G()(),j(41,"div",2)(42,"div",3)(43,"span",4),Y(44,"\u{1f4e6} Archive"),G(),j(45,"span",17),Y(46),G()(),j(47,"div",18),Ge("cdkDropListDropped",function(a){return i.drop(a)}),sr(48,P1e,11,5,"div",10,Ja),G()()()()),2&r&&(le(7),Lt(i.new.length||0),le(4),gn("cdkDropListData",i.new),le(),ar(i.new),le(7),Lt(i.en_cours.length),le(),gn("cdkDropListData",i.en_cours),le(),ar(i.en_cours),le(7),Lt(i.fait.length),le(),gn("cdkDropListData",i.fait),le(),ar(i.fait),le(7),Lt(i.bloquer.length),le(),gn("cdkDropListData",i.bloquer),le(),ar(i.bloquer),le(7),Lt(i.archiver.length),le(),gn("cdkDropListData",i.archiver),le(),ar(i.archiver))},dependencies:[Rh,XU,h1e,sW,oW,iW,Yb,fp],styles:[".drop-container[_ngcontent-%COMP%]{min-height:100vh;border:1px dashed #ccc}"]})}}return t})(),aW=(()=>{class t{constructor(){this._vacations=wo([]),this.vacations=this._vacations.asReadonly(),this.upcomingVacations=di(()=>{const e=new Date;return this._vacations().filter(r=>new Date(r.startDate)>e)}),this.nextVacation=di(()=>this.upcomingVacations()[0]||null),this.vacationsRef=Ir(Lr,"/vacations"),this.initListener()}initListener(){Mp(this.vacationsRef,e=>{const r=e.val();if(!r)return void this._vacations.set([]);const i=Object.keys(r).map(o=>({...r[o],id:o}));i.sort((o,a)=>new Date(o.startDate).getTime()-new Date(a.startDate).getTime()),this._vacations.set(i)})}addVacation(e){var r=this;return fe(function*(){const i=Vy(r.vacationsRef);return yield Sd(i,{...e,id:i.key}),i.key})()}updateVacation(e,r){return fe(function*(){yield Dg(Ir(Lr,`/vacations/${e}`),r)})()}deleteVacation(e){return fe(function*(){yield Cg(Ir(Lr,`/vacations/${e}`))})()}listenChecklist(e,r){const i=Ir(Lr,`/vacations/${e}/checklist`);return Mp(i,o=>{const a=o.val();r(a?Object.keys(a).map(c=>({...a[c],id:c})):[])}),()=>OD(i)}addChecklistItem(e,r){return fe(function*(){const i=ho.currentUser,o=Vy(Ir(Lr,`/vacations/${e}/checklist`));yield Sd(o,{id:o.key,text:r,checked:!1,addedBy:i?.displayName||""})})()}toggleChecklistItem(e,r,i){return fe(function*(){yield Dg(Ir(Lr,`/vacations/${e}/checklist/${r}`),{checked:i})})()}deleteChecklistItem(e,r){return fe(function*(){yield Cg(Ir(Lr,`/vacations/${e}/checklist/${r}`))})()}listenPhotos(e,r){const i=Ir(Lr,`/vacations/${e}/photos`);return Mp(i,o=>{const a=o.val();if(!a)return void r([]);const c=Object.keys(a).map(f=>({...a[f],id:f}));c.sort((f,_)=>new Date(_.addedAt).getTime()-new Date(f.addedAt).getTime()),r(c)}),()=>OD(i)}uploadPhoto(e,r,i){return fe(function*(){const o=ho.currentUser;if(!o)return;const a=`vacations/${e}/${Date.now()}_${r.name}`,c=lw(cw,a);yield DN(c,r);const f=yield TN(c),_=Vy(Ir(Lr,`/vacations/${e}/photos`));yield Sd(_,{id:_.key,url:f,caption:i||"",addedBy:o.uid,addedByName:o.displayName||"",addedAt:(new Date).toISOString()})})()}deletePhoto(e,r){return fe(function*(){yield Cg(Ir(Lr,`/vacations/${e}/photos/${r.id}`))})()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function O1e(t,n){if(1&t&&(j(0,"a",13)(1,"div",16),Y(2,"\u{1f3d6}\ufe0f"),G(),j(3,"div",17)(4,"div",18),Y(5),G(),j(6,"div",19),Y(7),G()(),j(8,"div",20)(9,"div",21),Y(10),G()()()),2&t){const e=n,r=xe();le(5),Lt(e.title),le(2),Lt(e.destination),le(3),ci("J-",r.daysUntil(e.startDate))}}let L1e=(()=>{class t{constructor(e,r){this.vacService=e,this.router=r,this.nextVacation=this.vacService.nextVacation}daysUntil(e){const r=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(r/864e5))}onEdit(e){this.router.navigate(["/task/edit",e])}static{this.\u0275fac=function(r){return new(r||t)(Re(aW),Re(Bs))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-home"]],decls:46,vars:1,consts:[[1,"card-fun","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","mb-6"],["routerLink","/chat",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],[1,"text-3xl","mb-2"],[1,"font-display","font-semibold","text-gray-700","text-sm"],["routerLink","/add-task",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/shopping",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/map",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/calendar",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/documents",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/vacances",1,"card-fun","p-4","text-center","hover:shadow-card-hover","transition-shadow","cursor-pointer"],["routerLink","/vacances",1,"card-fun","p-4","mb-6","flex","items-center","gap-4","hover:shadow-card-hover","transition-shadow","cursor-pointer","bg-gradient-to-r","from-family-coral/5","to-family-orange/5"],[1,"card-fun","p-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"text-3xl"],[1,"flex-1"],[1,"font-display","font-bold","text-gray-700"],[1,"text-sm","text-gray-500"],[1,"text-center"],[1,"text-2xl","font-display","font-extrabold","text-family-pink"]],template:function(r,i){if(1&r&&(j(0,"div",0)(1,"h1",1),Y(2,"Bonjour la famille ! \u{1f44b}"),G(),j(3,"p",2),Y(4,"Bienvenue sur votre espace famille"),G()(),j(5,"div",3)(6,"a",4)(7,"div",5),Y(8,"\u{1f4f1}"),G(),j(9,"div",6),Y(10,"Fil d'actu"),G()(),j(11,"a",7)(12,"div",5),Y(13,"\u270f\ufe0f"),G(),j(14,"div",6),Y(15,"Nouvelle tache"),G()(),j(16,"a",8)(17,"div",5),Y(18,"\u{1f6d2}"),G(),j(19,"div",6),Y(20,"Courses"),G()(),j(21,"a",9)(22,"div",5),Y(23,"\u{1f5fa}\ufe0f"),G(),j(24,"div",6),Y(25,"Carte"),G()(),j(26,"a",10)(27,"div",5),Y(28,"\u{1f4c5}"),G(),j(29,"div",6),Y(30,"Calendrier"),G()(),j(31,"a",11)(32,"div",5),Y(33,"\u{1f4c1}"),G(),j(34,"div",6),Y(35,"Documents"),G()(),j(36,"a",12)(37,"div",5),Y(38,"\u{1f3d6}\ufe0f"),G(),j(39,"div",6),Y(40,"Vacances"),G()()(),vt(41,O1e,11,3,"a",13),j(42,"div",14)(43,"h2",15),Y(44,"\u{1f4cb} Tableau des taches"),G(),wt(45,"app-kanban"),G()),2&r){let o;le(41),bt((o=i.nextVacation())?41:-1,o)}},dependencies:[N1e,Yb,fp],styles:[".card[_ngcontent-%COMP%]{box-sizing:border-box;width:300px;margin:20px auto;padding:10px 30px}h1[_ngcontent-%COMP%]{margin:10px}.close-button[_ngcontent-%COMP%], .edit-button[_ngcontent-%COMP%]{float:right;top:-14px;right:-30px}"]})}}return t})();var Qh=Nd(197),tO=Nd.n(Qh);function nO(t,n,e,r){return new(e||(e=Promise))(function(o,a){function c(x){try{_(r.next(x))}catch(D){a(D)}}function f(x){try{_(r.throw(x))}catch(D){a(D)}}function _(x){x.done?o(x.value):function i(o){return o instanceof e?o:new e(function(a){a(o)})}(x.value).then(c,f)}_((r=r.apply(t,n||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var rO,lW,lT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function cW(){if(lW)return rO;lW=1,rO=function n(){for(var e={},r=0;r<arguments.length;r++){var i=arguments[r];for(var o in i)t.call(i,o)&&(e[o]=i[o])}return e};var t=Object.prototype.hasOwnProperty;return rO}var uW,oO,dW,sO,hW,aO,fW,iO={exports:{}};var pW,lO,mW,gW,j1e=cT(function z1e(){if(fW)return aO;fW=1;var t=function V1e(){if(hW)return sO;hW=1;var t=cW(),n=function F1e(){return uW||(uW=1,iO.exports=e={},e.simpleFilter=function(r,i){return i.filter(function(o){return e.test(r,o)})},e.test=function(r,i){return null!==e.match(r,i)},e.match=function(r,i,o){var B,a=0,c=[],f=i.length,_=0,x=0,D=(o=o||{}).pre||"",A=o.post||"",N=o.caseSensitive&&i||i.toLowerCase();r=o.caseSensitive&&r||r.toLowerCase();for(var te=0;te<f;te++)B=i[te],N[te]===r[a]?(B=D+B+A,a+=1,x+=1+x):x=0,_+=x,c[c.length]=B;return a===r.length?(_=N===r?1/0:_,{rendered:c.join(""),score:_}):null},e.filter=function(r,i,o){return i&&0!==i.length?"string"!=typeof r?i:(o=o||{},i.reduce(function(a,c,f,_){var x=c;o.extract&&(x=o.extract(c));var D=e.match(r,x,o);return null!=D&&(a[a.length]={string:D.rendered,score:D.score,index:f,original:c}),a},[]).sort(function(a,c){return c.score-a.score||a.index-c.index})):[]}),iO.exports;var e}(),e=function B1e(){if(dW)return oO;dW=1;var t=function(n){return this.component=n,this.items=[],this.active=n.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,n.el.parentNode.insertBefore(this.wrapper,n.el.nextSibling),this};return t.prototype.show=function(){this.element.style.display="block"},t.prototype.hide=function(){this.element.style.display="none"},t.prototype.add=function(n){this.items.push(n)},t.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},t.prototype.isEmpty=function(){return!this.items.length},t.prototype.isVisible=function(){return"block"===this.element.style.display},t.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var n=0;n<this.items.length;n++)this.drawItem(this.items[n],this.active===n);this.show()}else this.hide()},t.prototype.drawItem=function(n,e){var r=document.createElement("li"),i=document.createElement("a");e&&(r.className+=" active"),i.innerHTML=n.string,r.appendChild(i),this.element.appendChild(r),r.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),r.addEventListener("mouseup",function(){this.handleMouseUp.call(this,n)}.bind(this))},t.prototype.handleMouseUp=function(n){this.selectingListItem=!1,this.component.value(n.original),this.clear(),this.draw()},t.prototype.move=function(n){this.active=n,this.draw()},t.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},t.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},t.prototype.drawError=function(n){var e=document.createElement("li");e.innerHTML=n,this.element.appendChild(e),this.show()},oO=t}(),r=function(i,o,a){return this.options=t({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},a=a||{}),this.el=i,this.data=o||[],this.list=new e(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(c){this.handleKeyUp(c.keyCode,c)}.bind(this),!1),this.el.addEventListener("keydown",function(c){this.handleKeyDown(c)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(c){this.handlePaste(c)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return r.prototype.handleKeyUp=function(i,o){if(40!==i&&38!==i&&27!==i&&9!==i){if(13===i)return void(this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),o.stopPropagation()));this.handleInputChange(this.el.value)}},r.prototype.handleKeyDown=function(i){switch(i.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&i.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},r.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},r.prototype.handlePaste=function(i){if(i.clipboardData)this.handleInputChange(i.clipboardData.getData("Text"));else{var o=this;setTimeout(function(){o.handleInputChange(i.target.value)},100)}},r.prototype.handleInputChange=function(i){this.query=this.normalize(i),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(o){for(var a=0;a<o.length&&(this.list.add(o[a]),a!==this.options.limit-1);a++);this.list.draw()}.bind(this))},r.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},r.prototype.update=function(i){this.data=i,this.handleKeyUp()},r.prototype.clear=function(){this.data=[],this.list.clear()},r.prototype.normalize=function(i){return i.toLowerCase()},r.prototype.match=function(i,o){return i.indexOf(o)>-1},r.prototype.value=function(i){if(this.selected=i,this.el.value=this.getItemValue(i||{place_name:this.query}),document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent("change",!0,!1),this.el.dispatchEvent(o)}else this.el.fireEvent("onchange")},r.prototype.getCandidates=function(i){var o={pre:"<strong>",post:"</strong>",extract:function(c){return this.getItemValue(c)}.bind(this)};i(this.options.filter?n.filter(this.query,this.data,o).map(function(c){return{original:c.original,string:this.render(c.original,c.string)}}.bind(this)):this.data.map(function(c){return{original:c,string:this.render(c)}}.bind(this)))},r.prototype.getItemValue=function(i){return i},r.prototype.render=function(i,o){if(o)return o;for(var a=this.getItemValue(i.original?i.original:i),c=this.normalize(a),f=c.lastIndexOf(this.query);f>-1;){var _=f+this.query.length;a=a.slice(0,f)+"<strong>"+a.slice(f,_)+"</strong>"+a.slice(_),f=c.slice(0,f).lastIndexOf(this.query)}return a},r.prototype.renderError=function(i){this.list.drawError(i)},sO=r}();return aO=t,typeof window<"u"&&(window.Suggestions=t),aO}()),uT={exports:{}},H1e=uT.exports,G1e=cT(function $1e(){return pW||(pW=1,n=H1e,r=function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(f){return f.match(e)||[]}function o(f){return{language:(f=r(f))[1]||"",extlang:f[2]||"",script:f[3]||"",region:f[4]||""}}function a(f,_,x){Object.defineProperty(f,_,{value:x,enumerable:!0})}function c(f,_,x){function D(A){return r(A)[f]||""}a(D,"pattern",_),a(o,x,D)}return c(1,/^[a-zA-Z]{2,3}$/,"language"),c(2,/^[a-zA-Z]{3}$/,"extlang"),c(3,/^[a-zA-Z]{4}$/,"script"),c(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(o,"split",function i(f){return r(f).filter(function(_,x){return _&&x})}),o},(t=uT).exports?t.exports=r():n.subtag=r()),uT.exports;var t,n,r}()),K1e=function W1e(){if(mW)return lO;mW=1;var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt,_="object"==typeof self&&self&&self.Object===Object&&self,x="object"==typeof lT&&lT&&lT.Object===Object&&lT||_||Function("return this")(),A=Object.prototype.toString,N=Math.max,B=Math.min,te=function(){return x.Date.now()};function we(Ee){var Be=typeof Ee;return!!Ee&&("object"==Be||"function"==Be)}function Se(Ee){if("number"==typeof Ee)return Ee;if(function We(Ee){return"symbol"==typeof Ee||function Ce(Ee){return!!Ee&&"object"==typeof Ee}(Ee)&&"[object Symbol]"==A.call(Ee)}(Ee))return NaN;if(we(Ee)){var Be="function"==typeof Ee.valueOf?Ee.valueOf():Ee;Ee=we(Be)?Be+"":Be}if("string"!=typeof Ee)return 0===Ee?Ee:+Ee;Ee=Ee.replace(r,"");var Xe=o.test(Ee);return Xe||a.test(Ee)?c(Ee.slice(2),Xe?2:8):i.test(Ee)?NaN:+Ee}return lO=function ce(Ee,Be,Xe){var mt,sn,cn,Li,Ci,ll,Pd=0,Rw=!1,Pt=!1,Qt=!0;if("function"!=typeof Ee)throw new TypeError("Expected a function");function un(Jn){var ea=mt,xs=sn;return mt=sn=void 0,Pd=Jn,Li=Ee.apply(xs,ea)}function Vl(Jn){var ea=Jn-ll;return void 0===ll||ea>=Be||ea<0||Pt&&Jn-Pd>=cn}function ws(){var Jn=te();if(Vl(Jn))return Tu(Jn);Ci=setTimeout(ws,function Ko(Jn){var Rg=Be-(Jn-ll);return Pt?B(Rg,cn-(Jn-Pd)):Rg}(Jn))}function Tu(Jn){return Ci=void 0,Qt&&mt?un(Jn):(mt=sn=void 0,Li)}function Pw(){var Jn=te(),ea=Vl(Jn);if(mt=arguments,sn=this,ll=Jn,ea){if(void 0===Ci)return function cr(Jn){return Pd=Jn,Ci=setTimeout(ws,Be),Rw?un(Jn):Li}(ll);if(Pt)return Ci=setTimeout(ws,Be),un(ll)}return void 0===Ci&&(Ci=setTimeout(ws,Be)),Li}return Be=Se(Be)||0,we(Xe)&&(Rw=!!Xe.leading,cn=(Pt="maxWait"in Xe)?N(Se(Xe.maxWait)||0,Be):cn,Qt="trailing"in Xe?!!Xe.trailing:Qt),Pw.cancel=function Di(){void 0!==Ci&&clearTimeout(Ci),Pd=0,mt=ll=sn=Ci=void 0},Pw.flush=function fT(){return void 0===Ci?Li:Tu(te())},Pw},lO}(),Z1e=cT(K1e),Cu=cT(cW()),dT={exports:{}},Q1e=function X1e(){if(gW)return dT.exports;gW=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(Ee,Be,Xe){return Function.prototype.apply.call(Ee,Be,Xe)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(Ee){return Object.getOwnPropertyNames(Ee).concat(Object.getOwnPropertySymbols(Ee))}:function(Ee){return Object.getOwnPropertyNames(Ee)};var i=Number.isNaN||function(Ee){return Ee!=Ee};function o(){o.init.call(this)}dT.exports=o,dT.exports.once=function we(Se,Ee){return new Promise(function(Be,Xe){function mt(cn){Se.removeListener(Ee,sn),Xe(cn)}function sn(){"function"==typeof Se.removeListener&&Se.removeListener("error",mt),Be([].slice.call(arguments))}We(Se,Ee,sn,{once:!0}),"error"!==Ee&&function Ce(Se,Ee,Be){"function"==typeof Se.on&&We(Se,"error",Ee,Be)}(Se,mt,{once:!0})})},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function c(Se){if("function"!=typeof Se)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Se)}function f(Se){return void 0===Se._maxListeners?o.defaultMaxListeners:Se._maxListeners}function _(Se,Ee,Be,Xe){var mt,sn,cn;if(c(Be),void 0===(sn=Se._events)?(sn=Se._events=Object.create(null),Se._eventsCount=0):(void 0!==sn.newListener&&(Se.emit("newListener",Ee,Be.listener?Be.listener:Be),sn=Se._events),cn=sn[Ee]),void 0===cn)cn=sn[Ee]=Be,++Se._eventsCount;else if("function"==typeof cn?cn=sn[Ee]=Xe?[Be,cn]:[cn,Be]:Xe?cn.unshift(Be):cn.push(Be),(mt=f(Se))>0&&cn.length>mt&&!cn.warned){cn.warned=!0;var Li=new Error("Possible EventEmitter memory leak detected. "+cn.length+" "+String(Ee)+" listeners added. Use emitter.setMaxListeners() to increase limit");Li.name="MaxListenersExceededWarning",Li.emitter=Se,Li.type=Ee,Li.count=cn.length,function r(Se){console&&console.warn&&console.warn(Se)}(Li)}return Se}function x(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(Se,Ee,Be){var Xe={fired:!1,wrapFn:void 0,target:Se,type:Ee,listener:Be},mt=x.bind(Xe);return mt.listener=Be,Xe.wrapFn=mt,mt}function A(Se,Ee,Be){var Xe=Se._events;if(void 0===Xe)return[];var mt=Xe[Ee];return void 0===mt?[]:"function"==typeof mt?Be?[mt.listener||mt]:[mt]:Be?function ce(Se){for(var Ee=new Array(Se.length),Be=0;Be<Ee.length;++Be)Ee[Be]=Se[Be].listener||Se[Be];return Ee}(mt):B(mt,mt.length)}function N(Se){var Ee=this._events;if(void 0!==Ee){var Be=Ee[Se];if("function"==typeof Be)return 1;if(void 0!==Be)return Be.length}return 0}function B(Se,Ee){for(var Be=new Array(Ee),Xe=0;Xe<Ee;++Xe)Be[Xe]=Se[Xe];return Be}function We(Se,Ee,Be,Xe){if("function"==typeof Se.on)Xe.once?Se.once(Ee,Be):Se.on(Ee,Be);else{if("function"!=typeof Se.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Se);Se.addEventListener(Ee,function mt(sn){Xe.once&&Se.removeEventListener(Ee,mt),Be(sn)})}}return Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(Se){if("number"!=typeof Se||Se<0||i(Se))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Se+".");a=Se}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(Ee){if("number"!=typeof Ee||Ee<0||i(Ee))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ee+".");return this._maxListeners=Ee,this},o.prototype.getMaxListeners=function(){return f(this)},o.prototype.emit=function(Ee){for(var Be=[],Xe=1;Xe<arguments.length;Xe++)Be.push(arguments[Xe]);var mt="error"===Ee,sn=this._events;if(void 0!==sn)mt=mt&&void 0===sn.error;else if(!mt)return!1;if(mt){var cn;if(Be.length>0&&(cn=Be[0]),cn instanceof Error)throw cn;var Li=new Error("Unhandled error."+(cn?" ("+cn.message+")":""));throw Li.context=cn,Li}var Ci=sn[Ee];if(void 0===Ci)return!1;if("function"==typeof Ci)n(Ci,this,Be);else{var ll=Ci.length,Pd=B(Ci,ll);for(Xe=0;Xe<ll;++Xe)n(Pd[Xe],this,Be)}return!0},o.prototype.on=o.prototype.addListener=function(Ee,Be){return _(this,Ee,Be,!1)},o.prototype.prependListener=function(Ee,Be){return _(this,Ee,Be,!0)},o.prototype.once=function(Ee,Be){return c(Be),this.on(Ee,D(this,Ee,Be)),this},o.prototype.prependOnceListener=function(Ee,Be){return c(Be),this.prependListener(Ee,D(this,Ee,Be)),this},o.prototype.off=o.prototype.removeListener=function(Ee,Be){var Xe,mt,sn,cn,Li;if(c(Be),void 0===(mt=this._events))return this;if(void 0===(Xe=mt[Ee]))return this;if(Xe===Be||Xe.listener===Be)0===--this._eventsCount?this._events=Object.create(null):(delete mt[Ee],mt.removeListener&&this.emit("removeListener",Ee,Xe.listener||Be));else if("function"!=typeof Xe){for(sn=-1,cn=Xe.length-1;cn>=0;cn--)if(Xe[cn]===Be||Xe[cn].listener===Be){Li=Xe[cn].listener,sn=cn;break}if(sn<0)return this;0===sn?Xe.shift():function te(Se,Ee){for(;Ee+1<Se.length;Ee++)Se[Ee]=Se[Ee+1];Se.pop()}(Xe,sn),1===Xe.length&&(mt[Ee]=Xe[0]),void 0!==mt.removeListener&&this.emit("removeListener",Ee,Li||Be)}return this},o.prototype.removeAllListeners=function(Ee){var Be,Xe,mt;if(void 0===(Xe=this._events))return this;if(void 0===Xe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==Xe[Ee]&&(0===--this._eventsCount?this._events=Object.create(null):delete Xe[Ee]),this;if(0===arguments.length){var cn,sn=Object.keys(Xe);for(mt=0;mt<sn.length;++mt)"removeListener"!==(cn=sn[mt])&&this.removeAllListeners(cn);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Be=Xe[Ee]))this.removeListener(Ee,Be);else if(void 0!==Be)for(mt=Be.length-1;mt>=0;mt--)this.removeListener(Ee,Be[mt]);return this},o.prototype.listeners=function(Ee){return A(this,Ee,!0)},o.prototype.rawListeners=function(Ee){return A(this,Ee,!1)},o.listenerCount=function(Se,Ee){return"function"==typeof Se.listenerCount?Se.listenerCount(Ee):N.call(Se,Ee)},o.prototype.listenerCount=N,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},dT.exports}();const _W={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};var Aw={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a",es:"Buscar"},errorNoResults:{en:"No results found",de:"Keine Ergebnisse gefunden",es:"No hay resultados",fr:"Aucun r\xe9sultat trouv\xe9"},errorConnectionFailed:{en:"There was an error reaching the server",de:"Verbindung fehlgeschlagen",es:"Error al conectarse al servidor",fr:"Une erreur est survenue lors de la connexion au serveur"}};const J1e=/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;class eEe{constructor(n,e,r=(i,o,a)=>new j1e(i,o,a)){this.options={zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:void 0,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,proximityMinZoom:9,getItemValue:i=>null!=i.text?i.text:i.place_name,render:i=>{if(!("geometry"in i)){const a=i.text,c=a.toLowerCase().indexOf(this._typeahead.query.toLowerCase()),f=this._typeahead.query.length;return'<div class="maplibregl-ctrl-geocoder--suggestion"><svg class="maplibregl-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="maplibregl-ctrl-geocoder--suggestion-info"><div class="maplibregl-ctrl-geocoder--suggestion-title">'+a.substring(0,c)+'<span class="maplibregl-ctrl-geocoder--suggestion-match">'+a.substring(c,c+f)+"</span>"+a.substring(c+f)+"</div></div></div>"}const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--result"><svg class="maplibregl-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="maplibregl-ctrl-geocoder--result-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--result-address">'+o.splice(1,o.length).join(",")+"</div></div></div>"},popupRender:i=>{const o=i.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--suggestion popup-suggestion"><div class="maplibregl-ctrl-geocoder--suggestion-title popup-suggestion-title">'+o[0]+'</div><div class="maplibregl-ctrl-geocoder--suggestion-address popup-suggestion-address">'+o.splice(1,o.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},this._eventEmitter=new Q1e.EventEmitter,this.options=Cu({},this.options,e),this.fresh=!0,this.lastSelected=null,this.geocoderApi=n,this.typeaheadFactory=r}addTo(n){function e(r,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const o=r.onAdd();i.appendChild(o)}if(n instanceof HTMLElement)e(this,n);else if("string"==typeof n){const r=document.querySelectorAll(n);if(0===r.length)throw new Error("Element "+n+"not found.");if(r.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,r[0])}else{if(!("addControl"in n))throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element");n.addControl(this)}}onAdd(n){if(n&&"string"!=typeof n&&(this._map=n),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);const e=this.container=document.createElement("div");e.className="maplibregl-ctrl-geocoder maplibregl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";const r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="search",this._inputEl.className="maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",Z1e(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);const i=document.createElement("div");i.classList.add("maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("type","button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="maplibregl-ctrl-geocoder--button";const o=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(o),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),i.appendChild(this._clearEl),i.appendChild(this._loadingEl),e.appendChild(r),e.appendChild(this._inputEl),e.appendChild(i),this._typeahead=this.typeaheadFactory(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.container.addEventListener("click",()=>{this._typeahead.update(this._typeahead.data)}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),e}createIcon(n,e){const r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("class","maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+n),r.setAttribute("viewBox","0 0 18 18"),r.setAttribute("xml:space","preserve"),r.setAttribute("width","18"),r.setAttribute("height","18"),"innerHTML"in r)r.innerHTML=e;else{const i=document.createElement("div");i.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",r.appendChild(i.firstChild.firstChild)}return r}onRemove(){return this.container.remove(),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this}_onPaste(n){const e=(n.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)}_onKeyDown(n){if("Escape"===n.key&&this.options.clearAndBlurOnEsc)return this._clear(n),void this._inputEl.blur();const e=this._inputEl.value;if(!e)return this.fresh=!0,"Tab"!==n.key&&this.clear(n),void(this._clearEl.style.display="none");if(!n.metaKey&&"Tab"!==n.key&&"Escape"!==n.key&&"ArrowLeft"!==n.key&&"ArrowRight"!==n.key&&"ArrowUp"!==n.key&&"ArrowDown"!==n.key){if("Enter"===n.key){if(this.options.showResultsWhileTyping)return void(null==this._typeahead.selected&&this.geocoderApi.getSuggestions?this._geocode(e,!0):null==this._typeahead.selected&&this.options.showResultMarkers&&this._fitBoundsForMarkers());this._typeahead.selected||this._geocode(e)}e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e)}}_showButton(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")}_hideButton(){this._typeahead.selected&&(this._clearEl.style.display="none")}_onBlur(n){this.options.clearOnBlur&&this._clearOnBlur(n),this.options.collapsed&&this._collapse()}_onChange(){var n;const e=this._typeahead.selected;if(e){if(!("geometry"in e))return void(e.placeId?this._geocode(e.placeId,!0,!0):this._geocode(e.text,!0));if(JSON.stringify(e)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){let r;if(this._removeResultMarkers(),e.properties&&_W[e.properties.short_code])r=Cu({},this.options.flyTo),this._map&&this._map.fitBounds(_W[e.properties.short_code].bbox,r);else if(e.bbox){const i=e.bbox;r=Cu({},this.options.flyTo),this._map&&this._map.fitBounds([[i[0],i[1]],[i[2],i[3]]],r)}else r=Cu({},{zoom:this.options.zoom},this.options.flyTo),e.center?r.center=e.center:"Point"===(null===(n=e.geometry)||void 0===n?void 0:n.type)&&e.geometry.coordinates&&(r.center=e.geometry.coordinates),this._map&&this._map.flyTo(r)}this.options.marker&&this._maplibregl&&this._handleMarker(e),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(e),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:e})}}}_getConfigForRequest(){return["bbox","limit","proximity","countries","types","language","reverseMode"].reduce((r,i)=>(this.options[i]&&(r[i]=["countries","types","language"].indexOf(i)>-1?this.options[i].split(/[\s,]+/):this.options[i],"proximity"===i&&this.options[i]&&"number"==typeof this.options[i].longitude&&"number"==typeof this.options[i].latitude&&(r[i]=[this.options[i].longitude,this.options[i].latitude])),r),{})}_geocode(n){return nO(this,arguments,void 0,function*(e,r=!1,i=!1){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:e});const o=this._getConfigForRequest(),a=this._createGeocodeRequest(o,e,r,i),c=this.options.localGeocoder&&this.options.localGeocoder(e)||[];try{const f=yield a;yield this._handleGeocodeResponse(f,o,e,r,c)}catch(f){this._handleGeocodeErrorResponse(f,c)}return a})}_createGeocodeRequest(n,e,r,i){return this.options.localGeocoderOnly?Promise.resolve({}):this.options.reverseGeocode&&J1e.test(e)?this._createReverseGeocodeRequest(e,n):(n.query=e,this.geocoderApi.getSuggestions?r?this.geocoderApi.searchByPlaceId&&i?this.geocoderApi.searchByPlaceId(n):this.geocoderApi.forwardGeocode(n):this.geocoderApi.getSuggestions(n):this.geocoderApi.forwardGeocode(n))}_createReverseGeocodeRequest(n,e){const r=n.split(/[\s(,)?]+/).map(i=>parseFloat(i)).reverse();return e.query=r,e.limit=1,"proximity"in e&&delete e.proximity,this.geocoderApi.reverseGeocode(e)}_handleGeocodeResponse(n,e,r,i,o){return nO(this,void 0,void 0,function*(){this._loadingEl.style.display="none";let a={};a=n||{type:"FeatureCollection",features:[]},a.config=e,this.fresh&&(this.fresh=!1),a.features=a.features?o.concat(a.features):o;const c=this.options.externalGeocoder&&this.options.externalGeocoder(r,a.features,e)||Promise.resolve([]);try{const _=yield c;a.features=a.features?_.concat(a.features):_}catch{}this.options.filter&&a.features.length&&(a.features=a.features.filter(this.options.filter));let f=[];f="suggestions"in a?a.suggestions:"place"in a?Array.isArray(a.place)?a.place:[a.place]:a.features,f.length?(this._clearEl.style.display="block",this._typeahead.update(f),(!this.options.showResultsWhileTyping||i)&&this.options.showResultMarkers&&(a.features.length>0||"place"in a)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",a)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",a))})}_handleGeocodeErrorResponse(n,e){this._loadingEl.style.display="none",e.length&&this.options.localGeocoder?(this._clearEl.style.display="block",this._typeahead.update(e)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:e}),this._eventEmitter.emit("error",{error:n})}_clear(n){n&&n.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0}clear(n){this._clear(n),this._inputEl.focus()}_clearOnBlur(n){n.relatedTarget&&this._clear(n)}_onQueryResult(n){if(!("features"in n)||!n.features.length)return;const e=n.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}_updateProximity(){if(this._map)if(this._map.getZoom()>this.options.proximityMinZoom){const n=this._map.getCenter().wrap();this.setProximity({longitude:n.lng,latitude:n.lat})}else this.setProximity(null)}_collapse(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("maplibregl-ctrl-geocoder--collapsed")}_unCollapse(){this.container.classList.remove("maplibregl-ctrl-geocoder--collapsed")}query(n){return nO(this,void 0,void 0,function*(){const e=yield this._geocode(n);this._onQueryResult(e)})}_renderError(){const n=`<div class='maplibre-gl-geocoder--error'>${this._localize("errorConnectionFailed")}</div>`;this._renderMessage(n)}_renderNoResults(){const n=`<div class='maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>\n        ${this._localize("errorNoResults")}</div>`;this._renderMessage(n)}_renderMessage(n){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(n)}_localize(n){const e=G1e.language(this.options.language.split(",")[0]);return this.options.language&&Aw?.[n][e]?Aw[n][e]:Aw[n].en}_fitBoundsForMarkers(){var n;if(this._typeahead.data.length<1)return;const e=this._typeahead.data.filter(r=>"string"!=typeof r).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){const i=Cu({},{padding:100},this.options.flyTo),o=new this._maplibregl.LngLatBounds;for(const a of e)"geometry"in a&&"Point"===(null===(n=a.geometry)||void 0===n?void 0:n.type)&&o.extend(a.geometry.coordinates);this._map.fitBounds(o,i)}return e.length>0&&this._maplibregl&&this._handleResultMarkers(e),this}setInput(n){return this._inputEl.value=n,this._typeahead.selected=null,this._typeahead.clear(),n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n),this}setProximity(n){return this.options.proximity=n,this}getProximity(){return this.options.proximity}setRenderFunction(n){return n&&"function"==typeof n&&(this._typeahead.render=n),this}getRenderFunction(){return this._typeahead.render}setLanguage(n){return this.options.language=n||this.options.language||navigator.language,this}getLanguage(){return this.options.language}getZoom(){return this.options.zoom}setZoom(n){return this.options.zoom=n,this}getFlyTo(){return this.options.flyTo}setFlyTo(n){return this.options.flyTo=n,this}getPlaceholder(){return this.options.placeholder}setPlaceholder(n){return this.options.placeholder=n||this.options.placeholder||this._localize("placeholder"),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this}getBbox(){return this.options.bbox}setBbox(n){return this.options.bbox=n,this}getCountries(){return this.options.countries}setCountries(n){return this.options.countries=n,this}getTypes(){return this.options.types}setTypes(n){return this.options.types=n,this}getMinLength(){return this.options.minLength}setMinLength(n){return this.options.minLength=n,this._typeahead&&(this._typeahead.options.minLength=n),this}getLimit(){return this.options.limit}setLimit(n){return this.options.limit=n,this._typeahead&&(this._typeahead.options.limit=n),this}getFilter(){return this.options.filter}setFilter(n){return this.options.filter=n,this}setGeocoderApi(n){return this.geocoderApi=n,this}getGeocoderApi(){return this.geocoderApi}_handleMarker(n){var e;if(!this._map)return;this._removeMarker();const i=Cu({},{color:"#4668F2"},this.options.marker);this.mapMarker=new this._maplibregl.Marker(i);let o=null;if(this.options.popup){const c=Cu({},{},this.options.popup);o=new this._maplibregl.Popup(c).setHTML(this.options.popupRender(n))}return n.center?(this.mapMarker.setLngLat(n.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):"Point"===(null===(e=n.geometry)||void 0===e?void 0:e.type)&&n.geometry.coordinates&&(this.mapMarker.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}_removeMarker(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)}_handleResultMarkers(n){if(!this._map)return;this._removeResultMarkers();let r=Cu({},{color:"#4668F2"},this.options.showResultMarkers);for(const i of n){let o;if(this.options.showResultMarkers){this.options.showResultMarkers&&this.options.showResultMarkers.element&&(o=this.options.showResultMarkers.element.cloneNode(!0),r=Cu(r,{element:o}));const a=new this._maplibregl.Marker(Cu({},r,{element:o}));let c;if(this.options.popup){const _=Cu({},{},this.options.popup);c=new this._maplibregl.Popup(_).setHTML(this.options.popupRender(i))}i.center?(a.setLngLat(i.center).addTo(this._map),this.options.popup&&a.setPopup(c)):i.geometry&&i.geometry.type&&"Point"===i.geometry.type&&i.geometry.coordinates&&(a.setLngLat(i.geometry.coordinates).addTo(this._map),this.options.popup&&a.setPopup(c)),this.resultMarkers.push(a)}}return this}_removeResultMarkers(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(n){n.remove()}),this.resultMarkers=[])}on(n,e){return this._eventEmitter.on(n,e),this}once(n){return new Promise(e=>{this._eventEmitter.once(n,e)})}off(n,e){return this._eventEmitter.removeListener(n,e),this}}const tEe=["map"];let nEe=(()=>{class t{constructor(e){var r;this.locationService=e,this.markers={},this.unsubscribeLocations=null,this.centeredOnSelf=!1,this.geocoderApi={forwardGeocode:(r=fe(function*(i){const o=[];try{const a=`https://nominatim.openstreetmap.org/search?q=${i.query}&format=geojson&polygon_geojson=1&addressdetails=1`,f=yield(yield fetch(a)).json();for(const _ of f.features){const x=[_.bbox[0]+(_.bbox[2]-_.bbox[0])/2,_.bbox[1]+(_.bbox[3]-_.bbox[1])/2];o.push({type:"Feature",geometry:{type:"Point",coordinates:x},place_name:_.properties.display_name,properties:_.properties,text:_.properties.display_name,place_type:["place"],center:x})}}catch(a){console.error(`Failed to forwardGeocode with error: ${a}`)}return{type:"FeatureCollection",features:o}}),function(o){return r.apply(this,arguments)})}}ngAfterViewInit(){this.map=new Qh.Map({container:this.mapContainer.nativeElement,style:"https://maps.geoapify.com/v1/styles/maptiler-3d/style.json?apiKey=793f93202015411eaa6fceaeadaad99c",center:[2.213749,46.227638],zoom:5}),this.map.addControl(new(tO().NavigationControl)({visualizePitch:!0,showZoom:!0,showCompass:!0})),this.map.addControl(new(tO().FullscreenControl)),this.map.addControl(new eEe(this.geocoderApi,{maplibregl:tO()}),"top-left"),this.map.on("load",()=>{this.unsubscribeLocations=this.locationService.listenAllLocations(o=>{this.updateFamilyMarkers(o);const a=ho.currentUser?.uid;a&&o[a]&&!this.centeredOnSelf&&(this.map.flyTo({center:[o[a].lng,o[a].lat],zoom:14}),this.centeredOnSelf=!0)})})}updateFamilyMarkers(e){const r=ho.currentUser?.uid,i=new Set;for(const[o,a]of Object.entries(e)){i.add(o);const c=o===r;if(this.markers[o])this.markers[o].setLngLat([a.lng,a.lat]),this.markers[o].getPopup()?.setHTML(this.buildPopupHtml(a));else{const f=document.createElement("div");if(f.className="family-marker",f.style.cssText=`width:40px;height:40px;border-radius:50%;border:3px solid ${c?"#3b82f6":"#ec4899"};overflow:hidden;background:#fff;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.3);`,a.photoURL){const D=document.createElement("img");D.src=a.photoURL,D.style.cssText="width:100%;height:100%;object-fit:cover;",D.referrerPolicy="no-referrer",f.appendChild(D)}else f.style.display="flex",f.style.alignItems="center",f.style.justifyContent="center",f.style.fontSize="14px",f.style.fontWeight="bold",f.style.color="#ec4899",f.textContent=(a.displayName||"?")[0].toUpperCase();const x=new Qh.Popup({offset:25}).setHTML(this.buildPopupHtml(a));this.markers[o]=new Qh.Marker({element:f}).setLngLat([a.lng,a.lat]).setPopup(x).addTo(this.map)}}for(const o of Object.keys(this.markers))i.has(o)||(this.markers[o].remove(),delete this.markers[o])}buildPopupHtml(e){const i=new Date(e.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});return`<div style="font-family:sans-serif;text-align:center;">\n      <strong>${e.displayName||"Membre"}</strong><br>\n      <span style="color:#888;font-size:12px;">${i}</span>\n    </div>`}ngOnDestroy(){this.unsubscribeLocations&&this.unsubscribeLocations(),Object.values(this.markers).forEach(e=>e.remove())}static{this.\u0275fac=function(r){return new(r||t)(Re(Aq))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-map"]],viewQuery:function(r,i){if(1&r&&op(tEe,5),2&r){let o;hd(o=fd())&&(i.mapContainer=o.first)}},decls:5,vars:0,consts:[["map",""],[1,"card-fun","p-4","h-[calc(100vh-12rem)]"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-3"],[1,"map-container","rounded-xl","overflow-hidden","h-[calc(100%-3rem)]"]],template:function(r,i){1&r&&(Zt(0,"div",1)(1,"h2",2),Y(2,"\u{1f5fa}\ufe0f Carte"),qt(),dd(3,"div",3,0),qt())},styles:[".map-container[_ngcontent-%COMP%]{height:100%}"]})}}return t})(),Du=(()=>{class t{constructor(e,r){this.router=e,this.authService=r}canActivate(){return this.authService.redirectReady.then(()=>new Promise(e=>{WC(ho,r=>{r?e(!0):(this.router.navigate(["/auth","signin"]),e(!1))})}))}static{this.\u0275fac=function(r){return new(r||t)(Dt(Bs),Dt(Ad))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac})}}return t})();const rEe=[{key:"fruits_legumes",label:"Fruits & L\xe9gumes",icon:"\u{1f966}"},{key:"produits_laitiers",label:"Produits laitiers",icon:"\u{1f9c0}"},{key:"viandes",label:"Viandes & Poissons",icon:"\u{1f969}"},{key:"epicerie",label:"\xc9picerie",icon:"\u{1f35d}"},{key:"boissons",label:"Boissons",icon:"\u{1f964}"},{key:"surgeles",label:"Surgel\xe9s",icon:"\u{1f9ca}"},{key:"hygiene",label:"Hygi\xe8ne & Maison",icon:"\u{1f9f4}"},{key:"autre",label:"Autre",icon:"\u{1f4e6}"}];let iEe=(()=>{class t{constructor(){this._items=wo([]),this.items=this._items.asReadonly(),this.uncheckedItems=di(()=>this._items().filter(e=>!e.checked)),this.checkedItems=di(()=>this._items().filter(e=>e.checked)),this.totalUnchecked=di(()=>this.uncheckedItems().length),this.initListener()}initListener(){Mp(Ir(Lr,"/shopping"),e=>{const r=e.val();this._items.set(r?Object.keys(r).map(i=>({...r[i],id:i})):[])})}addItem(e){Vy(Ir(Lr,"/shopping"),e)}removeItem(e){Cg(Ir(Lr,"/shopping/"+e))}toggleChecked(e,r){Dg(Ir(Lr,"/shopping/"+e),{checked:r})}clearChecked(){const e=this._items().filter(i=>i.checked),r={};e.forEach(i=>r["/shopping/"+i.id]=null),Dg(Ir(Lr),r)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const yW=(t,n)=>n.key,vW=(t,n)=>n.id;function oEe(t,n){if(1&t){const e=yn();j(0,"button",8),Ge("click",function(){return He(e),Ze(xe().showAddForm=!0)}),Rr(),j(1,"svg",9),wt(2,"path",10),G(),ua(),j(3,"span",11),Y(4,"Ajouter un article"),G()()}}function sEe(t,n){if(1&t&&(j(0,"option",17),Y(1),G()),2&t){const e=n.$implicit;gn("value",e.key),le(),Ch("",e.icon," ",e.label)}}function aEe(t,n){if(1&t){const e=yn();j(0,"div",5)(1,"div",12)(2,"input",13),_a("ngModelChange",function(i){He(e);const o=xe();return tl(o.newItemName,i)||(o.newItemName=i),Ze(i)}),Ge("keyup.enter",function(){return He(e),Ze(xe().addItem())}),G(),j(3,"div",14)(4,"input",15),_a("ngModelChange",function(i){He(e);const o=xe();return tl(o.newItemQuantity,i)||(o.newItemQuantity=i),Ze(i)}),G(),j(5,"select",16),_a("ngModelChange",function(i){He(e);const o=xe();return tl(o.newItemCategory,i)||(o.newItemCategory=i),Ze(i)}),sr(6,sEe,2,3,"option",17,yW),G()(),j(8,"div",18)(9,"button",19),Ge("click",function(){return He(e),Ze(xe().showAddForm=!1)}),Y(10,"Annuler"),G(),j(11,"button",20),Ge("click",function(){return He(e),Ze(xe().addItem())}),Y(12,"Ajouter"),G()()()()}if(2&t){const e=xe();le(2),ga("ngModel",e.newItemName),le(2),ga("ngModel",e.newItemQuantity),le(),ga("ngModel",e.newItemCategory),le(),ar(e.categories),le(5),gn("disabled",!e.newItemName.trim())}}function lEe(t,n){if(1&t&&(j(0,"span",27),Y(1),G()),2&t){const e=xe().$implicit;le(),ci("x",e.quantity)}}function cEe(t,n){1&t&&wt(0,"img",32),2&t&&gn("src",xe(2).$implicit.addedByPhoto,So)}function uEe(t,n){if(1&t&&(j(0,"div",28),vt(1,cEe,1,1,"img",32),j(2,"span",33),Y(3),G()()),2&t){const e=xe().$implicit;le(),bt(e.addedByPhoto?1:-1),le(2),Lt(e.addedByName)}}function dEe(t,n){if(1&t){const e=yn();j(0,"div",23)(1,"button",24),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).toggleChecked(i))}),G(),j(2,"div",25)(3,"span",26),Y(4),G(),vt(5,lEe,2,1,"span",27),vt(6,uEe,4,2,"div",28),G(),j(7,"button",29),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).removeItem(i))}),Rr(),j(8,"svg",30),wt(9,"path",31),G()()()}if(2&t){const e=n.$implicit;le(4),Lt(e.nom),le(),bt(e.quantity&&"1"!==e.quantity?5:-1),le(),bt(e.addedByName?6:-1)}}function hEe(t,n){if(1&t&&(j(0,"div",6)(1,"h3",21)(2,"span"),Y(3),G(),Y(4),G(),j(5,"div",22),sr(6,dEe,10,3,"div",23,vW),G()()),2&t){const e=n.$implicit;le(3),Lt(e.icon),le(),ci(" ",e.label," "),le(2),ar(e.items)}}function fEe(t,n){if(1&t){const e=yn();j(0,"div",38)(1,"button",39),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).toggleChecked(i))}),Rr(),j(2,"svg",40),wt(3,"path",41),G()(),ua(),j(4,"span",42),Y(5),G()()}if(2&t){const e=n.$implicit;le(5),Lt(e.nom)}}function pEe(t,n){if(1&t){const e=yn();j(0,"div",7)(1,"div",34)(2,"h3",35)(3,"span"),Y(4,"\u2705"),G(),Y(5),G(),j(6,"button",36),Ge("click",function(){return He(e),Ze(xe().clearChecked())}),Y(7," Vider le panier "),G()(),j(8,"div",37),sr(9,fEe,6,1,"div",38,vW),G()()}if(2&t){const e=xe();le(5),ci(" Dans le panier (",e.checkedItems().length,") "),le(4),ar(e.checkedItems())}}let mEe=(()=>{class t{constructor(e){this.shoppingService=e,this.categories=rEe,this.newItemName="",this.newItemCategory="autre",this.newItemQuantity="",this.showAddForm=!1,this.items=this.shoppingService.items,this.uncheckedByCategory=di(()=>{const r=this.shoppingService.items();return this.categories.map(i=>({...i,items:r.filter(o=>!o.checked&&o.category===i.key)})).filter(i=>i.items.length>0)}),this.checkedItems=di(()=>this.shoppingService.items().filter(r=>r.checked)),this.totalItems=di(()=>this.shoppingService.items().filter(r=>!r.checked).length)}addItem(){var e=this;return fe(function*(){const r=e.newItemName.trim();if(!r)return;const i=ho.currentUser;let o="",a="";if(i){const f=(yield tw(Ir(Lr,`/users/${i.uid}`))).val()||{};o=f.displayName||i.displayName||"",a=f.photoURL||i.photoURL||""}e.shoppingService.addItem({nom:r,category:e.newItemCategory,quantity:e.newItemQuantity.trim()||"1",checked:!1,addedBy:i?.uid||"",addedByName:o,addedByPhoto:a,addedAt:(new Date).toISOString()}),e.newItemName="",e.newItemQuantity="",e.newItemCategory="autre",e.showAddForm=!1})()}toggleChecked(e){this.shoppingService.toggleChecked(e.id,!e.checked)}removeItem(e){this.shoppingService.removeItem(e.id)}clearChecked(){this.shoppingService.clearChecked()}getCategoryIcon(e){return this.categories.find(r=>r.key===e)?.icon||"\u{1f4e6}"}static{this.\u0275fac=function(r){return new(r||t)(Re(iEe))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-shopping"]],decls:11,vars:6,consts:[[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"text-sm","text-gray-400","mt-1"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-green","transition-colors"],[1,"card-fun","p-4","mb-6"],[1,"mb-4"],[1,"mt-6"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-green","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"font-medium"],[1,"space-y-3"],["placeholder","Nom de l'article...","autofocus","",1,"input-fun","w-full",3,"ngModelChange","keyup.enter","ngModel"],[1,"flex","gap-3"],["placeholder","Qt\xe9 (ex: 2, 500g...)",1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[1,"input-fun","flex-1",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","justify-end","gap-2"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","text-sm","font-medium",3,"click"],[1,"btn-gradient","text-sm","px-6","py-2",3,"click","disabled"],[1,"font-display","font-bold","text-sm","text-gray-500","mb-2","flex","items-center","gap-1.5"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],[1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors"],[1,"w-6","h-6","rounded-full","border-2","border-gray-300","flex-shrink-0","hover:border-family-green","transition-colors",3,"click"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-700"],[1,"text-xs","text-gray-400","ml-2"],[1,"flex","items-center","gap-1.5","mt-0.5"],[1,"text-gray-300","hover:text-red-400","transition-colors","flex-shrink-0",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],["referrerpolicy","no-referrer",1,"w-4","h-4","rounded-full","object-cover",3,"src"],[1,"text-xs","text-gray-400","truncate"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-display","font-bold","text-sm","text-gray-400","flex","items-center","gap-1.5"],[1,"text-xs","text-red-400","hover:text-red-500","transition-colors","font-medium",3,"click"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100","opacity-60"],[1,"flex","items-center","gap-3","px-4","py-3"],[1,"w-6","h-6","rounded-full","bg-family-green","flex-shrink-0","flex","items-center","justify-center",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","3",1,"w-3.5","h-3.5","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],[1,"flex-1","line-through","text-gray-400"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1)(2,"h1",2),Y(3,"\u{1f6d2} Liste de courses"),G(),j(4,"p",3),Y(5),G()(),vt(6,oEe,5,0,"button",4),vt(7,aEe,13,4,"div",5),sr(8,hEe,8,2,"div",6,yW),vt(10,pEe,11,1,"div",7),G()),2&r&&(le(5),X1("",i.totalItems()," article",i.totalItems()>1?"s":""," restant",i.totalItems()>1?"s":""),le(),bt(i.showAddForm?-1:6),le(),bt(i.showAddForm?7:-1),le(),ar(i.uncheckedByCategory()),le(2),bt(i.checkedItems().length>0?10:-1))},dependencies:[Rh,xw,bw,ww,Rc,Ag,Rd,kg],styles:["select.input-fun[_ngcontent-%COMP%]{appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}"]})}}return t})(),bW=(()=>{class t{constructor(e,r){this.dialogRef=e,this.data=r,this.customMessage=r.customMessage}static{this.\u0275fac=function(r){return new(r||t)(Re(og),Re(DC))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-confirm-dialog"]],decls:8,vars:1,consts:[[1,"p-6","max-w-sm"],[1,"font-display","text-lg","font-semibold","text-gray-700"],[1,"flex","justify-end","gap-3","mt-6"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"btn-gradient","px-6","py-2",3,"click"]],template:function(r,i){1&r&&(Zt(0,"div",0)(1,"h2",1),Y(2),qt(),Zt(3,"div",2)(4,"button",3),ma("click",function(){return i.dialogRef.close()}),Y(5,"Non"),qt(),Zt(6,"button",4),ma("click",function(){return i.dialogRef.close(!0)}),Y(7,"Oui"),qt()()()),2&r&&(le(2),Lt(i.customMessage))},encapsulation:2})}}return t})();function gEe(t,n){if(1&t&&(j(0,"option",8),Y(1),G()),2&t){const e=n.$implicit;gn("value",e.displayName||e.email),le(),Lt(e.displayName||e.email)}}let _Ee=(()=>{class t{constructor(e,r,i,o,a,c,f){this.route=e,this.tasksService=r,this.formBuilder=i,this._snackBar=o,this.router=a,this.dialog=c,this.userService=f,this.taskToEdit=null,this.allUsers=[],xo(()=>{if(this.taskToEdit)return;const _=this.route.snapshot.params.id,x=this.tasksService.tasks().find(D=>D.id===_);x&&(this.taskToEdit=x,this.editTaskForm=this.formBuilder.group({id:[x.id,[Pc.required]],name:[x.name,[Pc.required]],urg:[x.urg,[Pc.required]],title:[x.title,[Pc.required]],descriptif:[x.descriptif],createdDate:[x.createdDate||""],statut:[x.statut||""]}))})}onDelete(e){this.dialog.open(bW,{data:{customMessage:"Etes-vous s\xfbr(e) de vouloir supprimer la t\xe2che"}}).afterClosed().subscribe(i=>{!0===i&&(this.tasksService.removeTask(e.id),this.router.navigate(["/home"]))})}ngOnInit(){this.userService.getAllUsers().then(e=>this.allUsers=e).catch(()=>this._snackBar.open("Erreur lors du chargement des utilisateurs","",{duration:5e3}))}editTask(){this.dialog.open(bW,{data:{customMessage:"Etes-vous s\xfbr(e) de vouloir modifier la t\xe2che"}}).afterClosed().subscribe(r=>{!0===r&&(this.tasksService.updateTaskById(this.route.snapshot.params.id,this.editTaskForm.value),this.router.navigate(["/home"]),this._snackBar.open("T\xe2che modifi\xe9e","avec succ\xe8s !!",{duration:5e3}))})}goBack(){this.router.navigate(["/home"])}static{this.\u0275fac=function(r){return new(r||t)(Re(Ym),Re(Ew),Re(iT),Re(ig),Re(Bs),Re(sg),Re(Ad))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-edit-task"]],decls:54,vars:1,consts:[[1,"flex","justify-center"],[1,"card-fun","p-6","w-full","max-w-lg"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],["for","name",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","name","id","name",1,"input-fun","w-full"],["value","","disabled",""],["value","Tout le monde"],[3,"value"],["for","statut",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","statut","id","statut","required","",1,"input-fun","w-full"],["value","Nouveau"],["value","En cours"],["value","Fait"],["value","Bloque"],["value","Archive"],["for","urg",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","urg","id","urg","required","",1,"input-fun","w-full"],["value","Urgent"],["value","Relativement urgent"],["value","Pas urgent"],["for","title",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","id","title","placeholder","Ex. Mon titre...","required","",1,"input-fun","w-full"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","descriptif","rows","5","placeholder","D\xe9crivez la t\xe2che...",1,"input-fun","w-full","resize-y"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"px-4","py-2","rounded-xl","bg-red-50","text-red-500","hover:bg-red-100","transition-colors","font-medium","text-sm",3,"click"],["type","submit",1,"btn-gradient","px-6","py-2",3,"click"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1)(2,"h3",2),Y(3,"\u{1f4dd} Editer la Tache"),G(),j(4,"form",3)(5,"div")(6,"label",4),Y(7,"Tache pour"),G(),j(8,"select",5)(9,"option",6),Y(10,"Choisir..."),G(),j(11,"option",7),Y(12,"Tout le monde"),G(),sr(13,gEe,2,2,"option",8,Ja),G()(),j(15,"div")(16,"label",9),Y(17,"Statut"),G(),j(18,"select",10)(19,"option",11),Y(20,"Nouveau"),G(),j(21,"option",12),Y(22,"En cours"),G(),j(23,"option",13),Y(24,"Fait"),G(),j(25,"option",14),Y(26,"Bloque"),G(),j(27,"option",15),Y(28,"Archive"),G()()(),j(29,"div")(30,"label",16),Y(31,"Priorite"),G(),j(32,"select",17)(33,"option",18),Y(34,"Urgent !"),G(),j(35,"option",19),Y(36,"Relativement urgent"),G(),j(37,"option",20),Y(38,"Pas Urgent"),G()()(),j(39,"div")(40,"label",21),Y(41,"Titre"),G(),wt(42,"input",22),G(),j(43,"div")(44,"label",23),Y(45,"Descriptif"),G(),wt(46,"textarea",24),G(),j(47,"div",25)(48,"button",26),Ge("click",function(){return i.goBack()}),Y(49,"Retour"),G(),j(50,"button",27),Ge("click",function(){return i.onDelete(i.taskToEdit)}),Y(51,"Supprimer"),G(),j(52,"button",28),Ge("click",function(){return i.editTask()}),Y(53,"Modifier"),G()()()()()),2&r&&(le(4),gn("formGroup",i.editTaskForm),le(9),ar(i.allUsers))},dependencies:[oT,yw,bw,ww,Rc,Ag,Rd,uw,Wy,Gy,qy],encapsulation:2})}}return t})();const yEe=["previewImg"];function vEe(t,n){1&t&&(j(0,"span",15),Y(1,"Charge !"),G())}function bEe(t,n){if(1&t){const e=yn();j(0,"div",7)(1,"h3",8),Y(2,"\u270f\ufe0f Modifier le profil"),G(),j(3,"form",9),Ge("ngSubmit",function(){return He(e),Ze(xe().onSubmitProfileForm())}),j(4,"div",10),wt(5,"img",11),j(6,"label",12)(7,"span",13),Y(8,"Choisir une photo"),G(),j(9,"input",14),Ge("change",function(i){return He(e),Ze(xe().detectFiles(i))}),G()(),vt(10,vEe,2,0,"span",15),G(),j(11,"div")(12,"label",16),Y(13,"Prenom"),G(),wt(14,"input",17),G(),j(15,"div")(16,"label",18),Y(17,"Telephone"),G(),wt(18,"input",19),G(),j(19,"div")(20,"label",20),Y(21,"Email"),G(),wt(22,"input",21),G(),j(23,"div")(24,"label",22),Y(25,"Anniversaire"),G(),wt(26,"input",23),G(),j(27,"button",24),Y(28,"Enregistrer"),G()()(),j(29,"div",25)(30,"h3",8),Y(31,"\u{1f4c5} Google Calendar"),G(),j(32,"div",26),wt(33,"div",27),j(34,"span",28),Y(35,"Connecte automatiquement via votre compte Google"),G()()()}if(2&t){const e=xe();le(3),gn("formGroup",e.profileForm),le(2),gn("src",e.fileUrl,So),le(5),bt(e.fileUploaded?10:-1),le(17),gn("disabled",e.profileForm.invalid)}}let wEe=(()=>{class t{constructor(e,r,i){this.editProfileService=e,this._snackBar=r,this.formBuilder=i,this.user=null,this.fileIsUploading=!1,this.fileUploaded=!1}ngOnInit(){this.userSubscription=this.editProfileService.getUserData().subscribe(e=>{this.user=e,this.user&&this.initForm(this.user)},()=>{this._snackBar.open("Erreur lors du chargement du profil","",{duration:5e3})})}initForm(e){this.profileForm=this.formBuilder.group({emailControl:[{value:e?.email||"",disabled:!0},[Pc.required,Pc.email]],displayNameControl:[e?.displayName||""],phoneNumberControl:[e?.phoneNumber||""],photoURLControl:[""],dateBirthControl:[e?.dateBirth?e.dateBirth.substring(0,10):""]}),this.fileUrl=this.user?.photoURL||"https://i.pinimg.com/originals/2f/15/f2/2f15f2e8c688b3120d3d26467b06330c.jpg"}loadFile(e){this.fileIsUploading=!0,this.editProfileService.deleteOldAvatar(this.user?.photoURL||"").then(()=>this.editProfileService.uploadFile(e)).then(i=>{this.fileUrl=i,this.profileForm.get("photoURLControl")?.setValue(""),this.fileIsUploading=!1,this.fileUploaded=!0})}detectFiles(e){const r=e.target;r.files?.[0]&&this.loadFile(r.files[0])}onSubmitProfileForm(){const e=this.user?.uid;if(!e)return;const r=this.profileForm.value;this.editProfileService.updateUserData(e,{displayName:r.displayNameControl||"",phoneNumber:r.phoneNumberControl||"",photoURL:this.fileUrl,dateBirth:r.dateBirthControl||""}).then(()=>this._snackBar.open("Profil mis a jour","avec succes !!",{duration:5e3})).catch(()=>this._snackBar.open("Erreur lors de la mise a jour","",{duration:5e3}))}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Re(UD),Re(ig),Re(iT))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-user-profile"]],viewQuery:function(r,i){if(1&r&&op(yEe,5),2&r){let o;hd(o=fd())&&(i.previewImg=o.first)}},decls:10,vars:4,consts:[[1,"card-fun","overflow-hidden","mb-6"],[1,"h-24","bg-gradient-to-r","from-family-pink","via-family-coral","to-family-orange"],[1,"px-6","pb-6","-mt-10","flex","items-end","gap-4"],["alt","Photo de profil","referrerpolicy","no-referrer",1,"h-20","w-20","rounded-full","object-cover","ring-4","ring-white","shadow-lg",3,"src"],[1,"pb-1"],[1,"font-display","text-xl","font-bold","text-gray-700"],[1,"text-sm","text-gray-400"],[1,"card-fun","p-6","max-w-lg","mx-auto"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4"],["alt","Avatar","referrerpolicy","no-referrer",1,"h-14","w-14","rounded-full","object-cover","ring-2","ring-family-pink/30",3,"src"],[1,"block"],[1,"sr-only"],["formControlName","photoURLControl","type","file","accept","image/*",1,"block","w-full","text-sm","text-gray-500","file:mr-3","file:py-2","file:px-4","file:rounded-full","file:border-0","file:text-sm","file:font-semibold","file:bg-family-pink/10","file:text-family-pink","hover:file:bg-family-pink/20","transition-colors",3,"change"],[1,"text-family-green","text-sm","font-medium"],["for","prenom",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","text","id","prenom","formControlName","displayNameControl","placeholder","Prenom",1,"input-fun","w-full"],["for","phone",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","tel","id","phone","formControlName","phoneNumberControl","placeholder","Votre numero",1,"input-fun","w-full"],["for","email",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","email","id","email","formControlName","emailControl","placeholder","Votre email",1,"input-fun","w-full"],["for","dateBirth",1,"block","mb-1","text-sm","font-medium","text-gray-600"],["type","date","id","dateBirth","formControlName","dateBirthControl",1,"input-fun","w-full"],["type","submit",1,"btn-gradient","w-full",3,"disabled"],[1,"card-fun","p-6","max-w-lg","mx-auto","mt-6"],[1,"flex","items-center","gap-3"],[1,"w-3","h-3","rounded-full","bg-family-green"],[1,"text-sm","text-gray-600"]],template:function(r,i){1&r&&(j(0,"div",0),wt(1,"div",1),j(2,"div",2),wt(3,"img",3),j(4,"div",4)(5,"h2",5),Y(6),G(),j(7,"p",6),Y(8),G()()()(),vt(9,bEe,36,4)),2&r&&(le(3),gn("src",i.fileUrl,So),le(3),Lt((null==i.user?null:i.user.displayName)||"Mon Profil"),le(2),Lt(null==i.user?null:i.user.email),le(),bt(i.profileForm?9:-1))},dependencies:[oT,yw,Rc,Rd,uw,Gy,qy],encapsulation:2})}}return t})();const Jh={production:!0,googleCalendar:{apiKey:"AIzaSyB4DkZu3SqYLJCrxFGS7DybGGKUBrlJqaI",clientId:"728695329604-70417p57psoofhqlsio6qjv705a0ieqf.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest","https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scopes:"https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/drive",familyCalendarId:"family12498967542838679084@group.calendar.google.com",familyDriveFolderId:"1yWZtCJZGlt2wfqmkcrJThLuY8m-aI0TW"}},xEe=(t,n)=>n.id;function EEe(t,n){if(1&t&&(j(0,"option",16),Y(1),G()),2&t){const e=n.$implicit;gn("value",e.id),le(),Lt(e.summary)}}function CEe(t,n){if(1&t&&(j(0,"div")(1,"label",3),Y(2,"Agenda"),G(),j(3,"select",15),sr(4,EEe,2,2,"option",16,xEe),G()()),2&t){const e=xe();le(4),ar(e.data.calendars)}}function DEe(t,n){1&t&&(j(0,"div",9)(1,"div")(2,"label",3),Y(3,"Heure debut"),G(),wt(4,"input",17),G(),j(5,"div")(6,"label",3),Y(7,"Heure fin"),G(),wt(8,"input",18),G()())}let TEe=(()=>{class t{constructor(e,r,i){this.fb=e,this.dialogRef=r,this.data=i;const o=this.formatLocalDate(i.date),a=Jh.googleCalendar.familyCalendarId,c=i.calendars?.find(f=>f.id===a)?.id||i.calendars?.find(f=>f.primary)?.id||"primary";this.eventForm=this.fb.group({title:["",Pc.required],description:[""],calendarId:[c],allDay:[!0],startDate:[o,Pc.required],endDate:[o,Pc.required],startTime:["09:00"],endTime:["10:00"]})}onCancel(){this.dialogRef.close()}onSubmit(){if(this.eventForm.invalid)return;const e=this.eventForm.value;let r=e.endDate;if(e.allDay){const o=new Date(e.endDate+"T00:00:00");o.setDate(o.getDate()+1),r=this.formatLocalDate(o)}this.dialogRef.close({id:"",title:e.title,description:e.description,allDay:e.allDay,calendarId:e.calendarId||"primary",startDate:e.allDay?e.startDate:`${e.startDate}T${e.startTime}:00`,endDate:e.allDay?r:`${e.endDate}T${e.endTime}:00`})}formatLocalDate(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}static{this.\u0275fac=function(r){return new(r||t)(Re(iT),Re(og),Re(DC))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-add-event-dialog"]],decls:32,vars:4,consts:[[1,"p-6"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-4"],[1,"space-y-4",3,"formGroup"],[1,"block","mb-1","text-sm","font-medium","text-gray-600"],["formControlName","title","placeholder","Ex. Reunion famille...","required","",1,"input-fun","w-full"],["formControlName","description","rows","3","placeholder","Details...",1,"input-fun","w-full","resize-y"],[1,"flex","items-center","gap-2","mb-2"],["type","checkbox","formControlName","allDay","id","allDay",1,"rounded"],["for","allDay",1,"text-sm","text-gray-600"],[1,"grid","grid-cols-2","gap-3"],["formControlName","startDate","type","date",1,"input-fun","w-full"],["formControlName","endDate","type","date",1,"input-fun","w-full"],[1,"flex","justify-end","gap-3","pt-2"],["type","button",1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],["type","button",1,"btn-gradient","px-6","py-2",3,"click","disabled"],["formControlName","calendarId",1,"input-fun","w-full"],[3,"value"],["formControlName","startTime","type","time",1,"input-fun","w-full"],["formControlName","endTime","type","time",1,"input-fun","w-full"]],template:function(r,i){if(1&r&&(j(0,"div",0)(1,"h2",1),Y(2,"Nouvel evenement"),G(),j(3,"form",2)(4,"div")(5,"label",3),Y(6,"Titre"),G(),wt(7,"input",4),G(),vt(8,CEe,6,0,"div"),j(9,"div")(10,"label",3),Y(11,"Description"),G(),wt(12,"textarea",5),G(),j(13,"div",6),wt(14,"input",7),j(15,"label",8),Y(16,"Toute la journee"),G()(),j(17,"div",9)(18,"div")(19,"label",3),Y(20,"Debut"),G(),wt(21,"input",10),G(),j(22,"div")(23,"label",3),Y(24,"Fin"),G(),wt(25,"input",11),G()(),vt(26,DEe,9,0,"div",9),j(27,"div",12)(28,"button",13),Ge("click",function(){return i.onCancel()}),Y(29," Annuler "),G(),j(30,"button",14),Ge("click",function(){return i.onSubmit()}),Y(31," Creer "),G()()()()),2&r){let o;le(3),gn("formGroup",i.eventForm),le(5),bt(i.data.calendars&&i.data.calendars.length>1?8:-1),le(18),bt(null!=(o=i.eventForm.get("allDay"))&&o.value?-1:26),le(4),gn("disabled",i.eventForm.invalid)}},dependencies:[oT,yw,bw,ww,Rc,IN,Ag,Rd,uw,Wy,Gy,qy],encapsulation:2})}}return t})();function SEe(t,n){if(1&t&&(Zt(0,"div",5)(1,"span",6),Y(2,"\u{1f4c5}"),qt(),Zt(3,"span"),Y(4),qt()()),2&t){const e=xe();le(4),Lt(e.data.event.calendarName)}}function IEe(t,n){if(1&t&&(Zt(0,"span"),Y(1),X_(2,"date"),qt()),2&t){const e=xe();le(),ci("Toute la journee \xb7 ",Q_(2,1,e.data.event.startDate,"EEEE d MMMM yyyy","","fr"))}}function kEe(t,n){if(1&t&&(Zt(0,"span"),Y(1),X_(2,"date"),X_(3,"date"),qt()),2&t){const e=xe();le(),Ch("",Q_(2,2,e.data.event.startDate,"EEEE d MMMM yyyy, HH:mm","","fr")," \u2014 ",Q_(3,7,e.data.event.endDate,"HH:mm","","fr"))}}function AEe(t,n){if(1&t&&(Zt(0,"div",7)(1,"span",11),Y(2,"\u{1f4cd}"),qt(),Zt(3,"span"),Y(4),qt()()),2&t){const e=xe();le(4),Lt(e.data.event.location)}}function MEe(t,n){if(1&t&&(Zt(0,"div",5)(1,"span",6),Y(2,"\u{1f464}"),qt(),Zt(3,"span"),Y(4,"Cree par : "),Zt(5,"span",12),Y(6),qt()()()),2&t){const e=xe();le(6),Lt(e.data.event.creatorName)}}function REe(t,n){if(1&t&&(Zt(0,"div",8),Y(1),qt()),2&t){const e=xe();le(),Lt(e.data.event.description)}}let PEe=(()=>{class t{constructor(e,r){this.dialogRef=e,this.data=r}close(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||t)(Re(og),Re(DC))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-event-detail-dialog"]],decls:18,vars:8,consts:[[1,"p-6"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-3","h-3","rounded-full","shrink-0"],[1,"font-display","text-lg","font-bold","text-gray-700"],[1,"space-y-3","text-sm"],[1,"flex","items-center","gap-2","text-gray-500"],[1,"w-5","text-center"],[1,"flex","items-start","gap-2","text-gray-500"],[1,"mt-3","p-3","bg-gray-50","rounded-xl","text-gray-600","text-sm","whitespace-pre-wrap"],[1,"flex","justify-end","pt-4"],[1,"px-4","py-2","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","font-medium","text-sm",3,"click"],[1,"w-5","text-center","shrink-0"],[1,"font-medium","text-gray-600"]],template:function(r,i){1&r&&(Zt(0,"div",0)(1,"div",1),dd(2,"div",2),Zt(3,"h2",3),Y(4),qt()(),Zt(5,"div",4),vt(6,SEe,5,1,"div",5),Zt(7,"div",5)(8,"span",6),Y(9,"\u{1f550}"),qt(),vt(10,IEe,3,6,"span")(11,kEe,4,12,"span"),qt(),vt(12,AEe,5,1,"div",7),vt(13,MEe,7,1,"div",5),vt(14,REe,2,1,"div",8),qt(),Zt(15,"div",9)(16,"button",10),ma("click",function(){return i.close()}),Y(17," Fermer "),qt()()()),2&r&&(le(2),zm("background-color",i.data.event.color||"#4285f4"),le(2),Lt(i.data.event.title),le(2),bt(i.data.event.calendarName?6:-1),le(4),bt(i.data.event.allDay?10:11),le(2),bt(i.data.event.location?12:-1),le(),bt(i.data.event.creatorName?13:-1),le(),bt(i.data.event.description?14:-1))},dependencies:[Rh,FE],encapsulation:2})}}return t})(),hT=(()=>{class t{constructor(e){this.authService=e,this.gapiLoaded=!1,this.tokenClient=null,this.accessToken=null,this.googleEmail=null,this.signInResolve=null,this.connectionChanged=new J,this.authService.googleToken$.subscribe(r=>{this.setToken(r)}),WC(ho,r=>{r&&!this.accessToken&&setTimeout(()=>{this.accessToken||this.requestTokenSilently()},1500)})}requestTokenSilently(){var e=this;return fe(function*(){try{yield e.loadGapi(),yield e.initTokenClient(),e.tokenClient&&e.tokenClient.requestAccessToken({prompt:""})}catch{}})()}setToken(e){this.accessToken=e,this.loadGapi().then(()=>{gapi.client.setToken({access_token:e})}).catch(()=>{}),this.fetchGoogleEmail(),this.saveConnectionStatus(!0),this.connectionChanged.next(!0)}loadGapi(){var e=this;return this.gapiLoaded?Promise.resolve():new Promise((r,i)=>{const o=()=>{typeof gapi>"u"?setTimeout(o,200):gapi.load("client",fe(function*(){try{yield gapi.client.init({discoveryDocs:Jh.googleCalendar.discoveryDocs}),e.gapiLoaded=!0,r()}catch(a){i(a)}}))};o()})}initTokenClient(){return new Promise(e=>{const r=()=>{typeof google>"u"||!google.accounts?.oauth2?setTimeout(r,200):(this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:Jh.googleCalendar.clientId,scope:Jh.googleCalendar.scopes,callback:i=>{i.error?this.signInResolve&&(this.signInResolve(!1),this.signInResolve=null):(this.accessToken=i.access_token||null,this.accessToken&&(gapi.client.setToken({access_token:this.accessToken}),this.fetchGoogleEmail()),this.saveConnectionStatus(!!this.accessToken),this.connectionChanged.next(!!this.accessToken),this.signInResolve&&(this.signInResolve(!!this.accessToken),this.signInResolve=null))}}),e())};r()})}signIn(){return new Promise(e=>{this.tokenClient?(this.signInResolve=e,this.tokenClient.requestAccessToken({prompt:"consent"})):e(!1)})}signOut(){if(this.accessToken){try{google.accounts.oauth2.revoke(this.accessToken)}catch{}try{gapi.client.setToken(null)}catch{}this.accessToken=null,this.googleEmail=null,this.saveConnectionStatus(!1),this.connectionChanged.next(!1)}}isConnected(){return!!this.accessToken}getAccessToken(){return this.accessToken}getGoogleEmail(){return this.googleEmail}fetchGoogleEmail(){var e=this;return fe(function*(){try{const i=yield(yield fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e.accessToken}`}})).json();e.googleEmail=i.email||null}catch{e.googleEmail=null}})()}saveConnectionStatus(e){const r=ho.currentUser?.uid;r&&Dg(Ir(Lr,`/users/${r}`),{googleCalendar:{connected:e,calendarId:"primary"}})}static{this.\u0275fac=function(r){return new(r||t)(Dt(Ad))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),NEe=(()=>{class t{constructor(e,r){this.googleAuth=e,this.authService=r,this.events=[],this.eventsSubject=new J,this.calendars=[],this.calendarsSubject=new J}emitEvents(){this.eventsSubject.next(this.events)}ensureToken(){const e=this.googleAuth.getAccessToken();e&&gapi.client.setToken({access_token:e})}getCalendars(){var e=this;return fe(function*(){if(!e.googleAuth.isConnected())return[];try{yield e.googleAuth.loadGapi(),e.ensureToken();const r=yield gapi.client.calendar.calendarList.list();console.log("Calendar list response:",r.result.items?.length,"calendars");const i=(r.result.items||[]).filter(a=>{const c=a.id||"";return!(c.includes("#weeknum")||c.includes("#contacts")||c.includes("#holiday")||c.includes("addressbook"))});e.calendars=i.map(a=>({id:a.id,summary:a.summary||a.id,backgroundColor:a.backgroundColor||"#4285f4",primary:!!a.primary}));const o=Jh.googleCalendar.familyCalendarId;return o&&!e.calendars.find(a=>a.id===o)&&e.calendars.push({id:o,summary:"Famille",backgroundColor:"#e67c73"}),e.calendarsSubject.next(e.calendars),e.calendars}catch{return[]}})()}getEvents(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return[];try{yield i.googleAuth.loadGapi(),i.ensureToken(),0===i.calendars.length&&(yield i.getCalendars());const o=ho.currentUser,a=i.calendars.map(function(){var _=fe(function*(x){try{return((yield gapi.client.calendar.events.list({calendarId:x.id,timeMin:e.toISOString(),timeMax:r.toISOString(),showDeleted:!1,singleEvents:!0,orderBy:"startTime"})).result.items||[]).map(A=>({id:A.id,title:A.summary||"(Sans titre)",description:A.description||"",startDate:A.start?.dateTime||A.start?.date||"",endDate:A.end?.dateTime||A.end?.date||"",allDay:!!A.start?.date,color:x.backgroundColor,calendarId:x.id,calendarName:x.summary,location:A.location||"",creatorUid:o?.uid||"",creatorName:A.creator?.displayName||A.creator?.email||""}))}catch(D){return console.error("Error fetching events from",x.id,D),[]}});return function(x){return _.apply(this,arguments)}}()),c=yield Promise.all(a),f=[];return c.forEach(_=>f.push(..._)),console.log("Total events fetched:",f.length,"from",i.calendars.length,"calendars"),f.sort((_,x)=>_.startDate.localeCompare(x.startDate)),i.events=f,i.emitEvents(),i.events}catch{return[]}})()}createEvent(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=e.calendarId||Jh.googleCalendar.familyCalendarId||"primary",o={summary:e.title,description:e.description||""};e.allDay?(o.start={date:e.startDate.substring(0,10)},o.end={date:e.endDate.substring(0,10)}):(o.start={dateTime:e.startDate},o.end={dateTime:e.endDate});const a=yield gapi.client.calendar.events.insert({calendarId:i,resource:o}),c=r.calendars.find(_=>_.id===i);return{id:a.result.id,title:a.result.summary,description:a.result.description||"",startDate:a.result.start?.dateTime||a.result.start?.date||"",endDate:a.result.end?.dateTime||a.result.end?.date||"",allDay:!!a.result.start?.date,calendarId:i,calendarName:c?.summary||i,color:c?.backgroundColor}}catch{return null}})()}deleteEvent(e){var r=this;return fe(function*(i,o="primary"){if(r.googleAuth.isConnected())try{yield r.googleAuth.loadGapi(),r.ensureToken(),yield gapi.client.calendar.events.delete({calendarId:o,eventId:i})}catch{}}).apply(this,arguments)}static{this.\u0275fac=function(r){return new(r||t)(Dt(hT),Dt(Ad))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const cO=(t,n)=>n.id;function OEe(t,n){if(1&t){const e=yn();Zt(0,"div",4)(1,"div",5),Y(2,"\u{1f4c5}"),qt(),Zt(3,"h2",6),Y(4,"Chargement du calendrier..."),qt(),Zt(5,"p",7),Y(6,"Connexion a Google Calendar en cours"),qt(),Zt(7,"button",8),ma("click",function(){return He(e),Ze(xe().connectGoogle())}),Y(8," Reconnecter Google Calendar "),qt()()}}function LEe(t,n){if(1&t&&(Zt(0,"div",24),dd(1,"div",25),Zt(2,"span",26),Y(3),qt()()),2&t){const e=n.$implicit;le(),zm("background-color",e.backgroundColor),le(2),Lt(e.summary)}}function FEe(t,n){if(1&t&&(Zt(0,"div",17)(1,"div",23),sr(2,LEe,4,3,"div",24,cO),qt()()),2&t){const e=xe(2);le(2),ar(e.calendars)}}function BEe(t,n){if(1&t&&(Zt(0,"div",20),Y(1),qt()),2&t){const e=n.$implicit;le(),Lt(e)}}function VEe(t,n){if(1&t&&(Zt(0,"span",32),Y(1),qt()),2&t){const e=xe(2).$implicit,r=xe(3);le(),ci("S",r.getWeekNumber(e))}}function zEe(t,n){if(1&t){const e=yn();Zt(0,"div",34),ma("click",function(i){const o=He(e).$implicit;return xe(5).viewEvent(o),Ze(i.stopPropagation())}),Y(1),qt()}if(2&t){const e=n.$implicit;zm("background-color",e.color||"#4285f4"),lb("title",e.calendarName?e.calendarName+" \u2014 "+e.title:e.title),le(),ci(" ",e.title," ")}}function UEe(t,n){if(1&t){const e=yn();Zt(0,"div",29),ma("click",function(){He(e);const i=xe().$implicit;return Ze(xe(3).openAddEvent(i))}),Zt(1,"div",30)(2,"span",31),Y(3),qt(),vt(4,VEe,2,1,"span",32),qt(),sr(5,zEe,2,4,"div",33,cO),qt()}if(2&t){const e=xe().$implicit,r=xe(3);Ls("bg-gradient-to-br",r.isToday(e))("from-family-pink/10",r.isToday(e))("to-family-orange/10",r.isToday(e))("border-family-pink",r.isToday(e))("border-gray-100",!r.isToday(e)),le(2),Ls("text-family-pink",r.isToday(e))("text-gray-600",!r.isToday(e)),le(),ci(" ",e.getDate()," "),le(),bt(r.isMonday(e)?4:-1),le(),ar(r.getEventsForDay(e))}}function jEe(t,n){1&t&&dd(0,"div",28)}function HEe(t,n){1&t&&vt(0,UEe,7,16,"div",27)(1,jEe,1,0,"div",28),2&t&&bt(n.$implicit?0:1)}function $Ee(t,n){if(1&t&&(Zt(0,"div",21),sr(1,HEe,2,1,null,null,DI),qt()),2&t){const e=n.$implicit;le(),ar(e)}}function qEe(t,n){if(1&t&&(Zt(0,"span",43),Y(1),qt(),Y(2," \xb7 ")),2&t){const e=xe().$implicit;le(),Lt(e.calendarName)}}function GEe(t,n){1&t&&Y(0),2&t&&ci(" ",xe().$implicit.creatorName," \xb7 ")}function WEe(t,n){1&t&&Y(0," Toute la journee ")}function KEe(t,n){1&t&&(Y(0),X_(1,"date")),2&t&&ci(" ",Q_(1,1,xe().$implicit.startDate,"d MMM, HH:mm","","fr")," ")}function ZEe(t,n){if(1&t){const e=yn();Zt(0,"button",44),ma("click",function(i){He(e);const o=xe().$implicit;return xe(3).deleteEvent(o),Ze(i.stopPropagation())}),Y(1," Supprimer "),qt()}}function YEe(t,n){if(1&t){const e=yn();Zt(0,"div",37),ma("click",function(){const i=He(e).$implicit;return Ze(xe(3).viewEvent(i))}),Zt(1,"div",38),dd(2,"div",39),Zt(3,"div")(4,"div",40),Y(5),qt(),Zt(6,"div",41),vt(7,qEe,3,1),vt(8,GEe,1,1),vt(9,WEe,1,0)(10,KEe,2,6),qt()()(),vt(11,ZEe,2,0,"button",42),qt()}if(2&t){const e=n.$implicit,r=xe(3);le(2),zm("background-color",e.color||"#4285f4"),le(3),Lt(e.title),le(2),bt(e.calendarName?7:-1),le(),bt(e.creatorName?8:-1),le(),bt(e.allDay?9:10),le(2),bt(r.canDelete(e)?11:-1)}}function XEe(t,n){if(1&t&&(Zt(0,"div",22)(1,"h3",35),Y(2,"Prochains evenements"),qt(),sr(3,YEe,12,7,"div",36,cO),qt()),2&t){const e=xe(2);le(3),ar(e.events)}}function QEe(t,n){if(1&t){const e=yn();Zt(0,"div",9)(1,"div",10)(2,"div",11)(3,"button",12),ma("click",function(){return He(e),Ze(xe().previousMonth())}),Y(4," < "),qt(),Zt(5,"h2",13),Y(6),qt(),Zt(7,"button",12),ma("click",function(){return He(e),Ze(xe().nextMonth())}),Y(8," > "),qt(),Zt(9,"button",14),ma("click",function(){return He(e),Ze(xe().goToday())}),Y(10," Aujourd'hui "),qt()(),Zt(11,"div",15)(12,"button",16),ma("click",function(){return He(e),Ze(xe().openAddEvent())}),Y(13," + Nouvel evenement "),qt()()()(),vt(14,FEe,4,0,"div",17),Zt(15,"div",18)(16,"div",19),sr(17,BEe,2,1,"div",20,Ja),qt(),sr(19,$Ee,3,0,"div",21,DI),qt(),vt(21,XEe,5,0,"div",22)}if(2&t){const e=xe();le(6),ci(" ",e.monthLabel," "),le(8),bt(e.calendars.length>1?14:-1),le(3),ar(e.weekDays),le(2),ar(e.daysInMonth),le(2),bt(e.events.length>0?21:-1)}}let JEe=(()=>{class t{constructor(e,r,i,o){this.googleAuth=e,this.calendarService=r,this.dialog=i,this.snackBar=o,this.isConnected=!1,this.currentDate=new Date,this.viewMode="month",this.events=[],this.calendars=[],this.daysInMonth=[],this.weekDays=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]}ngOnInit(){this.eventsSubscription=this.calendarService.eventsSubject.subscribe(e=>this.events=e.filter(r=>!this.isWeekNumberEvent(r))),this.calendarsSubscription=this.calendarService.calendarsSubject.subscribe(e=>this.calendars=e),this.connectionSubscription=this.googleAuth.connectionChanged.subscribe(e=>{this.isConnected=e,e&&this.loadEvents()}),this.initGoogle(),this.buildCalendarGrid()}initGoogle(){var e=this;return fe(function*(){try{yield e.googleAuth.loadGapi(),yield e.googleAuth.initTokenClient();const r=e.googleAuth.getAccessToken();r&&window.gapi.client.setToken({access_token:r}),e.isConnected=e.googleAuth.isConnected(),e.isConnected&&e.loadEvents()}catch{}})()}connectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&(this.loadEvents(),this.snackBar.open("Google Calendar connecte !","",{duration:3e3}))})}disconnectGoogle(){this.googleAuth.signOut(),this.isConnected=!1,this.events=[],this.snackBar.open("Google Calendar deconnecte","",{duration:3e3})}loadEvents(){const{start:e,end:r}=this.getMonthRange();this.calendarService.getEvents(e,r)}getMonthRange(){const e=this.currentDate.getFullYear(),r=this.currentDate.getMonth();return{start:new Date(e,r,1),end:new Date(e,r+1,0,23,59,59)}}buildCalendarGrid(){const e=this.currentDate.getFullYear(),r=this.currentDate.getMonth(),i=new Date(e,r,1),o=new Date(e,r+1,0);let a=i.getDay()-1;a<0&&(a=6);const c=[];for(let f=0;f<a;f++)c.push(null);for(let f=1;f<=o.getDate();f++)c.push(new Date(e,r,f));for(;c.length%7!=0;)c.push(null);this.daysInMonth=[];for(let f=0;f<c.length;f+=7)this.daysInMonth.push(c.slice(f,f+7))}isWeekNumberEvent(e){const r=e.title.trim();return/^(S|W|Wk|Semaine|Week)\s?\d{1,2}$/.test(r)||(e.calendarId?.includes("#weeknum")??!1)}getEventsForDay(e){if(!e)return[];const r=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;return this.events.filter(i=>{let o;if(i.allDay)o=i.startDate.substring(0,10);else{const a=new Date(i.startDate);o=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`}return o===r&&!this.isWeekNumberEvent(i)})}getWeekNumber(e){if(!e)return 0;const r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));const i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}isMonday(e){return!!e&&1===e.getDay()}isToday(e){if(!e)return!1;const r=new Date;return e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear()}previousMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}goToday(){this.currentDate=new Date,this.buildCalendarGrid(),this.isConnected&&this.loadEvents()}get monthLabel(){return this.currentDate.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}openAddEvent(e){this.dialog.open(TEe,{data:{date:e||new Date,calendars:this.calendars},width:"400px"}).afterClosed().subscribe(i=>{i&&this.calendarService.createEvent(i).then(o=>{o&&(this.loadEvents(),this.snackBar.open("Evenement cree !","",{duration:3e3}))})})}viewEvent(e){this.dialog.open(PEe,{data:{event:e},width:"400px"})}canDelete(e){const r=this.googleAuth.getGoogleEmail();return!!r&&e.creatorName===r}deleteEvent(e){this.calendarService.deleteEvent(e.id,e.calendarId||"primary").then(()=>{this.loadEvents(),this.snackBar.open("Evenement supprime","",{duration:3e3})})}ngOnDestroy(){this.eventsSubscription&&this.eventsSubscription.unsubscribe(),this.calendarsSubscription&&this.calendarsSubscription.unsubscribe(),this.connectionSubscription&&this.connectionSubscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Re(hT),Re(NEe),Re(sg),Re(ig))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-calendar"]],decls:8,vars:2,consts:[[1,"max-w-4xl","mx-auto"],[1,"card-fun","bg-gradient-to-r","from-family-sky","via-family-purple","to-family-pink","p-6","mb-6","text-white"],[1,"font-display","text-2xl","font-bold"],[1,"mt-1","opacity-90"],[1,"card-fun","p-8","text-center"],[1,"text-5xl","mb-4"],[1,"font-display","text-lg","font-bold","text-gray-700","mb-2"],[1,"text-gray-500","mb-6"],[1,"btn-gradient","px-6","py-3","text-lg",3,"click"],[1,"card-fun","p-4","mb-4"],[1,"flex","items-center","justify-between","flex-wrap","gap-3"],[1,"flex","items-center","gap-2"],[1,"p-2","rounded-xl","hover:bg-warm-50","transition-colors","text-gray-600",3,"click"],[1,"font-display","font-bold","text-gray-700","text-lg","capitalize","min-w-[180px]","text-center"],[1,"ml-2","px-3","py-1","rounded-xl","border","border-gray-200","text-sm","text-gray-600","hover:bg-warm-50","transition-colors",3,"click"],[1,"flex","gap-2"],[1,"btn-gradient","px-4","py-2","text-sm",3,"click"],[1,"card-fun","p-3","mb-4"],[1,"card-fun","p-4"],[1,"grid","grid-cols-7","gap-1","mb-2"],[1,"text-center","text-xs","font-semibold","text-gray-500","py-2"],[1,"grid","grid-cols-7","gap-1","mb-1"],[1,"card-fun","p-4","mt-4"],[1,"flex","flex-wrap","gap-3"],[1,"flex","items-center","gap-1.5"],[1,"w-3","h-3","rounded-full"],[1,"text-xs","text-gray-600","font-medium"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"bg-gradient-to-br","from-family-pink/10","to-family-orange/10","border-family-pink","border-gray-100"],[1,"min-h-20","p-1","rounded-xl","bg-gray-50/50"],[1,"min-h-20","p-1","rounded-xl","border","cursor-pointer","transition-all","hover:shadow-md",3,"click"],[1,"flex","items-center","justify-between","mb-1"],[1,"text-xs","font-semibold"],[1,"text-[9px]","text-gray-300","font-medium"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"background-color","title"],[1,"text-[10px]","rounded","px-1","py-0.5","mb-0.5","truncate","text-white","cursor-pointer","hover:opacity-80","transition-opacity",3,"click","title"],[1,"font-display","font-bold","text-gray-700","mb-3"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer"],[1,"flex","items-center","justify-between","p-3","rounded-xl","hover:bg-warm-50","transition-colors","mb-1","cursor-pointer",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-2","h-2","rounded-full"],[1,"font-medium","text-gray-700","text-sm"],[1,"text-xs","text-gray-400"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors"],[1,"font-medium"],[1,"text-red-300","hover:text-red-500","text-sm","transition-colors",3,"click"]],template:function(r,i){1&r&&(Zt(0,"div",0)(1,"div",1)(2,"h1",2),Y(3,"Calendrier"),qt(),Zt(4,"p",3),Y(5,"Vos evenements Google Calendar"),qt()(),vt(6,OEe,9,0,"div",4),vt(7,QEe,22,3),qt()),2&r&&(le(6),bt(i.isConnected?-1:6),le(),bt(i.isConnected?7:-1))},dependencies:[Rh,FE],encapsulation:2})}}return t})(),eCe=(()=>{class t{constructor(e){this.googleAuth=e,this.files=[],this.filesSubject=new J,this.breadcrumb=[],this.breadcrumbSubject=new J,this.rootFolderId=null,this.currentFolderId=null}ensureToken(){const e=this.googleAuth.getAccessToken();e&&gapi.client.setToken({access_token:e})}ensureRootFolder(){var e=this;return fe(function*(){if(e.rootFolderId)return e.rootFolderId;if(!e.googleAuth.isConnected())throw new Error("Not connected");const r=Jh.googleCalendar.familyDriveFolderId;if(r)return e.rootFolderId=r,e.rootFolderId;yield e.googleAuth.loadGapi(),e.ensureToken();const o=(yield gapi.client.drive.files.list({q:"name='FamilyApp' and mimeType='application/vnd.google-apps.folder' and trashed=false",fields:"files(id,name)",spaces:"drive"})).result.files||[];if(o.length>0)return e.rootFolderId=o[0].id,e.rootFolderId;const a=yield gapi.client.drive.files.create({resource:{name:"FamilyApp",mimeType:"application/vnd.google-apps.folder"},fields:"id"});return e.rootFolderId=a.result.id,e.rootFolderId})()}listFiles(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return[];try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),o=e||i;r.currentFolderId=o;const a=yield gapi.client.drive.files.list({q:`'${o}' in parents and trashed=false`,fields:"files(id,name,mimeType,webViewLink,iconLink,thumbnailLink,createdTime,properties)",orderBy:"folder,name",pageSize:100,includeItemsFromAllDrives:!0,supportsAllDrives:!0,corpora:"allDrives"});return r.files=(a.result.files||[]).map(c=>({id:c.id,name:c.name,mimeType:c.mimeType,webViewLink:c.webViewLink||"",iconLink:c.iconLink||"",thumbnailLink:c.thumbnailLink||"",createdTime:c.createdTime||"",isFolder:"application/vnd.google-apps.folder"===c.mimeType,uploadedBy:c.properties?.uploadedBy||"",uploadedByName:c.properties?.uploadedByName||""})),r.filesSubject.next(r.files),r.files}catch{return[]}})()}navigateToFolder(e,r){var i=this;return fe(function*(){i.breadcrumb.push({id:e,name:r}),i.breadcrumbSubject.next(i.breadcrumb),yield i.listFiles(e)})()}navigateToBreadcrumb(e){var r=this;return fe(function*(){if(e<0)r.breadcrumb=[],r.breadcrumbSubject.next(r.breadcrumb),yield r.listFiles();else{const i=r.breadcrumb[e];r.breadcrumb=r.breadcrumb.slice(0,e+1),r.breadcrumbSubject.next(r.breadcrumb),yield r.listFiles(i.id)}})()}navigateUp(){var e=this;return fe(function*(){if(0===e.breadcrumb.length)return;e.breadcrumb.pop(),e.breadcrumbSubject.next(e.breadcrumb);const r=e.breadcrumb.length>0?e.breadcrumb[e.breadcrumb.length-1].id:void 0;yield e.listFiles(r)})()}createFolder(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),o=r.currentFolderId||i,a=ho.currentUser,c=yield gapi.client.drive.files.create({resource:{name:e,mimeType:"application/vnd.google-apps.folder",parents:[o],properties:{uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}},fields:"id,name,mimeType,createdTime"});return{id:c.result.id,name:c.result.name,mimeType:c.result.mimeType,webViewLink:"",iconLink:"",createdTime:c.result.createdTime||"",isFolder:!0,uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}}catch{return null}})()}renameFile(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return!1;try{return yield i.googleAuth.loadGapi(),i.ensureToken(),yield gapi.client.drive.files.update({fileId:e,resource:{name:r}}),!0}catch{return!1}})()}uploadFile(e){var r=this;return fe(function*(){if(!r.googleAuth.isConnected())return null;try{yield r.googleAuth.loadGapi(),r.ensureToken();const i=yield r.ensureRootFolder(),a=ho.currentUser,c={name:e.name,parents:[r.currentFolderId||i],properties:{uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}},f=r.googleAuth.getAccessToken(),_=new FormData;_.append("metadata",new Blob([JSON.stringify(c)],{type:"application/json"})),_.append("file",e);const D=yield(yield fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,mimeType,webViewLink,iconLink,thumbnailLink,createdTime,properties",{method:"POST",headers:{Authorization:`Bearer ${f}`},body:_})).json();return{id:D.id,name:D.name,mimeType:D.mimeType,webViewLink:D.webViewLink||"",iconLink:D.iconLink||"",thumbnailLink:D.thumbnailLink||"",createdTime:D.createdTime||"",isFolder:!1,uploadedBy:a?.uid||"",uploadedByName:a?.displayName||""}}catch{return null}})()}deleteFile(e){var r=this;return fe(function*(){if(r.googleAuth.isConnected())try{yield r.googleAuth.loadGapi(),r.ensureToken(),yield gapi.client.drive.files.delete({fileId:e,supportsAllDrives:!0})}catch{}})()}moveFile(e,r){var i=this;return fe(function*(){if(!i.googleAuth.isConnected())return!1;try{yield i.googleAuth.loadGapi(),i.ensureToken();const a=(yield gapi.client.drive.files.get({fileId:e,fields:"parents"})).result.parents?.join(",")||"";return yield gapi.client.drive.files.update({fileId:e,addParents:r,removeParents:a,fields:"id, parents"}),!0}catch{return!1}})()}static{this.\u0275fac=function(r){return new(r||t)(Dt(hT))}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const uO=(t,n)=>n.id;function tCe(t,n){if(1&t){const e=yn();j(0,"div",3)(1,"div",5),Y(2,"\u{1f4c1}"),G(),j(3,"h2",6),Y(4,"Google Drive"),G(),j(5,"p",7),Y(6,"Connecte ton compte Google pour partager des documents avec la famille"),G(),j(7,"button",8),Ge("click",function(){return He(e),Ze(xe().connectGoogle())}),Y(8,"Connecter Google Drive"),G()()}}function nCe(t,n){if(1&t){const e=yn();j(0,"span",21),Y(1,"/"),G(),j(2,"button",22),Ge("click",function(){const i=He(e).$index;return Ze(xe(2).goToBreadcrumb(i))}),Y(3),G()}if(2&t){const e=n.$implicit,r=n.$index,i=xe(2);le(2),Ls("text-family-purple",r===i.breadcrumb.length-1)("text-gray-500",r!==i.breadcrumb.length-1),le(),ci(" \u{1f4c1} ",e.name," ")}}function rCe(t,n){if(1&t){const e=yn();j(0,"button",13),Ge("click",function(){return He(e),Ze(xe(2).goUp())}),Rr(),j(1,"svg",14),wt(2,"path",23),G(),Y(3," Retour "),G()}}function iCe(t,n){1&t&&(j(0,"div",19),wt(1,"div",24),Y(2," Upload en cours... "),G())}function oCe(t,n){1&t&&(j(0,"div",20),wt(1,"div",25),Y(2," Chargement... "),G())}function sCe(t,n){if(1&t){const e=yn();j(0,"div",31),Ge("dragover",function(i){const o=He(e).$implicit;return Ze(xe(4).onDragOver(i,o))})("dragleave",function(){const i=He(e).$implicit;return Ze(xe(4).onDragLeave(i))})("drop",function(i){const o=He(e).$implicit;return Ze(xe(4).onDrop(i,o))}),j(1,"div",32),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(4).openFolder(i))}),j(2,"span",33),Y(3,"\u{1f4c1}"),G(),j(4,"span",34),Y(5),G()(),j(6,"div",35)(7,"button",36),Ge("click",function(i){const o=He(e).$implicit;return xe(4).openRenameModal(o),Ze(i.stopPropagation())}),Rr(),j(8,"svg",14),wt(9,"path",37),G()(),ua(),j(10,"button",38),Ge("click",function(i){const o=He(e).$implicit;return xe(4).openDeleteModal(o),Ze(i.stopPropagation())}),Rr(),j(11,"svg",14),wt(12,"path",39),G()()()()}if(2&t){const e=n.$implicit,r=xe(4);Ls("ring-2",r.dragOverFolder===e.id)("ring-family-purple",r.dragOverFolder===e.id)("bg-family-purple/5",r.dragOverFolder===e.id),le(5),Lt(e.name)}}function aCe(t,n){if(1&t&&(j(0,"div",26)(1,"h3",28),Y(2,"Dossiers"),G(),j(3,"div",29),sr(4,sCe,13,7,"div",30,uO),G()()),2&t){const e=xe(3);le(4),ar(e.folders)}}function lCe(t,n){if(1&t&&(j(0,"span"),Y(1),G()),2&t){const e=xe().$implicit;le(),ci("",e.uploadedByName," \xb7 ")}}function cCe(t,n){if(1&t){const e=yn();j(0,"div",42),Ge("dragstart",function(i){const o=He(e).$implicit;return Ze(xe(4).onDragStart(i,o))})("dragend",function(){return He(e),Ze(xe(4).onDragEnd())}),j(1,"span",43),Y(2),G(),j(3,"div",44),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(4).openFile(i))}),j(4,"p",45),Y(5),G(),j(6,"p",46),vt(7,lCe,2,1,"span"),Y(8),X_(9,"date"),G()(),j(10,"div",47)(11,"button",36),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(4).openRenameModal(i))}),Rr(),j(12,"svg",14),wt(13,"path",37),G()(),ua(),j(14,"button",38),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(4).openDeleteModal(i))}),Rr(),j(15,"svg",14),wt(16,"path",39),G()()()()}if(2&t){const e=n.$implicit,r=xe(4);Ls("opacity-50",(null==r.draggedFile?null:r.draggedFile.id)===e.id),le(2),Lt(r.getFileIcon(e.mimeType)),le(3),Lt(e.name),le(2),bt(e.uploadedByName?7:-1),le(),ci(" ",Q_(9,6,e.createdTime,"d MMM yyyy","","fr")," ")}}function uCe(t,n){if(1&t&&(j(0,"div",26)(1,"h3",28),Y(2,"Fichiers"),G(),j(3,"div",40),sr(4,cCe,17,11,"div",41,uO),G()()),2&t){const e=xe(3);le(4),ar(e.documents)}}function dCe(t,n){if(1&t){const e=yn();j(0,"div",27)(1,"div",48),Y(2,"\u{1f4ed}"),G(),j(3,"p",49),Y(4,"Dossier vide"),G(),j(5,"p",50),Y(6,"Ajoute un fichier ou cr\xe9e un dossier !"),G(),j(7,"button",51),Ge("click",function(){return He(e),Ze(xe(3).reconnectGoogle())}),Y(8," Probl\xe8me d'acc\xe8s ? Reconnecter Google Drive "),G()()}}function hCe(t,n){if(1&t&&(vt(0,aCe,6,0,"div",26),vt(1,uCe,6,0,"div",26),vt(2,dCe,9,0,"div",27)),2&t){const e=xe(2);bt(e.folders.length>0?0:-1),le(),bt(e.documents.length>0?1:-1),le(),bt(0===e.folders.length&&0===e.documents.length?2:-1)}}function fCe(t,n){if(1&t){const e=yn();j(0,"div",9)(1,"button",10),Ge("click",function(){return He(e),Ze(xe().goToRoot())}),Y(2," \u{1f3e0} FamilyApp "),G(),sr(3,nCe,4,5,null,null,uO),G(),j(5,"div",11),vt(6,rCe,4,0,"button",12),j(7,"button",13),Ge("click",function(){return He(e),Ze(xe().openNewFolderModal())}),Rr(),j(8,"svg",14),wt(9,"path",15),G(),Y(10," Nouveau dossier "),G(),ua(),j(11,"label",16),Rr(),j(12,"svg",14),wt(13,"path",17),G(),Y(14," Ajouter fichier "),ua(),j(15,"input",18),Ge("change",function(i){return He(e),Ze(xe().onFileSelected(i))}),G()()(),vt(16,iCe,3,0,"div",19),vt(17,oCe,3,0,"div",20),vt(18,hCe,3,3)}if(2&t){const e=xe();le(),Ls("text-family-purple",0===e.breadcrumb.length)("text-gray-500",e.breadcrumb.length>0),le(2),ar(e.breadcrumb),le(3),bt(e.breadcrumb.length>0?6:-1),le(10),bt(e.uploading?16:-1),le(),bt(e.loading?17:-1),le(),bt(e.loading?-1:18)}}function pCe(t,n){if(1&t){const e=yn();j(0,"div",52),Ge("click",function(){return He(e),Ze(xe().closeNewFolderModal())}),j(1,"div",53),Ge("click",function(i){return He(e),Ze(i.stopPropagation())}),j(2,"h3",54),Y(3,"Nouveau dossier"),G(),j(4,"input",55),_a("ngModelChange",function(i){He(e);const o=xe();return tl(o.newFolderName,i)||(o.newFolderName=i),Ze(i)}),Ge("keydown.enter",function(){return He(e),Ze(xe().createFolder())}),G(),j(5,"div",56)(6,"button",57),Ge("click",function(){return He(e),Ze(xe().closeNewFolderModal())}),Y(7," Annuler "),G(),j(8,"button",58),Ge("click",function(){return He(e),Ze(xe().createFolder())}),Y(9," Cr\xe9er "),G()()()()}if(2&t){const e=xe();le(4),ga("ngModel",e.newFolderName),le(4),gn("disabled",!e.newFolderName.trim())}}function mCe(t,n){if(1&t){const e=yn();j(0,"div",52),Ge("click",function(){return He(e),Ze(xe().closeRenameModal())}),j(1,"div",53),Ge("click",function(i){return He(e),Ze(i.stopPropagation())}),j(2,"h3",54),Y(3,"Renommer"),G(),j(4,"input",59),_a("ngModelChange",function(i){He(e);const o=xe();return tl(o.renameName,i)||(o.renameName=i),Ze(i)}),Ge("keydown.enter",function(){return He(e),Ze(xe().confirmRename())}),G(),j(5,"div",56)(6,"button",57),Ge("click",function(){return He(e),Ze(xe().closeRenameModal())}),Y(7," Annuler "),G(),j(8,"button",58),Ge("click",function(){return He(e),Ze(xe().confirmRename())}),Y(9," Renommer "),G()()()()}if(2&t){const e=xe();le(4),ga("ngModel",e.renameName),le(4),gn("disabled",!e.renameName.trim())}}function gCe(t,n){1&t&&Y(0," Le dossier et tout son contenu seront supprim\xe9s. ")}function _Ce(t,n){1&t&&Y(0," Ce fichier sera supprim\xe9 d\xe9finitivement. ")}function yCe(t,n){if(1&t){const e=yn();j(0,"div",52),Ge("click",function(){return He(e),Ze(xe().closeDeleteModal())}),j(1,"div",53),Ge("click",function(i){return He(e),Ze(i.stopPropagation())}),j(2,"div",60)(3,"div",61),Rr(),j(4,"svg",62),wt(5,"path",39),G()(),ua(),j(6,"h3",63),Y(7,"Supprimer ?"),G(),j(8,"p",64),vt(9,gCe,1,0)(10,_Ce,1,0),G(),j(11,"div",56)(12,"button",57),Ge("click",function(){return He(e),Ze(xe().closeDeleteModal())}),Y(13," Annuler "),G(),j(14,"button",65),Ge("click",function(){return He(e),Ze(xe().confirmDelete())}),Y(15," Supprimer "),G()()()()()}if(2&t){const e=xe();le(9),bt(null!=e.deleteTarget&&e.deleteTarget.isFolder?9:10)}}Nz(s5);let vCe=(()=>{class t{constructor(e,r,i){this.googleAuth=e,this.driveService=r,this.snackBar=i,this.isConnected=!1,this.files=[],this.breadcrumb=[],this.loading=!1,this.uploading=!1,this.showNewFolderModal=!1,this.newFolderName="",this.showRenameModal=!1,this.renameTarget=null,this.renameName="",this.showDeleteModal=!1,this.deleteTarget=null,this.draggedFile=null,this.dragOverFolder=null}ngOnInit(){this.filesSub=this.driveService.filesSubject.subscribe(e=>this.files=e),this.breadcrumbSub=this.driveService.breadcrumbSubject.subscribe(e=>this.breadcrumb=e),this.connSub=this.googleAuth.connectionChanged.subscribe(e=>{this.isConnected=e,e&&this.loadFiles()}),this.isConnected=this.googleAuth.isConnected(),this.isConnected&&this.loadFiles()}loadFiles(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.listFiles(),e.loading=!1})()}get folders(){return this.files.filter(e=>e.isFolder)}get documents(){return this.files.filter(e=>!e.isFolder)}connectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&this.loadFiles()})}reconnectGoogle(){this.googleAuth.signIn().then(e=>{this.isConnected=e,e&&this.loadFiles()})}openFolder(e){var r=this;return fe(function*(){r.loading=!0,yield r.driveService.navigateToFolder(e.id,e.name),r.loading=!1})()}goToRoot(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.navigateToBreadcrumb(-1),e.loading=!1})()}goToBreadcrumb(e){var r=this;return fe(function*(){r.loading=!0,yield r.driveService.navigateToBreadcrumb(e),r.loading=!1})()}goUp(){var e=this;return fe(function*(){e.loading=!0,yield e.driveService.navigateUp(),e.loading=!1})()}openNewFolderModal(){this.newFolderName="",this.showNewFolderModal=!0}closeNewFolderModal(){this.showNewFolderModal=!1,this.newFolderName=""}createFolder(){var e=this;return fe(function*(){if(!e.newFolderName.trim())return;const r=yield e.driveService.createFolder(e.newFolderName.trim());e.closeNewFolderModal(),r&&(yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Dossier cr\xe9\xe9 !","",{duration:3e3}))})()}openRenameModal(e){this.renameTarget=e,this.renameName=e.name,this.showRenameModal=!0}closeRenameModal(){this.showRenameModal=!1,this.renameTarget=null,this.renameName=""}confirmRename(){var e=this;return fe(function*(){if(!e.renameTarget||!e.renameName.trim())return;const r=yield e.driveService.renameFile(e.renameTarget.id,e.renameName.trim());e.closeRenameModal(),r&&(yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Renomm\xe9 !","",{duration:3e3}))})()}onDragStart(e,r){this.draggedFile=r,e.dataTransfer&&(e.dataTransfer.effectAllowed="move")}onDragEnd(){this.draggedFile=null,this.dragOverFolder=null}onDragOver(e,r){e.preventDefault(),this.draggedFile&&!this.draggedFile.isFolder&&(this.dragOverFolder=r.id,e.dataTransfer&&(e.dataTransfer.dropEffect="move"))}onDragLeave(e){this.dragOverFolder===e.id&&(this.dragOverFolder=null)}onDrop(e,r){var i=this;return fe(function*(){e.preventDefault(),i.dragOverFolder=null,i.draggedFile&&!i.draggedFile.isFolder&&(yield i.driveService.moveFile(i.draggedFile.id,r.id))&&(yield i.driveService.listFiles(i.driveService.currentFolderId||void 0),i.snackBar.open(`Fichier d\xe9plac\xe9 dans "${r.name}"`,"",{duration:3e3})),i.draggedFile=null})()}openDeleteModal(e){this.deleteTarget=e,this.showDeleteModal=!0}closeDeleteModal(){this.showDeleteModal=!1,this.deleteTarget=null}confirmDelete(){var e=this;return fe(function*(){e.deleteTarget&&(yield e.driveService.deleteFile(e.deleteTarget.id),e.closeDeleteModal(),yield e.driveService.listFiles(e.driveService.currentFolderId||void 0),e.snackBar.open("Supprim\xe9","",{duration:3e3}))})()}onFileSelected(e){const r=e.target;r.files?.length&&(this.uploadFile(r.files[0]),r.value="")}uploadFile(e){var r=this;return fe(function*(){r.uploading=!0;const i=yield r.driveService.uploadFile(e);r.uploading=!1,i&&(yield r.driveService.listFiles(r.driveService.currentFolderId||void 0),r.snackBar.open("Document ajout\xe9 !","",{duration:3e3}))})()}openFile(e){window.open(e.webViewLink,"_blank")}getFileIcon(e){return"application/vnd.google-apps.folder"===e?"\u{1f4c1}":e.includes("pdf")?"\u{1f4c4}":e.includes("image")?"\u{1f5bc}\ufe0f":e.includes("spreadsheet")||e.includes("excel")?"\u{1f4ca}":e.includes("document")||e.includes("word")?"\u{1f4dd}":e.includes("presentation")||e.includes("powerpoint")?"\u{1f4fd}\ufe0f":"\u{1f4ce}"}ngOnDestroy(){this.filesSub&&this.filesSub.unsubscribe(),this.breadcrumbSub&&this.breadcrumbSub.unsubscribe(),this.connSub&&this.connSub.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)(Re(hT),Re(eCe),Re(ig))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-documents"]],decls:9,vars:5,consts:[[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold","text-gradient"],[1,"card-fun","p-8","text-center"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"text-4xl","mb-4"],[1,"font-display","font-bold","text-gray-700","mb-2"],[1,"text-sm","text-gray-500","mb-4"],[1,"btn-gradient",3,"click"],[1,"flex","items-center","gap-1","text-sm","mb-4","flex-wrap"],[1,"px-2","py-1","rounded","hover:bg-gray-100","transition-colors","font-medium",3,"click"],[1,"flex","gap-2","mb-4"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"],[1,"card-fun","px-3","py-2","text-sm","flex","items-center","gap-1.5","text-gray-500","hover:text-family-purple","transition-colors","cursor-pointer"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],["type","file",1,"hidden",3,"change"],[1,"card-fun","p-3","mb-4","flex","items-center","gap-2","text-sm","text-gray-500"],[1,"text-center","py-8","text-gray-400"],[1,"text-gray-300"],[1,"px-2","py-1","rounded","hover:bg-gray-100","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"w-4","h-4","border-2","border-family-purple","border-t-transparent","rounded-full","animate-spin"],[1,"w-6","h-6","border-2","border-family-purple","border-t-transparent","rounded-full","animate-spin","mx-auto","mb-2"],[1,"mb-4"],[1,"text-center","py-12","text-gray-400"],[1,"font-display","font-bold","text-xs","text-gray-400","uppercase","tracking-wider","mb-2"],[1,"grid","grid-cols-2","gap-2"],[1,"card-fun","p-3","cursor-pointer","hover:shadow-card-hover","transition-all","group","relative",3,"ring-2","ring-family-purple","bg-family-purple/5"],[1,"card-fun","p-3","cursor-pointer","hover:shadow-card-hover","transition-all","group","relative",3,"dragover","dragleave","drop"],[1,"flex","items-center","gap-2",3,"click"],[1,"text-2xl"],[1,"font-medium","text-gray-700","truncate","flex-1"],[1,"absolute","top-2","right-2","opacity-0","group-hover:opacity-100","transition-opacity","flex","gap-1"],[1,"p-1","text-gray-400","hover:text-family-purple",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"p-1","text-gray-400","hover:text-red-400",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],["draggable","true",1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors","group","cursor-grab","active:cursor-grabbing",3,"opacity-50"],["draggable","true",1,"flex","items-center","gap-3","px-4","py-3","hover:bg-gray-50","transition-colors","group","cursor-grab","active:cursor-grabbing",3,"dragstart","dragend"],[1,"text-xl","flex-shrink-0"],[1,"flex-1","min-w-0","cursor-pointer",3,"click"],[1,"font-medium","text-gray-700","truncate","hover:text-family-purple","transition-colors"],[1,"text-xs","text-gray-400","truncate"],[1,"opacity-0","group-hover:opacity-100","transition-opacity","flex","gap-1"],[1,"text-4xl","mb-3"],[1,"font-medium"],[1,"text-sm","mb-4"],[1,"text-sm","text-family-purple","hover:underline",3,"click"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full","p-6",3,"click"],[1,"text-lg","font-bold","text-gray-800","mb-4"],["placeholder","Nom du dossier","autofocus","",1,"input-fun","w-full","mb-4",3,"ngModelChange","keydown.enter","ngModel"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-family-purple","text-white","font-medium","hover:bg-family-purple/90","disabled:opacity-40","transition-colors",3,"click","disabled"],["placeholder","Nouveau nom","autofocus","",1,"input-fun","w-full","mb-4",3,"ngModelChange","keydown.enter","ngModel"],[1,"text-center"],[1,"w-14","h-14","mx-auto","mb-4","rounded-full","bg-red-100","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-red-500"],[1,"text-lg","font-bold","text-gray-800","mb-2"],[1,"text-sm","text-gray-500","mb-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"div",1)(2,"h1",2),Y(3,"\u{1f5c2}\ufe0f Documents famille"),G()(),vt(4,tCe,9,0,"div",3),vt(5,fCe,19,8),G(),vt(6,pCe,10,2,"div",4),vt(7,mCe,10,2,"div",4),vt(8,yCe,16,1,"div",4)),2&r&&(le(4),bt(i.isConnected?-1:4),le(),bt(i.isConnected?5:-1),le(),bt(i.showNewFolderModal?6:-1),le(),bt(i.showRenameModal?7:-1),le(),bt(i.showDeleteModal?8:-1))},dependencies:[Rh,xw,Rc,Rd,kg,FE],styles:["select.input-fun[_ngcontent-%COMP%]{appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}"]})}}return t})();const bCe=(t,n)=>n.name;function wCe(t,n){if(1&t){const e=yn();j(0,"button",16),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).selectDestination(i))}),Y(1),G()}if(2&t){const e=n.$implicit;le(),ci(" ",e.name," ")}}function xCe(t,n){if(1&t&&(j(0,"div",8),sr(1,wCe,2,1,"button",15,bCe),G()),2&t){const e=xe();le(),ar(e.geoResults)}}let ECe=(()=>{class t{constructor(e){this.dialogRef=e,this.title="",this.destinationQuery="",this.destination="",this.startDate="",this.endDate="",this.description="",this.geoResults=[]}get canSave(){return!!(this.title.trim()&&this.destination&&this.startDate&&this.endDate)}searchDestination(){var e=this;clearTimeout(this.searchTimeout),this.destinationQuery.length<3?this.geoResults=[]:this.searchTimeout=setTimeout(fe(function*(){try{const i=yield(yield fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(e.destinationQuery)}&format=json&limit=5`)).json();e.geoResults=i.map(o=>({name:o.display_name,lat:parseFloat(o.lat),lng:parseFloat(o.lon)}))}catch{e.geoResults=[]}}),400)}selectDestination(e){this.destination=e.name,this.destinationQuery=e.name,this.lat=e.lat,this.lng=e.lng,this.geoResults=[]}save(){if(!this.canSave)return;const e=ho.currentUser,r={title:this.title.trim(),destination:this.destination,lat:this.lat,lng:this.lng,startDate:this.startDate,endDate:this.endDate,description:this.description.trim()||void 0,createdBy:e?.uid||"",createdByName:e?.displayName||"",status:"planning"};this.dialogRef.close(r)}static{this.\u0275fac=function(r){return new(r||t)(Re(og))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-add-vacation-dialog"]],decls:34,vars:7,consts:[[1,"p-6"],[1,"font-display","text-xl","font-bold","mb-4"],[1,"text-gradient"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-600","mb-1"],["placeholder","Ex: Vacances a Barcelone",1,"input-fun","w-full","text-sm",3,"ngModelChange","ngModel"],[1,"relative"],["placeholder","Rechercher un lieu...",1,"input-fun","w-full","text-sm",3,"ngModelChange","input","ngModel"],[1,"absolute","z-10","mt-1","w-full","bg-white","rounded-xl","shadow-lg","border","border-gray-100","max-h-48","overflow-y-auto"],[1,"grid","grid-cols-2","gap-3"],["type","date",1,"input-fun","w-full","text-sm",3,"ngModelChange","ngModel"],["rows","2","placeholder","Notes, idees...",1,"input-fun","w-full","text-sm","resize-none",3,"ngModelChange","ngModel"],[1,"flex","gap-3","mt-6"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","hover:bg-gray-50","transition-colors","text-sm","font-medium",3,"click"],[1,"flex-1","btn-gradient","text-sm","disabled:opacity-50",3,"click","disabled"],[1,"w-full","text-left","px-4","py-2","text-sm","hover:bg-gray-50","transition-colors","truncate"],[1,"w-full","text-left","px-4","py-2","text-sm","hover:bg-gray-50","transition-colors","truncate",3,"click"]],template:function(r,i){1&r&&(j(0,"div",0)(1,"h2",1)(2,"span"),Y(3,"\u{1f3d6}\ufe0f"),G(),j(4,"span",2),Y(5,"Nouveau voyage"),G()(),j(6,"div",3)(7,"div")(8,"label",4),Y(9,"Titre"),G(),j(10,"input",5),_a("ngModelChange",function(a){return tl(i.title,a)||(i.title=a),a}),G()(),j(11,"div",6)(12,"label",4),Y(13,"Destination"),G(),j(14,"input",7),_a("ngModelChange",function(a){return tl(i.destinationQuery,a)||(i.destinationQuery=a),a}),Ge("input",function(){return i.searchDestination()}),G(),vt(15,xCe,3,0,"div",8),G(),j(16,"div",9)(17,"div")(18,"label",4),Y(19,"Debut"),G(),j(20,"input",10),_a("ngModelChange",function(a){return tl(i.startDate,a)||(i.startDate=a),a}),G()(),j(21,"div")(22,"label",4),Y(23,"Fin"),G(),j(24,"input",10),_a("ngModelChange",function(a){return tl(i.endDate,a)||(i.endDate=a),a}),G()()(),j(25,"div")(26,"label",4),Y(27,"Description (optionnel)"),G(),j(28,"textarea",11),_a("ngModelChange",function(a){return tl(i.description,a)||(i.description=a),a}),G()()(),j(29,"div",12)(30,"button",13),Ge("click",function(){return i.dialogRef.close()}),Y(31," Annuler "),G(),j(32,"button",14),Ge("click",function(){return i.save()}),Y(33," Creer "),G()()()),2&r&&(le(10),ga("ngModel",i.title),le(4),ga("ngModel",i.destinationQuery),le(),bt(i.geoResults.length?15:-1),le(5),ga("ngModel",i.startDate),le(4),ga("ngModel",i.endDate),le(4),ga("ngModel",i.description),le(4),gn("disabled",!i.canSave))},dependencies:[Rh,xw,Rc,Rd,kg,h6],encapsulation:2})}}return t})();const CCe=["detailMap"],Mw=(t,n)=>n.id;function DCe(t,n){if(1&t){const e=yn();j(0,"div",14),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).selectVacation(i))}),j(1,"div",15)(2,"span",16),Y(3,"En cours"),G(),j(4,"span",17),Y(5,"\u2708\ufe0f"),G()(),j(6,"h3",18),Y(7),G(),j(8,"p",19),Y(9),G(),j(10,"p",20),Y(11),G()()}if(2&t){const e=n.$implicit,r=xe(2);le(7),Lt(e.title),le(2),Ch("",e.destination," \xb7 ",r.durationDays(e)," jours"),le(2),Ch("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate))}}function TCe(t,n){1&t&&(j(0,"h2",10),Y(1,"A venir"),G())}function SCe(t,n){if(1&t){const e=yn();j(0,"div",21),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).selectVacation(i))}),j(1,"div",22)(2,"div")(3,"h3",18),Y(4),G(),j(5,"p",19),Y(6),G(),j(7,"p",20),Y(8),G()(),j(9,"div",23)(10,"div",24),Y(11),G(),j(12,"div",25),Y(13,"jours"),G()()()()}if(2&t){const e=n.$implicit,r=xe(2);le(4),Lt(e.title),le(2),Lt(e.destination),le(2),Ch("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate)),le(3),Lt(r.daysUntil(e.startDate))}}function ICe(t,n){1&t&&(j(0,"h2",10),Y(1,"Souvenirs"),G())}function kCe(t,n){if(1&t){const e=yn();j(0,"div",26),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(2).selectVacation(i))}),j(1,"h3",18),Y(2),G(),j(3,"p",19),Y(4),G(),j(5,"p",20),Y(6),G()()}if(2&t){const e=n.$implicit,r=xe(2);le(2),Lt(e.title),le(2),Ch("",e.destination," \xb7 ",r.durationDays(e)," jours"),le(2),Ch("",r.formatDate(e.startDate)," \u2192 ",r.formatDate(e.endDate))}}function ACe(t,n){1&t&&(j(0,"div",13)(1,"div",27),Y(2,"\u{1f334}"),G(),j(3,"p",8),Y(4,"Aucune vacance planifiee"),G(),j(5,"p",28),Y(6,"Planifie ton prochain voyage !"),G()())}function MCe(t,n){if(1&t){const e=yn();j(0,"div",1)(1,"div",2)(2,"h1",3)(3,"span"),Y(4,"\u{1f3d6}\ufe0f"),G(),j(5,"span",4),Y(6,"Vacances"),G()()(),j(7,"button",5),Ge("click",function(){return He(e),Ze(xe().openAdd())}),Rr(),j(8,"svg",6),wt(9,"path",7),G(),ua(),j(10,"span",8),Y(11,"Planifier des vacances"),G()(),sr(12,DCe,12,5,"div",9,Mw),vt(14,TCe,2,0,"h2",10),sr(15,SCe,14,5,"div",11,Mw),vt(17,ICe,2,0,"h2",10),sr(18,kCe,7,5,"div",12,Mw),vt(20,ACe,7,0,"div",13),G()}if(2&t){const e=xe();le(12),ar(e.ongoing()),le(2),bt(e.upcoming().length?14:-1),le(),ar(e.upcoming()),le(2),bt(e.past().length?17:-1),le(),ar(e.past()),le(2),bt(e.vacations().length?-1:20)}}function RCe(t,n){if(1&t&&(j(0,"div",35)(1,"div",42),Y(2),G(),j(3,"div",43),Y(4,"jours"),G()()),2&t){const e=xe(2);le(2),Lt(e.daysUntil(e.selectedVacation.startDate))}}function PCe(t,n){if(1&t&&(j(0,"p",36),Y(1),G()),2&t){const e=xe(2);le(),Lt(e.selectedVacation.description)}}function NCe(t,n){if(1&t&&(j(0,"div",44)(1,"div",51)(2,"span"),Y(3),G(),j(4,"span"),Y(5),G()(),j(6,"div",52),wt(7,"div",53),G()()),2&t){const e=xe(3);le(3),ci("",e.checklistProgress,"% complete"),le(2),ci("",e.checklist.length," elements"),le(2),zm("width",e.checklistProgress,"%")}}function OCe(t,n){if(1&t){const e=yn();j(0,"div",49)(1,"input",54),Ge("change",function(){const i=He(e).$implicit;return Ze(xe(3).toggleItem(i))}),G(),j(2,"span"),Y(3),G(),j(4,"button",55),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(3).deleteItem(i))}),Rr(),j(5,"svg",30),wt(6,"path",56),G()()()}if(2&t){const e=n.$implicit;le(),gn("checked",e.checked),le(),sp(e.checked?"flex-1 text-sm text-gray-400 line-through":"flex-1 text-sm text-gray-700"),le(),ci(" ",e.text," ")}}function LCe(t,n){1&t&&(j(0,"div",50)(1,"div",57),Y(2,"\u{1f4dd}"),G(),Y(3," Ajoute des elements a ta checklist "),G())}function FCe(t,n){if(1&t){const e=yn();vt(0,NCe,8,4,"div",44),j(1,"div",45)(2,"input",46),_a("ngModelChange",function(i){He(e);const o=xe(2);return tl(o.newItemText,i)||(o.newItemText=i),Ze(i)}),Ge("keyup.enter",function(){return He(e),Ze(xe(2).addItem())}),G(),j(3,"button",47),Ge("click",function(){return He(e),Ze(xe(2).addItem())}),Y(4,"+"),G()(),j(5,"div",48),sr(6,OCe,7,4,"div",49,Mw),G(),vt(8,LCe,4,0,"div",50)}if(2&t){const e=xe(2);bt(e.checklist.length?0:-1),le(2),ga("ngModel",e.newItemText),le(4),ar(e.checklist),le(2),bt(e.checklist.length?-1:8)}}function BCe(t,n){1&t&&(j(0,"div",60),wt(1,"div",64),Y(2," Upload en cours... "),G())}function VCe(t,n){1&t&&(j(0,"div",61),Y(1,"\u{1f4f7} Ajouter une photo"),G())}function zCe(t,n){if(1&t){const e=yn();j(0,"div",63),wt(1,"img",65),j(2,"div",66)(3,"p",67),Y(4),G()(),j(5,"button",68),Ge("click",function(){const i=He(e).$implicit;return Ze(xe(3).deletePhoto(i))}),Rr(),j(6,"svg",69),wt(7,"path",56),G()()()}if(2&t){const e=n.$implicit;le(),gn("src",e.url,So),le(3),Lt(e.addedByName)}}function UCe(t,n){1&t&&(j(0,"div",50)(1,"div",57),Y(2,"\u{1f4f8}"),G(),Y(3," Ajoute des photos de tes vacances "),G())}function jCe(t,n){if(1&t){const e=yn();j(0,"label",58)(1,"input",59),Ge("change",function(i){return He(e),Ze(xe(2).onPhotoSelected(i))}),G(),vt(2,BCe,3,0,"div",60)(3,VCe,2,0,"div",61),G(),j(4,"div",62),sr(5,zCe,8,2,"div",63,Mw),G(),vt(7,UCe,4,0,"div",50)}if(2&t){const e=xe(2);le(2),bt(e.uploading?2:3),le(3),ar(e.photos),le(2),bt(e.photos.length||e.uploading?-1:7)}}function HCe(t,n){1&t&&wt(0,"div",39,0)}function $Ce(t,n){if(1&t){const e=yn();j(0,"div",1)(1,"button",29),Ge("click",function(){return He(e),Ze(xe().backToList())}),Rr(),j(2,"svg",30),wt(3,"path",31),G(),Y(4," Retour "),G(),ua(),j(5,"div",32)(6,"div",22)(7,"div")(8,"h1",33),Y(9),G(),j(10,"p",34),Y(11),G(),j(12,"p",20),Y(13),G()(),vt(14,RCe,5,1,"div",35),G(),vt(15,PCe,2,1,"p",36),G(),j(16,"div",37)(17,"button",38),Ge("click",function(){return He(e),Ze(xe().onTabChange("checklist"))}),Y(18," Checklist "),G(),j(19,"button",38),Ge("click",function(){return He(e),Ze(xe().onTabChange("photos"))}),Y(20," Photos "),G(),j(21,"button",38),Ge("click",function(){return He(e),Ze(xe().onTabChange("map"))}),Y(22," Carte "),G()(),vt(23,FCe,9,3),vt(24,jCe,8,2),vt(25,HCe,2,0,"div",39),j(26,"div",40)(27,"button",41),Ge("click",function(){return He(e),Ze(xe().deleteVacation())}),Y(28," Supprimer ce voyage "),G()()()}if(2&t){const e=xe();le(9),Lt(e.selectedVacation.title),le(2),ci("\u{1f4cd} ",e.selectedVacation.destination),le(2),X1("",e.formatDate(e.selectedVacation.startDate)," \u2192 ",e.formatDate(e.selectedVacation.endDate)," \xb7 ",e.durationDays(e.selectedVacation)," jours"),le(),bt(e.daysUntil(e.selectedVacation.startDate)>0?14:-1),le(),bt(e.selectedVacation.description?15:-1),le(2),sp("checklist"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-pink shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),le(2),sp("photos"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-coral shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),le(2),sp("map"===e.activeTab?"flex-1 py-2 rounded-lg text-sm font-medium bg-white text-family-sky shadow-sm":"flex-1 py-2 rounded-lg text-sm font-medium text-gray-500"),le(2),bt("checklist"===e.activeTab?23:-1),le(),bt("photos"===e.activeTab?24:-1),le(),bt("map"===e.activeTab?25:-1)}}let qCe=(()=>{class t{constructor(e,r){this.vacService=e,this.dialog=r,this.vacations=this.vacService.vacations,this.selectedVacation=null,this.activeTab="checklist",this.checklist=[],this.photos=[],this.newItemText="",this.uploading=!1,this.unsubChecklist=null,this.unsubPhotos=null,this.map=null,this.upcoming=di(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.startDate>i)}),this.ongoing=di(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.startDate<=i&&o.endDate>=i)}),this.past=di(()=>{const i=(new Date).toISOString().slice(0,10);return this.vacService.vacations().filter(o=>o.endDate<i)})}daysUntil(e){const r=new Date(e).getTime()-Date.now();return Math.max(0,Math.ceil(r/864e5))}durationDays(e){const r=new Date(e.endDate).getTime()-new Date(e.startDate).getTime();return Math.max(1,Math.ceil(r/864e5))}formatDate(e){return new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}openAdd(){this.dialog.open(ECe,{width:"95vw",maxWidth:"500px",panelClass:"rounded-dialog"}).afterClosed().subscribe(r=>{r&&this.vacService.addVacation(r)})}selectVacation(e){this.selectedVacation=e,this.activeTab="checklist",this.cleanupDetail(),this.unsubChecklist=this.vacService.listenChecklist(e.id,r=>this.checklist=r),this.unsubPhotos=this.vacService.listenPhotos(e.id,r=>this.photos=r)}backToList(){this.selectedVacation=null,this.cleanupDetail()}cleanupDetail(){this.unsubChecklist?.(),this.unsubPhotos?.(),this.unsubChecklist=null,this.unsubPhotos=null,this.map?.remove(),this.map=null,this.checklist=[],this.photos=[]}addItem(){var e=this;return fe(function*(){!e.newItemText.trim()||!e.selectedVacation||(yield e.vacService.addChecklistItem(e.selectedVacation.id,e.newItemText.trim()),e.newItemText="")})()}toggleItem(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.toggleChecklistItem(r.selectedVacation.id,e.id,!e.checked))})()}deleteItem(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.deleteChecklistItem(r.selectedVacation.id,e.id))})()}get checklistProgress(){return this.checklist.length?Math.round(this.checklist.filter(e=>e.checked).length/this.checklist.length*100):0}onPhotoSelected(e){var r=this;return fe(function*(){const i=e.target;!i.files?.length||!r.selectedVacation||(r.uploading=!0,yield r.vacService.uploadPhoto(r.selectedVacation.id,i.files[0]),r.uploading=!1,i.value="")})()}deletePhoto(e){var r=this;return fe(function*(){r.selectedVacation&&(yield r.vacService.deletePhoto(r.selectedVacation.id,e))})()}onTabChange(e){this.activeTab=e,"map"===e&&setTimeout(()=>this.initMap(),100)}initMap(){if(!this.mapContainer||!this.selectedVacation)return;this.map?.remove();const e=this.selectedVacation;this.map=new Qh.Map({container:this.mapContainer.nativeElement,style:"https://maps.geoapify.com/v1/styles/maptiler-3d/style.json?apiKey=793f93202015411eaa6fceaeadaad99c",center:[e.lng||2.35,e.lat||48.85],zoom:e.lat?10:5}),e.lat&&e.lng&&new Qh.Marker({color:"#ec4899"}).setLngLat([e.lng,e.lat]).setPopup((new Qh.Popup).setHTML(`<strong>${e.destination}</strong>`)).addTo(this.map);for(const i of this.photos)if(i.lat&&i.lng){const o=document.createElement("div");o.style.cssText="width:30px;height:30px;border-radius:50%;border:2px solid #fff;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.3);cursor:pointer;";const a=document.createElement("img");a.src=i.url,a.style.cssText="width:100%;height:100%;object-fit:cover;",o.appendChild(a),new Qh.Marker({element:o}).setLngLat([i.lng,i.lat]).setPopup((new Qh.Popup).setHTML(`<img src="${i.url}" style="max-width:150px;border-radius:8px;"/>`)).addTo(this.map)}}deleteVacation(){var e=this;return fe(function*(){e.selectedVacation&&(yield e.vacService.deleteVacation(e.selectedVacation.id),e.backToList())})()}ngOnDestroy(){this.cleanupDetail()}static{this.\u0275fac=function(r){return new(r||t)(Re(aW),Re(sg))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-vacances"]],viewQuery:function(r,i){if(1&r&&op(CCe,5),2&r){let o;hd(o=fd())&&(i.mapContainer=o.first)}},decls:2,vars:2,consts:[["detailMap",""],[1,"max-w-2xl","mx-auto","px-4"],[1,"text-center","mb-6"],[1,"font-display","text-2xl","font-bold"],[1,"text-gradient"],[1,"w-full","card-fun","p-4","mb-6","flex","items-center","justify-center","gap-2","text-gray-500","hover:text-family-pink","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"font-medium"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","border-l-4","border-green-400"],[1,"font-display","font-bold","text-sm","text-gray-500","mb-2","mt-6"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","opacity-80"],[1,"text-center","py-12","text-gray-400"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","border-l-4","border-green-400",3,"click"],[1,"flex","items-center","gap-2","mb-1"],[1,"bg-green-100","text-green-700","text-xs","font-bold","px-2","py-0.5","rounded-full"],[1,"text-lg"],[1,"font-display","font-bold","text-gray-700"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow",3,"click"],[1,"flex","justify-between","items-start"],[1,"text-center","flex-shrink-0","ml-4"],[1,"text-2xl","font-display","font-extrabold","text-family-pink"],[1,"text-[10px]","text-gray-400","font-medium"],[1,"card-fun","p-4","mb-4","cursor-pointer","hover:shadow-card-hover","transition-shadow","opacity-80",3,"click"],[1,"text-4xl","mb-3"],[1,"text-sm"],[1,"flex","items-center","gap-1","text-gray-500","hover:text-gray-700","mb-4","text-sm","font-medium",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"card-fun","p-5","mb-4"],[1,"font-display","text-xl","font-bold","text-gray-700"],[1,"text-sm","text-gray-500","mt-1"],[1,"text-center","flex-shrink-0"],[1,"text-sm","text-gray-600","mt-3"],[1,"flex","gap-1","mb-4","bg-gray-100","rounded-xl","p-1"],[3,"click"],[1,"w-full","h-80","rounded-xl","overflow-hidden","shadow-sm"],[1,"mt-8","mb-8","text-center"],[1,"text-sm","text-red-400","hover:text-red-600","transition-colors",3,"click"],[1,"text-3xl","font-display","font-extrabold","text-family-pink"],[1,"text-[10px]","text-gray-400"],[1,"mb-4"],[1,"flex","gap-2","mb-4"],["placeholder","Ajouter un element...",1,"flex-1","input-fun","text-sm",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn-gradient","px-4","text-sm",3,"click"],[1,"card-fun","overflow-hidden","divide-y","divide-gray-100"],[1,"flex","items-center","gap-3","px-4","py-3"],[1,"text-center","py-8","text-gray-400","text-sm"],[1,"flex","justify-between","text-xs","text-gray-500","mb-1"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"bg-gradient-to-r","from-family-pink","to-family-coral","h-2","rounded-full","transition-all"],["type","checkbox",1,"w-4","h-4","rounded","border-gray-300","text-family-pink","focus:ring-family-pink",3,"change","checked"],[1,"text-gray-300","hover:text-red-400","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"text-2xl","mb-2"],[1,"block","card-fun","p-4","mb-4","text-center","cursor-pointer","hover:shadow-card-hover","transition-shadow"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"flex","items-center","justify-center","gap-2","text-sm","text-gray-500"],[1,"text-gray-500","text-sm","font-medium"],[1,"grid","grid-cols-2","gap-3"],[1,"relative","group"],[1,"w-4","h-4","border-2","border-family-coral","border-t-transparent","rounded-full","animate-spin"],["loading","lazy",1,"w-full","aspect-square","object-cover","rounded-xl","shadow-sm",3,"src"],[1,"absolute","bottom-0","left-0","right-0","bg-gradient-to-t","from-black/50","to-transparent","p-2","rounded-b-xl"],[1,"text-white","text-xs","truncate"],[1,"absolute","top-2","right-2","w-6","h-6","bg-white/80","rounded-full","flex","items-center","justify-center","opacity-100","md:opacity-0","md:group-hover:opacity-100","transition-opacity","text-red-400",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3","h-3"]],template:function(r,i){1&r&&(vt(0,MCe,21,3,"div",1),vt(1,$Ce,29,16,"div",1)),2&r&&(bt(i.selectedVacation?-1:0),le(),bt(i.selectedVacation?1:-1))},dependencies:[Rh,xw,Rc,Rd,kg],encapsulation:2})}}return t})(),GCe=(()=>{class t{constructor(){this.messagesRef=Ir(Lr,"/chat/messages")}listenMessages(e){const r=function Ybe(t,...n){let e=Ao(t);for(const r of n)e=r._apply(e);return e}(this.messagesRef,function $be(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Hbe(t)}(100)),i=ho.currentUser?.uid;return Mp(r,o=>{const a=o.val();if(!a)return void e([]);const c=Object.keys(a).map(f=>{const _={...a[f],id:f};return _._likeCount=_.likes?Object.keys(_.likes).length:0,_._liked=!!i&&!!_.likes?.[i],_.comments?(_._comments=Object.keys(_.comments).map(x=>({..._.comments[x],id:x})).sort((x,D)=>x.timestamp-D.timestamp),_._commentCount=_._comments.length):(_._comments=[],_._commentCount=0),_}).sort((f,_)=>_.timestamp-f.timestamp);e(c)}),()=>OD(r)}sendMessage(e,r){var i=this;return fe(function*(){const o=ho.currentUser;if(!o||!e.trim()&&!r)return;let a;r&&(a=yield i.uploadImage(r));const c=Vy(i.messagesRef);yield Sd(c,{id:c.key,text:e.trim(),uid:o.uid,displayName:o.displayName||"",photoURL:o.photoURL||"",timestamp:Date.now(),...a&&{imageURL:a}})})()}uploadImage(e){var r=this;return fe(function*(){const i=yield r.compressImage(e),o=`${Date.now()}_${Math.random().toString(36).substring(2,11)}.jpg`,a=lw(cw,`feed/${o}`);return TN((yield DN(a,i,{contentType:"image/jpeg"})).ref)})()}compressImage(e,r=1200,i=.7){return new Promise((o,a)=>{const c=new Image,f=new FileReader;f.onload=_=>{c.onload=()=>{const x=document.createElement("canvas");let D=c.width,A=c.height;D>r&&(A=Math.round(A*r/D),D=r),x.width=D,x.height=A,x.getContext("2d").drawImage(c,0,0,D,A),x.toBlob(B=>B?o(B):a("Compression failed"),"image/jpeg",i)},c.onerror=a,c.src=_.target?.result},f.onerror=a,f.readAsDataURL(e)})}toggleLike(e){return fe(function*(){const r=ho.currentUser?.uid;if(!r)return;const i=Ir(Lr,`/chat/messages/${e}/likes/${r}`);(yield tw(i)).val()?yield Cg(i):yield Sd(i,!0)})()}addComment(e,r){return fe(function*(){const i=ho.currentUser;if(!i||!r.trim())return;const o=Vy(Ir(Lr,`/chat/messages/${e}/comments`));yield Sd(o,{text:r.trim(),uid:i.uid,displayName:i.displayName||"",photoURL:i.photoURL||"",timestamp:Date.now()})})()}deleteComment(e,r){return fe(function*(){yield Cg(Ir(Lr,`/chat/messages/${e}/comments/${r}`))})()}deleteMessage(e){return fe(function*(){if(e.imageURL)try{const r=lw(cw,e.imageURL);yield kq(r)}catch{console.log("Image not found or already deleted")}yield Cg(Ir(Lr,`/chat/messages/${e.id}`))})()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=je({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const WCe=["messagesContainer"],KCe=["fileInput"],wW=(t,n)=>n.id;function ZCe(t,n){1&t&&(j(0,"div",7)(1,"div",20),Y(2,"\u{1f4f1}"),G(),j(3,"p",21),Y(4,"Aucune publication"),G(),j(5,"p",22),Y(6,"Partage un moment avec ta famille !"),G()())}function YCe(t,n){if(1&t&&(j(0,"div",23),wt(1,"div",40),j(2,"span",41),Y(3),G(),wt(4,"div",40),G()),2&t){const e=xe().$implicit,r=xe();le(3),Lt(r.formatDate(e.timestamp))}}function XCe(t,n){1&t&&wt(0,"img",26),2&t&&gn("src",xe().$implicit.photoURL,So)}function QCe(t,n){if(1&t&&(j(0,"div",27),Y(1),G()),2&t){const e=xe().$implicit;le(),ci(" ",(e.displayName||"?")[0].toUpperCase()," ")}}function JCe(t,n){if(1&t){const e=yn();j(0,"button",42),Ge("click",function(){He(e);const i=xe().$implicit;return Ze(xe().openDeleteModal(i))}),Rr(),j(1,"svg",17),wt(2,"path",43),G()()}}function eDe(t,n){1&t&&wt(0,"img",32),2&t&&gn("src",xe().$implicit.imageURL,So)}function tDe(t,n){if(1&t&&(j(0,"div",33)(1,"p",44),Y(2),G()()),2&t){const e=xe().$implicit;le(2),Lt(e.text)}}function nDe(t,n){1&t&&wt(0,"img",50),2&t&&gn("src",xe().$implicit.photoURL,So)}function rDe(t,n){if(1&t&&(j(0,"div",51),Y(1),G()),2&t){const e=xe().$implicit;le(),ci(" ",(e.displayName||"?")[0].toUpperCase()," ")}}function iDe(t,n){if(1&t){const e=yn();j(0,"button",58),Ge("click",function(){He(e);const i=xe().$implicit,o=xe(3).$implicit;return Ze(xe().deleteComment(o.id,i.id))}),Y(1," Supprimer "),G()}}function oDe(t,n){if(1&t&&(j(0,"div",49),vt(1,nDe,1,1,"img",50)(2,rDe,2,1,"div",51),j(3,"div",28)(4,"div",52)(5,"p",53),Y(6),G(),j(7,"p",54),Y(8),G()(),j(9,"div",55)(10,"span",56),Y(11),G(),vt(12,iDe,2,0,"button",57),G()()()),2&t){const e=n.$implicit,r=xe(4);le(),bt(e.photoURL?1:2),le(5),Lt(e.displayName||"Anonyme"),le(2),Lt(e.text),le(3),Lt(r.formatTime(e.timestamp)),le(),bt(e.uid===r.currentUid?12:-1)}}function sDe(t,n){if(1&t&&(j(0,"div",45),sr(1,oDe,13,5,"div",49,wW),G()),2&t){const e=xe(2).$implicit;le(),ar(e._comments)}}function aDe(t,n){if(1&t){const e=yn();j(0,"div",39),vt(1,sDe,3,0,"div",45),j(2,"div",46)(3,"input",47),_a("ngModelChange",function(i){He(e);const o=xe().$implicit,a=xe();return tl(a.commentInputs[o.id],i)||(a.commentInputs[o.id]=i),Ze(i)}),Ge("keydown.enter",function(){He(e);const i=xe().$implicit;return Ze(xe().addComment(i.id))}),G(),j(4,"button",48),Ge("click",function(){He(e);const i=xe().$implicit;return Ze(xe().addComment(i.id))}),Rr(),j(5,"svg",17),wt(6,"path",18),G()()()()}if(2&t){const e=xe().$implicit,r=xe();le(),bt(e._comments&&e._comments.length>0?1:-1),le(2),ga("ngModel",r.commentInputs[e.id]),le(),gn("disabled",!(null!=r.commentInputs[e.id]&&r.commentInputs[e.id].trim()))}}function lDe(t,n){if(1&t){const e=yn();vt(0,YCe,5,1,"div",23),j(1,"div",24)(2,"div",25),vt(3,XCe,1,1,"img",26)(4,QCe,2,1,"div",27),j(5,"div",28)(6,"p",29),Y(7),G(),j(8,"p",30),Y(9),G()(),vt(10,JCe,3,0,"button",31),G(),vt(11,eDe,1,1,"img",32),vt(12,tDe,3,1,"div",33),j(13,"div",34)(14,"button",35),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().toggleLike(i))}),j(15,"span",36),Y(16),G(),j(17,"span",37),Y(18),G()(),j(19,"button",38),Ge("click",function(){const i=He(e).$implicit;return Ze(xe().toggleComments(i.id))}),j(20,"span",36),Y(21,"\u{1f4ac}"),G(),j(22,"span",37),Y(23),G()()(),vt(24,aDe,7,3,"div",39),G()}if(2&t){const e=n.$implicit,r=n.$index,i=xe();bt(i.showDateSeparator(r)?0:-1),le(3),bt(e.photoURL?3:4),le(4),Lt(e.displayName||"Anonyme"),le(2),Lt(i.formatTime(e.timestamp)),le(),bt(i.isMine(e)?10:-1),le(),bt(e.imageURL?11:-1),le(),bt(e.text?12:-1),le(2),sp(e._liked?"text-family-pink":"text-gray-400 hover:text-family-pink"),le(2),Lt(e._liked?"\u2764\ufe0f":"\u{1f90d}"),le(2),Lt(e._likeCount||0),le(5),Lt(e._commentCount||0),le(),bt(i.isCommentsExpanded(e.id)?24:-1)}}function cDe(t,n){if(1&t){const e=yn();j(0,"div",9),wt(1,"img",59),j(2,"button",60),Ge("click",function(){return He(e),Ze(xe().removeImage())}),Rr(),j(3,"svg",61),wt(4,"path",62),G()()()}if(2&t){const e=xe();le(),gn("src",e.imagePreview,So)}}function uDe(t,n){if(1&t){const e=yn();j(0,"div",63),Ge("click",function(){return He(e),Ze(xe().closeDeleteModal())}),j(1,"div",64),Ge("click",function(i){return He(e),Ze(i.stopPropagation())}),j(2,"div",65)(3,"div",66),Rr(),j(4,"svg",67),wt(5,"path",43),G()(),ua(),j(6,"h3",68),Y(7,"Supprimer ce post ?"),G(),j(8,"p",69),Y(9,"Cette action est irr\xe9versible."),G(),j(10,"div",70)(11,"button",71),Ge("click",function(){return He(e),Ze(xe().closeDeleteModal())}),Y(12," Annuler "),G(),j(13,"button",72),Ge("click",function(){return He(e),Ze(xe().confirmDelete())}),Y(14," Supprimer "),G()()()()()}}const dDe=[{path:"auth/signin",component:Gxe},{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",canActivate:[Du],component:L1e},{path:"user-profile",canActivate:[Du],component:wEe},{path:"add-task",canActivate:[Du],component:$xe},{path:"shopping",canActivate:[Du],component:mEe},{path:"map",canActivate:[Du],component:nEe},{path:"calendar",canActivate:[Du],component:JEe},{path:"documents",canActivate:[Du],component:vCe},{path:"vacances",canActivate:[Du],component:qCe},{path:"chat",canActivate:[Du],component:(()=>{class t{constructor(e){this.chatService=e,this.messages=[],this.newMessage="",this.currentUid="",this.selectedImage=null,this.imagePreview=null,this.unsubscribe=null,this.shouldScroll=!0,this.showDeleteModal=!1,this.messageToDelete=null,this.expandedComments=new Set,this.commentInputs={}}ngOnInit(){this.currentUid=ho.currentUser?.uid||"",this.unsubscribe=this.chatService.listenMessages(e=>{this.messages=e,this.shouldScroll=!0})}ngAfterViewChecked(){this.shouldScroll&&(this.scrollToTop(),this.shouldScroll=!1)}scrollToTop(){const e=this.messagesContainer?.nativeElement;e&&(e.scrollTop=0)}isMine(e){return e.uid===this.currentUid}formatTime(e){const r=new Date(e),i=new Date,o=new Date(i);o.setDate(o.getDate()-1);const a=r.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});return r.toDateString()===i.toDateString()?`Aujourd'hui \xe0 ${a}`:r.toDateString()===o.toDateString()?`Hier \xe0 ${a}`:`${r.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})} \xe0 ${a}`}formatDate(e){const r=new Date(e),i=new Date,o=new Date(i);return o.setDate(o.getDate()-1),r.toDateString()===i.toDateString()?"Aujourd'hui":r.toDateString()===o.toDateString()?"Hier":r.toLocaleDateString("fr-FR",{day:"numeric",month:"long"})}showDateSeparator(e){return 0===e||new Date(this.messages[e-1].timestamp).toDateString()!==new Date(this.messages[e].timestamp).toDateString()}openFilePicker(){this.fileInput.nativeElement.click()}onFileSelected(e){const r=e.target;if(r.files&&r.files[0]){this.selectedImage=r.files[0];const i=new FileReader;i.onload=o=>{this.imagePreview=o.target?.result},i.readAsDataURL(this.selectedImage)}}removeImage(){this.selectedImage=null,this.imagePreview=null,this.fileInput&&(this.fileInput.nativeElement.value="")}send(){var e=this;return fe(function*(){if(!e.newMessage.trim()&&!e.selectedImage)return;const r=e.newMessage,i=e.selectedImage;e.newMessage="",e.removeImage(),yield e.chatService.sendMessage(r,i||void 0)})()}toggleLike(e){var r=this;return fe(function*(){yield r.chatService.toggleLike(e.id)})()}openDeleteModal(e){e.uid===this.currentUid&&(this.messageToDelete=e,this.showDeleteModal=!0)}closeDeleteModal(){this.showDeleteModal=!1,this.messageToDelete=null}confirmDelete(){var e=this;return fe(function*(){e.messageToDelete&&(yield e.chatService.deleteMessage(e.messageToDelete),e.closeDeleteModal())})()}toggleComments(e){this.expandedComments.has(e)?this.expandedComments.delete(e):this.expandedComments.add(e)}isCommentsExpanded(e){return this.expandedComments.has(e)}addComment(e){var r=this;return fe(function*(){const i=r.commentInputs[e]?.trim();i&&(r.commentInputs[e]="",yield r.chatService.addComment(e,i))})()}deleteComment(e,r){var i=this;return fe(function*(){yield i.chatService.deleteComment(e,r)})()}ngOnDestroy(){this.unsubscribe?.()}static{this.\u0275fac=function(r){return new(r||t)(Re(GCe))}}static{this.\u0275cmp=_r({type:t,selectors:[["app-chat"]],viewQuery:function(r,i){if(1&r&&op(WCe,5)(KCe,5),2&r){let o;hd(o=fd())&&(i.messagesContainer=o.first),hd(o=fd())&&(i.fileInput=o.first)}},decls:25,vars:5,consts:[["messagesContainer",""],["fileInput",""],[1,"flex","flex-col","h-[calc(100vh-14rem)]","md:h-[calc(100vh-6rem)]","max-w-2xl","mx-auto"],[1,"text-center","py-3","flex-shrink-0"],[1,"font-display","text-2xl","font-bold"],[1,"text-gradient"],[1,"flex-1","overflow-y-auto","px-4","space-y-4","pb-4"],[1,"text-center","py-12","text-gray-400"],[1,"flex-shrink-0","px-4","py-3","bg-white/80","backdrop-blur-sm","border-t","border-gray-100"],[1,"relative","mb-3","inline-block"],[1,"flex","gap-2","items-end"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"p-2.5","text-gray-400","hover:text-family-pink","transition-colors","flex-shrink-0",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],["placeholder","Quoi de neuf ?","rows","1",1,"flex-1","input-fun","text-sm","resize-none","max-h-24","overflow-y-auto",3,"ngModelChange","keydown.enter","ngModel"],[1,"btn-gradient","px-4","py-2.5","rounded-xl","text-sm","disabled:opacity-40","flex-shrink-0",3,"click","disabled"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4"],[1,"text-4xl","mb-3"],[1,"font-medium"],[1,"text-sm"],[1,"flex","items-center","gap-3","py-2"],[1,"card-fun","overflow-hidden"],[1,"flex","items-center","gap-3","p-3"],["referrerpolicy","no-referrer",1,"w-10","h-10","rounded-full","object-cover","border-2","border-gray-100",3,"src"],[1,"w-10","h-10","rounded-full","bg-gradient-to-br","from-family-pink","to-family-coral","flex","items-center","justify-center","text-white","font-bold"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-700","truncate"],[1,"text-xs","text-gray-400"],[1,"text-gray-300","hover:text-red-400","transition-colors","p-1"],["loading","lazy",1,"w-full","object-contain","max-h-96","bg-gray-50",3,"src"],[1,"px-4","py-3"],[1,"flex","items-center","gap-4","px-4","py-3","border-t","border-gray-50"],[1,"flex","items-center","gap-1.5","transition-colors",3,"click"],[1,"text-lg"],[1,"text-sm","font-medium"],[1,"flex","items-center","gap-1.5","text-gray-400","hover:text-family-sky","transition-colors",3,"click"],[1,"px-4","pb-4","border-t","border-gray-50"],[1,"flex-1","h-px","bg-gray-200"],[1,"text-xs","text-gray-400","font-medium"],[1,"text-gray-300","hover:text-red-400","transition-colors","p-1",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"text-gray-700","whitespace-pre-wrap","break-words"],[1,"space-y-3","pt-3"],[1,"flex","gap-2","mt-3","pt-3","border-t","border-gray-50"],["placeholder","\xc9crire un commentaire...",1,"flex-1","text-sm","px-3","py-2","rounded-full","bg-gray-50","border-0","focus:ring-2","focus:ring-family-pink/30","outline-none",3,"ngModelChange","keydown.enter","ngModel"],[1,"px-3","py-2","text-family-pink","hover:text-family-coral","disabled:opacity-40","transition-colors",3,"click","disabled"],[1,"flex","gap-2"],["referrerpolicy","no-referrer",1,"w-7","h-7","rounded-full","object-cover","flex-shrink-0",3,"src"],[1,"w-7","h-7","rounded-full","bg-gradient-to-br","from-family-sky","to-family-purple","flex","items-center","justify-center","text-white","text-xs","font-bold","flex-shrink-0"],[1,"bg-gray-50","rounded-xl","px-3","py-2"],[1,"text-xs","font-semibold","text-gray-700"],[1,"text-sm","text-gray-600","break-words"],[1,"flex","items-center","gap-2","mt-1","px-1"],[1,"text-[10px]","text-gray-400"],[1,"text-[10px]","text-gray-400","hover:text-red-400"],[1,"text-[10px]","text-gray-400","hover:text-red-400",3,"click"],[1,"h-20","rounded-lg","object-cover",3,"src"],[1,"absolute","-top-2","-right-2","w-6","h-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","shadow-md","hover:bg-red-600","transition-colors",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-2xl","shadow-xl","max-w-sm","w-full","p-6","animate-fade-in",3,"click"],[1,"text-center"],[1,"w-14","h-14","mx-auto","mb-4","rounded-full","bg-red-100","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-red-500"],[1,"text-lg","font-bold","text-gray-800","mb-2"],[1,"text-sm","text-gray-500","mb-6"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-2.5","rounded-xl","border","border-gray-200","text-gray-600","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"flex-1","px-4","py-2.5","rounded-xl","bg-red-500","text-white","font-medium","hover:bg-red-600","transition-colors",3,"click"]],template:function(r,i){if(1&r){const o=yn();j(0,"div",2)(1,"div",3)(2,"h1",4)(3,"span"),Y(4,"\u{1f4f1}"),G(),j(5,"span",5),Y(6,"Fil d'actu"),G()()(),j(7,"div",6,0),vt(9,ZCe,7,0,"div",7),sr(10,lDe,25,13,null,null,wW),G(),j(12,"div",8),vt(13,cDe,5,1,"div",9),j(14,"div",10)(15,"input",11,1),Ge("change",function(c){return He(o),Ze(i.onFileSelected(c))}),G(),j(17,"button",12),Ge("click",function(){return He(o),Ze(i.openFilePicker())}),Rr(),j(18,"svg",13),wt(19,"path",14),G()(),ua(),j(20,"textarea",15),_a("ngModelChange",function(c){return He(o),tl(i.newMessage,c)||(i.newMessage=c),Ze(c)}),Ge("keydown.enter",function(c){return He(o),c.preventDefault(),Ze(i.send())}),G(),j(21,"button",16),Ge("click",function(){return He(o),Ze(i.send())}),Rr(),j(22,"svg",17),wt(23,"path",18),G()()()()(),vt(24,uDe,15,0,"div",19)}2&r&&(le(9),bt(i.messages.length?-1:9),le(),ar(i.messages),le(3),bt(i.imagePreview?13:-1),le(7),ga("ngModel",i.newMessage),le(),gn("disabled",!i.newMessage.trim()&&!i.selectedImage),le(3),bt(i.showDeleteModal?24:-1))},dependencies:[Rh,xw,Rc,Rd,kg],encapsulation:2})}}return t})()},{path:"task/edit/:id",canActivate:[Du],component:_Ee}];Nz(s5),function pre(){return pk.apply(this,arguments)}($we,{providers:[function vte(t){const n=t?.scheduleInRootZone,e=function yte({ngZoneFactory:t,scheduleInRootZone:n}){return t??=()=>new on({...J3(),scheduleInRootZone:n}),[{provide:Qu,useValue:!1},{provide:on,useFactory:t},{provide:qs,multi:!0,useFactory:()=>{const e=X(gte,{optional:!0});return()=>e.initialize()}},{provide:qs,multi:!0,useFactory:()=>{const e=X(bte);return()=>{e.initialize()}}},{provide:Xw,useValue:n??Jp}]}({ngZoneFactory:()=>{const r=J3(t);return r.scheduleInRootZone=n,r.shouldCoalesceEventChangeDetection&&Jo("NgZone_CoalesceEvent"),new on(r)},scheduleInRootZone:n});return za([{provide:_te,useValue:!0},e])}(),function Pce(t,...n){return za([{provide:Zb,multi:!0,useValue:t},[],{provide:Ym,useFactory:Bj},{provide:aI,multi:!0,useFactory:Vj},n.map(e=>e.\u0275providers)])}(dDe),function hoe(){return Jo("NgEagerAnimations"),[...doe]}(),function vue(...t){const n=[uue,UA,{provide:jA,useExisting:UA},{provide:oC,useFactory:()=>X(Xj,{optional:!0})??X(Qj)},{provide:e0,useValue:yue,multi:!0}];for(const e of t)n.push(...e.\u0275providers);return za(n)}(),wf(vhe,h6,Bhe.register("ngsw-worker.js",{enabled:Jh.production,registrationStrategy:"registerWhenStable:30000"})),Ad,Du,Ew,UD,{provide:Th,useValue:"fr-FR"}]}).catch(t=>console.error(t))}},Zy=>{Zy(Zy.s=681)}]);